% !TEX root = ../Schur indices and line operators.tex

\section{Special Functions\label{app:special-functions}}

Through out this appendix and the paper, we adopt the convention that fraktur letters $\mathfrak{a}, \mathfrak{b},$ etc., are related to the standard letters by
\begin{align}
	a = e^{2\pi i \mathfrak{a}}, \qquad
	b = e^{2 \pi i \mathfrak{b}}, \qquad \cdots, \qquad
	z = e^{2\pi i \mathfrak{z}} \ .
\end{align}
except for the standard notation $q = e^{2\pi i \tau}$.


\subsection{\texorpdfstring{The Weierstrass $\zeta$-function}{}}

The Weierstrass $\zeta$-function is defined by
\begin{align}\label{weierstrasszetadef}
	\zeta(z) \coloneqq \frac{1}{z} + \sum'_{\substack{(m, n) \in \mathbb{Z}^2\\(m, n) \ne (0, 0)}}
	\left[\frac{1}{z - m - n \tau} + \frac{1}{m + n \tau} + \frac{z }{(m + n \tau)^2} \right]\ .
\end{align}
In the following and in the main text we will often abbreviate
\begin{align}
	\sum'_{\substack{(m, n) \in \mathbb{Z}^2\\(m, n) \ne (0, 0)}} \to \ \ \sum'_{m, n} \ , \qquad \sum_{\substack{m \in \mathbb{Z}\\m \ne 0}} \to \sum_m '\ .
\end{align}
The $\zeta$ function is not elliptic, and under pull period shift of $z$,
\begin{align}\label{shift-formula-zeta}
  \zeta(z + 1 | \tau) - \zeta(z| \tau) = & \ 2\eta_1(\tau)\\
  \zeta(z + \tau |\tau) - \zeta(z|\tau) = & \ 2 \eta_2(\tau) \equiv 2\tau \eta_1(\tau) - 2\pi i\ ,
\end{align}
where $\eta_1$ and $\eta_2$ are independent of $z$ and are both related to the Eisenstein series $E_2$. Note that $\zeta$ has a simple pole at each lattice point $m + n \tau$ with unit residue. The fact that $\zeta$ isn't fully elliptic is due to the fact that meromorphic function on $T^2$ with only one simple pole doesn't exist.

% \begin{itemize}

	% \item The Weierstrass $\wp$-function
	% \begin{align}
	% 	\wp(z) \coloneqq & \ \frac{1}{z^2} + \sum_{(m,n) \ne (0,0)} \left[\frac{1}{(z - m - n \tau)^2} - \frac{1}{(m + n \tau)^2}\right] \ .
	% \end{align}
	% This function is elliptic,
	% \begin{align}
	% 	\wp(z) = \wp(z + 1) = \wp(z + \tau) \ .
	% \end{align}
	% Following from the simple fact that $\partial_z z^{-1} = - z^{-2}$, one has
	% \begin{align}
	% 	\wp(z) = - \partial_z \zeta(z)\ .
	% \end{align}
	% By definition, $\wp$ has only one double pole on $T^2_\tau$.

	% \item The descendants $\partial_z^n \wp(z)$ are all elliptic functions, all with a single $n + 2$-th order pole on $T^2_\tau$.
% \end{itemize}






\subsection{Jacobi theta functions}


The standard Jacobi theta functions can be defined as infinite products of the $q$-Pochhammer symbol $(z;q) \coloneqq \prod_{k = 0}^{+\infty}(1 - zq)$,
\begin{align}\label{def:Jacobi-theta}
	\vartheta_1(\mathfrak{z}) \coloneqq & \ - i z^{\frac{1}{2}}q^{\frac{1}{8}}(q;q)(zq;q)(z^{-1};q),
	& \vartheta_2(\mathfrak{z}) \coloneqq & z^{1/2}q^{\frac{1}{8}}(q;q)(-zq;q)(-z^{-1};q) \ ,\\
	\vartheta_3(\mathfrak{z}) \coloneqq & \ (q;q)(-zq^{1/2};q)(-z^{-1}q^{1/2}),
	& \vartheta_4(\mathfrak{z}) \coloneqq & (q;q)(zq^{1/2};q)(z^{-1}q^{1/2};q) \ .
\end{align}
From the definition is easy to read off their simple zeros, for example,
\begin{align}
	\vartheta_1(m + n \tau) = 0, \qquad
	\vartheta_4(m + n \tau + \frac{\tau}{2}) = 0 \ , \qquad
	m, n \in \mathbb{Z} \ .
\end{align}
The Jacobi theta functions can also be rewritten in infinite series in $q$, or Fourier series in $\mathfrak{z}$,
\begin{align}
	\vartheta_1(\mathfrak{z}) = & \ -i \sum_{r \in \mathbb{Z} + \frac{1}{2}} (-1)^{r-\frac{1}{2}} e^{2\pi i r \mathfrak{z}} q^{\frac{r^2}{2}} ,
	& \vartheta_2(\mathfrak{z}) = & \sum_{r \in \mathbb{Z} + \frac{1}{2}} e^{2\pi i r \mathfrak{z}} q^{\frac{r^2}{2}} \ ,\\
	\vartheta_3(\mathfrak{z}) = & \ \sum_{n \in \mathbb{Z}} e^{2\pi i n \mathfrak{z}} q^{\frac{n^2}{2}},
	& \vartheta_4(\mathfrak{z}) = & \sum_{n \in \mathbb{Z}} (-1)^n e^{2\pi i n \mathfrak{z}} q^{\frac{n^2}{2}} \ .
\end{align}

The functions $\vartheta_i(z)$ share similar shift properties under the full period shifts,
\begin{align}
	\vartheta_{1,2}(\mathfrak{z} + 1) = & - \vartheta_{1,2}(\mathfrak{z}) , & 
	\vartheta_{3,4}(\mathfrak{z} + 1) = & + \vartheta_{3,4}(\mathfrak{z}) , & \\
	\vartheta_{1,4}(\mathfrak{z} + \tau) = & - \lambda \vartheta_{1,4}(\mathfrak{z}), & 
	\vartheta_{2,3}(\mathfrak{z} + \tau) = & + \lambda \vartheta_{2,3}(\mathfrak{z}) , & 
\end{align}
where $\lambda \coloneqq e^{-2\pi i \mathfrak{z}}e^{- \pi i \tau}$, while under half-period shifts which can be summarized as in the following diagram,
\begin{center}
	% Figure removed
\end{center}
where $\mu = e^{- \pi i \mathfrak{z}} e^{- \frac{\pi i}{4}}$, and $f \xrightarrow{a} g$ means
\begin{align}
	\text{either}\qquad  f\left(\mathfrak{z} + \frac{1}{2}\right) = a g(\mathfrak{z}) \qquad \text{or} \qquad
	f\left(\mathfrak{z} + \frac{\tau}{2}\right) = a g(\mathfrak{z}) \ ,
\end{align}
depending on whether the arrow is horizontal or (slanted) vertical respectively.

% The functions $\vartheta_{i = 2,3,4}(z | \tau)$ transform into each other under the modular $S$ and $T$ transformations, which act, as usual, on the nome and flavor fugacity as $(\frac{\mathfrak{z}}{\tau}, - \frac{1}{\tau})\xleftarrow{~~S~~}(\mathfrak{z}, \tau) \xrightarrow{~~T~~} (\mathfrak{z}, \tau + 1).$ In summary, with $\alpha = \sqrt{-i \tau}e^{\frac{\pi i z^2}{\tau}}$,
% \begin{center}
% 	% Figure removed
% \end{center}




Finally, we will frequently encounter residues of the $\vartheta$ functions. In particular,
\begin{align}\label{theta-function-residue}
	\mathop{\operatorname{Res}}\limits_{a \to b^{\frac{1}{n}}q^{\frac{k}{n} + \frac{1}{2n}}e^{2\pi i \frac{\ell}{n}}} \frac{1}{a} \frac{1}{\vartheta_4(n\mathfrak{a} - \mathfrak{b})} = & \ \frac{1}{n} \frac{1}{(q;q)^3} (-1)^k q^{\frac{1}{2} k (k + 1)} \ , \\
	\mathop{\operatorname{Res}}\limits_{a \to b^{\frac{1}{n}}q^{\frac{k}{n}}e^{2\pi i \frac{\ell}{n}}} \frac{1}{a} \frac{1}{\vartheta_1(n\mathfrak{a} - \mathfrak{b})} = & \ \frac{1}{n} \frac{i }{\eta(\tau)^3} (-1)^{k + \ell} q^{\frac{1}{2}k^2}\ .
\end{align}
Note that the $(-1)^\ell$ in the second line is related to the presence of a branch point at $z = 0$ according to \eqref{def:Jacobi-theta}. 





\subsection{Eisenstein series}


The twisted Eisenstein series are defined by the following infinite sum,
\begin{align}
	E_{k \ge 1}\left[\begin{matrix}
		\phi \\ \theta
	\end{matrix}\right] \coloneqq & \ - \frac{B_k(\lambda)}{k!} \\
	& \ + \frac{1}{(k-1)!}\sum_{r \ge 0}' \frac{(r + \lambda)^{k - 1}\theta^{-1} q^{r + \lambda}}{1 - \theta^{-1}q^{r + \lambda}}
	+ \frac{(-1)^k}{(k-1)!}\sum_{r \ge 1} \frac{(r - \lambda)^{k - 1}\theta q^{r - \lambda}}{1 - \theta q^{r - \lambda}} \ ,
\end{align}
where the parameter $\phi \equiv e^{2\pi i \lambda}$ with $\lambda \in [0, 1)$, $B_k(x)$ denotes the $k$-th Bernoulli polynomial, and the prime $^\prime$ in the summation means that the term with $r = 0$ should be omitted whenever $\phi = \theta = 1$. We also define $E_0\big[\substack{\phi \\ \theta}\big] = -1$.

The standard Eisenstein series $E_{2n}$ are the $\theta, \phi \to 1$ limit of the above Eisenstein series. When $k$ is odd, $\theta = \phi = 1$ gives zero except for the special instance with $k = 1$, where there is a simple pole $\mathfrak{z} \to 0$,
\begin{align}
	E_{2n}\left[\begin{matrix}
		+1 \\ +1
	\end{matrix}\right] = E_{2n} \ , \qquad
	E_{2n + 1 \ge 3}\left[\begin{matrix}
		+1 \\ +1
	\end{matrix}\right] = 0 
	\qquad
	E_1\left[\begin{matrix}
		+ 1 \\ z
	\end{matrix}\right] = \frac{1}{2\pi i }\frac{\vartheta'_1(\mathfrak{z})}{\vartheta_1(\mathfrak{z})}
	\ .
\end{align}

The Eisenstein series exhibits several useful properties. For example, the symmetry property
\begin{align}\label{Eisenstein-symmetry}
	E_k\left[\begin{matrix}
	  \pm 1 \\ z^{-1}
	\end{matrix}\right] = (-1)^k E_k\left[\begin{matrix}
	  \pm 1 \\ z
	\end{matrix}\right] \ .
\end{align}
% The twisted Eisenstein series of neighboring weights are related by
% \begin{align}\label{EisensteinDerivative}
% 	q \partial_q E_k\left[\begin{matrix}
% 		\phi \\ b
% 	\end{matrix}
% 	\right] = (- k) b \partial_b E_{k + 1}\left[\begin{matrix}
% 		\phi \\ b
% 	\end{matrix}
% 	\right]\ .
% \end{align}

When shifting the argument $\mathfrak{z}$ of the Eisenstein series by half or full periods of $\tau$, or equivalently, shifting $z$ by $q^{\frac{n}{2}}$, one has
\begin{align}\label{Eisenstein-half-shift}
	E_k\left[\begin{matrix}
		\pm 1\\ z q^{\frac{n}{2}}
	\end{matrix}\right]
	=
	\sum_{\ell = 0}^{k} \left(\frac{n}{2}\right)^\ell \frac{1}{\ell !}
	E_{k - \ell}\left[\begin{matrix}
		(-1)^n(\pm 1) \\ z
	\end{matrix}\right] \ , \qquad n \in \mathbb{Z} \ .
\end{align}
A simple consequence is that\footnote{In fact, these equalities remain true even after replacing $1$ by $e^{2\pi i \lambda}$ and $- 1$ by $e^{2\pi i (\lambda + \frac{1}{2})}$.}
\begin{align}\label{Eisenstein-shift-1}
	E_k\left[\begin{matrix}
		\pm 1 \\ zq^{\frac{1}{2}}
	\end{matrix}\right]
	- E_k\left[\begin{matrix}
		\pm 1 \\ zq^{ - \frac{1}{2}}
	\end{matrix}\right]
	= & \ \sum_{m = 0}^{\floor{\frac{k - 1}{2}}} \frac{1}{2^{2m}(2m+1)!}E_{k - 1 - 2m}\left[\begin{matrix}
		\mp 1\\z
	\end{matrix}\right] \ ,
\end{align}
or more generally
\begin{align}
	E_k\left[\begin{matrix}
		\pm 1 \\ zq^{\frac{1}{2} + n}
	\end{matrix}\right]
	- E_k\left[\begin{matrix}
		\pm 1 \\ zq^{ - \frac{1}{2} - n}
	\end{matrix}\right]
	= & \ 2\sum_{m = 0}^{\floor{\frac{k - 1}{2}}} \left(\frac{2n+1}{2}\right)^{2m + 1}\frac{1}{(2m+1)!}E_{k - 1 - 2m}\left[\begin{matrix}
		\mp 1\\z
	\end{matrix}\right] \ .
\end{align}


% With the Eisenstein series one define the twisted Elliptic-$P$ functions, generalizing the well-known Weierstrass $\wp$-family. In particular \cite{Mason:2008zzb},
% \begin{align}\label{P1}
% 	P_{k = 1}\left[\begin{matrix}
% 		\phi \\ \theta
% 	\end{matrix}\right](y) \coloneqq - \frac{1}{y}\sum_{m \ge 0}E_m\left[\begin{matrix}
% 		\phi \\ \theta
% 	\end{matrix}\right] y^m \ ,
% \end{align}
% while the remaining twisted-$P_k$ with higher $k$ are obtained by taking successively $y$-derivatives.

% With $P$, the difference equations can be further reorganized into the more compact formula
% \begin{align}\label{Delta-Eisenstein}
% 	\Delta_k \left[\begin{matrix}
% 		\pm 1 \\ z
% 	\end{matrix}\right]
% 	= - 2\oint_0 \frac{dy}{2\pi i} \frac{1}{y^k} \sinh \left(\frac{y}{2}\right) P_1\left[\begin{matrix}
% 		\mp 1 \\ z
% 	\end{matrix}\right](y) \ .
% \end{align}
% where the $y$-contour goes around the origin. Conversely, the individual twisted Eisenstein series can be rewritten in terms of the above differences $\Delta_k$. Let us define $\mathcal{S}_\ell$ by
% \begin{align}\label{S2k}
% 	\frac{1}{2}\frac{y}{\sinh \frac{y}{2}}
% 	\equiv \sum_{\ell \ge 0} \mathcal{S}_\ell\, y^\ell .
% \end{align}
% It is straightforward to show that
% \begin{align}\label{Eisenstein-from-Delta}
% 	E_k\left[\begin{matrix}
% 		\pm 1 \\ z
% 	\end{matrix}\right]
% 	= \sum_{\ell = 0}^{k} \mathcal{S}_\ell\, \Delta_{k - \ell + 1}\left[\begin{matrix}
% 		\mp 1 \\ z
% 	\end{matrix}\right]\ .
% \end{align}




\subsection{Elliptic function}
In this paper we frequently encounter elliptic functions with respect to a complex structure $\tau$. They are meromorphic functions on $\mathbb{C}$ satisfying the doubly-periodic condition,
\begin{align}
	f(\mathfrak{z}) = f(\mathfrak{z} + \tau) = f(\mathfrak{z} + 1) \ .
\end{align}
Here $\tau \in \mathbb{C}$ with $\operatorname{Im}\tau > 0$. Exploiting the periodicity, one may restrict the domain of $\mathfrak{z}$ to be the \emph{fundamental parallelogram} in $\mathbb{C}$ with vertices $0$, $1$, $\tau$, $1 + \tau$. Equivalently, an elliptic function $f$ is a meromorphic function on the torus $T^2_\tau$ with complex structure $\tau$. Using $z = e^{2\pi i \mathfrak{z}}$, $f(\mathfrak{z})$ is some times rewritten as $f(z)$.

As a meromorphic function, $f(\mathfrak{z})$ may have poles in the parallelogram. In this paper we mainly focus on elliptic functions $f(\mathfrak{z})$ with only simple poles. We classify the poles $\mathfrak{z}_j$ into two types by the following criteria: we call $\mathfrak{z}_j$ \emph{real} if $\operatorname{Im}\mathfrak{z}_j = 0$, or \emph{imaginary} if $\operatorname{Im}\mathfrak{z}_j > 0$. The residues at the simple poles $\mathfrak{z}_j$ are captured by $R_j$,
\begin{align}
	R_j \coloneqq \mathop{\operatorname{Res}}_{z \to z_j}\frac{1}{z}f(z) \ .
\end{align}
Using the well-known Weierstrass $\zeta$ function and the Eisenstein series, any elliptic function with $f(\mathfrak{z})$ with only simple poles\footnote{For functions with higher order poles, one needs to include derivatives of $\zeta$-function or Eisentein series.} can be expanded in various ways,
\begin{align}\label{elliptic-function-decomposition}
	f(\mathfrak{z}) = C_f + \frac{1}{2\pi i}\sum_{j} R_j \zeta(\mathfrak{z} - \mathfrak{z}_j)
	= & \ f(\mathfrak{z}_0) + \sum_j R_j \left(
		E_1 \begin{bmatrix}
    	+1 \\ \frac{z_j}{z_0}
		\end{bmatrix}
		- E_1 \begin{bmatrix}
    	+1 \\ \frac{z_j}{z}
		\end{bmatrix}
	\right) \nonumber\\
	= & \ f(\mathfrak{z}_0) + \sum_j R_j \left(
		E_1 \begin{bmatrix}
    	- 1 \\ \frac{z_j}{z_0} q^{\frac{1}{2}}
		\end{bmatrix}
		- E_1 \begin{bmatrix}
    	- 1 \\ \frac{z_j}{z} q^{\frac{1}{2}}
		\end{bmatrix}
	\right) \\
	= & \ f(\mathfrak{z}_0) + \sum_j R_j \left(
		E_1 \begin{bmatrix}
    	- 1 \\ \frac{z_j}{z_0} q^{-\frac{1}{2}}
		\end{bmatrix}
		- E_1 \begin{bmatrix}
    	- 1 \\ \frac{z_j}{z} q^{-\frac{1}{2}}
		\end{bmatrix}
	\right) \nonumber \\
		= & \ f(\mathfrak{z}_0) + \sum_{\text{real/img} \ \mathfrak{z}_j} R_j \left(
			E_1 \begin{bmatrix}
	    	- 1 \\ \frac{z_j}{z_0} q^{\pm\frac{1}{2}}
			\end{bmatrix}
			- E_1 \begin{bmatrix}
	    	- 1 \\ \frac{z_j}{z} q^{\pm\frac{1}{2}}
			\end{bmatrix}
		\right) \nonumber \ .
\end{align}
Here $z_0 = e^{2\pi i \mathfrak{z}_0}$ is an arbitrary and generic reference value. Note that the expansion is valid for all types of pole combinations, real or imaginary, where the last line incorporates explicitly the real-ness of the poles to determine the $\pm \frac{1}{2}$. These expansions lead to useful integration formula that we will review later.




\subsection{Useful identities}

% The Jacobi theta functions satisfy a collection of \emph{duplication formulas}, for example,
% \begin{align}\label{duplication}
% 	\vartheta_1(2 \mathfrak{z})\vartheta_1'(0)
% 	= & \ 2\pi\prod_{i = 1}^{4}\vartheta_i(\mathfrak{z})
% 	= \pi \vartheta_1(2 \mathfrak{z}) \prod_{i = 2}^{4}\vartheta_i(0) \ ,\\
%   \vartheta_4(2 \mathfrak{z}) \vartheta_4(0)^3
%   = & \ \vartheta_4(\mathfrak{z})^4 - \vartheta_1(\mathfrak{z})^4
%   = \vartheta_3(\mathfrak{z})^4 - \vartheta_2(\mathfrak{z})^4 \ .
% \end{align}
% The $\mathfrak{z} \to 0$ limit of the first line gives the well-known identity $\vartheta'_1(0) = \pi \vartheta_2(0)\vartheta_3(0)\vartheta_4(0)$. The derivatives of $\vartheta_i$ satisfy, among a few other relations,
% \begin{align}\label{theta-derivative-formula}
% 	\frac{d}{d \mathfrak{z}} \left[\frac{\vartheta_1(\mathfrak{z})}{\vartheta_4(\mathfrak{z})}\right] = \vartheta_4(0)^2 \frac{\vartheta_2(\mathfrak{z})\vartheta_3(\mathfrak{z})}{\vartheta_4(\mathfrak{z})^2} \quad \Rightarrow
% 	\quad
% 	\frac{\vartheta'_4(\mathfrak{z})}{\vartheta_4(\mathfrak{z})}
% 	- \frac{\vartheta'_1(\mathfrak{z})}{\vartheta_1(\mathfrak{z})}
% 	= - \pi \vartheta_4(0)^2 \frac{\vartheta_2(\mathfrak{z})\vartheta_3(\mathfrak{z})}{\vartheta_1(\mathfrak{z})\vartheta_4(\mathfrak{z})}\ .
% \end{align}



% One can express both the Weierstrass family and the Eisenstein series in terms of the Jacobi theta functions. For example,
% \begin{align}\label{zeta-thetap}
% 	\zeta(\mathfrak{z}) = \frac{\vartheta'_1(\mathfrak{z})}{\vartheta_1(\mathfrak{z})} - 4\pi^2 \mathfrak{z} E_2 \ .
% \end{align}
% The quasi-periodicity of $\zeta$ now follows and one can express the $\eta_i(\tau)$ in \eqref{shift-formula-zeta} as
% \begin{align}
% 	\eta_1(\tau) = - 2\pi^2 E_2, \qquad \eta_2(\tau) = \tau \eta_1(\tau) - \pi i \ .
% \end{align}

% The schematic relation between the Eisenstein series and the Jacob-theta functions can be summarized in the diagram
% \begin{center}
% 	% Figure removed
% \end{center}
% In more details, the Eisenstein series can be rewritten in terms of ratios of $\vartheta$ functions and their derivatives,
% \begin{align}\label{EisensteinToTheta}
% 	E_k\left[\begin{matrix}
% 		+ 1 \\ z
% 	\end{matrix}\right] = - \left[e^{ - \frac{y}{2\pi i }\mathcal{D}_\mathfrak{z} - P_2(y) }\right]_k \vartheta_1(\mathfrak{z})
% \end{align}
% where $P_2$ is a Weierstrass elliptic-$P$ function (\ref{P2}), $[f(y)]_k$ denotes the $k$-th coefficient of the Taylor series of $f(y)$ around $y=0$, and we define an abstract differential operators $\mathcal{D}_\mathfrak{z}^n$ by
% \begin{align}
% 	\underbrace{\mathcal{D}_\mathfrak{z} \ldots \mathcal{D}_\mathfrak{z}}_{n \text{ copies}} \vartheta_i(\mathfrak{z}) = \mathcal{D}_\mathfrak{z}^n \vartheta_i(\mathfrak{z}) \equiv \frac{\vartheta^{(n)}_i(\mathfrak{z})}{\vartheta_i(\mathfrak{z})} \ .
% \end{align}
The Eisenstein series are related to the Jacobi theta functions,
\begin{align}\label{EisensteinToTheta-2}
	E_k\left[\begin{matrix}
		+ 1 \\ z
	\end{matrix}\right] = \sum_{\ell = 0}^{\floor{k/2}}  \frac{(-1)^{k + 1}}{(k - 2\ell)!}\left(\frac{1}{2\pi i}\right)^{k - 2\ell} \mathbb{E}_{2\ell} \frac{\vartheta_1^{(k - 2\ell)}(\mathfrak{z})}{\vartheta_1(\mathfrak{z})} \ ,
\end{align}
where we define
\begin{align}\label{Ebold}
	& \mathbb{E}_{2} \coloneqq E_2, \qquad \mathbb{E}_4 \coloneqq E_4 + \frac{1}{2}(E_2)^2, \qquad
	\mathbb{E}_6 \coloneqq E_6 + \frac{3}{4}E_4E_2 + \frac{1}{8}(E_2)^3 \ , \qquad \ldots\\
	& \mathbb{E}_{2\ell} \coloneqq \sum_{\substack{\{n_p\} \\ \sum_{p \ge 1} (2p)n_p = 2\ell}} \prod_{p\ge 1} \frac{1}{n_p !} \left(\frac{1}{2p}E_{2p}\right)^{n_p}\ .
\end{align}
Similar formula for $E_k\left[\substack{- 1 \\ \pm z}\right]$ can be obtained by replacing $\vartheta_1$ with $\vartheta_{2,3,4}$. For the reader's convenience we list the first few conversions here.
\begin{align}\label{Ek-thetap}
	E_1\left[\begin{matrix}
		+1 \\ z
	\end{matrix}
	\right] = & \ \frac{1}{2\pi i} \frac{\vartheta'_1(\mathfrak{z})}{\vartheta_1(\mathfrak{z})}\ ,  \\
	E_2\left[\begin{matrix}
		+1 \\ z
	\end{matrix}
	\right] = & \ \frac{1}{8\pi^2}\frac{\vartheta_1''(\mathfrak{z})}{\vartheta_1(\mathfrak{z})} - \frac{1}{2} E_2 \ , \\
	E_3\left[\begin{matrix}
		+1 \\ z
	\end{matrix}
	\right] = & \ \frac{i}{48\pi^3} \frac{\vartheta'''_1(\mathfrak{z})}{\vartheta_1(\mathfrak{z})}
	  - \frac{i}{4\pi}\frac{\vartheta'_1(\mathfrak{z})}{\vartheta_1(\mathfrak{z})} E_2,  \\
	E_4\left[\begin{matrix}
		+1 \\ z
	\end{matrix}\right] = & \ - \frac{1}{384\pi^4} \frac{\vartheta''''_1(\mathfrak{z})}{\vartheta_1(\mathfrak{z})} + \frac{1}{16\pi^2}E_2 \frac{\vartheta''_1(\mathfrak{z})}{\vartheta_1(\mathfrak{z})} - \frac{1}{4} \left(E_4 + \frac{1}{2}(E_2)^2\right) \\
	E_5\left[\begin{matrix}
		+1 \\ z
	\end{matrix}\right]
	= & \ - \frac{i}{3840 \pi^5} \frac{\vartheta^{(5)}_1(\mathfrak{z})}{\vartheta_1(\mathfrak{z})} + \frac{i}{96\pi^3}E_2 \frac{\vartheta_1^{(3)}(\mathfrak{z})}{\vartheta_1(\mathfrak{z})} - \frac{i}{8\pi}\left(E_4 + \frac{1}{2}(E_2)^2\right)\frac{\vartheta_1'(\mathfrak{z})}{\vartheta_1(\mathfrak{z})} \\
	E_6\left[\begin{matrix}
		+ 1 \\ z
	\end{matrix}\right]
	= & \ \frac{1}{46080\pi^6} \frac{\vartheta^{(6)}_1(\mathfrak{z})}{\vartheta_1(\mathfrak{z})} - \frac{1}{768\pi^4}E_2 \frac{\vartheta_1^{(4)}(\mathfrak{z})}{\vartheta_1(\mathfrak{z})} + \frac{1}{32\pi^2} \left(E_4 + \frac{1}{2}(E_2)^2\right) \frac{\vartheta_1^{(2)}(\mathfrak{z})}{\vartheta_1(\mathfrak{z})} \nonumber\\
	& \ - \frac{1}{6}\left(E_6 + \frac{3}{4}E_4 E_2 + \frac{1}{8}E_2^3\right) \ .
\end{align}


% From the above conversion one computes the residues of Eisenstein series,
% \begin{align}
% 	\mathop{\operatorname{Res}}_{z \to 1}\frac{1}{z}E_k\left[\begin{matrix}
% 		+ 1 \\ z
% 	\end{matrix}\right] = \delta_{k1} \ ,
% 	\qquad
% 	\mathop{\operatorname{Res}}_{z \to q^{\frac{1}{2} + n}}\frac{1}{z}E_k\left[\begin{matrix}
% 		- 1 \\ z
% 	\end{matrix}\right] = \frac{1}{2^{k - 1} (k - 1)!} \ .
% \end{align}



Moreover, the Eisenstein series satisfy the following relations which are generalization of the so-called duplication formula of the Jacobi theta functions,
\begin{align}\label{duplication-Eisenstein}
	\sum_{\pm}E_k\left[\begin{matrix}
		\phi \\ \pm z
	\end{matrix}\right](\tau) = & \ 2 E_k\left[\begin{matrix}
		\phi \\ z^2
	\end{matrix}\right](2\tau) \ , \nonumber \\
	\sum_{\pm} \pm E_k\left[\begin{matrix}
		\phi \\ \pm z
	\end{matrix}\right](\tau)
	= & \ -2 E_k\left[\begin{matrix}
		\phi \\ z^2
	\end{matrix}\right](2\tau)
	 + 2 E_k\left[\begin{matrix}
	 	\phi \\ z
	 \end{matrix}\right](\tau)\ , \nonumber
	\\
	E_k\left[\begin{matrix}
		+ 1\\z
	\end{matrix}\right](2\tau)
	+ E_k\left[\begin{matrix}
		- 1\\z
	\end{matrix}\right](2\tau) = & \ 
	\frac{2}{2^k}E_k\left[\begin{matrix}
		+ 1 \\ z
	\end{matrix}\right] \ ,\\
	\sum_{\pm \pm} E_k\left[\begin{matrix}
		\pm 1 \\ \pm z
	\end{matrix}\right](\tau) = & \ \frac{4}{2^k}E_k\left[
	\begin{matrix}
		+ 1 \\ z^2
	\end{matrix}\right](\tau)\ . \nonumber\\
	E_1 \begin{bmatrix}
  	\phi \\ zq^{-1/2}  
	\end{bmatrix}(2\tau) + E_1 \begin{bmatrix}
  	\phi \\ z q^{\frac{1}{2}}  
	\end{bmatrix}(2\tau) = & \ E_1 \begin{bmatrix}
  	\phi \\ z  
	\end{bmatrix}(\tau), \qquad \phi = \pm 1 \ .
\end{align}
% There are similar identities coming from applying the shift $z \to z q^{\frac{1}{2}}$. Combining the duplication formulas and (\ref{theta-derivative-formula}), one finds a useful identity
% \begin{align}\label{Eisenstein-identity-1}
% 	E_1\left[\begin{matrix}
% 		+ 1 \\ z
% 	\end{matrix}\right]
% 	- E_1\left[\begin{matrix}
% 		- 1 \\ z
% 	\end{matrix}\right]
% 	= \frac{\eta(\tau)^3}{2i} \frac{\vartheta_1(2 \mathfrak{z})\vartheta_4(0)^2}{\vartheta_1(\mathfrak{z})^2 \vartheta_4(\mathfrak{z})^2}\ .
% \end{align}

The $E_1$ function also has some alternative expansions besides its definition, for example,
\begin{align}\label{E1-expansions}
	E_1 \begin{bmatrix}
  	-1 \\ b  
	\end{bmatrix}
	=  & \ \frac{b^{-1} q^{\frac{1}{2}}}{1 - b^{-1} q^{\frac{1}{2}}}
	- \frac{b q^{\frac{1}{2}}}{1 - b q^{\frac{1}{2}}}
	+ \sum_{k = 1}^{+\infty} q^n \frac{b^n - b^{-n}}{q^{\frac{n}{2}} - q^{-\frac{n}{2}}} \\
	= & \ \frac{1}{2}\left(\frac{b^{-1} q^{\frac{1}{2}}}{1 - b^{-1} q^{\frac{1}{2}}}
	- \frac{b q^{\frac{1}{2}}}{1 - b q^{\frac{1}{2}}}\right)
	+ \frac{1-q}{2}\sum_{n = 1}^{+\infty}q^{n/2}\sum_{\substack{m = - n/2 \\ m\ne0 }}^{n/2} \frac{b^{2m} - b^{-2m}}{1 - q^{-2m}} \ .
\end{align}
% To understand these relations, it is useful to also note the following $q$-series identities,
% \begin{align}
% 	\sum_{n = 1}^{+\infty}\frac{x^n}{q^{- n/2} - q^{n/2}} = \sum_{n = 0}^{+\infty} \frac{x q^{n + \frac{1}{2}}}{1 - xq^{n + \frac{1}{2}}} \ ,
% \end{align}
% and the identity
% \begin{align}
% 	& \ \frac{1}{1 - q^2}\sum_{n = 1}^{+\infty}a_n q^n
% 	= \sum_{n = 1}^{+\infty} \sum_{\ell = 0}^{+\infty} a_n q^{2\ell + n}
% 	= \sum_{N = 1}^{+\infty} \sum_{\ell = 0}^{\lfloor\frac{N-1}{2} \rfloor} a_{N - 2\ell} q^N \\
% 	= & \ \sum_{N = 1}^{+\infty}q^N \sum_{\ell = \frac{N}{2} - \lfloor \frac{N-1}{2} \rfloor}^{\frac{N}{2}}a_{2\ell} \ ,
% \end{align}
% combined with
% \begin{align}
% 	& \ \sum_{\substack{m = - n/2 \\ m \ne 0}}^{+n/2} \frac{b^{2m}}{q^m - q^{-m}} = \sum_{\ell = \frac{n}{2} - \lfloor \frac{n}{2} \rfloor}^{\frac{n}{2}} \frac{b^{2\ell} - b^{-2\ell}}{q^\ell - q^{-\ell}} \ ,
% \end{align}
% to imply
% \begin{align}
% 	\sum_{n = 1}^{\infty}\sum_{\substack{m = - n/2 \\ m \ne 0}}^{n/2} q^n \frac{b^{2m}}{q^m - q^{-m}} = \frac{1}{1-q^2} \sum_{n = 1}^{+\infty} \frac{b^n - b^{-n}}{q^{n/2} - q^{-n/2}} \ .
% \end{align}




\section{Integration formula \label{app:integration-formula}}

In this appendix we collect integration formula for contour integrals containing an elliptic function, some products of Eisenstein series and some monomial factors.


\subsection{Integration formula without monomial}

We begin with the simplest formula. Consider an elliptic function $f(\mathfrak{z})$ with only simple poles. Denoting $z = e^{2\pi i \mathfrak{z}}$, then the contour integral of $f$ along the unit circle can be computed analytically,
\begin{align}\label{integration-formula-f}
	\oint_{|z| = 1} \frac{dz}{2\pi i z} f(\mathfrak{z})
	= f(\mathfrak{z}_0)
	+ \sum_{\text{real/img} \ \mathfrak{z}_j} R_j E_1 \begin{bmatrix}
  	-1 \\ \frac{z_j}{z_0}q^{\pm \frac{1}{2}} 
	\end{bmatrix} \ .
\end{align}
Here, $\mathfrak{z}_0$ (and $z_0 = e^{2\pi i \mathfrak{z}_0}$) denotes an arbitrary and generic reference value, and $\mathfrak{z}_j$ (with $z_j = e^{2\pi i \mathfrak{z}_j}$) are the simple poles of $f$. Recall that $\mathfrak{z}_j$ is real if $\operatorname{Im}\mathfrak{z}_j = 0$, or imaginary if $\operatorname{Im}\mathfrak{z}_j > 0$. This formula follows directly from the decomposition
\begin{align}
	f(\mathfrak{z}) = f(\mathfrak{z}_0) + \sum_{\text{real/img} \ \mathfrak{z}_j} R_j \left(
			E_1 \begin{bmatrix}
	    	- 1 \\ \frac{z_j}{z_0} q^{\pm\frac{1}{2}}
			\end{bmatrix}
			- E_1 \begin{bmatrix}
	    	- 1 \\ \frac{z_j}{z} q^{\pm\frac{1}{2}}
			\end{bmatrix}
		\right) \ .
\end{align}
Note that only the last term depends on $z$, and upon integration,
\begin{align}
	\oint \frac{dz}{2\pi i z} E_1 \begin{bmatrix}
  	-1 \\ za  
	\end{bmatrix} = 0 \ .
\end{align}
Only the $z$-independent terms survives the contour integration, yielding \eqref{integration-formula-f}.

In computing Schur index, we often encounter more complicated contour integrals involving the product of an elliptic function and several Eisenstein series. For example, for the class-$\mathcal{S}$ $A_1$ index, we need the following integration formula,
\begin{align}
	\label{integration-formula-fE-1}
		& \ \oint_{|z| = 1} \frac{dz}{2\pi i z}f(\mathfrak{z})E_k\left[
		\begin{matrix}
			-1 \\ za
		\end{matrix}\right] \\
		= & \ - \mathcal{S}_{k} \left(f(\mathfrak{z}_0)
		  + \sum_{\text{real/imag } \mathfrak{z}_j}R_j  E_{1}\left[\begin{matrix}
				-1 \\ \frac{z_j}{z_0}q^{\pm \frac{1}{2}}
			\end{matrix}\right]
		\right)
		- \sum_{\text{real/imag } \mathfrak{z}_j} R_j\,  \sum_{\ell = 0}^{k - 1} \mathcal{S}_{\ell}\, E_{k - \ell + 1}\left[
			\begin{matrix}
				1 \\ z_j a q^{\pm \frac{1}{2}}
			\end{matrix}\right] \ .
\end{align}
Here $\mathcal{S}_k$ are rational numbers defined through the series expansion
\begin{align}
	\frac{1}{2} \frac{y}{\sinh(y/2)} = \sum_{\ell \ge 0} \mathcal{S}_\ell y^\ell \ .
\end{align}
Explicitly, we list a few instances of $\mathcal{S}_\ell$ below.
\begin{center}
	\begin{tabular}{c|c|c|c|c|c|c|c|c|c|c|c|c|c}
		$\ell$ & 0 & 1 & 2 & 3 & 4 & 5 & 6 & 7 & 8 & 9 & 10 & 11 & 12 \\
		\hline
		$\mathcal{S}_\ell$ & 1 & 0 & $- \frac{1}{24}$ & 0 & $\frac{7}{5760}$ & 0 & $ - \frac{31}{967680}$ & 0 & $\frac{127}{154828800}$ & 0 & $- \frac{73}{3503554560}$
		& $0$ & 
		$\frac{1414477}{2678117105664000}$
	\end{tabular}
\end{center}

Similarly, we also have
\begin{align}\label{integration-formula-fE-2}
	& \ \oint_{|z| = 1} \frac{dz}{2\pi i z} f(\mathfrak{z}) E_k\left[\begin{matrix}
		+ 1 \\ za
	\end{matrix}
	\right] \nonumber\\
	= & \ - \mathcal{A}_k\left(f(\mathfrak{z}_0) + \sum_{\text{real/imag } \mathfrak{z}_j}R_j\, E_1\left[\begin{matrix}
			- 1\\ \frac{z_j}{z_0}q^{\pm \frac{1}{2}}
		\end{matrix}\right]\right)  \nonumber\\
	  & \ - \sum_{\text{real/imag } \mathfrak{z}_j} R_j \left(
	    - \mathcal{B}_k\, E_1\left[\begin{matrix}
	  	  -1 \\ z_jaq^{\pm \frac{1}{2}}
	    \end{matrix}\right]
	  + \sum_{\ell = 0}^{k - 1} \mathcal{S}_{\ell}\, E_{k + 1 - \ell} \left[\begin{matrix}
	  	  		-1 \\ z_j a q^{\pm  \frac{1}{2}}
	  	  	\end{matrix}\right]\right) \; ,
\end{align}
where
\begin{align}
	\mathcal{A}_{2n} = \frac{B_{2n}}{(2n)!}, \qquad \mathcal{A}_{2n + 1} = \frac{\delta_{n, 0}}{2}, \qquad \mathcal{B}_{2n} = \frac{B_{2n}}{(2n)!} - \mathcal{S}_{2n}, \qquad \mathcal{B}_{2n + 1} = \frac{\delta_{n,0}}{2} \ .
\end{align}

To compute the Schur index of the some class-$\mathcal{S}$ $A_2$ with 2 or 3 maximal punctures and an arbitrary number of minimal punctures, we need the following type of integrals,
\begin{align}\label{EEtype}
	\oint \frac{dz}{2\pi i z} f(\mathfrak{z}) E_1 \begin{bmatrix}
  	\pm 1 \\ za  
	\end{bmatrix}
	E_k \begin{bmatrix}
  	\pm 1 \\ zb
	\end{bmatrix} \ .
\end{align}

As simplest cases, when $f(\mathfrak{z}) = 1$ we have the following integration formula,
\begin{align}\label{integration-formula-EE}
	& \ \oint \frac{dz}{2\pi i z}E_k \begin{bmatrix}
  	-1 \\ za  
	\end{bmatrix}
	E_\ell \begin{bmatrix}
  	-1 \\ zb
	\end{bmatrix}\\
	= & \ (-1)^{k + \ell + 1}\Bigg(
	- C_{k + \ell}^{k} \mathcal{S}_{k + \ell} 
	+ \sum_{r = 2}^{\ell}\sum_{s = r}^{\ell}
	(-1)^{r + s}C_{k + \ell - s}^{\ell + 1 - r}\mathcal{S}_{k + \ell - s} E_s \begin{bmatrix}
  	1 \\ a/b  
	\end{bmatrix}
	\\
	& \ \qquad
	\qquad\qquad\qquad + \sum_{r = \ell + 1}^{k + \ell}(-1)^r C_{k + \ell - 1 - r}^{\ell - 1}
	E_r \begin{bmatrix}
  	1 \\ a/b  
	\end{bmatrix}
	\Bigg) \ .
\end{align}
One can also utilize this formula to derive or understand the structure of the other ones we introduce in this appendix. For example, to compute \eqref{integration-formula-fE-1}, one can begin by decomposing $f$ as in (\ref{elliptic-function-decomposition}), and apply (\ref{integration-formula-EE}).




When $f(\mathfrak{z})$ is a nontrivial elliptic function, we have the following series of integration formula,
\begin{align}\label{integration-formula-fEE-1}
  & \ \oint \frac{dz}{2\pi i z} f(\mathfrak{z}) E_1 \begin{bmatrix}
    -1 \\ za
  \end{bmatrix}
  E_{2k} \begin{bmatrix}
    -1 \\ zb
  \end{bmatrix} \nonumber \\
  = & \ 
  \left[\oint \frac{dz}{2\pi i z}f(\mathfrak{z})\right]\sum_{\ell = 0}^{k - 1}
  \mathcal{S}_{2\ell} E_{2k + 1 - 2\ell} \begin{bmatrix}
      1 \\ a/b
    \end{bmatrix} \\
  & \ - \sum_{\text{real/img }\mathfrak{z}_j} R_j E_1 \begin{bmatrix}
      1 \\ a z_j q^{\pm \frac{1}{2}}
    \end{bmatrix}\sum_{\ell = 0}^{k - 1}
  \mathcal{S}_{2\ell} 
    E_{2k + 1 - 2\ell} \begin{bmatrix}
      1 \\ b z_j q^{\pm \frac{1}{2}}
    \end{bmatrix} \nonumber\\
   & \ - \sum_{\text{real/img }\mathfrak{z}_j} R_j  E_1 \begin{bmatrix}
      1 \\ a z_j q^{\pm \frac{1}{2}}
    \end{bmatrix}\sum_{\ell = 0}^{k - 1}
    \mathcal{S}_{2\ell} 
    E_{2k + 1 - 2\ell} \begin{bmatrix}
      1 \\ \frac{a}{b}
    \end{bmatrix}
    \nonumber\\
  & \ - \sum_{\text{real/img }\mathfrak{z}_j} R_j
  \sum_{\ell = 0}^{k}(1-2\ell)\mathcal{S}_{2\ell} E_{2k + 2 - 2\ell}\begin{bmatrix}
    1 \\ b z_j q^{\pm \frac{1}{2}}  
  \end{bmatrix}
  + \mathcal{S}_{2k}\left(E_2\begin{bmatrix}
        1 \\ a z_j q^{\pm \frac{1}{2}}  
      \end{bmatrix}
    + E_2\begin{bmatrix}
        1 \\ b z_j q^{\pm \frac{1}{2}}  
      \end{bmatrix}  \right)\ , \nonumber
\end{align}
and
\begin{align}\label{integration-formula-fEE-2}
  & \ \oint \frac{dz}{2\pi i z} f(\mathfrak{z}) E_1 \begin{bmatrix}
    -1 \\ za  
  \end{bmatrix}
  E_{2k + 1} \begin{bmatrix}
    -1 \\ zb
  \end{bmatrix} \nonumber \\
  = & \ \left[\oint \frac{dz}{2\pi i z}f(\mathfrak{z})\right]\left[- (2k + 1)\mathcal{S}_{2k + 2} + \sum_{\ell = 0}^{k + 1} \mathcal{S}_{2\ell} E_{2k+2- 2\ell}\begin{bmatrix}
        1 \\ a/b  
      \end{bmatrix}\right] \nonumber \\
  & \ - \sum_{\text{real/img.}\ \mathfrak{z}_j} R_j E_1 \begin{bmatrix}
    1 \\ a z_j q^{\pm \frac{1}{2}}
  \end{bmatrix} \sum_{\ell = 0}^{k} \mathcal{S}_{2\ell} E_{2k + 2 - 2\ell}\begin{bmatrix}
    1 \\ bz_j q^{\pm \frac{1}{2}}
  \end{bmatrix} \\
  & \ + \sum_{\text{real/img.}\ \mathfrak{z}_j} R_j E_1 \begin{bmatrix}
    1 \\ a z_j q^{\pm \frac{1}{2}}
  \end{bmatrix} \sum_{\ell = 0}^{k} \mathcal{S}_{2\ell} E_{2k + 2 - 2\ell}\begin{bmatrix}
    + 1 \\ a/b
  \end{bmatrix} \nonumber\\
  & \ - \sum_{\text{real/img.}\ \mathfrak{z}_j} R_j \sum_{\ell = 0}^{k} (1-2\ell)\mathcal{S}_{2\ell} E_{2k + 3 - 2\ell}\begin{bmatrix}
    1 \\ b z_j q^{\pm \frac{1}{2}}
  \end{bmatrix} \nonumber \ .
\end{align}
Variants of these integration formula with $E_1 \big[\substack{+ 1 \\ za}\big]$, $E_1 \big[\substack{+ 1 \\ zb}\big]$ can be obtained by applying (\ref{Eisenstein-half-shift}).

\subsection{Integration formula with monomial}

In the previous discussions, we have encountered integrals involving products of elliptic functions and Eisenstein series. In the following, we further enrich the integration formula by including a monomial of the integration variable,
\begin{align}
	\oint \frac{dz}{2\pi i z} z^n f(\mathfrak{z}), \qquad
	\oint \frac{dz}{2\pi i z} z^n f(\mathfrak{z}) E_k \begin{bmatrix}
  	\pm 1 \\
  	z a  
	\end{bmatrix}\ , \qquad
	n \in \mathbb{Z}_{\ne 0} \ .
\end{align}
where $f(\mathfrak{z})$ is again an elliptic function in $\mathfrak{z}$. These formula will be important when dealing with loop operator index.


\subsubsection{One Eisenstein and monomial}
In the presence of a Eisenstein series, we have the following integration formula for a generic $a$ independent of $q$,
\begin{align}
	\oint \frac{dz}{2\pi i z} z^n E_k \begin{bmatrix}
		1 \\ za
	\end{bmatrix}
	= & \ \frac{1}{(k-1)!} \frac{q^n}{a^n} \frac{\text{Eu}_{k - 1}(q^n)}{(1 - q^n)^k} \ ,\\
	\oint \frac{dz}{2\pi i z} z^n E_k \begin{bmatrix}
		1 \\ z^{-1}a
	\end{bmatrix}
	= & \ \frac{(-1)^k}{(k-1)!} (aq)^n \frac{\text{Eu}_{k - 1}(q^n)}{(1 - q^n)^k} \ .
\end{align}
Here $\text{Eu}_n(t)$ denotes the Eulerian polynomial that is defined by the equation
\begin{align}
	\sum_{n = 0}^{+\infty}\text{Eu}_n(t) \frac{x^n}{n!} = \frac{t - 1}{t - e^{(t - 1)x}} \ .
\end{align}
Similarly, we have the following parallel integration formula
\begin{align}
	\oint \frac{dz}{2\pi i z} z^n E_k \begin{bmatrix}
		- 1 \\ za
	\end{bmatrix}
	= & \ \frac{1}{(k-1)!} \frac{q^{n/2}}{a^n} \Phi(q^n, 1 - k, \frac{1}{2}) \ ,\\
	\oint \frac{dz}{2\pi i z} z^n E_k \begin{bmatrix}
		- 1 \\ z^{-1}a
	\end{bmatrix}
	= & \ \frac{(-1)^k}{(k-1)!} a^nq^{n/2} \Phi(q^n, 1 - k, \frac{1}{2}) \ ,
\end{align}
where the $\Phi$ denotes the Lerch transcendent function $\Phi(z, s, a)$ given by
\begin{align}
	\Phi(z, s, a) \coloneqq \sum_{p = 0}^{+\infty} \frac{z^p}{(p + a)^s} \ .
\end{align}
Recall that the Eisenstein series enjoy shift property (\ref{Eisenstein-half-shift}). When inserted into the above integration formula, the shift property translates to
\begin{align}
	\frac{1}{(1 - q^n)^k} \operatorname{Eu}_{k - 1}(q^n)
	= \sum_{\ell = 0}^{k} \left(\frac{1}{2}\right)^\ell \frac{(k-1)!}{\ell!(k - 1 - \ell)!} \Phi(q^n, 1 - k + \ell, \frac{1}{2}) \ .
\end{align}
For readers' convenience, we list a few instances of $\operatorname{Eu}$ and $\Phi$,
\begin{center}
	\begin{tabular}{c|c|c|c|c|c|c}
		$n$ & $1$ & $2$ & $3$ & $4$ & $5$ \\
		\hline
		$\operatorname{Eu}_n(t)$ & $1$ & $1 + q$ & $1 + 4q + q^2$ & $1 + 11q + 11q^2 + q^3$ & $1 + 26 q + 66q^2 + 26q^3 + q^4$ \\
	\end{tabular}
	\begin{tabular}{c|c|c|c|c}
		$n$ & $6$ \\
		\hline
		$\operatorname{Eu}_n(t)$ & $1 + 57q + 302q^2 + 302q^3 + 57q^4 + q^5$
	\end{tabular}
	\begin{tabular}{c|c|c|c|c}
		$n$ & $7$ \\
		\hline
		$\operatorname{Eu}_n(t)$ & $1 + 120q + 1191q^2 + 2416 q^3 + 1191q^4 + 120 q^5 + q^6$
	\end{tabular}
\end{center}

In the presence of certain amount of $q$-shift, the above formula needs some modifications. For example, with generic $a$, $0 < \alpha < 1$, $\ell \in \mathbb{N}_{> 0}$
\begin{align}
	\oint \frac{dz}{2\pi i z}z^n E_1 \begin{bmatrix}
  	1 \\ z^{-1}aq
	\end{bmatrix}
	= & \ \frac{(a)^n}{1 - q^{-n}} = \oint \frac{dz}{2\pi i z} z^n E_1 \begin{bmatrix}
  	1 \\ z^{-1} a  
	\end{bmatrix}, \\
	\oint \frac{dz}{2\pi i z}z^n E_{k} \begin{bmatrix}
  	1 \\ z^{-1}aq^\alpha
	\end{bmatrix}
	= & \ \frac{(-1)^k}{(k-1)!} (a q^\alpha)^n q^{n} \frac{\operatorname{Eu}_{k - 1}(q^n)}{(1 - q^n)^k}- \delta_{k = 1}(aq^\alpha)^n \ ,\\
	\oint \frac{dz}{2\pi i z}z^n E_1 \begin{bmatrix}
  	-1 \\ z^{-1}aq^\ell
	\end{bmatrix}
	= & \ \frac{-2 + 2q^n}{1 + q^n} \frac{(-1)^k}{(k-1)!} a^n q^{n/2} \Phi(q^n, 1 - k, \frac{1}{2})  \ ,\\
	\oint \frac{dz}{2\pi i z}z^n E_2 \begin{bmatrix}
  	-1 \\ z^{-1}aq^\ell
	\end{bmatrix}
	= & \ \frac{-(2\ell - 1) + (2\ell + 1)q^n}{1 + q^n} \frac{(-1)^k}{(k-1)!} a^n q^{n/2} \Phi(q^n, 1 - k, \frac{1}{2})  \ ,\\
	\oint \frac{dz}{2\pi i z}z^n E_3 \begin{bmatrix}
  	-1 \\ z^{-1}aq^\ell
	\end{bmatrix}
	= & \ \frac{(2\ell - 1)^2 - 2(-3 + 4\ell^2)q^n + (2\ell + 1)^2 q^{2n}}{1 + q^n} \\
	& \ \qquad\qquad\qquad \times \frac{(-1)^k}{(k-1)!} a^n q^{n/2} \Phi(q^n, 1 - k, \frac{1}{2})  \ .
\end{align}








\subsubsection{Two Eisensteins}
With two factors of Eisenstein series, the integration formula become much more tedious. For $n \in \mathbb{Z}_{\ne 0}$ and $k_1 \ge k_2$, we have
\begin{align}\label{integration-formula-zEE-1}
	& \ \oint \frac{dz}{2\pi i z} z^n E_{k_1}\begin{bmatrix}
  	+ 1 \\ z  
	\end{bmatrix}E_{k_2} \begin{bmatrix}
  	+ 1 \\ za  
	\end{bmatrix} \\
	= & \ \sum_{\ell = 0}^{k_1} \frac{1}{\ell!} \frac{q^n}{a^n}  \frac{\operatorname{Eu}_{k_2 + \ell - 1}(q^n)}{(1 - q^n)^{k_2 + \ell}}\left[
		\frac{(-1)^{k_1 - \ell}}{(k_2 - 1)!} + \frac{\ell!a^n}{(k_1 - 1)! (k_2 - k_1 + \ell)!}
	\right] E_{k_1 - \ell}\begin{bmatrix}
  	+ 1 \\ a  
	\end{bmatrix} \ , \nonumber
\end{align}
and when $k_1 \le k_2$,
\begin{align}\label{integration-formula-zEE-2}
	& \ \oint \frac{dz}{2\pi i z} z^n E_{k_1}\begin{bmatrix}
  	+ 1 \\ z  
	\end{bmatrix}E_{k_2} \begin{bmatrix}
  	+ 1 \\ za  
	\end{bmatrix} \\
	= & \ \sum_{\ell = 0}^{k_2} \frac{1}{\ell!} \frac{q^n}{a^n}  \frac{\operatorname{Eu}_{k_1 + \ell - 1}(q^n)}{(1 - q^n)^{k_1 + \ell}}\left[
		\frac{a^n}{(k_1 - 1)!} + \frac{(-1)^{k_2 - \ell} \ell!}{(k_2 - 1)! (k_1 - k_2 + \ell)!}
	\right] E_{k_2 - \ell}\begin{bmatrix}
  	+ 1 \\ a
	\end{bmatrix} \ .\nonumber
\end{align}
It may be convenient to merge the two identities into
\begin{align}\label{integration-formula-zEE-3}
	\oint \frac{dz}{2\pi i z} z^n E_{k_1}\begin{bmatrix}
  	+ 1 \\ z  
	\end{bmatrix}
	E_{k_2}\begin{bmatrix}
  	+ 1 \\ z  a
	\end{bmatrix}
	= \sum_{\ell = 1}^{\operatorname{max}(k_1, k_2)}
	\frac{1}{\ell!}\frac{q^n}{a^n}\mathcal{E}_{k_1, k_2; \ell}(a^n, q^n) E_{\max(k_1, k_2) - \ell} \begin{bmatrix}
  	+1 \\ a  
	\end{bmatrix} \ ,
\end{align}
where $\mathcal{E}$ can be read off from (\ref{integration-formula-zEE-1}) and (\ref{integration-formula-zEE-2}). Note also that
\begin{align}
	\oint \frac{dz}{2\pi i z}z^n E_{k_1} \begin{bmatrix}
  	+1 \\ z a  
	\end{bmatrix}
	E_{k_1} \begin{bmatrix}
  	+1 \\ z b  
	\end{bmatrix}
	= & \ b^{-n} \oint \frac{dz}{2\pi i z}z^n E_{k_1} \begin{bmatrix}
  	+1 \\ z a/b
	\end{bmatrix}
	E_{k_2} \begin{bmatrix}
  	+1 \\ z
	\end{bmatrix} \nonumber \\
	= & \ a^{-n} \oint \frac{dz}{2\pi i z}z^n E_{k_1} \begin{bmatrix}
  	+1 \\ z
	\end{bmatrix}
	E_{k_2} \begin{bmatrix}
  	+1 \\ z b/a
	\end{bmatrix} \ .
\end{align}
The other integration formula variants of (\ref{integration-formula-zEE-1}), (\ref{integration-formula-zEE-2}) of involving $E_k \big[\substack{- 1\\za}\big]$, $E_k \big[\substack{- 1\\zb}\big]$ can be straightforwardly derived using the shift property (\ref{Eisenstein-half-shift}). For example, solving the system of equations
\begin{align}
	q^{- \frac{n}{2}}
	\oint \frac{dz}{2\pi i z}z^n E_{k_1} \begin{bmatrix}
  	+ 1 \\ z
	\end{bmatrix}
	E_{k_2} \begin{bmatrix}
  	+ 1 \\ z
	\end{bmatrix}
	= \sum_{\ell_1 = 0}^{k_1}
	\sum_{\ell_2 = 0}^{k_2} \frac{1}{2^{\ell_1 + \ell_2}} \frac{1}{\ell_1! \ell_2!} \oint \frac{dz}{2\pi i z}
	\prod_{i = 1}^2E_{k_i - \ell_i}\begin{bmatrix}
  	-1 \\ z  
	\end{bmatrix} \ ,
\end{align}
produces the integration formula for $z^n E_{1 \le \ell_1 \le k_1}\big[\substack{-1\\ z}\big] E_{1 \le \ell_2 \le k_2}\big[\substack{-1\\ z}\big]$ in terms of a linear combination of the known results for $z^n E_{1 \le \ell_1 \le k_i}\big[\substack{-1\\ z}\big]$ and $z^n E_{1 \le \ell_1 \le k_1}\big[\substack{+1\\ z}\big] E_{1 \le \ell_2 \le k_2}\big[\substack{+1\\ z}\big]$. 



Combining the above results, one can write down integration formula for $m \in \mathbb{Z}_{\ne 0}$
\begin{align}\label{integration-formula-zfE}
	\oint \frac{dz}{2\pi i z} z^m f(\mathfrak{z}) E_k \begin{bmatrix}
		\pm 1 \\ za
	\end{bmatrix}
	= & \ \left[\oint \frac{dz}{2\pi i z} f(\mathfrak{z})\right]\oint \frac{dz}{2\pi i z}z^m E_k \begin{bmatrix}
  	\pm 1 \\ za  
	\end{bmatrix} \nonumber\\
	& \ - \sum_{\operatorname{real/img} \ \mathfrak{z}_j}R_j
		\oint \frac{dz}{2\pi i z}
		z^m
		E_1 \begin{bmatrix}
  		- 1 \\ \frac{z_j}{z} q^{\pm\frac{1}{2}} 
		\end{bmatrix}E_k \begin{bmatrix}
  		\pm 1 \\ za  
		\end{bmatrix} \ ,
\end{align}
which follows easily from the decomposition
\begin{align}
	f(\mathfrak{z}) = f(\mathfrak{z}_0) + \sum_{\text{real/img} \ \mathfrak{z}_j} R_j \left(
			E_1 \begin{bmatrix}
	    	- 1 \\ \frac{z_j}{z_0} q^{\pm\frac{1}{2}}
			\end{bmatrix}
			- E_1 \begin{bmatrix}
	    	- 1 \\ \frac{z_j}{z} q^{\pm\frac{1}{2}}
			\end{bmatrix}
		\right) \ .
\end{align}





\subsubsection{Elliptic functions and monomial}

We proceed with the first integral by recalling that
\begin{align}
	f(\mathfrak{z})
	= C_f(\tau) + \frac{1}{2\pi i}\sum_{j}R_j\zeta (\mathfrak{z} - \mathfrak{z}_j) \ ,
\end{align}
where $\zeta$ can be expanded in Fourier series,
\begin{align}
	\zeta(\mathfrak{z}) = - 4\pi^2 \mathfrak{z} E_2(\tau) - (2m + 1)\pi i
	+ \pi \sum_{n}' \frac{1}{\sin n \pi \tau}q^{- \frac{n}{2}} e^{2\pi i n(\mathfrak{z}_0 + \lambda \tau)},
\end{align}
for $\mathfrak{z} = \mathfrak{z}_0 + \lambda \tau + m \tau$, $\lambda \in [0,1)$ and $m \in \mathbb{Z}$. The integral in the presence of $z^n$ with $n \ne 0$ can be carried out easily, which gives
\begin{align}\label{integration-formula-monomial}
	\oint \frac{dz}{2\pi i z} z^n f(\mathfrak{z})
	= & \ - \sum_{\text{real} \ \mathfrak{z}_j} R_j \frac{1}{1 - q^{-n}} z_j^n - \sum_{\text{imag.}\ \mathfrak{z}_j}R_j \frac{1}{q^n - 1}z_j^n  \nonumber\\
	= & \  - \sum_{\text{real/img.} \ \mathfrak{z}_j} R_j \frac{(z_j q^{\pm\frac{1}{2}})^n}{q^{n/2} - q^{-n/2}} \ .
\end{align}
Summing over $n$ with suitable coefficients, we further obtain some useful formula. For example,
\begin{align}
	\oint \frac{dz}{2\pi i z}\sum_{n \in \mathbb{Z}}' z^nf(\mathfrak{z})
	= - \sum_{\text{real/img } \mathfrak{z}_j} R_j E_1 \begin{bmatrix}
  	-1 \\ z_jq^{\pm \frac{1}{2}}  
	\end{bmatrix} \ .
\end{align}
This is simply a special case of (\ref{integration-formula-f}), since
\begin{align}
	f(z = 1) = \oint \frac{dz}{2\pi i z} \delta(z)f(\mathfrak{z}) 
	= \oint \frac{dz}{2\pi i z} (1 + \sum_{n}' z^n)f(\mathfrak{z}) \ .
\end{align}
Also, for $n \in \mathbb{N}$,
\begin{align}
	\oint{\frac{dz}{2\pi iz}\frac{\left( q-1 \right) z}{\left( 1-z \right) \left( 1-qz \right)}f\left( \mathfrak{z} \right)}
	= & \ - \sum_{\text{real } \mathfrak{z}_j}{R_j\frac{qz_j}{1-qz_j}}
	  -\sum_{\text{img } \mathfrak{z}_j}{R_j\frac{z_j}{1-z_j}} \\
	= & \ - \sum_{\text{real } \mathfrak{z}_j}{R_j\frac{1}{1-qz_j}}
	  -\sum_{\text{img } \mathfrak{z}_j}{R_j\frac{1}{1-z_j}} \ ,\\
	\oint \frac{dz}{2\pi i z} \frac{1}{(1-z^p)(1 - \frac{1}{z^p})} z^n f(\mathfrak{z})
	= & \ \sum_{\text{real/img } \mathfrak{z}_j} R_j (z_jq^{\pm \frac{1}{2}})^n  \sum_{\substack{k \ge 0 \\ k + n \ne 0}} \frac{k(z_j q^{\pm \frac{1}{2}})^{pk}}{q^{\frac{pk + n}{2}} - q^{- \frac{pk + n}{2}}} \\
	& + \frac{n}{p} \delta_{\frac{n}{p} \in \mathbb{Z}_{< 0}}\oint \frac{dz}{2\pi i z} f(\mathfrak{z}) \ .
\end{align}
When $z$ is the $SU(2)$ fugacity, then we have with the insertion of a spin-$J$ character $\chi_J(z) \coloneqq \sum_{m = -J}^{J}z^{2m}$,
\begin{align}\label{integration-formula-Ï‡f}
	\oint \frac{dz}{2\pi i z} & \ \chi_{J}(z) f(\mathfrak{z}) \nonumber\\
	= & \ \delta_{J \in \mathbb{Z}} \oint \frac{dz}{2\pi i z}f(\mathfrak{z})
	- \sum_{\substack{m = -J\\ m\ne 0}}^{+J}
	\left(
		\sum_{\text{real} \ \mathfrak{z}_j}R_j  \frac{1}{1 - q^{-2m}}z_j^{2m}
		+ \sum_{\text{img} \ \mathfrak{z}_j}R_j \frac{1}{q^{2m} - 1}z_j^{2m}
	\right) \ ,
\end{align}
and
\begin{align}
	\oint \frac{dz}{2\pi i z}\frac{\chi_J(z)}{(1-z^p)(1-1/z^p)}f(\mathfrak{z})
	= & \ \sum_{m = -J}^{J}
				\sum_{\text{real/img } \mathfrak{z}_j}R_j(z_jq^{\pm \frac{1}{2}})^{2m}
				\sum_{\substack{k \ge 0 \\ pk + 2m \ne 0}} \frac{k(z_j q^{\pm \frac{1}{2}})^{pk}}{q^{\frac{pk+2m}{2}} - q^{- \frac{pk+2m}{2}}} \nonumber \\
	& \ + \left[\sum_{m = - J}^{+J} \frac{2m}{p}\delta_{\frac{2m}{p} \in \mathbb{Z}_{< 0}}\right] \oint \frac{dz}{2\pi i z}f(\mathfrak{z}) \ .
\end{align}
Note that for $p = 1$, $J \in\frac{1}{2} \mathbb{N}$, $\sum_{m = -J}^{+J}2m \delta_{2m < 0} = \lceil J \rceil (\lceil J \rceil - 2J - 1) = - \lfloor(J + \frac{1}{2})^2\rfloor$.










