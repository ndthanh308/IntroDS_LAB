\documentclass[reprint,superscriptaddress,amsmath,amssymb,aps,prl]{revtex4-2}

\usepackage{graphicx}
\usepackage{dcolumn}
\usepackage{bm}
\usepackage{physics}
\usepackage{subcaption}
\usepackage{xcolor}

\usepackage{hyperref} 
\hypersetup{colorlinks, allcolors=black}

\makeatletter
\newcommand\footnoteref[1]{\protected@xdef\@thefnmark{\ref{#1}}\@footnotemark}
\makeatother

\begin{document}

\preprint{APS/123-QED}

\title{Spectroscopy and topological properties of a Haldane light system}


\author{Julian Legendre}
%\email{julian.legendre@uni.lu}
\affiliation{Department of Physics and Materials Science, University of Luxembourg, L-1511, Luxembourg}
\affiliation{CPHT, CNRS, Institut Polytechnique de Paris, Route de Saclay, 91128 Palaiseau, France}
\author{Karyn Le Hur}
 %\email{karyn.le-hur@polytechnique.edu}
\affiliation{CPHT, CNRS, Institut Polytechnique de Paris, Route de Saclay, 91128 Palaiseau, France}

%\date{\today}

\begin{abstract}

We present a method to probe the topological properties of a circuit quantum electrodynamics (cQED) array described through a Haldane model on the honeycomb lattice. We develop the theory of microwave light propagating in a local probe or a microscope (a one-dimensional transmission line) capacitively coupled to the topological cQED lattice model. Interestingly, we show that even if the microwave light has no transverse polarization, the measured reflection coefficient, resolved in frequency through the resonance, allows us to reveal the geometrical properties and topological phase transition associated to the model. This spectroscopy tool developed for cQED lattice models reveals the same topological information as circularly polarized light, locally within the Brillouin zone of the honeycomb lattice. Furthermore, our findings hold significance for topological magnon systems and are \textit{a priori} applicable to all Chern insulators, presenting an intriguing opportunity for their adaptation to other systems with different particle statistics.
\end{abstract}

\maketitle

\paragraph*{Introduction.---} Topological systems find various interesting applications in physics, in particular related to the protected mesoscopic transport at the edges. In two dimensions, the quantum Hall effect, induced by a perpendicular uniform magnetic field, has been generalized to situations with no net flux in a unit cell, referring to 
the Haldane honeycomb lattice model \cite{Haldane88}, and then generally to the quantum anomalous Hall effect and Chern insulators. The Haldane's seminal model is realized in solid-state systems, in cold atom gases and in photonic systems (coupled waveguides) \cite{Chang13,Rechtsman13,Jotzu14}. One elegant way to realize this model for artificial systems is through Floquet engineering \cite{Takashi09,Rechtsman13,Jotzu14,Zheng14,Eckardt15,Plekhanov17}.

The most common way to probe the topological properties in condensed matter systems is to determine the Hall conductance \cite{Klitzing80,Chang22}. 
The topological responses of artificial systems are accessible in several ways \cite{Goldman16,Cooper19,LuJ14,OzawaPrice19}.
In cold atom gases, topological properties are revealed through transport or Hall drift \cite{Jotzu14,Aidelsburger15}, interferometry
\cite{Atala13,Duca15,TracyLi16}, the physics of chiral edge states \cite{Stuhl15,Mancini15} or via a measurement of the Berry curvature \cite{Flaschner16}.
For condensed matter systems and cold atom gases, a circular drive on the system also enables to probe the topological information \cite{Mciver12,Juan17,Tran17,Asteria19,Rees20}, even with a local resolution within the Brillouin zone \cite{KleinP21,HurK22}.
Topological properties of light systems have also attracted attention such as gyromagnetic photonic crystals \cite{Haldane08,Raghu08,WangChong08,WangChong09}, arrays of coupled waveguides \cite{Rechtsman13,Mukherjee17,Maczewsky17}, optomechanical systems \cite{Fleury14,Kim17}, cavity and circuit quantum electrodynamics (cQED) \cite{Koch10,Anderson16,Owens18,Hur16,GuKockum17,Roushan17}. 

In Ref.~\cite{Goren18}, a protocol to probe the topological properties of a one-dimensional LC circuit system is proposed. This system is closely connected to the SSH model which has been implemented recently \cite{Rosenthal18,Poli15,Meier16,StJean17}. In Ref.~\cite{Goren18}, the authors considered a transmission line (capacitively) coupled to a single cell within the chain. From the reflection of an input triggered in the probe, they reconstructed the Zak phase, which is the topological invariant characterizing the studied one-dimensional system. 
The extension of such a local capacitive probe to two-dimensional systems is not readily apparent. Previous proposals for light-matter topological probes in two-dimensional systems have used the transverse polarization of light to detect the chirality associated with the system's topological nature \cite{Mciver12,Tran17}. In striking contrast to these approaches, our study focuses on a local probe, specifically a long transmission line capacitively coupled to a Haldane bosonic model in circuit quantum electrodynamics (cQED). Remarkably, we demonstrate how the Chern number can be measured by analyzing the reflection coefficient, which relates the input and output voltage signals.

\paragraph*{Bosonic Haldane model.---}We introduce a cQED system made of an array of resonators coupled together in such a way \cite{Plekhanov17} that the system is described by a usual Haldane Hamiltonian $H= \sum_{{\bf k}} \Psi_{{\bf k}}^\dagger h_{{\bf k}} \Psi_{{\bf k}}$ \cite{Haldane88,Chang13,Rechtsman13,Jotzu14,Takashi09,Zheng14,Eckardt15}, with
\begin{equation} \label{eq:hk}
h_{{\bf k}} = h_0({\bf k})   + \textrm{Re}\left[h_1({\bf k}) \right]\sigma_x -\textrm{Im}\left[h_1({\bf k}) \right] \sigma_y + h_2({\bf k})  \sigma_z,
\end{equation}
and with $h_0({\bf k}) = \hbar \Omega_0  + 2 t_2 \cos \phi \sum_{i =1}^3 \cos ({\bf k} \cdot {\bf b}_i)$, $h_1({\bf k}) = t_1 \sum_{i =1}^3 \exp (-i {\bf k} \cdot {\bf a}_i)$, and $h_2({\bf k}) = M- 2 t_2 \sin \phi \sum_{i =1}^3 \sin ({\bf k} \cdot {\bf b}_i)$. We define $\Psi_{{\bf k}}^\dagger = \left(a_{1,{\bf k}}^\dagger, a_{2,{\bf k}}^\dagger\right)$, with $a^{\dagger}_{j,{\bf k}}$ the creation operator for a color-$j$ (say $j=1(2)$ correspond to the lattice site A(B) appearing in Fig.~\ref{fig1}(a)) boson with momentum ${\bf k}$, ${\bf a}_i, \, i \in \{1,2,3\}$ and ${\bf b}_i, \, i \in \{1,2,3\}$ are defined in Fig.~\ref{fig1}(a), hopping amplitudes $t_1 \in \mathbb{R}$ and $t_2 \in \mathbb{R}$, Semenoff mass $M  \in \mathbb{R}$ \cite{Semenoff84} and $\sigma^{x},\sigma^{y},\sigma^{z}$ the Pauli matrices in sub-lattice space. 
Hereafter, we study the case where $t_2$ is small compared to $t_1$, as it is often the situation in physical systems. In Ref.~\cite{Plekhanov17}, a Haldane effective Hamiltonian is derived from Floquet engineering with a high-frequency approximation.
Such a photonic system is permanently driven to compensate for the photon decay processes that necessarily happen \cite{OzawaPrice19}. In typical photonic systems
the on-site energy $\hbar\Omega_0$ is large (usually $\sim$ GHz order of magnitude) compared to the effective hopping amplitudes on the lattice (\textit{e.g.} can be $\sim 10$ MHz to $\sim 100$ MHz) \cite{Koch10,Underwood12,Hartmann16,Roushan17}.

The Haldane model is characterized by two energy bands in momentum space $E_{i,{\bf k}} = h_0({\bf k}) \pm  \epsilon({\bf k})$ where the minus (plus) sign is associated to the band $i=1$ ($i=2$) and with $\epsilon({\bf k}) = \sqrt{|h_1({\bf k})|^2+h_2({\bf k})^2}$.
Band crossing appears at $h_1({\bf k}) = h_2({\bf k}) = 0$. $h_1({\bf k}) =0$ is reached at both nonequivalent Dirac points ${\bf K} = \left({\bf g}_3-{\bf g}_2\right)/3$ and ${\bf K}'=\left({\bf g}_2-{\bf g}_3\right)/3$ (see Fig.~\ref{fig1}(c)). Moreover, we have $h_2({\bf K}) = 0$ if $M = + 3 \sqrt{3}  t_2 \sin \phi$ and $h_2({\bf K}') = 0$ if $M = - 3 \sqrt{3}  t_2  \sin \phi$. When the bands cross, the dispersion relation around ${\bf K}$ and ${\bf K}'$ is linear. The energies for a chosen point in parameter space are represented in Fig.~\ref{fig1}(b).

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Figure environment removed
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\paragraph*{Topological properties.---} 
Following the approach of Kohmoto \cite{Kohmoto85}, we will write the Chern number $C_i$ (energy band $i=1$ or $i =2$) in terms of a phase entering in the wavefunction, which is associated to the definition of the $h_1({\bf k})$ kinetic term only. This will elegantly allow us to show that the light probe can detect the topological response of the system locally within the Brillouin zone through the conservation of energy. 


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{table}[b]
\caption{\label{tab:sgnh2}Sign of $h_2$ at the Dirac points, as a function of $M$ and $\textrm{sgn}(\sin \phi)$.}
\begin{ruledtabular}
\begin{tabular}{ccc}
& $|M|<3 \sqrt{3} t_2 |\sin \phi|$ & $|M|>3 \sqrt{3} t_2 |\sin \phi|$ \\
\colrule
$\textrm{sgn} \, h_2({\bf K})$ & $-\textrm{sgn}(\sin \phi)$ 
&  $\textrm{sgn} \, M$\\
$\textrm{sgn} \, h_2({\bf K}')$ &  $\textrm{sgn}(\sin \phi)$  &  $\textrm{sgn} \, M$  \\
\end{tabular}
\end{ruledtabular}
\end{table}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

We write $
\ket{u_{i,{\bf k}}}$ the Bloch eigenvectors of the Haldane Hamiltonian, \textit{i.e.} $\textrm{e}^{-i {\bf k} \cdot \hat{{\bf r}}} H   \textrm{e}^{i {\bf k} \cdot \hat{{\bf r}}} \ket{ u_{i,{\bf k}}} = E_{i,{\bf k}} \ket{ u_{i,{\bf k}}}$ and we define the coefficients $\alpha_{i }^{1}({\bf k})$ and $\alpha_{i }^{2}({\bf k})$ such that $
\ket{u_{i,{\bf k}}} = \left[\alpha_{i}^{1}({\bf k}) a_{1,{\bf k}}^{\dagger} + \alpha_{i}^{2}({\bf k}) a_{2,{\bf k}}^{\dagger} \right] \ket{0}
$. These coefficients may vanish only at the Dirac points. 
 
(i)  If the sign of $h_2$ is opposite at the Dirac points ($|M|< 3 \sqrt{3} t_2 |\sin \phi|$, see Table~\ref{tab:sgnh2}), then $\alpha_{i }^{1}({\bf k})$ and $\alpha_{i }^{2}({\bf k})$ vanish at the opposite Dirac points. It follows that it is impossible to find a unique and smooth phase  over all the BZ for the Bloch state $\ket{u_{i,{\bf k}}}$. 
Rather, we choose to define two non-overlapping domains $\mathcal{D}_I$ and $\mathcal{D}_{II}$ in the BZ, each containing a different Dirac point (see Fig.~\ref{fig1}(c)), and we use a different gauge choice for the Bloch states in each domain \cite{Kohmoto85}.
We define a closed path P along the boundary between $\mathcal{D}_I$ and $\mathcal{D}_{II}$, surrounding once the Dirac points,  
and a smooth phase along P, $\varphi({\bf k})$, such that $\textrm{e}^{-i \varphi({\bf k})}= \left. \textrm{e}^{i {\bf k} \cdot {\bf a}_3} h_1({\bf k})^* \right/ |h_1({\bf k})|$. Then $C_{i}$
reads \footnote{See Supplementary Material \ref{app:Haldane} for Chern number computation details using Kohmoto's approach.} 
\begin{equation}
2 \pi C_{i} =(-1)^{i} \,\textrm{sgn}( \sin \phi ) \oint_{\textrm{P}} d{\bf k} \cdot {\bf \nabla}_{{\bf k}} \varphi ({\bf k}).
\end{equation}
From the expressions of $\varphi ({\bf k})$ and $h_1({\bf k})$, we find that $\varphi ({\bf k})$ changes by $-2 \pi$ when moving along the entire closed path P. This gives $C_{i} =(-1)^{i+1} \, \textrm{sgn}( \sin \phi )$. Let us remark that the vanishing of Bloch eigenvectors' components at different points in the BZ, which prevents the smooth definition of Bloch states, is a characteristic feature of Chern insulators. As we will see, this fundamental property forms the basis of the probe proposed in this letter, rendering it \textit{a priori} relevant for all Chern insulators.

(ii) If the sign of $h_2$ is the same at both Dirac points ($|M|> 3 \sqrt{3} t_2 |\sin \phi|$, see Table~\ref{tab:sgnh2}), then $\alpha_{i }^{1}({\bf k})$ or $\alpha_{i }^{2}({\bf k})$ can be chosen non-zero over all the BZ, and it is possible to find a unique and smooth phase for $\ket{u_{i,{\bf k}}}$, leading to a unique and smooth Berry gauge field. Because the BZ is a torus, we find that the Chern numbers $C_i$ are vanishing.

From this analysis, for $|M| \neq 3 \sqrt{3} t_2 |\sin \phi|$, 
we find  $C_i = (-1)^{i+1} \, \textrm{sgn}( \sin \phi ) \left[1- \textrm{sgn}( h_2({\bf K}) h_2({\bf K}')\right]/2$, \textit{i.e.} 
\begin{equation} \label{eq:chnumber}
    C_i = \dfrac{(-1)^{i}}{2}  \left[\textrm{sgn} \, h_2({\bf K}) - \textrm{sgn} \, h_2({\bf K}') \right].
\end{equation}
This formula has in fact a simple physical understanding for a Hamiltonian $h_{\bf k}$ written as a $2\times 2$ matrix. From the Ehrenfest theorem and a Bloch sphere correspondence the topological number is equivalent to
$C_i = (-1)^{i} \left[\langle \sigma_z(0)\rangle - \langle \sigma_z(\pi)\rangle\right]/2$ with $\langle \sigma_z\rangle=(-1)^i\cos\theta=(-1)^i\hbox{sgn} \, h_2(\theta)$ \cite{KLHreview}. 
In the following, we namely rely on Eq.~\eqref{eq:chnumber} to show how $C_i$ can be probed from the reflected light in a local probe capacitively coupled to a Haldane photonic system.
The simple idea behind our proposal is that the topological properties manifest as discernible sublattice weight variations of the wave function, 
enabling to reveal the topological transition through the coupling of a probe to one of the sublattice sites. 

\paragraph*{Spectroscopic probe.---}
Let us consider
a local light probe with weak capacitive coupling to a Haldane boson model. 
The probe is a resonator with a certain number of (relevant) modes, each mode $q$ being characterized by the frequency $\omega_q$. The probe is coupled to the system at position ${\bf R}_0$, on the sublattice identified by the index $j_0$, where $j_0 = 1$ ($j_0 = 2$) for the sublattice A (B). We write the Hamiltonian associated to the probe $
H_{\textrm{prb}} =\sum_q \hbar \omega_q b_{q}^\dagger b_{q}$,
with $b_{q}$ the annihilation operators for the mode $q$ of the probe.
The coupling is described by $H_{\textrm{cpl}} = \left( a_{{\bf R}_0}+ a_{{\bf R}_0}^\dagger \right)\sum_q g_q \left( b_{q}+ b_{q}^\dagger  \right)$,
with $ a_{{\bf R}_0}^\dagger$ the creation operator for a boson at site ${\bf R}_0$. For simplicity, first of all, we disregard the dissipation effects induced by the probe in the Chern insulator and we assume that the light modes $\ket{u_{i,{\bf k}}}$ exhibit an infinitely long lifetime.  

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{table}
\caption{\label{tab:Cherncoef}Coefficients $\alpha_{i }^{j_0}$ which, at the Dirac points, are directly related to the Chern number, as a function of $\textrm{sgn} \, M$ and $\textrm{sgn}(\sin \phi)$.}
\begin{tabular}{ccc}
\hline
\hline
& $\textrm{sgn} \, M=\textrm{sgn}\left(\sin \phi \right) $ & $\textrm{sgn} \, M=-\textrm{sgn}\left(\sin \phi \right)$ \\
\hline \noalign{\smallskip}
$\textrm{sgn}\left(\sin \phi \right)=(-1)^i$ & $ \alpha_{i}^2(\boldsymbol{K}) = - C_i$ 
&  $\alpha_{i}^1(\boldsymbol{K}') = (-1)^{i+1} C_i$\\
\noalign{\smallskip}
$\textrm{sgn}\left(\sin \phi \right)=(-1)^{i+1}$ & $\alpha_{i}^1(\boldsymbol{K}) = (-1)^{i} C_i$ 
&  $\alpha_{i}^2(\boldsymbol{K}') = C_i$\\
\hline
\hline
\end{tabular}
\end{table}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{table}
\caption{\label{tab:Cherncoef1}Choice of the probe's input frequency $\hbar \omega_{q_0} =E_{i,{\bf k}}$, given by the indices $i$ and ${\bf k}$, as a function of $\textrm{sgn} \, M$ and $\textrm{sgn}\left(\sin \phi \right)$, such that the transition rate depends on the Chern number: $\Gamma = J\left[E_{i,{\bf k}}\right] |C_i |/\hbar$.}
\begin{tabular}{ccc}
\hline
\hline
& $\textrm{sgn} \, M=\textrm{sgn}\left(\sin \phi \right) $ & $\textrm{sgn} \, M=-\textrm{sgn}\left(\sin \phi \right)$ \\
\hline \noalign{\smallskip}
$\textrm{sgn}\left(\sin \phi \right)=1$ & $i = j_0$, ${\bf k} = {\bf K} $ 
&  $i = \overline{j_0}$, ${\bf k} = {\bf K}' $\\
\noalign{\smallskip}
$\textrm{sgn}\left(\sin \phi \right)=-1$ & $i = \overline{j_0}$, ${\bf k} = {\bf K} $ 
&  $i = j_0$, ${\bf k} = {\bf K}' $\\
\hline
\hline
\end{tabular}
\end{table}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

To build intuition, let us show that the transition rate $\Gamma$ from a state $\ket{\psi(t)}$ which, at initial time $t_i$, is a probe's mode with frequency
$\omega_{q_0}$, \textit{i.e.} $\ket{\psi(t_i)} = \ket{b_{q_0}}$, to the eigenstates $\ket{u_{i,{\bf k}}}$ of the Haldane Hamiltonian's bears information about the topological character of the system. 
Fermi Golden rule states that at sufficiently long times $t$, 
$\Gamma \left[\hbar \omega_{q_0} \right] = \dfrac{2 \pi}{\hbar} \sum_{i,{\bf k}} |\bra{b_{{q_0}}} H_{\textrm{cpl}} \ket{u_{i,{\bf k}}}|^2 \delta\left( \hbar \omega_{q_0} - E_{i,{\bf k}}\right)$. $\bra{b_{{q_0}}} H_{\textrm{cpl}} \ket{u_{i,{\bf k}}}$ involves the components of the Bloch state in the basis
$\left( a_{1,{\bf k}}^{\dagger} , a_{2,{\bf k}}^{\dagger} \right)$ and a factor $\textrm{e}^{i {\bf k} \cdot {\bf R}_0}$ (transformation to the real space representation), such that we obtain 
$\bra{b_{{q_0}}} H_{\textrm{cpl}} \ket{u_{i,{\bf k}}} = g_{q_0} \alpha_{i }^{j_0}({\bf k})  \textrm{e}^{i {\bf k} \cdot {\bf R}_0}$.  
As one can see from Table~\ref{tab:Cherncoef}, which is constructed using Eq.~\eqref{eq:chnumber} and the related analysis of the coefficients $\alpha_{i }^{j_0}({\bf k})$, depending on $\textrm{sgn} \, M$ and $\textrm{sgn}\left(\sin \phi \right)$, it is possible to express the Chern number as a function of the coefficients $\alpha_{i }^{j_0}({\bf k})$. If $\textrm{sgn} \, M=\textrm{sgn}\left(\sin \phi \right) $ ($\textrm{sgn} \, M=-\textrm{sgn}\left(\sin \phi \right) $) we notice that the Chern number is directly related to the coefficients $\alpha_{i }^{j_0}({\bf k})$ evaluated at $\boldsymbol{K}$ ($\boldsymbol{K}'$) and $E_{i,\boldsymbol{K}}$ ($E_{i,\boldsymbol{K}'}$), $ i \in \{1,2\}$, is non-degenerate.
Therefore, 
choosing $\hbar \omega_{q_0} =E_{i,{\bf k}}$ with $i$ and ${\bf k}$ according to Table~\ref{tab:Cherncoef1}, we find a simple relation between $\Gamma$ and the topological invariant: $\Gamma\left[E_{i,{\bf k}}\right] = J\left[E_{i,{\bf k}}\right] |C_i |^2 =J\left[E_{i,{\bf k}}\right]  |C_i |$, where the spectral function $J$ is: $J[\omega] = (2 \pi/\hbar) \sum_q g_q^2 \left[ \delta(\omega - \omega_q) -  \delta(\omega + \omega_q) \right]$. In other words, 
\begin{equation} \label{eq:gamma}
    \Gamma \left[E_{i,{\bf k}}\right] = J\left[E_{i,{\bf k}}\right] |C_i |,
\end{equation}
where the indices $i$ and ${\bf k}$ are functions of $\textrm{sgn} \, M$ and $\textrm{sgn}\left(\sin \phi \right)$ as indicated in Table~\ref{tab:Cherncoef1}. The relation appearing in Eq.~\eqref{eq:gamma} has been established from Table~\ref{tab:Cherncoef} and Table~\ref{tab:Cherncoef1}, which are constructed from the previous section. 
Therefore, Eq.~\eqref{eq:gamma} relies on a fundamental property characterizing a Chern insulator: the impossibility of defining smooth Bloch states over the BZ, which translates here into the vanishing of the Bloch eigenvectors' components $\alpha_{i }^{1}$ and $\alpha_{i }^{2}$ at the opposite Dirac points.

Motivated by this, 
we now investigate the relation between an input voltage $ \langle V_{{\bf R}_0}^{\textrm{in}}[\omega] \rangle$ and the resulting output voltage $\langle V_{{\bf R}_0}^{\textrm{out}}[\omega] \rangle$, both at frequency $\omega$ in the probe at ${\bf R}_0$. 
For $\omega$ resolved around one Dirac point, this relation between $\langle V_{{\bf R}_0}^{\textrm{in}}[\omega] \rangle$ and $\langle V_{{\bf R}_0}^{\textrm{out}}[\omega] \rangle$ enables to rebuild the Haldane topological phase diagram
\footnote{For explicit definitions and demonstrations we refer to the Supplemental material \ref{app:inputoutput}.}. To fourth order in the coupling amplitudes $\{g_q\}$, we indeed find
\begin{equation} \label{eq:hzfjzd}
\langle V_{{\bf R}_0}^{\textrm{out}}[\omega] \rangle= R(\omega) \langle V_{{\bf R}_0}^{\textrm{in}}[\omega] \rangle ,
\end{equation}
with $R(\omega) = 1 +i  J[\omega]   \chi_{{\bf R}_0,{\bf R}_0} $,
and
\begin{widetext}
\begin{equation} \label{eq:xi}
\chi_{{\bf R}_0,{\bf R}_0} = \dfrac{1}{ N} \sum_{i=1}^2 \sum_{{\bf k} } \gamma_{j_0,{\bf k}}^{i} \left[ \dfrac{1}{- \hbar \omega - E_{i,{\bf k}} + i 0^+} - \dfrac{1}{-\hbar \omega + E_{i,{\bf k}} + i 0^+} \right],
\end{equation}
\end{widetext}
where $N$ is the number of lattice sites
and 
\begin{equation} \label{eq:zfregtbrij}
\gamma_{j_0,{\bf k}}^{i} = \dfrac{1}{2}+\dfrac{(-1)^{j_0+i+1} h_2({\bf k})}{2 \epsilon({\bf k})} \in \, \mathbb{R}.
\end{equation}
From $\epsilon({\bf k}) = \sqrt{|h_1({\bf k})|^2+h_2({\bf k})^2}$, we notice that $\gamma_{j_0,{\bf k}}^{i}$ 
evaluated at the Dirac points depends on the sign of the function $h_2$: we have $2 \gamma_{j_0,{\bf k}}^{i} = 1 - (-1)^{j_0+i} \textrm{sgn} \, h_2({\bf k}) $ for ${\bf k} = \{{\bf K}, {\bf K}'\}$. This is related to the topological invariant via the Eq.~\eqref{eq:chnumber} and Table~\ref{tab:sgnh2}. As we show in Table~\ref{tab:alphabeta}, depending on the sign of $\sin \phi $ and on the sign of the Semenoff mass, the $i^{\textrm{th}}$ band topological invariant is given by the coefficient $\gamma_{j_0,{\bf k}}^{i}$, evaluated at $j_0 =i$ or $j_0 =\overline{i}$ and at ${\bf k} = {\bf K}$ or ${\bf k} = {\bf K}'$, with $\overline{i} = 2(1)$ if $i=1(2)$. Again, this outcome is obtained thanks to a fundamental characteristic associated to the topological phase: the vanishing of the Bloch eigenvectors' components $\alpha_{i }^{1}$ and $\alpha_{i }^{2}$ at the opposite Dirac points. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{table}[b]
\caption{\label{tab:alphabeta} Value of $\gamma_{j_0,{\bf k}}^{i}$, evaluated at $j_0 =i$ or $j_0 =\overline{i}$ and at ${\bf k} = {\bf K}$ or ${\bf k} = {\bf K}'$, as a function of $\textrm{sgn}\left(\sin \phi \right)$ and $\textrm{sgn} \, M$. We remind that $\overline{i} = 2(1)$ if $i=1(2)$.}
\begin{ruledtabular}
\begin{tabular}{ccc}
& $\textrm{sgn} \, M=\textrm{sgn}\left(\sin \phi \right) $ & $\textrm{sgn} \, M=-\textrm{sgn}\left(\sin \phi \right)$ \\
\colrule \noalign{\smallskip}
$\textrm{sgn}\left(\sin \phi \right)=1$ & $ \gamma_{i,\boldsymbol{K}}^i = (-1)^{\overline{i}} C_i$ 
&  $\gamma_{\overline{i},\boldsymbol{K}'}^{i} = (-1)^{\overline{i}} C_i$\\
\noalign{\smallskip}
$\textrm{sgn}\left(\sin \phi \right)=-1$ & $\gamma_{\overline{i},\boldsymbol{K}}^{i} = (-1)^{i} C_i$ 
&  $\gamma_{i,\boldsymbol{K}'}^i = (-1)^{i} C_i$\\
\end{tabular}
\end{ruledtabular}
\end{table}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Now, we can understand how a simple measurement of the reflection of a light input in the probe gives access to the topological invariant. 
We write $S^{\textrm{in}}(\omega)=\left| \langle V_{{\bf R}_0}^{\textrm{in}}[\omega] \rangle\right|^2$ and $S^{\textrm{out}}(\omega)=\left| \langle V_{{\bf R}_0}^{\textrm{out}}[\omega] \rangle\right|^2$ the energy spectral density respectively associated to the input and output voltages.
To leading order in the coupling amplitudes, we have $S^{\textrm{out}}(\omega) = | R(\omega) |^2 S^{\textrm{in}}(\omega)$ and for $\omega>0$,
\begin{equation}\label{eq:realRrrreaf}
  |R(\pm \omega) |^2 =  1 \mp \dfrac{2\pi J[\pm \omega]}{N}   \sum_{i=1}^2 \sum_{{\bf k} }  \gamma_{j_0,{\bf k}}^{i} \delta( \hbar \omega - E_{i,{\bf k}}).
\end{equation}
For $\textrm{sgn} \, M=\textrm{sgn}\left(\sin \phi \right) $, the energies $E_{i,\boldsymbol{K}}, \, i \in \{1,2\}$ are non-degenerate, therefore, choosing $\hbar \omega = E_{i,\boldsymbol{K}}$ selects only the ${\bf k} = {\bf K}$ point in the integral appearing in the Eq.~\eqref{eq:realRrrreaf}.  
Moreover, as indicated in Table~\ref{tab:alphabeta},
$\gamma_{j_0,{\bf K}}^{i}$ is related to the topological invariant if we choose a probe at $j_0=i$ ($\overline{i}$) for $\textrm{sgn}\left(\sin \phi \right)=1$ ($\textrm{sgn}\left(\sin \phi \right)=-1$). Therefore, for a well-chosen frequency $\omega$, $|R(\omega) |^2 $ clearly depends on the topological invariant.
This is also true for $\textrm{sgn} \, M=-\textrm{sgn}\left(\sin \phi \right) $, if, in the previous analysis, we replace ${\bf K}$ by ${\bf K}'$ and $j_0$ by $\overline{j_0}$. 

\paragraph*{Finite lifetimes for the light modes.---} Eventually, we address the more realistic scenario in which we incorporate finite lifetimes for both the modes in the probe $\ket{b_{q}}$ and the Chern insulator's modes $\ket{u_{i,{\bf k}}}$. For simplicity, we consider the same bandwidth amplitude $\Delta_{\textrm{CI}}$ ($\Delta_{\textrm{P}}$) for all the modes $\ket{u_{i,{\bf k}}}$ ($\ket{b_{q}}$). 
We assume the following ordering of the energies $\textrm{max}_q(g_q) \ll \{\Delta_{\textrm{CI}},\Delta_{\textrm{P}}\} \ll \{ t_1, \textrm{min}_{q,q'}(|\omega_{q}-\omega_{q'}|)\}$. 
We replace the Dirac Delta functions appearing in Eq.~\eqref{eq:realRrrreaf} by normalized Gaussian spectral distributions denoted $G\left(\omega;\overline{\omega},\Delta\right)$ with mean value $\overline{\omega}$ and standard deviation $\Delta$: 
$\delta( \hbar \omega - E_{i,{\bf k}})$ is replaced by $G\left(\omega;E_{i,{\bf k}}/\hbar, \Delta_{\textrm{CI}}\right)$ and 
$J[\omega]$ is replaced by $\tilde{J}[\omega] = 2 \pi \sum_q \left(g_q/\hbar\right)^2 \left[ G\left(\omega,\omega_q,\Delta_{\textrm{P}}\right)-  G\left(\omega,-\omega_q,\Delta_{\textrm{P}}\right) \right]$.
We also consider an input energy spectral density with Gaussian distribution: $S^{\textrm{in}}(\omega) = G\left(\omega;\omega_{q_0},\Delta_{\textrm{P}}\right) $. 
For a well chosen $\omega_{q_0}$ ($E_{i,\boldsymbol{K}}$ or $E_{i,\boldsymbol{K}}$), $|R(\omega) |^2 $ still depends on the topological invariant because $\gamma_{j_0,{\bf k}}^{i}$ is directly related to the Chern number.
To illustrate this point, let us consider the case $\textrm{sgn} \, M=\textrm{sgn}\left(\sin \phi \right) =1$ for which we choose $\hbar \omega_{q_0} = E_{1,\boldsymbol{K}}$ and $j_0=i=1$ and we expect $\gamma_{1,{\bf K}}^1 = C_1 $.  
$S^{\textrm{out}}(\omega)$ depends on $\gamma_{1,{\bf K}}^1 $, especially around $\omega=\omega_{q_0}$, leading to a decrease of the output peak's weight $\int d \omega S^{\textrm{out}}(\omega)$ compared to the normalized weight of the input peak. This decrease
is given by
\begin{equation} \label{eq:output}
  1-\int d \omega S^{\textrm{out}}(\omega) =  \dfrac{2\pi }{N}   \sum_{i=1}^2 \sum_{{\bf k} }  \gamma_{j_0,{\bf k}}^{i} I_{i,{\bf k}},
\end{equation}
with $I_{i,{\bf k}}=\int d \omega \tilde{J}[\omega] G\left(\omega;E_{i,{\bf k}}/\hbar, \Delta_{\textrm{CI}}\right) G\left(\omega;E_{1,{\bf K}}/\hbar,\Delta_{\textrm{P}}\right) $, which is $\left( g_{q_0}/\hbar\right)^2 /\left( \sqrt{2 \pi }\Delta_{\textrm{CI}} \Delta_{\textrm{P}}^2\right) $ times the overlap area $\int d\omega \, \textrm{exp}{- \dfrac{\left(\omega-E_{1,{\bf K}}/\hbar\right)^2}{ \Delta_{\textrm{P}}^2 } } \, \textrm{exp} {- \dfrac{\left(\omega-E_{i,{\bf k}}/\hbar\right)^2}{2 \Delta_{\textrm{CI}}^2 }}$ . 
$1-\int d \omega S^{\textrm{out}}(\omega)$ reproduces the topological phase diagram associated to the Haldane model,
as we show in Fig.~\ref{fig1}(d), from a numerical evaluation of Eq.~\eqref{eq:output}, with the energy scales $\Omega_0=10$ GHz, $t_1/\hbar=100$ MHz, $\Delta_{\textrm{CI}} = \Delta_{\textrm{P}} = 10$MHz and $g_{q_0}/\hbar=1$MHz. These scales corresponds to a relatively low quality factor $Q=\Omega_0/\Delta_{\textrm{CI}} =10^3$ (here the same for both the cQED Chern insulator and the probe) and a low coupling amplitude and should be reachable in a cQED experiment. 

\paragraph*{Magnon system and material suggestions.---} The results described here are directly relevant for other Chern insulator systems. For instance, our probe can be used for a topological magnon insulator, as the one proposed in Ref.~\cite{Owerre16}, which is described by a bosonic Haldane model. Indeed, consider a magnetic tip described by a polarization state denoted ${\bf s}=(s^x,s^y,s^z)$, and assume the tip thin enough to couple to only one magnetic site ${\bf S}_i$ of the system. The Hamiltonian coupling the tip to the magnon system is $H_{\textrm{cpl}} = J \, {\bf S}_i \cdot {\bf s}_i$, with $J$ the coupling amplitude. Suppose now the tip is polarized along $x$ only. Then $H_{\textrm{cpl}} = J \, {\bf S}_i \cdot {\bf s}_i = (J/4) (S_i^+ + S_i^-) (s^+ + s^-)$, where $S_i^+$, $S_i^-$, $s^+$ and $s^-$ are bosonic creation/annihilation operators. $H_{\textrm{cpl}}$ is completely analogue to the coupling Hamiltonian we considered for the cQED system. Therefore, measuring the response to a magnetic excitation provides a way to access the topological number. Such a measurement should be applicable in topological magnon quantum materials, such as CrI$_3$ \cite{Chen18} or maybe $\beta$-Cu$_2$V$_2$O$_7$ \cite{Tsirlin10}. Even though the magnon can condense at the lowest energy mode, thermal excitation shall generate magnon modes at all energies in the system, namely the ones required for the proposed probe, with energy around the Dirac point.

\paragraph{Remarks.---} Several observations are in order.

(i) Topological insulators are robust against weak disorder. Then we expect the general structure of the wave function over space, which is related to the bulk invariant, to be robust against disorder. This central feature give robustness to the probe proposed in this letter. 
In a magnon system, even though the disorder could be high compared to cQED systems, a magnetic tip enables to scan several sites in the sample; averaging the output signal over these sites would mitigate disorder effects. 


(ii) It is interesting to observe that the probe is able to measure the topological number based on a real space local coupling to the system and with a resolution in reciprocal space thanks to the energy conservation, similarly to circularly polarized light \cite{HurK22}. 

(iii) We checked the applicability of the probe proposed here to a simple topological bosonic kagome system.

(iv) From Eqs.~\eqref{eq:zfregtbrij} and \eqref{eq:realRrrreaf}, we notice that the energy density of states at $ \hbar \omega =E_{i,\boldsymbol{k}}$ can be evaluated by summing the local responses $1-\textrm{Re} \left[R(\omega) \right]$ measured separately in a probe at $j_0=1$ (sublattice A) and in a probe at $j_0=2$ (sublattice B).

(v) If the input is triggered at a site with position $ {\bf r} $ lying on the sublattice $j_0$ and the output is measured at a different site with position $ {\bf r}' $ and sublattice index $j_0'$ , the expression in the summation of Eq.~\eqref{eq:xi} is replaced by
\begin{equation} \label{eq:rq}
    \dfrac{\left[\beta_{j_0}^i({\bf k}) \alpha_{i}^{j_0'}({\bf k})\right]^* \textrm{e}^{i {\bf k}\left({\bf r}-{\bf r}'\right)}}{-\hbar \omega - E_{i,{\bf k}} + i 0^+} - \dfrac{\beta_{j_0}^i({\bf k}) \alpha_{i}^{j_0'}({\bf k}) \textrm{e}^{-i{\bf k} \left({\bf r}-{\bf r}'\right)}}{-\hbar \omega + E_{i,{\bf k}} + i 0^+} ,
\end{equation}
with $\beta_{j_0 }^{i}({\bf k}) \alpha_{i }^{j_0}({\bf k})=\gamma_{j_0,{\bf k}}^{i}$ and for $j_0' =\overline{j_0} \neq j_0$, $\beta_{j_0}^i({\bf k}) \alpha_{i}^{\overline{j_0}}({\bf k}) \propto h_1({\bf k}) / 2 \epsilon({\bf k})$.
At the Dirac points, $h_1$ is vanishing, therefore, in the case $j_0' =\overline{j_0}$, the simple protocol we sketched above does not help to rebuild the topological phase diagram. This outcome can be anticipated based on the fact that, at one given Dirac point, one of both Bloch eigenvectors' components vanish, in the topological regime. In the scenario $j_0' =j_0$,  because the coefficients in the numerator of Eq.~\eqref{eq:rq} are complex-valued, the Chern number dependency of $1-\int d \omega S^{\textrm{out}}(\omega)$ is mitigated. Indeed, the latter contains principal values of integrals over frequency involving $\left[1/\left(-\hbar \omega \pm E_{i,{\bf k}}\right)\right]$ terms.

\paragraph*{Conclusion.---} We have considered a local microwave-light probe with capacitive coupling to a cQED array described by a Haldane bosonic system, in the regime of small coupling amplitudes. We have explained how 
this probe is relevant for the detection of the topological character of Chern insulators. 
Firstly, using FGR, we established a connection between the Chern number and the transition rate from a probe's eigenstate (with frequency corresponding to one of the Dirac points energy) to the eigenstates of the Haldane Hamiltonian.
Secondly, we developed the input-output theory for the probe, enabling us to compute the reflection coefficient which relates an input voltage and an output voltage. We showed that for an input with frequency resolved at one of the Dirac points, this reflection coefficient is directly related to the system's topological invariant.
The fundamental working principle of this probe makes it inherently relevant for all Chern insulators. Additionally, as a future prospect, it appears both possible and intriguing to adapt this probe to other systems that may exhibit different particle statistics, such as cold atoms or various material platforms.

\paragraph{Acknowledgments.---} This work was supported by the french ANR BOCA grant. JL acknowledges support from the National Research Fund Luxembourg under Grant No. INTER/QUANTERA21/16447820/MAGMA.



\bibliography{References}

\clearpage
\onecolumngrid
\input{suppl.tex}

\end{document}
