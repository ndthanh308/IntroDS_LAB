\documentclass[reprint,superscriptaddress,amsmath,amssymb,aps,prl]{revtex4-2}

\usepackage{graphicx}
\usepackage{dcolumn}
\usepackage{bm}
\usepackage{physics}
\usepackage{xcolor}

\usepackage{hyperref} 
\hypersetup{colorlinks, allcolors=black}

\makeatletter
\newcommand\footnoteref[1]{\protected@xdef\@thefnmark{\ref{#1}}\@footnotemark}
\makeatother

\begin{document}

\preprint{APS/123-QED}

\title{Spectroscopy and topological properties of a Haldane light system}

\author{Julian Legendre}
%\email{julian.legendre@uni.lu}
\affiliation{Department of Physics and Materials Science, University of Luxembourg, L-1511, Luxembourg}
\affiliation{CPHT, CNRS, Institut Polytechnique de Paris, Route de Saclay, 91128 Palaiseau, France}
\author{Karyn Le Hur}
 %\email{karyn.le-hur@polytechnique.edu}
\affiliation{CPHT, CNRS, Institut Polytechnique de Paris, Route de Saclay, 91128 Palaiseau, France}

%\date{\today}

\begin{abstract}

We introduce a local spectroscopic method in real space to probe the topological properties of a circuit quantum electrodynamics (cQED) array generalizing previous approaches from one to two dimensions in the plane. As an application, we develop the theory of microwave light propagating in the local probe capacitively coupled to the cQED array associated to a bosonic Haldane model. Interestingly, we show that the measured reflection coefficient, resolved in frequency through the resonance, reveals the modelâ€™s geometrical properties and topological phase transition. We discuss the role of physical parameters such as the lifetime of the light modes and stability towards local disorder related to further realizations. 
\end{abstract}

\maketitle

\paragraph*{Introduction.---} Topological systems find various interesting applications in physics, in particular related to the protected mesoscopic transport at the edges. In two dimensions, the quantum Hall effect, induced by a perpendicular uniform magnetic field, has been generalized to situations with no net flux in a unit cell, referring to the Haldane honeycomb lattice model \cite{Haldane88}, and then generally to the quantum anomalous Hall effect and Chern insulators. The latter are realized in solid-state systems, in cold atom gases and in photonic systems (coupled waveguides) \cite{Chang13,Rechtsman13,Jotzu14}. One elegant way to realize Haldane's seminal model for artificial systems is through Floquet engineering \cite{Takashi09,Rechtsman13,Jotzu14,Zheng14,Eckardt15,Plekhanov17}.

The most common way to probe the topological properties in condensed matter systems is to determine the Hall conductance \cite{Klitzing80,Chang22}. 
The topological responses of artificial systems are accessible in several ways \cite{Goldman16,Cooper19,LuJ14,OzawaPrice19}.
In cold atom gases, topological properties are revealed through transport or Hall drift \cite{Jotzu14,Aidelsburger15}, interferometry
\cite{Atala13,Duca15,TracyLi16}, the physics of chiral edge states \cite{Stuhl15,Mancini15} or via a measurement of the Berry curvature \cite{Flaschner16}.
For condensed matter systems and cold atom gases, a circular drive on the system also enables to probe the topological information \cite{Mciver12,Juan17,Tran17,Asteria19,Rees20}, even with a local resolution within the Brillouin zone \cite{KleinP21,HurK22}.
Light systems with topological properties, including gyromagnetic photonic crystals \cite{Haldane08,Raghu08,WangChong08,WangChong09}, arrays of coupled waveguides \cite{Rechtsman13,Mukherjee17,Maczewsky17}, optomechanical systems \cite{Fleury14,Kim17}, cavity and circuit quantum electrodynamics (cQED) \cite{Koch10,Anderson16,Owens18,Hur16,GuKockum17,Roushan17}, have also garnered significant interest. 

In Ref.~\cite{Goren18}, a protocol to probe the topological properties of a one-dimensional LC circuit system is proposed. This system is closely connected to the SSH model which has been implemented recently \cite{Rosenthal18,Poli15,Meier16,StJean17}. In Ref.~\cite{Goren18}, the authors considered a transmission line (capacitively) coupled to a single cell within the chain. From the reflection of an input triggered in the probe, they reconstructed the Zak phase, which is the topological invariant characterizing the studied one-dimensional system. 
Our quest is to generalize this local probe approach on the lattice in two dimensions, which is {\it \` a priori} not so apparent. Previous proposals for light-matter topological probes in two-dimensional systems have used the transverse polarization of light to detect the chirality associated with the system's topological nature \cite{Mciver12,Tran17}. In striking contrast to these approaches, our study focuses on a local probe in real space, specifically a long transmission line capacitively coupled to a Haldane bosonic model in circuit quantum electrodynamics (cQED). We demonstrate how the Chern number can be measured by analyzing the reflection coefficient, which relates the input and output voltage signals.

\paragraph*{Bosonic Haldane model.---} We introduce a cQED system made of an array of resonators coupled together in such a way \cite{Plekhanov17} that the system is described by a usual Haldane Hamiltonian $H= \sum_{{\bf k}} \Psi_{{\bf k}}^\dagger h_{{\bf k}} \Psi_{{\bf k}}$ \cite{Haldane88,Chang13,Rechtsman13,Jotzu14,Takashi09,Zheng14,Eckardt15}, with
\begin{equation} \label{eq:hk}
h_{{\bf k}} = h_0({\bf k})   + \textrm{Re}\left[h_1({\bf k}) \right]\sigma_x -\textrm{Im}\left[h_1({\bf k}) \right] \sigma_y + h_2({\bf k})  \sigma_z,
\end{equation}
and $h_0({\bf k}) = \hbar \Omega_0  + 2 t_2 \cos \phi \sum_{i =1}^3 \cos ({\bf k} \cdot {\bf b}_i)$, $h_1({\bf k}) = t_1 \sum_{i =1}^3 \exp (-i {\bf k} \cdot {\bf a}_i)$, $h_2({\bf k}) = M- 2 t_2 \sin \phi \sum_{i =1}^3 \sin ({\bf k} \cdot {\bf b}_i)$ and $\Psi_{{\bf k}}^\dagger = \left(a_{1,{\bf k}}^\dagger, a_{2,{\bf k}}^\dagger\right)$, where $a^{\dagger}_{j,{\bf k}}$ is the creation operator for a boson with momentum ${\bf k}$ on sublattice $j$ ($j=1(2)$ corresponds to the sublattice A(B) appearing in Fig.~\ref{fig1}(a)). ${\bf a}_i$ and ${\bf b}_i$ ($i \in \{1,2,3\}$) are defined in Fig.~\ref{fig1}(a), the hopping amplitudes $t_1$ and $t_2$ and the Semenoff mass $M$ \cite{Semenoff84} are real numbers and $\sigma^{x},\sigma^{y},\sigma^{z}$ are Pauli matrices acting in sub-lattice space. 
Hereafter, we study the case where $t_2$ is small compared to $t_1$, as it is often the situation in physical systems. In Ref.~\cite{Plekhanov17}, a Haldane Hamiltonian for bosonic systems is derived from Floquet engineering with a high-frequency approximation.
For a photonic system, a permanent drive is necessary to compensate for the photon decay processes that happen \cite{OzawaPrice19}. In typical photonic systems
the on-site energy $\hbar\Omega_0$ is large (usually $\sim$ GHz order of magnitude) compared to the effective hopping amplitudes on the lattice (\textit{e.g.} can be $\sim 10$ MHz to $\sim 100$ MHz) \cite{Koch10,Underwood12,Hartmann16,Roushan17}.

The Haldane model shows two energy bands in momentum space $E_{i,{\bf k}} = h_0({\bf k}) + (-1)^i  \epsilon({\bf k})$, where $i=1$ or 2 and $\epsilon({\bf k}) = \sqrt{|h_1({\bf k})|^2+h_2({\bf k})^2}$ (see Fig.~\ref{fig1}(c)).
%Band crossing appears at $h_1({\bf k}) = h_2({\bf k}) = 0$. 
$h_1({\bf k}) =0$ is reached at both nonequivalent Dirac points ${\bf K} = \left({\bf g}_3-{\bf g}_2\right)/3$ and ${\bf K}'=\left({\bf g}_2-{\bf g}_3\right)/3$ (see Fig.~\ref{fig1}(b)). Moreover, we have $h_2({\bf K}) = 0$ if $M = + 3 \sqrt{3}  t_2 \sin \phi$ and $h_2({\bf K}') = 0$ if $M = - 3 \sqrt{3}  t_2  \sin \phi$. When the bands cross, the dispersion relation around ${\bf K}$ and ${\bf K}'$ is linear.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Figure environment removed
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\paragraph*{ Topological properties.---} 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{table}[b]
\caption{\label{tab:sgnh2}Sign of $h_2$ at the Dirac points, as a function of $M$ and $\textrm{sgn}(\sin \phi)$.}
\begin{ruledtabular}
\begin{tabular}{ccc}
& $|M|<3 \sqrt{3} t_2 |\sin \phi|$ & $|M|>3 \sqrt{3} t_2 |\sin \phi|$ \\
\colrule
$\textrm{sgn} \, h_2({\bf K})$ & $-\textrm{sgn}(\sin \phi)$ 
&  $\textrm{sgn} \, M$\\
$\textrm{sgn} \, h_2({\bf K}')$ &  $\textrm{sgn}(\sin \phi)$  &  $\textrm{sgn} \, M$  \\
\end{tabular}
\end{ruledtabular}
\end{table}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

Here, we describe the geometrical properties of the system through Bloch eigenvectors and through a definition of the topological number resolved at the Dirac points in Eq. (\ref{eq:chnumber}). This definition is generally valid for a model that can be written as a 
spin-$\frac{1}{2}$ particle in momentum space \cite{KLHreview}. We introduce
$\ket{u_{i,{\bf k}}}$ as the Bloch eigenvectors of the Haldane Hamiltonian, \textit{i.e.} $\textrm{e}^{-i {\bf k} \cdot \hat{{\bf r}}} H   \textrm{e}^{i {\bf k} \cdot \hat{{\bf r}}} \ket{ u_{i,{\bf k}}} = E_{i,{\bf k}} \ket{ u_{i,{\bf k}}}$ and we define the coefficients $\alpha_{i }^{1}({\bf k})$ and $\alpha_{i }^{2}({\bf k})$ such that $
\ket{u_{i,{\bf k}}} = \left[\alpha_{i}^{1}({\bf k}) a_{1,{\bf k}}^{\dagger} + \alpha_{i}^{2}({\bf k}) a_{2,{\bf k}}^{\dagger} \right] \ket{0}
$. These coefficients may vanish only at the Dirac points. If the sign of $h_2$ is opposite at the non-equivalent Dirac points ($|M|< 3 \sqrt{3} t_2 |\sin \phi|$, see Table~\ref{tab:sgnh2}), then $\alpha_{i }^{1}({\bf k})$ vanish at one Dirac point and $\alpha_{i }^{2}({\bf k})$ vanish at the other Dirac point. It follows that it is impossible to find a unique and smooth phase  over all the BZ for the Bloch state $\ket{u_{i,{\bf k}}}$. This characteristic feature of Chern insulators \cite{Kohmoto85} forms the basis of the probe proposed in this letter, rendering it \textit{\` a priori} relevant for Chern insulators with non-degenerate Dirac points in the energy spectrum (for the Haldane system we consider this imposes $t_2 \lesssim 0.15t_1$). In this phase, the Chern number $C_i$ ($i$ is the band index) reads $C_{i} =(-1)^{i+1} \, \textrm{sgn}( \sin \phi)$. In the Supplemental Material, for completeness, we present a derivation of this formula \cite{suppl}. Now, we build an alternative definition of the topological number from the Dirac points. If the sign of $h_2$ is the same at both Dirac points ($|M|> 3 \sqrt{3} t_2 |\sin \phi|$, see Table~\ref{tab:sgnh2}), then $\alpha_{i }^{1}({\bf k})$ or $\alpha_{i }^{2}({\bf k})$ can be chosen non-zero over all the BZ. In this case, the Chern numbers $C_i$ are vanishing. From this analysis, for $|M| \neq 3 \sqrt{3} t_2 |\sin \phi|$, we have $C_i = (-1)^{i+1} \, \textrm{sgn}( \sin \phi ) \left[1- \textrm{sgn}( h_2({\bf K}) h_2({\bf K}')\right]/2$, \textit{i.e.} 
\begin{equation} \label{eq:chnumber}
    C_i = \dfrac{(-1)^{i}}{2}  \left[\textrm{sgn} \, h_2({\bf K}) - \textrm{sgn} \, h_2({\bf K}') \right].
\end{equation}
This formula has indeed a simple physical understanding for a Hamiltonian $h_{\bf k}$ written as a $2\times 2$ matrix. From the Ehrenfest theorem and a Bloch sphere correspondence the topological number is equivalent to
$C_i = (-1)^{i} \left[\langle \sigma_z(0)\rangle - \langle \sigma_z(\pi)\rangle\right]/2$ with $\langle \sigma_z\rangle=(-1)^i\cos\theta=(-1)^i\hbox{sgn} \, h_2(\theta)$ \cite{KLHreview}. In the following, we namely rely on Eq.~\eqref{eq:chnumber} to show how $C_i$ can be probed from the reflected light in a local probe capacitively coupled to a Haldane photonic system.
The simple idea behind our proposal is that the topological properties manifest as discernible sublattice weight variations of the wave function, enabling to reveal the topological transition through the coupling of a probe to one of the sublattice sites. 

We emphasize here that in Ref.~\cite{Goren18}, we proposed a capacitively coupled topological probe for a 1D system. It gives access to a phase whose winding around the BZ is the topological invariant (Zak phase). The probe proposed in the following is substantially different since it measures the information in Eq. (\ref{eq:chnumber}). 

\paragraph*{ Spectroscopic probe.---}
Here, we introduce the local spectroscopic approach, i.e. a local light probe with weak capacitive coupling to a Haldane boson system at position ${\bf R}_0$, on the sublattice $j_0$. 
The probe is a resonator with a certain number of (relevant) modes, described by the Hamiltonian $
H_{\textrm{prb}} =\sum_q \hbar \omega_q b_{q}^\dagger b_{q}$,
with $ b_q^{\dagger}, b_{q}$ the creation, annihilation operators for the mode $q$ characterized by the frequency $\omega_q$. The coupling is described by $H_{\textrm{cpl}} = \left( a_{{\bf R}_0}+ a_{{\bf R}_0}^\dagger \right)\sum_q g_q \left( b_{q}+ b_{q}^\dagger  \right)$, where $ a_{{\bf R}_0}^\dagger$ is the Fourier transform of $a^{\dagger}_{j,{\bf k}}$ at position ${\bf R}_0$. For simplicity, we initially disregard the dissipation effects induced by the probe in the Haldane system and assume infinitely long lifetimes for the light modes $\ket{u_{i,{\bf k}}}$.  

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{table}
\caption{\label{tab:Cherncoef}Coefficients $\alpha_{i }^{j_0}$ which, at the Dirac points, are directly related to the Chern number, as a function of $\textrm{sgn} \, M$ and $\textrm{sgn}(\sin \phi)$.}
\begin{ruledtabular}
\begin{tabular}{ccc}
& $\textrm{sgn} \, M=\textrm{sgn}\left(\sin \phi \right) $ & $\textrm{sgn} \, M=-\textrm{sgn}\left(\sin \phi \right)$ \\
\colrule
$\dfrac{\textrm{sgn}\left(\sin \phi \right)}{(-1)^i}=1$ & $ \alpha_{i}^2(\boldsymbol{K}) = - C_i$ 
&  $\alpha_{i}^1(\boldsymbol{K}') = (-1)^{i+1}C_i$\\
\noalign{\smallskip}
$\dfrac{\textrm{sgn}\left(\sin \phi \right)}{(-1)^{i+1}}=1$ & $\alpha_{i}^1(\boldsymbol{K}) = (-1)^{i} C_i $ 
&  $\alpha_{i}^2(\boldsymbol{K}') = C_i$\\
\end{tabular}
\end{ruledtabular}
\end{table}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{table}
\caption{\label{tab:Cherncoef1}Choice of the probe's input frequency $\hbar \omega_{q_0} =E_{i,{\bf k}}$, given by the indices $i$ and ${\bf k}$, as a function of $\textrm{sgn} \, M$ and $\textrm{sgn}\left(\sin \phi \right)$, such that the transition rate depends on the Chern number: $\Gamma = J\left[E_{i,{\bf k}}\right] |C_i |/\hbar$.}
\begin{ruledtabular}
\begin{tabular}{ccc}
& $\textrm{sgn} \, M=\textrm{sgn}\left(\sin \phi \right) $ & $\textrm{sgn} \, M=-\textrm{sgn}\left(\sin \phi \right)$ \\
\colrule
$\textrm{sgn}\left(\sin \phi \right)=1$ & $i = j_0$, ${\bf k} = {\bf K} $ 
&  $i = \overline{j_0}$, ${\bf k} = {\bf K}' $\\
\noalign{\smallskip}
$\textrm{sgn}\left(\sin \phi \right)=-1$ & $i = \overline{j_0}$, ${\bf k} = {\bf K} $ 
&  $i = j_0$, ${\bf k} = {\bf K}' $\\
\end{tabular}
\end{ruledtabular}
\end{table}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

To acquire some intuition, let us show that the transition rate $\Gamma$ from a state $\ket{\psi(t)}$ which, at initial time $t_i$, is a probe's mode with frequency
$\omega_{q_0}$, \textit{i.e.} $\ket{\psi(t_i)} = \ket{b_{q_0}}$, to the eigenstates $\ket{u_{i,{\bf k}}}$ of the Haldane Hamiltonian's bears information about the topological character of the system. At sufficiently long times $t$, 
$\Gamma \left[\hbar \omega_{q_0} \right] = \dfrac{2 \pi}{\hbar} \sum_{i,{\bf k}} |\bra{b_{{q_0}}} H_{\textrm{cpl}} \ket{u_{i,{\bf k}}}|^2 \delta\left( \hbar \omega_{q_0} - E_{i,{\bf k}}\right)$. $\bra{b_{{q_0}}} H_{\textrm{cpl}} \ket{u_{i,{\bf k}}}$ involves the components of the Bloch state in the basis $\left( a_{1,{\bf k}}^{\dagger} , a_{2,{\bf k}}^{\dagger} \right)$ and a factor $\textrm{e}^{i {\bf k} \cdot {\bf R}_0}$ (transformation to the real space representation), such that we obtain 
$\bra{b_{{q_0}}} H_{\textrm{cpl}} \ket{u_{i,{\bf k}}} = g_{q_0} \alpha_{i }^{j_0}({\bf k})  \textrm{e}^{i {\bf k} \cdot {\bf R}_0}$.  
As one can see from Table~\ref{tab:Cherncoef}, which is constructed using Eq.~\eqref{eq:chnumber} and the related analysis of the coefficients $\alpha_{i }^{j_0}({\bf k})$, depending on $\textrm{sgn} \, M$ and $\textrm{sgn}\left(\sin \phi \right)$, it is possible to express the Chern number as a function of the coefficients $\alpha_{i }^{j_0}({\bf k})$. If $\textrm{sgn} \, M=\textrm{sgn}\left(\sin \phi \right) $ ($\textrm{sgn} \, M=-\textrm{sgn}\left(\sin \phi \right) $) we notice that the Chern number is directly related to the coefficients $\alpha_{i }^{j_0}({\bf k})$ evaluated at $\boldsymbol{K}$ ($\boldsymbol{K}'$) and $E_{i,\boldsymbol{K}}$ ($E_{i,\boldsymbol{K}'}$), $ i \in \{1,2\}$, is non-degenerate.
Therefore, choosing $\hbar \omega_{q_0} =E_{i,{\bf k}}$ with $i$ and ${\bf k}$ according to Table~\ref{tab:Cherncoef1}, we find a simple relation between $\Gamma$ and the topological invariant: $\Gamma\left(E_{i,{\bf k}}\right) = J\left(E_{i,{\bf k}}\right) |C_i |^2 =J\left(E_{i,{\bf k}}\right)|C_i |$, where the spectral function $J$ is: $J(\omega) = (2 \pi/\hbar) \sum_q g_q^2 \left[ \delta(\omega - \omega_q) -  \delta(\omega + \omega_q) \right]$. In other words, 
\begin{equation} \label{eq:gamma}
    \Gamma \left(E_{i,{\bf k}}\right) = J\left(E_{i,{\bf k}}\right) |C_i |,
\end{equation}
where the indices $i$ and ${\bf k}$ are functions of $\textrm{sgn} \, M$ and $\textrm{sgn}\left(\sin \phi \right)$ as indicated in Table~\ref{tab:Cherncoef1}. The relation appearing in Eq.~\eqref{eq:gamma} has been established from Table~\ref{tab:Cherncoef} and Table~\ref{tab:Cherncoef1}. Therefore, it relies on a fundamental property characterizing a Chern insulator: the impossibility of defining smooth Bloch states over the BZ, which translates here into the vanishing of the Bloch eigenvectors' components $\alpha_{i }^{1}$ and $\alpha_{i }^{2}$ at the opposite Dirac points.

Motivated by this, we now investigate the relation between an input voltage $ \langle V_{{\bf R}_0}^{\textrm{in}}(\omega) \rangle$ and the resulting output voltage $\langle V_{{\bf R}_0}^{\textrm{out}}(\omega) \rangle$, both at frequency $\omega$ in the probe at ${\bf R}_0$. 
For $\omega$ resolved around one Dirac point, this relation between $\langle V_{{\bf R}_0}^{\textrm{in}}(\omega)\rangle$ and $\langle V_{{\bf R}_0}^{\textrm{out}}(\omega)\rangle$ enables to rebuild the Haldane topological phase diagram.
More details on the derivation of Eq. (\ref{eq:zfregtbrij}) are given in the Supplemental Material \cite{suppl}. We indeed find
\begin{equation} \label{eq:hzfjzd}
\langle V_{{\bf R}_0}^{\textrm{out}}(\omega) \rangle= R(\omega) \langle V_{{\bf R}_0}^{\textrm{in}}(\omega)\rangle ,
\end{equation}
with $R(\omega) = 1 +i  J(\omega)\chi_{{\bf R}_0,{\bf R}_0} $,
and
\begin{widetext}
\begin{equation} \label{eq:xi}
\chi_{{\bf R}_0,{\bf R}_0} = \dfrac{1}{ N} \sum_{i=1}^2 \sum_{{\bf k} } \gamma_{j_0,{\bf k}}^{i} \left[ \dfrac{1}{- \hbar \omega - E_{i,{\bf k}} + i 0^+} - \dfrac{1}{-\hbar \omega + E_{i,{\bf k}} + i 0^+} \right],
\end{equation}
\end{widetext}
where $N$ is the number of lattice sites
and 
\begin{equation} \label{eq:zfregtbrij}
\gamma_{j_0,{\bf k}}^{i} = \dfrac{1}{2}+\dfrac{(-1)^{j_0+i+1} h_2({\bf k})}{2 \epsilon({\bf k})} \in \, \mathbb{R}.
\end{equation}
The key point within our present approach is to observe that $\gamma_{j_0,{\bf k}}^{i}$ evaluated at the Dirac points, where $h_1=0$, depends only on the sign of the function $h_2$: we have $2 \gamma_{j_0,{\bf k}}^{i} = 1 - (-1)^{j_0+i} \textrm{sgn} \, h_2({\bf k}) $ for ${\bf k} = \{{\bf K}, {\bf K}'\}$. The response function is then directly related to the topological invariant via Eq.~\eqref{eq:chnumber} and Table~\ref{tab:sgnh2}. As we show in Table~\ref{tab:alphabeta}, depending on the sign of $\sin \phi $ and on the sign of the Semenoff mass, the $i^{\textrm{th}}$ band topological invariant is given by the coefficient $\gamma_{j_0,{\bf k}}^{i}$, evaluated at $j_0 =i$ or $j_0 =\overline{i}$ and at ${\bf k} = {\bf K}$ or ${\bf k} = {\bf K}'$, with $\overline{i} = 2(1)$ if $i=1(2)$. Again, this outcome arises from a fundamental characteristic associated to the topological phase: the vanishing of the Bloch eigenvectors' components $\alpha_{i }^{1}$ and $\alpha_{i }^{2}$ at the opposite Dirac points. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{table}[b]
\caption{\label{tab:alphabeta} Value of $\gamma_{j_0,{\bf k}}^{i}$, evaluated at $j_0 =i$ or $j_0 =\overline{i}$ and at ${\bf k} = {\bf K}$ or ${\bf k} = {\bf K}'$, as a function of $\textrm{sgn}\left(\sin \phi \right)$ and $\textrm{sgn} \, M$. We remind that $\overline{i} = 2(1)$ if $i=1(2)$.}
\begin{ruledtabular}
\begin{tabular}{ccc}
& $\textrm{sgn} \, M=\textrm{sgn}\left(\sin \phi \right) $ & $\textrm{sgn} \, M=-\textrm{sgn}\left(\sin \phi \right)$ \\
\colrule \noalign{\smallskip}
$\textrm{sgn}\left(\sin \phi \right)=1$ & $ \gamma_{i,\boldsymbol{K}}^i = (-1)^{\overline{i}} C_i$ 
&  $\gamma_{\overline{i},\boldsymbol{K}'}^{i} = (-1)^{\overline{i}} C_i$\\
\noalign{\smallskip}
$\textrm{sgn}\left(\sin \phi \right)=-1$ & $\gamma_{\overline{i},\boldsymbol{K}}^{i} = (-1)^{i} C_i$ 
&  $\gamma_{i,\boldsymbol{K}'}^i = (-1)^{i} C_i$\\
\end{tabular}
\end{ruledtabular}
\end{table}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

We can now understand how measuring the reflected light signal in the probe reveals the topological phase transition of the two-dimensional lattice model.
We write $S^{\textrm{in}}(\omega)=\left| \langle V_{{\bf R}_0}^{\textrm{in}}(\omega)\rangle\right|^2$ and $S^{\textrm{out}}(\omega)=\left| \langle V_{{\bf R}_0}^{\textrm{out}}(\omega)\rangle\right|^2$ the energy spectral density respectively associated to the input and output voltages.
To leading order in the coupling amplitudes, we have $S^{\textrm{out}}(\omega) = | R(\omega) |^2 S^{\textrm{in}}(\omega)$ and for $\omega>0$,
\begin{equation}\label{eq:realRrrreaf}
  |R(\pm \omega) |^2 =  1 \mp \dfrac{2\pi J(\pm \omega)}{N}   \sum_{i=1}^2 \sum_{{\bf k} }  \gamma_{j_0,{\bf k}}^{i} \delta( \hbar \omega - E_{i,{\bf k}}).
\end{equation}
For $\textrm{sgn} \, M=\textrm{sgn}\left(\sin \phi \right) $, the energies $E_{i,\boldsymbol{K}}, \, i \in \{1,2\}$ are non-degenerate, therefore, choosing $\hbar \omega = E_{i,\boldsymbol{K}}$ selects only the ${\bf k} = {\bf K}$ point in the integral appearing in the Eq.~\eqref{eq:realRrrreaf}.  
Moreover, as indicated in Table~\ref{tab:alphabeta},
$\gamma_{j_0,{\bf K}}^{i}$ is related to the topological invariant if we choose a probe at $j_0=i$ ($\overline{i}$) for $\textrm{sgn}\left(\sin \phi \right)=1$ ($\textrm{sgn}\left(\sin \phi \right)=-1$). Therefore, for a well-chosen frequency $\omega$, $|R(\omega) |^2 $ clearly depends on the topological invariant. This is also true for $\textrm{sgn} \, M=-\textrm{sgn}\left(\sin \phi \right) $, if, in the previous analysis, we replace ${\bf K}$ by ${\bf K}'$ and $j_0$ by $\overline{j_0}$. 

\paragraph*{ Finite lifetimes for the light modes.---} Eventually, we address the more realistic scenario in which we incorporate finite lifetimes for both the modes in the probe $\ket{b_{q}}$ and the Chern insulator's modes $\ket{u_{i,{\bf k}}}$. For simplicity, we consider the same bandwidth amplitude $\Delta_{\textrm{CI}}$ ($\Delta_{\textrm{P}}$) for all the modes $\ket{u_{i,{\bf k}}}$ ($\ket{b_{q}}$). 
We assume the following ordering of the energies $\textrm{max}_q(g_q) \ll \{\Delta_{\textrm{CI}},\Delta_{\textrm{P}}\} \ll \{t_1, \hbar\textrm{min}_{q,q'}(|\omega_{q}-\omega_{q'}|)\}$. 
We replace the Dirac Delta functions appearing in Eq.~\eqref{eq:realRrrreaf} by normalized Gaussian spectral distributions denoted $G\left(\omega;\overline{\omega},\Delta\right)$ with mean value $\overline{\omega}$ and standard deviation $\Delta$: 
$\delta( \hbar \omega - E_{i,{\bf k}})$ is replaced by $G\left(\omega;E_{i,{\bf k}}/\hbar, \Delta_{\textrm{CI}}\right)$ and 
$J(\omega)$ is replaced by $\tilde{J}[\omega] = 2 \pi \sum_q \left(g_q/\hbar\right)^2 \left[ G\left(\omega,\omega_q,\Delta_{\textrm{P}}\right)-  G\left(\omega,-\omega_q,\Delta_{\textrm{P}}\right) \right]$.
We also consider an input energy spectral density with Gaussian distribution: $S^{\textrm{in}}(\omega) = G\left(\omega;\omega_{q_0},\Delta_{\textrm{P}}\right) $. 
For a well chosen $\omega_{q_0}$ ($E_{i,\boldsymbol{K}}$ or $E_{i,\boldsymbol{K}}$), $|R(\omega) |^2 $ still depends on the topological invariant because $\gamma_{j_0,{\bf k}}^{i}$ is directly related to the Chern number.
It leads to a decrease of the output peak's weight $\int d \omega S^{\textrm{out}}(\omega)$ compared to the normalized weight of the input peak. This decrease is given by
\begin{equation} \label{eq:output}
  1-\int d \omega S^{\textrm{out}}(\omega) =  \dfrac{2\pi }{N}   \sum_{i=1}^2 \sum_{{\bf k} }  \gamma_{j_0,{\bf k}}^{i} I_{i,{\bf k}},
\end{equation}
with $I_{i,{\bf k}}=\int d \omega \tilde{J}(\omega) G\left(\omega;E_{i,{\bf k}}/\hbar, \Delta_{\textrm{CI}}\right) G\left(\omega;\omega_{q_0},\Delta_{\textrm{P}}\right) $, which is $\left( g_{q_0}/\hbar\right)^2 /\left( \sqrt{2 \pi }\Delta_{\textrm{CI}} \Delta_{\textrm{P}}^2\right) $ times the overlap area $\int d\omega \, \textrm{exp}{- \dfrac{\left(\omega- \omega_{q_0} \right)^2}{ \Delta_{\textrm{P}}^2 } } \, \textrm{exp} {- \dfrac{\left(\omega-E_{i,{\bf k}}/\hbar\right)^2}{2 \Delta_{\textrm{CI}}^2 }}$ . 

\paragraph*{Disorder.---}
We expect the general structure of the wave function over space, which is related to the bulk invariant, to be robust against weak disorder. This central feature gives robustness to the probe proposed in this letter. To illustrate this point, we consider a finite size system with local disorder on the parameters. We do not have translational symmetry but the expression of $1-\int d \omega S^{\textrm{out}}(\omega)$ in Eq.~\eqref{eq:output} is easily adapted: the sum over $i$ and $\bf k$ is replaced by a sum over the lattice sites and a numerical diagonalization gives the energies and the decomposition of the eigenvectors over the lattice sites from which we get the analogues of the coefficient $\gamma_{j_0,{\bf k}}^{i}$ and the integral $I_{i,{\bf k}}$.
 
For one disorder configuration, we choose to sample each of the values of $t_1$, $t_2$, $M$ and $\phi$ over the lattice from a Gaussian distribution law with respectively mean value $\overline{t}_1$, $\overline{t}_2$, $\overline{M}$ and $\overline{\phi}$ and standard deviation being five percent of the associated mean value. We choose the experimentally relevant energy scales $\Omega_0=10$ GHz, $\overline{t}_1/\hbar=100$ MHz, $\overline{t}_2/\hbar=15 $ MHz, $\Delta_{\textrm{CI}} = \Delta_{\textrm{P}} = 10$MHz and $g_{q_0}/\hbar=1$MHz. These scales correspond to a relatively low quality factor $Q=\Omega_0/\Delta_{\textrm{CI}} =10^3$ (here the same for both the cQED Chern insulator and the probe) and a low coupling amplitude and should be reachable in a cQED experiment. In Fig.~\ref{fig1}(d), we show a numerical evaluation of $1-\int d \omega S^{\textrm{out}}(\omega)$ as a function of $\overline{M}/\overline{t}_2$ and $\overline{\phi}$. 
For this figure, we consider $ \overline{M}>0$, the probe is coupled to a sublattice A site ($j_0 =1$) and $\sin \overline{\phi} >0$. Note that if the latter inequality is arbitrarily imposed then our measure can not access the sign of the Chern number, but it still discriminates between a topological and a trivial phase. Moreover, we chose $\hbar \omega_{q_0} = \tilde{E}_{1,\boldsymbol{K}}$ and we expect $1-\int d \omega S^{\textrm{out}}(\omega)$ depends on $ C_1 $ (because $\gamma_{1,{\bf K}}^1 = C_1 $). $\tilde{E}_{1,\boldsymbol{K}}$ is the highest energy of the lowest band and it can be determined through the energy density of states before the measure of the Chern number. From Eqs.~\eqref{eq:zfregtbrij} and \eqref{eq:realRrrreaf}, we observe that the energy density of states is obtained by summing the local responses to an input measured in two distinct probes on sublattices A and B. In our protocol, $\textrm{sgn} \, M$ also needs to be determined before the measure of the Chern number.

%\paragraph*{Magnon system and material suggestions.---} The results described here are directly relevant for other Chern insulator systems. For instance, our probe can be used for a topological magnon insulator, as the one proposed in Ref.~\cite{Owerre16}, which is described by a bosonic Haldane model. Indeed, consider a magnetic tip described by a polarization state denoted ${\bf s}=(s^x,s^y,s^z)$, and assume the tip thin enough to couple to only one magnetic site ${\bf S}_i$ of the system. The Hamiltonian coupling the tip to the magnon system is $H_{\textrm{cpl}} = J \, {\bf S}_i \cdot {\bf s}_i$, with $J$ the coupling amplitude. Suppose now the tip is polarized along $x$ only. Then $H_{\textrm{cpl}} = J \, {\bf S}_i \cdot {\bf s}_i = (J/4) (S_i^+ + S_i^-) (s^+ + s^-)$, where $S_i^+$, $S_i^-$, $s^+$ and $s^-$ are bosonic creation/annihilation operators. $H_{\textrm{cpl}}$ is completely analogue to the coupling Hamiltonian we considered for the cQED system. Therefore, measuring the response to a magnetic excitation provides a way to access the topological number. Such a measurement should be applicable in topological magnon quantum materials, such as CrI$_3$ \cite{Chen18} or maybe $\beta$-Cu$_2$V$_2$O$_7$ \cite{Tsirlin10}. Even though the magnon can condense at the lowest energy mode, thermal excitation shall generate magnon modes at all energies in the system, namely the ones required for the proposed probe, with energy around the Dirac point.

\paragraph*{ Remarks.---} Two observations are in order.

(i) The probe is able to measure the topological number based on a real space local coupling to the system and with a resolution in reciprocal space thanks to the energy conservation, similarly to circularly polarized light \cite{HurK22}. 

(ii) If the input is triggered at a site identified by $\left( {\bf r}, j_0\right)$ and the output is measured at $\left( {\bf r}', j_0'\right)$, the expression in the summation of Eq.~\eqref{eq:xi} becomes
\begin{equation} \label{eq:rq}
    \dfrac{\left[\beta_{j_0}^i({\bf k}) \alpha_{i}^{j_0'}({\bf k})\right]^* \textrm{e}^{i {\bf k}\left({\bf r}-{\bf r}'\right)}}{-\hbar \omega - E_{i,{\bf k}} + i 0^+} - \dfrac{\beta_{j_0}^i({\bf k}) \alpha_{i}^{j_0'}({\bf k}) \textrm{e}^{-i{\bf k} \left({\bf r}-{\bf r}'\right)}}{-\hbar \omega + E_{i,{\bf k}} + i 0^+} ,
\end{equation}
with $\beta_{j_0 }^{i}({\bf k}) \alpha_{i }^{j_0}({\bf k})=\gamma_{j_0,{\bf k}}^{i}$ and for $j_0' =\overline{j_0} \neq j_0$, $\beta_{j_0}^i({\bf k}) \alpha_{i}^{\overline{j_0}}({\bf k}) \propto h_1({\bf k}) / 2 \epsilon({\bf k})$.
At the Dirac points, $h_1$ is vanishing, therefore, in the case $j_0' =\overline{j_0}$, the simple protocol we sketched above does not help to rebuild the topological phase diagram. This outcome can be anticipated based on the fact that, at one given Dirac point, one of both Bloch eigenvectors' components vanish, in the topological regime. In the scenario $j_0' =j_0$,  because the coefficients in the numerator of Eq.~\eqref{eq:rq} are complex-valued, the Chern number dependency of $1-\int d \omega S^{\textrm{out}}(\omega)$ is mitigated. Indeed, the latter contains principal values of integrals over frequency involving $\left[1/\left(-\hbar \omega \pm E_{i,{\bf k}}\right)\right]$ terms.

\paragraph*{ Conclusion.---} We have introduced a local microwave-light probe with capacitive coupling to a cQED array described by a Haldane bosonic system, in the regime of small coupling amplitudes. We have explained how this probe is relevant for the detection of the topological character of Chern insulators. Using Fermi golden rule, we established a connection between the Chern number and the transition rate from a probe's eigenstate (with frequency corresponding to one of the Dirac points energy) to the eigenstates of the Haldane Hamiltonian. Secondly, we developed the input-output theory for the probe, enabling us to compute the reflection coefficient which relates an input voltage and an output voltage. We showed that for an input with frequency resolved at one of the Dirac points, this reflection coefficient is directly related to the system's topological invariant. The fundamental working principle of this probe makes it inherently relevant for Chern insulators with non-degenerate Dirac points in the energy spectrum (for the Haldane system we consider this imposes $t_2 \lesssim 0.15t_1$). As a future prospect, it appears intriguing to adapt this probe to other systems that may exhibit different particle statistics, such as cold atoms or various material platforms.

\begin{acknowledgments}
This work was supported by the french ANR BOCA grant. JL acknowledges support from the National Research Fund Luxembourg under Grant No. INTER/QUANTERA21/16447820/MAGMA.
\end{acknowledgments}

\bibliography{ref}

\clearpage
\input{sup.tex}

\end{document}
