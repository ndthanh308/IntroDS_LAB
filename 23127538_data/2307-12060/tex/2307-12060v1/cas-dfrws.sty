% cas-dfrws.sty
%
% adaption package to turn cas-dc.cls into a preprint class
% for papers accepted at DFRWS conferences.
%
% based on cas-dc.cls version 2.1 (2020/03/14)
%
% Use as follows in the preable of your cas-dc document:
%
% \documentclass{cas-dc}
% \usepackage{cas-dfrws}
% \renewcommand{\dfrwsconference}{Digital Forensics Research Conference Europe (DFRWS EU) 2021, March 29--April 1, 2021}
% ...
%
%
\def\RCSfile{cas-dfrws}%
\def\RCSversion{0.9}%
\def\RCSdate{2021/03/23}%


\NeedsTeXFormat{LaTeX2e}[1995/12/01]
\ProvidesPackage{\RCSfile}[\RCSdate, \RCSversion: turn cas-dc.cls papers into preprints for DFRWS conferences]

%\renewcommand{\ast}{$*$}  	%uncomment if you do not see a * for corresponding author; usually a problem with the used font and math mode

\ExplSyntaxOn
%\makeatletter

%cas-dc includes thumbnails for ``email'', ``url'' ... this removes them
\keys_set:nn { stm / mktitle } { nologo }

% define name of conference. Must be overwritten in manuscript
\newcommand{\dfrwsconference}{DFRWS 1999}

% overwrite footer to indicate DFRWS conference
\cs_gset:Npn \__first_footerline:
{
  \group_begin:
  \small
%  \sffamily \__short_authors: :~
  { \sffamily \itshape Proceedings~ of~ the~ \dfrwsconference{} }
  \group_end:
}

% overwrite header to show authors and title
\cs_gset:Npn \__cas_head: 
{ 
  \parbox{\textwidth}
    { 
      \sffamily\small\centering
      \__short_authors: ~\,/\,
      \__short_title:
    }
  }

\renewcommand \ps@cas
{
  \cs_set_eq:NN \@oddhead \__cas_head:
  \cs_set_eq:NN \@evenhead \__cas_head:
  \cs_set_eq:NN \@evenfoot \__cas_foot:
  \cs_set_eq:NN \@oddfoot \__cas_foot:
}
 
\ps@cas


% please do not add below here
% everthing below is redefining the authors macro; this is needed as the original template writes the first name in grey; 
% https://tex.stackexchange.com/questions/501560/els-cas-templates-no-highlighting-of-author-names
\RenewDocumentCommand \author { O{} m O{} }
   {
     \ResetMarks
     \tl_if_blank:nTF { #3 } { }
       { \keys_set:nn { stm / author } { #3 } }
%
     \int_gincr:N \g_stm_au_int  
     \tex_gdef:D \theau@ { \int_use:N \g_stm_au_int }
%
     \seq_gput_right:Nn \g_stm_prelimsau_seq { #2 }
     \bool_if:NTF \l_stm_au_collab_bool
       { \seq_gput_right:cn { g_stm_clau\int_use:N \g_stm_augr_int _seq } }
       { \seq_gput_right:cn { g_stm_au\int_use:N \g_stm_augr_int _seq } }
       {          
         \int_gincr:N \g_stm_aau_int  
         \tex_gdef:D \theauthor {\int_use:N \g_stm_aau_int }
         \keys_set:nn { stm /author } { #3 }
         \tl_if_head_eq_catcode:nNTF { #1 } a
            { \processAffRef { #1 } }
            { \processAffNum { #1 } }
         \tl_if_empty:NF \l_stm_au_prefix
            { \l_stm_au_prefix_tl \c_space_token } 
         \str_if_eq:VnTF \l_stm_au_style_tl  { chinese }
            { %\msg_term:n {STYLE~T=\l_stm_au_style_tl........}
              \invparsename { #2 } 
              \textcolor{\l_stm_augroup_color_tl}{\surname}
              \no_break_space:
              \textcolor{\l_stm_augroup_color_tl}{\firstname}  %%% CHANGE HERE
            }
            { %\msg_term:n {STYLE~F=\l_stm_au_style_tl........}  
              \parsename { #2 } 
              \textcolor{\l_stm_augroup_color_tl}{\firstname} %%% AND HERE
              \no_break_space:
              \textcolor{\l_stm_augroup_color_tl}{\surname}
            }
        \tl_if_empty:NF \l_stm_au_suffix_tl
        { \c_space_token \l_stm_au_suffix_tl }
         \unskip
         \textsuperscript
         {
           \tl_if_blank:nTF { #1 }
           { \tex_def:D \sep{} }
           { {\itshape\listAff} \tex_def:D \sep{\unskip,} }
           \process@marks 
           \bool_if:NT \l_stm_au_deceased_bool 
           { \sep \maltese
             \tex_def:D \sep { \unksip, }
           }
         }
        \tl_if_empty:NF \l_stm_au_degree_tl
        { ,\c_space_token \l_stm_au_degree_tl }
        \tl_if_empty:NF \l_stm_au_role_tl
        { \c_space_token (\l_stm_au_role_tl) }
%
       \ResetMarks
      }
%
      \bool_if:NT \l_stm_au_deceased_bool 
       { 
        \seq_gput_right:Nn \g_stm_maltese_seq
         {
          \tex_def:D \thefootnote { \maltese }
          \footnotetext{Deceased~author.} 
         } 
       }
% various social media
      \tl_if_empty:NTF \l_stm_au_facebook_tl { }
        { 
          \wrAux { \token_to_str:N \facebookauthor
            { \l_stm_au_facebook_tl } { \exp_not:n {#2} } }
        }
      \tl_if_empty:NF \l_stm_au_twitter_tl
        { 
          \wrAux { \token_to_str:N \twitterauthor
            { \l_stm_au_twitter_tl } { \exp_not:n {#2} } }
        }
      \tl_if_empty:NF \l_stm_au_gplus_tl
        { 
          \wrAux { \token_to_str:N \gplusauthor
            { \l_stm_au_gplus_tl } { \exp_not:n {#2} } }
        }
      \tl_if_empty:NF \l_stm_au_linkedin_tl
        { 
          \wrAux { \token_to_str:N \linkedinauthor
            { \l_stm_au_linkedin_tl } { \exp_not:n {#2} } }
        }
      \tl_if_empty:NF \l_stm_au_orcid_tl
        { 
          \wrAux { \token_to_str:N \orcidauthor
            { \l_stm_au_orcid_tl } { \exp_not:n {#2} } }
        }
%
        \@eadauthor={#2}
        \pdfstringdef\__info_au: { #2 }
        \int_compare:nNnTF { \theau@ } < { 4 }
        { \xappto \infoauthors { \__info_au: , ~ } }
        {
          \int_compare:nNnTF { \theau@ } = { 4 }
          { \xappto \infoauthors { et~al. } }
          { }
        }        
    }
\ExplSyntaxOff

\ExplSyntaxOff
