%% ****** Start of file apsguide4-2.tex ****** %
%%
%%   This file is part of the APS files in the REVTeX 4.2 distribution.
%%   Version 4.2b of REVTeX, December 2018.
%%
%%   Copyright (c) 2019 The American Physical Society.
%%
%%   See the REVTeX 4.2 README file for restrictions and more information.
%%
\documentclass[twocolumn,secnumarabic,amssymb, nobibnotes, aps, prd]{revtex4-1}
\RequirePackage[english]{babel}
\RequirePackage[utf8]{inputenc}
\RequirePackage{hyperref}
\hypersetup{colorlinks=true, citecolor=blue, urlcolor=blue, linkcolor=blue}

\RequirePackage[]{amsmath,amssymb}

\newcommand{\revtex}{REV\TeX\ }
\newcommand{\classoption}[1]{\texttt{#1}}
\newcommand{\macro}[1]{\texttt{\textbackslash#1}}
\newcommand{\m}[1]{\macro{#1}}
\newcommand{\env}[1]{\texttt{#1}}
\setlength{\textheight}{9.5in}

\RequirePackage[]{graphicx}

\RequirePackage{physics}
\RequirePackage{siunitx}
\sisetup{%
	exponent-product = \times,
	output-decimal-marker = {.},
	range-units = single,
	list-units = single,
	group-minimum-digits = 4,
	group-digits = integer,
	group-separator = {\,},
	per-mode = symbol,
	separate-uncertainty = true,
	detect-all = true}

\RequirePackage{cleveref}

\usepackage[dvipsnames]{xcolor}
\newcommand{\red}[1]{\textcolor{red}{\textbf{#1}}}
\newcommand{\green}[1]{\textcolor{ForestGreen}{\textbf{#1}}} 
\newcommand{\teal}[1]{\textcolor{teal}{\textbf{#1}}}

\RequirePackage[normalem]{ulem}
\RequirePackage{orcidlink}

\begin{document}

\title{Sub-shot-noise interferometry with two mode quantum states}

\author{Quentin Marolleau\,\orcidlink{0009-0002-3587-3912}}
% \email[contact: ]{\texttt{name}.\texttt{surname}@institutoptique.fr}
\author{Charlie Leprince\,\orcidlink{0009-0002-5490-6767}}
\author{Victor Gondret\,\orcidlink{0009-0005-8468-161X}}%
\author{Denis Boiron\,\orcidlink{0000-0002-2719-5931}}%
\author{Christoph I. Westbrook\,\orcidlink{0000-0002-6490-0468}}
\affiliation{Université Paris-Saclay, Institut d’Optique Graduate School, CNRS, Laboratoire Charles Fabry, 91127, Palaiseau, France}
\date{\today}%

\begin{abstract}
    We study the feasibility of sub-shot-noise interferometry with imperfect detectors, starting from twin-Fock
    states and two-mode squeezed vacuum states. We derive analytical expressions for the corresponding phase uncertainty.
    We find that one can achieve phase shift measurements below the standard quantum limit, as long as the losses are
    smaller than a given threshold, and that the measured phase is close enough to an optimal value. We provide our
    analytical formulae in a Python package, accessible online.
\end{abstract}

\maketitle

\section{Introduction}

The ability to map many physical quantities onto a phase shift makes interferometry both a crucial and generic technique
in metrology. Because of entanglement, some non-classical states can lead to improved phase resolution compared to their
classical counterparts \cite{giovannettiQuantumEnhancedMeasurementsBeating2004,giovannettiQuantumMetrology2006,
    pezzeEntanglementNonlinearDynamics2009,pezzeQuantumMetrologyNonclassical2018}.
Given an experimental resource of $N$ identical bosons, an attractive choice is to use NOON states
$\frac{1}{\sqrt{2}} \left( \ket{N,0} + \ket{0,N} \right)$. Indeed  NOON states lead to a ``Heisenberg limited" phase
uncertainty {$\Delta \phi = \mathcal{O}(N^{-1})$} \cite{bollingerOptimalFrequencyMeasurements1996a,
    dowlingCorrelatedInputportMatterwave1998,giovannettiAdvancesQuantumMetrology2011},
known to be optimal \cite{heitlerQuantumTheoryRadiation1954,ouFundamentalQuantumLimit1997}. This is a much more
advantageous scaling than the best phase sensitivity reachable with classical systems ($\Delta \phi = 1/\sqrt{N}$),
provided by a coherent state, and usually called the \emph{standard quantum limit} (SQL) or \emph{shot noise}.
Other authors have proposed the use of ``twin Fock" (TF) states $\ket{\mathrm{TF}}=\ket{N/2,N/2}$ and have shown that
they also can achieve $1/N$ scaling in phase sensitivity \cite{hollandInterferometricDetectionOptical1993,
    bouyerHeisenberglimitedSpectroscopyDegenerate1997}.

Unfortunately, NOON states are extremely fragile and behave even worse than classical states when losses are present
\cite{dunninghamInterferometryStandardQuantum2002,dornerOptimalQuantumPhase2009}. In addition, they are challenging to
prepare, and their realization with $N$ larger than a few units has not been achieved
\cite{nagataBeatingStandardQuantum2007,afekHighNOONStatesMixing2010}.

The effect of loss in quantum enhanced interferometers has been studied more generally, and states minimizing the phase
uncertainty in the presence of loss have been found \cite{demkowicz-dobrzanskiQuantumPhaseEstimation2009,
    kolodynskiPhaseEstimationPriori2010,knyshScalingLawsPrecision2011}. These states can be expressed as superpositions
of  states of the form:
\begin{equation}
    \ket{N :: m}_\pm = \frac{1}{\sqrt{2}} \left( \ket{N-m,m} \pm \ket{m,N-m} \right).
\end{equation}
Like NOON states, these states involve superpositions of strong population imbalances between the two modes (a NOON
state is in fact the special case $m=0$). This imbalance is responsible for the enhanced sensitivity, but these states
can retain their coherence despite a loss of order $m$ particles, and thus are more robust \cite{huverEntangledFockStates2008}.
In the presence of losses however, even these states can only surpass the standard quantum limit by a numerical factor,
meaning that $\Delta \phi = \mathcal{O}(N^{-1/2})$ is the best scaling possible \cite{kolodynskiPhaseEstimationPriori2010,
    escherGeneralFrameworkEstimating2011}. Here again, although the optimal states are conceptually interesting, their
experimental realization is not presently realistic.

On the other hand, the mixing on a beam splitter of the twin-Fock states mentioned above gives rise to a superposition
of $\ket{2n::2k}_\pm$ states \cite{camposQuantummechanicalLosslessBeam1989,yuspasibkoInterferenceMacroscopicBeams2014,
    laloe_quantum_2012}, and one might wonder about the robustness of such a superposition in the presence of loss. A
related state is the two-mode squeezed state (TMS) \cite{anisimovQuantumMetrologyTwoMode2010}, which is a superposition
of twin Fock states with different particle numbers. Both of these states are widely used and can be produced with a
large number of particles \cite{luoDeterministicEntanglementGeneration2017,deng2023heisenberglimited,
    andersMomentumEntanglementAtom2021,bookjansStrongQuantumSpin2011,shiskhakovMacroscopicHongOu2013,
    harderSingleModeParametricDownConversionStates2016}. These states are different from another type of experimentally
realizable state, the ``spin squeezed'' states, see fig. 5 of~\cite{pezzeQuantumMetrologyNonclassical2018}.

Other authors have studied the behaviour of twin Fock states in non-ideal interferometers \cite{tichy_double-fock_2015}.
The focus of that work was on procedures to identify different decoherence mechanisms.
Our interest here is rather to analyse how losses affect the scaling of the phase sensitivity with the number of particles.
Unlike for spin squeezed states, the relevant observable is not simply the population difference and in fact several
choices are a priori possible. We will follow other authors in using the variance of the population difference as the
interferometric observable \cite{hollandInterferometricDetectionOptical1993,bouyerHeisenberglimitedSpectroscopyDegenerate1997}.
We find that the sensitivity in this case only differs from that of the optimal state by a numerical factor and that one
can surpass the standard quantum limit if the losses are low enough.

%%%%%%%%%%%%%
%  Our model
%%%%%%%%%%%%%
\section{Our model}
We will consider the interferometer configuration represented in \cref{fig:schematic_MZI}, and for the sake of clarity we
will distinguish the \emph{input} state (before the first beam splitter) that one must prepare, from the \emph{probe}
state (after the first beam splitter) that exhibits some phase sensitivity. We assume that the losses are only caused by
the detectors, having the same quantum efficiency $\eta$ and we will consider ${\Delta \phi = 1 / \sqrt{\eta N}}$ to be
the standard quantum limit, against which we should compare our results. Our input state is either a twin Fock state or
a two-mode squeezed state. Note that without an initial beam splitter, these states produce interference patterns that
are independent of the phase \cite{hongMeasurementSubpicosecondTime1987,camposQuantummechanicalLosslessBeam1989,
    yuspasibkoInterferenceMacroscopicBeams2014}.

% Figure environment removed

Two-mode squeezed states are spontaneously generated from vacuum with a quadratic interaction Hamiltonian. By denoting
${\xi = r e^{i \theta}}$ the squeezing parameter, whose norm $r$ is proportional to the interaction time, such a state
reads
\begin{equation}
    \ket{\mathrm{TMS}} = \frac{1}{\cosh(r)} \sum\limits_{n=0}^\infty e^{i n \theta} \tanh^n(r) \ket{n,n}
\end{equation}
in the Fock basis relative to the modes $\hat{a}_1$ and $\hat{a}_2$ (see \cref{fig:schematic_MZI}).

The action of the interferometer on the input state is described by the unitary operator $\hat{U}$:
\begin{equation}
    \hat{U} = \hat{S} \begin{pmatrix}
        e^{i\phi} & 0 \\ 0 & 1
    \end{pmatrix}     \hat{S} = e^{i \frac{\phi}{2}}
    \begin{bmatrix}
        i \sin(\frac{\phi}{2}) & \cos(\frac{\phi}{2})    \\
        -\cos(\frac{\phi}{2})  & -i \sin(\frac{\phi}{2})
    \end{bmatrix}
\end{equation}
The losses are modelled by additional beam splitters $\hat{S}_\eta$ placed at the output ports:
\begin{equation}
    \hat{S}_\eta =
    \begin{bmatrix}
        \sqrt{\eta}     & \sqrt{1-\eta} \\
        - \sqrt{1-\eta} & \sqrt{\eta}
    \end{bmatrix}
\end{equation}
With the input and output annihilation operators defined in \cref{fig:schematic_MZI}, we introduce the additional
notations for the number operators:
\begin{equation}
    \hat{N}_{\alpha_i} = \hat{\alpha}^\dagger_i \hat{\alpha}_i
    \quad / \quad \alpha \in \{a,b,c \} \ , \ i \in\{ 1,2 \}
\end{equation}
and the detected particle number difference at the output, with and without losses:
\begin{equation}
    \left\{
    \begin{aligned}
        \hat{D}_\eta & = \frac{1}{2} \left( \hat{N}_{c_2} - \hat{N}_{c_1} \right)                      \\
        \hat{D}      & = \frac{1}{2} \left( \hat{N}_{b_2} - \hat{N}_{b_1} \right) = \hat{D}_{\eta = 1}
    \end{aligned}
    \right.
\end{equation}

We also denote ${N=\ev{\hat{N}_{a_1}+\hat{N}_{a_2}}=\ev{\hat{N}_{b_1}+\hat{N}_{b_2}}}$ the average number of particles
in the initial state. In the case of a twin Fock state $\ket{n,n}$, we simply have $N=2n$, whereas for a two-mode
squeezed state $N = 2 \sinh^2(r)$, i.e. twice the average number of particles per mode. The mean number of detected
particles therefore is $\eta N$.

The operator $\hat{U}$ provides the expansion of $\hat{D}$ in terms of the input modes:
\begin{equation}
    \hat{D} =\frac 12 \left[\cos(\phi) \, \left( \hat{N}_{a_1} - \hat{N}_{a_2} \right) +i \sin(\phi) \, \left( \hat{a}^\dagger_1 \hat{a}_2  - \hat{a}_2^\dagger \hat{a}_1\right) \right]
\end{equation}
Therefore, whatever the phase $\phi$ and the quantum efficiency $\eta$, a twin Fock state placed at the input of the
interferometer yields a vanishing expectation value for $\hat{D}$. Due to linearity, the same is true for two-mode
squeezed states. This means that $\hat{D}$ itself is not a suitable observable to recover information about the phase
$\phi$ with those states. However one can study  $\hat{D}^2$ which characterizes the width of these distributions.

Indeed, one can derive \cite{supplemental}:
%
\begin{equation}
    \left\{
    \begin{aligned}
        \ev{\hat{D}_\eta^2}_{\mathrm{tf}}  & = \eta^2 \frac N4 \left(1+\frac N2\right)\sin^2(\phi) + \eta (1-\eta) \frac N4 \\
        \ev{\hat{D}_\eta^2}_{\mathrm{tms}} & = \eta^2 \frac N2 \left(1+\frac N2\right)\sin^2(\phi) + \eta (1-\eta) \frac N4
    \end{aligned}
    \right.
\end{equation}
making explicit the phase dependence. The $\eta (1-\eta) \frac N4$ offset is the Poissonian noise due to the fact that
the losses at each detector are uncorrelated.

%%%%%%%%%%%%
%  Results
%%%%%%%%%%%%
\section{Results}
The phase uncertainty can be computed analytically using
\begin{equation}
    \Delta \phi =\frac{\sqrt{\mathrm{Var}\left[\hat{D}_\eta^2\right]}}{\left|\dfrac{\partial}{\partial \phi}\left[ \ev{\hat{D}_\eta^2} \right] \right|}.
    \label{eq:phase_uncertainty}
\end{equation}
If the detectors are lossless ($\eta =1$), the phase uncertainties are given by:
\begin{equation}
    \begin{cases}
        \Delta \phi_{\mathrm{tf}} = \dfrac{1}{\cos (\phi ) \sqrt{N (N+2)}} \sqrt{2 + \left(-3 + \frac N4 + \frac{N^2}{8}\right) \sin ^2(\phi )} \\
        \Delta \phi_{\mathrm{tms}} = \dfrac{1}{\cos (\phi ) \sqrt{N (N+2)}} \sqrt{1 + 2 N (N+2) \sin ^2(\phi )}
    \end{cases}
    \label{eqlossless}
\end{equation}
In the neighbourhood of ${\phi = 0}$, we find Heisenberg limited scaling ${\Delta \phi = \mathcal{O}(N^{-1})}$. We also
note that the TMS state outperforms the TF state by a factor of $\sqrt{2}$.


% Figure environment removed
% Figure environment removed

When we include losses, the analogous expressions become rather long and we leave them to the supplementary materials
\cite{supplemental}. In the example in \cref{fig:phase_uncertainty}, we show that the phase uncertainty $\Delta \phi$
can be smaller than the standard quantum limit. In addition, the phase uncertainty has a minimum at a non-zero phase
$\phi_0$ which depends on the detection efficiency, number of particles and the input state (see \cref{fig:optimal_phi}).
The optimal phase is shifted because, in presence of losses, $\mathrm{Var}\left[\hat{D}_\eta^2\right]$ does not vanish
at $\phi=0$, leading to a divergence ${\Delta \phi \underset{\phi = 0}{=} \mathcal{O}(\phi^{-1})}$. Also, unlike the
lossless case, in this situation the twin-Fock state outperforms the two-mode squeezed state even at the optimal phase
$\phi_0$ \cite{supplemental}.

This type of profile has been observed experimentally \cite{luckeTwinMatterWaves2011}. From the study of the variations
of $\Delta \phi$ as a function of $\phi$, one can compute the optimal phase $\phi_0$ around which an experiment should
operate to perform precision measurements. This means that during an experiment, one must be able to tune a phase offset,
for instance in optics by adding a tiltable glass plate.

In \cref{fig:optimal_phi} we show color maps of the values of $\phi_0$ as a function of the number of particles $N$ and
the quantum efficiency $\eta$. Regions where sub-shot-noise measurements are possible correspond to non-hashed regions.
It appears in these maps that this question is mostly related to the quantum efficiency of the detectors: depending on
whether one is dealing with twin Fock or two-mode squeezed states, a threshold of $\eta \approx 0.7$ or respectively
$\eta \approx 0.9$ must be achieved to surpass the standard quantum limit.

% Figure environment removed

We have computed $\Delta\phi_0$ \cite{supplemental}, the phase uncertainty when the measurement is performed at the
optimal phase $\phi_0$. When $N$ is small, $\Delta\phi_0$ varies similarly to a power law ${\Delta\phi_0 \approx 1 / N^\alpha}$
with ${0.5 < \alpha < 1}$, depending on the value of $\eta$ (an example is plotted in \cref{fig:delta_phi_phi0}).
Experimentally, in this region one obtains significant gains with respect to the standard quantum limit by increasing
the number of particles. In the asymptotic region, where $N$ goes to infinity, we recover the ${\Delta\phi_0 = \mathcal{O}(N^{-1/2})}$ scaling \cite{kolodynskiPhaseEstimationPriori2010,escherGeneralFrameworkEstimating2011}.

We also compute
\begin{equation}
    \gamma(\eta) = \lim\limits_{N\rightarrow \infty}\sqrt{\eta N} \, \Delta\phi_0
    \label{eq:def_gamma}
\end{equation}
which is the ratio between $\Delta \phi_0$ and the standard quantum limit, in the asymptotic limit. This quantity tells
what value of $\eta$ must be reached to go below the SQL. It has been proven \cite{kolodynskiPhaseEstimationPriori2010}
that
\begin{equation}
    \sqrt{\eta N} \, \Delta\phi \geq \sqrt{1-\eta}
    \label{eq:lower_bound_gamma}
\end{equation}
but this bound is tight only when using optimal input states, as well as an observable which is not explicitly known.
In our case, the function $\gamma$ is actually a simple dilation of the lower bound (\cref{eq:lower_bound_gamma}) (see
\cref{fig:res_limit}):
\begin{equation}
    \left\{
    \begin{aligned}
        \gamma^{\mathrm{tf}}(\eta)  & = \sqrt{3} \, \sqrt{1-\eta}                                                                                                                                           \\
        \gamma^{\mathrm{tms}}(\eta) & = \vphantom{\left(\frac{2}{5}\right)^{1/4}} \smash{\underbrace{\left(\frac{2}{5}\right)^{1/4} \sqrt{5 + 2 \sqrt{10}}}_{\displaystyle \approx 2.676}} \, \sqrt{1-\eta}
    \end{aligned}
    \right.
    \vspace*{3ex}
    \label{eq:lowerbondTFTMS}
\end{equation}
Our simple measurement protocol is therefore similar to an optimal situation where ideal states are used.
% Figure environment removed

\newpage
\section{Conclusion}

We have shown that two classes of experimentally accessible states, twin-Fock and two-mode squeezed states can behave in
a way reminiscent of ideal ones with respect to their phase sensitivity in interferometers. In the absence of any loss,
their phase sensitivity exhibits $\mathcal{O}(N^{-1})$ scaling, as do NOON states. On the other hand, in the presence of
loss, they are more robust than NOON states. Although the sensitivity scales only as $\mathcal{O}(N^{-1/2})$ they can
still surpass the standard quantum limit if the losses are kept small enough. In this sense they resemble other ideal
states which have been shown to be optimal in the presence of loss, only differing from the optimal states by a
numerical factor, see \cref{eq:lowerbondTFTMS}. We show in \cref{fig:delta_phi_phi0} that using a twin-Fock state and a
95\% quantum efficiency results in a 8 dB improvement compared to the standard quantum limit which is not very far from
the theoretical bound of 13 dB given by \cref{eq:lowerbondTFTMS}. For a two-mode squeezed state the gain is only 4.4 dB.

We emphasize that minimizing the loss is critical. Fig.~\ref{fig:res_limit} shows that both types of state require a
minimum quantum efficiency to achieve a gain. Fig.~\ref{fig:optimal_phi} shows that this minimum is roughly independent
of the number of particles on that state. Despite this drawback, we expect that such improvements could be useful in
some interferometers: for example when increasing the number of particles to reduce the shot noise is not practical.
Whether twin Fock or two-mode squeezed states constitute a real advantage compared to spin squeezing will require more
work in the future using comparisons in realistic experimental situations \cite{pezzeQuantumMetrologyNonclassical2018}.
The fact that these relatively accessible states are not far from the optimized ones is an encouraging sign.

Our analytical formulae are provided in the supplementary materials and are implemented in a Python package, accessible
online at \url{https://github.com/quentinmarolleau/qsipy}.


\begin{acknowledgments}
    The research leading to these results has received funding from QuantERA Grant No. ANR-22-QUA2-0008-01 (MENTA) and
    ANR Grant No. 20-CE-47-0001-01 (COSQUA), the LabEx PALM, Région Ile-de-France in the framework of the DIM SIRTEQ
    program and Quantum Paris-Saclay.
\end{acknowledgments}
\clearpage

\bibliography{bibliography}


\end{document}