\section{Model components}\label{sec:models:components}
As the human metabolism is a set of chemical reactions, the gastrointestinal tract can be modeled mathematically using modeling techniques from chemical reaction engineering. In this section, we briefly outline a systematic modeling approach using stoichiometry and reaction kinetics in combination with ideal CSTRs and PFRs. Furthermore, delays play an important role in metabolic modeling~\citep{Voit:2017}, and we describe several mathematical models and approximations of delayed signals.

% CITE THESE INSTEAD OF MIXRAJI:ETAL:1988
% https://www.ncbi.nlm.nih.gov/pmc/articles/PMC5643013/pdf/nihms869909.pdf
% https://www.eolss.net/sample-chapters/c02/E6-188-14.pdf <- THIS DOESN'T SEEM TO BE PROPERLY PUBLISHED: MAYBE IT'S A TECHNICAL REPORT

\input{./tex/model_components/stoichiometry}
\input{./tex/model_components/cstr}
\input{./tex/model_components/pfr}

\subsection{Delays}
Here, we describe different formulations and approximations of a model, where $y$ is equal to the input signal~$u$ delayed by $\tau_d$, i.e.,
%
\begin{align}
\label{eq:TimeDelayModelYU}
    y(t) &= u(t - \tau_d).
\end{align}
%
The Laplace transform of \eqref{eq:TimeDelayModelYU} is
%
\begin{subequations}\label{eq:Laplace:TimeDelayModelYU}
\begin{align}
    \label{eq:Laplace:TimeDelayModelYU:YGU}
    Y(s) &= G(s) U(s), \\
    %
    \label{eq:Laplace:TimeDelayModelYU:G}
    G(s) &= e^{-\tau_d s}.
\end{align}
\end{subequations}

Alternatively, the system~\eqref{eq:TimeDelayModelYU} can be formulated as a series of $M$ systems with smaller time delays:
%
\begin{align}
    y_i(t) &= y_{i-1}(t - \tau_d/M), & i &= 1, \ldots, M,
\end{align}
%
where
%
\begin{subequations}
\begin{align}
    y_0(t) &= u(t), \\
    y(t) &= y_M(t).
\end{align}
\end{subequations}
%
The Laplace transform of this series of systems are
%
\begin{subequations}
\label{eq:Laplace:TimeDelayModelYU:Multiple}
\begin{align}
    Y_i(s) &= G_i(s) Y_{i-1}(s), & i &= 1, \ldots, M, \\
    G_i(s) &= e^{-(\tau_d/M) s},
\end{align}
\end{subequations}
%
where
%
\begin{subequations}
\begin{align}
    Y_0(s) &= U(s), \\
    Y(s)   &= Y_M(s).
\end{align}
\end{subequations}
%
Approximating $G_i$ in~\eqref{eq:Laplace:TimeDelayModelYU:Multiple} will typically result in a lower error than approximating $G$ in~\eqref{eq:Laplace:TimeDelayModelYU} because the delay is smaller. However, the increased accuracy comes at the expense of higher computational cost.
%
Below, we show different approximations based on a dynamical system in the form
%
\begin{subequations}
\label{eq:linear:state:space:model}
\begin{align}
    \dot   x(t) &= A_c x(t) + B_c u(t), \\
    \tilde y(t) &= C_c x(t) + D_c u(t).
\end{align}
\end{subequations}

\input{./tex/model_components/lag_delay_approximation}
\input{./tex/model_components/pade_delay_approximation}
\input{./tex/model_components/transport_delay_model}
\input{./tex/model_components/algebraic_delay_approximation}

% Figure environment removed