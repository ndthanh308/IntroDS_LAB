\subsection{Lagrange polynomials}\label{sec:spectral:galerkin:lagrange:polynomials}
Here, we describe the Lagrange polynomials which we use several times in the derivation of the spectral Galerkin method presented in this section.
%
For arbitrary $z$, the $m$'th Lagrange polynomial of order $M+1$ and its derivatives are~\citep{Berrut:Trefethen:2004}
%
\begin{subequations}
	\begin{align}
		\ell_m(z) &= \prod_{\substack{l = 0\\l \neq m}}^M \frac{z - z_l}{z_m - z_l} = \frac{1}{s(z)} \frac{\tilde w_m}{z - z_m}, \\
		%
		\diff{\ell_m}{z}(z) &= \frac{1}{s(z)}\left(\frac{-\tilde w_m}{(z - z_m)^2} - \ell_m(z) \diff{s}{z}(z)\right), \\
		%
		\ndiff[2]{\ell_m}{z}(z)
		&= \frac{1}{s(z)}\bigg(\frac{2 \tilde w_m}{(z - z_m)^3} - 2 \diff{\ell_m}{z}(z) \diff{s}{z}(z) \nonumber \\
		&- \ell_m(z) \ndiff[2]{s}{z}(z)\bigg),
	\end{align}
\end{subequations}
%
where the corresponding weight is
%
\begin{align}
	\tilde w_m &= \prod_{\substack{l = 0\\l \neq m}}^M \frac{1}{z_m - z_l},
\end{align}
%
and the auxiliary function, $s$, and its derivatives are given by
%
\begin{subequations}
	\begin{align}
		s(z) &= \sum_{l=0}^M \frac{\tilde w_l}{z - z_l}, \\
		%
		\diff{s}{z}(z) &= \sum_{l=0}^M \frac{-\tilde w_l}{(z - z_l)^2}, \\
		%
		\ndiff[2]{s}{z}(z) &= \sum_{l=0}^M \frac{2 \tilde w_l}{(z - z_l)^3}.
	\end{align}
\end{subequations}
%
The above expressions for the derivative of $\ell_m$ cannot be evaluated in the collocation points, $\{z_m\}_{m=0}^M$, because it would result in division by zero. In the collocation points, the Lagrange polynomials and their derivatives are
%
\begin{subequations}
	\begin{align}
		\ell_m(z_l) &= \delta_{ml}, \\
		%
		\diff{\ell_m}{z}(z_l) &=
		\begin{cases}
			\frac{\tilde w_m}{\tilde w_l (z_l - z_m)}, & l \neq m, \\
			-\sum\limits_{\substack{j = 0\\j\neq l}}^M \diff{\ell_j}{z}(z_i), & l = m,
		\end{cases} \\
		%
		\ndiff[2]{\ell_m}{z}(z_l) &=
		\begin{cases}
			-2 \diff{\ell_m}{z}(z_l)\left(-\diff{\ell_l}{z}(z_l) + \frac{1}{z_l - z_m}\right), & l \neq m, \\
			-\sum\limits_{\substack{j = 0\\j\neq l}}^M \ndiff[2]{\ell_j}{z}(z_i), & l = m.
		\end{cases}
	\end{align}
\end{subequations}
%
\begin{remark}
There is a sign error in the last term in the parenthesis on the right-hand side of~(9.4) in the paper by~\cite{Berrut:Trefethen:2004}.
\end{remark}