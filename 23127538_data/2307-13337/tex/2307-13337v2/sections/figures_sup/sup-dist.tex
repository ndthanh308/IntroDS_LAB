\newcommand{\sidecaption}[2][\empty]% #1=caption, #2=image
{\bgroup% use local registers
  \sbox0{#2}% measure image
  \rotatebox[origin=Bl]{90}{\parbox{\ht0}{\subcaption[position=above]{#1}}}%
  \usebox0
\egroup}
% Figure environment removed


