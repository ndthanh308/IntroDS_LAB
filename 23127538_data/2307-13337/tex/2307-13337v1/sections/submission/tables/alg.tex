\begin{algorithm}[t]
\caption{Quantization-aware training process of ODM} 
\label{algo-odm}
\textbf{Input:} Pre-trained 32-bit network $\mathcal{P}$, distribution offset ratio $p$. \\
\textbf{Output:} Quantized network $\mathcal{Q}$.

\begin{algorithmic}
\State Using $\mathcal{P}$, obtain $M_\mu^i$ and $M_\sigma^i$ $(i=1,\cdots,\#\text{layers})$ using Eq.~\eqref{eq:indicators}
\For{$i=1,\cdots,$ \# layers}
    \State Initialize quantization range parameters $\alpha_l$, $\alpha_u$ for feature $x_i$ of $\mathcal{Q}$ using percentile
    \If{$M_\mu^i$ is in top-$p$ ratio among $M_\mu^i$s}
        \State Shift $x_i$ with $S_\mu$ using Eq.~\eqref{eq:offsets-b}
    \EndIf
    \If{$M_\sigma^i$ is in top-$p$ ratio among $M_\sigma^i$s} 
        \State Scale $x_i$ with $S_\sigma$ using Eq.~\eqref{eq:offsets-w}
    \EndIf
    \State Given $x_i$, obtain variance regularization loss $\mathcal{L}_{V}(x_i)$ using Eq.~\eqref{eq:varianceloss}
\State Given $\mathcal{L}_V$ and $\mathcal{L}_1$, update parameters of $\mathcal{Q}$ using Eq.~\eqref{eq:cooperativeloss}
\EndFor
\end{algorithmic}
\end{algorithm}
