\documentclass{article}
\usepackage{graphicx} % Required for inserting images
\usepackage[utf8]{inputenc}
\usepackage{authblk}
\usepackage{caption}
\usepackage{hyperref}
\usepackage{mathtools, nccmath}
\usepackage{amssymb}
\usepackage{geometry}
\geometry{legalpaper, margin=1in}

\title{Simple few-shot method for spectrally resolving the wavefront of an ultrashort laser pulse}
\author[1,3,*]{Slava Smartsev}
\author[2,3]{Aaron Liberman}
\author[1]{Igor A. Andriyash}
\author[1]{Antoine Cavagna}
\author[1]{Alessandro Flacco}
\author[1]{Camilla Giaccaglia}
\author[1]{Jaismeen Kaur}
\author[1]{Jos\'ephine Monzac}
\author[2]{Sheroy Tata}
\author[1]{Aline Vernier}
\author[2]{Victor Malka}
\author[1]{Rodrigo Lopez-Martens}
\author[1]{J\'er\^ome Faure}

%\author[1,2,3,*]{Authors}

\affil[1]{Laboratoire d’Optique Appliquée, ENSTA Paris, CNRS, Ecole Polytechnique, Institut Polytechnique de Paris, 828 Bd. des Maréchaux, 91120 Palaiseau, France}
\affil[2]{Department of Physics of Complex Systems, Weizmann Institute of Science, 234 Herzl St., Rehovot 7610001, Israel}
\affil[3]{The authors contributed equally to this work}

\affil[*]{smartslava[at]gmail[dot]com}

\date{}

\usepackage{lineno}
\usepackage{float}

\begin{document}



\maketitle

\begin{abstract}
We present a novel and straightforward approach for the spatio-spectral characterization of ultrashort pulses. This minimally intrusive method relies on placing a mask with specially arranged pinholes in the beam path before the focusing optic and retrieving the spectrally-resolved laser wavefront from the speckle pattern produced at focus. We test the efficacy of this new method by accurately retrieving chromatic aberrations, such as pulse front tilt, pulse front curvature, and higher-order aberrations introduced by a spherical lens. The simplicity and scalability of this method, combined with its compatibility with single-shot operation, make it a promising candidate to become a new standard diagnostic tool in high-intensity laser facilities.
\end{abstract}


\section{Introduction}
Ultrashort lasers, with femtosecond pulse durations, are indispensable tools in medicine, industry, and science. The advent of chirped pulse amplification (CPA) \cite{STRICKLAND_OC_1985} enabled such pulses to be amplified to peak powers of terawatts and even petawatts \cite{Danson_HPLSE_2019}. Intense, short laser pulses have opened possibilities to explore laser-matter interactions in the relativistic regime \cite{mourou-rmp06}, and their applications in a field of compact laser-plasma accelerators \cite{Esaray_RMP_2009,RMP_ions}.

Ultrashort lasers are necessarily broadband, and the spectral phase can impact the pulse's duration and shape in the temporal domain. Accurate and precise measurement of the spectral phase is the core of temporal metrology of ultrashort pulses \cite{Walmsley_09}. Typical measurements assume the spectral phase is not spatially varying, a valid approximation for small beams.

High-intensity lasers, however, operate with large beams for which the spatio-spectral phase can be very important. Spatially non-uniform dispersion effects accumulated during amplification, propagation, and focusing can lead to different spectral components of the beam ending up with different wavefronts. These wavefronts determine how and where each color is focused, ultimately shaping the full multi-color spatiotemporal intensity at the focus. These and related effects are usually referred to as spatiotemporal couplings (STCs) \cite{Akturk_2010}.

The most commonly encountered STCs are pulse-front tilt (PFT), which can be caused by the misalignment of the gratings in the compressor, and pulse-front curvature (PFC), induced by chromatic lenses \cite{Bor_89}. In most cases, STCs are undesirable because they increase pulse duration and reduce peak intensity and contrast at the focus \cite{Bourassin_OE_2011}. In some cases, however, STCs can be exploited in a controlled and intricate way to manipulate the dynamics of intense pulses in the focal region \cite{Sainte_Marie_Optika_2017,Froula_NPH_2018}. Control over the velocity with which energy is deposited along the focal region, through the tailoring of STCs, paves the way toward a new generation of laser-driven particle accelerators \cite{Debus_2019_PRX,Caizergues_NP_2020,Palastro_PRL_2020} and X-ray sources \cite{Kabacinski_2023}. Techniques for accurate and straightforward measurement of STCs are necessary to mitigate unwanted couplings and enable the utilization of STCs as a critical degree of freedom in an experiment.


The development of spatiotemporal metrology is well summarized in several reviews \cite{Akturk_2010,Dorrer_2019,Jolly_IOP_2020}.
The main methods of STC characterization of ultrashort pulses are listed below.

(1) There are methods that utilize spectrally-resolved wavefront measurements based on Shack-Hartmann sensors. HAMSTER, for instance, uses an acousto-optic programmable dispersive filter to isolate spectral components and then a Shack-Hartmann sensor to reconstruct each component's wavefront \cite{Cousin_OL_2012}. Other similar techniques employ optical filtering to narrow the pulse's spectral content \cite{Kim_OE_2021,Weise_2023}.

(2) A number of methods are based on spatially-resolved Fourier-transform spectroscopy (FTS). A self-referenced version of FTS, TERMITES \cite{Miranda_OL_2014,Pariente_NatPhot_2016}, uses a spatially filtered copy of the beam as a clean reference for interference in the near field. INSIGHT \cite{Borot_OE_2018} uses a similar approach, but the interference is observed in the far field, and the Gerchberg–Saxton (GS) iterative algorithm \cite{GS_1972} is used to retrieve the spatially resolved spectral information of the beam.%,Ilina_QE_2009

(3) Some methods use hyperspectral imaging techniques for STC measurements. One example is broadband ptychography which is based on coherent diffraction imaging. In ptychography, the beam under analysis is scattered off an object, forming a diffraction pattern. Phase retrieval algorithms are used to reconstruct the initial field from the diffraction patterns \cite{BATEY_UM_2014,Goldberg_OE_2021}.

(4) Measurement methods such as RED-SEA-TADPOLE \cite{Gallet_OL_2014} characterize STCs by the spectral interference of the unknown test pulse with a known reference pulse. 


(5) Yet another method, STRIPED-FISH \cite{Gabolde_OE_2006}, is based on holography and requires a spatially filtered reference beam. Recently, a similar method, CMISS \cite{Xu_OL_2022}, which does not require a special reference pulse, was proposed.

(6) Finally, there are STC measurement methods based on broadband Young's Double Slit Interferometry. The method relies on the fact that the far-field diffraction pattern of an ultra-short beam that impinges on Young's double slit (or two-pinholes) contains information about the time delay between the two sub-pulses that go through the slits (or pinholes) \cite{Netz_APB_2000,Smartsev_JOPT_2022}.

While many of these techniques can effectively yield the spatiotemporal characterization of the beam, they generally have relatively complex experimental setups that can be expensive and challenging to install. Moreover, many of these methods rely on optical components that are not typically utilized in the beamline, such as beam splitters, band-pass filters, or gratings. As a result, they cannot be employed as \emph{in-situ} diagnostics, and their accuracy in representing the true spatiotemporal field of the experimental focal spot is limited. The most widely used techniques suffer from the need to take dozens or even hundreds of measurements, limiting their usefulness in high-power, low-repetition rate systems. The single-shot techniques, meanwhile, are often experimentally cumbersome. These limitations have made developing next-generation spatiotemporal measurement techniques a subject of intense study in the world of high-power lasers.


% Figure environment removed

This paper introduces an experimentally simple and novel method for measuring the multispectral wavefronts of ultrashort laser pulses in a single shot or only a few shots. IMPALA, or Iterative Multispectral Phase Analysis for LAsers, is based on the linear far-field interferometry of multiple beamlets generated by a special pinhole mask. Instead of a two-pinhole mask, we generalize the Young's Double Slit Interferometry method to dozens of pinholes. The pinholes are arranged in a specific aperiodic manner to ensure that each interference pattern created by any pair of holes does not overlap with others in the spatial Fourier plane, an idea inspired by phase retrieval in randomly positioned cores of a fiber bundle \cite{Kogan_17}. It allows retrieval of spectrally resolved wavefronts of the ultrashort beam, spatially sampled at the pinhole positions in one shot, which is sufficient for low spatial resolution wavefront retrieval. In addition, rotations of the mask allow for improved spatial resolution of the wavefronts. This particular implementation of the pinhole mask was optimized to get a high spatial resolution from 12 shots, each with a unique rotation of the mask. Our method is remarkably straightforward because the only non-standard optical element it requires is a special pinhole mask placed before the focusing optics used in the experiment. This mask can be easily cut or 3D printed. The method is minimally intrusive and can be readily moved in and out of an existing optical setup. It is easily scalable to different beam sizes, focal lengths of the optics and spectral bandwidths. By combining scalability, a simple setup, low cost, and single-shot compatibility with sufficient spatial and spectral resolution for many applications, IMPALA has the characteristics necessary to become a standard diagnostic tool.



% Figure environment removed
\section{Description about the method}
The simplified experimental setup is depicted in Fig.~\ref{fig:Setup}. An ultrashort laser pulse with unknown STCs impinges on the mask and is focused by a parabolic mirror or lens. A microscope objective images the optic's focal plane onto a CCD camera where the beamlets interfere and form a speckle pattern, shown in Fig.~\ref{fig:Algo} as a polychromatic far-field (FF) intensity map. Another CCD camera with photographic objective images the surface of the mask to record the beam's spatial profile, which is shown in Fig.~\ref{fig:Algo} as polychromatic near-field (NF) intensity.

As we showed in \cite{Smartsev_JOPT_2022}, each pair of broadband beamlets forms a structured fringe pattern at the focus in the FF. The spatial fast Fourier transform (FFT) of this fringe pattern consists of a central peak and two sideband streaks, whose positioning depends on the beamlets' relative orientation. The length of the streaks depends on the bandwidth of the beam and also on the hole separation distance (See Eq. 16 in \cite{Smartsev_JOPT_2022}). These streaks contain temporal information about the relative group delay between the beamlets. This is equivalent to a PFT estimate, which is proportional to the linear term in a spectrally resolved wavefront sampled at two spatial points. Generalizing this method allows the extraction of the spectrally-resolved wavefront, sampled at dozen of points in the beam. We find the optimal hole arrangement for a given number of holes and a given laser spectrum using a genetic algorithm that packs the streaks with minimum overlaps (see Appendix) to ensure proper phase retrieval.

The IMPALA algorithm is schematically shown in Fig.~\ref{fig:Algo}. The method utilizes two measured intensity profiles: the near-field before focusing (polychromatic NF intensity) and the speckle pattern at focus (polychromatic FF intensity). The spectrum of the spatially Fourier-transformed speckle intensity (FFT$\{$FF Intensity$\}$) consists of sparse streaks for a given hole arrangement of an adequately designed mask. Different colors of the beam are distributed radially along these streaks. For example, along the same streak, the "red" ($\lambda_R$) component is located closer to the center when compared to the "blue" ($\lambda_B$). This is due to the fact that the monochromatic speckle pattern has a smaller spatial frequency, which is inversely proportional to the wavelength. This separation allows us to isolate monochromatic "spots" inside the polychromatic streaks. These isolated spots (and their corresponding phases) of the Fourier-transformed speckle intensity are spatially transformed back to obtain a monochromatic speckle pattern. For the NF intensity, we assume the monochromatic components share the same spatial envelope. Having obtained monochromatic intensities in both the NF and the FF, we use the GS algorithm to find the spatial phase in the NF for each specific color. The process is then repeated for different colors to obtain spectrally-resolved wavefronts. The spatial resolution is enhanced by rotating the mask over 12 angular positions, obtaining more dense spatial sampling in the NF. It should be noted that optimizing the mask holes was designed to balance between the sparsity of speckle intensity in the Fourier plane (avoid overlapping streaks) and uniform sampling of holes in the NF when summing all 12 rotations (see Appendix).

The length of the polychromatic streak (along the radial coordinate) defines the spectral resolution of the phase measurement. Drawing from the model derived in \cite{Smartsev_JOPT_2022}, we show in Appendix that the spectral resolution is $\Delta \lambda_{impala}\approx \Delta \lambda(1+[\Delta \lambda s_b / \sqrt{2 \log 2} \lambda_0 d_b]^2)^{-1/2}$, where $\Delta \lambda$ and $\lambda_0$ are the full width at half maximum (FWHM) of the spectrum and its central wavelength, while $s_b$ and $d_b$ are the beamlets' separation and diameter (or hole diameter) in the NF, respectively. For the longest streaks in Fig.~\ref{fig:Algo}, the spectral resolution is $\Delta \lambda_{impala}\approx 10$ nm, using the experimentally relevant parameters $\Delta \lambda=30$ nm, $\lambda_0=770$ nm, $s_b=12$ mm, and $d_b=150$ \textmu m. 


\section{Results and discussion}
The experiments were performed at Laboratoire d'Optique Appliquée using the Salle Noire 3.0 laser system. The laser's front end consists of a commercial Ti:Sa oscillator (Rainbow, Femtolasers GmbH), followed by a Ti:Sa chirped pulse amplifier system (Femtopower Pro-HE) delivering 30 fs compressed pulses of up to 1.2 mJ energy with a 1 kHz repetition rate. 
We used a standard cube polarizer-waveplate pair attenuator to obtain a variable attenuation of the beam in the range of hundreds of \textmu J without introducing any STC between the measurements. In addition, a neutral density filter with an optical density of 4 was installed before the FF CCD sensor during all measurements. To avoid any risk of non-linear effects, we stretched the pulse to nearly 1 ps by introducing GDD through an acoustic-optic programmable dispersive filter (Dazzler, Fastlite) integrated into the main amplifier. We tested IMPALA by measuring the spectrally resolved wavefronts of the laser. For further testing, we introduced STCs into the laser in a controlled way and retrieved them with IMPALA, thus verifying the correctness of our method.
\subsection{Parabolic mirror as a focusing optic and introduced PFT}
We tested our method by introducing a controlled amount of PFT by acting on the parallelism of the compressor gratings in their dispersion plane (See Appendix). The focusing element, in this case, was a 100 mm focal length parabolic mirror. As seen in Fig.~\ref{fig:PFT_sing} (a), we observe a linear PFT as a function of grating misalignment in the x-axis (grating dispersion plane), while the PFT in the y-axis is nearly constant. The slight variation can be explained by an imperfect alignment of the compressor's roof mirrors, which can couple the x and y axes for PFT. In addition, we estimate the PFT with our previous method based on the interference of two beamlets by using a mask with two holes \cite{Smartsev_JOPT_2022}. The IMPALA's PFT measurement agrees both with the measured PFT using the beamlets method and the simulation. The measured wavefronts for a grating tilt of 2.3' (minutes of arc) and their Zernike decomposition are shown in Fig.~\ref{fig:Algo}.


% Figure environment removed











\subsection{Singlet lens as a focusing optic and introduced PFC}
We also tested IMPALA by using a spherical singlet lens as a focusing element. A singlet lens introduces PFC when focusing an ultrashort pulse since it has a non-negligible amount of longitudinal chromatic aberration \cite{Bor_89}. We used a 100 mm focal length plano-convex singlet lens as the focusing element (See Appendix). The measured spectrally resolved wavefronts are depicted in Fig.~\ref{fig:PFT_sing} (b). The phase fronts were unwrapped manually at a few points. The displayed phase range is limited to 2$\pi$ to make the spherical term visible. From the Zernike decomposition shown in Fig.~\ref{fig:PFT_sing} (c), it is evident that the lens introduces non-negligible chromatic defocus terms, observable in the measurement through the chromatically dependent defocus term. This corresponds to a PFC of: \mbox{PFC$_{singlet}$=0.21 fs/mm$^2$}. For comparison, the value of the PFC in the measurement with the parabola, shown in Fig.~\ref{fig:Algo}, is \mbox{PFC$_{parab}$=0.052 fs/mm$^2$}. Additionally, the lens introduces the expected spherical aberration, and the measured value quantitatively aligns well with the simulation. The other measured aberration terms (astigmatism and coma) are probably mainly due to imperfect lens alignment. The non-zero value of PFC$_{parab}$ is expected and reflects the fact that there is a chromatic beam expander in the laser chain.






\section{Conclusion}
We presented a simple yet powerful method to measure spectrally resolved wavefronts of broad-spectrum lasers. We successfully tested our method by inducing controlled STCs and demonstrating their accurate measurement. Our method performed well both when compared to simulations and when benchmarked against a previous measurement method. This method is extremely simple to implement and to scale to different systems and is compatible with high power, low repetition rate laser systems. It thus promises to become a new standard in high-power laser laboratories, potentially making STC measurements as common a part of laser diagnostics as spatial wavefront and temporal measurements are today. 
 
\subsection*{Funding} 
European Union's Horizon 2020, no. 101004730 and Advanced Grant ExCoMet 694596; Agence Nationale de la Recherche, no. ANR-20-CE92-0043-01 and no. ANR-10-LABX-0039-PALM. LaserLAB-Europe no. 871124; Schwartz/Reisman Center for Intense Laser Physics, Benoziyo Endowment Fund for the Advancement of Science, the Israel Science Foundation, Minerva, Wolfson Foundation, the Schilling Foundation, R. Lapon, Dita and Yehuda Bronicki, WIS-CNRS (IPR LAMA).
\subsection*{Acknowledgments}
We thank Prof. Dan Oron for the fruitful discussions. We also thank Dr. Nicolas Thurieau for printing the masks and Sébastien Brun and Pascal Rousseau for assistance in micro-drilling.

\subsection*{Disclosures}
The authors declare no conflicts of interest.

\subsection*{Data Availability Statement}
The data supporting this study's findings are available from the authors upon reasonable request.

\appendix

\renewcommand{\thefigure}{A\arabic{figure}}
\renewcommand{\theequation}{A\arabic{equation}}

\setcounter{figure}{0}

\section*{\underline{Appendix}}

\section{Phase retrieval algorithm}


The retrieved wavefronts for each shot (one mask rotation) presented in the main paper are obtained with the following IMPALA algorithm implementation, depicted schematically in Fig.~\ref{fig:algo}. 

(1) The measured polychromatic NF intensity, $I_{NF~{meas}}(x,y)$, and the mask transmission function, $M_{holes}(x,y)$, (holes shown larger in the figure for clarity) are used to simulate the NF field $A_{NF}(x,y)$, with perfect flat phase $\Phi _{NF~0}(x,y)=0$. 

(2) For each specific wavelength $\lambda$, this field is propagated to the FF using the Fraunhofer propagator for the specific wavelength. This results in a set of FF fields, each for a different wavelength.

(3) Taking the absolute value squared of each of these fields results in a set of simulated FF speckle intensities (for a perfect NF phase), $\tilde{I}_{FF~0,\lambda}(k_x,k_y)$.

(4) The spatial FFT of these speckle intensities then reveals the "short monochromatic streaks" structure $A_{streaks, \lambda}(\xi_x,\xi_y)$ of these speckles. The phase $\Phi_{streak~0,\lambda}(\xi_x,\xi_y)$ is useless because it is related to the perfect flat phase $\Phi _{NF~0}(x,y)$=0 we assumed.

(5) Next, we extract the measured phase from the measured speckle pattern. For this, we perform a spatial FFT on the measured polychromatic speckle pattern $\tilde{I}_{FF~meas}(k_x,k_y)$ and get the measured  $\Phi_{streak~meas}(\xi_x,\xi_y)$. We apply this measured phase onto the monochromatic streaks $A_{streaks, \lambda}(\xi_x,\xi_y)\times$ $\times\exp{[i\Phi_{streak~meas}(\xi_x,\xi_y)]}$. It should be noted that the exact positions of monochromatic streaks should overlap with the appropriate positions on the "long polychromatic streaks"; otherwise, noise will be picked up. To account for experimental uncertainties, we optimize the overlap by allowing small perturbations of hole positions (300 \textmu m range) in the NF. This process is done for each of the specific wavelengths.  

(6) Having the monochromatic short streaks with measured phase for each wavelength allows us to get the monochromatic speckles in the FF $\tilde{I}_{FF,\lambda}(k_x,k_y)$ by applying an inverse spatial FFT. 

(7) We get the field amplitude $\tilde{A}_{FF,\lambda}(k_x,k_y)$ from the intensity (and assume flat phase).

(8) The final step is to retrieve the phase in the NF iteratively using a standard Gersberg-Saxton algorithm. Propagating between the NF and FF using the Fraunhofer propagator and preserving the field amplitudes $\tilde{A}_{FF,\lambda}(k_x,k_y)$ and $A_{NF}(x,y)$ allows the algorithm to converge to the NF phase solution. We are not interested here in the FF phase but in the phase in the NF, $\Phi _{NF~GS}(x,y)$. It should be noted that for each GS iteration, we constrained each hole phase to be a constant value across the hole. 

The end result of this algorithm is a set of wavefronts, one for each of the specific wavelengths used. Combining these yields the spectrally resolved wavefront of the beam.

% Figure environment removed

\section{Spherical singlet lens wavefronts simulation}
The lens used in the experiment was a 2-inch plano-convex lens CVI-PLCX-50.8-51.5-UV made of fused silica with a radius of 51.5 mm and a central thickness of 10 mm. The approximate focal length of the lens is 100 mm. We simulated the lens-focused spectrally resolved wavefronts and their Zernike decompositions using OpticStudio (Zemax) software. Using its standard tools, we extracted the wavefronts and their Zernike decompositions (shown in the main text, Fig.~\ref{fig:PFT_sing} (c)) after recollimating the beam with an ideal lens. A normalization factor of $2(\pi)^{3/2}$ for Zernike terms extracted from OpticStudio was used to change the units to radians. The optical layout is depicted in Fig.~\ref{fig:singlet} (a). The wavefront for the 770 nm wavelength is shown in Fig.~\ref{fig:singlet} (b).

% Figure environment removed




\section{Compressor induced PFT simulation}
% Figure environment removed
We simulated the transmission grating compressor used in the experiment with the OpticStudio software and computed the induced PFT as a function of the grating misalignment angle. The optical layout is depicted in Fig.~\ref{fig:comp} (a). The compressor consists of a pair of transmission gratings which each have a 3 mm fused silica substrate and an engraved grating with a density of 1280 lines/mm. The grating surface is shown as a thin rectangular surface, and the fused silica substrate is shown as a cylindrical volume. The nominal grating angle to the incoming beam in the dispersion plane is 31 degrees. The compressor was simulated in sequential mode, which simulates a single pass through 4 gratings: G$_1$, G$_2$, G$_3$, G$_4$, rather than a double pass through 2 gratings as we had in the experiment, since G$_1$ and G$_4$ as well G$_3$ and G$_3$ are the same optical elements. To simulate induced PFT, we perturbed the angle of rotation of the first grating along the axis shown in Fig.~\ref{fig:comp} (a). For each angle, we calculated the induced amount of PFT with a special macro \cite{Slava_Thesis}, which directly extracts the value of the group delay of the pulse along the transverse spatial coordinate. The simulated PFT for small angles is in good agreement with a simple analytical estimation, as presented in Fig.~\ref{fig:comp} (b).

The analytical expression for the PFT as a function of the gratings misalignment is based on Eq. 8 in \cite{Zhao_2023}.

\begin{equation}
{\text{PFT}}=2\epsilon N \frac{\lambda_0 \tan{\beta_0}}{c \cos{\alpha}}
\end{equation}

where $\epsilon$ is the misalignment angle (in radians) in the dispersion plane, $N$ is the grating density (1280 lines/mm), $\lambda_0$ is the central wavelength (770 nm), $\alpha$ is the grating angle with respect to the beam (31 degrees), and $\beta_0$ is the first order diffraction angle, such that $\beta_0=\arcsin{(\sin{\alpha}-\lambda_0 N)}$, and $c$ is the speed of light. For example, when the misalignment angle $\epsilon=2.5$ (') (minutes of arc), the resulting PFT$\approx 3$ (fs/mm).

\section{Spectral resolution}
As we have shown in our previous work \cite{Smartsev_JOPT_2022}, for the case of two Gaussian beamlets, the resulting pair of streaks in the Fourier plane of the speckle intensity has a Gaussian form $\propto \exp{a_{SB1}}+\exp{a_{SB2}}$ where the arguments in the exponents are:

\begin{equation} \label{eq1}
a_{SB1,2}=-\frac{[\Delta \omega\tau_1 \sigma_0 \omega_0]^2+(cfk_x\pm \omega_0 s_b)^2+i\tau_1[s_b\Delta \omega^2 c f k_x\mp 4\sigma_0^2 \omega_0^3]}{4\sigma_0^2\omega_0^2+\Delta \omega^2 s_b^2}
\end{equation}
Here, $\Delta \omega$ is the laser bandwidth, $\omega_0$ is the central frequency, $\tau_1$ is the relative delay between the two beamlets, $\sigma_0$ is the spatial width of the beamlets, $ k=\omega/c$ is the k-vector, $f$ is the focal distance of the focusing optics, $s_b$ is the spatial separation of the beamlets in the near-field, and $x$ is the far-field coordinate.

Therefore, the streak's length (in the appropriate units in the spatial Fourier plane) is:
\begin{equation} \label{eq2}
\sigma_{streak}^2=2\sigma_0^2\ \omega_0^2+(\Delta \omega^2\ s_b^2)/2
\end{equation}

The width of the monochromatic streak is $\sigma_{mono~streak}^2=2\sigma_0^2\omega_0^2$ and therefore the minimal relative spectral band is:

\begin{equation}
\Delta \omega _{min}=\Delta \omega \frac{\sigma_{mono~streak}}{\sigma_{streak}}
\end{equation}

For expressing the spectral resolution of IMPALA, it is more convenient to work in wavelength units. Thus, rather than $\Delta \omega$, the laser bandwidth in frequency, we will use spectral bandwidth, $\Delta \lambda_a$, the bandwidth in wavelength units. The ratio term of the streak lengths is unaffected since it is a unitless ratio. Thus, the minimal wavelength segment resolved by IMPALA is:

\begin{equation}
    \Delta \lambda_{min}=\Delta \lambda_a\sqrt{\frac{1}{1+(\frac{\Delta \lambda_a s_b}{2\sigma_0\lambda_0})^2}}
\end{equation}

\noindent where $\lambda_0$ is the central wavelength. We want to express this formula in simple experimental parameters. The spectral bandwidth, $\Delta \lambda_a$, is defined for the field amplitude, and since we measure the intensity, there is a factor of $\sqrt2$ in the width that must be added. Also, the full width at half maximum is defined by FWHM$=2\sqrt{\log2}\sigma$, and therefore the FWHM of the intensity spectrum is $\Delta\lambda= (2\sqrt{2\log2}\Delta \lambda_a)/\sqrt2$. The beamlet diameter for the intensity is defined as $d_b=2\sqrt2\sigma_0$. Finally, the spectral resolution is:



\begin{equation}
\Delta\lambda_{impala}\cong\Delta\lambda\left(1+\left[\frac{\Delta\lambda s_b}{\lambda_0 d_b\sqrt{2\log 2}}\right]^2\right)^{-1/2}
\end{equation}

Here, $\Delta\lambda$ is the intensity spectral bandwidth FWHM expressed in wavelength. The geometry parameters are shown in Fig.~\ref{fig:beamlets_geom}. For the experimental case presented in the paper, the maximal spectral resolution for the most separated beamlets is $\Delta\lambda_{impala}\cong30~\text{nm}\times 0.3=10~\text{nm}$, and the relevant parameters are $\Delta \lambda=30$ nm, $\lambda_0=770$ nm, $s_b=12$ mm, and $d_b=150$ \textmu m.

% Figure environment removed




\section{Pinhole mask optimization}



The hole arrangement of the mask is optimized to balance between a sparse streak distribution in the Fourier-transformed FF and a uniform sampling of holes in the NF when summing all rotations. The optimization procedure is based on the analytical formula for the streak length and width in the Fourier plane of the FF intensity. Each hole pair in the NF generates a symmetrical pattern in the FF intensity Fourier plane. The pattern consists of a central lobe and two streaks. For each hole pair, the length of these streaks is given by $\sigma_{streak}$ from Eq.~\ref{eq2} and depends on the distance of the holes $s_b$, while the streaks' width is $\sigma_{streak}$ at $s_b=0$. For a given number of holes $N_{holes}$, the Fourier-transformed FF intensity will contain $N_{streaks}=N_{holes}(N_{holes}-1)/2$ streak patterns. We find each streak's spatial envelope, set its value to 1, and sum all the streaks for a given hole distribution. Thus, if two or more streaks overlap, the value in the area of the overlap will be higher than 1. Finally, we integrate the overlapped values, normalized by the overlap area, for the merit function.
The merit function for the spatial sampling for all rotations is constructed similarly. For each hole in the NF, we set a finite circular area and value of 1, and all holes are summed over all rotations. The overlapped areas which have values higher than 1 are integrated and normalized by total area. Finally, the algorithm finds the best hole distribution by minimizing both merits simultaneously.

% Figure environment removed

We use a genetic algorithm to find the best hole arrangement for a given hole number and the given laser parameters. An example of such optimization for the laser parameters used in the experiment and for 15 holes is shown in Fig.~\ref{fig:gen_opt}. One hole is constrained to be on the center of the mask. We start from the random hole arrangement depicted in Fig.~\ref{fig:beamlets_geom} (a), and after 12 rotations, the holes are non-uniformly sampled (b). Prior to optimization, the streaks in the FF Fourier transform have multiple overlaps (c). After the optimization, the hole arrangement (d) brings more uniform sampling after 12 rotations (e) and much less overlap of the streaks (f).




% Bibliography

\section{Pinhole mask}

The mask holder and mask substrate are 3D printed using fused deposition modeling (FDM) with Polylactic Acid (PLA) and shown in Fig.~\ref{fig:mask} (a). The holder has a special bump shown in a zoomed area in Fig.~\ref{fig:mask} (c) that snaps to the notches made at the edges of the mask. This allows for the precise positioning of the mask for a discrete set of angles. The pinholes of diameter 150 \textmu m were micro-drilled on black aluminum foil (THORLABS-BKF12) (Fig.~\ref{fig:mask} (b)) attached to the mask substrate.


% Figure environment removed 
\hspace{1cm}

\bibliographystyle{ieeetr} 
\bibliography{impala} 


\end{document}
