\documentclass[aps,prl,onecolumn,amsfonts,superscriptaddress,amssymb,amsmath]{revtex4-2}

\usepackage{graphicx}
\usepackage[separate-uncertainty = false]{siunitx}
\usepackage{color}
%\usepackage{lineno}
%\usepackage{palatino}
\usepackage{array}

\newcolumntype{L}[1]{>{\raggedright\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
\newcolumntype{C}[1]{>{\centering\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}
\newcolumntype{R}[1]{>{\raggedleft\let\newline\\\arraybackslash\hspace{0pt}}m{#1}}

\newcommand\red[1]{{\textbf{\color{red}#1}}}
\newcommand\blue[1]{{\color{black}#1}}
\newcommand{\calP}{$\mathcal{P}$}
\newcommand{\calT}{$\mathcal{T}$}
\newcommand{\ra}{\rightarrow}
\newcommand{\la}{\leftarrow}
\newcommand{\XXX}{\textbf{\red{XXX}}}

\renewcommand{\baselinestretch}{1.8} 

%TURN ON OR OFF AUTHORS
\newcommand\authors[1]{#1}
%\renewcommand\authors[1]{\author{The authors}}

\setcitestyle{super}

%\renewcommand*\familydefault{\sfdefault}

\begin{document}
%\linenumbers
\title{Nonlinear optical diode effect in a magnetic Weyl semimetal}% 

\authors{\author{Christian Tzschaschel}\email[]{current address: Max-Born Institute for Nonlinear Optics and Short Pulse Spectroscopy, Berlin, Germany. Email: christian.tzschaschel@mbi-berlin.de}
\affiliation{Department of Chemistry and Chemical Biology, Harvard University, Massachusetts 02138, USA}

\author{Jian-Xiang Qiu}\affiliation{Department of Chemistry and Chemical Biology, Harvard University, Massachusetts 02138, USA}

\author{Xue-Jian Gao}\affiliation{Department of Physics, Hong Kong University of Science and Technology, Clear Water Bay, Hong Kong, China}

\author{Hou-Chen Li}\affiliation{Department of Chemistry and Chemical Biology, Harvard University, Massachusetts 02138, USA}

\author{Chunyu Guo}
\affiliation{Laboratory of Quantum Materials (QMAT), Institute of Materials (IMX), École Polytechnique Fédérale de Lausanne (EPFL), CH-1015, Lausanne, Switzerland}
\affiliation{Max Planck Institute for the Structure and Dynamics of Matter, Hamburg, Germany}

\author{Hung-Yu Yang}\affiliation{Department of Physics, Boston College, Chestnut Hill, MA, USA}

\author{Cheng-Ping Zhang}\affiliation{Department of Physics, Hong Kong University of Science and Technology, Clear Water Bay, Hong Kong, China}
\author{Ying-Ming Xie}\affiliation{Department of Physics, Hong Kong University of Science and Technology, Clear Water Bay, Hong Kong, China}
\author{Yu-Fei Liu}\affiliation{Department of Chemistry and Chemical Biology, Harvard University, Massachusetts 02138, USA}
\author{Anyuan Gao}\affiliation{Department of Chemistry and Chemical Biology, Harvard University, Massachusetts 02138, USA}
\author{Damien B\'erub\'e}\affiliation{Department of Chemistry and Chemical Biology, Harvard University, Massachusetts 02138, USA}
\author{Thao Dinh}\affiliation{Department of Chemistry and Chemical Biology, Harvard University, Massachusetts 02138, USA}
\author{Sheng-Chin Ho}\affiliation{Department of Chemistry and Chemical Biology, Harvard University, Massachusetts 02138, USA}

\author{Yuqiang Fang}\affiliation{State Key Laboratory of High Performance Ceramics and Superfine Microstructure, Shanghai Institute of Ceramics, Chinese Academy of Science, Shanghai, China}\affiliation{State Key Laboratory of Rare Earth Materials Chemistry and Applications, College of Chemistry and Molecular Engineering Peking University, Beijing, China}

\author{Fuqiang Huang}\affiliation{State Key Laboratory of High Performance Ceramics and Superfine Microstructure, Shanghai Institute of Ceramics, Chinese Academy of Science, Shanghai, China}\affiliation{State Key Laboratory of Rare Earth Materials Chemistry and Applications, College of Chemistry and Molecular Engineering Peking University, Beijing, China}
\author{Johanna Nordlander}\affiliation{Department of Physics, Harvard University, Massachusetts 02138, USA}


\author{Qiong Ma}\affiliation{Department of Physics, Boston College, Chestnut Hill, MA, USA}

\author{Fazel Tafti}\affiliation{Department of Physics, Boston College, Chestnut Hill, MA, USA}

\author{Philip J.W. Moll}
\affiliation{Laboratory of Quantum Materials (QMAT), Institute of Materials (IMX), École Polytechnique Fédérale de Lausanne (EPFL), CH-1015, Lausanne, Switzerland}
\affiliation{Max Planck Institute for the Structure and Dynamics of Matter, Hamburg, Germany}

\author{Kam Tuen Law}\affiliation{Department of Physics, Hong Kong University of Science and Technology, Clear Water Bay, Hong Kong, China}
\author{Su-Yang Xu}
\email[]{Email: suyangxu@fas.harvard.edu}\affiliation{Department of Chemistry and Chemical Biology, Harvard University, Massachusetts 02138, USA}}

%\date{\today}

\maketitle

\section{Abstract}

\textbf{Weyl semimetals have emerged as a promising quantum material system to discover novel electrical and optical phenomena, due to their combination of nontrivial quantum geometry and strong symmetry breaking. One crucial class of such novel transport phenomena is the diode effect, which is of great interest for both fundamental physics and modern technologies. In the electrical regime, giant electrical diode effect (the nonreciprocal transport) has been observed in Weyl systems. In the optical regime, novel optical diode effects have been theoretically considered but never probed experimentally. Here, we report the observation of the nonlinear optical diode effect (NODE) in the magnetic Weyl semimetal CeAlSi, where the magnetic state of CeAlSi introduces a pronounced directionality in the nonlinear optical second-harmonic generation (SHG). By physically reversing the beam path, we show that the measured SHG intensity can change by at least a factor of six between forward and backward propagation over a wide bandwidth exceeding \SI{250}{meV}. Supported by density-functional theory calculations, we establish the linearly dispersive bands emerging from Weyl nodes as the origin of the extreme bandwidth. Intriguingly, the NODE directionality is directly controlled by the direction of magnetization. By utilizing the electronically conductive semimetallic nature of CeAlSi, we demonstrate current-induced magnetization switching and thus electrical control of the NODE in a mesoscopic spintronic device structure with current densities as small as \SI{5}{kA/cm^2}. Our results advance ongoing research to identify novel nonlinear optical/transport phenomena in magnetic topological materials. The NODE also provides a way to measure the phase of nonlinear optical susceptibilities and further opens new pathways for the unidirectional manipulation of light such as electrically controlled optical isolators.}

\section{Main}

Diode effects, i.e., phenomena that exhibit a preferred direction, are at the heart of new fundamental physics and modern technologies. A primary example is an electrical diode, which readily conducts current in one direction, but has a high resistance in the opposite direction. In analogy to electrical diodes, optical diodes are characterized by a directionally asymmetric propagation of light. Recent theoretical studies have shown that such an optical diode effect can reveal fundamentally new physics, such as the quantum metric of Bloch wavefunctions \cite{Lapa2019,Gao2019, Zhang2023}. Moreover, the optical diode would be a crucial component of various optical technologies including the photonics, where light instead of electrical current is envisioned as information carrier. For instance, in the microwave regime, the optical diode effect has been proposed for telecommunications \cite{Sabharwal2014,Reiskarimian2016}. Such prospects have inspired a flurry of experimental studies of the optical diode effect (also known as the nonreciprocal directional dichroism) especially in magnetoelectric wide-bandgap insulators \cite{Fiebig2005Revival, Spaldin2019}. However, the observed optical diode effect is typically very weak with the difference between forward and backward propagation being less than 1\% unless the photon energy is tuned to specific narrow electronic or magnetic resonances with bandwidths often below \SI{5}{meV}.

In addition to its propagation direction, light has another important degree of freedom, the color (frequency). Therefore, it is possible to conceptualize the nonlinear optical diode effect, where the photon frequency changes during the diode process. A second-order diode effect is a process where the optical second-harmonic generation (SHG) of a material along the forward and backward propagation directions differ. In terms of fundamental physics, the nonlinear optical diode effect (NODE) may reveal novel quantum geometrical phenomena distinct from the linear optical diode \cite{Nagaosa2020,Orenstein2021,Ma2021,Nagaosa2022}. Also, nonlinear optical processes (e.g. SHG) can lead to a much stronger diode effect (i.e., a larger contrast between the forward and backward direction) as SHG supports much stronger crystallographic selection rules \cite{Toyoda2021,Mund2021}. In terms of technology, the NODE may also enable novel optical applications such as unidirectional and mode-locked lasers \cite{Fan2012} and novel designs for optical isolators for optical communication \cite{Feng2011}.  

Recently, Weyl semimetals have emerged as an attractive system to explore various novel electrical and optical phenomena, due to its combination of nontrivial quantum geometry and strong symmetry breaking (to generate Weyl fermions, the system has to break space-inversion, or time-reversal, or both). In the electrical regime, a giant electrical diode effect (the nonreciprocal transport) has been observed in Weyl systems \cite{Tokura2018}. In the optical regime, novel optical diode effect has been theoretically considered \cite{Lapa2019, Gao2019, Nandy2022} but never probed experimentally. In contrast to conventional magnetoelectric insulators \cite{Toyoda2021, Mund2021} (Fig.~\ref{Fig1}a), the Weyl semimetals host linearly dispersive Weyl cones, which can allow for a wide range of photon energies to excite interband optical transitions in the material (Fig.~\ref{Fig1}b).

In this paper, we report the observation and manipulation of a giant, broadband NODE in the magnetic Weyl semimetal CeAlSi. We demonstrate that at least a sixfold change in SHG intensity is achievable between forward and backward propagating light over a broad spectral range covering \SI{250}{meV}. Supported by first-principles calculations, we establish a link between the broadband characteristics and the linearly dispersive Weyl fermions in CeAlSi. We show that the directionality of the NODE is directly related to the magnetic order in CeAlSi. We can switch the magnetic order by passing a current and thus demonstrate electrical control of the NODE. We reveal that this basic opto-spintronic functionality persists in technologically relevant, micromachined device structures with the additional advantage of drastically reduced switching currents.


\section{Observation of the nonlinear optical diode effect (NODE) in CeAlSi}

CeAlSi belongs to the family of Weyl semimetals with chemical formula $R$Al$X$ ($R=\textrm{La-Nd}$ and $X$=\textrm{Si or Ge}) that recently gained considerable attention as magnetic Weyl semimetals\cite{Chang2018Magnetic, Hodovanets2018single, Suzuki2019singular, Puphal2020Topological, Yang2021, Sun2021Mapping, Su2021Multiple, Gaudet2021Weyl, Yao2023, Alam2023, Zhang2022c, Hodovanets2022}. This family is closely related to TaAs \cite{Xu2015Discovery, Lv2015Experimental}, as they have the same noncentrosymmetric, tetragonal crystal structure (point group $4mm$) and the same valence condition ($R^{3+}[\textrm{Al}X]^{3-}$ $vs$ $\textrm{Ta}^{3+}\textrm{As}^{3-}$). The introduction of magnetic rare earth elements (Ce, Pr, or Nd) in $R$Al$X$ compounds leads to long-range magnetic order. Depending on the rare earth element, a variety of magnetic structures ranging from simple collinear ferromagnetism to noncollinear magnetism and complex multi-$k$ helical spin structures has been found \cite{Hodovanets2018single, Suzuki2019singular, Puphal2020Topological, Yang2021, Sun2021Mapping, Su2021Multiple, Gaudet2021Weyl}. The interplay between Weyl fermions, inversion symmetry-breaking, and magnetism provides a fertile ground to discover novel emergent quantum electromagnetism in this class of Weyl semimetals.

CeAlSi exhibits a canted ferromagnetic order below $T_{\textrm{C}}\sim \SI{8.4}{K}$ (Fig.~\ref{Fig1}c). The net magnetization points along one of the four symmetry-equivalent in-plane crystallographic directions, $\pm[110]$ and $\pm[\bar{1}10]$ (We define $[110]=+\hat{\mathbf{x}}$, $[\bar{1}10]=+\hat{\mathbf{y}}$, and $[001]=+\hat{\mathbf{z}}$, Fig.~\ref{Fig1}c). Hence, there are four distinct ferromagnetic states, denoted as $\mathbf{M}_\mathrm{+x}$, $\mathbf{M}_\mathrm{-x}$, $\mathbf{M}_\mathrm{+y}$, and $\mathbf{M}_\mathrm{-y}$. Such a \calT-breaking magnetic ordering on a \calP-breaking crystal structure makes CeAlSi a promising candidate for the observation of the NODE. 

We consider the NODE explicitly by experimentally reversing the light path. As CeAlSi is semimetallic and therefore highly reflective, we consider the NODE here in a reflection geometry (Fig.~\ref{Fig1}d). We study in particular SHG from the $(001)$ facet of a CeAlSi single crystal. Therefore, all four magnetic states of CeAlSi exhibit an in-plane net magnetization. We orient the crystal such that the s-polarization of light is parallel to the net magnetization of two out of the four possible magnetic states. We denote those states as $\mathbf{M}_\mathrm{\pm y}$ states and the states with net magnetization perpendicular to the s-polarization $\mathbf{M}_\mathrm{\pm x}$ states (see coordinate system in Fig.~\ref{Fig1}d).

In Fig. \ref{Fig1}e, we directly compare the spectra for the recorded SHG intensity for the forward propagation direction ($I^{\ra}(2\omega)$) and the backward propagation direction ($I^{\la}(2\omega)$) for the magnetic $\mathbf{M}_\mathrm{+y}$ state. The SHG intensity $I^{\ra}(2\omega)$ in forward direction is more than twice as large as the intensity $I^{\la}(2\omega)$ in backward direction over the entire considered spectral range of the incident light from \SI{650}{meV} to \SI{900}{meV}. Reversing the magnetization reverses the situation (Extended Data Fig.~\ref{Ext2}a). We thus find that the SHG response exhibits a NODE over a wide range of fundamental photon energies spanning at least \SI{250}{meV}. 

In Figs.~\ref{Fig2}a,b we show the polarization dependence of $I_\mathrm{+y}^{\ra}$ and $I^{\la}_\mathrm{+y}$, respectively, at a fundamental photon energy of \SI{715}{meV} for the magnetic $\mathbf{M}_\mathrm{+y}$ state of CeAlSi. The polarization dependence also clearly reveals the NODE in the SHG response. To further corroborate the nonreciprocal character of the observed SHG, we define the integrated SHG intensity $\langle I\rangle$ as the intensity measured without polarization analysis, thus simultaneously detecting s- and p-polarized SHG light, and averaging over all polarizations of the incident fundamental light. Comparing the integrated SHG intensity between the forward and backward direction gives us a measure of the diode effect independent of the light polarization (i.e., the diode effect for unpolarized light). Interestingly, we find for the magnetic $\mathbf{M}_\mathrm{+y}$ state that the integrated SHG intensity  $\langle I^{\ra}_{+y}\rangle$ in the forward direction is significantly higher than $\langle I^{\la}_{+y}\rangle$ in the reversed direction (Fig.~\ref{Fig2}c). This shows that the NODE is not restricted to particular polarization configurations but a net diode effect can persist even in the case of unpolarized incident light.

\section{Magnetic control of the NODE}

Interestingly, the directionality of the NODE can be controlled by the magnetic order. In Figs.~\ref{Fig2}a-c and ~\ref{Fig2}d-e, we compare the results for the $\mathbf{M}_\mathrm{+y}$ and $\mathbf{M}_\mathrm{-y}$ states, from which we see that the directionality of the NODE is flipped as we flip the magnetization. Thus, while the broken \calP\ symmetry in general activates the NODE, the broken \calT\ symmetry enables controlling its directionality. By selecting either the $\mathbf{M}_\mathrm{+y}$ or $\mathbf{M}_\mathrm{-y}$ state, we can deterministically set the propagation direction that generates higher integrated SHG intensity.

We can understand the NODE and its magnetic control by the interference of independent SHG tensor components with different origins. In our case, we can use $\chi_{xxx}$ and $\chi_{xxz}$. $\chi_{xxz}$ arises from the noncentrosymmetric polar lattice of CeAlSi; $\chi_{xxx}$ arises from the magnetic order. As shown in Extended Data Fig.~\ref{ExtMinimal}, the total SHG intensity is given by $\vert \chi_{xxx}E_{x}^2+\chi_{xxz}E_{x}E_{z}\vert^2$. Considering p-polarized incident light, the electric field $\mathbf{E}$ of the light wave is parallel to $\mathbf{k}\times\hat{\mathbf{y}}$ leading to a $\mathbf{k}$ dependence of the SHG response. Specifically, as we reverse the light propagation direction, we reverse the relative sign between $E_x$ and $E_z$. Hence, we find $I_\mathrm{+y}^\rightarrow(2\omega) \propto \vert\chi_{xxx}+\chi_{xxz}\vert^2$ and $I_\mathrm{+y}^\leftarrow(2\omega) \propto \vert\chi_{xxx}-\chi_{xxz}\vert^2$. Thus, the NODE is based on a directionally dependent mixing between tensor components. It is interesting to note that the origin of the symmetry breaking that enables those tensor components is not crucial. This is in contrast to the established SHG interference imaging technique which strictly relies on interference between order-parameter dependent and order-parameter independent $\chi$ tensor components \cite{Fiebig05}. As a consequence, a NODE can in principle exist even in non-magnetic materials. Here, however, we explicitly utilize the different origin of $\chi_{xxx}$ and $\chi_{xxz}$ to control the directionality of the NODE. As we reverse the magnetization direction, we reverse the sign of the magnetic SHG tensor $\chi_{xxx}$ but the crystalline SHG tensor component $\chi_{xxz}$ remains unchanged. Thus, we find $I_\mathrm{-y}^\ra(2\omega) \propto \vert-\chi_{xxx}+\chi_{xxz}\vert^2$ and $I_\mathrm{-y}^\la(2\omega) \propto \vert-\chi_{xxx}-\chi_{xxz}\vert^2$, which explains why the NODE directionality flips as we flip the magnetization direction. 

\section{Electrical control of the NODE}

The noncentrosymmetric symmetry of CeAlSi supports a magnetoelectric coupling between the magnetization $\mathbf{M}$ and a current $\mathbf{J}$. Microscopically, such a coupling may be either intrinsic \cite{Birss66, Johansson2018}, mediated by strain \cite{Xu2021}, or relying on the spin-Hall effect\cite{Sinova2015} and assisted by the Oersted field of the current \cite{Krause2007,Mendil2019}. In all cases, the magnetoelectric coupling is such that a current in the $xy$-plane favors a magnetization perpendicular to the current in the $xy$-plane with a fixed handedness as depicted in Fig.~\ref{Fig3}b, providing a way to control the magnetic domain configuration through an electrical current.  

We supply a current in the $xy$-plane through a pattern of gold electrodes on a $(001)$ facet of the sample as illustrated in Fig.~\ref{Fig3}b. We can then use SHG to optically detect the magnetization state. Specifically, we choose s-polarized incident light at \SI{715}{meV} and detect p-polarized SHG, where $\mathbf{M}_\mathrm{\pm y}$ states correspond to high and low SHG intensity, respectively (Fig. \ref{Fig2}a,b. See also Extended Data Fig.~\ref{Ext4} for more systematic characterizations).

Remarkably, we find that passing a current in CeAlSi can directly choose its magnetization direction. Moreover, the selected magnetization persists when the current is removed (i.e., the control is nonvolatile). Specifically, as shown in Fig.~\ref{Fig3}c, if we pass a negative current of \SI{-100}{mA} along the $x$-direction and then remove this current, we control the magnetization to be along $+y$ ($\mathbf{M}_\mathrm{+y}$); if we pass a positive current of \SI{+100}{mA} and then remove this current, we control the magnetization to be along $-y$ ($\mathbf{M}_\mathrm{-y}$). Therefore, the data in Fig.~\ref{Fig3}c shows that the magnetization of CeAlSi can be controlled by current. Moreover, Fig.~\ref{Fig3}d shows the results over the course of $>10$ consecutive current cycles along opposite directions. We found that the control is highly deterministic, i.e., $-x$ current selects $+y$ magnetization whereas $+x$ current selects $-y$ magnetization. The control is also clearly nonvolatile, i.e., the selected magnetization persists when the current is reduced to zero. By electrically controlling the NODE, we realize here a basic nonreciprocal nonlinear opto-spintronic functionality.

We note that the above results are obtained on a large mm-sized single crystal. So although the total current needed for the magnetic control appears large (\SI{100}{mA}), the current density is very small. However, as the contacts are deposited on the top surface (Fig.~\ref{Fig3}b), the spatial distribution of current flow is likely to be inhomogeneous for such a thick bulk crystal (especially along the $z$ direction), so it is hard to reliably estimate the current density. In order to reliably estimate the current density, it is highly desirable to fabricate a miniaturized device. Such a micro-device also helps us to explore the tantalizing potential of electrically controlling the nonlinear optical response of CeAlSi for spintronic applications.

In Fig.~\ref{Fig3}f, we use focused ion-beam (FIB) milling to fabricate such a micro-device of CeAlSi. The core part of the structure is a free-standing slab of CeAlSi of $\SI{126}{\micro m}\times\SI{29}{\micro m}\times\SI{2}{\micro m}$. In order to counter-act the significant magnetic shape anisotropy due to the large aspect ratio and keep the device switchable, we prepared the slab with the long axis along the magnetic hard axis, i.e. at an angle of $45^\circ$ relative to the $x$ and $y$ directions. The device can be poled into a magnetic single domain state with magnetic fields of about \SI{30}{mT}. Analogously to the previous bulk measurements, the four magnetic states can be distinguished by their SHG polarization dependence (Extended Data Fig.~\ref{ExtFIB}).

Most strikingly, in the absence of external magnetic fields, we can electrically control the magnetic state of the micro-device with dramatically reduced currents. As shown in Fig.~\ref{Fig3}g, we find that we can change the magnetic state in the FIB device with currents as small as \SI{3}{mA} corresponding to current densities of around \SI{5}{kA/cm^2} in the slab (in this case, we do not see remanent switching possibly due to shape anisotropy and residual strain in the sample \cite{Dubowik1996,Wang2013,Xu2021}). The magnetic switching is clearly evidenced by a change of the SHG polarization dependence indicative of switching between the $\mathbf{M}_\mathrm{-x}$ state at \SI{-3}{mA} and a $\mathbf{M}_\mathrm{+x}$ state at \SI{+3}{mA}. Such a reversible electrical control of a magnetic state may be highly desirable for novel device concepts.

\section{Observation of a broadband NODE}

Note that so far we observed a pronounced NODE for a specific SHG component at \SI{715}{meV} without deliberate optimization with respect to polarization or photon energy. However, a comparison of Figs.~\ref{Fig2}a and b reveals that changing the magnetization induces large changes of SHG intensity for certain polarization components and vanishing changes for others. To quantify the NODE, we define the nonreciprocal contrast $\eta$ as 

\begin{equation}
    \eta = \frac{ I^{\ra}_{+y}-I^{\la}_{+y}}{I^{\ra}_{+y}+I^{\la}_{+y}}.
\end{equation}

The nonreciprocal contrast $\eta = 0$ corresponds to absence of the NODE (i.e., the SHG intensity along forward and backward directions is equal); the nonreciprocal contrast $\eta = \pm 1$ corresponds to extreme NODE (i.e., SHG can only occur along one direction)
%The nonreciprocal contrast vanishes for $I^{\ra}_{+y}=I^{\la}_{+y}$ and approaches $\pm 1$ in the extreme cases that the SHG intensity vanishes for either propagation direction.

In Fig.~\ref{Fig4}a, we show the evolution of $\left\vert\eta\right\vert$ for p-polarized SHG as a function of both incoming laser polarization and SHG photon energy. Here, we compare $I^{\ra}_{+y}$ and $I^{\ra}_{-y}$, which is equivalent to comparing $I^{\ra}_{+y}$ and $I^{\la}_{+y}$ but experimentally more straightforwardly accessible (see Extended Data Fig.~\ref{Ext3} for other assessments of $\eta$).  The figure is characterized by a rich behavior that is mirror symmetric along the 0 and 90 deg directions due to mirror symmetries in CeAlSi. At \SI{715}{meV} we find that $\eta$ exhibits maxima at 0 deg/180 deg (p-polarized light) as well as near 90 deg (s-polarized light) but vanishes near 45/135 deg, in agreement with Fig.~\ref{Fig2}a and b. In Fig.~\ref{Fig4}b, we show the maximum achievable contrast for each SHG photon energy. The nonreciprocal contrast peaks around \SI{750}{meV} at $97.2\,\%$ corresponding to a more than 70-fold change in SHG intensity. Moreover, we find that a nonreciprocal contrast of at least $73\,\%$ (corresponding to a more than 6-fold change) is achievable for all photon energies in the considered spectral range between \SI{650}{meV} and \SI{900}{meV}.

\section{Broadband NODE from first principles}

In order to understand the microscopic origin of the NODE, we directly compute the NODE from the electronic structure of CeAlSi. Specifically, the NODE is the difference in SHG intensity between opposite propagation directions, which is determined by the two momentum-space resolved quantities $\kappa^\ra$ and $\kappa^\la$ as (see methods, Eq.~(\ref{eqn:SHG})):

\begin{equation}
	\mathrm{NODE} = I^\ra - I^\la = \vert \int_{BZ}\kappa^\ra\, d^3\mathbf{k}\vert^2 - \vert \int_{BZ}\kappa^\la\, d^3\mathbf{k}\vert^2.
	\label{eqn:SHGDFT}
\end{equation}

Here, $\kappa^{\ra(\la)} = \xi_{ijk}E_j^{\ra(\la)}E_k^{\ra(\la)}A_k^{\ra(\la)}$,
where $\mathbf{E}^{\ra(\la)}$ is the electric field of the incident light for the forward and backward propagation direction, $\mathbf{A}^{\ra(\la)}$ is a projector to select either the $s$ or $p$ polarized SHG response, and $\xi_{ijk}$ is the k-space resolved contribution to the nonlinear optical susceptibility ($\xi_{ijk}$ is directly computed from the band structure of CeAlSi, see methods Eqs.~(\ref{eqn:supp1}) and (\ref{eqn:supp2})). 

Figure~\ref{Fig4}c shows a section of the band structure of CeAlSi consistent with previous first-principles calculations \cite{Yang2021} (see methods for further details). Along with the band structure, we show in Fig.~\ref{Fig4}d the magnitude of $\kappa^\ra$ and $\kappa^\la$ in the band structure of CeAlSi (for $\hbar\omega = \SI{750}{meV}$). We see from Fig.~\ref{Fig4}d that discrete $\mathbf{k}$ points contribute significantly. By comparing Figs.~\ref{Fig4}c and d, it is clear that these are the states which allow for optical transitions at $\omega$ or $2\omega$ across the Fermi energy. Importantly, the magnitude of $\kappa^\ra$ and $\kappa^\la$ differs significantly, giving rise to the observed NODE.

To understand the band structure origin of the broadband nature of the NODE in CeAlSi, we vary the incident photon energy from \SI{650}{meV} to \SI{850}{meV}. We can observe two qualitatively different behaviors (Fig.~\ref{Fig4}e). On the one hand, we notice a few contributions such as near the $\Gamma$ point along the $\Gamma-\Sigma$ line that occur only at specific photon energies (here \SI{650}{meV}). The bands at that $\mathbf{k}$ point are relatively flat. As the photon energy changes, such contributions disappear, which is indicative of a typical electronic resonance. Despite the apparent size of this resonant contribution, the spectrum of all SHG tensor components evolves smoothly towards \SI{650}{meV} indicating an overall negligible effect (Ext. Data Fig.~\ref{Ext5}). On the other hand, the majority of the SHG response arises at $\mathbf{k}$ points where the electronic bands are linearly dispersive. Accordingly, as we vary the incident photon energy, those contributions only shift slightly to different $\mathbf{k}$ points but remain comparable in magnitude. This observation of SHG originating from linearly dispersive bands is qualitatively different from the conventional resonance picture. Moreover, we thus see that the broadband NODE in CeAlSi ultimately arises from the linearly dispersive bands in the vicinity of the Weyl nodes. %Note that despite the apparent size of the resonant contribution along the $\Gamma-\Sigma$ line, the SHG spectrum in Fig.~\ref{Fig4}c evolves smoothly towards \SI{650}{meV} indicating an overall dominance of the contributions from linearly dispersive bands.

\section{Discussion}

In summary, we explored the nonlinear optical response of the magnetic Weyl semimetal CeAlSi using SHG spectroscopy. In addition to the crystallographic (time-reversal symmetric) SHG, we observe magnetic (time-reversal asymmetric) SHG, which represents the first observation of magnetic SHG in a topologically nontrivial material. By physically reversing the light path, we revealed a pronounced NODE. Specifically, we found a sizable nonreciprocal contrast of at least $73\%$ over a remarkable spectral range exceeding \SI{250}{meV} --- two orders of magnitude wider than previous reports. 

Microscopically, our DFT calculations show that the extreme broadband NODE is directly related to the electronic band structure. The SHG response emerges from linearly dispersive bands that naturally occur near the Fermi energy in a Weyl semimetal. The linear dispersion allows for strong optical responses over a wide range of frequencies.

Our observations open up a number of intriguing possibilities. First, it suggests the NODE as a powerful method to measure the phase of optical properties. All optical processes (e.g., SHG, Raman) are governed by the corresponding susceptibility tensor, which is determined by the material. Hence, inversely, by measuring the SHG, Raman, or other optical process, we can learn about the symmetry and electronic properties of a material. However, typically we only access the magnitude of the susceptibility, whereas the sign or phase is hard to probe. Here, as we showed above, the NODE arises from the directionally dependent mixing between tensor components which provides insights into their relative phases. It would be interesting to test the optical diode effect for other optical processes such as high-harmonic generation \cite{Heide2022}, Raman scattering \cite{Wang2022a}, and optically generated spin currents \cite{Li2020}, where interesting phenomena hinting nonreciprocity have been observed. Second, we note the low current density associated with the switching of magnetic order in CeAlSi. It would be of interest to perform future studies to understand its microscopic mechanism and to test it on other magnetic and noncentrosymmetric Weyl fermion systems. The low-current switching in combination with the extreme broadband character of the NODE, may enable fundamentally new device concepts for photonic circuits. From a fundamental point of view, our observation of a broadband NODE is testament to the exotic electromagnetic responses that can be discovered in novel quantum magnets. 

\newpage
\renewcommand{\baselinestretch}{1.2}
\bibliographystyle{Science}
\bibliography{../../../../../Papers/Library3}
\clearpage


% Figure environment removed
\clearpage

% Figure environment removed
\clearpage

% Figure environment removed
\clearpage

% Figure environment removed
\clearpage

\renewcommand{\figurename}{Extendend Data Fig.}
\setcounter{figure}{0}

% Figure environment removed
\clearpage

% Figure environment removed
\clearpage

% Figure environment removed
\clearpage

% Figure environment removed
\clearpage

% Figure environment removed
\clearpage


% Figure environment removed
\clearpage

% Figure environment removed
\clearpage

% Figure environment removed
\clearpage


\section{Acknowledgment}
Work in the SYX group was partly supported through the Center for the Advancement of Topological Semimetals (CATS), an Energy Frontier Research Center (EFRC) funded by the U.S. Department of Energy (DOE) Office of Science (fabrication and measurements), through the Ames National Laboratory under contract DE-AC0207CH11358, and partly by the AFOSR grant FA9550-23-1-0040 (data analysis), and partly by the NSF Career DMR-2143177 (manuscript writing). SYX also acknowledges the Corning Fund for Faculty Development. The work in the QM group was supported through the CATS, an EFRC funded by the DOE Office of Science (manuscript writing), through the Ames National Laboratory under contract DE-AC0207CH11358. QM also acknowledges the support from NSF through a CAREER award DMR-2143426 (material supplies) and the CIFAR Azrieli Global Scholars Program. C.T. acknowledges support from the Swiss National Science Foundation under project no. P2EZP2\_191801 and from the Harvard University Climate Change Solutions Fund. J.N. acknowledges support from the Swiss National Science Foundation under project no. P2EZP2\_195686. F.H. received funding by the National Natural Science Foundation of China under grant 52103353. P.J.W.M. acknowledges funding by the European Research Council (ERC) under the European Union’s Horizon 2020 research and innovation programme (MiTopMat, grant agreement no. 715730). C.G. received funding by the Swiss National Science Foundation (grant no. PP00P2\_176789). This material is based upon work supported by the Air Force Office of Scientific Research under award number FA2386-21-1-4059. K.T.L. acknowledges the support of HKRGC through Grants RFS2021-6S03, C6025-19G, AoE/P-701/20, 16310520, 16310219 and 16307622.

\section{Author contributions}

C.T. designed and conducted the SHG experiments with assistance from J.-X.Q., H.-C.L., Y.-F.L., A.G., D.B., T.D., and S.-C.H. C.T. evaluated the data with support from J.N. X.-J.G., C.-P.Z., Y.-M.X., and K.T.L. performed the first-principles calculations. H.-Y.Y., X.P., Y.F., F.H., and F.T. synthesized CeAlSi single crystals. C.G. and P.M. prepared the FIB cut. C.T., Q.M. and S.-Y.X. wrote the manuscript with discussions and contributions from all authors.

\section{Methods}

\subsection{Crystal growth}
Single crystals of CeAlSi were grown by a self-flux method. The starting materials were Ce and Al ingots, and Si pieces, mixed in ratio Ce:Al:Si = 1:10:1 in an alumina crucible. The crucible was sealed in an evacuated quartz tube, and went through the following heating sequence: the sample was heated from \SI{25}{\degree C} to \SI{1000}{\degree C} at \SI{3}{\degreeCelsius \per \minute}, stayed for \SI{12}{h}, cooled to \SI{700}{\degree C} at \SI{0.1}{\degreeCelsius \per \minute}, stayed for \SI{12}{h}, and finally centrifuged to remove the residual Al flux at \SI{700}{\degree C}.

\subsection{SHG measurements}
Second-harmonic generation (SHG) is a nonlinear optical process that describes the interaction of two photons at frequency $\omega$ in a material leading to the re-emission of one photon at frequency $2\omega$. In the lowest-order electric-dipole approximation, the process can be formally expressed as

\begin{equation}
	P_i(2\omega) = \sum_{j,k}\mathcal{X}_{ijk}E_j(\omega)E_k(\omega),
\end{equation}

where $E_{j}(\omega)$ and $E_{k}(\omega)$ denote the electric-field components of the incident light-wave and $P_i$ the components of the induced nonlinear polarization oscillating at $2\omega$ (indices $i,j,k$ can be $x$, $y$, or $z$). The process is mediated by the second-order susceptibility tensor $\mathcal{X}_{ijk}$, which can only have non-vanishing components when \calP\ is broken \cite{Birss66}. 

All SHG measurements were obtained using a laser system by LightConversion consisting of an amplified femtosecond laser (Pharos, photon energy \SI{1.2}{eV}, maximum power \SI{10}{W}, maximum repetition rate \SI{100}{kHz}) in combination with an optical parametric amplifier (Orpheus One HE). In order to avoid heating effects, we reduce the repetition rate of the laser and employ attenuating filters to achieve an average power on the sample of less than \SI{2}{mW}. For domain imaging (e.g., Fig~\ref{Fig2}i), we chose a spot size of approximately \SI{800}{\micro m}. For all other measurements, we focused the laser to a spot size of approximately \SI{150}{\micro m}. All SHG measurements were performed in reflection under an angle of incidence of $45^\circ$. We adjust the laser polarization of the incident fundamental beam using an achromatic half-waveplate, while selectively detecting s- and p-polarized SHG intensity (red and gray data points, respectively) using a Glan-laser polarizer and a thermo-electrically cooled electron-multiplying CCD camera (EMCCD). For spectrally resolved SHG measurements, a grating spectrometer was mounted in front of the EMCCD camera. For all other measurements, the EMCCD camera was mounted behind a narrow band pass filter centered at \SI{1.425}{eV} (bandwidth \SI{30}{meV}). We used additional filters directly before the sample to block parasitic SHG signals from all previous optical components as well as directly after the sample to block the fundamental beam.

The measured SHG intensity is proportional to 

\begin{equation}
	I(2\omega)	= \vert \mathbf{P}(2\omega)\cdot\mathbf{A}\vert^2 = \vert \sum_{i,j,k}\mathcal{X}_{ijk}E_j(\omega)E_k(\omega)A_i\vert^2,
	\label{eqn:SHGSupp}
\end{equation}

where $\mathbf{A}$ is the direction of the transmitted polarization axis of the analyzer (here $s$ or $p$ polarization).

\subsection{Fitting of SHG polarization dependencies}

The SHG polarization dependencies were fit self-consistently according to Eq.~(1). In the magnetically ordered phase, the 16 measurements in Extended Data Fig.~\ref{Ext1}(a-d,f-i) (four magnetization directions, forward/backward propagation, s/p-polarized SHG) were fit simultaneously by optimizing the amplitude and phase of the allowed SHG tensor components of the $2^\prime m m^\prime$ symmetry. The different magnetization directions were simulated by performing $90^\circ$ rotations of the SHG tensor about the crystallographic $c$ axis. To account for experimental uncertainties, the fit allowed for slight variations of the sample orientation, i.e., rotations about the surface normal and about the horizontal axis in the lab frame as well as deviations of the angle of incidence from $45^\circ$. A consistent fit was achieved with all variations being less than $2^\circ$. Similarly, the four measurements in Extended Data Fig.~\ref{Ext1}(e,j) were fit simultaneously with the allowed SHG tensor components of the paramagnetic $4mm$ symmetry. The fit results are not unique but show consistency with the expected symmetries as well as self-consistency of the different measurements.

\subsection{Focused-ion-beam microstructuring}

An oriented large single crystal of CeAlSi was milled using a Xe-Plasma FIB (Thermofisher Helios PFIB). At 2.5mA, 30kV, first a rectangular bar was milled from the parent crystal (bar length 300mm, width 50mm, height 30mm). This bar was attached with Pt deposition to an in-situ micromanipulator and rotated by 90°, to access the side face of the bar. At this angle, the trapezoidal outer shape and the central bridge were patterned at 500nA, 30kV for coarse and 60nA, 30kV for fine patterning. Furthermore, the outer feet were polished flat at 60nA, 30kV to ensure a flat mating with the substrate. A sapphire substrate (2x2mm) with two large, lithographically prepared Au leads (10nm Ti / 100nm Au) was introduced into the chamber and the bridge rotated back. Using the in-situ manipulator, the bridge was placed ontop of these Au pads and connected by Pt deposition (60nA, 12kV), on the right foot in main Fig.~\ref{Fig3}f. The tip of the manipulator was cut off (60nA, 30kV), and the remains of the manipulator are well visible on the front section of the right foot. Despite best efforts of alignment, an approximately 500nm gap appeared between the left foot and the Au pad. The micromanipulator was used to gently push the structure flat, yet without forming a solid bond via deposition. Using the same settings as on the right side, the left side was connected with Pt. The sizable depositions resulted in visible overspray, which at these channel lengths does not notably conduct. Out of caution, the overspray was removed in a rectangular channel on both sides of the bridge (60nA, 30kV). The FIB process at 30kV usually results in a ~20nm thick amorphous layer which may cause issues with the SHG experiments. This layer was strongly reduced using low-voltage polishing. At an angle of 52° between the beam and the surface normal, the central top of the bridge was irradiated at 60nA, 5kV in a final cleaning step. As the entire process is performed using Xe beams, no implantation of the primary ions is expected.

\subsection{First-principles calculations}

We performed density-functional theory calculations \cite{Hohenberg1964} using the \textit{Vienna Ab initio Simulation Package} (VASP) \cite{Kresse1996} with the Perdew-Berke-Ernzerhof's (PBE) pseudopotential \cite{Perdew1996} in the generalized-gradient approximation \cite{Langreth1983}. We adopted $U_\mathrm{eff} = \SI{6}{eV}$ for the Hubbard U-term acting on the Ce $f$-orbital electrons \cite{Yang2021}. The Wannier tight-binding Hamiltonians were established using the $Wannier90$ package \cite{Mostofi2014}. The Wannier bands were symmetrized to restore the symmetry restrictions of the CeAlSi space group \cite{Gresch2018}. The magnetic order of CeAlSi is described by two magnetic sublattices of equal magnitude with noncollinear magnetic moments $\mathbf{m}_\mathrm{1}$ and $\mathbf{m}_\mathrm{2}$ on Ce $4f$ orbitals such that $(\mathbf{m}_\mathrm{1}+\mathbf{m}_\mathrm{2})\parallel \left[110\right]$. The angle between $\mathbf{m}_\mathrm{1}$ and $\mathbf{m}_\mathrm{2}$ is $70^\circ$ as indicated in Ref. \cite{Yang2021}.

\subsection{Calculation of $\chi_{ijk}$}
We calculated the nonlinear optical susceptibility $\chi_{ijk}$ for electric-dipole SHG according to the diagrammatic approach to the nonlinear optical response \cite{Parker2019, Takasan2021}. Interband transitions cause two contributions $\xi^{I}$ and $\xi^{II}$ such that $\chi_{ijk} = \int_{BZ}d^3\mathbf{k} \left(\xi^I_{ijk}+\xi^{II}_{ijk}\right)$, where

\begin{eqnarray}
	\xi^I_{ijk} &=& C \sum_{m\neq n} f_{mn}\left(\frac{h^{ij}_{nm}h^k_{mn} + h^{ik}_{nm}h^j_{mn}}{\omega+i\eta - \omega_{mn}} + \frac{h^{jk}_{mn}h^i_{nm}}{2\omega+i\eta - \omega_{mn}}\right) \label{eqn:supp1}, \\
	\xi^{II}_{ijk} &=& C \sum_{m\neq n\neq p} \frac{h^i_{pm}\left(h^j_{mn}h^k_{np}+h^k_{mn}h^j_{np}\right)}{\omega_{mn}+\omega_{np}}\left(\frac{f_{np}}{\omega + i\eta -\omega_{pn}} + \frac{f_{nm}}{\omega + i\eta -\omega_{nm}} + \frac{2f_{mp}}{\omega + i\eta -\omega_{pm}}\right)\label{eqn:supp2}
\end{eqnarray}  

Here, $\left\{i,j,k\right\}$ run over $\left\{x,y,z\right\}$ directions, $C = \frac{e^3}{2i\epsilon_0\hbar^2\omega^3}$, $\left\{m,n,p\right\}$ are the band indices, $h^i_{mn} = \frac{1}{\hbar}\langle m \vert \partial_{k_i} h(\mathbf{k})\vert n\rangle$, $h^{ij}_{mn} = \frac{1}{\hbar}\langle m \vert \partial_{k_i}\partial_{k_j} h(\mathbf{k}) \vert n\rangle$,  $\omega_{mn} = \frac{1}{\hbar}\left(\epsilon_m-\epsilon_n\right)$ represents the transition frequency between bands $m$ and $n$, $f_{mn}$ is the difference in band occupation according to the Fermi-Dirac distribution, and $\epsilon_0$ is the vacuum permittivity. The derivatives $h^i_{mn}$ and $h^{ij}_{mn}$ can be rewritten in terms of the generalized Berry connection $\mathcal{A}^{i}_{mn} = i\langle m\vert \partial_{k_i} \vert n\rangle$ \cite{Morimoto2016}:

\begin{equation}
h^i_{mn} = \frac{1}{\hbar}\langle m \vert \partial_{k_i} h(\mathbf{k})\vert n\rangle = \partial_{k_i}\langle m \vert h(\mathbf{k})\vert n\rangle - \langle \partial_{k_i} m \vert  h(\mathbf{k})\vert n\rangle - \langle m \vert  h(\mathbf{k})\vert \partial_{k_i} n\rangle = \delta_{mn} \partial_{k_i} \epsilon_m + i\hbar\omega_{mn}\mathcal{A}^{i}_{mn}.
\end{equation}

As the summation in Eqs. (\ref{eqn:supp1}) and (\ref{eqn:supp2}) only considers interband transitions ($m\neq n$), we find $h^i_{mn} =  i\hbar\omega_{mn}\mathcal{A}^{i}_{mn}$. Similarly, we find $h^{ij}_{mn} = i\hbar\mathcal{A}^{i}_{mn}\partial_{k_j}\omega_{mn}$ for the relevant case of $m\neq n$. Therefore, all interband contributions to $\chi_{ijk}$ can be related to the generalized Berry connection $\mathcal{A}^{i}_{mn}$.

Using $\chi_{ijk} = \int_{BZ}d^3\mathbf{k} \xi_{ijk}$ and Eq.~(\ref{eqn:SHGSupp}), we can express the SHG intensity as 

\begin{equation}
	I(2\omega)	= \vert \int_{BZ}\sum_{i,j,k}\xi_{ijk}E_j(\omega)E_k(\omega)A_i d^3\mathbf{k}\vert^2 = \vert \int_{BZ}\kappa d^3\mathbf{k}\vert^2,
	\label{eqn:SHG}
\end{equation}

where we define $\kappa = \sum_{i,j,k}\xi_{ijk}E_j(\omega)E_k(\omega)A_i$.


\end{document}
