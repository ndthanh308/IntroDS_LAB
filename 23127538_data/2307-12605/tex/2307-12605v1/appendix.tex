\appendix
\section{Proof of Lemma~\ref{LEM:WeightInequalityImpliesEnvyFree}} \label{app:413}
\begin{proof}
  By the Birkhoffâ€“von~Neumann theorem, for any $k$, there exists a
  probability distribution $\{\alpha^k_\pi\}_{\pi \in S_n}$ over
  permutations on $[n]$ such that
  \begin{equation}
    q_{ij}^k = p_k \sum_{\substack{\pi \in S_n \\ \pi(i)=j}} \alpha^k_\pi \text{ , for all } i,j,k.
    \label{EQ:Birkhoff-q}
  \end{equation}
  From $\q$, define the lottery $\hat\q$ by
  \[
    \hat{q}_{ij}^k = \begin{cases} q_{hj}^k & \text{ if } i=l\\q_{lj}^k & \text{ if } i=h\\q_{ij}^k & \text{ if } i\notin\{l,h\}
    \end{cases}.
  \]
and note that $u_l(\hat\q;h) = u_l(\q;l)$, $u_h(\hat\q;l) = u_h(\q;h)$,
whereas $u_i(\hat\q;j) = u_i(\q;j)$ when
$(i,j) \notin \{(l,l),(l,h),(h,l),(h,h)\}$.

For any permutation $\pi \in S_n$, denote by $\hat{\pi}$ the permutation given by
\[
  \hat\pi(i) = \begin{cases} \pi(h) & \text{ if } i=l\\ \pi(l) & \text{ if } i=h\\ \pi(i) & \text{ if } i \notin \{l,h\}
  \end{cases}.
\]
In other words, $\hat{\pi}$ just swaps the images of $l$ and $h$, respectively, compared to $\pi$. We can now observe that
  \[
    \hat{q}_{ij}^k = p_k \sum_{\substack{\pi \in S_n \\ \pi(i)=j}} \alpha^k_{\hat\pi} \text{ , for all } i,j,k \enspace .
  \]

  Since $(\q,p)$ is an optimal solution of
  LP~(\ref{EQ:MaxWeightedSumLP}) and $(\hat\q,p)$ is a feasible  solution, we have that
  $\sum_{i=1}^n w_i u_i(\q;i) \geq \sum_{i=1}^n w_i
  u_i(\hat\q;i)$. Using Equation~\ref{EQ:Birkhoff-q} we can rewrite the two sides of the inequality as
\[
  \sum_{i=1}^n w_i u_i(\q;i) = \sum_{k=1}^mp_k\sum_{\pi\in S_n}\alpha_\pi^k \sum_{i=1}^n w_i u_{i\pi(i)}^k
\]
and
\[
  \sum_{i=1}^n w_i u_i(\hat\q;i) = \sum_{k=1}^mp_k\sum_{\pi\in S_n}\alpha_{\hat\pi}^k \sum_{i=1}^n w_i u_{i\pi(i)}^k = \sum_{k=1}^mp_k\sum_{\pi\in S_n}\alpha_\pi^k \sum_{i=1}^n w_i u_{i\hat\pi(i)}^k,
\]
respectively. Optimality of $\q$ implies that whenever
$p_k\alpha_\pi^k>0$, we have
\[
  \sum_{i=1}^n w_i u_{i\pi(i)}^k \geq \sum_{i=1}^n w_i u_{i\hat\pi(i)}^k,
\]
or equivalently,
\[
  w_l u_{l\pi(l)}^k + w_h u_{h\pi(h)}^k \geq w_l u_{l\pi(h)}^k + w_h u_{h\pi(l)}^k,
\]
which may be rewritten as
\begin{equation}
  w_h(u_{h\pi(h)}^k - u_{h\pi(l)}^k) \geq w_l(u_{l\pi(h)}^k - u_{l\pi(l)}^k).
  \label{EQ:weight-envy-inequality}
\end{equation}
Suppose for contradiction that $u_{l\pi(h)}^k > u_{l\pi(l)}^k$. Then
since $w_l>0$ we also have that $u_{h\pi(h)}^k > u_{h\pi(l)}^k$. By Definition~\ref{DEF:rho} this
means that $(k,l,\pi(l),h,\pi(h)) \in J$ and thus
\[
  \rho < (u_{l\pi(h)}^k - u_{l\pi(l)}^k)/(u_{h\pi(h)}^k - u_{h\pi(l)}^k).
\]
From Equation~(\ref{EQ:weight-envy-inequality}) we then obtain
$w_h > \rho w_l$, contradicting the assumption that
$w_h \leq \rho w_l$.

Since this holds for $k$ and $\pi$ we can finally conclude that
\[
  u_l(\q;l) = \sum_{k=1}^m p_k\sum_{\pi\in S_n}\alpha_\pi^k u_{l\pi(l)}^k \geq \sum_{k=1}^m p_k\sum_{\pi\in S_n}\alpha_\pi^k u_{l\pi(h)}^k = u_l(\q;h). \qedhere
\]
\end{proof}

\section{Solving optimization and feasibility problems using the linear-OPT-gate}
\label{app:linearOPT}
In this section we give precise statements of the optimization and feasibility problems that are solvable by the linear-OPT-gate of Filos-Ratsikas~et~al.~\cite{Filos-RatsikasH2023-PPAD}.

\subsection{Optimization problems}
The linear-OPT gate is a construction of a piecewise linear arithmetic pseudo-circuit. It is parametrized (meaning that these are fixed constants) by the following:
\begin{itemize}
    \item Numbers $n,m,k \in \NN$.
    \item A (rational) matrix $A \in \RR^{m\times n}$.
    \item A piecewise linear arithmetic circuit $G_{\partial f} \colon \RR^n \times \RR^k \times [0,1]^\ell \to \RR \times [0,1]^\ell$.
\end{itemize}
It takes as input (meaning that these are given as input variables) by the following:
\begin{itemize}
    \item Vectors $b \in \RR^m$ and $c \in \RR^k$.
    \item A number $R \in \RR$.
\end{itemize}
The linear-OPT gate computes an optimal solution of the following optimization problem $\mathcal{C}$ in decision variables $x \in \RR^n$:
\begin{center}\underline{Optimization Program $\mathcal{C}$}\end{center}
\begin{equation}\label{eq:OPT-gate-general}
\begin{split}
\min \quad &f(x;c) \\
\text{ s.t.} \quad & Ax \leq b\\
& x \in [-R,R]^n
\end{split}
\end{equation}
whenever the following conditions hold:
\begin{itemize}
\item The feasible domain $\{x \in [-R,R]^n : Ax \leq b\}$ is not empty.
\item The map $x \mapsto f(x;c)$ is a convex function on the feasible domain and its subgradient is given by the pseudo-circuit $G_{\partial f}$.
\end{itemize}

\subsection{Feasibility problems}
Using the linear-OPT, a piecewise linear arithmetic pseudo-circuit solving feasibility problems with conditional constraints can be constructed. It is parametrized (meaning that these are fixed constants) by the following:
\begin{itemize}
    \item Numbers $n,m,k \in \NN$.
    \item A (rational) matrix $A \in \RR^{m\times n}$.
    \item Piecewise linear circuit arithmetic circuits $h_i \colon \RR^k \to \RR$, for $i=1,\dots,m$.
\end{itemize}
It takes as input (meaning that these are given as input variables) by the following:
\begin{itemize}
    \item Vectors $b \in \RR^m$ and $y \in \RR^k$.
    \item A number $R \in \RR$.
\end{itemize}
The pseudo-circuit outputs a feasible solution of the following feasibility problem $\mathcal{Q}$ in decision variables $x \in \mathbb{R}^n$:
\begin{center}\underline{Feasibility Program $\mathcal{Q}$}\end{center}
\begin{equation}\label{eq:feasibility-general}
\begin{split}
h_i(y) > 0 \implies a_i^\mathsf{T} x \leq b_i\\
x \in [-R,R]^n
\end{split}
\end{equation}
whenever it is feasible. Note also that ordinary inequality constraints are a special case of conditional linear constraints, obtained by setting $h_i(y) = 1$ above.

