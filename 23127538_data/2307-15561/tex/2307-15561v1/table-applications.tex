\begin{table*}
    \newlength{\citationcolumnwidth}
    \setlength{\citationcolumnwidth}{\widthof{[00, 00, 00]}}
    
    \newcommand{\citbox}[1]{\parbox{\citationcolumnwidth}{\centering #1}}

    \newcommand{\oh}[1]{\ensuremath{\times\,#1}}
    \newcommand{\ohapprox}[1]{\oh{#1}}
    \newcommand{\nooh}{--}

    \newcommand{\SwiperBlackBox}{{\Swiper} (BB)}
    
    \centering
    \renewcommand{\arraystretch}{1.1}
    \begin{tabular}{ccccccc}
        \hline
        \thead{Problem}
            & \thead{nominal\\solutions}
            & \thead{weight-reduction\\algorithm}
            & \thead{$f_w$} 
            & \thead{$f_n$}
            & \thead{worst-case average\\comm. overhead}
            & \thead{worst-case average\\comp. overhead}
        \\
        \hline\hline
        \multicolumn{7}{c}{Derived Protocols}\\
        \hline\hline
        \makecell{Efficient Asynchronous\\State-Machine Replication} 
            & \citbox{\cite{honey-badger,beat-bft,all-you-need-is-dag,narwhal,bullshark}}
            & {\Swiper}+{\Dora} %
            & $1/3$
            & $1/3$
            & \makecell{\ohapprox{1.33} for Broadcast \\ \oh{2} for RNG}
            & \makecell{\ohapprox{5.33} for Broadcast \\ \oh{2} for RNG}
            \\
        \hline
        \makecell{Structured Mempool} 
            & \citbox{\cite{narwhal}}
            & {\Dora} %
            & $1/3$
            & $1/3$
            & \makecell{\ohapprox{1.33} for Broadcast}
            & \makecell{\ohapprox{5.33} for Broadcast}
            \\
        \hline
        \makecell{Validated Asynchronous\\Byzantine Agreement} 
            & \citbox{\cite{vaba-cachin,vaba-abraham}}
            & {\Swiper} %
            & $1/3$
            & $1/3$
            & \oh{2} for RNG %
            & \oh{2} for RNG %
            \\

        \hline
        \makecell{Consensus with Checkpoints}
            & \cite{pikachu}
            & {\Swiper} 
            & $1/3$ 
            & $1/3$ 
            & \oh{2} for signing
            & \oh{2} for signing
            \\
        \hline\hline

        
        \multicolumn{7}{c}{Useful Building Blocks} \\
        \hline\hline
        \multirowcell{2}{Erasure-Coded\\Storage and Broadcast}
            
            & \multirowcell{2}{\citbox{\cite{ida-rabin-89,ida-cachin-tessaro-05,ida-hendricks-07,ida-nazirkhanova-21,ida-yang-22,rbc-erasures-high-threshold-trusted-setup}}}
            & {\Dora}   & $1/3$ & $1/3$ & \ohapprox{1.33} & \ohapprox{5.33}
            \\ \cline{3-7}
            & %
            & {\SwiperBlackBox} & $1/4$ & $1/3$ & \nooh & \oh{3}
            \\
        \hline
        \multirowcell{2}{Error-Corrected Broadcast}
            & \multirowcell{2}{\cite{dxr21}}
            & {\Dora}   
            & $1/3$ 
            & $1/3$ 
            & \ohapprox{1.33}
            & \oh{10.66}
            \\ \cline{3-7}
            & %
            & {\SwiperBlackBox}
            & $1/4$
            & $1/3$
            & \nooh
            & \oh{3}
            \\
        \hline
        Blunt Secret Sharing & \cite{Sha79}
            & \multirowcell{5}{\Swiper}
            & \multirowcell{5}{$1/3$} 
            & \multirowcell{5}{$1/3$} 
            & \multirowcell{5}{\oh{2}}
            & \multirowcell{5}{\oh{2}}
            \\
        Distributed RNG & \cite{pre-shared-common-coins,random-oracles} \\
        Blunt Threshold Signatures & \cite{ThresholdBLS,ThresholdSchnorr,rsa-threshold-signatures} \\
        Blunt Threshold Encryption & \cite{threshold-cryptosystems} \\
        Blunt Threshold FHE & \cite{ThFHE-jain,ThFHE-boneh} \\
        \hline
        Tight Secret Sharing
            & \multirowcell{4}{Sec. \ref{subsec:tight-secret-sharing}\\(this paper)}
            & \multirowcell{4}{\Swiper}
            & \multirowcell{4}{$1/3$} 
            & \multirowcell{4}{$1/3$} 
            & \multirowcell{4}{\oh{2}}
            & \multirowcell{4}{\oh{2}   }
            \\
        Tight Threshold Signatures  \\
        Tight Threshold Encryption  \\
        Tight Threshold FHE  \\
        \hline
        Linear BFT Consensus
            & \cite{yin2019hotstuff}
            & \multirowcell{2}{\SwiperBlackBox}
            & \multirowcell{2}{$1/4$}
            & \multirowcell{2}{$1/3$}
            & \multirowcell{2}{\oh{3}}
            & \multirowcell{2}{\oh{3}}
            \\ 
        Chain-Quality SSLE
            & \cite{ssle} %
            \\
        \hline
    \end{tabular}
    \medskip
    \caption{Examples of suggested weighted distributed protocols with the upper bounds on communication and computation overhead compared to the nominal solutions\atadd{ with the same number of participants}.
    \atadd{See \Cref{sec:wr-applications,sec:wq-applications,sec:derived-applications} for details on how these numbers were obtained.}
    \atadd{In \Cref{sec:empirical-study}, we study real-world weight distributions and conclude that, in practice, the overhead should be much smaller.}
    \atrev{``{\Swiper}'' and ``{\Dora}'' refer to weight-reduction algorithms defined in \Cref{sec:algo} and used to achieve these results. ``{\SwiperBlackBox}'' refers to the black-box transformation described in \Cref{subsec:black-box}.}}
    \label{tab:applications}
\end{table*}

\begin{table*}
    \centering
    \renewcommand{\arraystretch}{1.5}
    \begin{tabular}{|c|c|c|c|c|c|c|}
    \hline
    \multirow{3}{*}{\thead{System}} & \multirow{3}{*}{\thead{Total\\weight}} & \multirow{3}{*}{\thead{\# parties}} & \multicolumn{4}{|c|}{\thead{\# tickets using {\Swiper}}}\\[0.5ex]
    \cline{4-7}
    & & & $\fRw = 1/4$ & $\fRw = 1/3$ & $\fRw = 1/3$ & $\fRw = 2/3$\\
    & & & $\fRn = 1/3$ & $\fRn = 3/8$ & $\fRn = 1/2$ & $\fRn = 3/4$\\
    \hline\hline
    Aptos~\cite{aptos_white,aptos_stake}& $8.4708\times10^8$ & $104$ & $58$ & $203$ & $27$ & $138$\\
    \hline
    Tezos~\cite{tezos_white, tezos_stake} & $6.7579\times10^8$ & $382$ & $136$ & $598$ & $75$ & $481$ \\
    \hline
    Filecoin~\cite{filecoin_white,filecoin_stake} & $2.5242\times10^{19}$ & $3700$ & $3307$ & $11814$  & $1895$ & $8454$\\
    \hline
    Algorand~\cite{algorand_white,algorand_stake} & $9.7223\times10^9$ & $42~920$ & $961$ & $17273$ & $373$ & $17222$\\
    \hline
    \end{tabular}
    
    \medskip
    \caption{\atadd{Number of allocated tickets on sample weight distributions, using the {\Swiper} protocol described in \Cref{sec:algo} with recommended parameters.}}
    \label{tab:evaluations}
\end{table*}
