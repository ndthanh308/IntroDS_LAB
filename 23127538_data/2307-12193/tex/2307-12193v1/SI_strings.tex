\documentclass[report, amsmath,amssymb, aps, superscriptaddress]{revtex4-2}
\usepackage{b26_style}
\usepackage[yyyymmdd,hhmmss]{datetime}

\newcommand{\var}[1]{\langle #1^2 \rangle}
\newcommand{\remark}[1]{\textcolor{blue}{#1}}
\newcommand{\fix}[1]{\textcolor{red}{#1}}
\newcommand{\confirm}[1]{\textcolor{green}{#1}}
\newcommand{\suggestion}[1]{\textcolor{blue}{#1}}
\newcommand{\CnNOTe}{\textrm{C}_\textrm{n} \textrm{NOT}_\textrm{e}}
\newcommand{\fifteenN}{^{15}\textrm{N}}
\newcommand{\thirteenC}{^{13}\textrm{C}}

\DeclareUnicodeCharacter{2009}{\,}
\DeclareSIUnit\gauss{G}

\begin{document}
\include{commands}

\title{\Supplementary Information for \\
Programmable Quantum Processors based on Spin Qubits with Mechanically-Mediated Interactions and Transport}
\author{}
\maketitle

\tableofcontents

\section{Experimental setup}
The experiment is performed inside a modified Janis ST-500 continuous flow cryostat, which also serves as a vacuum chamber for room temperature measurements shown in Fig.~2 and 3. The AFM chip containing the diamond nanopillar is attached to a glass slide which is then mounted on a fixed copper block. The sample containing the nanobeams is mounted on a 3-axis Attocube stack (ANPz101 and ANPx101), which allows for fine control over the position of the diamond nanopillar relative to nanobeam.

We use a home-built confocal microscope to perform NV measurements. A Mach-Zehnder interferometer (Fig.~\ref{fig:interferometer}) integrated into the optical path is used to characterize the mechanical properties of the nanobeams.

% Figure environment removed

\section{Sample fabrication}
We start with a 4-inch, \SI{525}{\micro\meter}-thick, high resistivity ($\geq 10^4 ~\Omega \cdot \mathrm{cm}$) $\mathrm{\langle 100 \rangle}$ silicon wafer obtained from Silicon Valley Microelectronics (SVMI). These wafers have \SI{150}{\milli\meter} of high stress ($\sim 1$ GPa) silicon nitride deposited on one side using LPCVD. The backside is also scored $\sim \SI{200}{\nano\meter}$ deep according to a \SI{1}{\centi\meter} square grid.

First, we fabricate the coplanar waveguide (CPW) using optical lithography, electron-beam evaporation, and a liftoff process. The CPW consists of \SI{200}{\nano\meter} of gold evaporated on a \SI{7}{\nano\meter} sticking layer of titanium. Next, the mechanical resonators are defined with electron-beam lithography and the corresponding areas are etched with reactive ion etching, resulting in 
nanobeams that are \SI{145}{\micro\meter} long and \SI{1}{\micro\meter} wide.  Then the resonators are released using either a wet KOH etch or a dry $\mathrm{XeF_2}$ isotropic etch. Finally, the sample chip is wire-bonded to a printed circuit board (PCB) for microwave delivery.

We magnetically functionalize the nanobeam using a home-built micromanipulator setup. The sample is placed on a 3-axis translation stage, while a tungsten tip (75960-02, Electron Microscopy Sciences) is mounted on a nearby micromanipulator. This allows us to move both the sample and tip independently under a microscope objective (100X Mitutoyo Plan Apo SL). We first deposit a small volume of UV epoxy (Loctite 349) on the center of the beam using the tungsten tip. Then we use another tungsten tip to pick up a NdFeB micromagnet, put it on the glue, and cure the epoxy with UV light. Since we have observed that the glue remains tacky even after prolonged UV exposure, we put the sample on a hot plate at $\SI{80}{\celsius}$ for $8$ hours to eliminate any ``tackiness''. A comparison of the quality factors of a functionalized and bare resonator is shown in Fig.~\ref{fig:functionalized_Q}.

% Figure environment removed


Details on fabrication of the diamond nanopillars can be found in references \cite{angle_etch,zhou_scanning_2017}.


\section{Magnetic field imaging}
The scan in Fig.~2(a) in the main text was done in air at room temperature without an external field. At each position in the scan, we perform an electron spin resonance (ESR) measurement by sweeping a microwave frequency and observing changes in the NV center photoluminescence. Since we are not driving the mechanical resonator and the measurement time is much longer than the mechanical period, we can neglect the mechanics. The spin Hamiltonian is given by:

\begin{equation}
\mathcal{H}/\hbar = D S_z^2 + \gamma_e (S_z \cdot B_z + S_x \cdot B_x)
\end{equation}
where $D = \SI{2.8707}{\giga\hertz}$ is the zero-field splitting and $\gamma_e = \SI{2.8}{\mega\hertz/\gauss}$ is the NV gyromagnetic ratio. By diagonalizing $\mathcal{H}$, we can extract the magnetic field component $B_z$ from the micromagnet that is parallel to the NV center quantization axis.

Two pixels are missing because the ESR frequencies exceeded the frequency sweep range. We do not consider the missing pixels in the fit to the dipole model. For display in the figure, we fill in these pixels by interpolating from nearby pixels.

\section{Analytical form of contrast in the presence of mechanical motion}

For our analysis we consider only the $\ket{S_z = +1}$ and $\ket{S_z = 0}$ eigenstates, and model our spin-mechanical system using the following Hamiltonian:

\begin{equation}\label{Ham}
\mathcal{H}/\hbar = \frac{\omega_s}{2} \sigma_z + \omega_r a^\dagger a + \lambda 
\sigma_z (a + a^\dagger)
\end{equation}
where $a$ is the annihilation operator for the mechanical mode, $S_z = \frac{1}{2} \sigma_z$ is the spin-$\frac{1}{2}$ operator, and $\lambda = 2\pi \gamma_e z_p G$ is the spin-mechanical coupling strength for gradient $G$ and zero-point motion $z_p$. For our system, we find typical values of $z_p \sim \SI{10}{\femto\meter}$.

Considering a Hahn echo pulse sequence, we calculate the signal in the limit of no intrinsic spin decoherence. Since $\lambda$ is small, we use a semi-classical approximation, where the resonator quadrature $x = z_p (a + a^\dagger)$ is independent of the spin state.

After initializing the spin into $\ket{0}$, we put it into a coherent superposition with a $\pi/2$ pulse. We then let it evolve over time $\tau$, resulting in the following spin state, up to a global phase:

\begin{equation}
    \ket{\psi} = \frac{1}{\sqrt{2}}\left( \ket{0} + e^{-i\int_0^\tau \frac{\lambda}{z_p} x(t) dt}\ket{1} \right)
\end{equation}

After the $\pi$ pulse and evolution for another time $\tau$, the spin state becomes
\begin{equation}
\ket{\psi} = \frac{1}{\sqrt{2}}\left(\ket{0} + e^{-i \phi (\tau)}\ket{1} \right)
\end{equation}
where $ \phi(\tau) \equiv \int_\tau^{2\tau} \frac{\lambda}{z_p} x(t) dt - \int_0^\tau \frac{\lambda}{z_p} x(t) dt$ is the phase difference accumulated due to the mechanical motion. After the last $\pi/2$ pulse to convert the coherence into population, the measured contrast is $\alpha \cos{(\phi(\tau))}$, where $\alpha$ is a constant determined by the spin-dependent optical initialization and readout, as well as the background fluorescence. We assume that the quality factor is high, $Q \gg 1$, such that the signal is highly correlated during the pulse sequence, and can be given by a specific point in phase space with amplitude $x_0$ and phase $\phi_0$, such that $x(t) = x_0 \cos{(\omega_r t + \phi_0)}$. For a given run of the pulse sequence with phase $\phi_0$ and amplitude $x_0$ the accumulated phase on the spin is: 
\begin{equation}
    \phi(\tau) = \frac{\lambda}{z_p \omega_r} x_0 \left(\sin{(2\omega_r \tau + \phi_0)} - 2\sin{(\omega_r \tau + \phi_0)} + \sin{(\phi_0)} \right)
\end{equation}

The resonator frequency drifts over the duration of the Hahn echo measurement, so we apply a wide-band drive to ensure that the resonator is always driven on resonance. Because the wide-band drive effectively raises the temperature of the mechanical mode and the measurement is longer than the dissipation time,  we incoherently average over the statistical distribution for $x(t)$. From the statistics of thermal states, we assume that $\phi_0$ is uniformly distributed, and that the energy $E$ of the resonator follows a Boltzmann distribution:
\begin{equation}
p(E) dE = \frac{1}{kT} e^{\frac{E}{kT}} dE
\end{equation}
where $E = \frac{1}{2} m_{\mathrm{eff}} \omega_r^2 x_0^2$ and $\frac{1}{2} k_B T = \frac{1}{2} m_{\mathrm{eff}} \omega_r^2 \Delta_x^2$ according to the equipartition theorem; $m_{\mathrm{eff}}$ is the effective mass of the resonator, $k_B$ is the Botlzmann constant, $T$ is the effective temperature of the mechanical mode, and $\Delta_x^2$ is the variance of the mechanical motion.

%the square of the amplitude follows a Boltzmann distribution with mean $2\Delta_x^2$ (multiplied by two for each of the quadratures). %square of the amplitude $\mathcal{E}$ follows the Boltzmann exponential distribution, with mean given by $m \omega_r^2 \Delta_x^2$. 

Averaging over the phase $\phi_0$ first, we find the equivalent signal under a coherent drive with amplitude $x_0$:
\begin{equation}
    \alpha \langle \cos{(\phi(\tau))} \rangle_{\phi_0} = \alpha \mathcal{J}_0 \left(\frac{2\lambda x_0}{z_p\omega_r} \left(\cos{(\omega_r t)}-1\right)\right),
\end{equation}
where $\mathcal{J}_0$ is the zeroth order Bessel function of the first kind. Note that this would be the form of the signal under a coherent state assumption. Averaging over the amplitudes:
\begin{equation}
      \alpha \langle \cos{(\phi(\tau))} \rangle_{A, \phi_0} =\alpha \int_0^\infty \frac{1}{\Delta_x^2} e^{-x_0^2/2\Delta_x^2} \langle \cos{(\phi(\tau))} \rangle_{\phi_0} x_0 \text{ d}x_0 = \alpha e^{-q(\tau)}
\end{equation}
where $q(\tau) = 8 \Delta_x^2 \lambda^2 \sin^4{(\omega_r \tau/2)}/(\omega_r^2 z_p^2)$ as reported in the main text \cite{bennett_measuring_2012}. To account for spin decoherence, we include an additional phenomenological term $e^{\chi(\tau)}$ and factor it out with a baseline Hahn echo measurement in the absence of mechanical driving.

%As a consistency check, integrating over Gaussian distributions of the quadratures $x_0$ and $p_0 = m\omega_r \dot{x}_0$ yields the same result.

%\subsection{Consistency check 1}
%We can arrive at the same result if instead we model the position of the oscillator as $x(t) = x_0 \cos{(\omega_r t)} + \frac{p_0}{\omega m} \sin{(\omega_r t)}$ and take Gaussian averages over $x_0$ and $p_0$. YOU GET THE SAME RESULT IN THE END :)

%\subsection{Consistency check 2} COMPARING TO BENNETT ET AL: THEY INCLUDE THE EFFECT OF FINITE Q SINCE THEY DO LONGER DYNAMICAL DECOUPLING AND HAVE WORSE Q. THIS RESULTS IN NUMERICS. IN A LIMIT THEY GET AN EXPONENTIAL DECAY FORM LIKE WE DO, AND THEIR CURVES LOOK QUALITATIVELY THE SAME AS US.

\section{Preservation of coherent information while moving inside a field gradient}

\subsection{Experimental setup}
The measurements in Fig.~3 in the main text were performed in air at room temperature. An external field of about \SI{180}{\gauss} from a bar magnet is aligned within $1^{\circ}$ to the quantization axis of the NV center. To drive radiofrequency (RF) pulses on nuclear spins, we use an external coil consisting of magnet wire wound in two layers with $7$ turns each.

The sample is placed on a 3-axis Attocube stack, which in turn is placed on top of a single-axis flexure stage (Thorlabs NFL5DP20S). To move the sample containing the mechanical resonators horizontally relative to the nanopillar during the movement sequence, we drive the flexure stage with a signal from an arbitrary function generator (Tektronix AFG3021) amplified by a piezo driver (Thorlabs BPC301). The signal is chosen to be a simple sinusoid to avoid exciting higher harmonics of the setup (e.g. resonances of the Attocube stack).

\subsection{Nuclear and electronic spin control}
The RF signals are synthesized with an arbitrary function generator (Tektronix AFG3022) and amplified (Mini Circuits LZY-22+). With the RF coil placed between the nanopillar and long working distance objective (LU Plan 100X/0.90), we obtain minimum $\pi$-pulse durations of $\sim\SI{20}{\micro \second}$.

The same on-chip coplanar waveguide (CPW) in Fig.~1 of the main text is used to drive microwave (MW) transitions of the electronic spin. We generate two MW signals at the fixed frequencies $\mathrm{MW}_\uparrow$ and $\mathrm{MW}_{\downarrow}$, which correspond to the upper and lower $\fifteenN$ hyperfine transitions (Fig.~\ref{fig:pulsed_esr_stationary}). The two MW signals are combined using a power combiner, gated with a switch, and then amplified (Mini Circuits ZHL 16W 43+).

% Figure environment removed

During the movement sequence, the micromagnet begins near the NV center, moves away, and finally returns to its original position. The pulse sequences for the coherence measurements are synchronized with the movement sequence. While the hyperfine frequencies shift significantly over the entire movement sequence, we expect from the sinusoidal driving signal that the shift will be insignificant during the beginning and end, which are the only times where $\CnNOTe$ pulses are applied. We estimate from our field profile measurement in Fig.~3(a) that during the time between the two entangling/disentangling gates, the hyperfine frequencies do not deviate by more than \SI{15}{\kilo\hertz}, corresponding to an estimated phase accumulation of less than $0.01\,\pi$ over a maximum accumulation time of $\SI{4.5}{\micro\second}$.

\subsection{Pulse sequence for ESR measurements during movement sequence}

To monitor the field experienced by the NV center during the movement of the micromagnet (Fig.~3(a) in main text), we take pulsed ESR measurements at different times and MW frequencies during the movement sequence (Fig.~\ref{fig:pulsed_esr_moving}). By initializing the NV center electronic spin and then applying a $\pi$ pulse, we expect to see a drop in the NV photoluminescence if the MW frequency coincides with the ESR frequency. To obtain a better signal-to-noise ratio, we repeat for $n = 11$ times the initialization and $\pi$-pulse pair, for each time segment ($\sim \SI{46}{\micro\second}$) of the entire movement duration of \SI{1.7}{\milli\second}.

Due to the long read times of our data acquisition card, we use a single long readout window for each time segment, which results in faster data acquisition at the expense of lower photoluminescence contrast, as the readout window now includes times where the NV center is being reinitialized.

% Figure environment removed

\subsection{Pulse sequence for coherence measurement}
The detailed version of the pulse sequence in Fig.~3(b) in the main text is shown in Fig.~\ref{fig:full_pulse_sequence}. At the beginning of the pulse sequence, we polarize the $\fifteenN$ nuclear spin by first polarizing the electron spin and then transferring the polarization to the nuclear spin via a SWAP operation \cite{jiang2009repetitive}. A pulsed ESR measurement after $\fifteenN$ polarization is shown in Fig.~\ref{fig:nuclear_polarization}, where the polarization is $\sim\SI{78}{\percent}$.

% Figure environment removed


To normalize the measurement in Fig.~3(c) in the main text, we use the same pulse sequence, but without the two entangling and disentangling $\CnNOTe$ gates. Setting the rotation axis angle of the final nuclear $\pi/2$ pulse to be $\theta = 0$ and $\pi$, we obtain the upper and lower bounds for the fluorescence levels, which we use to normalize the measurements where we vary $\theta$.

% Figure environment removed

Despite the small gyromagnetic ratio of the the $\fifteenN$ nuclear spin, the field change during the movement sequence is large enough to cause significant phase accumulation ($>2 \pi$) on the nuclear spin. To cancel out this phase, we apply a $\pi$-pulse on the $\fifteenN$ nuclear spin. Since the field changes symmetrically during the movement sequence, the optimal time for this $\pi$-pulse is around the middle of the movement sequence, when the micromagnet is the furthest away from the NV center.

One can calculate the optimal $T_\pi$ by measuring the ESR frequencies of the electronic spin during the movement sequence (Fig.~3(a) in the main text). As the micromagnet moves away from the diamond nanopillar, the ESR frequencies become positively detuned relative to their initial values due to the Zeeman interaction; as the micromagnet moves back, the detunings of the ESR frequencies decrease back to $0$. The nuclear magnetic resonance (NMR) frequency of the $\fifteenN$ nuclear spin also experiences the same detuning as the electron spin, scaled by the ratio of their respective gyromagnetic ratios $\gamma_{\mathrm{n}}/\gamma_e$. We then solve for $T_\pi$ such that the total phase accumulated $\phi_{\mathrm{n}}$ is $0$:

\begin{equation}
\phi_{\mathrm{n}} = \int^{T_\pi}_0 \gamma_{\mathrm{n}}\delta_{\mathrm{n}}(t) dt - \gamma_{\mathrm{n}} \int^{T_{\mathrm{move}}}_{T_\pi} \gamma_{\mathrm{n}} \delta_{\mathrm{n}}(t) dt = 0
\label{eqn:phase_accum}
\end{equation}
where $T_{\mathrm{move}} = \SI{1.7}{\milli\second}$ is the duration of the entire movement sequence; $\delta_n(t)$ is the time-dependent detuning of the $\fifteenN$ NMR frequency from its frequency at the beginning of the movement sequence.

To experimentally determine $T_\pi$, we use the pulse sequence in Fig.~\ref{fig:vary_pi_time}, where we vary the $\pi$-pulse time $T_\pi$ and observe the resulting change in readout photoluminescence. As expected, as we vary $T_\pi$, the total phase accumulation also changes, resulting in the fringes in Fig.~\ref{fig:vary_pi_time}. The maxima of the fringe correspond to the times when the total phase accumulation is $0$. The maximum at $\sim \SI{853}{\micro\second}$ is roughly half the time of the movement sequence and agrees with the calculated result using Equation~\ref{eqn:phase_accum}.

% Figure environment removed

\subsection{Phase information $\phi(\tau)$}
In fig.~3(c) of the main text, we quantify the preservation of spin coherence by fixing $\tau = \SI{900}{\nano\second}$ and varying the rotation axis angle of the final $\pi/2$ pulse. We also show in Fig.~\ref{fig:phase_vary_tau} a measurement where we keep the rotation axis angle of the final $\pi/2$ pulse same as all the other nuclear pulses, and vary $\tau$ instead. As expected, we observe Ramsey fringes due to the $\CnNOTe$ gate having an equal detuning from the two $\thirteenC$ transitions. 

% Figure environment removed

\section{NV center electronic and nuclear spin coherence times}

In Fig.~\ref{fig:t1_t2}, we show measurements of the electron spin coherence time ($T_{2,e}$), lifetime ($T_{1,e}$), and the $\fifteenN$ nuclear spin coherence time ($T_{2,n}$). These measurements are performed in air at room temperature in the presence of an external bias magnetic field of $\sim \SI{180}{\gauss}$. With an XY8-4 sequence, $T_{2,e}$ exceeds \SI{0.95(4)}{\milli\second} (middle). We expect that NV centers implanted with more energy than the 6 keV used in this diamond nanopillar would have improved coherence times. Furthermore, we measure the nuclear spin coherence time $T_{2,n} \sim \SI{5}{\milli\second}$ (right), similar to $T_{1,e}$, suggesting that it is limited by the electron spin lifetime.

% Figure environment removed

\section{Comparisons of Cooperativity for Previous Works}
In Table~\ref{table:cooperativities} we compare the spin-mechanical cooperativity of our current system with those of previous works involving NV centers. We note that some of the previous works do not explicitly report parameters necessary to calculate the cooperativity; we give optimistic estimates (highlighted) where appropriate.

\begin{table}[]
\centering
\begin{tabular}{lcccccc}
\hline
Work &
  \begin{tabular}[c]{@{}c@{}}$\omega/(2\pi)$ \\ (Hz)\end{tabular} &
  \begin{tabular}[c]{@{}c@{}}$g/(2\pi)$\\ (Hz)\end{tabular} &
  \begin{tabular}[c]{@{}c@{}}T\\ (K)\end{tabular} &
  \begin{tabular}[c]{@{}c@{}}$n \kappa/(2\pi)$\\ (Hz)\end{tabular} &
  \begin{tabular}[c]{@{}c@{}}$T_2$\\ (s)\end{tabular} &
  $C$ \\ \hline
This work        & $\num{1.4e6}$ & $\num{7.7}$    & 20  & $\num{5e5}$  & $\num{8.8e-4}$ & $\num{1.0e-7}$  \\
Gieseler \textit{et al.} \cite{gieseler_single-spin_2020} & $\num{1.4e2}$ & $\num{4.8e-2}$ & \colorbox{yellow}{4}   & $\num{8e4}$  & $\colorbox{yellow}{\num{1.0e-2}}$ & $\num{2.8e-10}$ \\
Arcizet \textit{et al.} \cite{arcizet_single_2011} & $\num{1.0e6}$ & $\num{1.4e2}$  & 300 & $\num{4e10}$ & $\num{4.0e-4}$ & $\num{1.8e-10}$ \\
Oeckinghaus \textit{et al.} \cite{wrachtrup_cantilever_2020} & $\num{8.6e5}$ & $\num{7.7}$    & 5   & $\num{2e5}$  & $\num{1.2e-6}$ & $\num{2.8e-10}$ \\ \hline
\end{tabular}
\caption{Comparison of spin-mechanical cooperativities with previous works. Optimistic estimates (highlighted) are given for unreported values. We also note the large coupling strength ($> \SI{700}{\hertz}$ reported in a related work where a cantilever is coupled to unpaired electron spins ($\sim \SI{700}{\hertz})$ \cite{rugar_single_2004}; however, the spin coherence time and quality factor were not reported.}
\label{table:cooperativities}
\end{table}

%\bibliographystyle{unsrt}
\bibliography{SI_bib} 
\end{document}