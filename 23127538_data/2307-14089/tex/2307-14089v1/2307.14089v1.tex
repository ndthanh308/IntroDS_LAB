%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\documentclass[12pt,reqno]{amsart}

\newcommand\version{July 26, 2023}

%--- Packages ---

\usepackage{amsmath,amsfonts,amsthm,amssymb,amsxtra}
\usepackage{bbm} % to get \1
\usepackage{hyperref} % creates hyperlinks to the references 

%--- Page structure ---

%\addtolength{\hoffset}{-2cm}
%\addtolength{\textwidth}{4cm}

\renewcommand{\baselinestretch}{1.1}
\setlength{\voffset}{-.7truein}
\setlength{\textheight}{8.8truein}
\setlength{\textwidth}{6.05truein}
\setlength{\hoffset}{-.7truein}

%--- Theorem structure ---

\newtheorem{theorem}{Theorem}%[section]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}

\theoremstyle{definition}

\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}
\newtheorem{assumption}[theorem]{Assumption}

\theoremstyle{remark}

\newtheorem{remark}[theorem]{Remark}
\newtheorem{remarks}[theorem]{Remarks}

%--- Settings ---

%\numberwithin{equation}{section}

%--- Commands and math operators ---

\newcommand{\1}{\mathbbm{1}}
\newcommand{\A}{\mathbf{A}}
\newcommand{\B}{\mathfrak{B}}
\newcommand{\ball}{B}
\newcommand{\C}{\mathbb{C}}
\newcommand{\cl}{\mathrm{cl}}
\newcommand{\const}{\mathrm{const}\ }
\newcommand{\D}{\mathcal{D}}
\renewcommand{\epsilon}{\varepsilon}
\newcommand\eps\varepsilon
\newcommand{\I}{\mathbb{I}}
\newcommand{\F}{\mathcal{F}}
\newcommand{\loc}{{\rm loc}}
\newcommand{\mg}{\mathrm{mag}}
\newcommand{\N}{\mathbb{N}}
\newcommand{\ope}{\mathrm{op}}
\renewcommand{\phi}{\varphi}
\newcommand{\R}{\mathbb{R}}
\newcommand{\Rp}{\text{Re\,}}
\newcommand{\Sph}{\mathbb{S}}
\newcommand{\T}{\mathbb{T}}
\newcommand{\w}{\mathrm{weak}}
\newcommand{\Z}{\mathbb{Z}}

\DeclareMathOperator{\codim}{codim}
\DeclareMathOperator{\dist}{dist}
\DeclareMathOperator{\Div}{div}
\DeclareMathOperator{\dom}{dom}
\DeclareMathOperator{\im}{Im}
\DeclareMathOperator{\ran}{ran}
\DeclareMathOperator{\re}{Re}
\DeclareMathOperator{\spec}{spec}
\DeclareMathOperator{\supp}{supp}
\DeclareMathOperator{\sgn}{sgn}
\DeclareMathOperator{\Tr}{Tr}
\DeclareMathOperator{\tr}{Tr}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\begin{document}

\title[The generalized Wehrl entropy bound --- \version]{The generalized Wehrl entropy bound\\ in quantitative form}

\author{Rupert L. Frank}
\address[Rupert L. Frank]{Mathe\-matisches Institut, Ludwig-Maximilans Universit\"at M\"unchen, The\-resienstr.~39, 80333 M\"unchen, Germany, and Munich Center for Quantum Science and Technology, Schel\-ling\-str.~4, 80799 M\"unchen, Germany, and Mathematics 253-37, Caltech, Pasa\-de\-na, CA 91125, USA}
\email{r.frank@lmu.de}

\author{Fabio Nicola}
\address[Fabio Nicola]{Dipartimento di Scienze Matematiche, Politecnico di Torino, Corso Duca degli Abruzzi 24, 10129 Torino, Italy}
\email{fabio.nicola@polito.it}

\author{Paolo Tilli}
\address[Paolo Tilli]{Dipartimento di Scienze Matematiche, Politecnico di Torino, Corso Duca degli Abruzzi 24, 10129 Torino, Italy}
\email{paolo.tilli@polito.it}

\renewcommand{\thefootnote}{${}$} \footnotetext{\copyright\, 2023 by the authors. This paper may be reproduced, in its entirety, for non-commercial purposes.\\
	Partial support through US National Science Foundation grant DMS-1954995 (R.L.F.), as well as through the Deutsche Forschungsgemeinschaft (DFG, German Research Foundation) through Germanyâ€™s Excellence Strategy EXC-2111-390814868 (R.L.F.) is acknowledged.}

\begin{abstract}
	Lieb and Carlen have shown that pure states with minimal Wehrl entropy are coherent states. We prove that pure states with almost minimal Wehrl entropy are almost coherent states. This is proved in a quantitative sense where both the norm and the exponent are optimal and the constant is explicit. We prove a similar bound for generalized Wehrl entropies. 
\end{abstract}

\maketitle

\section{Introduction and main result}

We consider the following $L^2(\R)$-normalized Gaussian
$$
\phi(x) := 2^{1/4} e^{-\pi x^2} \,,
\qquad\text{for all}\ x\in\R \,,
$$
as well as its translations and modulations, for $(x_0,\omega_0)\in\R^2$,
$$
\phi_{(x_0,\omega_0)}(x) = e^{2\pi i\omega_0x} \phi(x-x_0) 
\qquad\text{for all}\ x\in\R \,.
$$
In various contexts in mathematics and its applications one arrives at the operator $\mathcal V$ that transforms a function $f\in L^2(\R)$ into a function $\mathcal Vf$ on $\R^2$, defined by
$$
(\mathcal V f)(x_0,\omega_0) = \int_{\R} \overline{\phi_{(x_0,\omega_0)}(x)} f(x)\,dx \,.
$$
The operator $\mathcal V$ is known as coherent state transform in mathematical physics and quantum mechanics and as short-time Fourier transform in signal processing and time-frequency analysis. It is easy to see that $\mathcal Vf\in L^2(\R^2)$ with
$$
\iint_{\R^2} |\mathcal Vf(x_0,\omega_0)|^2 \,dx_0\,d\omega_0 = \int_\R |f(x)|^2\,dx \,,
$$
so for $L^2$-normalized $f$, $|\mathcal Vf|^2$ can be viewed as a probability density on $\R^2$.

In the late 1970s Wehrl \cite{We} suggested a certain quantity, based on the coherent state transform, as a measure of the entropy of a quantum state and demonstrated several interesting properties of it. We refer to \cite{Sc} for a review of this topic. In the case of a pure state, described by an $L^2(\R)$-normalized $f$, Wehrl's entropy is
$$
- \iint_{\R^2} |\mathcal Vf(x_0,\omega_0)|^2 \ln |\mathcal Vf(x_0,\omega_0)|^2 \,dx_0\,d\omega_0 \,,
$$
which is the continuous entropy of the probability density $|\mathcal Vf|^2$.

In 1978 Lieb \cite{Li} proved Wehrl's conjecture that this entropy assumes its minimal value for $f=c\phi_{(x_0,\omega_0)}$, where $c\in\C$ with $|c|=1$ and $(x_0,\omega_0)\in\R^2$ are arbitrary. Lieb deduced this in an ingenious fashion from the sharp forms of the Hausdorff--Young and Young inequalities. Later, Carlen \cite{Ca} provided a new proof of Lieb's result and showed that the functions $f=c\phi_{(x_0,\omega_0)}$ are the only ones for which the minimal value is attained.

Our main result in this paper is a quantitative version of this result. Specifically, we will show that if $f$ has almost minimal Wehrl entropy, then it is close to the above family of functions in the sense that its squared $L^2$-distance to this family of functions is bounded from above by the discrepancy in entropy. We set
$$
D[f] := \inf_{x_0, \omega_0\in\R,\, |c|=1} \frac{\|f- c\phi_{(x_0,\omega_0)}\|_2}{\|f\|_2} \,,
$$
where $\|\cdot\|_2$ denotes the norm in $L^2(\R)$.

\begin{theorem}\label{wehrlintro}
	There is a $c_*>0$ such that, for all $f\in L^2(\R)$ with $\|f\|_2=1$,
	\begin{align}\label{eq:wehrlintro}
		- \iint_{\R^2} |\mathcal Vf(x,\omega)|^2 \ln |\mathcal Vf(x,\omega)|^2 \,dx\,d\omega
		& \geq - \iint_{\R^2} |\mathcal V\phi(x,\omega)|^2\ln|\mathcal V\phi(x,\omega)|^2 \,dx\,d\omega \notag \\
		& \quad + c_* D[f]^2 \,.
	\end{align}
\end{theorem}

\begin{remarks}
	(a) The constant $c_*$ in this theorem is explicit (in the sense that it is not obtained by a compactness argument) and is related to the constant $c$ in Theorem \ref{stabtau} by $c_*=c/4$.\\
	(b) The power $2$ of $D[f]$ in the theorem is optimal, as is easily seen by taking $f$ as a small perturbation of $\phi$.\\
	(c) One easily computes $- \iint_{\R^2} |\mathcal V\phi(x,\omega)|^2\ln|\mathcal V\phi(x,\omega)|^2 \,dx\,d\omega= 1$.
\end{remarks}

Theorem \ref{wehrlintro} will be a special case of a more general result. To motivate it, let us recall that in his proof of Wehrl's conjecture, Lieb proceeded by considering
\begin{equation}
	\label{eq:wehrlgen}
	\iint_{\R^2} \Phi(|\mathcal Vf(x,\omega)|^2) \,dx\,d\omega
\end{equation}
with $\Phi(u)=u^r$ for $r\geq 1$ and showing that, among $f$ with $\|f\|_2=1$, this quantity is maximal for $f=c\phi_{(x_0,\omega_0)}$. Many years later, Lieb and Solovej \cite{LiSo1} showed that the same is valid for any convex and continuous function $\Phi:[0,1]\to\R$. They deduced this generalized Wehrl conjecture via a limiting argument from their resolution of the analogue of Wehrl's conjecture for coherent spin states; see also \cite{LiSo2} for an alternative proof of the latter. The fact that \eqref{eq:wehrlgen} is maximized \emph{only} for the above family of functions (provided $\Phi$ is not affine linear) was shown recently in \cite{Fr,KuNiOCTi}.

Our main result is a quantitative version of this generalized Wehrl conjecture.

\begin{theorem}\label{thm1}
	Let $\Phi:[0,1]\to\R$ be continuous and convex with $\Phi(0)=0$ and assume that $\Phi$ is not a linear function. Then there is a constant $c_\Phi>0$ such that, for all $f\in L^2(\R)$ with $\|f\|_2=1$,
	\begin{equation}\label{SF}
		\iint_{\mathbb{R}^2} \Phi(|\mathcal{V} f(x,\omega)|^2)\, dx d\omega\leq \iint_{\mathbb{R}^2} \Phi(|\mathcal{V}\varphi(x,\omega)|^2)\, dx d\omega-c_\Phi D[f]^2. 
	\end{equation}
\end{theorem}

\begin{remarks}
	(a) As in Theorem \ref{wehrlintro}, the constant $c_\Phi$ is explicit (in the sense that it is not obtained by a compactness argument).\\
	(b) The power $2$ of $D[f]$ in the theorem is optimal, as is easily seen by taking $f$ as a small perturbation of $\phi$.\\
	(c) One easily computes $\iint_{\R^2} \Phi(|\mathcal V\phi(x,\omega)|^2)\,dx\,d\omega= \int_0^1 \Phi(\rho)\,\frac{d\rho}{\rho}$.\\
	(d) For $\Phi(\rho)= \rho\ln\rho$ one obtains Theorem \ref{wehrlintro}.
\end{remarks}

The developments that made the characterization of cases of equality in the generalized Wehrl conjecture possible \cite{Fr,KuNiOCTi} and that are also at the basis of our analysis here have their roots in the paper \cite{NiTi}, where an optimal Faber--Krahn inequality for the short-time Fourier transform/the coherent state transform was proved. As an aside we mention the paper \cite{Ku} by Kulikov that modified the method of \cite{NiTi} to prove contractivity properties of embeddings in Hardy and Bergman spaces and to verify an analogue of Wehrl's conjecture for the affine-linear group \cite{LiSo3}.

Very recently, in \cite{GGRT} a quantitative version of this optimal Faber--Krahn inequality was obtained. The present paper is a campanion to this result.

In fact, we give two proofs of Theorem \ref{thm1}. The first one is a `direct proof' that makes the analysis in \cite{NiTi} quantitative. At a crucial point in the analysis a lemma from the proof of the quantitative Faber--Krahn inequality will enter; see Lemma \ref{lemmaggrt} below. Our second proof of Theorem \ref{thm1} takes the quantitative version of the Faber--Krahn inequality as a black box and uses it to deduce the quantitative version of the generalized Wehrl entropy bound. We believe that both proofs have their value and we present them side by side. 

For simplicity we confine ourselves to the one-dimensional case, but the arguments below can be easily
generalized to higher dimensions (details will appear in an updated version of this paper).

%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%

\section{A first proof of the main result}

We have to introduce some notation and recall from \cite{NiTi,Fr,KuNiOCTi} some preliminary facts about the superlevel sets of $|\mathcal{V}f|$.  These properties are stated there for functions in the Fock space, but can be easily rephrased for the short-time Fourier transform; see e.g.~\cite{NiTi}.

\begin{lemma}\label{lem1}
	Let $f\in L^2(\mathbb{R})$ with $\|f\|_{2}=1$ and let
	\[
	\mu(t):=|\{|\mathcal{V}f|^2>t\}|
	\qquad\text{for all}\ t>0.
	\]
	\begin{itemize}
		\item[a)] $t\mapsto \mu(t)$ is nonincreasing and locally absolutely continuous.
		\item[b)] Setting $T:=\max |\mathcal{V}f|^2$, we have $T\in (0,1]$ and $T=1$ if and only if $f=c\varphi_{(x_0,\omega_0)}$ for some $(x_0,\omega_0)\in\mathbb{R}^2$ and $c\in\mathbb{C}$, $|c|=1$. 
		\item[c)] $\mu'(t)\leq -1/t$ for almost every $t\in(0,T)$, and $\mu(t)=0$ for $t\geq T$.
		\item[d)] Setting $\mu_0(t)=(-\ln t)_+$, there is a ${t^\ast}\in (0,T)$ such that $\mu({t^\ast})=\mu_0({t^\ast})$, and $\mu(t)\geq \mu_0(t)$ for $0<t<t^\ast$ and  $\mu(t)\leq \mu_0(t)$  for $t>t^\ast$.
	\end{itemize} 
\end{lemma}
One can easily see that $\mu_0(t)= (-\ln t)_+$ is in fact the distribution function associated with the Gaussian $\varphi$, or even to $\varphi_{(x_0,\omega_0)}$, for any $(x_0,\omega_0)\in\mathbb{R}^2$. Moreover, since $\|f\|_{2}=1$ and $\mathcal{V}:L^2(\mathbb{R})\to L^2(\mathbb{R}^2)$ is an isometry, we have 
\begin{equation}\label{eq int}
	\int_0^{+\infty} \mu(t)\, dt=\int_0^{+\infty} \mu_0(t)\, dt=1 \,.
\end{equation}

The main ingredient in the proof of \eqref{SF} is the function  
\begin{equation}
	\label{defH}
	H(t):=\int_0^t (\mu(\tau)-\mu_0(\tau))\,d\tau,\quad t\in [0,1].
\end{equation}
With the notation of Lemma \ref{lem1}, note that $H\in C^0([0,1])\cap C^1((0,1])$, $H(0)=H(1)=0$, $H$ is nondecreasing on $[0,{t^\ast}]$ and nonincreasing on $[{t^\ast},0]$, so $H\geq 0$ achieves its maximum at ${t^\ast}$. Moreover, since $H''=\mu'-\mu_0'$,
$H$ is concave on $[0,T]$ (by the differential inequality $\mu'\leq \mu_0'$, which is valid almost everywhere on $(0,T)$), and 
convex on $[T,1]$ (since, there, $H''=-\mu_0' > 0$).  

We well use the following fundamental estimates from \cite{GGRT}. 

\begin{lemma}\label{lemmaggrt}
	There is a constant $C>0$ such that for all $f\in L^2(\mathbb{R})$ with $\|f\|_{2}=1$ one has, in the notation of Lemma \ref{lem1},
	\begin{equation}\label{HT}
		1-T\leq C H({t^\ast}). 
	\end{equation}
\end{lemma}

\begin{proof}
	In \cite[Lemma 2.4]{GGRT} it was proved that, for some constant $C>0$,
	\[
	1-T\leq C\int_0^{s^\ast} (e^{-s}-u^\ast(s))\, ds,
	\]
	where $u^\ast(s)$ is the inverse function of $s=\mu(t)$ and $t^\ast=e^{-s^\ast}$, hence $s^\ast=u(t^\ast)$.  Since 
	\[
	\int_{t^\ast}^1 (\mu_0(t)-\mu(t))\, dt= \int_0^{s^\ast} (e^{-s}-u^\ast(s))\, ds,
	\]
	we obtain \eqref{HT} with the same constant $C$. 
\end{proof}

Also observe that, if $t\geq T$, then by \eqref{eq int}
\begin{equation}\label{eq agg}
	H(t)=\int_t^1(\mu_0(\tau)-\mu(\tau))\, d\tau=\int_t^1 (-\ln \tau)\, d\tau\geq \frac{(1-t)^2}{2}\qquad t\in[T,1],
\end{equation}
where we used the fact that  $-\ln t\geq 1-t$ for $t>0$.\par\medskip

We are now ready to proof Theorem \ref{thm1}.

\begin{proof}[Proof of Theorem \ref{thm1}]
	In follows from the proof of \cite[Theorem 1.3]{KuNiOCTi} that the integrals in \eqref{SF} could be $-\infty$, but not $+\infty$ and that, if the integral on the right side is $-\infty$, then the same holds for the integral on the left-hand side. Hence we can suppose that both integrals are finite. 
	
	With the notation of Lemma \ref{lem1}, 
	in terms of distribution functions, we have to prove that, if
	\begin{equation}
		\label{A}
		\varepsilon \geq \int_0^1 \Phi'(t)(\mu_0(t)-\mu(t))\,dt,
	\end{equation}  
	then
	\begin{equation}
		\label{B}
		1-T \leq C  \varepsilon,
	\end{equation}  
	for some constant $C$ that depends only on $\Phi$.
	Indeed, \eqref{SF} follows immediately from \eqref{B} and the simple fact that (see e.g.\ \cite[Lemma 2.5]{GGRT})
	\[
	D[f]^2=2(1-\sqrt{T})\leq 2(1-T).
	\]
	Of course we can suppose $T<1$. 
	
	The proof of \eqref{B} is elementary and is based on the following steps: 1) prove that
	$H(t_1)\leq C_1\eps$ at some point $t_1$ not too close to $t=0$ nor to $t=1$; 2) prove that this implies $H({t^\ast})\leq C_2\eps$, and conclude using \eqref{HT}.
	
	
	\bigskip
	
	\noindent{\emph{Step 1) }} Since $\Phi$ is convex, but not linear, there are two points $0<a<b<1$ such that
	\[
	\Phi'(b)-\Phi'(a)>0 \,.
	\]
	(Here and throughout, for definiteness, by $\Phi'(t)$ we mean e.g.\ the right derivative $\Phi'(t^+)$.) Let $t^\ast$ be as in Lemma \ref{lem1}. Then from \eqref{A}, since $\mu_0(t)-\mu(t)=-H'(t)$,
	\begin{align}
		\label{esti}
		\varepsilon\geq \int_0^1 \Phi'(t)\bigl(-H'(t) \bigr)\,dt=
		\int_0^1 \bigl(\Phi'(t)-\Phi'({t^\ast})\bigr)\bigl(-H'(t) \bigr)\,dt \,.
	\end{align}
	Note that $\bigl(\Phi'(t)-\Phi'({t^\ast})\bigr)\bigl(-H'(t) \bigr)\geq 0$ everywhere.
	Thus, if $a < {t^\ast} < b$, we have
	\begin{align*}
		\varepsilon &\geq 
		\int_0^a \bigl(\Phi'(t)-\Phi'({t^\ast})\bigr)\bigl(-H'(t) \bigr)\,dt
		+
		\int_b^1 \bigl(\Phi'(t)-\Phi'({t^\ast})\bigr)\bigl(-H'(t) \bigr)\,dt
		\\
		&=\int_0^a \bigl(\Phi'({t^\ast})-\Phi'(t)\bigr)H'(t)\,dt
		+
		\int_b^1 \bigl(\Phi'(t)-\Phi'({t^\ast})\bigr)\bigl(-H'(t) \bigr)\,dt\\
		&\geq
		\int_0^a \bigl(\Phi'({t^\ast})-\Phi'(a)\bigr)H'(t)\,dt
		+
		\int_b^1 \bigl(\Phi'(b)-\Phi'({t^\ast})\bigr)\bigl(-H'(t) \bigr)\,dt\\
		&=
		\bigl(\Phi'({t^\ast})-\Phi'(a)\bigr)H(a)
		+
		\bigl(\Phi'(b)-\Phi'({t^\ast})\bigr)H(b).
	\end{align*}
	Letting $t_1:=a$ or $t_1:=b$ in such a way that
	$H(t_1)=\min \{H(a),H(b)\}$, we get
	\begin{equation}
		\label{eq7}
		\eps
		\geq 
		%\bigl(\Phi'({t^\ast})-\Phi'(a)\bigr)H(t_1)+\bigl(\Phi'(b)-\Phi'({t^\ast})\bigr)H(t_1)=
		\bigl(\Phi'(b)-\Phi'(a)\bigr)H(t_1).
	\end{equation}
	If, on the other hand, ${t^\ast}\geq b$, then from \eqref{esti}
	\begin{align*}
		\varepsilon &\geq 
		\int_0^a \bigl(\Phi'(t)-\Phi'({t^\ast})\bigr)\bigl(-H'(t) \bigr)\,dt
		%+
		%\int_b^1 \bigl(\Phi'(t)-\Phi'({t^\ast})\bigr)\bigl(-H'(t) \bigr)\,dt
		=\int_0^a \bigl(\Phi'({t^\ast})-\Phi'(t)\bigr)H'(t)\,dt\\
		%+
		%\int_b^1 \bigl(\Phi'(t)-\Phi'({t^\ast})\bigr)\bigl(-H'(t) \bigr)\,dt\\
		&\geq
		\int_0^a \bigl(\Phi'(b)-\Phi'(a)\bigr)H'(t)\,dt
		%+
		%\int_b^1 \bigl(\Phi'(b)-\Phi'({t^\ast})\bigr)\bigl(-H'(t) \bigr)\,dt\\
		=
		\bigl(\Phi'(b)-\Phi'(a)\bigr)H(a),
		%+\bigl(\Phi'(b)-\Phi'({t^\ast})\bigr)H(b)
	\end{align*}
	and \eqref{eq7} holds again.
	Similarly, if ${t^\ast}\leq a$, then
	from \eqref{esti}
	\begin{align*}
		\varepsilon &\geq 
		%\int_0^a \bigl(\Phi'(t)-\Phi'({t^\ast})\bigr)\bigl(-H'(t) \bigr)\,dt
		%+
		\int_b^1 \bigl(\Phi'(t)-\Phi'({t^\ast})\bigr)\bigl(-H'(t) \bigr)\,dt\\
		&\geq
		\int_b^1 \bigl(\Phi'(b)-\Phi'(a)\bigr)\bigl(-H'(t) \bigr)\,dt
		=
		\bigl(\Phi'(b)-\Phi'(a)\bigr)H(b),
		%+\bigl(\Phi'(b)-\Phi'({t^\ast})\bigr)H(b),
	\end{align*}
	and \eqref{eq7} holds again.
	Summing up, in all cases we get
	\begin{equation}
		\label{estHt1}
		H(t_1)\leq \frac\eps{\Phi'(b)-\Phi'(a)},\quad\text{where either $t_1=a$ or $t_1=b$}.
	\end{equation}
	
	
	\bigskip
	
	\noindent{\emph{Step 2) }} Now that $t_1\in\{a,b\}$ has been fixed, we may have
	$t_1\leq {t^\ast}$, or ${t^\ast}<t_1\leq T$, or $t_1>T$. 
	
	
	If $t_1\leq {t^\ast}$,  since $H(0)=0$ and $H$ is concave on
	$[0,T]$, the ratio $H(t)/t$ is nonincreasing on $(0,T]$, so that
	\[
	H({t^\ast})\leq
	\frac {H({t^\ast})}{{t^\ast}}\leq\frac{H(t_1)}{t_1} \leq \frac{H(t_1)}{a}\leq \frac{\eps}{a (\Phi'(b)-\Phi'(a))}
	\]
	by \eqref{estHt1}. Combining with \eqref{HT}, we find
	\begin{equation}
		\label{est1}
		1-T\leq \frac{C\eps}{a (\Phi'(b)-\Phi'(a))}.
	\end{equation}

	If ${t^\ast}\leq t_1< T$, we consider the function $\tilde{H}(t)$ given by 
	\[
	\tilde{H}(t) :=
	\begin{cases}
		H(t) & \text{if}\ t\in [0,T] \,, \\
		H(T)+H'(T)(t-T) & \text{if}\ t\in (T,t_2] \,,
	\end{cases}
	\]
	where $H(T) =\int_T^1 (-\ln \tau)\, d\tau$ and $t_2:=(T-1)/\ln T\in (T,1)$ is the point $t$ where  $H(T)+H'(T)(t-T)=0$. Hence $\tilde{H}$ is concave on $[0,t_2]$ and $\tilde{H}(t_2)=0$. Since $t_2\to 1$ as $T\to 1$, we see that there is a $c=c(b)>0$ such that if $1-T<c$ we have, say, $t_2-b>\frac{1-b}{2}$. 
	
	Arguing as above, and assuming for the moment $1-T<c$, we have 
	\[
	H({t^\ast})\leq
	\frac {H({t^\ast})}{t_2-{t^\ast}}\leq\frac{H(t_1)}{t_2-t_1} \leq \frac{H(t_1)}{t_2-b}\leq \frac{2\eps}{(1-b) (\Phi'(b)-\Phi'(a))}.
	\]
	Combining with \eqref{HT}, we find
	\begin{equation}
		\label{est1}
		1-T\leq \frac{2C\eps}{(1-b)(\Phi'(b)-\Phi'(a))}.
	\end{equation}
	If $1-T\geq c$ we simply use the fact that, by \eqref{eq agg} (applied with $t=T$), 
	\[
	H(t_1)\geq H(T)\geq \frac{(1-T)^2}{2}\geq \frac c2\, (1-T)
	\]
	and one concludes using \eqref{estHt1}. 
	
	Finally, if $t_1> T$, then from  \eqref{estHt1} and \eqref{eq agg} (applied with $t=t_1$)  we get
	\[
	\frac\eps{\Phi'(b)-\Phi'(a)}\geq H(t_1)\geq \frac{(1-t_1)^2}2
	\geq \frac{(1-b)^2}2 \,,
	\]
	which is a lower bound for $\eps$ (so that \eqref{B} is trivial). In particular, we have
	\[
	\frac\eps{\Phi'(b)-\Phi'(a)}
	\geq \frac{(1-b)^2}2 \geq \frac{(1-b)^2}2 (1-T)
	\]
	and thus also in this case
	\begin{equation}
		\label{est2}
		1-T\leq\frac{2\eps}{(1-b)^2 (\Phi'(b)-\Phi'(a))}.
	\end{equation}
	This completes our first proof of Theorem \ref{thm1}.
\end{proof}

%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%

\section{A second proof of the main result}

Our second proof of the Theorem \ref{thm1} is related to Hardy--Littlewood majorization theory. While we present the proof in a self-contained way and will not use anything from this theory, it might be helpful for the reader to view it from this point of view (see, e.g., \cite[Theorems 108, 249, 250]{HaLiPo}, \cite[Corollary 2.1]{AlTrLi}, \cite[Theorem 15.27]{Si3} and also \cite[Chapter 2, Propsition 3.3]{BeSh}. Using majorization theory one can show that the generalized Wehrl conjecture and the Faber--Krahn inequality are equivalent. The main idea of this section is to show that stability for the Faber--Krahn inequality implies stability for the generalized Wehrl entropy bound.

\subsection*{Proof of the generalized Wehrl conjecture given the Faber--Krahn inequality}

In \cite[Section 5]{Fr} we have shown how the generalized Wehrl conjecture implies the Faber--Krahn theorem of \cite{NiTi}. As a warm up, let us begin by showing the converse. For the sake of conciseness, we do not characterize the cases of equality.

Let $\Phi:[0,1]\to\R$ be continuous and convex with $\Phi(0)=0$. For simplicity we also assume that $\Phi'(0)>-\infty$. (Here $\Phi'(0)$ denotes the right-sided derivative of $\Phi$, which exists by monotonicity. The assumption that it is $>-\infty$ excludes the important special case $\Phi(u) = u\ln u$, which we will discuss separately afterwards.) We can write, using $\Phi(0)=0$ and $\Phi'(0)>-\infty$,
\begin{equation}
	\label{eq:superposition}
	\Phi(u) = \Phi'(0) u + \int_0^\infty (u-\tau)_+ \Phi''(\tau)\,d\tau
	\qquad\text{for all}\ u\in[0,1] \,.
\end{equation}
Here the expression $\Phi''(\tau)\,d\tau$ should be interpreted as a (not necessarily absolutely continuous) measure on $[0,1]$. It follows that
$$
\iint_{\R^2} \Phi(|\mathcal Vf(x,\omega)|^2)\,dx\,d\omega = \Phi'(0) + \int_0^\infty \iint_{\R^2} \left( |\mathcal Vf(x,\omega)|^2 - \tau \right)_+\,dx\,d\omega\, \Phi''(\tau)\,d\tau.
$$
We fix $\tau>0$ and set
$$
E := \{ |\mathcal Vf|^2>\tau \} \,.
$$
Then, by the Faber--Krahn inequality of \cite{NiTi},
\begin{align*}
	\iint_{\R^2} \left( |\mathcal Vf(x,\omega)|^2 - \tau \right)_+\,dx\,d\omega
	& = \iint_E |\mathcal Vf(x,\omega)|^2 \,dx\,d\omega - \tau |E| \\
	& \leq \iint_{E^*} |\mathcal V\phi(x,\omega)|^2 \,dx\,d\omega - \tau |E^*| \\
	& = \iint_{E^*} \left( |\mathcal V\phi(x,\omega)|^2 - \tau \right) \,dx\,d\omega \,,
\end{align*}
where $E^*$ denotes the disk in $\R^2$, centered at the origin, with the same area as $E$. Now it is immediate (`bathtub principle') that
\begin{align*}
	\iint_{E^*} \left( |\mathcal V\phi(x,\omega)|^2 - \tau \right) dx\,d\omega 
	& \leq \iint_{E^*} \left( |\mathcal V\phi(x,\omega)|^2 - \tau \right)_+ dx\,d\omega \\
	& \leq \iint_{\R^2} \left( |\mathcal V\phi(x,\omega)|^2 - \tau \right)_+ dx\,d\omega \,.
\end{align*}
Inserting this into the above expression, we find
\begin{align*}
	\iint_{\R^2} \Phi(|\mathcal Vf(x,\omega)|^2)\,dx\,d\omega & \leq \Phi'(0) + \int_0^\infty \iint_{\R^2} \left( |\mathcal V\phi(x,\omega)|^2 - \tau \right)_+ dx\,d\omega\, \Phi''(\tau)\,d\tau \\
	& = \iint_{\R^2} \Phi(|\mathcal V\phi(x,\omega)|^2)\,dx\,d\omega \,.
\end{align*}
This is the generalized Wehrl entropy inequality of Lieb and Solovej in the special case $\Phi'(0)>-\infty$.

In case $\Phi'(0)=-\infty$, we apply the above inequality with $\Phi(u)$ replaced by the function $\max\{\Phi(u),-(1/\varepsilon) u\}$ and let $\epsilon\to 0$. In the original Wehrl case, i.e.\ $\Phi(u)=u\ln u$, we can alternatively write
\begin{equation}
	\label{eq:superpositionwehrl}
	u\ln u = \int_0^1 \left( (u-\tau)_+ - u \right) \frac{d\tau}{\tau} + \int_1^\infty (u-\tau)_+ \frac{d\tau}{\tau} + u
	\qquad\text{for all}\ u\in [0,\infty) \,.
\end{equation}
This can be verified by explicit computation. Given this formula, the argument is precisely the same as before.

%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%

\subsection*{Stability for fixed $\tau$}

To get stability for the generalized Wehrl inequality, we want to follow the same route as above and deduce it from the stability for the Faber--Krahn inequality. The goal is therefore to first prove stability for the special case $\Phi(u)=(u-\tau)_+$ with some fixed $\tau>0$. We shall prove

\begin{theorem}\label{stabtau}
	There is a constant $c>0$ such that for any $\tau>0$ and any $f$ with $\|f\|_2=1$,
	$$
	\iint_{\R^2} (|\mathcal V f|^2-\tau)_+ \,dx\,d\omega \leq \left( 1 -  c \tau D[f]^2 \right) \iint_{\R^2} (|\mathcal V \phi|^2-\tau)_+ \,dx\,d\omega \,.
	$$
	The constant $c$ is explicit and can be chosen as $\min\{ \frac{c_0}2,\frac1{16}\}$, where $c_0$ is the constant in the stability version of the Faber--Krahn inequality. 
\end{theorem}

We recall that the stability version of the Faber--Krahn inequality, due to \cite{GGRT}, reads
$$
\iint_\Omega |\mathcal Vf(x,\omega)|^2\,dx\,d\omega \leq \left(1- c_0 e^{-|\Omega|} D[f]^2 \right) \iint_{\Omega^*} |\mathcal V\phi(x,\omega)|^2\,dx\,d\omega \,.
$$

\begin{proof}
	We go through the above argument, setting again $E:=\{|\mathcal Vf|^2>\tau\}$. By the above stability version of the Faber--Krahn inequality, we obtain
	\begin{align*}
		\iint_{\R^2} \left( |\mathcal Vf(x,\omega)|^2 - \tau \right)_+dx\,d\omega
		& \leq (1 - c_0 e^{-|E|} D[f]^2) \iint_{E^*} |\mathcal V\phi(x,\omega)|^2 \,dx\,d\omega - \tau |E^*| \\
		& = (1 - c_0 e^{-|E|} D[f]^2) \iint_{E^*} \left( |\mathcal V\phi(x,\omega)|^2 - \tau \right) dx\,d\omega \\
		& \quad - c_0 e^{-|E|} D[f]^2 \tau |E| \\
		& \leq (1 - c_0 e^{-|E|} D[f]^2) \iint_{E^*} \left( |\mathcal V\phi(x,\omega)|^2 - \tau \right) dx\,d\omega \,.
	\end{align*}
	Note that, by expanding the square of the $L^2$ norm and optimizing over $c$,
	\begin{equation}
		\label{eq:distancesmall}
		D(f)^2 = 2 \left( 1- \sup_{z_0} |(\phi_{z_0},f)| \right) \leq 2 \,.
	\end{equation}
	Thus, $c_0 e^{-|E|} D[f]^2 \leq 2c_0$ and by assuming that $c_0\leq 1/2$, we may assume that the prefactor $1 - c_0 e^{-|E|} D[f]^2$ is nonnegative. Therefore we can argue as before and use
	\begin{equation}
		\label{eq:bathtub1}
		\iint_{E^*} \left( |\mathcal V\phi(x,\omega)|^2 - \tau \right) dx\,d\omega \leq
	\iint_{\R^2} \left( |\mathcal V\phi(x,\omega)|^2 - \tau \right)_+ dx\,d\omega \,.
	\end{equation}
	Thus, we have shown the bound
	\begin{equation}
		\label{eq:tauinitial}
		\iint_{\R^2} \left( |\mathcal Vf(x,\omega)|^2 - \tau \right)_+dx\,d\omega
		\leq (1 - c_0 e^{-|E|} D[f]^2) \iint_{\R^2} \left( |\mathcal V\phi(x,\omega)|^2 - \tau 	\right)_+ dx\,d\omega \,.
	\end{equation}
	This is almost of the form claimed in Theorem \ref{stabtau}, except that it contains $|E|$, which depends on $f$, and which we still need to bound.
	
	We set
	$$
	F_\tau := \{ |\mathcal V\phi|^2 >\tau \} \,.
	$$
	Using
	$$
	\mathcal V\phi(x,\omega) = e^{i\pi x\omega} e^{-\frac\pi 2(x^2+\omega^2)} \,,
	$$
	we see that $F_\tau$ is a disk with
	$$
	|F_\tau|=\ln\frac1\tau \,.
	$$
	
	We distinguish two cases. The first one is where
	$$
	e^{-|E|} \geq \frac12 e^{-|F_\tau|} = \frac\tau 2 \,.
	$$
	In this case, we can insert this bound into \eqref{eq:tauinitial} and obtain a bound of the form claimed in Theorem \ref{stabtau}.
	
	In the opposite case, we have
	$$
	e^{-|E|} < \frac12 e^{-|F_\tau|} \,,
	$$
	which we can write as
	\begin{equation}
		\label{eq:case2}
		e^{-|F_\tau|} - e^{-|E|} > \frac12 e^{-|F_\tau|}= \frac\tau 2 \,.
	\end{equation}
	In this case we only use the Faber--Krahn inequality, but not its stability version. Our goal is to improve on inequality \eqref{eq:bathtub1}. To do so, we write
	\begin{align}
		\label{eq:bathtubformula}
		\iint_{E^*} \left( |\mathcal V \phi|^2 - \tau \right) dx\,d\omega 
		& = \iint_{\R^2} \left( |\mathcal V \phi|^2 - \tau \right)_+ dx\,d\omega \notag \\
		& - \iint_{F_\tau \setminus E^*} \left( |\mathcal V \phi|^2 - \tau \right)_+ dx\,d\omega
		- \iint_{E^* \setminus F_\tau} \left( |\mathcal V \phi|^2 - \tau \right)_- dx\,d\omega \,.
	\end{align}
	Previously to arrive at \eqref{eq:bathtub1}, we dropped the last two terms. Now we keep them and we will get a remainder bound out of these.
	
	Note that $F_\tau$ and $E^*$ are concentric disks, so at most one of the two extra integrals is nonzero. Our assumption on $e^{-|E|} < \frac12 e^{-|F_\tau|}$ implies that $|E|> |F_\tau|$, so only the last term is nonzero. We define $R\geq 0$ by
	$$
	|E| = \pi R^2
	$$
	and compute explicitly using the above form of $\mathcal V\phi$. We obtain
	\begin{align}
		\label{eq:bathtub}
		\iint_{E^* \setminus F_\tau} \left( |\mathcal V \phi|^2 - \tau \right)_- dx\,d\omega
		& = 2\pi \int_{(\frac1\pi \ln\frac1\tau)^{1/2}}^R ( \tau - e^{-\pi r^2}) r\,dr \notag \\
		& = \int_{\ln\frac1\tau}^{\pi R^2} ( \tau - e^{-\rho})\,d\rho \notag \\
		& = e^{-|E|} - e^{-|F_\tau|} + \tau |E| - \tau |F_\tau| \,.
	\end{align}
	Now we use the elementary inequality
	\begin{equation*}
		%\label{eq:elementary}
		s-\ln s - 1 \geq \frac12(1-s)^2
		\qquad\text{for all}\ 0<s\leq 1 \,,
	\end{equation*}
	which follows by writing
	\begin{align*}
		s-\ln s - 1 = \int_s^1 \left( \frac1t- 1\right)dt = \int_s^1 \int_t^1 \frac{du}{u^2}\,dt \geq \int_s^1 \int_t^1 du\,dt = \frac12(1-s)^2 \,.
	\end{align*}
	Taking $s = e^{-|E|} / e^{-|F_\tau|} = \tau e^{-|E|}$, we deduce that
	$$
	e^{-|E|} - e^{-|F_\tau|} + \tau |E| - \tau |F_\tau| \geq \frac1{2\tau} (e^{-|F_\tau|} - e^{-|E|})^2 \,.
	$$
	This, when inserted into \eqref{eq:bathtub}, gives
	\begin{equation}
		\label{eq:bathtubrem}
			\iint_{E^* \setminus F_\tau } \left( |\mathcal V \phi|^2 - \tau \right)_+ dx\,d\omega
		\geq \frac1{2\tau} (e^{-|F_\tau|} - e^{-|E|})^2 \,,
	\end{equation}
	and, returning to \eqref{eq:bathtubformula}, we find
	$$
	\iint_{E^*} \left( |\mathcal V \phi|^2 - \tau \right) dx\,d\omega 
	\leq \iint_{\R^2} \left( |\mathcal V \phi|^2 - \tau \right)_+ dx\,d\omega \\
	- \frac1{2\tau} (e^{-|F_\tau|} - e^{-|E|})^2 \,.
	$$
	This is the desired improvement of \eqref{eq:bathtub1}.
	
	Thus, if we go through the argument at the beginning of this section and use our improved bound, we get
	\begin{align*}
		\iint_{\R^2} (|\mathcal Vf|^2-\tau)_+\,dx\,d\omega 
		& \leq \iint_{E^*} (|\mathcal V\phi|^2-\tau)\, dx\,d\omega \\
		& \leq \iint_{\R^2} (|\mathcal V\phi|^2-\tau)_+ \,dx\,d\omega - \frac1{2\tau} (e^{-|F_\tau|} - e^{-|E|})^2 \,.
	\end{align*}
	According to our assumption \eqref{eq:case2} and the bound \eqref{eq:distancesmall}, we have
	$$
	\frac1{2\tau} (e^{-|F_\tau|} - e^{-|E|})^2 \geq \frac{\tau}{8} \geq \frac{\tau}{16} D[f]^2 \,.
	$$
	In order to write the inequality in a multiplicative form, we compute
	\begin{equation}
		\label{eq:entropytau}
		\iint_{\R^2} (|\mathcal V\phi|^2-\tau)_+ \,dx\,d\omega = 1 - \tau - \tau \ln \frac1\tau \,.
	\end{equation}
	In particular, $\iint_{\R^2} (|\mathcal V\phi|^2-\tau)_+ \,dx\,d\omega\leq 1$ and therefore
	$$
	\frac{\tau}{16} D[f]^2 \geq \frac{\tau}{16} D[f]^2 \iint_{\R^2} (|\mathcal V\phi|^2-\tau)_+ \,dx\,d\omega \,.
	$$
	This gives the desired bound in the second case.
\end{proof}

%%%%%%%%%%%%%%%%%%%%%%%

\subsection*{Stability for general $\Phi$}

With Theorem \ref{stabtau} at hand, it is easy to prove Theorem \ref{thm1}. We will prove the bound \eqref{SF} with constant
$$
c_\Phi := c \int_0^1 \tau (1-\tau - \tau \ln\frac1\tau)\, \Phi''(\tau)\,d\tau \,,
$$
where $c$ is the constant from Theorem \ref{stabtau}.

Indeed, when $\Phi'(0)>-\infty$, then this bound follows from the superposition formula \eqref{eq:superposition}, the expression \eqref{eq:entropytau} for the maximum and the stability bound for $\Phi(u)=(u-\tau)_+$ from Theorem \ref{stabtau}.

If $\Phi'(0)=-\infty$ we can apply the same approximation argument as at the beginning of this section. Alternative, in the original Wehrl case we can use the superposition formula \eqref{eq:superpositionwehrl}. In both ways we obtain the bound \eqref{eq:wehrlintro} with constant
$$
c_* := c \int_0^1 (1-\tau - \tau \ln\frac1\tau) \,d\tau = \frac c4 \,,
$$	
where again $c$ is the constant from Theorem \ref{stabtau}.

\section{Acknowledgments} F. N. and P. T. would like to thank Aleksei Kulikov and Joaquim Ortega-Cerd\`a for useful discussions on the topic of this paper. 

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%

\bibliographystyle{amsalpha}

\begin{thebibliography}{16}
	
	\bibitem{AlTrLi} A. Alvino, G. Trombetti, P.-L. Lions, \textit{On optimization problems with prescribed rearrangements}. Nonlinear Anal. \textbf{13} (1989), no. 2, 185--220.
	
	\bibitem{BeSh} C. Bennett, R. Sharpley, \textit{Interpolation of operators}. Pure and Applied Mathematics, 129. Academic Press, Inc., Boston, MA, 1988.
	
	\bibitem{Ca} E. A. Carlen, \textit{Some integral identities and inequalities for entire functions and their application to the coherent state transform}. J. Funct. Anal. \textbf{97} (1991), no. 1, 231--249.
	
	\bibitem{Fr} R. L. Frank, \textit{Sharp inequalities for coherent states and their optimizers}. Adv. Nonlinear Stud. \textbf{23} (2023), no. 1, Paper No. 20220050, 28 pp.
	
	\bibitem{GGRT}
	J.~Gomez, A.~Guerra, J.P.G.~Ramos and P.~Tilli.
	\newblock Stability of the Faber-Krahn inequality for the Short-time Fourier Transform.
	\newblock {\em arXiv:2307.09304}, 2023.
	
	\bibitem{HaLiPo} G. H. Hardy, J. E. Littlewood, G. P\'olya, \textit{Inequalities}. Reprint of the 1952 edition. Cambridge Mathematical Library. Cambridge University Press, Cambridge, 1988.
	
	\bibitem{Ku} A. Kulikov, \textit{Functionals with extrema at reproducing kernels}. Geom. Funct. Anal. \textbf{32} (2022), no. 4, 938--949. 
	
	\bibitem{KuNiOCTi} A. Kulikov, F. Nicola, J. Ortega-Cerd\`a, P. Tilli, \textit{A monotonicity theorem for subharmonic functions on manifolds}. Preprint (2022), arXiv:2212.14008.
	
	\bibitem{Li} E. H. Lieb, \textit{Proof of an entropy conjecture of Wehrl}. Comm. Math. Phys. \textbf{62} (1978), no. 1, 35--41.
	
	\bibitem{LiSo1} E. H. Lieb, J. P. Solovej, \textit{Proof of an entropy conjecture for Bloch coherent spin states and its generalizations}. Acta Math.\ \textbf{212} (2014), no.\ 2, 379--398.
	
	\bibitem{LiSo2} E. H. Lieb, J. P. Solovej, \textit{Proof of the Wehrl-type entropy conjecture for symmetric $\mathrm{SU(N)}$ coherent states}. Comm.\ Math.\ Phys.\ \textbf{348} (2016), no.\ 2, 567--578.
	
	\bibitem{LiSo3} E. H. Lieb, J. P. Solovej, \textit{Wehrl-type coherent state entropy inequalities for $\mathrm{SU(1,1)}$ and its AX+B subgroup}. In: Partial differential equations, spectral theory, and mathematical physics -- the Ari Laptev anniversary volume, 301--314, EMS Ser. Congr. Rep., EMS Press, Berlin, 2021.
	
	\bibitem{NiTi} F. Nicola, P. Tilli, \textit{The Faber--Krahn inequality for the short-time Fourier transform}. Invent. Math. \textbf{230} (2022), no. 1, 1--30. 
	
	\bibitem{Sc} P. Schupp, \textit{Wehrl entropy, coherent states and quantum channels}. In: The Physics and Mathematics of Elliott Lieb, Vol. II, 329--344, EMS Press, Berlin, 2022.
	
	\bibitem{Si3} B. Simon, \textit{Convexity. An analytic viewpoint}. Cambridge Tracts in Mathematics, 187. Cambridge University Press, Cambridge, 2011.
	
	\bibitem{We} A. Wehrl, \textit{On the relation between classical and quantum-mechanical entropy}. Rep.\ Math.\ Phys.\ \textbf{16} (1979), no.\ 3, 353--358.
\end{thebibliography}

\end{document}