\documentclass{article}

\setlength{\oddsidemargin}{.0in}
\setlength{\evensidemargin}{.0in}
\setlength{\textwidth}{6.5in}
\setlength{\topmargin}{-.3in}
\setlength{\headsep}{.20in}
\setlength{\textheight}{9.in}
\raggedbottom

% PACKAGES

\usepackage{enumitem}
\usepackage{url}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{graphicx}
\usepackage{float}
\usepackage{caption}
\usepackage{amsthm}
\usepackage{color}
\definecolor{green}{rgb}{0,0.5977,0}
\usepackage[linesnumbered,algoruled,boxed,lined]{algorithm2e}

% GENERAL SHORTCUTS

% Common symbols
\newcommand{\rr}{\mathbb R}
\newcommand{\cc}{\mathbb C}
\newcommand{\zz}{\mathbb Z}
\newcommand{\nn}{\mathbb N}
\newcommand{\qq}{\mathbb Q}
\newcommand{\ee}{\mathbb E}
\newcommand{\ff}{\mathbb F}
\newcommand{\zzn}[1]{\zz/{#1}\zz}
\newcommand{\id}{\text{id}}

% Common operations
\newcommand{\inv}{^{-1}}
\newcommand{\abs}[1]{\left|{#1}\right|}
\newcommand{\man}[1]{\left|\left|{#1}\right|\right|_1}
\newcommand{\suchthat}{\ | \ }
\newcommand{\tand}{\txt{ and }}
\newcommand{\normalize}[1]{\frac{#1}{\abs{#1}}}
\newcommand{\normallize}[1]{\frac{#1}{\abs{{\abs#1}}}}
\newcommand{\tth}{^\text{th}}
\newcommand{\genseq}[3]{{#1}_1 {#3} {#1}_2 {#3} \dots {#3} {#1}_{#2}}
\newcommand{\seq}[2]{\genseq{#1}{#2}{,}}
\DeclareMathOperator*{\argmin}{argmin}
\DeclareMathOperator*{\argmax}{argmax}
\newcommand{\pp}[1]{\mathbb{P}\left\{#1\right\}}

% General tools
\newcommand{\twocases}[4]{\begin{cases} #2 & #1 \\ #4 & #3 \end{cases}}
\newcommand{\threecases}[6]{\begin{cases} #2 & #1 \\ #4 & #3 \\ #6 & #5 \end{cases}}
\newcommand{\triad}[5]{\threecases{#1 < #2}{#3}{#1 = #2}{#4}{#1 > #2}{#5}}
\newcommand{\emptybox}[2][\textwidth]{\begingroup\setlength{\fboxsep}{-\fboxrule}\noindent\mbox{\rule{0pt}{#2}}\endgroup}
\newcommand{\leavespace}{{\centering\emptybox[15cm]{10cm}}}
\newcommand{\txt}[1]{\text{#1}}
\newcommand{\fcite}[1]{\texttt{#1.pdf}}
\newcommand{\red}[1]{{\color{red} #1}}

% Align mode tools
\newcommand{\stext}[1]{\ \ \ \ \ \text{(#1)}}
\newcommand{\stextn}[1]{\\&\ \ \ \ \ \ \stext{#1}}
\newcommand{\bcause}[1]{\stext{because ${#1}$}}
\newcommand{\snc}[1]{\stext{since ${#1}$}}
\newcommand{\indhyp}{\stext{by the inductive hypothesis}}
\newcommand{\triineq}{\stext{by the triangle inequality}}
\newcommand{\ub}{\stext{by the union bound}}
\newcommand{\bydef}{\stext{by definition}}
\newcommand{\push}{\\ & \ \ \ \ \ \ \ \ \ \ }
\newcommand{\topindent}{&\hspace{1.335em}}

% Graphics
\newcommand{\ig}[2]{% Figure environment removed}
\newcommand{\igc}[3]{% Figure environment removed}
\newcommand{\ignc}[3]{% Figure environment removed}
\newcommand{\ipnct}[3]{% Figure environment removed}
\newcommand{\ignct}[3]{% Figure environment removed}
\newcommand{\igm}[2]{% Figure environment removed}
\newcommand{\igcm}[3]{% Figure environment removed}
\newcommand{\igncm}[3]{% Figure environment removed}
\newcommand{\ignsm}[4]{% Figure environment removed}
\newcommand{\ip}[2]{% Figure environment removed}
\newcommand{\ipc}[3]{% Figure environment removed}
\newcommand{\ipnc}[3]{% Figure environment removed}
\newcommand{\ipm}[2]{% Figure environment removed}
\newcommand{\ipcm}[3]{% Figure environment removed}
\newcommand{\ipncm}[3]{% Figure environment removed}
\newcommand{\ipnsm}[4]{% Figure environment removed}

% Algorithms
\makeatletter 
\g@addto@macro{\@algocf@init}{\SetKwInOut{Parameter}{Parameters}} 
\makeatother

% SUBJECT SPECIFIC SHORTCUTS

% Algebra
\newcommand{\pres}[2]{\langle {#1} \ | \ {#2} \rangle}

% Analysis
\newcommand{\infsum}{\sum_{n = 0}^\infty}
\newcommand{\finsum}{\sum_{n = 0}^N}
\newcommand{\limh}{\lim_{h \to 0}}

% Complex analysis
\newcommand{\real}{\text{Re}}
\newcommand{\imag}{\text{Im}}
\newcommand{\nz}{|z|^2}
\newcommand{\Arg}{\text{Arg}}
\newcommand{\Log}{\text{Log}}
\newcommand{\ddz}{\frac{d}{dz}}

% Complexity theory
\newcommand{\PP}{\mathsf{P}}
\newcommand{\NP}{\mathsf{NP}}
\newcommand{\NPh}{$\NP$-hard }
\newcommand{\NPc}{$\NP$-complete }
\newcommand{\BQP}{\mathsf{BQP}}

% Optimization
\newcommand{\succinctlp}[3]{\begin{tabular}{l l}\textbf{#1} & \begin{tabular}{l}$#2$\end{tabular}\\\textbf{subject to} & \begin{tabular}{l}$#3$\end{tabular}\end{tabular}}
\newcommand{\spmax}[2]{\succinctlp{maximize}{#1}{#2}}
\newcommand{\spmin}[2]{\succinctlp{minimize}{#1}{#2}}
\newcommand{\lp}[3]{\begin{tabular}{l l}\textbf{#1} & \begin{tabular}{l}$#2$\end{tabular}\\\textbf{subject to} & \begin{tabular}{l l}#3\end{tabular}\end{tabular}}
\newcommand{\lpmax}[2]{\lp{maximize}{#1}{#2}}
\newcommand{\lpmin}[2]{\lp{minimize}{#1}{#2}}

% Partition theory
\newcommand{\pofn}[1]{p(n \ | \ \text{#1})}

% p-adic numbers
\newcommand{\pabs}[1]{\left|{#1}\right|_p}
\newcommand{\qp}{\qq_p}
\newcommand{\zp}{\zz_p}

% Quantum mechanics
\newcommand{\bra}[1]{\langle {#1} |}
\newcommand{\ket}[1]{| {#1} \rangle}
\newcommand{\braket}[2]{\langle {#1} | {#2} \rangle}

% Topology
\newcommand{\rp}[1]{\rr\text{P}^{#1}}
\newcommand{\cp}[1]{\cc\text{P}^{#1}}
\newcommand{\Ht}{\widetilde{H}}

% Linear algebra
\newcommand{\mTwoTwo}[4]{\begin{bmatrix}{#1}&{#2}\\{#3}&{#4}\end{bmatrix}}
\newcommand{\mTwoThree}[6]{\begin{bmatrix}{#1}&{#2}&{#3}\\{#4}&{#5}&{#6}\end{bmatrix}}
\newcommand{\mTwoFour}[8]{\begin{bmatrix}{#1}&{#2}&{#3}&{#4}\\{#5}&{#6}&{#7}&{#8}\end{bmatrix}}
\newcommand{\mThreeTwo}[6]{\begin{bmatrix}{#1}&{#2}\\{#3}&{#4}\\{#5}&{#6}\end{bmatrix}}
\newcommand{\mThreeThree}[9]{\begin{bmatrix}{#1}&{#2}&{#3}\\{#4}&{#5}&{#6}\\{#7}&{#8}&{#9}\end{bmatrix}}
\newcommand{\mFourTwo}[8]{\begin{bmatrix}{#1}&{#2}\\{#3}&{#4}\\{#5}&{#6}\\{#7}&{#8}\end{bmatrix}}
\newcommand{\vectTwo}[2]{\begin{bmatrix}{#1}\\{#2}\end{bmatrix}}
\newcommand{\rowTwo}[2]{\begin{bmatrix}{#1}&{#2}\end{bmatrix}}
\newcommand{\vectThree}[3]{\begin{bmatrix}{#1}\\{#2}\\{#3}\end{bmatrix}}
\newcommand{\rowThree}[3]{\begin{bmatrix}{#1}&{#2}&{#3}\end{bmatrix}}
\newcommand{\vectFour}[4]{\begin{bmatrix}{#1}\\{#2}\\{#3}\\{#4}\end{bmatrix}}
\newcommand{\rowFour}[4]{\begin{bmatrix}{#1}&{#2}&{#3}&{#4}\end{bmatrix}}

% Category theory
\newcommand{\inl}{\txt{inl}}
\newcommand{\inr}{\txt{inr}}
\newcommand{\obj}{\txt{obj }}

\makeatletter
\newcommand*{\shifttext}[2]{%
	\settowidth{\@tempdima}{#2}%
	\makebox[\@tempdima]{\hspace*{#1}#2}%
}
\makeatother

\theoremstyle{plain}
\newtheorem{theorem}{Theorem}
\newtheorem{lemma}[theorem]{Lemma} 
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{claim}[theorem]{Claim}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{question}[theorem]{Question}
\newtheorem{globalTheorem}{Theorem}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{example}[theorem]{Example}
\newtheorem{exercise}[theorem]{Exercise}
\usepackage{tagging}
\usetag{name}

\numberwithin{theorem}{section}

\begin{document}
	\title{Locked Polyomino Tilings}
	\author{\iftagged{name}{Jamie Tucker-Foltz\footnote{\texttt{jtuckerfoltz@gmail.com}}\\Harvard University}{Manuscript \#81}}
	\maketitle
	
	\begin{abstract}
		A locked $t$-omino tiling is a grid tiling by $t$-ominoes such that, if you remove any pair of tiles, the only way to fill in the remaining $2t$ grid cells with $t$-ominoes is to use the same two tiles in the exact same configuration as before. We exclude degenerate cases where there is only one tiling overall due to small dimensions. It is a classic (and straightforward) result that finite grids do not admit locked 2-omino tilings. In this paper, we construct explicit locked $t$-omino tilings for $t \geq 3$ on grids of various dimensions. Most notably, we show that locked 3- and 4-omino tilings exist on finite square grids of arbitrarily large size, and locked $t$-omino tilings of the infinite grid exist for arbitrarily large $t$. The result for 4-omino tilings in particular is remarkable because they are so rare and difficult to construct: Only a single tiling is known to exist on any grid up to size $40 \times 40$.
		
		Locked $t$-omino tilings arise as obstructions to widely used political redistricting algorithms in a model of redistricting where the underlying census geography is a grid graph. Most prominent is the \emph{ReCom} Markov chain, which takes a random walk on the space of redistricting plans by iteratively merging and splitting pairs of districts (tiles) at a time. Locked $t$-omino tilings are isolated states in the state space of ReCom. The constructions in this paper are counterexamples to the meta-conjecture that ReCom is irreducible on graphs of practical interest.
	\end{abstract}
	
	\section{Introduction}\label{secIntro}
	
	In the United States, \emph{redistricting} is the process by which states regularly  redraw electoral districts in accordance with new census data. To mathematicians and computer scientists, political redistricting is most commonly thought of as a graph partitioning problem. The vertices represent census blocks, precincts, or counties, and the edges represent geographic adjacency. Given such a vertex-weighted graph $G$ and a target number of districts $k$, redistricting is the act of partitioning the vertex set of $G$ into $k$ sets of equal population, each inducing connected subgraphs.
	
	One of the most successful algorithmic paradigms for exploring the space of redistricting plans (graph partitions) is to run a Markov chain whereby adjacent districts are merged into a double-district and then instantly split again, hopefully in a different way \cite{ReCom}. Such an operation is called a \emph{recombination move}, and the sampling algorithm is known as \emph{ReCom} for short. In practice, the ReCom chain is observed to be rapidly mixing, meaning that, after a short number of steps, it will not matter what redistricting plan the chain started from, and ultimately all plans should have some nonzero probability of being sampled by the algorithm. In theory, however, very little is known about the mixing time.
	
	Arguably the most simple model of this problem is to take $G$ to be an $m \times n$ grid graph, which we notate $G(m, n)$. Grid graphs are simple objects that capture many salient features of those graphs encountered in real-world geographic data. As such, they have been the subject of many prior works on redistricting algorithms \cite{DGKO18, ReCom, RevReCom, procacciaTuckerFoltz2021compactness, tappspanning, charikar2022complexity, frieze2022subexponential, NnToN}. We assume, as is typical in this model, that vertices have equal population. The \emph{metagraph} $\mathcal{M}(G, t)$ is the graph whose vertices are partitions of $G$ into connected subgraphs, each containing exactly $t$ vertices, with two partitions joined by an edge whenever they differ only on two parts (see Figure \ref{figMetagraphExample}). A ReCom Markov chain on redistrictings of $G$ into $k$ is thus a walk on $\mathcal{M}(G, t)$, where $t = \frac{\abs{G}}{k}$, so, given a probabilistic transition function, we may inquire about its mixing time. A prerequisite, of course, is the basic question of whether or not $\mathcal{M}(G, t)$ is even connected. Unfortunately, even for $k = 3$, very little is known.
	
	\ipnct{.16}{G33Meta}{\label{figMetagraphExample}The metagraph $\mathcal{M}(G(3, 3), 3)$. Each vertex is a partition of the $3 \times 3$ grid graph into connected subgraphs, each containing 3 vertices. Note that this graph is connected, as is claimed by Conjecture \ref{cnjGridKEquals3}.}
	
	\begin{conjecture}\label{cnjGridKEquals3}
		For any positive integer $n$ that it divisible by 3, $\mathcal{M}(G(n, n), \frac{n^2}{3})$ is connected.
	\end{conjecture}
	
	Every step, you are allowed to repartition two-thirds of the entire grid graph any way you wish, so surely it is possible to eventually get from one partition to any other? If we completely drop the constraint that parts have equal numbers of vertices, it is known that the metagraph of partitions into $k$ districts is connected whenever $G$ is 2-connected, and moreover, it is possible to transition from one partition to another by only reassigning a single vertex at each step \cite{AnySizeDistricts}. When $G$ has a Hamiltonian cycle, Akitaya, Korman, Korten, Souvaine, and T\'oth \cite{AnySizeDistrictsNew} show that districts need be no bigger than double their target size (but may still need to be as small as a single vertex). More relevant is the groundbreaking triangular lattice metagraph connectivity result for $k = 3$ by Cannon \cite{TriangularLattice}, which keeps very strict balance constraints. Compared to Conjecture \ref{cnjGridKEquals3}, this result is weaker in the following three ways.
	\begin{itemize}
		\item The graph $G$ is a subset of the triangular lattice rather than a square lattice. This graph structure is easier to work with since the neighbors of any vertex are connected by a path/cycle, a fact that is leveraged by the proof in a crucial way.
		\item The districts may vary in size $\pm 1$ from the target size. This makes it easier to transition from one partition to another, as only one vertex need be reassigned in a given step.
		\item Districts must always be simply-connected.
	\end{itemize}
	
	In this paper, we approach the metagraph connectivity question from the opposite end of the parameter space: instead of taking $k$ to be small, we assume the district size $t$ to be small. On grid graphs, it is natural to think of this problem in the language of \emph{polyomino tilings}. Specifically, we study the space of $t$-omino tilings of $m \times n$ grids under operations that replace two tiles at a time. Here we find new obstacles, exemplified by the 3-omino tiling in Figure \ref{fig3Omino6}.
	
	\ipnct{.16}{Triomino6}{\label{fig3Omino6}A locked 3-omino tiling of $G(6, 6)$. In total, there are 50 such tilings.}
	
	Observe that there are no two adjacent tiles that can be merged and split into 3-ominoes in a different way than they are currently arranged. Since there are no recombination moves, this tiling is an isolated vertex in $\mathcal{M}(G(6, 6), 3)$, proving that the graph is disconnected. Further, observe that we may tile any $6m \times 6n$ grid with copies of this tiling arranged in an $m \times n$ grid of $6 \times 6$ blocks as in Figure \ref{fig3Omino12}. By flipping every other block, we ensure that there are no recombination moves available on the boundaries between blocks either. This shows that grid metagraphs can be disconnected for arbitrarily large $k$, even fixing $t = 3$.
	
	\ipnc{.16}{Triomino12}{\label{fig3Omino12}A locked 3-omino tiling of $G(12, 12)$ obtained from copying and flipping the tiling from Figure \ref{fig3Omino6}.}
	
	Formally, we define a \emph{locked $t$-omino tiling} of an $n$-vertex graph $G$ to be an isolated vertex in $\mathcal{M}(G, t)$ that is not the only vertex in $\mathcal{M}(G, t)$. This final condition outlaws degenerate cases: a tiling cannot be considered locked merely because there are no other tilings (as this is not a connectivity counterexample anyway). The fundamental question we ask in this paper is,
	
	\begin{center}
		\emph{For which grid dimensions and which $t$ do there exist locked $t$-omino tilings?}
	\end{center}
	This question is interesting for two principal reasons:
	\begin{enumerate}
		\item Locked tilings point to the theoretical limits of ReCom and other MCMC-based redistricting algorithms. Much effort has been spent on trying to prove rapid mixing. Understanding the combinatorial obstructions that can occur informs what assumptions we might need to make in order to guarantee mixing properties, or what tweaks to the algorithms may be necessary (e.g., relaxing balance constraints, recombining more than two districts at a time). Furthermore, the problem of balanced graph partitioning with small parts arises when jurisdictions impose \emph{nesting rules}, for example, that a state senate district must be formed from exactly 3 state house districts \cite{NestingRules}.
		\item There is a substantial mathematics literature on connectivity of polyomino tilings via local moves. This particular question, where we do not restrict the set of $t$-ominoes that may be used, is arguably the most basic one to ask, yet it has not been studied before beyond the case of $t = 2$ (see Section \ref{subLitReview}). Perhaps this is due to the fact that locked $t$-omino tilings for larger $t$ are so difficult to find that they require computational methods, as this paper employs (see Section \ref{subAlgorithm}).
	\end{enumerate}
	
	For $t = 2$, no locked polyomino tilings exist on any rectangular grid. In the special case of the $8 \times 8$ grid, this is a classic mathematical puzzle: Is it possible to cover a chessboard with $1 \times 2$ dominoes without creating a $2 \times 2$ square? Not only is this not possible, but it is well-known that the metagraph is connected on any rectangular grid, and moreover, ReCom is rapidly mixing \cite{GlauberConnected2, GlauberConnected1}. For completeness, in Section \ref{sec2Omino} we give an elementary proof of the connectivity of 2-omino metagraphs on grids.
	
	In Section \ref{sec3Omino} we then turn to 3-ominoes, where locked tilings are abundant. The example from Figures \ref{fig3Omino6} and \ref{fig3Omino12} show that grids with side lengths divisible by 6 admit locked tilings; we prove a stronger result, that all sufficiently large grids admit locked tilings. On the other hand, if one of the side lengths is at most 3, we show that the metagraph is connected, so no locked tilings exist.
	
	In Section \ref{sec45Omino} we construct locked 4- and 5-omino tilings, which are considerably more difficult to find. The constructions in this section were discovered in part with the help of a computer program. One would expect to find none, as is the case with 2-ominoes, or many, as is the case with 3-ominoes. Instead, after exhaustively searching for all locked tilings on the $m \times n$ grid for any $m, n \leq 20$, the program found only a \emph{single} tiling of each type up to isomorphism: There is one locked 4-omino tiling on a $10 \times 10$ grid, and one locked 5-omino tiling on a $20 \times 20$ grid. The next smallest known locked 4- and 5-omino tilings are on the $42 \times 42$ and $30 \times 30$ grids, respectively. In Section \ref{sec45Omino} we describe the algorithm and present these tilings, along with a generalization of the $42 \times 42$ tiling to an infinite family of locked 4-omino tilings on larger and larger finite grids.
	
	In Section \ref{secTori} we briefly consider infinite periodic tilings, in both the square and triangular grid lattices. These are easier to reason about since there is no boundary, so all vertices look the same. While we conjecture that the set of integers $t$ for which there exist locked $t$-omino tilings of finite grids is bounded (possibly even by 5), it turns out that this is not the case for infinite tilings. We construct a family of infinite periodic locked $t$-omino tilings for increasing $t$.
	
	\subsection{Related Work on Polyomino Recombination}\label{subLitReview}
	
	The study of connectivity of domino tilings by local moves goes back to the works of Conway and Lagarias \cite{Conway} and Thurston \cite{GlauberConnected1}, who construct a ``height function'' on the dual graph with the property that the highest point can always be decreased by a recombination move. This actually turns the set of domino tilings into a lattice, implying that the state space is connected \cite{ThurstonMadePrecise}. Surprisingly, this holds not just on rectangular grids, but any any simply connected grid subgraph.
	
	On lattices other than the square lattice, the space of domino tilings can easily fail to be connected. If we add diagonals to the square lattice (all in the same direction), we get the triangular lattice, on which there are simple examples of locked tilings. For instance, consider a triangle with six vertices. There are only two perfect matchings in the triangular lattice, and they are not connected by a recombination move \cite{TriangularLattice}. However, Kenyon and R\'emila \cite{DominoesTriangularLattice} showed that recombination moves involving 4 dominoes suffice to connect the space of domino tilings on any simply connected subgraph of the triangular lattice. R{\o}ising and Zhang \cite{DominoesArchimedianLattices} generalized this result to all eleven Archimedean lattices. If we add diagonals to the square grid in \emph{alternating} directions, then pairwise recombination moves suffice \cite{Impurities}.
	
	Larger polyomino sizes have received far less attention. To the best of our knowledge, this is the first paper to study the question of state space connectivity with arbitrary tiles of a given small size $t \geq 3$. Related questions have been investigated previously in the context of restricted tile sets. Korn \cite{KornThesis} studies the question of when arbitrarily powerful local moves, perhaps involving recombining more than two tiles, exist for restricted sets of polyominoes. While not every tile set admits \emph{any} set local moves, it is known that recombinations of up to 4 pieces are sufficient to connect the space of grid tilings by T-shaped 4-ominoes \cite{TOmino}. Sheffield \cite{Ribbon} shows that pairwise recombination moves connect the set of \emph{ribbon tilings} of order $n$ in any simply connected grid subgraph. In a ribbon tiling, each piece must be a path that snakes upward and to the right.
	
	\section{Domino Tilings}\label{sec2Omino}
	
	In this section we present an elementary proof of the following result, which is originally credited to William Thurston \cite{GlauberConnected1} as mentioned above. Our proof, while less elegant and general, is perhaps easier to understand.
	
	\begin{theorem}\label{thmDominoConnected}
		For any positive integers $m$ and $n$, $\mathcal{M}(G(m, n), 2)$ is connected.
	\end{theorem}
	
	
	
	\begin{proof}
		If either $m$ or $n$ is 1, or if $mn$ is odd, then there is at most one tiling, so the metagraph is obviously connected. So suppose both side lengths are at least 2, and without loss of generality assume the horizontal dimension has even length. We show that any pair of tilings are connected to each other via a sequence of recombination moves by showing that any given tiling is connected to a ``central'' tiling in which all dominoes are horizontally oriented. Starting from the top-left corner, reading left-to-right, top-to-bottom, let $D_1$ be the first domino that is vertically oriented. In Figure \ref{figDominoConnectivityProof}, $D_1$ is the black-outlined domino.
		
		\ipnc{.16}{DominoConnectivityProof}{\label{figDominoConnectivityProof}A generic step of the algorithm to transition to the all-horizontal domino tiling.}
		
		If the domino $D_2$ to the right of $D_1$ is also vertically oriented, then we can recombine $D_1$ and $D_2$ so that $D_1$ is horizontal. Otherwise we check if we can recombine $D_2$ with the domino $D_3$ below it, and so on. Iteratively supposing we cannot recombine, we find a ladder of dominoes extending downward and to the right, which must eventually terminate in a $2 \times 2$ square (the gold vertical dominoes in the bottom of Figure \ref{figDominoConnectivityProof}) because it cannot go on forever without hitting the boundary of the rectangular grid. It is straightforward to see that a sequence of recombination moves can push this square up the ladder until $D_1$ is horizontal. Note that these moves do not touch any of the horizontal dominoes preceding $D_1$. Thus, we have strictly increased the number of consecutive horizontal dominoes reading from the top-left corner. We can continue iteratively applying this algorithm until all dominoes are horizontal.
	\end{proof}
	
	\section{Tromino Tilings}\label{sec3Omino}
	
	We begin our discussion of 3-ominoes by considering the easy cases where the metagraph is connected. The proof proceeds along similar lines as the proof of Theorem \ref{thmDominoConnected}, though there are a few more cases to consider.
	
	\begin{theorem}\label{thmTriominoConnected}
		For any positive integers $m$ and $n$ such that $m \leq 3$, $\mathcal{M}(G(m, n), 3)$ is connected.
	\end{theorem}
	
	\begin{proof}
		As before, we may assume without loss of generality that $mn$ is divisible by 3 and both $m$ and $n$ are at least 2.
		
		\ipnc{.16}{TriominoConnectivityProofEasy}{\label{figTriominoConnectivityProof2} Steps required to make all 3-ominoes horizontal in a $2 \times n$ grid.}
		
		If $m = 2$, then we show that we can transition from any tiling to a tiling in which all 3-ominoes are horizontal. Indeed, the first column that is not configured this way must be configured according to one of the four cases in Figure \ref{figTriominoConnectivityProof2}. As indicated by the arrows, we can reconfigure these 3-ominoes to be horizontal in at most 2 moves. Continuing inductively, we can eventually make all 3-ominoes horizontal.
		
		\ipnc{.16}{TriominoConnectivityProof}{\label{figTriominoConnectivityProof3} All possible cases of what the frontier could look like in transitioning to an all-vertical tiling of a $3 \times n$ grid.}
		
		If $m = 3$, we analogously transition to a tiling in which all 3-ominoes are \emph{vertical}. Figure \ref{figTriominoConnectivityProof3} exhaustively lists all possible cases of what the neighborhood around the first column that is not a 3-omino could look like. We leave it to the reader to verify that it is always possible to make this column into a vertical 3-omino in at most 3 recombination moves.
	\end{proof}
	
	The smallest nontrivial case that is not covered by this theorem is $m = 6$ and $n = 4$. Already here there are locked 3-omino tilings---up to isomorphism, there are 7 distinct tilings. We conjecture that locked tilings exist whenever Theorem \ref{thmTriominoConnected} does not apply, i.e., whenever $m$ is divisible by 3 (which is without loss of generality), $m \geq 6$, and $n \geq 4$. It is tedious to prove a statement like this as, even though 3-omino tilings are plentiful, they are largely unstructured and difficult to find, especially when $m$ or $n$ is odd. With not to much difficulty, we can obtain a weaker result, replacing the number 4 with 100.
	
	\begin{theorem}\label{thm3OminoLocked}
		For any integers $m$ and $n$ such that $m$ is divisible by 3, $m \geq 6$, and $n \geq 100$, the $m \times n$ grid has a locked 3-omino tiling.
	\end{theorem}
	
	\begin{proof}
		Given the assumptions on $m$ and $n$, one can verify that it is always possible to find nonnegative integers $x_1, x_2, x_3, x_4, x_5$ such that $m = 6x_1 + 9x_2$ and $n = 22x_3 + 19x_4 + 8x_5$, with one of $x_1$ or $x_2$ greater than zero and $x_3$ also greater than zero. We may thus draw straight horizontal and vertical lines across the entire grid to partition the grid into rectangular blocks of size $6 \times 22$, $9 \times 22$, $6 \times (22 + 19x_4 + 8x_5)$, and $9 \times (22 + 19x_4 + 8x_5)$. We may fill these blocks in with the tilings depicted in Figure \ref{figTriominoLocked}.
		
		\ipnc{.14}{Triomino100Colorful}{\label{figTriominoLocked} Locked 3-omino tilings that can tile with themselves and each other.}
		
		Each tiling consists of four parts: two green parts on the end of total length 22, a red part in the middle of length 19, and a blue part of length 8. To make a rectangle of length $22 + 19x_4 + 8x_5$ we repeat the red part $x_4$ times and the blue part $x_5$ times. One can check that there are no recombination moves within the interiors of any of these tilings, nor between neighboring blocks.
	\end{proof}
	
	\section{Tetromino and Pentomino Tilings}\label{sec45Omino}
	
	\subsection{Enumeration Algorithm}\label{subAlgorithm}
	
	While locked 3-omino tilings can be found by hand with some effort, locked $t$-omino tilings are extremely difficult to construct for $t \geq 4$. However, for small grids we may attempt to enumerate them exhaustively using a computer. The surprising takeaway from these computational results is that locked 4- and 5-omino tilings exist, but are extraordinarily rare.
	
	The algorithm, which has been made publicly available online,\footnote{\iftagged{name}{\url{https://github.com/jtuckerfoltz/LockedPolyominoTilings}}{Link excluded for the purposes of anonymity.}} works as follows. We enumerate all possible locations within all possible $t$-ominoes that a given cell could be contained in, which we call the \emph{type} of the cell. For example, when $t = 2$, there are 4 types, depending on whether the other cell in the domino is above, below, to the left, or to the right. For $t = 3$, there are 18 types, for $t = 4$, there are 76 types, and for $t = 5$, there are 315 types.\footnote{See OEIS sequence A048664 \cite{OtherOEIS}.} Next, we enumerate, for every $(x, y)$ offset, all the incompatible pairs of types, i.e., the set of pairs of types $(t_1, t_2)$ such that it is not possible for a cell at location $(x_0, y_0)$ to have type $t_1$ and a cell at location $(x_0 + x, y_0 + y)$ to have type $t_2$ because the tiles either intersect or admit a recombination move. We store the incompatible pairs in a massive lookup table, representing types as arbitrary integers to save space. We then augment the lookup table by iteratively applying the following rule until no more additions are made: it is not possible for cell $a$ to have type $t_1$ and cell $b$ to have type $t_2$ if that would mean that there is no compatible type for some other cell $c$. All of these steps are very time consuming, but only need to be computed once for each polyomino size.
	
	For any given grid size, we initialize each grid cell with the set of types it is allowed to have. For most interior cells, this is almost all types, but cells near the grid boundary have additional restrictions. We then iteratively pick a cell with few possible types and recursively try all of them, eliminating incompatible types for other cells as we go. This enables us to exhaustively search for all locked polyomino tilings. The reason this algorithm is so successful at handling large grid sizes is that the locking constraint is quite strong, which severely restricts the branching factor.
	
	\subsection{Computational Results on Small Grids}\label{subSmallGrids}
	
	Using the algorithm described in the previous section, we may enumerate all locked 4-, 5-, and 6-omino tilings on rectangular grids up to size $20 \times 20$, and all tilings that are also rotationally symmetric on grids up to size $40 \times 40$. Table \ref{tab456} summarizes the results: Only a small handful of locked 4- and 5-omino tilings exist, and no locked 6-omino tilings have been found.
	
	\begin{table}[ht]\begin{center}
			\begin{tabular}{ r|c|c|c }
				Number of locked $t$-omino tilings on grids of size\dots & 4-ominoes & 5-ominoes & 6-ominoes\\
				\hline
				\dots up to $20 \times 20$ & 1 & 1 & 0\\
				\dots up to $40 \times 40$, with 4-fold rotational symmetry & 1 & 3270 & 0
			\end{tabular}
			\caption[]{\label{tab456}Enumeration of locked 4-, 5-, and 6-ominoes on small grid sizes, counting up to isomorphism.}
	\end{center}\end{table}
	
	%\begin{proposition}\label{pro4OminoLocked}
	%	Up to isomorphism, there is only one locked 4-omino tiling of any grid of up to 400 vertices (shown in Figure \ref{figUniqueTilings10}). Among tilings that are additionally 4-fold rotationally symmetric, it is unique for grids up to size $40 \times 40$.
	%\end{proposition}
	
	%\begin{proposition}\label{thm5OminoLocked}
	%	Up to isomorphism, there is only one locked 5-omino tiling of any grid with both dimensions $\leq 20$ (shown in Figure \ref{figUniqueTilings20}). For square grids up to size $40 \times 40$, the exact number of locked 5-omino tilings that are additionally 4-fold rotationally symmetric is given by Table \ref{tabSymmetric5OminoTilings}.
	%\end{proposition}
	
	%\begin{proposition}\label{thm5OminoLocked}
	%	There are no locked 6-omino tilings of any grid with both dimensions $\leq 20$, nor any rotationally symmetric  $40 \times 40$, the exact number of locked 5-omino tilings that are additionally 4-fold rotationally symmetric is given by Table \ref{tabSymmetric5OminoTilings}.
	%\end{proposition}
	
	Figure \ref{figUniqueTilings10} shows the sole locked 4-omino tiling mentioned in this table, and Figure \ref{figUniqueTilings20} shows the smallest locked 5-omino tiling.\tagged{name}{\footnote{Pictures of additional tilings can be found online at:\\\url{https://github.com/jtuckerfoltz/LockedPolyominoTilings/tree/main/Images}}} Table \ref{tabSymmetric5OminoTilings} further breaks down the enumeration of locked 5-omino tilings by grid dimensions.
	
	\ipnc{.16}{TetrominoLocked10}{\label{figUniqueTilings10}The smallest locked 4-omino grid tiling.}
	
	\ipnc{.16}{S20-Z.drawio}{\label{figUniqueTilings20}The smallest locked 5-omino grid tiling.}
	
	\begin{table}[ht]\begin{center}
			\begin{tabular}{ c|c }
				Square grid side length & Number of symmetric locked 5-omino tilings (A365862)\\
				\hline
				5 & 0\\
				10 & 0\\
				15 & 0\\
				20 & 1\\
				25 & 0\\
				30 & 10\\
				35 & 27\\
				40 & 3232
			\end{tabular}
			\caption[]{\label{tabSymmetric5OminoTilings}Number of 4-fold symmetric locked 5-omino tilings, up to isomorphism. This sequence appears doubled in OEIS A365862 \cite{MyOEIS}, since each tiling can be mirrored to produce an isomorphic one. The sole tiling of the $20 \times 20$ grid is depicted in Figure \ref{figUniqueTilings20}.}
	\end{center}\end{table}
	
	
	
	%	% Figure environment removed
	
	
	
	
	

	
	Finally, we record several additional facts about the structure of locked tilings that were discovered computationally.
	
	\begin{enumerate}
		\item Any locked 4-omino tiling of a grid where both dimensions are at least 14 must contain all five tile shapes. (It is notable that the $10 \times 10$ tiling from Figure \ref{figUniqueTilings10} does not; it is missing the L tile.)
		\item While we cannot enumerate the asymmetric locked 5-omino tilings of some larger grid sizes due to computational issues, we do know that at least some tilings exist. In particular, Figure \ref{figSpaceInvaders} shows a partial tiling with four holes that can be completed in different ways to produce asymmetric tilings. They can also be completed to yield small metagraph components of size greater than one.
		\item Any tile can be part of a locked 5-omino grid tiling except for the V-tile. It is not too hard to see that any tile placed inside the V-tile will admit a recombination move with it. There are locked tilings that use all of the other tiles (for instance, those in Figure \ref{figSpaceInvaders}).
		\item In any locked 4-, 5-, or 6-omino tiling of a grid where both dimensions are at least 9, only some specific tiles can be placed in the corners. For the top left corner, the tile must be one of the tiles in Figure \ref{figCorners} (or flipped along the main diagonal).
	\end{enumerate}
	
	\ipnc{.16}{SpaceInvaders2}{\label{figSpaceInvaders}A partial tiling of the $40 \times 40$ grid graph. The remaining spaces can each be completed in five different configurations. Two of these configurations are locked and the other three are linked to each other by recombination moves, but can never recombine with any other neighboring tiles. Thus, the tiling can be completed to obtain both symmetric and asymmetric locked tilings, as well as connected components of $\mathcal{M}(G(40, 40), 5)$ of size 3, 9, 27, and 81.}
	
	\ipnc{.16}{Corners}{\label{figCorners}The only $t$-ominoes that can occur in the top-left corner of a locked $t$-omino grid tiling, for $t \in \{4, 5, 6\}$.}
	
	\subsection{Locked 4-Omino Tilings on Arbitrarily Large Grids}
	
	One might conjecture, on the basis of Table \ref{tab456}, that the locked 4-omino tiling from Figure \ref{figUniqueTilings10} is the only locked tiling that exists on any finite grid. Surprisingly, not only do more tilings exist, but they exist for arbitrarily large grid dimensions, starting at $42 \times 42$.
	
	\ipnc{.16}{T42-02.drawio}{\label{fig4OminoLockedInfiniteConstructionSmall}A locked 4-omino tiling on the $42 \times 42$ grid. This is the smallest known locked 4-omino tiling beyond the $10 \times 10$ grid tiling from Figure \ref{figUniqueTilings10}. It is the tiling for $n = 1$ in construction of Theorem \ref{thm4OminoLockedInfiniteConstruction}.}
	
	\begin{theorem}\label{thm4OminoLockedInfiniteConstruction}
		For any positive integer $n$, the square grid of side length $26 + 16n$ has a locked 4-omino tiling.
	\end{theorem}
	
	\begin{proof}
		The construction for $n = 1$, on the $42 \times 42$ grid, is presented in Figure \ref{fig4OminoLockedInfiniteConstructionSmall}, and the construction for $n = 4$ is presented in Figure \ref{fig4OminoLockedInfiniteConstructionBig}. It is self-evident that this construction can extended to arbitrary $n$ by adding additional repetitions of the patterns on the border and the 8 ``spokes'' leading into the center. Each repetition increases the grid dimensions by 8 on each side, for a total grid dimension increase of 16.
	\end{proof}
	
	\ipnc{.075}{T90-02.drawio}{\label{fig4OminoLockedInfiniteConstructionBig}A locked 4-omino tiling on the $ \times 42$ grid. This is the tiling for $n = 4$ in the construction from Theorem \ref{thm4OminoLockedInfiniteConstruction}.}
	
	\section{Infinite Tilings}\label{secTori}
	
	The most difficult part of constructing locked polyomino tilings seems to be making straight borders. In this section, we remove this obstacle by considering infinite grid tilings. Any infinite tiling that is periodic can also be thought of as a tiling of a finite torus graph $T(m, n)$, i.e., the grid graph $G(m, n)$ with additional edges connecting the vertices on the left border of the grid to those on the right border and similarly with the top and bottom vertices. As Figure \ref{figTorusTilings} illustrates, with infinite grids we can construct several different kinds of tilings that are not possible for finite grids.
	
	Surprisingly, we find that it is possible to construct infinite periodic locked $t$-omino tilings for \emph{arbitrarily large} $t$. We can do this in either the square grid lattice, which is the focus of this paper, or the triangular lattice, which serves as an intriguing counterpoint to the connectivity result of Cannon \cite{TriangularLattice}. Both constructions are essentially the same, and we only sketch them here by means of example.
	
	\ipnc{.16}{TorusTetrominoLocked12}{\label{figTorusTilings} Some locked 2-, 3-, and 4-omino tilings on $T(12, 12)$ or the infinite grid. Note that the middle tiling is locked even if we were to allow recombining up to four tiles at a time rather than two. Generalizations of the tiling on the left are still locked with respect to arbitrarily large numbers of tiles being recombined.}
	
	% Figure environment removed
	
	\newpage
	
	\ipnc{.32}{CocreateFinal}{\label{figBigTriangularTorusTiling} Part of a periodic locked 31-omino tiling of the infinite triangular lattice.}
	
	\begin{theorem}\label{thmTorusFamily}
		For any positive integer $n$, the square torus $T(2(2n^2 + 2n + 1), 2(2n^2 + 2n + 1))$ (or infinite square grid lattice) has a locked $(2n^2 + 2n + 1)$-omino tiling, and the infinite triangular lattice has a locked $((n + 1)(n + 2) + 1)$-omino tiling.
	\end{theorem}
	
	\begin{proof}
		The construction is tedious to specify formally, and it is easy to verify that it generalizes to any $n$ from seeing a sufficiently large example, so we will mostly rely on illustrations. For the square lattice, the construction for $n = 1$ is the 5-omino tiling pattern in the center of Figure \ref{figSpaceInvaders}. The Z-tiles in this tiling can be thought of as double spirals, where we start with a straight segment of length 3 and spiral inward on both sides by appending paths of length 1 to the sides in a symmetric way. For general $n$, we extend this double spiral pattern in the natural way: we start with a straight segment of length $2n + 1$ and append symmetric spirals with segments of length $2n - 1, 2n - 3, 2n - 5, \dots, 3, 1$. Figure \ref{figBigTorusTiling} shows the tiling for $n = 4$. Every pair of adjacent tiles touches in the exact same way, so it suffices to verify that they cannot be recombined. This follows from the observation that the lengths of the two long paths trailing off of the region obtained by removing two adjacent tiles sum to $t + 1$, so they cannot be in the same $t$-omino. This forces them to partition up the rest of the region in a unique way. Figure \ref{figBigTriangularTorusTiling} shows the tiling for the triangular lattice (also for $n = 4$). It is straightforward to see that both patterns extend to arbitrary $n$ by making the spirals longer.
	\end{proof}
	
	Finally, we note that the metagraph of 4-omino infinite grid tilings does not merely consist of isolated vertices, but also larger connected components. This is intriguing because it is the only known result of its kind for $t = 4$.
	
	\begin{proposition}
		For any positive integers $m$ and $n$, $\mathcal{M}(T(4m, 5 + 8n), 4)$ has connected components of size $3^m$. Consequently, the metagraph of the infinite grid, $\mathcal{M}(\zz \times \zz, 4)$, has multiple connected components of infinite size.
	\end{proposition}
	
	\ipnc{.16}{TorusComponent}{\label{figTorusComponent}Above, a tiling in a connected component of size 3 in $\mathcal{M}(T(4, 13), 4)$ that can be tiled with itself to produce arbitrarily large connected components in torus metagraphs. Below, four copies are joined together, illustrating how it would extend to an infinite grid.}
	
	\begin{proof}
		Consider the torus tiling in Figure \ref{figTorusComponent}. This can be extended to a tiling of $T(4m, 5 + 8n)$ by placing copies of the blue L-tiles a total of $n$ times on each side, then tiling the whole diagram with itself vertically for a total of $m$ copies. Only the green T-tiles are unlocked. Each pair of T-tiles may be independently re-tiled in 3 different ways (the original T-tiling plus two different Z-tilings), but none of these admit recombination moves with neighboring tiles.
	\end{proof}
	
	\section{Open Problems}\label{secOpenProblems}
	
	The practical success of the ReCom sampling algorithm has spurred renewed interest in the connectivity of polyomino tilings under local moves. We are still quite far from being able to prove Conjecture \ref{cnjGridKEquals3}, and this paper hopes to have shed light on some of the obstructions that any potential proof will need to overcome. We have demonstrated that, even in the tame setting of grid graphs, certain local structures of balanced graph partitions exist which can disconnect the state space of ReCom.
	
	The study of these local structures is quite intriguing on its own, due to the fact that locked polyomino tilings are so difficult to find. Numerous open questions remain, of which the following are particularly interesting.
	
	\begin{enumerate}
		\item Are there locked 5-omino tilings for arbitrarily large grids? Can we construct an infinite family? None of the 3270 tilings enumerated in this paper appear to generalize.
		\item Are there any locked $t$-omino grid tilings, of any finite grid dimensions, for any $t \geq 6$? Is the set of positive integers $t$ with this property bounded?
		\item Can locked $t$-omino tilings exist even if we allow 3-way recombination moves? For infinite grids/tori, the answer is clearly yes, as shown in Figure \ref{figTorusTilings}. For finite grids, however, there are no values of $t$ for which the answer to this question is known. In light of the results of this paper, the most likely candidate is obviously $t = 3$. None of the 50 locked 3-omino tilings on the $6 \times 6$ grid are still locked if we allow 3-way recombination.
		\item Is there some structure to locked 3-omino tilings, and more generally, 3-omino grid metagraphs? As it so happens, 3-omino metagraphs suffer from more connectivity issues than just isolated points. The connected components of $\mathcal{M}(G(6, 6), 3)$ are enumerated in Table \ref{tabComponents}.
		
		\ignct{.29}{NetworkxScreenshot}{\label{figGraphVis} A connected component of $\mathcal{M}(G(6, 6), 3)$ of order 199. Every vertex represents a 3-omino tiling of the $6 \times 6$ grid.}
		
		\begin{table}[H]\begin{center}
				\begin{tabular}{ c|c }
					Number of vertices in component & Number of components\\
					\hline
					73738 & 1\\
					384 & 4\\
					235 & 8\\
					199 & 8\\
					68 & 8\\
					20 & 16\\
					19 & 16\\
					16 & 2\\
					8 & 8\\
					2 & 16\\
					1 & 50\\
				\end{tabular}
				\caption[]{\label{tabComponents}Connected component sizes of $\mathcal{M}(G(6, 6), 3)$.}
		\end{center}\end{table}
		It is not surprising that there are as many as 50 locked tilings (components of size 1) or that most of the vertices lie in one giant component. What \emph{is} surprising is that there are many other large components. Strangest of all is the fact that, for all components of size 68 and above, there is no pair of grid cells that are always together in the same 3-omino throughout the component. In other words, some components do not correspond to local regions of the $6 \times 6$ grid, but rather global invariants that are somehow preserved through recombination moves. Figure \ref{figGraphVis} depicts one of these strange components.
		\item Even when a grid metagraph is disconnected, is it still the case that the vast majority of tilings lie in one connected component?
	\end{enumerate}
	
	
	\tagged{name}{
		\section*{Acknowledgments}
		
		I am deeply grateful to Christopher Donnay for his helpful suggestions, motivations, pointers to existing literature, and technical support. I am also grateful to Parker Rule, Moon Duchin, and Josh Mermelstein for multiple thought-provoking discussions. And also to Peep Mouse Kumar, the kind and fluffy cat that sat on my lap (and sometimes arms) as I wrote the first draft of this paper.
		
		This material is based in part upon work supported by the National Science Foundation under Grant No.\txt{} DMS-1928930 and by the Alfred P.\txt{} Sloan Foundation under grant G-2021-16778, while the author was in residence at the Simons Laufer Mathematical Sciences Institute (formerly MSRI) in Berkeley, California, during the Fall 2023 semester.}
	
	\bibliographystyle{plain}
	\bibliography{bibliography}
\end{document}