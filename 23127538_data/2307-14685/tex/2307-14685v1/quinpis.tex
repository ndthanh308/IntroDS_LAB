\documentclass{article}

% ===================================
% PACCHETTI PER VERSIONI PROVVISORIE
%\usepackage{filemod}
%\usepackage{datetime2}\DTMsetdatestyle{ddmmyy}
%\date{\bf Last edit: \today\ at \DTMcurrenttime}%\FilemodToday{\jobname.tex}}
%\usepackage[textsize=footnotesize,backgroundcolor=yellow!70,bordercolor=orange]{todonotes}
%\newcommand{\completare}[1]{\todo[inline, color=blue!30]{#1}}
%\usepackage[color]{showkeys}
%\definecolor{refkey}{rgb}{.35,.75,0}
%\definecolor{labelkey}{rgb}{.15,.55,0}
%\usepackage{hyperref}

%\usepackage{fancyhdr}
%\pagestyle{fancy}
%\renewcommand*{\thefilemoddate}[3]{#3-#2-#1}
%\renewcommand*{\thefilemodtime}[4]{#1:#2}
%\lhead{\texttt{\jobname.tex}}
%\rhead{\textsf{\filemodprint{\jobname.tex}}} 

% ====================================

\usepackage{graphicx}
\graphicspath{{figures/}}
\DeclareGraphicsExtensions{.png,.pdf}

\usepackage{amsmath,amsfonts,amsthm,amssymb}

\usepackage{tikz,pgfplots,pgfplotstable}
\usetikzlibrary{positioning,calc}
\usetikzlibrary{decorations.pathreplacing,calligraphy}
\usetikzlibrary{shapes.geometric}

\newtheorem{definition}{Definition}
\newtheorem{remark}{Remark}
\newtheorem{notation}{Notation}

\usepackage{multirow}
\usepackage{booktabs}
\usepackage{caption,subcaption}
\usepackage{cite}
\usepackage{nicefrac}

\newcommand{\NumFlux}{\mathcal{F}}
\newcommand{\dx}{\mathrm{d}x}
\renewcommand{\d}{\mathrm{d}}

\newcommand{\R}{\mathbb{R}}

\newcommand{\Popt}{P_{\text{\sf opt}}}
\newcommand{\Poly}[1]{\mathbb{P}^{#1}}
\newcommand{\Sopt}{\mathcal{S}_{\text{\sf opt}}}

\newcommand{\ca}[1]{\overline{#1}}
\newcommand{\DT}{\mathrm{\Delta} t}
\newcommand{\DX}{\mathrm{\Delta} x}
\newcommand{\D}{\mathrm{d}}

\newcommand{\CW}{\mathsf{CWZb}3}
\newcommand{\Q}{\mathsf{Q}3}
\newcommand{\QI}[1]{\mathsf{Q}3_{\scriptscriptstyle{\mathcal{I}#1}}}
\newcommand{\Qexp}{\mathsf{Q}3^{\scriptscriptstyle{\mathsf{CFL}}}}
\newcommand{\QIexp}[1]{\mathsf{Q}3^{\scriptscriptstyle{\mathsf{CFL}}}_{\scriptscriptstyle{\mathcal{I}#1}}}

\newcommand{\TotDer}[2]{\frac{\mathrm{d}{#1}}{\mathrm{d}{#2}}}

\newcommand{\bigvec}[1]{\mathfrak{#1}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Front matter
\title{Quinpi: Integrating stiff hyperbolic systems with implicit high order finite volume schemes}

\author{
	Gabriella Puppo\footnote{Dipartimento di Matematica -- Sapienza, Universit\`{a} di Roma; P.le Aldo Moro, 5 -- 00185 Roma (Italy); gabriella.puppo@uniroma1.it}
	\quad Matteo Semplice\footnote{Dipartimento di Scienza e Alta Tecnologia -- Universit\`{a} dell'Insubria; Via Valleggio, 11 -- 22100 Como (Italy); matteo.semplice@uninsubria.it}
	\quad Giuseppe Visconti\footnote{Dipartimento di Matematica -- Sapienza, Universit\`{a} di Roma; P.le Aldo Moro, 5 -- 00185 Roma (Italy); giuseppe.visconti@uniroma1.it}
	}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\begin{document}

\maketitle

\begin{abstract}
	Many interesting physical problems described by systems of hyperbolic conservation laws are stiff, and thus impose a very small time-step because of the restrictive CFL stability condition. In this case, one can exploit the superior stability properties of implicit time integration which allows to choose the time-step only from accuracy requirements, and thus avoid the use of small time-steps. We discuss an efficient framework to devise high order implicit schemes for stiff hyperbolic systems without tailoring it to a specific problem. The nonlinearity of high order schemes, due to space- and time-limiting procedures which control nonphysical oscillations, makes the implicit time integration difficult, e.g.~because the discrete system is nonlinear also on linear problems. This nonlinearity of the scheme is circumvented as proposed in (Puppo et al., Comm.~Appl.~Math.~\& Comput., 2023) for scalar conservation laws, where a first order implicit predictor is computed to freeze the nonlinear coefficients of the essentially non-oscillatory space reconstruction, and also to achieve limiting in time. In addition, we propose a novel conservative flux-based a-posteriori time-limiting procedure using numerical entropy indicators to detect troubled cells. The numerical tests involve classical and artificially devised stiff problems using the Euler's system of gas-dynamics.
\end{abstract}

\paragraph{Mathematics Subject Classification (2020)} 65M08, 65M20, 35L65, 65L04
\paragraph{Keywords} implicit methods, essentially non-oscillatory schemes, finite volumes, hyperbolic systems, entropy indicators

\input{intro}

\input{scheme}

\input{numerics}

\section{Conclusions and future research} \label{sec:conclusion}

In this work, we have proposed a framework for the high order implicit integration of hyperbolic systems of conservation laws. The approach is based on the recent work~\cite{PSV23:Quinpi}, which was focused on scalar conservation laws.
The crucial idea of Quinpi is to use a first order implicit predictor to freeze the nonlinear space limiters in the CWENO third order reconstruction, because such a predictor gives a pre-estimate of the WENO weights, which will be used by the higher order method. Space limiting however is not enough, and it is necessary to perform limiting in time, based on mixing the computed high order solution and the low order predictor. As a consequence, the nonlinearity of the scheme is linked only to the nonlinearity of the flux, while space and time-limiting need not enter into the nonlinear iterations needed to update the solution.

At a difference from \cite{PSV23:Quinpi}, we have designed a flux-based conservative time-limiting procedure inspired by the MOOD technique, where the numerical entropy residual has been used as indicator of non-smooth solutions and troubled cells. This is more robust than the previous cell-based limiter that required a conservative correction after the time-limiting.

We mention that this implicit approach has not been tailored to the solution of a specific problem. We expect the new scheme to have impact in many applications described by stiff problems, in particular in those cases in which the phenomena of interest travel slower than the fastest speeds.

Future work will involve the study of the Quinpi approach combined with different time integration methods, for instance using hybrid BDF schemes, extensions to higher order, and possibly investigation of analytical properties of the scheme. 
Further attention will also be paid to the optimization of the efficiency of the scheme. To this end, we will investigate ad-hoc linear solvers and preconditioners, especially in view of higher dimensional applications, and the time-limiting procedure. A preliminary analysis on the work-precision shows that the accuracy of the implicit and explicit schemes is similar on the material wave. Whereas, the implicit scheme becomes competitive, and more convenient than the explicit method, when the Courant number $C \gtrsim 12$. We expect to make the computational cost scale more favorably for the implicit approach.

 % \begin{table}[t!]
 %    \caption{Work-precision.\label{tab:wp}}
 %    \begin{subtable}[h]{\textwidth}
	% \caption{Symmetric expansion problem.\label{tab:wp:tworar}}
	% \centering
	% \vspace{0.25cm}
	% \pgfplotstabletypeset[
	% font=\footnotesize,
	% col sep=comma,
	% sci zerofill,
	% empty cells with={--},
	% every head row/.style={before row={\toprule
	% 		&\multicolumn{1}{c}{$\CW$}
	% 		&\multicolumn{1}{c}{$\QI{3}$}
	% 		\\
	% 	},
	% 	after row=\midrule
	% },
	% every last row/.style={after row=\bottomrule},
	% columns/0/.style={column name={$N$}},
	% columns/6/.style={column name={CPU time/$\Delta t$}},
	% columns/2/.style={column name={CPU time/$\Delta t$}},
	% columns/4/.style={column name={ratio}},
	% columns={0,6,2,4},
	% skip rows between index={0}{14},
 %    skip rows between index={19}{25}
	% ]
	% {data/data_tworar/workprecisionTAB.csv}
 %    \end{subtable}
 %    \begin{subtable}[h]{\textwidth}
 %    \vspace{0.25cm}
	% \caption{Colliding flows problem.\label{tab:wp:twoshocks}}
	% \centering
	% \vspace{0.25cm}
	% \pgfplotstabletypeset[
	% font=\footnotesize,
	% col sep=comma,
	% sci zerofill,
	% empty cells with={--},
	% every head row/.style={before row={\toprule
	% 		&\multicolumn{2}{c}{$\CW$}
	% 		&\multicolumn{2}{c}{$\QI{3}$}
	% 		\\
	% 	},
	% 	after row=\midrule
	% },
	% every last row/.style={after row=\bottomrule},
	% columns/0/.style={column name={$N$}},
 %    columns/7/.style={column name={$L^1$ error}},
	% columns/6/.style={column name={CPU time/$\Delta t$}},
 %    columns/3/.style={column name={$L^1$ error}},
	% columns/2/.style={column name={CPU time/$\Delta t$}},
	% columns/4/.style={column name={ratio}},
	% columns={0,7,6,3,2,4},
	% skip rows between index={0}{14},
 %    skip rows between index={19}{25}
	% ]
	% {data/data_twoshocks/workprecisionTAB.csv}
    % \end{subtable}
 %    \begin{subtable}[h]{\textwidth}
 %    \vspace{0.25cm}
	% \caption{Modified Lax's problem.\label{tab:wp:stiffLax}}
	% \centering
	% \vspace{0.25cm}
	% \pgfplotstabletypeset[
	% font=\footnotesize,
	% col sep=comma,
	% sci zerofill,
	% empty cells with={--},
	% every head row/.style={before row={\toprule
	% 		&\multicolumn{1}{c}{$\CW$}
	% 		&\multicolumn{1}{c}{$\QI{3}$}
	% 		\\
	% 	},
	% 	after row=\midrule
	% },
	% every last row/.style={after row=\bottomrule},
	% columns/0/.style={column name={$N$}},
	% columns/6/.style={column name={CPU time/$\Delta t$}},
	% columns/2/.style={column name={CPU time/$\Delta t$}},
	% columns/4/.style={column name={ratio}},
	% columns={0,6,2,4},
	% skip rows between index={0}{14},
 %    skip rows between index={19}{25}
	% ]
	% {data/data_lax_stiff/workprecisionTAB.csv}
 %    \end{subtable}
% \end{table}

\paragraph{Acknowledgments} This work was partly supported by MUR (Ministry of University and Research) under the PRIN-2017 project on ``Innovative Numerical Methods for Evolutionary Partial Differential Equations and Applications'' (number 2017KKJP4X).

This work was carried out within the Ateneo Sapienza projects 2019 ``Metodi numerici per problemi evolutivi, networks ed applicazioni'', 2020 ``Algoritmi e modelli per sistemi di natura iperbolica, networks e applicazioni'', 2021 ``Evolutionary problems: analysis techniques and construction of numerical solutions'', 2022 ``Approssimazione numerica di modelli differenziali e applicazioni''.

GP and GV acknowledge support from PNRR-MUR project ``Italian Research Center on High Performance Computing, Big Data and Quantum Computing'' and from PNRR-MUR project PE0000013-FAIR. 

The authors are members of the INdAM Research National Group of Scientific Computing (INdAM-GNCS).

No conflict of interest is extant in the present work.

\bibliographystyle{plain}
\bibliography{Quinpi}

\end{document}