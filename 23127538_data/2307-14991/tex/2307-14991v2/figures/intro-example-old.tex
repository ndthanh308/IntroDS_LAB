
\newsavebox\boxCsMethod
\begin{lrbox}{\boxCsMethod}
  \begin{lstlisting}[language=java-pretty]
    [NUnit.Framework.Test] 
    public virtual void Equality() {
      Tag p1 = Tag.ValueOf("p");
      Tag p2 = Tag.ValueOf("p");
      NUnit.Framework.Assert.(-W<)IsTrue(p1.Equals(p2))(>W-);
      NUnit.Framework.Assert.(-W<)IsTrue(p1 == p2)(>W-);
    }

    [NUnit.Framework.Test] 
    public virtual void Equality() {
      Tag p1 = Tag.ValueOf("p");
      Tag p2 = Tag.ValueOf("p");
      NUnit.Framework.Assert.(+W<)AreEqual(p1, p2)(>W+);
      NUnit.Framework.Assert.(+W<)AreSame(p1, p2)(>W+);
    }
  \end{lstlisting}
\end{lrbox}

\newsavebox\boxJavaMethod
\begin{lrbox}{\boxJavaMethod}
  \begin{lstlisting}[language=java-pretty]
    @Test 
    public void equality() {
      Tag p1 = Tag.valueOf("p");
      Tag p2 = Tag.valueOf("p");
      (-W<)assertTrue(p1.equals(p2))(>W-);
      (-W<)assertTrue(p1 == p2)(>W-);
    }

    @Test 
    public void equality() {
      Tag p1 = Tag.valueOf("p");
      Tag p2 = Tag.valueOf("p");
      (+W<)assertEquals(p1, p2)(>W+);
      (+W<)assertSame(p1, p2)(>W+);
    }
  \end{lstlisting}
\end{lrbox}


\begin{tikzpicture}[
    line width=0.4pt,
    node distance=0ex and 0em,
    every node/.style={scale=1},
    gridBox/.style={rectangle, opacity=0, draw=red},
    box/.style={rectangle, draw=black, inner sep=2pt, font=\small},
    rounded box/.style={rectangle, rounded corners, draw=black, inner sep=2pt, font=\small},
    anno/.style={font=\footnotesize},
]

    \DefMacro{wCodeBox}{25em}
    \DefMacro{hCodeBox}{32ex}
    
    \node (g-Old) at (0,0) [box, minimum width=\UseMacro{wCodeBox}, minimum height=\UseMacro{hCodeBox}] {};
    \node (b-Old) [right = -0.3 of g-Old.west] [] {\usebox\boxJavaMethod};
    \node (b-OldText) [below left = 1pt and 1pt of g-Old.north east] [box, draw=red!50, fill=red!20, scale=0.8] {\bf Java Old\phantom{p\hskip -.6em}};
    \node (b-OldText) [below left = 60pt and 1pt of g-Old.north east] [box, draw=green!50, fill=green!20, scale=0.8] {\bf Java New\phantom{p\hskip -.6em}};
    \node (g-New) [below = 0 of g-Old.south] [box, minimum width=\UseMacro{wCodeBox}, minimum height=\UseMacro{hCodeBox}] {};
    \node (b-New) [right = -0.3 of g-New.west] [] {\usebox\boxCsMethod};
    \node (b-NewText) [below left = 1pt and 1pt of g-New.north east] [box, draw=red!50, fill=red!20, scale=0.8] {\bf C\# Old};
    \node (b-NewText) [below left = 60pt and 1pt of g-New.north east] [box, draw=green!50, fill=green!20, scale=0.8] {\bf C\# New\phantom{p\hskip -.6em}};
    
\end{tikzpicture}