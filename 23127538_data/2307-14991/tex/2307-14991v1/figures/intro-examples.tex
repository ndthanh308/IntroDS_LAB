
\newsavebox\boxJavaExample
\begin{lrbox}{\boxJavaExample}
  \begin{lstlisting}[language=java-pretty, numbers=left]
      @Test
      public void docWithInvalidMapping02() throws IOException {
        ...
        customRolePara.getAccessibilityProperties().setRole(HtmlRoles.p);
        Exception e = Assert.assertThrows(PdfException.class,()->document.add(customRolePara));
       - Assert.assertEquals(MessageFormat.format((-w<)PdfException(>w-).ROLE_IS_NOT_MAPPED_TO_ANY_STANDARD_ROLE, "p"), e.getMessage());
       + Assert.assertEquals(MessageFormat.format((+w<)LayoutExceptionMessageConstant(>w+).ROLE_IS_NOT_MAPPED_TO_ANY_STANDARD_ROLE, "p"), e.getMessage());
      }
  \end{lstlisting}
\end{lrbox}


\newsavebox\boxGenerationExample
\begin{lrbox}{\boxGenerationExample}
  \begin{lstlisting}[language=java-pretty, numbers=left]
      [NUnit.Framework.Test] 
      public virtual void DocWithInvalidMapping02() {
        ...
        - customRolePara.GetAccessibilityProperties().SetRole((-w<)LayoutTaggingPdf2Test(>w-).HtmlRoles.p);
        + customRolePara.GetAccessibilityProperties().SetRole(HtmlRoles.p);
        - Exception e = NUnit.Framework.Assert.(-w<)Catch(>w-)(typeof(PdfException),()=>document.Add(customRolePara));
        + Exception e = NUnit.Framework.Assert.(+w<)IsThrows(>w+)(PdfException.class,()=>document.Add(customRolePara));
        - NUnit.Framework.Assert.AreEqual(String.Format((-w<)PdfException(>w-).ROLE_IS_NOT_MAPPED_TO_ANY_STANDARD_ROLE, "p"), e.Message);
        + NUnit.Framework.Assert.AreEqual(String.Format((+w<)LayoutExceptionMessageConstant(>w+).ROLE_IS_NOT_MAPPED_TO_ANY_STANDARD_ROLE, "p"), e.Message);
      }
  \end{lstlisting}
\end{lrbox}

\newsavebox\boxCsOurExample
\begin{lrbox}{\boxCsOurExample}
  \begin{lstlisting}[language=java-pretty, numbers=left]
      [NUnit.Framework.Test] 
      public virtual void DocWithInvalidMapping02() {
        ...
        customRolePara.GetAccessibilityProperties().SetRole(LayoutTaggingPdf2Test.HtmlRoles.p);
        Exception e = NUnit.Framework.Assert.Catch(typeof(PdfException),()=>document.Add(customRolePara));
        - NUnit.Framework.Assert.AreEqual(String.Format((-w<)PdfException(>w-).ROLE_IS_NOT_MAPPED_TO_ANY_STANDARD_ROLE, "p"), e.Message);
        + NUnit.Framework.Assert.AreEqual(String.Format((+w<)LayoutExceptionMessageConstant(>w+).ROLE_IS_NOT_MAPPED_TO_ANY_STANDARD_ROLE, "p"), e.Message);
      }
  \end{lstlisting}
\end{lrbox}

% \newsavebox\boxDeleteCode
% \begin{lrbox}


\newsavebox\boxJavaAdd
\begin{lrbox}{\boxJavaAdd}
  \begin{lstlisting}[language=java-pretty]
    
  \end{lstlisting}
\end{lrbox}


\begin{tikzpicture}[
    line width=0.4pt,
    node distance=0ex and 0em,
    every node/.style={scale=1},
    gridBox/.style={rectangle, opacity=0, draw=red},
    box/.style={rectangle, draw=black, inner sep=2pt, font=\small},
    rounded box/.style={rectangle, rounded corners, draw=black, inner sep=2pt, font=\small},
    anno/.style={font=\footnotesize},
]

    \DefMacro{wCodeBox}{26.4em}
    \DefMacro{hJavaCodeBox}{25ex}
    \DefMacro{hGenerationCodeBox}{35ex}
    \DefMacro{hOurCodeBox}{29ex}

    \DefMacro{diff-box-w}{26.2em}
    
    \node (box-java) at (0,0) [box, minimum width=\UseMacro{wCodeBox}, minimum height=\UseMacro{hJavaCodeBox}] {};
    \node (java-del) [below right = 13.5ex and .1em of box-java.north west] [box, minimum width=\UseMacro{diff-box-w}, minimum height=4ex, draw=none, fill=\UseMacro{git-del-color}, ] {};
    \node (java-add) [below right = 17.5ex and .1em of box-java.north west] [box, minimum width=\UseMacro{diff-box-w}, minimum height=4ex, draw=none, fill=green!20, ] {};
    \node (b-java) [below right = 0 and -1em of box-java.north west] [] {\usebox\boxJavaExample};
    \node (b-java-text) [above left = .5ex and .1em of box-java.south east] [box, scale=0.8] {\bf Java Change Made by Developers\phantom{p\hskip -.6em}};

    \node (box-generation) [below = 0 of box-java.south] [box, minimum width=\UseMacro{wCodeBox}, minimum height=\UseMacro{hGenerationCodeBox}] {};
    \node (gen-del-0) [below right = 7.5ex and .1em of box-generation.north west] [box, minimum width=\UseMacro{diff-box-w}, minimum height=4ex, draw=none, fill=\UseMacro{git-del-color}, ] {};
    \node (gen-add-0) [below right = 11.5ex and .1em of box-generation.north west] [box, minimum width=\UseMacro{diff-box-w}, minimum height=2ex, draw=none, fill=green!20, ] {};
    \node (gen-del-1) [below right = 13.75ex and .1em of box-generation.north west] [box, minimum width=\UseMacro{diff-box-w}, minimum height=4ex, draw=none, fill=\UseMacro{git-del-color}, ] {};
    \node (gen-add-1) [below right = 17.75ex and .1em of box-generation.north west] [box, minimum width=\UseMacro{diff-box-w}, minimum height=4ex, draw=none, fill=green!20, ] {};
    \node (gen-del-2) [below right = 22ex and .1em of box-generation.north west] [box, minimum width=\UseMacro{diff-box-w}, minimum height=4ex, draw=none, fill=\UseMacro{git-del-color}, ] {};
    \node (gen-add-2) [below right = 26ex and .1em of box-generation.north west] [box, minimum width=\UseMacro{diff-box-w}, minimum height=6ex, draw=none, fill=green!20, ] {};
    \node (generation) [below right = 0 and -1em of box-generation.north west] [] {\usebox\boxGenerationExample};
    \node (b-generation-text) [above left = .5ex and .1em of box-generation.south east] [box, draw,  scale=0.8] {\bf \Cs Change Predicted by Existing Generation-based Model \ \textcolor{red!80!black}{\mycross}\phantom{p\hskip -.6em}};

    \node (box-our) [below = 0 of box-generation.south] [box, minimum width=\UseMacro{wCodeBox}, minimum height=\UseMacro{hOurCodeBox}] {};
    \node (our-del) [below right = 15.75ex and .1em of box-our.north west] [box, minimum width=\UseMacro{diff-box-w}, minimum height=4ex, draw=none, fill=\UseMacro{git-del-color}, ] {};
    \node (our-add) [below right = 19.75ex and .1em of box-our.north west] [box, minimum width=\UseMacro{diff-box-w}, minimum height=6ex, draw=none, fill=green!20, ] {};
    \node (our) [below right = 0 and -1em of box-our.north west] [] {\usebox\boxCsOurExample};
    \node (b-our-text) [above left = .5ex and .1em of box-our.south east] [box, draw,  scale=0.8] {\bf \Cs Change Made by Developers and Predicted by Our \DeltaTool{} \ \textcolor{green!80!black}{\mycheckmark}\phantom{p\hskip -.6em}};
    
\end{tikzpicture}