\definecolor{babyblueeyes}{rgb}{0.63, 0.79, 0.95}
\definecolor{bubbles}{rgb}{0.91, 1.0, 1.0}
\definecolor{lavenderblue}{rgb}{0.8, 0.8, 1.0}
\definecolor{gray(x11gray)}{rgb}{0.75, 0.75, 0.75}
\definecolor{cobalt}{rgb}{0.0, 0.28, 0.67}
\definecolor{navyblue}{rgb}{0.0, 0.0, 0.5}
\definecolor{orange(colorwheel)}{rgb}{1.0, 0.5, 0.0}
\definecolor{lightgray}{rgb}{0.83, 0.83, 0.83}

\begin{tikzpicture}[
    node distance = 5cm,
    every node/.style={scale=1},
    roundnode/.style={circle, draw, thin, minimum size=1em},
]


\tikzset{XOR/.style={draw,circle,append after command={
        [shorten >=\pgflinewidth, shorten <=\pgflinewidth,]
        (\tikzlastnode.north) edge (\tikzlastnode.south)
        (\tikzlastnode.east) edge (\tikzlastnode.west)
        }
    }
}

\tikzset{
    pre/.style={=stealth',semithick},
    post/.style={->,shorten >=1pt,>=stealth',semithick}
}

% edits node
\node [block, minimum width=3.3cm, minimum height=0.8cm, text width=3.3cm, text height=0.2cm, thin, draw, fill=lavenderblue!50, font=\ttfamily, align=left] at (0,0) (javaEdits) {\scriptsize \texttt{<ReplaceOldKeepBefore> format(PdfException <ReplaceNewKeepBefore> format( LayoutExceptionMessageConstant <ReplaceEnd>}};
\node [text_box, left = -2ex of javaEdits, text width=4em] (input1) {\footnotesize \UseMacro{java_edits}};

% old code node
\node [block, minimum width=3.3cm, minimum height=0.8cm, text width=3.3cm, text height=0.1cm,thin, draw, fill=bubbles, font=\ttfamily, align=left] at (0,-1.7) (csharpOld) {\scriptsize \texttt{...\\String.Format(PdfException...}};
\node [text_box, left = -1.5ex of csharpOld, text width=4em] (input2) {\footnotesize \UseMacro{cs_old}};

% new code node
\node [block, minimum width=3.3cm, minimum height=0.8cm, text width=3.3cm,text height=0.2cm,thin, draw, fill=babyblueeyes, font=\ttfamily, align=left] at (0,-3) (javaNew) {\scriptsize \texttt {...\\MessageFormat.format(\\LayoutExceptionMessageConstant..}};
\node [text_box, left = -1.5ex of javaNew, text width=4em] (input3) {\footnotesize \UseMacro{java_new}};

\node (concat) [XOR, scale=1.2] at (2.5,-1.7) {};
% % model node
% \node [block] at (4.5,-1.7) (model) {\small \DeltaTool};

\node [block, minimum width=7.5cm, minimum height=3cm, dashed, very thick, draw=navyblue, fill=blue!5!white] at (6.95, 0) (editTranslation) {};
\node [text_box, below right = .5ex and .5em of editTranslation.north west, align=left] {\edittranslation};
\node [block, minimum width=7.5cm, minimum height=3cm, dashed, very thick, draw=orange(colorwheel), fill=yellow!5!white] at (6.95, -3.2) (metaEdits) {};
\node [text_box, above right = .5ex and .5em of metaEdits.south west, align=left] {\metaEdits};

\node [block, draw, thin, fill=lightgray,minimum width=3.3cm, text width=3.3cm, text height=0.2cm, font=\ttfamily, align=left] at (6.75,-0.2) (csharpEdits1) {\scriptsize \texttt{<ReplaceOldKeepBefore> Format(PdfException <ReplaceNewKeepBefore> Format( LayoutExceptionMessageConstant <ReplaceEnd>}};
\node [text_box, above = 0.5ex of csharpEdits1, text width=4em] (l-csharpEdits1) {\footnotesize \UseMacro{cs_edits}};

\node [block, draw, thin, fill=lightgray,minimum width=2.2cm, text width=2.2cm, text height=0.2cm, font=\ttfamily, align=left] at (5,-3.2) (metaEdits) {\scriptsize \texttt{<ReplaceOld> format <ReplaceNew> Format <ReplaceEnd>}};
\node [text_box, above = 0.5ex of metaEdits, text width=12em] (l-metaEdits) {\footnotesize meta edit sequence};

\node [block, draw, thin, fill=lightgray,minimum width=3.3cm, text width=3.3cm, text height=0.2cm, font=\ttfamily, align=left] at (8.5,-3.2) (csharpEdits2) {\scriptsize \texttt{<ReplaceOldKeepBefore> Format(PdfException <ReplaceNewKeepBefore> Format( LayoutExceptionMessageConstant <ReplaceEnd>}};
\node [text_box, above = 0.5ex of csharpEdits2, text width=4em] (l-csharpEdits2) {\footnotesize \UseMacro{cs_edits}};

\node [block, thin, draw, fill=lightgray, minimum width=3.3cm, text width=3.3cm, text height=0.2cm,font=\ttfamily, align=left] at (13,-1.7) (csharpNew) {\scriptsize \texttt{...\\String.Format(\\LayoutExceptionMessageConstant..}};
\node [text_box, above = 0.5ex of csharpNew, text width=4em] (l-csharpNew) {\footnotesize \UseMacro{cs_new}};

% \draw[->, rounded corners] ([yshift=.3mm]javaEdits.east) -- +(1mm, 0) -- ([yshift=.3mm]model.west);
\draw [post, rounded corners=5pt] (javaEdits.east) -| (concat.north);
% \path [line] (javaEdits.east) -- (concat.north);
\path [line, semithick] (csharpOld.east) -- (concat.west);
\draw [post, rounded corners=5pt] (javaNew.east) -| (concat.south);
% \path [line] (javaNew.east) -- (concat.south);

\node [coordinate, right = 1em of concat.east] (c-split) {};
\draw [post, rounded corners=5pt] (concat.east) -- (c-split) |- (csharpEdits1.west);
\draw [post, rounded corners=5pt] (concat.east) -- (c-split) |- (metaEdits.west);
\draw [post, rounded corners=5pt] (metaEdits.east) -- (csharpEdits2.west);

\node [coordinate, left = 1em of csharpNew.west] (c-merge) {};
\draw [post, rounded corners=5pt] (csharpEdits1.east) -| (c-merge) -- (csharpNew.west);
\draw [post, rounded corners=5pt] (csharpEdits2.east) -| (c-merge) -- (csharpNew.west);

% \path [line, semithick] (concat.east) -- (c-split);
% \path [line, semithick] (model.east) -- (csharpEdits1.west);
% \path [line, semithick] (csharpEdits1.east) -- (csharpNew.west);
% \path [line, semithick] (model.east) -- (csharpEdits2.west);
% \path [line, semithick] (csharpEdits2.east) -- (csharpNew.west);


\end{tikzpicture}
