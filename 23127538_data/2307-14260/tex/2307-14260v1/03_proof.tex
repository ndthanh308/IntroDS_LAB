\section{Determining $\ed_{\Forb(C_h^t)}(p)$}\label{sec:proof}

In this section we aim to determine $\ed_{\Forb(C_h^t)}(p)$. Recall that Berikkyzy, Martin and Peck \cite{berikkyzy2019edit} determined this for all $p$ in the case when $(t+1) \nmid h$ and for $p \in [1/\ceil{h/(2t+1)}, 1]$ in the case when $(t+1) \mid h$. Therefore, we will be focusing on determining this function for $0 \leq p \leq 1/\ceil{h/(2t+1)}$ in the case when $(t+1) \mid h$.

For the remainder of this section, we let $\cH= \Forb(C_h^t)$, for integers $h$ and $t$.

\subsection{Preliminaries}

We begin by stating the value of $\gamma_\cH(p)$, which was determined by Berikkyzy, Martin and Peck \cite{berikkyzy2019edit}. 

\begin{lemma}[Berikkyzy, Martin and Peck \cite{berikkyzy2019edit}]\label{plem:gamma_function_general}
Let $t \geq 1$ and $h \geq \max\{t(t+1), 4\}$ be integers. Then for all $p \in [0,1]$, the following holds.
\begin{enumerate}
    \item\label{item:gamma_function_general_1} If $(t+1) \not| \,\, h$, then
        \[
            \gamma_\cH(p) = \min_{r \in \{0, 1, \dots, t\}} \lcb \min \lcb \frac{p}{t+1}, \frac{p(1-p)}{r(1-p)+\lb \ceil{\frac{h}{t+r+1}} -1 \rb p} \rcb \rcb.
        \]
    \item\label{item:gamma_function_general_2} If $(t+1) \mid h$ then 
        \[
            \gamma_\cH(p) = \min_{r \in \{0, 1, \dots, t\}} \lcb \frac{p(1-p)}{r(1-p)+\lb \ceil{\frac{h}{t+r+1}} -1 \rb p} \rcb.
        \]
\end{enumerate}
\end{lemma}
%
% Figure environment removed

In \cref{fig:Gamma_Forb_C_h}, we see the structures which correspond to $\Gamma^*(\Forb(C_h))$ and by applying \cref{lemma:calulate_g_of_K_r_s}, we obtain the values of $g_K(p)$ for each of these CRGs $K$. This gives $\gamma_{\Forb(C_h)}(p)$, which is exactly equal to the right hand side of \cref{plem:gamma_function_general} in the case $t=1$. Observe that these are exactly the bounds given by the strategies in \cref{sec:introduction}, and in particular, the strategies in \cref{sec:introduction} correspond exactly to $\Gamma(\Forb(C_h))$. We recall the notion of a candidate CRG as in \cref{def:candidate_CRG}, that is, consider a CRG $K \in \K(\cH)$ such that $g_K(p) < \gamma_\cH(p)$ for some $p$. By \cref{pthm:berikkyzy_powers_of_cycles}, we know that in order for such a CRG to exist, we must have $(t+1) \mid h$ and $p \leq 1/\ceil{h/(2t+1)}$. We will determine some characteristics for such a candidate CRG.

By taking sub-CRGs, we may assume that $K$ is $p$-core. Thus, in particular by \cref{thm:characterisation_of_p_core_crgs}, in the case when $p \leq 1/\ceil{h/(2t+1)}$, we may assume that all edges of $K$ are grey or white, and that there are no white edges incident to white vertices. Here, we are assuming that $1/\ceil{h/(2t+1)} \leq 1/2$, which is true provided that 
\[h \geq 2(2t+1).\] 
So, in particular, we have this lower bound on $h$ throughout. Recall that $\VW$ is the set of white vertices of $K$, and $\VB$ is the set of black vertices of $K$. Let $K_B = K[\VB]$. The following lemma gives some structural conditions on $K$.

\begin{lemma}[Berikkyzy, Martin and Peck \cite{berikkyzy2019edit}]\label{lem:forbidden_cycles}
Let $p \in (0, 1/2]$\ and let $t \geq 1$ and $h \geq 2t+2$ be integers. Let $K \in \K(\cH)$ be $p$-core with $r$ white vertices.
\begin{enumerate}
    \item\label{item:lem_forbidden_cycles_1} If $r \in \{ 0, \dots, t-1 \}$ and $h \geq t(t-1)$, then $K_B$ contains no grey cycle of length in $\lcb \ceil{\frac{h}{t+r+1}}, \dots, \floor{\frac{h}{t}} \rcb$.
    \item\label{item:lem_forbidden_cycles_2} If $r = t$, then $\size{V(K_B)} \leq \ceil{\frac{h}{2t+1}}-1$.
    \item\label{item:lem_forbidden_cycles_3} If $r \geq t+1$, then $(t+1) \nmid h$ and $V(K_B)= \emptyset$.
\end{enumerate}
\end{lemma}



We will determine further characteristics of such a candidate CRG in the case that $(t+1) \mid h$ and $p < 1/\ceil{h/(2t+1)}$, with the aim of finding a contradiction and thus disproving its existence. We begin by determining the value of $\gamma_\cH(p)$ for small $p$.
%
\begin{lemma}\label{plem:gamma_function_for_small_p}
Let $t \geq 1$ and $h \geq t(2t+1)$ be integers with $(t+1) \mid h$. Then for $p \leq 1/\ceil{h/(2t+1)}$, we have
\[
    \gamma_\cH(p) = \frac{p(1-p)}{t(1-p) + \lb \ceil{\dfrac{h}{2t+1}}-1 \rb p}.
\]
\end{lemma}
%
\begin{proof}
We would like to show that if $p \leq 1/\ceil{h/(2t+1)}$ then for every $r \in \{ 0, \dots, t-1 \}$ we have
\[
    \frac{p(1-p)}{r(1-p) + \lb \ceil{\frac{h}{t+r+1}}-1 \rb p} \geq \frac{p(1-p)}{t(1-p) + \lb \ceil{\frac{h}{2t+1}}-1 \rb p},
\]
that is, the minimum in \cref{plem:gamma_function_general}~\ref{item:gamma_function_general_2} is attained when $r = t$. By rearranging, we get that the inequality above is equivalent to showing that
\begin{equation}\label{eq:showing_minimised_at_ub_on_p}
    t-r + \lb \ceil{\frac{h}{2t+1}}- \ceil{\frac{h}{t+r+1}} - t + r \rb p \geq 0.
\end{equation}
Next, note that\begin{align*}
     \ceil{\frac{h}{2t+1}}- \ceil{\frac{h}{t+r+1}} - t + r &\leq \frac{h}{2t+1} +1 -\frac{h}{t+r+1} -t+r \\&= \frac{-h(t-r)}{(2t+1)(t+r+1)} -(t-r-1) < 0.
\end{align*}
Therefore, the left hand side of \eqref{eq:showing_minimised_at_ub_on_p} is a decreasing function of $p$, so is minimised at the upper bound on $p$, that is, when $p = 1/\ceil{h/(2t+1)}$. Combined with the fact that $r \leq t-1$ and by applying the crude upper and lower bounds on the ceiling function, we have
\begin{align}
    &t-r + \lb \ceil{\frac{h}{2t+1}}- \ceil{\frac{h}{t+r+1}} - t + r \rb p \geq t - r + 1 - \frac{\ceil{\frac{h}{t+r+1}}}{\ceil{\frac{h}{2t+1}}} - \frac{t-r}{\ceil{\frac{h}{2t+1}}} \nonumber\\
    % \geq \, &t - r + 1 - \frac{\frac{h}{t+r+1}+1}{\frac{h}{2t+1}} - \frac{t-r}{\frac{h}{2t+1}}\\
    \geq \, &t - r + 1 - \frac{h(2t+1)-(2t+1)(t+r+1)(t-r-1)}{h(t+r+1)} \label{eq:want_to_be_positive}
    %\geq \, &t - r + 1 - \frac{h(t+r+1)}{h(t+r+1)} - \frac{h(t-r) + (2t+1)(t+r+1) + (t-r)(2t+1)(t+r+1)}{h(t+r+1)}
\end{align}
%We require \eqref{eq:want_to_be_positive} to be at least 0 in order for \eqref{eq:showing_minimised_at_ub_on_p} to hold. 
Observe now that
\begin{align*}
     \frac{h}{2t+1} \geq t \geq \frac{(2t+1)(t-1)}{2t-1} \geq \frac{(t+r+1)(t-r-1)}{(t+r)(t-r)}
\end{align*}
where the first inequality holds by our assumption on $h$, the second by a straightforward manipulation, and the third since $r \in \{0,1,\dots, t-1\}$. By rearranging, we find that the right hand side of~\eqref{eq:want_to_be_positive} is non-negative, and therefore that~\eqref{eq:showing_minimised_at_ub_on_p} holds, as required. 
%In other words, by rearranging \eqref{eq:want_to_be_positive}, we show that we require
%\begin{align}
%h \geq \frac{(t+r+1)(t-r-1)(2t+1)}{(t+r)(t-r)}
%\end{align}
%Note that since $0 \leq r \leq t-1$, 
%\begin{align*}
%    \frac{(t+r+1)(t-r-1)(2t+1)}{(t+r)(t-r)} \leq \frac{(2t+1)^2(t-1)}{2t-1}.
%\end{align*}
%On the other hand, {$h \geq t(2t+1)$} and therefore, since
%\begin{align*}
%    t(2t+1)-\frac{(2t+1)^2(t-1)}{2t-1} &= \frac{(2t^2+t)(2t-1)-(2t+1)^2(t-1)}{2t-1}\\
%    &=\frac{4t^3+2t^2-2t^2 -t-(4t^3+4t^2+t-4t^2-4t-1)}{2t-1} = \frac{2t+1}{2t-1} > 0,
%\end{align*}
% whenever $t\geq 1$. Therefore, whenever {$h \geq t(2t+1)$}, \eqref{eq:want_to_be_positive} is at least $0$, and therefore, \eqref{eq:showing_minimised_at_ub_on_p} holds, and thus the lemma holds.  
\end{proof}
%
Recall that for each pair of vertices $v, w \in V(K)$, $\boldx(v)$ is the weight assigned to the vertex $v$ by optimal vector $\boldx$ found by the quadratic program $g_K(p)$, $d_G(v)$ is the sum of the weights of all vertices incident to $v$ via a grey edge, and
$\text{deg}_G(v)$ is the number of vertices adjacent to $V$ via a grey edge. We define $d_G^W(v)$ be the sum of the weights of white vertices adjacent to $v$ via a grey edge, and let $d_G^B(v)$ be the analogous quantity for black vertices. Additionally, let $\text{deg}_G^B(v)$ be the number of black vertices adjacent to $v$ via a grey edge. We further define $d_G(v,w)$ to be the weight of the common grey neighbourhood of $v$ and $w$, and extend the definitions given above to common neighbourhoods.  Recall also that for a set of vertices $S$, $\boldx(S)$ is the sum of weights of vertices in that set. In the following proposition, we state some important properties which the vertices of a candidate CRG $K$ must satisfy. 
%
\begin{proposition}\label{pprop:black_vertex_properties}Let $t \geq 1$ and $h \geq t(2t+1)$ be integers with $(t+1) \mid h$. Let $K$ be a $p$-core candidate CRG, for $p \leq 1/\ceil{h/(2t+1)}$ with $g_K(p) = \gamma_\cH(p)- \eps$ for some $\eps >0$. Suppose that $K$ has $r$ white vertices, for $r \in \{ 0, \dots, t-1\}$. Then for every $v\in \VB(K)$ the following statements hold.
\begin{enumerate}
    \item\label{pitem:black_vertex_properties_overall_weighted_degree} $d_G(v) = \dfrac{t-1+\lb \ceil{\frac{h}{2t+1}}-t \rb p}{t+ \lb \ceil{\frac{h}{2t+1}}-t-1 \rb p} + \dfrac{\eps}{p} +\dfrac{1-2p}{p}\boldx(v)$.
    \item\label{pitem:black_vertex_properties_black_weighted_degree} $d_G^B(v) = \dfrac{t-r-1 + \lb \ceil{\frac{h}{2t+1}}-t+r \rb p}{t+ \lb \ceil{\frac{h}{2t+1}}-t-1 \rb p} + \dfrac{(r+1)\eps}{p} + \dfrac{1-2p}{p}\boldx(v)$.
    \item\label{pitem:black_vertex_properties_weight} $\boldx(v) \leq \dfrac{p}{t + \lb \ceil{ \frac{h}{2t+1}} - t - 1 \rb p  } - \dfrac{\eps}{1-p}$.
    \item\label{pitem:black_vertex_properties_black_unweighted_degree} $\deg_G^B(v) > \lb \ceil{\frac{h}{2t+1}} -1 \rb \lb t-r \rb$.
    % \item\label{pitem:black_pair_common_neighbourhood} $\deg_G^B(v,w) \geq \ceil{\dfrac{t-r-2 -rp}{p}}$
\end{enumerate}
\end{proposition}

\begin{proof}
Let $v \in \VB(K)$. To prove \ref{pitem:black_vertex_properties_overall_weighted_degree}, we apply \cref{lem:symmetrisation} to get that
\begin{align*}
    d_G(v) &= \frac{p-g_K(p)}{p} + \frac{1-2p}{p}\boldx(v) = 1 - \frac{\gamma_\cH(p)-\eps}{p} + \frac{1-2p}{p}\boldx(v)\\
        &= 1 - \frac{1-p}{t+ \lb \ceil{\frac{h}{2t+1}}-t-1 \rb p} + \frac{\eps}{p} +\frac{1-2p}{p}\boldx(v)= \frac{t-1+\lb \ceil{\frac{h}{2t+1}}-t \rb p}{t+ \lb \ceil{\frac{h}{2t+1}}-t-1 \rb p} + \frac{\eps}{p} +\frac{1-2p}{p}\boldx(v).
\end{align*}
Here, the third equality holds by applying \cref{plem:gamma_function_for_small_p}, since {$h \geq t(2t+1)$} and $p \leq 1/\ceil{h/(2t+1)}$.

To prove \ref{pitem:black_vertex_properties_black_weighted_degree}, we note that since $K$ is $p$-core for $p \leq 1/2$, every edge incident to a white vertex in $K$ is grey by \cref{thm:characterisation_of_p_core_crgs}. Furthermore, by \cref{lem:symmetrisation}, for each white vertex $u \in \VW(K)$, we have
\begin{equation}\label{eq:weight_of_white_vertex}
\boldx(u) = \frac{g_K(p)}{p} = \frac{1-p}{t+ \lb \ceil{\frac{h}{2t+1}}-t-1 \rb p} - \frac{\eps}{p}.
\end{equation}
Here again the second equality holds by an application of \cref{plem:gamma_function_for_small_p}. Then $d_G^B(v) = d_G(v) - d_G^W(v)=d_G(v) - \boldx(\VW)$, and we obtain the result by observing that $\boldx(\VW)$ is $r$ times the bound given in \eqref{eq:weight_of_white_vertex}, and subtracting this from the bound on $d_G(v)$ given in \ref{pitem:black_vertex_properties_overall_weighted_degree}.

To prove \ref{pitem:black_vertex_properties_weight}, we note that $\boldx(\VB) \geq \boldx(v) + d_G^B(v)$. On the other hand, we also have $\boldx(\VB) = 1 - \boldx(\VW)$. Thus, combining these gives
\begin{align*}
    \boldx(v) \leq \,\, &1 - \boldx(\VW) - d_G^B(v)\\
        =\,\, &1 - \frac{r(1-p)}{t+ \lb \ceil{\frac{h}{2t+1}}-t-1 \rb p}+\frac{r\eps}{p} - \frac{t-r-1 + \lb \ceil{\frac{h}{2t+1}}-t+r \rb p}{t+ \lb \ceil{\frac{h}{2t+1}}-t-1 \rb p} - \frac{(r+1)\eps}{p} - \frac{1-2p}{p} \boldx(v)\\
        =\,\, &\frac{1-p}{t+ \lb \ceil{\frac{h}{2t+1}}-t-1 \rb p} - \frac{\eps}{p} - \frac{1-2p}{p} \boldx(v).
\end{align*}
Rearranging and solving for $\boldx(v)$ gives the result.

Finally, to prove \ref{pitem:black_vertex_properties_black_unweighted_degree}, we have
\begin{align*}
    \text{deg}_G^B(v) &\geq \ceil{\frac{d_G^B(v)}{\max_{u \in \VB} \boldx(u)}} > \frac{t-r-1 + \lb \ceil{\frac{h}{2t+1}}-t+r \rb p}{p} \\
    &\geq \lb \ceil{\frac{h}{2t+1}}-1 \rb \lb t-r \rb,
\end{align*}
where the second inequality holds by \ref{pitem:black_vertex_properties_black_weighted_degree} and \ref{pitem:black_vertex_properties_weight} and the final inequality because $p \leq \frac{1}{\ceil{h/(2t+1)}}$.
% Finally, to prove \ref{pitem:black_pair_common_neighbourhood}, we observe
% $\boldx(VK) \geq d_G^B(v) + d_G^B(w)-d_G^B(v,w)$. Therefore, by applying \ref{pitem:black_vertex_properties_weight}, we have
% %
% \begin{align*}
%     d_G^B(v,w) \geq d_G^B(v) + d_G^B(w) - 1 + \boldx(\VW) > \frac{t-r-2 +rp}{t+ \lb \ceil{\dfrac{h}{2t+1}}-t-1 \rb p}.
% \end{align*}
% %
% Therefore,
% %
% \[
% \deg_G^B(v,w) \geq \ceil{\frac{d_G^B(v,w)}{\max_{u \in \VB} \boldx(u)}} > \ceil{\frac{t-r-2+rp}{p}}.
% \]
\end{proof}

Note that when applying this result, we will usually ignore the exact value of $\eps$ and rely only on the fact that $g_K(p) < \gamma_\cH(p)$. Finally, we state the following fact, which follows immediately from Cases $2$ and $3$ in the proof of Theorem 3 in the work of Berikkyzy, Martin, and Peck \cite{berikkyzy2019edit}. This allows us to now restrict to the case when the candidate CRG contains exactly $t-1$ vertices.

\begin{lemma}\label{lem:white_vxs}
Let $p \in (0, 1/2]$\ and let $t \geq 1$ and $h \geq 2t(t+1)+1$. If $K$ is a $p$-core CRG with $g_K(p) < \gamma_\cH(p)$, that is, a candidate CRG, then $K$ has exactly $t-1$ white vertices.
\end{lemma}

\subsection{Existence of long cycles}

Before stating and proving the key lemmas in this section, we define some useful notation relating to paths and cycles. We will define these in terms of labelled paths, and remark that the corresponding definitions also apply for cycles. We say the \emph{length} of a path $P$ is the number of edges in $P$, and we denote this by $\size{P}$. If $P$ is a labelled path, say $P=v_1 \, \dots \, v_\ell$, then the \emph{successor} of a vertex $v_i$ on $P$ is the vertex $v_{i+1}$. The \emph{predecessor} of $v_i$ on $P$ is the vertex $v_{i-1}$. For indices $1 \leq i < j \leq \ell$, the subpath $v_i \, P \, v_j$ is the path $v_i \, v_{i+1} \, \dots \, v_{j-1} \, v_j$, that is, the path which has initial vertex $v_i$ and final vertex $v_j$ and follows the labelling of $P$. The path $v_j \, P^{-1} \, v_i$ is the path which has initial vertex $v_j$, final vertex $v_i$ and follows the reverse of the labelling of $P$. We also recall that for a set $S \subseteq V(K)$, the value $\boldx(S)$ denotes the sum of weights of vertices in that set, that is, $\boldx(S) = \sum_{v \in S} \boldx(v)$. We now prove a lemma which shows that for sufficiently small values of $p$, every $p$-core candidate CRG which has $t-1$ white vertices contains a grey cycle of length at least $\ceil{h/2t}$ in the subgraph induced on the black vertices. Recall that $K_B = K[\VB]$.
%
\begin{lemma}\label{plem:long_cycle_exists}
Let $t \geq 1$, and {$h \geq 4t(2t+1) \}$} be integers with $(t+1) \mid h$. Let $K$ be a $p$-core candidate CRG for some $p \leq 1/\ceil{h/(2t+1)}$, and suppose that $K$ contains $t-1$ white vertices. Then $K_B$ contains a grey cycle of length at least $\ceil{h/2t}$.
\end{lemma}
%
\begin{proof}
We would like to find a grey cycle of length at least $\ceil{h/2t}$. Recall by \cref{thm:characterisation_of_p_core_crgs}
that all edges of $K_B$ are either grey or white. Assume for a contradiction that the longest grey cycle in $K_B$ has length at most $\ceil{h/2t}-1$. By \cref{pprop:black_vertex_properties}~\ref{pitem:black_vertex_properties_black_weighted_degree}, for each vertex $v \in \VB$, we have that 
%
\begin{align*}
    d_G^B(v) > \frac{\lb \ceil{\frac{h}{2t+1}}-1\rb p}{t+\lb \ceil{\frac{h}{2t+1}}-t-1\rb p} + \frac{1-2p}{p}\boldx(v).
\end{align*}
%
Let $P$ be a longest grey path in $K_B$. Let $P = v_1 \ldots v_\ell$ so that $v_1$ and $v_\ell$ are the endvertices of $P$ and $v_{i}v_{i+1}$ are edges of $P$ for each $i \in [\ell-1]$. Note that by the maximality of $P$, each grey neighbour of $v$ in $\VB$ must lie on $P$. Let $Q = \{v_2, \ldots, v_m\}$ where $m$ is the largest index in $[\ell]$ such that $m \leq \ceil{h/2t}$ (so $Q \cup \{v_1\}$ is the set of the first $m+1$ vertices of $P$). The aim is to show that $v_1$ must have a grey neighbour in $\VB$ which lies outside $Q$, and this will give us a cycle of length at least $\ceil{h/2t}$. So we assume that $\size{Q} = \ceil{h/2t}-2$, that is $Q = \{v_2, \ldots, v_{\ceil{h/2t}-1}\}$. 

Consider $b \in \{2, \ldots, \ceil{h/2t}-1\}$ such that $v_1 v_b$ is an edge. Then by applying a rotation, we can find a grey path $P_b =  v_{b-1} P^{-1} v_1 v_b P v_\ell$ which has initial vertex $v_{b-1}$ and has the same length as $P$. By the maximality of $P$, the path $P_b$ must also be a longest grey path in $K_B$ and so the grey neighbourhood in $\VB$ of $v_{b-1}$ must also lie entirely on $P_b$. Furthermore, note that the set of vertices $Q \cup \{v_1\}$ are still the first $\ceil{h/2t}-1$ vertices of the path $P_b$. Therefore, if $v_{b-1}$ had a grey neighbour on $P$ outside $Q \cup \{v_1\}$, we would find a cycle of length at least $\ceil{h/2t}$, as required. So, we may assume that the grey neighbourhood of $v_{b-1}$ in $\VB$ lies entirely in the set $Q \cup \{v_1\}$. In particular, the set of the first $\ceil{h/(2t)}-1$ vertices of $P$ is the same as the set of the first $\ceil{h/2t}-1$ vertices of $P'$, albeit that they have been rearranged.

We know by \cref{pprop:black_vertex_properties}~\ref{pitem:black_vertex_properties_black_unweighted_degree} that $v_1$ has at least $\ceil{h/(2t+1)}$ grey neighbours in $\VB$. Say $v_1$ has exactly $\ceil{h/(2t+1)}+y$ grey neighbours in $\VB$ for some $y \in \{0, \ldots, \ceil{h/2t}-\ceil{h/(2t+1)}-2\}$. Let $Q'$ be the set of vertices in $Q$ which are predecessors in $P$ of grey neighbours of $v_{1}$, that is, the set of vertices $v_j \in V(P)$ for which $v_1 v_{j+1}$ is a grey edge and $j \in Q$. Then $\size{Q'}=\ceil{h/(2t+1)}+y-1$ (since $v_1$ itself is a predecessor of $v_2$ on $P$, but $v_1$ does not lie in $Q$). Let $Q'' = Q \setminus Q'$. Then $\size{Q''} = \ceil{h/2t}-\ceil{h/(2t+1)}-y-1$. Now by the upper bound on the weight of a black vertex given in \cref{pprop:black_vertex_properties}~\ref{pitem:black_vertex_properties_weight}, we obtain that
%
\begin{equation*}
 \boldx(Q) \leq \frac{\lb \ceil{\frac{h}{2t}}-2 \rb p}{t + \lb \ceil{\frac{h}{2t+1}}-t-1 \rb p}.
\end{equation*}
On the other hand, since $\boldx(Q) \geq d_G^B(v_1)$, we have 
\begin{equation*}
    \boldx(Q) > \frac{\lb \ceil{\frac{h}{2t+1}}-1 \rb p }{t + \lb \ceil{\frac{h}{2t+1}}-t-1 \rb p} + \frac{1-2p}{p} \boldx(v_1).
\end{equation*}
Furthermore, again by the upper bound on the weight of a black vertex, we have 
\begin{equation*}
    \boldx(Q'') \leq \frac{\lb \ceil{\frac{h}{2t}}-\ceil{\frac{h}{2t+1}}-y-1 \rb p}{t + \lb \ceil{\frac{h}{2t+1}}-t-1 \rb p}.
\end{equation*}
Therefore, since $\boldx(Q') = \boldx(Q) - \boldx(Q'')$, we have
\begin{equation*}
    \boldx(Q') > \frac{\lb 2\ceil{\frac{h}{2t+1}}-\ceil{\frac{h}{2t}} +y \rb p }{t + \lb \ceil{\frac{h}{2t+1}}-t-1 \rb p} + \frac{1-2p}{p} \boldx(v_1).
\end{equation*}
Therefore, by averaging over all vertices in $Q'$, we find that there exists some vertex $u \in Q'$ such that
\begin{equation*}
    \boldx(u) > \frac{\lb 2\ceil{\frac{h}{2t+1}}-\ceil{\frac{h}{2t}} +y \rb p }{\lb \ceil{\frac{h}{2t+1}}+y-1 \rb \lb t + \lb \ceil{\frac{h}{2t+1}}-t-1 \rb p \rb} + \frac{1-2p}{\lb \ceil{\frac{h}{2t+1}}+y-1 \rb p} \boldx(v_1).
\end{equation*}
Since {$h \geq 4t(2t+1)$}, we have that 
\begin{equation*}
    \boldx(u) > \frac{\lb 2\ceil{\frac{h}{2t+1}}-\ceil{\frac{h}{2t}} \rb p }{\lb \ceil{\frac{h}{2t+1}}-1 \rb \lb t + \lb \ceil{\frac{h}{2t+1}}-t-1 \rb p \rb} + \frac{1-2p}{\lb \ceil{\frac{h}{2t}}-3 \rb p} \boldx(v_1).
\end{equation*}
This bound holds because $(x + y)/(x'+y) \geq x/x'$ whenever $x' \geq x$ and $y \geq 0$. So, if we let $x = 2 \ceil{h/(2t+1)}-\ceil{h/2t}$ and $x' = \ceil{h/(2t+1)}-1$, then it suffices to have $x \leq x'$, and in order for this to be true, it suffices to have $h \geq 4t(2t+1)$. Now note that
\begin{equation}\label{eq:upper_bound_on_qv1}
    \boldx(Q \cup \{ v_1 \}) \leq \frac{\lb \ceil{\frac{h}{2t}}-2 \rb p}{t + \lb \ceil{\frac{h}{2t+1}}-t-1 \rb p} + \boldx(v_1).
\end{equation}
On the other hand, since $u \in Q'$, it is the predecessor on $P$ to some grey neighbour of $v_1$ and so as we have seen already, the entire grey neighbourhood of $u$ in $K_B$ must lie in $Q \cup \{v_1\}$. Therefore, 
\begin{align}
    &\,\,\boldx(Q \cup \{v_1\}) > \frac{\lb \ceil{\frac{h}{2t+1}}-1 \rb p}{t + \lb \ceil{\frac{h}{2t+1}}-t-1 \rb p} + \frac{1-p}{p}\boldx(u) \nonumber\\
&> \frac{\lb \ceil{\frac{h}{2t+1}}-1 \rb p}{t + \lb \ceil{\frac{h}{2t+1}}-t-1 \rb p} + \frac{\lb 2\ceil{\frac{h}{2t+1}}-\ceil{\frac{h}{2t}} \rb (1-p) }{\lb \ceil{\frac{h}{2t+1}}-1 \rb \lb t + \lb \ceil{\frac{h}{2t+1}}-t-1 \rb p \rb} + \frac{(1-2p)(1-p)}{\lb \ceil{\frac{h}{2t}}-3 \rb p^2} \boldx(v_1) \nonumber\\
&= \frac{2\ceil{\frac{h}{2t+1}}-\ceil{\frac{h}{2t}} + \lb \ceil{\frac{h}{2t+1}}^2 -4\ceil{\frac{h}{2t+1}}+\ceil{\frac{h}{2t}}+1 \rb p}{\lb \ceil{\frac{h}{2t+1}}-1 \rb \lb t + \lb \ceil{\frac{h}{2t+1}}-t-1 \rb p \rb} + \frac{(1-2p)(1-p)}{\lb \ceil{\frac{h}{2t}}-3 \rb p^2} \boldx(v_1). \label{eq:bound_in_terms_of_v_1}
\end{align}
Now we prove the following claim.
\begin{claim}\label{pclaim:long_cycles}
If $t \geq 1$, $h \geq 4(2t+1)$ and $p \leq 1/\ceil{h/(2t+1)}$, we have
\[
    \frac{(1-2p)(1-p)}{\lb \ceil{\frac{h}{2t}}-3 \rb p^2} \geq 1.
\]
\end{claim}
\begin{proof}[Proof of \cref{pclaim:long_cycles}]
We would like to show that when $p \leq 1/\ceil{h/(2t+1)}$, we have $(1-2p)(1-p)/p^2 \geq \ceil{h/2t}-3$. It suffices to show that whenever $p \leq (2t+1)/h$, we have
%
\[
    \frac{1-3p}{p^2} \geq \frac{h}{2t}-2.
\]
%
Since the left side of the equation above is decreasing in $p$ in the interval $(0,2/3)$, it suffices to show that this holds for the upper bound on $p$, that is, it suffices to show
%
\begin{equation}\label{eq:bound_for_claim3.6}
1-3\lb \frac{2t+1}{h} \rb \geq \lb \frac{2t+1}{h} \rb^2 \lb  \frac{h}{2t}-2 \rb.
\end{equation}
%
Now suppose that $h = k(2t+1)$ for some $k > 0$. Then in order for the inequality in \eqref{eq:bound_for_claim3.6} to hold, we need
\[
1-\frac{3}{k} \geq \frac{1}{k^2} \lb \frac{k(2t+1)}{2t} -2 \rb.
\]
or equivalently, we need $k^2 -k(4+1/2t)+2 \geq 0$. In particular, since $t \geq 1$, it suffices to have $k^2 - 4.5 k +2 \geq 0$. The left side of this inequality is a positive quadratic with roots at $k=0.5$ and $k=4$, so in particular, this holds whenever $k \geq 4$. Therefore, in particular, it suffices to have $h \geq 4(2t+1)$. 
\end{proof}
%
Note that we have {$h \geq 4t(2t+1) \geq 4(2t+1)$} and $p \leq 1/\ceil{h/(2t+1)}$. Therefore, by applying \cref{pclaim:long_cycles} to \eqref{eq:bound_in_terms_of_v_1}, we get 
\begin{equation*}
    \boldx(Q \cup \{v_1\}) > \frac{2\ceil{\frac{h}{2t+1}}-\ceil{\frac{h}{2t}} + \lb \ceil{\frac{h}{2t+1}}^2 -4\ceil{\frac{h}{2t+1}}+\ceil{\frac{h}{2t}}+1 \rb p}{\lb \ceil{\frac{h}{2t+1}}-1 \rb \lb t + \lb \ceil{\frac{h}{2t+1}}-t-1 \rb p \rb} + \boldx(v_1).
\end{equation*}
%
Combining this with the upper bound on $\boldx(Q \cup \{v_1\})$ given in \eqref{eq:upper_bound_on_qv1}, and rearranging, we get that
\begin{equation}\label{eq:intermediate_bound_on_p}
p > \frac{2\ceil{\frac{h}{2t+1}} -\ceil{\frac{h}{2t}}}{\ceil{\frac{h}{2t}}\ceil{\frac{h}{2t+1}} - \ceil{\frac{h}{2t+1}}^2 -2\ceil{\frac{h}{2t}} + 2 \ceil{\frac{h}{2t+1}}+1}.
\end{equation}
However, when {$h \geq 4t(2t+1)$}, the inequality above contradicts the assumption that $p \leq 1/\ceil{h/(2t+1)}$. For $t\geq 2$, we can show this by the fact that $m \leq \ceil{m} \leq m+1$. Indeed, since $p \leq 1/\ceil{h/(2t+1)}$, we know that the right side of the inequality~\eqref{eq:intermediate_bound_on_p} above must also be at most $1/\ceil{h/(2t+1)}$. Rearranging this and substituting the appropriate upper or lower bound for $m = \frac{h}{2t+1}$ or $m=\frac{h}{2t}$, and we obtain an inequality in terms of $h$ and $t$. Specifically, we show that if $p \leq 1/\ceil{h/(2t+1)}$ and also satisfies \eqref{eq:intermediate_bound_on_p}, then
\begin{equation}\label{eq:intermediate_bound_2}
\frac{2h^2(t-1)-2h(2t-1)(2t+1)^2-10(2t+1)^2t}{h^2+h(2t+1)(8t^2+4t-1)+8t(2t+1)^2}<0.
\end{equation}
As the denominator of this is always non-negative for $t \geq 1$, we require $2h^2(t-1)-2h(2t-1)(2t+1)^2-10(2t+1)^2t<0$. For $t \geq 2$, this is a positive quadratic with minimum at $h= (2t-1)(2t+1)^2/(2(t-1))$. For $t \geq 2$, this is smaller than $h=4t(2t+1)$, so for $h \geq 4t(2t+1)$, the function is increasing. By showing that the left side of \ref{eq:intermediate_bound_2} is positive at $h=4t(2t+1)$, we obtain the necessary contradiction. This does not work for $t=1$, however, since this crude upper and lower bound on $\ceil{m}$ is not quite good enough. Instead, we split into $3$ cases depending on the value of $h$ mod $3$ (that is, we replace $h$ by one of $3k$, $3k+1$, or $(3k+2)$) and then obtain a contradiction as before $p$ satisfying both $p \leq 1/\ceil{h/(2t+1)}$ and also \cref{eq:intermediate_bound_on_p}. 
We conclude that the black-vertex subgraph $K_B$ must indeed contain a grey cycle of length at least $\ceil{h/2t}$.
\end{proof}


\subsection{Using long cycles to find shorter cycles}

In this section, we prove two key lemmas. First, we show that given a graph satisfying a particular condition on the degree, we can use `long' cycles to find shorter cycles in the graph.

\begin{lemma}\label{lem:length_reduction}
Let $G$ be a graph, $m \geq 5$ a positive integer. Suppose that in every set of $\floor{m/3}$ vertices of $G$, there are some two which have a common neighbour. If $G$ contains a cycle of length at least $m$, then it also contains a cycle of length between~$\ceil{m/2}$~and~$m-1$.
\end{lemma}
%
\begin{proof}
Let $C$ be a shortest cycle in $G$ among all cycles of length at least $m$. The idea of the proof is as follows. We carefully choose a set of $\floor{m/3}$ vertices of $C$, and our hypothesis then implies that two of these vertices share a common neighbour. We use this common neighbour to find a new cycle $C'$ which has length strictly shorter than $C$ but still has length at least $\ceil{m/2}$. By minimality of $C$, we must have that $C'$ has length at most $m-1$, thus proving the result. It remains only to choose the set of vertices, and show that we can always find a new cycle $C'$.

We begin by labelling the vertices of $C$ by $u_1, \dots, u_\ell$, so that $u_i u_{i+1}$ is an edge for each $i \in [\ell]$ (indices taken with addition modulo $\ell$). Let $M$ be the subset of vertices of $C$ given by 
\[
    M = \lcb u_{3i-2} \colon i \in \lcb 1, \dots, \floor{\frac{m}{3}} \rcb \rcb.
\]
Since $M$ contains exactly $\floor{m/3}$ vertices, we know by hypothesis that there exist two distinct vertices $u_i, u_j \in M$ which have a common neighbour $v$ in $G$. Without loss of generality, we may assume $i <j$. By choice of $M$, the paths $u_i \, C \, u_j$ and $u_j \, C \, u_i$ have length at least 3. Hence, the path $u_i \, v \, u_j$ requires at least one edge which does not belong to the cycle $C$.

We have two cases to consider. Recall that in each case, we aim to find a new cycle $C'$ such that $\ceil{m/2} \leq \size{C'} \leq \size{C}-1$.

\begin{enumerate}[label=\textbf{Case \arabic*:},wide,labelindent=0pt,parsep=0pt]
\item \textbf{$\boldsymbol{v}$ lies outside the cycle $\boldsymbol{C}$.} Now note that $3 \leq j-i \leq m-3$. If $j-i \geq \ceil{m/2}-2$ then let $C' = u_i \, C \, u_j \, v \, u_i$. Then $\size{C'} = (j-i)+2$. Hence,
\[
\ceil{\frac{m}{2}} = \ceil{\frac{m}{2}}-2 + 2 \leq \size{C'} \leq \size{C}-3+2 = \size{C}-1,
\]
as required. On the other hand, if $j-i \leq \ceil{m/2}-2$, then let $C' = u_i \, v \, u_j \, C \, u_i$. Then $\size{C'} = \size{C}-(j-i)+2 $ and
\[
\ceil{\frac{m}{2}} \leq  m -\ceil{\frac{m}{2}} + 2 + 2 \leq  \size{C'} \leq \size{C}-1,
\]
as required. 

\item \textbf{$\boldsymbol{v}$ lies on the cycle $\boldsymbol{C}$.} Since both the paths $u_i \, C \, u_j$ and $u_j \, C \, u_i$ have length at least 3, and the vertex $v$ must lie on one of these paths, we may assume without loss of generality that both of the paths $P_1 = u_i \, C \, v$ and $P_2 = v \, C \, u_i$ have length at length at least 2. In particular, the edge $u_i \, v$ is a chord on $C$. Thus, either $P_1$ or $P_2$ have length at least $\ceil{\size{C}/2}$, say this is $P_1$ without loss of generality, and let $C' = P_1 \, u_i$. Then 
\[
    \ceil{\frac{m}{2}} \leq \frac{\size{C}}{2}+1 \leq \size{C'} \leq \size{C}-1,
\]
as required.\qedhere
\end{enumerate}
\end{proof}

The following lemma gives a condition on the common neighbourhoods of vertices in a weighted graph $K$. For each vertex $v \in V(K)$, let $N_G(v)$ be the set of grey neighbours of $v$ in $V(K)$, that is,
\[
N_G(v) = \{u \in V(K) \colon uv \in \EG\}.
\]

\begin{lemma}\label{lem:any_set_has_pair_with_intersecting_neighbourhood}
Let $K$ be a CRG with all black vertices and all edges grey or white. Let $m \geq 2$ be an integer. If $d_G(v) >1/m$ for all $v \in V(K)$, then in each subset $M \subseteq V(K)$ of size at least $m$ there exist at least 2 vertices which have a common neighbour in their grey neighbourhood.
\end{lemma}
%
\begin{proof}
Consider a set $M \subseteq V(K)$ with $\size{M} \geq m$. Suppose that the neighbourhoods of vertices in $M$ are pairwise-disjoint. Then we have
\[
1 \geq \sum_{w \in \bigcup_{v \in M} N_G(v)} \boldx(w) = \sum_{v \in M} \sum_{w \in N_G(v)} \boldx(w) = \sum_{v \in M} {d_G(v)} > 1,
\]
a contradiction. Here, the first inequality holds since the sum of weights of all vertices in $K$ is exactly 1, the second equality holds by the assumption that every pair of vertices have a disjoint neighbourhood and the final inequality holds because each term of the sum has size greater than $1/m$ by assumption.
\end{proof}

\subsection{Proof of Theorem~\ref{thm:main_result}}

It remains only to combine the lemmas we have seen in this section to prove our main result. 

\begin{proof}[Proof of \cref{thm:main_result}]
Let {$t \geq 1$ and $h \geq 4t(2t+1)$}. Recall that $c_0  = \floor{(\floor{h/t}+1)/3}$, $\ell_0 = \ceil{h/(2t+1)}$, and $p_0 = t/(c_0 \ell_0 -c_0 - \ell_0 +t+1)$, with $p \in [p_0, 1/\ceil{h/(2t+1)}]$.

Assume for a contradiction that there exists a $p$-core candidate CRG $K$. Suppose that $K$ has $r$ white vertices. By \cref{lem:white_vxs}, we $r = t-1$.
By \cref{plem:long_cycle_exists}, we know that $K_B$ contains a grey cycle of length at least $\ceil{h/(2t)}$. By \cref{lem:forbidden_cycles}, $K_B$ cannot contain a grey cycle of length $\ell$ for any $\ell \in \{ \ceil{h/(2t)}, \ldots, \floor{h/t} \}$. Combining these facts together, we may assume that $K_B$ contains a grey cycle of length at least $\floor{h/t}+1$. 

By definition we have $\boldx(\VB) \leq 1$. Furthermore, by \cref{pprop:black_vertex_properties}~\ref{pitem:black_vertex_properties_black_weighted_degree} as there are exactly $t-1$ white vertices, we know that for each vertex $v \in \VB$,
\begin{equation}\label{eq:weight_of_black_neighbourhood_in_grey}
    d_G^B(v) \geq \frac{\lb \ceil{\frac{h}{2t+1}}-1 \rb p}{t+ \lb \ceil{\frac{h}{2t+1}}-t-1 \rb p} + \frac{1-2p}{p}\boldx(v).
\end{equation}

\begin{claim}\label{claim:where_we_use_p_0}
    When $p \geq p_0$, we have that $d_G^B(v) > 1/c_0$.
\end{claim}
\begin{proof}[Proof of \cref{claim:where_we_use_p_0}]
    It suffices to show that when $p \geq p_0$,
    \begin{equation*}
        \frac{\lb \ceil{\frac{h}{2t+1}}-1 \rb p}{t+ \lb \ceil{\frac{h}{2t+1}}-t-1 \rb p} > \frac{1}{c_0},
    \end{equation*}
    as by \eqref{eq:weight_of_black_neighbourhood_in_grey} this implies the claim. This is equivalent to showing
    \begin{equation}\label{eq:equivalent_to_claim}
        \lb \lb \ceil{\frac{h}{2t+1}}-1 \rb c_0  -  \ceil{\frac{h}{2t+1}}+t+1 \rb p > t.
    \end{equation}
    Now note that 
    \begin{align*}
        \lb \ceil{\frac{h}{2t+1}}-1 \rb \floor{\frac{\floor{\frac{h}{t}}+1 }{3}}  -  \ceil{\frac{h}{2t+1}}+t+1 
        &\geq \lb {\frac{h}{2t+1}}-1 \rb \lb {\frac{h}{3t}} - 1 \rb  -  {\frac{h}{2t+1}}-1+t+1\\
        &= \frac{h^2}{3t(2t+1)} - \frac{h}{3t} -\frac{h}{2t+1} +1 +t \\
        &= \frac{h^2 - h(5t+1)+3t(t+1)(2t+1)}{3t(2t+1)}.
    \end{align*}
    This is positive whenever $h^2 - h(5t+1)+3t(t+1)(2t+1) \geq 0$. Indeed, this has roots at
    \begin{equation*}
        t_0^\pm = \frac{(5t+1) \pm \sqrt{(5t-1)^2-12t(t+1)(2t+1)}}{2}.
    \end{equation*}
    For $t \geq 4$, the quantity $(5t-1)^2-12t(t+1)(2t+1)$ is negative, and so this is a positive quadratic with no roots, and so is always positive. On the other hand, for $t = 1$, this is a positive quadratic with larger root between $5$ and $5.5$, and so for $h \geq 4t(2t+1) \geq 6$, the equation is positive. For $t = 2$, this has larger root between $8$ and $8.5$ and so for $h \geq 4t(2t+1) \geq 8$, the equation is positive. Finally, for $t=3$, this has larger root at $9$, and therefore, for $h \geq 4t(2t+1) \geq 9$, the equation is always positive. 

    In particular, when $t \geq 1$ and $h \geq 4t(2t+1)$, the inequality $h^2 - h(5t+1)+3t(t+1)(2t+1) \geq 0$ holds. Therefore, we can rearrange \eqref{eq:equivalent_to_claim} and get that
    \begin{equation}
        p \geq \frac{t}{\lb \ceil{\frac{h}{2t+1}}-1 \rb \floor{\frac{\floor{\frac{h}{t}}+1 }{3}}  -  \ceil{\frac{h}{2t+1}}+t+1 } = p_0.
    \end{equation}
\end{proof}


So by \cref{claim:where_we_use_p_0}, since $p \geq p_0$, each vertex $v \in \VB(K)$ satisfies $d_G^B(v) > \boldx(\VB)/ \ceil{(\ceil{h/t}+1)/3}$. Therefore by \cref{lem:any_set_has_pair_with_intersecting_neighbourhood}, in each set of $\ceil{\frac{\floor{h/t}+1}{3}}$ vertices of $K_B$, there are some two which have a common grey neighbour in $K_B$. Thus, we can apply \cref{lem:length_reduction} to show that $K_B$ must contain a grey cycle of length $\ell$ for some $\ell \in \{ \ceil{(\floor{h/t}+1)/2}, \dots, \floor{h/t}\}$. Note that $\ceil{(\floor{h/t}+1)/2} \geq \ceil{h/(2t)}$. Indeed, if $h = x + y t$ for $x \in \{0, \ldots, t-1\}$, then
\begin{align*}
    \ceil{\frac{\floor{\frac{h}{t}}+1}{2}}-\ceil{\frac{h}{2t}} = \ceil{\frac{\floor{\frac{x+yt}{t}}+1}{2}}-\ceil{\frac{x+yt}{2t}} = \ceil{\frac{y}{2}+\frac{1}{2}}-\ceil{\frac{y}{2} + \frac{x}{2t}} \geq 0.
\end{align*}
Here, the second equality holds because of the definition of the floor function and the final inequality holds because $x/t < 1$. Thus, we have found a cycle of length in the range forbidden by \cref{lem:forbidden_cycles}, giving a contradiction to the assumption that such a $K$ exists, and therefore, $\ed_{\Forb(C_h^t)}(p) = \gamma_{\Forb(C_h^t)}(p)$ for $p \in [p_0, 1/\ceil{h/(2t+1)}]$, concluding the proof.
\end{proof}

%Therefore, we have proved that when $p \geq p_0$, \cref{thm:main_result} does indeed hold. In the next lemma, we check that $p_0 < 1/\ceil{h/2t+1}$ for all $h \geq 4t(2t+1)$, and therefore the result does indeed extend on the range given in the work of Berikkyzy, Martin and Peck \cite{berikkyzy2019edit}.

% \begin{lemma}\label{lem:p_0_is_small}
%     Let $t \geq 1$ and $h \geq 4t(2t+1)$. Then $p_0 \leq 1/\ceil{h/(2t+1)}$, that is,
%     \[\frac{t}{\lb \ceil{\frac{h}{2t+1}}-1 \rb \floor{\frac{\floor{\frac{h}{t}}+1 }{3}}  -  \ceil{\frac{h}{2t+1}}+t+1 } < \frac{1}{\ceil{\frac{h}{2t+1}}}.\]
% \end{lemma}
% \begin{proof}
% Let $t$ and $h$ be as in the lemma. It suffices to show that
% \begin{equation}\label{eq:suffices_to_show_for_p_0}
%     \ceil{\frac{h}{2t+1}}\floor{\frac{\floor{\frac{h}{t}}+1 }{3}} - \floor{\frac{\floor{\frac{h}{t}}+1 }{3}}  -(t+1) \ceil{\frac{h}{2t+1}}+t+1 > 0.
% \end{equation}
% Note that 
% \begin{align*}
%     &\ceil{\frac{h}{2t+1}}\floor{\frac{\floor{\frac{h}{t}}+1 }{3}} - \floor{\frac{\floor{\frac{h}{t}}+1 }{3}}  -(t+1) \ceil{\frac{h}{2t+1}}+t+1 \\
%     &\geq \frac{h}{2t+1} \lb \frac{\frac{h}{t}}{3} -1 \rb - \frac{\frac{h}{t}+1}{3}-(t+1) \lb \frac{h}{2t+1}+1 \rb+ (t+1)\\
%     &= \frac{h^2}{3t(2t+1)} =\frac{h}{2t+1}=\frac{h+1}{3t}-\frac{(t+1)h}{2t+1}\\
%     &=\frac{h^2-h(3t^2+8t+1)-(2t+1)}{3t(2t+1)}.
% \end{align*}
% As the denominator is always positive, this is positive when the numerator is positive. The numerator is a positive quadratic, and so is always positive when $h$ is at least the larger root. So, if we can show that the larger root is at most $4t(2t+1)$, then we are done. Indeed, the larger root is at
% \begin{align*}
%     h_0= \frac{3t^2+8t+1+\sqrt{(3t^2+8t+1)^2+4(2t+1)}}{2}=\frac{3t^2+8t+1+\sqrt{9t^4+48t^3+70t^2+24t+5}}{2}.
% \end{align*}
% For $t \geq 2$, we have 
% \[
% \frac{3t^2+8t+1+\sqrt{9t^4+48t^3+70t^2+24t+5}}{2} < \frac{3t^2+8t+1 + \sqrt{(13t^2-1)^2}}{2} = 4t(2t+1).
% \]
% Therefore, the lemma holds for each $t \geq 2$. Meanwhile, for $t=1$, we can directly calculate this. Indeed, note that if we substitute $t=1$ into the left hand side \eqref{eq:suffices_to_show_for_p_0}, we get
% \begin{align*}
%     \ceil{\frac{h}{3}}\floor{\frac{h+1}{3}} - \floor{\frac{h+1}{3}} - 2\ceil{\frac{h}{3}}  +2 \geq \frac{h}{3}\lb \frac{h+1}{3}-1 \rb - \frac{h+1}{3} - 2 \lb \frac{h}{3}+1 \rb +2 = \frac{h^2+h-3}{9}.
% \end{align*}
% The numerator is a positive quadratic and is positive whenever $h$ is at least the largest root. In particular, we need $h \geq -1/2+\sqrt{13}/2$. Since we have $h \geq 4t(2t+1)=12 = -1/2 + \sqrt{25^2}/2 > -1/2 + \sqrt{13}/2$, the equation is positive for all $h \geq 12$. Therefore, for each $t \geq 1$, for each $h \geq 4t(2t+1)$, we have that \eqref{eq:suffices_to_show_for_p_0} holds, concluding the proof.
% \end{proof}

\subsection{Proof of \cref{thm:main_result_C_10_12}}

In order to prove \cref{thm:main_result_C_10_12}, we first need to introduce the following definition. Let $K$ be a CRG. Then for any vertices $u, v \in V(K)$, we say that $\dist_G(u,v)$ is the length of the shortest grey-edge path between $u$ and $v$. For any $i \in \N$, we define $N^i_G(v)= \{u \in V(K) \colon \dist_G(u,v) \leq i\}$.

\begin{proof}
    Let $h \in \{10, 12\}$ and let $p_{10} = 1/7$ and $p_{12} = 1/10$. Let $p \in (0, p_h)$ and suppose there is a $p$-core candidate CRG $K$ for $\Forb(C_h)$. We will find a contradiction to show that such a CRG cannot exist, which therefore implies that $\ed_{\Forb(C_h)}(p) = \gamma_{\Forb(C_h)}(p) = \frac{p(1-p)}{1+(\ceil{h/3}-2)p}$. By \cref{thm:characterisation_of_p_core_crgs}, we may assume that all vertices of $K$ are black, and all edges are either grey or white. Thus whenever it is not explicitly stated in this proof, we consider grey edges to be edges and white edges to be non-edges. By \cref{plem:long_cycle_exists}, we know that $K$ contains a grey cycle of length at least $h/2$. Let $C$ be the shortest grey cycle of length at least $h/2$ in $K$. Then by \cref{lem:forbidden_cycles}, we know that $K$ cannot contain a grey cycle which has length in the range $\{h/2, \ldots, h\}$. Therefore, we may assume that $C$ has length at least $h+1$. Let $u$ and $u'$ be (as close as possible to) diametrically opposite vertices on $C$ (that is, $u C u'$ and $u' C u$ both have length at least $\floor{\size{C}/2}$). Note in particular that $\floor{\size{C}/2} \geq h/2$. 
    
    Suppose first that $N_G^2(u) \cap N_G^2(u') \neq \emptyset$, that is, there is some $v$ which lies in $N_G^2(u) \cap N_G^2(u')$. Note that no neighbour of $u$ (other than the vertices adjacent to $u$ on $C$) can lie on $C$, and similarly for $u'$. If this were the case, we would find a chord in $C$, which would give a shorter cycle of length at least $\floor{\size{C}/2} \geq h/2$, a contradiction. Similarly, if the vertex $v$ lies on the cycle, then it would lie on some path between $u$ and $u'$ on the cycle. Then the path from $u$ to $v$ outside the cycle has length $2$ and the path from $u'$ to $v$ outside the cycle has length $2$. Combining these paths with the path from $u$ to $u'$ on the cycle which does not include $v$, we would get a cycle which is strictly shorter than $C$ but has length at least $h/2$. Therefore, $v$ also lies outside the cycle. This would give a path of length either $2$ or $4$ between $u$ and $u'$ outside the cycle. Taking this together with a path from $u$ to $u'$ on $C$ again gives a shorter cycle than $C$ which still has length at least $h/2$, a contradiction. Thus, we may assume that $N_G^2(u) \cap N_G^2(u') = \emptyset$. We know that $\boldx(N^2_G(u)) + \boldx(N^2_G(u')) \leq 1$. Thus, without loss of generality, assume that $\boldx(N^2_G(u)) \leq 1/2$. 

    Now for any vertex $w \in N^2(u)$, we say that the multiplicity of $w$ is the number of vertices $v \in N_G(u)$ such that $w \in N_G(v)$. By \cref{pprop:black_vertex_properties}, we know that for any $v \in V(K)$, $d_G(v) \geq \frac{3p}{1+2p}+\frac{1-2p}{p} \boldx(v)$, and that $\boldx(v) \leq \frac{p}{1+2p}$. Thus, in particular, $\size{N_G(v)} \geq 3$. The remainder of the proof differs depending on whether \ref{item:main_result_h_10} $h=10$, or \ref{item:main_result_h_12} $h=12$.

    {For \ref{item:main_result_h_10}:} Note that $K$ cannot contain cycles of length in the range $\{5,\ldots, 10\}$. Suppose that there is some vertex $v \in N_G(u)$ such that there are 2 vertices $w, w' \in N_G(v)\setminus \{u\}$ which have multiplicity at least 3. Note that this implies there exists some $v' \in N_G(u)$ such that $v' w \in \EG(K)$. If there is some $v'' \in N_G(u) \setminus \{v, v', w\}$ such that $w' v'' \in \EG(K)$, then $u v' w v w' v'' u$ is a cycle of length $6$, a contradiction. Therefore, there can be no such $v''$, and so $ w \in N_G(u)$ and $v', w \in N_G(w')$. But then $u v w w' v' u$ is a cycle of length $5$, a contradiction. Therefore, for each vertex $v \in N_G(u)$, there can be at most one vertex $b(v)$ which has multiplicity at least $3$. Then
      \begin{align*}
        \sum_{v \in N_G(u)} \sum_{w \in N_G(v) \setminus \{u, b(v)\}} \boldx(w) &= \sum_{v\in N_G(u)} \lb \lb \sum_{w \in N_G(v)} \boldx(w) \rb - \boldx(u)\rb = \sum_{v \in N_G(u)} \lb d_G(v) - \boldx(u) - \boldx(b(v)) \rb\\
        &> \sum_{v\in N_G(u)} \lb \frac{3p}{1+2p} + \frac{1-2p}{p} \boldx(v) - \boldx(u) - \boldx(b(v))\rb \\
        &\geq \sum_{v \in N_G(u)} \frac{p}{1+2p} + \frac{1-2p}{p} \boldx(v)\\
        &> \frac{p}{1+2p} \size{N_G(u)} + \frac{1-2p}{p}\lb \frac{3p}{1+2p} + \frac{1-2p}{p} \boldx(u) \rb \\
        & \geq \frac{3-3p}{1+2p} + \frac{(1-2p)^2}{p^2} \boldx(u) \geq \frac{3-\frac{3}{7}}{1+\frac{2}{7}}=\frac{18}{9}=2.
    \end{align*}
Here, the second equality comes from the definition of $d_G(v)$, the next inequality by the lower bound on $d_G(v)$, the next by using the upper bound on the weight of a vertex, the next by the bound on $d_G(u)$ and the next by the fact that $\size{N_G(u)} \geq 3$. However, for each vertex $w$ which has a path of length exactly 2 to $u$, the number of times $\boldx(w)$ is counted in this sum is exactly the multiplicity of $w$, and therefore in particular, as we are ignoring any vertices with multiplicity at least $3$, each vertex in $N^2_G(u)$ can appear at most twice in this sum. Thus, 
\[
\sum_{v \in N_G(u)} \sum_{w \in N_G(v) \setminus \{u, b(v)\}} \boldx(w) \leq 2 \cdot \boldx(N_G^2(u)) \leq 1,
\]
a contradiction. Therefore, $K$ cannot exist. 

For \ref{item:main_result_h_12}: The proof follows similarly. Note that $K$ cannot contain any cycle of length in the range $\{6, \ldots, 12\}$. Suppose there is some vertex $v \in N_G(u)$ such that there are two vertices $w$ and $w'$ in $N_G(v)$ with multiplicity at least $4$. Then in particular, there are two vertices $v'$ and $v''$ in $N_G(u)$ such that $v' w$ and $v'' w' \in \EG(K)$. Then $u v' w v w' v'' u$ gives a cycle of length $6$, a contradiction. Therefore, for each vertex $v \in N_G(u)$, there can be at most one vertex $b'(v)$ which has multiplicity at least $4$. Then by the same calculation as before with $p \leq p_{12} = 1/10$,
\begin{align*}
        \sum_{v \in N_G(u)} \sum_{w \in N_G(v) \setminus \{u, b'(v)\}} \boldx(w) > \frac{3-3p}{1+2p} + \frac{(1-2p)^2}{p^2} \boldx(u) \geq \frac{3-\frac{3}{10}}{1+\frac{2}{10}}=\frac{27}{12} > 2.
    \end{align*}
However, by the same reasoning as before, each vertex in $N^2_G(u)$ can only appear at most 3 times in the sum above, and so
\[
\sum_{v \in N_G(u)} \sum_{w \in N_G(v) \setminus \{u, b'(v)\}} \boldx(w) \leq 3 \cdot \boldx(N_G^2(u)) \leq 3/2,
\]
a contradiction. Thus again, such a CRG $K$ cannot exist.
\end{proof}