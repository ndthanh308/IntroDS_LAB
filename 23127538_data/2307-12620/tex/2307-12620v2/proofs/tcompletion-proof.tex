
\begin{proofof}{Theorem \ref{thm:tcompletion}}
From left to right, let us assume towards a contradiction that \Ttrace\ is a temporal answer set of $P$, 
but \Ttrace\ is not an \LTLf-model of $\tCF{P}$.
By construction, if $\Ttrace$ is a temporal answer set of $P$ then $\T$ is an \LTLf{} model of $P$ so $\T, 0 \models P$.
Therefore, $\T,0 \models r$, for all $r \in P$ such that $\Head{r} = \bot$ and
$\T, 0 \models r$ for all $r \in F(P)$.
Since $\T, 0 \not \models \tCF{P}$, there exists $a \in \A$ such that 

\begin{align*}
	\T, 0 \not \models \alwaysF\big( a \leftrightarrow
	\ \bigvee_{r\in\initial{P}, a\in\Head{r}} (\initially\wedge S(r,a))
	\vee \bigvee_{r\in\dynamic{P}, a\in\Head{r}} (\neg\initially\wedge S(r,a))\big)
\end{align*}


So, there exists $\rangeco{i}{0}{\lambda}$ such that

\begin{align*}
	\T, i \not \models a \leftrightarrow
	\ \bigvee_{r\in\initial{P}, a\in\Head{r}} (\initially\wedge S(r,a))
	\vee \bigvee_{r\in\dynamic{P}, a\in\Head{r}} (\neg\initially\wedge S(r,a))
\end{align*}

We consider two cases: 

\begin{enumerate}
	\item $\T, i \models a$ and $\T, i \not \models 
	\ \bigvee_{r\in\initial{P}, a\in\Head{r}} (\initially\wedge S(r,a))
	\vee \bigvee_{r\in\dynamic{P}, a\in\Head{r}} (\neg\initially\wedge S(r,a))$: 
	
	\begin{itemize}
		\item If $i = 0$ then we get that for all $r \in \initial{P}$, if $a \in \Head{r}$ then $\tuple{\Ttrace,\Ttrace}, 0 \not \models S(r,a)$. 
		Therefore, for all $r \in \initial{P}$, if $a \in \Head{r}$ then $\tuple{\Ttrace,\Ttrace}, 0 \not \models \S(r,a)$.
		Let \Htrace\ be a trace of length $\lambda$ such that $H_0=T_0\setminus\{a\}$ and $H_i=T_i$ for $\rangeo{i}{1}{\lambda}$.
		Clearly, $\Htrace < \Ttrace$.
		We show a contradiction by proving that $\tuple{\Htrace,\Ttrace}\models P$:
		\begin{enumerate}
			\item  $\tuple{\Htrace,\Ttrace},0\models \initial{P}$: note that $\tuple{\Ttrace,\Ttrace},0\models \body{r}\to\Head{r}$ for all $r\in\initial{P}$, iff for any $r\in\initial{P}$, $\tuple{\Ttrace,\Ttrace},0\not\models \body{r}$ or $\tuple{\Ttrace,\Ttrace},0\models \Head{r}$.
			If $\tuple{\Ttrace,\Ttrace},0\not\models \body{r}$ then, by persistence, $\tuple{\Htrace,\Ttrace},0\not\models \body{r}$, and $\tuple{\Htrace,\Ttrace},0\models \body{r}\to\Head{r}$.
			If $\tuple{\Ttrace,\Ttrace},0\models \body{r}$, then $\tuple{\Ttrace,\Ttrace},0\models \Head{r}$.
			There are two cases.
			\begin{itemize}
				\item Case $a\not\in\Head{r}$:
				$\tuple{\Ttrace,\Ttrace},0\models \Head{r}$ so there is some $p\in\Head{r}$ such that $p\in T_0$ and $p \not = a$.  Then, $p\in H_0$, $\tuple{\Htrace,\Ttrace},0\models \Head{r}$ and $\tuple{\Htrace,\Ttrace},0\models r$.
				\item Case $a\in\Head{r}$:
				We know that $\tuple{\Ttrace,\Ttrace},0\not\models \body{r}\wedge \bigwedge_{p\in \Head{r}\setminus \{a\}} \neg p$.
				Since, by assumption, $\tuple{\Ttrace,\Ttrace},0\models \body{r}$, it follows 
				$\tuple{\Ttrace,\Ttrace}, 0\not\models  \bigwedge_{p\in \Head{r}\setminus \{a\}} \neg p$
				Therefore, there is $p\in\Head{r}\setminus\{a\}$ such that $p\in T_0$. Then $p\in H_0$, $\tuple{\Htrace,\Ttrace},0\models\Head{r}$ and $\tuple{\Htrace,\Ttrace},0\models r$.
%				We have already shown that, if $\tuple{\Ttrace,\Ttrace},0\not\models \body{r}$,
%				then $\tuple{\Htrace,\Ttrace},0\models r$.
%				If , there is
%				some 
			\end{itemize}
				As $r$ is chosen arbitrarily, $\tuple{\Htrace,\Ttrace}\models \initial{P}$.
			
			
			\item $\tuple{\Htrace,\Ttrace},0\models \dynamic{P}$: $\tuple{\Ttrace,\Ttrace}\models \dynamic{P}$, then $\tuple{\Ttrace,\Ttrace},i\models \body{r}\to\Head{r}$
			for all $r\in\dynamic{P}$ and $\rangeo{i}{1}{\lambda}$. Then, for any $r\in\dynamic{P}$ and
			$\rangeo{i}{1}{\lambda}$, $\tuple{\Ttrace,\Ttrace},i\not\models \body{r}$ or $\tuple{\Ttrace,\Ttrace},i\models \Head{r}$.
			If $\tuple{\Ttrace,\Ttrace},i\not\models \body{r}$ then, by persistence, $\tuple{\Htrace,\Ttrace},i\not\models \body{r}$,
			and $\tuple{\Htrace,\Ttrace},i\models r$.
			If, $\tuple{\Ttrace,\Ttrace},i\models \Head{r}$, there is some $p\in\Head{r}$ such that $p\in T_i$.
			$H_i = T_i$, so $p\in H_i$ and $\tuple{\Htrace,\Ttrace},i\models \Head{r}$.
			Then $\tuple{\Htrace,\Ttrace},i\models r$. As $r$ and $i$ are chosen arbitrarily,
			$\tuple{\Htrace,\Ttrace}\models \dynamic{P}$.
			\item $\tuple{\Htrace,\Ttrace},0\models \final{P}$: final rules are constraints, so $\tuple{\Ttrace,\Ttrace}\models \final{P}$ implies $\tuple{\Htrace,\Ttrace}\models \final{P}$.
		\end{enumerate}
		We showed that $\tuple{\Htrace, \Ttrace}, 0 \models P$ : a contradiction.
		
		
		\item If $i > 0$: we follow a very similar reasoning as for the case $i=0$.
		
	\end{itemize}	
	
%	
%	
%	in this case we conclude that for all $r \in P$ one of the following items hold
%		\begin{itemize}
%			\item if $r \in \initial{P}$ and  $a \in \Head{r}$ then either $\T, 0 \not \models \body{r}$ or $\T, 0 \models \Head{r} \setminus \lbrace a \rbrace$ 
%			\item if $r \in \dynamic{P}$ and  $a \in \Head{r}$ then either $\T, i \not \models \body{r}$ or $\T, i \models \Head{r} \setminus \lbrace a \rbrace$, for some $i > 0$.\footnote{\color{red}M: finish this part}
%		\end{itemize}	
		
	\item $\T, i \not \models a$ but $\T, i \models
	\ \bigvee_{r\in\initial{P}, a\in\Head{r}} (\initially\wedge S(r,a))
	\vee \bigvee_{r\in\dynamic{P}, a\in\Head{r}} (\neg\initially\wedge S(r,a))$: again, we consider two cases here
		\begin{itemize}
			\item there exists $r\in\initial{P}, a\in\Head{r}$ and  $\T, i \models \initially\wedge S(r,a)$: in this case, it follows that $i= 0$, so $\T, 0 \models a$ and $\T, 0 \models  S(r,a)$.
			Therefore, $\T, 0 \models \body{r}$.
			Since $\T, 0 \models r$ and $\T, 0 \models \body{r}$ then $\T, 0 \models p$ for some $p \in \Head{r}$, which contradicts 
			$\T, 0 \not \models a$ and $\T, 0 \models \neg q$ for all $p \in \Head{r} \setminus\lbrace a\rbrace$.
			
			\item there exists $r\in\dynamic{P}, a\in\Head{r}$ and  $\T, i \models  \neg \initially\wedge S(r,a)$: in this case we conclude that $i >0$ and so $\T, i \models a$ and $\T, i \models  S(r,a)$.
			Therefore, $\T, i \models \body{r}$.
			Since $\T, 0 \models r$ and $\T, i \models \body{r}$ then $\T, i \models q$ for some $q \in \Head{r}$.
			However, from $\T, i \models  S(r,a)$ and $\T, i \not \models a$ we conclude that $\T, i \not \models p$ for all $p \in \Head{r}$: a contradiction.
		\end{itemize}
		
\end{enumerate} 




For the converse direction, assume, again, by contradiction that $\tuple{\Ttrace,\Ttrace}$ is not a \TELf{} model of $P$.
We consider two cases:

\begin{enumerate}
	\item $\tuple{\Ttrace,\Ttrace},0 \not \models P$.
	Therefore, there exists $r \in P$ such that $\tuple{\Ttrace,\Ttrace}, 0 \not \models r$.
	Clearly, $r$ cannot be a constraint, otherwise we would already reach a contradiction.
	We still have to check two cases:
	\begin{itemize}
		\item If $r \in \initial{P}$, then $\tuple{\Ttrace,\Ttrace}, 0 \models \body{r}$ and $\tuple{\Ttrace,\Ttrace},0 \not \models \Head{r}$.
		Take any $a \in \Head{r}$. It follows that $\tuple{\Ttrace,\Ttrace}, 0 \models \initially \wedge S(r,a)$.
		so $\tuple{\Ttrace,\Ttrace}, 0 \not \models \tCFa{P}{a}$: a contradiction.
		\item If $r \in \dynamic{P}$ we follow a similar reasoning as for the previous case.
	\end{itemize}	

	\item $\tuple{\Ttrace,\Ttrace},0 \models P$ but $\tuple{\Htrace,\Ttrace}, 0 \models P$ for some $\Htrace < \Ttrace$.
	By definition, there exists $i \ge 0$ such that $H_i \subset T_i$. Let us take the smallest $i$ satisfying this property.
	Therefore, $H_j = T_j$ for all $\rangeco{j}{0}{i}$. 
	.Moreover, Let us take $a \in T_i\setminus H_i$ and let us proceed depending on the value of $i$
	
	\begin{itemize}
		\item If $i > 0 $ and $a \in T_i$ then $\tuple{\Ttrace,\Ttrace},i \models \tCFa{P}{a}$ then there exists $r \in \dynamic{P}$ such that $\tuple{\Ttrace,\Ttrace},i \models S(r,a)$.
			  Therefore $\Head{t} \setminus \lbrace a \rbrace \cup T_i = 0$
			  Since $a \not \in H_i$ then $\tuple{\Htrace,\Ttrace}, i \not \models \Head{r}$ and $\tuple{\Htrace,\Ttrace}, i \not \models \body{r}$.
			
			
			  At this point of the proof we have that $\tuple{\Ttrace,\Ttrace},i \models \body{r}$, $\tuple{\Htrace,\Ttrace},i \not\models \body{r}$ and $T_j\setminus H_j = \emptyset$ for any $j<i$.
	%\footnote{\color{red}M: check this paragraph}	
	By Lemma~\ref{lem:pastocc}, there must be some $b\in T_i\setminus H_i$ with a present and positive occurence
		in $\body{r}$ that is not in the scope of negation.
		Then, for any $a\in T_i\setminus H_i$, there is some $b\in T_i\setminus H_i$ such that $(a,b)\in G(\dynamic{P})$.
		$P$ is tight, so $G(\dynamic{P})$ is acyclic. Then, there is a topological ordering of the nodes in $G(\dynamic{P})$,
		and therefore of the atoms in $T_i\setminus H_i$, such that if $a,b \in T_i\setminus H_i$ and $(a,b)\in G(\dynamic{P})$,
		then $a$ appears before $b$ in the topoligical ordering.
		Then, there is no outgoing edge from the last node in the ordering, which contradict the fact that,
		for any $a\in T_i\setminus H_i$, there is some $b\in T_i\setminus H_i$ such that $(a,b)\in G(\dynamic{P})$.\\
		
		\item If $i = 0$ we proceed as in the previous case.
	\end{itemize}
	


\end{enumerate}


%{\color{red}
%
%
%
%It amounts to prove that $T,0 \models \tCF{P}$, that is, for all $a \in \A$ such that 
%
%
%
%
%	
%	
%	
%
%We first prove that, .
%It amounts to proving that
%$\tuple{\Ttrace,\Ttrace} \models  \{r\mid r\in \initial{P}\cup\dynamic{P}, \Head{r}=\bot\} \cup \final{P}$
%and
%$\tuple{\Ttrace,\Ttrace} \models        \{\alwaysF\big( a \leftrightarrow
%                \ \bigvee_{r\in\initial{P}, a\in\Head{r}} \initially\wedge S(r,a)
%        \vee \bigvee_{r\in\initial{P}, a\in\Head{r}} \neg\initially\wedge S(r,a)\big)
%		\mid a\in\A\}$.
%The first part follows from $\tuple{\Ttrace,\Ttrace}\models P$. To prove the second part we show that, for any $a\in\A$:
%\begin{itemize}
%    \item
%        $\tuple{\Ttrace,\Ttrace},0 \models a \leftrightarrow
%        \bigvee_{r\in\initial{P}, a\in\Head{r}}\big(\body{r}\wedge \bigwedge_{p\in \Head{r}\setminus \{a\}} \neg p\big)$ and,
%    \item
%        $\tuple{\Ttrace,\Ttrace},i \models a \leftrightarrow
%        \bigvee_{r\in\initial{P}, a\in\Head{r}}\big(\body{r}\wedge \bigwedge_{p\in \Head{r}\setminus \{a\}} \neg p\big)$
%        for all $\rangeo{i}{1}{\lambda}$.
%\end{itemize}
%
%%-----------------------------
%For the first item, we first prove that\\
%$\tuple{\Ttrace,\Ttrace},0 \models a \rightarrow
%\bigvee_{r\in\initial{P}, a\in\Head{r}}\big(\body{r}\wedge \bigwedge_{p\in \Head{r}\setminus \{a\}} \neg p\big)$.
%Lets assume that the implication isn't satisfied, i.e.,  $a\in T_0$ and there is no rule $ r\in\initial{P}$ with
%$a\in\Head{r}$ such that $\tuple{\Ttrace,\Ttrace},0\models \body{r}\wedge \bigwedge_{p\in \Head{r}\setminus \{a\}} \neg p$.
%Let \Htrace\ be a trace of length $\lambda$ such that $H_0=T_0\setminus\{a\}$ and $H_i=T_i$ for $\rangeo{i}{1}{\lambda}$.
%We show a contradiction by proving that $\tuple{\Htrace,\Ttrace}\models P$. $\tuple{\Htrace,\Ttrace}\models P$ iff
%\begin{enumerate}
%    \item
%        $\tuple{\Htrace,\Ttrace}\models \initial{P}$
%    \item
%        $\tuple{\Htrace,\Ttrace}\models \dynamic{P}$
%    \item
%        $\tuple{\Htrace,\Ttrace}\models \final{P}$
%\end{enumerate}
%
%\begin{enumerate}
%    \item
%        $\tuple{\Ttrace,\Ttrace}\models \initial{P}$, then $\tuple{\Ttrace,\Ttrace},0\models \body{r}\to\Head{r}$ for all $r\in\initial{P}$.
%        Iff, for any $r\in\initial{P}$, $\tuple{\Ttrace,\Ttrace},0\not\models \body{r}$ or $\tuple{\Ttrace,\Ttrace},0\models \Head{r}$.
%    If $\tuple{\Ttrace,\Ttrace},0\not\models \body{r}$ then, by persistence, $\tuple{\Htrace,\Ttrace},0\not\models \body{r}$, and $\tuple{\Htrace,\Ttrace},0\models \body{r}\to\Head{r}$.
%    If $\tuple{\Ttrace,\Ttrace},0\models \body{r}$, then $\tuple{\Ttrace,\Ttrace},0\models \Head{r}$. There is two case.
%    \begin{itemize}
%        \item
%            Case $a\not\in\Head{r}$:
%            $\tuple{\Ttrace,\Ttrace},0\models \Head{r}$ so there is some $p\in\Head{r}$ such that $p\in T_0$. $a\not\in\Head{r}$ so
%            $a\neq p$. Then, $p\in H_0$, $\tuple{\Htrace,\Ttrace},0\models \Head{r}$ and $\tuple{\Htrace,\Ttrace},0\models r$.
%        \item
%            Case $a\in\Head{r}$:
%            We know that $\tuple{\Ttrace,\Ttrace},0\not\models \body{r}\wedge \bigwedge_{p\in \Head{r}\setminus \{a\}} \neg p$.
%            We have already shown that, if $\tuple{\Ttrace,\Ttrace},0\not\models \body{r}$,
%            then $\tuple{\Htrace,\Ttrace},0\models r$.
%            If $\tuple{\Ttrace,\Ttrace}, 0\not\models  \bigwedge_{p\in \Head{r}\setminus \{a\}} \neg p$, there is
%            some $p\in\Head{r}\setminus\{a\}$ such that $p\in T_0$. Then $p\in H_0$, $\tuple{\Htrace,\Ttrace},0\models\Head{r}$ and $\tuple{\Htrace,\Ttrace},0\models r$.
%    \end{itemize}
%    As $r$ is chosen arbitrarily, $\tuple{\Htrace,\Ttrace}\models \initial{P}$.
%    \item
%        $\tuple{\Ttrace,\Ttrace}\models \dynamic{P}$, then $\tuple{\Ttrace,\Ttrace},i\models \body{r}\to\Head{r}$
%        for all $r\in\initial{P}$ and $\rangeo{i}{1}{\lambda}$. Then, for any $r\in\initial{P}$ and
%        $\rangeo{i}{1}{\lambda}$, $\tuple{\Ttrace,\Ttrace},i\not\models \body{r}$ or $\tuple{\Ttrace,\Ttrace},i\models \Head{r}$.
%        If $\tuple{\Ttrace,\Ttrace},i\not\models \body{r}$ then, by persistence, $\tuple{\Htrace,\Ttrace},i\not\models \body{r}$,
%        and $\tuple{\Htrace,\Ttrace},i\models r$.
%        If, $\tuple{\Ttrace,\Ttrace},i\models \Head{r}$, there is some $p\in\Head{r}$ such that $p\in T_i$.
%        $H_i = T_i$, so $p\in H_i$ and $\tuple{\Htrace,\Ttrace},i\models \Head{r}$.
%        Then $\tuple{\Htrace,\Ttrace},i\models r$. As $r$ and $i$ are chosen arbitrarily,
%        $\tuple{\Htrace,\Ttrace}\models \dynamic{P}$.
%
%    \item
%        Final rules are constraints, so $\tuple{\Ttrace,\Ttrace}\models \final{P}$ implies $\tuple{\Htrace,\Ttrace}\models \final{P}$.
%\end{enumerate}
%
%%--------
%Then, we prove that
%$\tuple{\Ttrace,\Ttrace},0 \models  \bigvee_{r\in\initial{P}, a\in\Head{r}}\big(\body{r}\wedge
%\bigwedge_{p\in \Head{r}\setminus \{a\}} \neg p\big) \rightarrow a$, for all $a\in\A$.
%
%$\tuple{\Ttrace,\Ttrace}\models \initial{P}$, so
%$\tuple{\Ttrace,\Ttrace},0 \models r$ for all $r\in\initial{P}$.
%Then, for any $a\in\A$
%$\tuple{\Ttrace,\Ttrace},0 \not\models \body{r}$ or $\tuple{\Ttrace,\Ttrace},0 \models a$ or
%$\tuple{\Ttrace,\Ttrace},0 \models \bigvee_{p\in \Head{r}\setminus \{a\}} p$,
%for all $r\in\initial{P}$ such that $a\in\Head{r}$.
%$\tuple{\Ttrace,\Ttrace},0 \models \bigvee_{p\in \Head{r}\setminus \{a\}} p$ iff
%$\tuple{\Ttrace,\Ttrace},0 \not\models \bigwedge_{p\in \Head{r}\setminus \{a\}} \neg p$,
%so $\tuple{\Ttrace,\Ttrace},0 \not\models \body{r}$ or $\tuple{\Ttrace,\Ttrace},0 \models a$ or
%$\tuple{\Ttrace,\Ttrace},0 \not\models \bigwedge_{p\in \Head{r}\setminus \{a\}} \neg p$,
%for all $r\in\initial{P}$ such that $a\in\Head{r}$.
%Then, $\tuple{\Ttrace,\Ttrace},0 \models \body{r} \wedge \bigwedge_{p\in \Head{r}\setminus \{a\}} \neg p \to a$
%for all $r\in\initial{P}$ such that $a\in\Head{r}$.
%Therefore,
%$\tuple{\Ttrace,\Ttrace},0 \models \bigwedge_{r\in\initial{P}, a\in\Head{r}}\big(\body{r} \wedge \bigwedge_{p\in \Head{r}\setminus \{a\}} \neg p \to a\big)$
%and $\tuple{\Ttrace,\Ttrace},0 \models \bigvee_{r\in\initial{P}, a\in\Head{r}}\big(\body{r} \wedge \bigwedge_{p\in \Head{r}\setminus \{a\}} \neg p\big) \to a$.
%
%%-----------------------------
%For the second item, we first prove that\\
%$\tuple{\Ttrace,\Ttrace},i \models a \rightarrow
%\bigvee_{r\in\dynamic{P}, a\in\Head{r}}\big(\body{r}\wedge \bigwedge_{p\in \Head{r}\setminus \{a\}} \neg p\big)$
%for all $\rangeo{i}{0}{\lambda}$.
%Lets assume that the implication isn't satisfied for some $\rangeo{i}{0}{\lambda}$, i.e.,
%$a\in T_i$ and there is no rule $ r\in\dynamic{P}$ with $a\in\Head{r}$ such that
%$\tuple{\Ttrace,\Ttrace},i\models \body{r}\wedge \bigwedge_{p\in \Head{r}\setminus \{a\}} \neg p$.
%Let \Htrace\ be a trace of length $\lambda$ such that $H_i=T_i\setminus\{a\}$ and $H_j=T_j$ for
%$\rangeo{j}{0}{\lambda}\setminus{i}$.
%We show a contradiction by proving that $\tuple{\Htrace,\Ttrace}\models P$. $\tuple{\Htrace,\Ttrace}\models P$ iff
%\begin{enumerate}
%    \item
%        $\tuple{\Htrace,\Ttrace}\models \initial{P}$
%    \item
%        $\tuple{\Htrace,\Ttrace}\models \dynamic{P}$
%    \item
%        $\tuple{\Htrace,\Ttrace}\models \final{P}$
%\end{enumerate}
%
%\begin{enumerate}
%    \item
%        $H_0=T_0$ and initial rules do not contain temporal operators. Then, $\tuple{\Ttrace,\Ttrace}\models \initial{P}$
%        implies $\tuple{\Htrace,\Ttrace}\models \initial{P}$.
%    \item
%        $\tuple{\Ttrace,\Ttrace}\models \dynamic{P}$, then $\tuple{\Ttrace,\Ttrace},j\models \body{r}\to\Head{r}$
%        for all $r\in\dynamic{P}$ and $\rangeo{j}{1}{\lambda}$. Iff, for any $r\in\dynamic{P}$ and
%        $\rangeo{j}{1}{\lambda}$, $\tuple{\Ttrace,\Ttrace},j\not\models \body{r}$ or $\tuple{\Ttrace,\Ttrace},j\models \Head{r}$.
%        If $\tuple{\Ttrace,\Ttrace},j\not\models \body{r}$ then, by persistence, $\tuple{\Htrace,\Ttrace},j\not\models \body{r}$, and $\tuple{\Htrace,\Ttrace},j\models \body{r}\to\Head{r}$.
%        If $\tuple{\Ttrace,\Ttrace},j\models \Head{r}$, there is some $p\in\Head{r}$ such that $p\in T_j$.
%        If $j\neq i$, then $H_j=T_j$ and $p\in H_j$. Then $\tuple{\Htrace,\Ttrace},j\models \Head{r}$.
%        If $j=i$ there is two case:
%        \begin{itemize}
%            \item
%            Case $a\not\in\Head{r}$:
%            Then, $p\neq a$, then $p\in H_j$ and $\tuple{\Htrace,\Ttrace},j\models \Head{r}$.
%
%            \item
%            Case $a\in\Head{r}$:
%            We know that $\tuple{\Ttrace,\Ttrace},i\models \body{r}\wedge \bigwedge_{p\in \Head{r}\setminus \{a\}} \neg p$.
%            We have already shown that, if $\tuple{\Ttrace,\Ttrace},i\not\models \body{r}$,
%            then $\tuple{\Htrace,\Ttrace},i\models \body{r}\to\Head{r}$.
%            If $\tuple{\Ttrace,\Ttrace}, i\not\models  \bigwedge_{p\in \Head{r}\setminus \{a\}} \neg p$, there is
%            some $p\in\Head{r}\setminus\{a\}$ such that $p\in T_i$. Then $p\in H_i$ and $\tuple{\Htrace,\Ttrace},i\models\Head{r}$.
%        \end{itemize}
%
%        In both cases $\tuple{\Htrace,\Ttrace},i\models \Head{r}$, then $\tuple{\Htrace,\Ttrace},i\models \body{r}\to\Head{r}$. As both $r$ and $i$ are chosen arbitrarily, $\tuple{\Htrace,\Ttrace}\models \dynamic{P}$.
%
%    \item
%        Final rules are constraints, so $\tuple{\Ttrace,\Ttrace}\models \final{P}$ implies $\tuple{\Htrace,\Ttrace}\models \final{P}$.
%\end{enumerate}
%
%%----------
%Then, we prove that
%$\tuple{\Ttrace,\Ttrace},i \models  \bigvee_{r\in\dynamic{P}, a\in\Head{r}}\body{r}\wedge
%                           \bigwedge_{p\in \Head{r}\setminus \{a\}} \neg p \rightarrow a$
%                           for all $\rangeo{i}{1}{\lambda}$ and all $a\in\A$.
%
%$\tuple{\Ttrace,\Ttrace}\models \dynamic{P}$, so
%$\tuple{\Ttrace,\Ttrace},i \models r$ for all $\rangeo{i}{1}{\lambda}$ and $r\in\dynamic{P}$.
%Then, for any $a\in\A$ and $\rangeo{i}{1}{\lambda}$,
%$\tuple{\Ttrace,\Ttrace},i \not\models \body{r}$ or $\tuple{\Ttrace,\Ttrace},i \models a$ or
%$\tuple{\Ttrace,\Ttrace},i \models \bigvee_{p\in \Head{r}\setminus \{a\}} p$,
%for all $r\in\dynamic{P}$ such that $a\in\Head{r}$.
%$\tuple{\Ttrace,\Ttrace},i \models \bigvee_{p\in \Head{r}\setminus \{a\}} p$ iff
%$\tuple{\Ttrace,\Ttrace},i \not\models \bigwedge_{p\in \Head{r}\setminus \{a\}} \neg p$,
%so $\tuple{\Ttrace,\Ttrace},i \not\models \body{r}$ or $\tuple{\Ttrace,\Ttrace},i \models a$ or
%$\tuple{\Ttrace,\Ttrace},i \not\models \bigwedge_{p\in \Head{r}\setminus \{a\}} \neg p$,
%for all $r\in\dynamic{P}$ such that $a\in\Head{r}$.
%Then, $\tuple{\Ttrace,\Ttrace},i \models \body{r} \wedge \bigwedge_{p\in \Head{r}\setminus \{a\}} \neg p \to a$
%for all $r\in\dynamic{P}$ such that $a\in\Head{r}$.
%Therefore,
%$\tuple{\Ttrace,\Ttrace},i \models \bigwedge_{r\in\dynamic{P}, a\in\Head{r}}\big(\body{r} \wedge \bigwedge_{p\in \Head{r}\setminus \{a\}} \neg p \to a\big)$
%and $\tuple{\Ttrace,\Ttrace},i \models \bigvee_{r\in\dynamic{P}, a\in\Head{r}}\big(\body{r} \wedge \bigwedge_{p\in \Head{r}\setminus \{a\}} \neg p\big) \to a$.\\
%
%
%%-----------------------------------------------------------------------------------------------
%For the other direction, we prove that, if \Ttrace\ is a \LTLf-model of \tCF{P}, then \Ttrace\ is a \TELf-model of $P$.
%We first show that $\tuple{\Ttrace,\Ttrace}\models P$:
%\begin{itemize}
%    \item
%        From $\tuple{\Ttrace,\Ttrace}\models \tCF{P}$, we have that
%        $\tuple{\Ttrace,\Ttrace},i \models  \bigvee_{r\in\dynamic{P}, a\in\Head{r}}(\body{r}\wedge
%        \bigwedge_{p\in \Head{r}\setminus \{a\}} \neg p) \rightarrow a$ for all $a\in\A$,
%        and $\tuple{\Ttrace,\Ttrace},i \models r$ for all $r\in \dynamic{P}$ such that $\Head{r}=\bot$
%        for all $\rangeo{i}{1}{\lambda}$.
%        $\tuple{\Ttrace,\Ttrace},i \models  \bigvee_{r\in\dynamic{P}, a\in\Head{r}}(\body{r}\wedge
%        \bigwedge_{p\in \Head{r}\setminus \{a\}} \neg p) \rightarrow a$, so
%        $\tuple{\Ttrace,\Ttrace},i \models \body{r}\wedge \bigwedge_{p\in \Head{r}\setminus \{a\}} \neg p \rightarrow a$
%        for all $r\in\dynamic{P}$ such that $a\in\Head{r}$, iff
%        $\tuple{\Ttrace,\Ttrace},i \not\models \body{r}$ or $\tuple{\Ttrace,\Ttrace},i \models a$ or
%        $\tuple{\Ttrace,\Ttrace},i \not\models \bigwedge_{p\in \Head{r}\setminus \{a\}} \neg p$, iff
%        $\tuple{\Ttrace,\Ttrace},i \not\models \body{r}$ or $\tuple{\Ttrace,\Ttrace},i \models a$ or
%        $\tuple{\Ttrace,\Ttrace},i \models \bigvee_{p\in \Head{r}\setminus \{a\}} p$, iff
%        $\tuple{\Ttrace,\Ttrace},i \models r$.
%        Then, we have that for any $\rangeo{i}{1}{\lambda}$,
%        $\tuple{\Ttrace,\Ttrace},i \models r$ for all $r\in\dynamic{P}$ such that $\Head{r}=\bot$ or $a\in\Head{r}$, for all $a\in\A$,
%        which is equivalent to $\tuple{\Ttrace,\Ttrace}\models \dynamic{P}$.
%
%    \item
%    %     From $\tuple{\Ttrace,\Ttrace}\models \tCF{P}$, we have that
%    %     $\tuple{\Ttrace,\Ttrace},0 \models  \bigvee_{r\in\initial{P}, a\in\Head{r}}(\body{r}\wedge
%    %     \bigwedge_{p\in \Head{r}\setminus \{a\}} \neg p) \rightarrow a$ for all $a\in\A$,
%    %     and $\tuple{\Ttrace,\Ttrace},0 \models r$ for all $r\in \initial{P}$ such that $\Head{r}=\bot$.
%    %     $\tuple{\Ttrace,\Ttrace},0 \models  \bigvee_{r\in\initial{P}, a\in\Head{r}}(\body{r}\wedge
%    %     \bigwedge_{p\in \Head{r}\setminus \{a\}} \neg p) \rightarrow a$, so
%    %     $\tuple{\Ttrace,\Ttrace},0 \models \body{r}\wedge \bigwedge_{p\in \Head{r}\setminus \{a\}} \neg p \rightarrow a$
%    %     for all $r\in\initial{P}$ such that $a\in\Head{r}$, iff
%    %     $\tuple{\Ttrace,\Ttrace},0 \not\models \body{r}$ or $\tuple{\Ttrace,\Ttrace},0 \models a$ or
%    %     $\tuple{\Ttrace,\Ttrace},0 \not\models \bigwedge_{p\in \Head{r}\setminus \{a\}} \neg p$, iff
%    %     $\tuple{\Ttrace,\Ttrace},0 \not\models \body{r}$ or $\tuple{\Ttrace,\Ttrace},0 \models a$ or
%    %     $\tuple{\Ttrace,\Ttrace},0 \models \bigvee_{p\in \Head{r}\setminus \{a\}} p$, iff
%    %     $\tuple{\Ttrace,\Ttrace},0 \models r$.
%    %     Then, we have that
%    %     $\tuple{\Ttrace,\Ttrace},0 \models r$ for all $r\in\dynamic{P}$ such that $\Head{r}=\bot$ or $a\in\Head{r}$, for all $a\in\A$,
%    %     which is equivalent to $\tuple{\Ttrace,\Ttrace}\models \initial{P}$.
%          Similarly, we get $\tuple{\Ttrace,\Ttrace}\models \initial{P}$ from $\tuple{\Ttrace,\Ttrace}\models \tCF{P}$.
%
%    \item
%        $\tuple{\Ttrace,\Ttrace}\models \final{P}$ follows directly from $\tuple{\Ttrace,\Ttrace}\models \tCF{P}$.
%
%\end{itemize}
%
%Then we show that there is no $\Htrace < \Ttrace$ such that $\tuple{\Htrace,\Ttrace}\models P$.
%Let assume that there is such a trace $\Htrace$, and let $i$ be the smallest time point such that $H_i\subset T_i$.\\
%
%Case $i>0$:
%Let $a\in T_i\setminus H_i$. $\tuple{\Ttrace,\Ttrace}\models \tCF{P}$, so $\tuple{\Ttrace,\Ttrace},i \models a \leftrightarrow
%\bigvee_{r\in\dynamic{P}, a\in\Head{r}}(\body{r}\wedge\bigwedge_{p\in \Head{r}\setminus \{a\}} \neg p)$.
%Then, as $a\in T_i$, there is some rule $r\in\dynamic{P}$ such that $a\in\Head{r}$,
%$\tuple{\Ttrace,\Ttrace},i \models \body{r}$, and $\tuple{\Ttrace,\Ttrace},i \models \bigwedge_{p\in \Head{r}\setminus \{a\}} \neg p$.
%$\tuple{\Htrace,\Ttrace}\models P$, so $\tuple{\Htrace,\Ttrace},i \models \body{r} \rightarrow a \vee\bigvee_{p\in\Head{r}\setminus\{a\}} p$
%for all $r\in\dynamic{P}$ such that $a\in\Head{r}$.
%Then, $\tuple{\Htrace,\Ttrace},i \not\models \body{r}$ or $\tuple{\Htrace,\Ttrace},i \models a$ or
%$\tuple{\Htrace,\Ttrace},i \models \bigvee_{p\in\Head{r}\setminus\{a\}} p$.
%As $a\not\in H_i$, $\tuple{\Htrace,\Ttrace},i \not\models a$.
%As $\tuple{\Ttrace,\Ttrace},i \models \bigwedge_{p\in \Head{r}\setminus \{a\}} \neg p$,
%$\tuple{\Htrace,\Ttrace},i \not\models \bigvee_{p\in\Head{r}\setminus\{a\}} p$.
%So, $\tuple{\Htrace,\Ttrace},i \not\models \body{r}$.
%
%$\tuple{\Ttrace,\Ttrace},i \models \body{r}$, $\tuple{\Htrace,\Ttrace},i \not\models \body{r}$ and $T_j\setminus H_j = \emptyset$ for $j<i$.
%So, by Lemma~\ref{lem:pastocc}, there must be some $b\in T_i\setminus H_i$ with a present and positive occurence
%in $\body{r}$ that is not in the scope of negation.
%Then, for any $a\in T_i\setminus H_i$, there is some $b\in T_i\setminus H_i$ such that $(a,b)\in G(\dynamic{P})$.
%$P$ is tight, so $G(\dynamic{P})$ is acyclic. Then, there is a topological ordering of the nodes in $G(\dynamic{P})$,
%and therefore of the atoms in $T_i\setminus H_i$, such that if $a,b \in T_i\setminus H_i$ and $(a,b)\in G(\dynamic{P})$,
%then $a$ appears before $b$ in the topoligical ordering.
%Then, there is no outgoing edge from the last node in the ordering, which contradict the fact that,
%for any $a\in T_i\setminus H_i$, there is some $b\in T_i\setminus H_i$ such that $(a,b)\in G(\dynamic{P})$.\\
%
%Case $i=0$: we reach a contradiction in a similar way as above.\\
%
%}
\end{proofof}
