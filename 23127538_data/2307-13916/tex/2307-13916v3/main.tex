\documentclass[11pt, letterpaper]{article}
\pdfoutput=1
\usepackage[authoryear]{natbib}
\usepackage{amsmath,amssymb,amsfonts,amsthm,bbm}
\usepackage{epic,eepic,epsfig,longtable}
\usepackage{multirow,verbatim}
\usepackage{array}

\usepackage{epsfig}
% \usepackage{euler}
\usepackage{setspace}
%\usepackage{CJK}
%\usepackage{color}
% \usepackage{tikz}
% \usetikzlibrary{arrows,positioning}
\usepackage{pb-diagram}
\usepackage{fancyhdr}
\usepackage{graphicx}
\usepackage[title]{appendix}
%\usepackage{appendix}
\usepackage{listings}
\usepackage{longtable}
\usepackage{url}
\usepackage{lineno}
%\usepackage{hyperref}       % hyperlinks
%\hypersetup{
%  colorlinks = true,
%  urlcolor = blue,
%  linkcolor = blue,
%  citecolor = blue,
%}
%\usepackage{subfigure}
\usepackage{mathrsfs}
\usepackage{stmaryrd}
\usepackage{appendix}
\usepackage{algorithmic}
\usepackage{algorithm}


%\renewcommand{\algorithmicrequire}{\textbf{Input:}}
%\renewcommand{\algorithmicensure}{\textbf{Output:}}

%\providecommand{\abs}[1]{\left\lvert#1\right\rvert}
%\providecommand{\norm}[1]{\left\lVert#1\right\rVert}
\newcommand\blfootnote[1]{%
  \begingroup
  \renewcommand\thefootnote{}\footnote{#1}%
  \addtocounter{footnote}{-1}%
  \endgroup
}

%%%%%%%%%% page setup %%%%%%%%%%
\textheight 8.5 in
\textwidth 6.5 in
\topmargin -0.5 in
\oddsidemargin -0.1 in
\renewcommand{\topfraction}{1}
\renewcommand{\bottomfraction}{1}
\renewcommand{\textfraction}{0}
\renewcommand{\floatpagefraction}{0.90}
\makeatletter
\def\singlespace{\def\baselinestretch{1}\@normalsize}
\def\endsinglespace{}
\renewcommand{\topfraction}{1}
\renewcommand{\bottomfraction}{1}
\renewcommand{\textfraction}{0}
\renewcommand{\floatpagefraction}{0.90}
\makeatletter
\def\singlespace{\def\baselinestretch{1}\@normalsize}
\def\endsinglespace{}

%%%%%%%%%% numbering %%%%%%%%%%
%\renewcommand{\theequation}{\thesection.\arabic{equation}}
%\numberwithin{equation}{section}
%\renewcommand{\thefootnote}{\fnsymbol{footnote}}
%\renewcommand{\hat}{\widehat}
\def\c{\centerline}

%\renewcommand{\hat}{\widehat}

%\newcommand{\bfm}[1]{\ensuremath{\mathbf{#1}}}

\allowdisplaybreaks
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\setcounter{section}{0}
\def\thesection{\arabic{section}}
\setcounter{page}{1}
% \pagestyle{myheadings}
\usepackage{verbatim}
\pagestyle{plain}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\renewcommand{\baselinestretch}{1.66}
\baselineskip=22pt


%%%%%%%%%%%%%%%%%%%% more definitions %%%%%%%%%%%%%%%%%%%%

\numberwithin{equation}{section}
\theoremstyle{plain}
\newtheorem{thm}{Theorem}[section]
\newtheorem{claim}{Claim}[section]
\newtheorem{defn}{Definition}[section]
\newtheorem{lem}{Lemma}[section]
\newtheorem{cor}{Corollary}[section]
\newtheorem{prop}{Proposition}[section]
\newtheorem{ass}{Assumption}[section]
\newtheorem{fact}{Fact}[section]
\theoremstyle{definition}
\newtheorem{exm}{Example}[section]
\newtheorem{rem}{Remark}[section]


\newcounter{CondCounter}
\newenvironment{con}{
	\refstepcounter{CondCounter} % increment the environment's counter
	(C\theCondCounter)}{\par} % move to the next line


\usepackage{mystyle}
\date{\vspace{-5ex}}


%%%%%%%%%%%%%%%%%%%%%%%%% document starts here %%%%%%%%%%%%%%%%%%%%%%%%%

\makeatother

\begin{document}
% \renewcommand{\baselinestretch}{1.2}

\title{Online learning in bandits with predicted context}

\author{Yongyi Guo\thanks{Department of Statistics, University of Wisconsin-Madison, Madison, WI, 53706. Email: \texttt{guo98@wisc.edu}.}
\and Ziping Xu\thanks{Department of Statistics, Harvard University, Cambridge, MA, 02138. Email: \texttt{zipingxu@fas.harvard.edu}.}
\and Susan Murphy\thanks{Department of Statistics, Harvard University, Cambridge, MA, 02138. Email: \texttt{samurphy@g.harvard.edu}.}
}

%\date{\today}

\maketitle
\onehalfspacing

\begin{abstract}
We consider the contextual bandit problem where at each time, the agent only has access to a noisy version of the context and the error variance (or an estimator of this variance). This setting is motivated by a wide range of applications where the true context for decision-making is unobserved, and only a prediction of the context by a potentially complex machine learning algorithm is available. When the context error is non-vanishing, classical bandit algorithms fail to achieve sublinear regret. We propose the first online algorithm in this setting with sublinear regret guarantees under mild conditions. The key idea is to extend the measurement error model in classical statistics to the online decision-making setting, which is nontrivial due to the policy being dependent on the noisy context observations. We further demonstrate the benefits of the proposed approach in simulation environments based on synthetic and real digital intervention datasets.
\end{abstract}

\input{main_body}

\input{sec_simulation}


\newpage 
\bibliographystyle{ims}
\bibliography{rl_aistats}
\newpage

\input{supplement}

%\appendix
%\begin{appendices}
%\input{appendix}

%\end{appendices}


\end{document}
