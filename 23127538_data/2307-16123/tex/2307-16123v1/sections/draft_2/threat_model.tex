\section{Threat Model}
\label{sec:threat_model}

%TODO: include security status of the targeted system
% what is enabled? what is disabled? what defense mechanisims it assumes?

Our threat model is for a cross-processor covert channel attack in Intel-based SoC (from iGPU to CPU). In a covert channel, two processes (a trojan as a sender and a spy as a receiver) communicate covertly using a shared resource. The spy runs on a CPU core and the trojan process (from another CPU core) launches the kernel through user-level OpenCL API calls to run on iGPU. Both spy and trojan need to execute on the same machine and share the MC. We assume these processes are separate user space processes and do not require any privileged support. Also, there is no shared data between spy and trojan processes.

MC serves read and write memory requests from read and write buffers. Sharing of other architectural and micro-architectural resources other than the MC is not required in our attack. Also, it is not required for CPU cores and iGPU to share the same cache as long as the same MC is serving memory requests.
%Although sharing such resources (such as LLC in Intel-based SoCs) would introduce another level of contention, we show that the contention we observe in our attack is mainly introduced on the shared memory controller resources.
Our attack targets SoCs with a single MC with dual channels which is the common case with most SoCs in desktop, workstation, and mobile processor chips \cite{gen7.5, gen9, gen11, intel_uhd, arm_npu1, snapdragon_660, qualcomm_660}. All memory requests from the CPU and iGPU are routed through this shared MC from the cache write-back buffer. We exploit the write buffer within the shared MC to develop our covert channel attack variants.

%\hoda{Ghadeer, how common is this to have just one memory controller in Intel SoCs? Is there one memory channel in your system? We should mention details of DRAM (number of channels,  size, ... here. Please write all details here.}
\begin{comment}
We also present a proof-of-concept side channel attack, in which a spy process running on a CPU core, monitors the contention on the write buffer to leak sensitive information about a victim process that is running on iGPU.
\end{comment}
%All of our experiments are implemented on a Comet Lake i7-10700K desktop processor, which features an integrated Intelâ€™s Gen9 UHD 630 Graphics \cite{proc_spec}. We use OpenCL version 2.1 running Ubuntu 20.04.1 LTS with linux kernel 5.13.
%\hoda{complete the blank spaces.}

Our attacks are developed and tested on an unmodified system. Current Intel iGPUs are not capable of running multiple computation kernels from separate contexts concurrently and therefore no noise is expected on the GPU side. Figure \ref{fig:threat-model} demonstrates our covert channel threat model.


%The attacker exploited a vulnerability in a targeted process and now can execute code as part of this process execution. The attacker aim to leak information from attacked process (trojan process) to spy process which is also running on the same processor chip. 
% Figure environment removed