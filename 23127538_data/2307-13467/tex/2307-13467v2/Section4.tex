%!TEX root = jsac_v6.tex


\vspace{-0.3cm}
\section{Numerical Analysis}
The analysis presented above highlights that the mutual coupling effects resulting from closely spaced antennas can potentially provide benefits to the uplink spectral efficiency in single-user and multi-user Holographic MIMO systems, depending on the specific propagation conditions. However, it is important to note that these conditions may not be met in practical network scenarios, and therefore the average gains may be marginal or even non-existent. The analysis focused on a simplified uplink case study with two antennas, two UEs, and single-path LoS propagation. Next, the numerical analysis is expanded to more realistic scenarios, including a larger number of antennas, multiple UEs, and different propagation conditions. Additionally, the analysis considers the case of densely packed antennas in a space-constrained form factor. By exploring these scenarios, a more comprehensive understanding of the benefits of mutual coupling in Holographic MIMO systems can be obtained.

% We assume that the BS is located at a height of $10$~m. The communication takes places over a bandwidth of $B = 20$~MHz, with the total receiver noise power σ2 = −87 dBm. Each UE transmits with power pk = 20 dBm ∀k. We assume a carrier frequency of f0 = 28GHz such that λ = 10.71mm, NH = 62, and NV = 42, to focus on a 5G hot-spot scenario. When relevant, throughout the letter, we also consider higher carrier frequencies that cover future use cases and scenarios.


The key parameters of the system are those reported in Table~\ref{tab:array_parameters}. Unless otherwise stated, we consider a scenario with single-path LoS propagation, where the BS is positioned at a height of $10$~m. The azimuth angle of each UE is randomly distributed within the sector $[-\pi/2, \pi/2]$ while the elevation angle depends on the distance from the BS. The UEs are randomly dropped at a minimum distance of $15$~m and a maximum distance of $150$~m from the BS, and they transmit with the same power. The results are obtained by averaging over $1000$ UE drops. Due to space limitations, our main emphasis is on the uplink but we put a specific focus on addressing the duality issue in the downlink. Moreover, we still focus on line-of-sight propagation but notice that similar results can be obtained with different channel models, e.g., based on stochastic approaches. The Matlab code that will be made available upon completion of the review process can be used to generate the omitted results.
% Figure environment removed

\subsection{Fixing the Number of Antennas while Varying Array Size}

% \textcolor{red}{Uniformare le label dell'asse Y nelle figure 10.a e 10.b. In particolare, fare attenzione al fatto che, anche in altre figure, alcune volte l'efficienza spettrale viene indicata in [bit/s/Hz] altre volte in [bit/s/Hz/cell].}

Fig.~\ref{fig:SE_vs_dH_K10_M16,64} illustrates the average SE per UE in the uplink as a function of $d_H/\lambda$ for two different antenna configurations: $M_{\rm BS}=16$ and $M_{\rm BS}=64$, with a fixed number of UEs, $K=10$. The results show that, \textit{when the number of antennas is fixed, reducing the antenna spacing generally has a negative impact on the average SE}. Optimal performance is observed for $d_H/\lambda > 0.5$, where the advantages of mutual coupling 
% \textcolor{red}{Cosa ci aspettiamo in assenza di coupling? È realmente significativo il coupling quando $d_H = \lambda$? Dalla figura 3 sembrerebbe che per $d_H = \lambda$ non ci sia accoppiamento.}  \textcolor{blue}{Una minima differenza rispetto a $\lambda/2$ c'e'.} 
and holographic MIMO become more pronounced. In this range, employing a full matching network yields only a marginal gain compared to the self-impedance matching design. However, a significant decrease in SE occurs when no matching network is utilized. Additionally, as expected, increasing the number of antennas results in higher SE due to enhanced interference rejection capabilities. Similar conclusions can be drawn from Figure~\ref{fig:SE_vs_dH_M32_K8,24}, where the number of antennas is fixed at $M_{\rm BS}=32$, while the number of UEs is varied between $K=10$ and $K=30$.
% \textcolor{red}{La figura 10.b la farei solamente con la full matching network, per K = 8, 16, 24. Direi che nei casi SI matching network o senza matching network le conclusioni sono le stesse della figura 10.a.} \textcolor{blue}{Per me va bene. Mi sembrava pero interessante far vedere che all'aumentare di $K$ il gap con SI matching e senza matching diminuisce. Nel senso che sono meno importanti quando $K$ si avvicina ad $M_{\rm BS}$.}
The curves in Fig.~\ref{fig:SE_vs_dH_K10_M16,64} were obtained with $R_{\rm d} =10^{-3} R_{\rm r}$. Numerical results (not reported for space limitations) show that the SE worsens as $R_{\rm d}$ increases but similar behaviors can be observed. We also notice that the effect of $R_{\rm d}$ is more significant for $d_H < \lambda/2$ while a marginal impact is observed for large antenna spacings (i.e, $d_H > \lambda/2$).

% Figure environment removed

% Fig.~\ref{fig:SE_vs_dH_K10_M16,64} illustrates the average SE per UE as a function of $d_H/\lambda$ for two different numbers of antennas, $M_{\rm BS}=16$ and $M_{\rm BS}=64$, with a fixed number of UEs, $K=10$. The results confirm that reducing the antenna spacing generally has a negative impact on the average SE. The best performance is observed for $d_H/\lambda > 0.5$, where the benefits of mutual coupling and holographic MIMO are more pronounced. In this regime, the use of a full matching network provides only a marginal gain compared to the self-impedance matching design. However, a significant loss in SE is incurred when no matching network is employed. Furthermore, as expected, an increase in the number of antennas leads to higher spectral efficiency due to improved interference rejection capabilities. Similar conclusions can be drawn from Fig.~\ref{fig:SE_vs_dH_M32_K10,30} where the number of antennas is fixed to $M_{\rm BS}=32$ while the number of UEs is $K=10$ or $30$ 


% Fig.~\ref{fig:SE_vs_dH_K10_M16,64} shows the average SE per UE as a function of $d_H/\lambda$ for $M_{\rm BS}=16$ and $M_{\rm BS}=64$. The number of UEs is $K=10$. The results confirm that reducing the antenna spacing has on average a negative effect on the spectral efficiency. The best performance is obtained for $d_H/\lambda > 0.5$, so that a full matching network provides a negligible gain compared to the self-impedance design. A considerable loss is incurred if no matching network is used. As expected, an increase in the number of antennas results in a larger SE due to a better capability to reject the interference. Similar conclusions can be drawn from Fig.~\ref{fig:SE_vs_dH_M32_K10,30} where the number of antennas is fixed to $M_{\rm BS}=32$ while the number of UEs is $K=10$ or $30$.   


\subsection{Fixing the Array Size while Varying the Number of Antennas}

Fig.~\ref{fig:SE_vs_dH_Lfixed} illustrates the average SE per UE in the uplink as a function of $d_H/\lambda$ for a fixed array size $L_H = 6 \lambda$. Both MR and MMSE receivers exhibit similar SE behaviors. Notably, when a full matching network is employed, SE increases as $d_H/\lambda$ decreases due to the augmented number of antennas $M_{\rm BS}=L_H/d_H + 1$. This increase in antennas contributes to higher array gain and improved interference rejection. However, without a matching network or with a self-impedance matching network, the optimal performance is achieved when $d_H/\lambda \approx 0.4$. Going below this value may result in a decrease in SE. It is important to emphasize that the SE improvement observed when reducing $d_H$ with a full matching network cannot be attributed to antenna coupling. This can be clearly seen in Figure~\ref{fig:ChannelGain_vs_dH_Lfixed}, which displays the channel gain per antenna using MMSE, corresponding to the same simulation scenario as in Figure~\ref{fig:SE_vs_dH_Lfixed}. The results demonstrate that bringing the antennas closer to each other in Holographic MIMO systems can have adverse effects on the channel gain, even when employing a full matching strategy. This is evident from the declining trend of the channel gain as the antenna spacing decreases.



Fig.~\ref{SE_vs_dH_K10_LH61224} shows the average SE per UE as a function of $d_H/\lambda$ for three different values of the array size $L_H$. The number of UEs is $K=10$ and an MMSE combiner is employed, with either full noise or SI matching networks. As can be seen from the results, the behavior is the same irrespective of the array size. We only observe that, moving the antennas close to each other, the gain reduces as $L_H$ increases. In particular, when $L_H=6 \lambda$ and a full matching network is used, for $d_H=\lambda/10$ the average SE is about $4 \operatorname{bit/s/Hz}$ and drops to about $2 \operatorname{bit/s/Hz}$ for $d_H=\lambda$, with a ratio of 2 between the two values. On the other hand, when $L_H=24 \lambda$ the ratio decreases to about $6/4.5 \approx 1.33$. Essentially, this means that the positive effects of packing the antennas close to each other is greater for smaller antenna sizes.   

% Fig.~\ref{fig:SE_vs_dH_Lfixed} shows SE as a function of $d_H/\lambda$ for a fixed array size $L_H = 6 \lambda$. As can be seen, the spectral efficiency has similar behaviors with both MR and MMSE receivers. In particular, we observe that with a full matching network SE increases as $d_H/\lambda$ decreases, due to the increase in the number of antennas $M_{\rm BS}=L_H/d_H + 1$. This has beneficial effects on the the array gain (which increases with $M_{\rm BS}$) and interference rejection. On the other hand, without matching network or with a self-impedance matching network the best performance is attained for $d_H/\lambda \approx 0.4$, and decreasing $d_H/\lambda$ below this value may result in some losses in terms of spectral efficiency.

% It is worth pointing out that the increase in SE when $d_H$ is reduced, observed with a full matching network, cannot be attributed to the coupling between the antennas. This can be appreciated with the aid of Fig.~\ref{fig:ChannelGain_vs_dH} where we report the channel gain per antenna, with MMSE, in the same simulation scenario of Fig.~\ref{fig:SE_vs_dH_Lfixed}. Indeed, the results demonstrate that moving the antennas close to each other in Holographic MIMO systems can have detrimental effects on the channel gain, even when using a full matching strategy. This is evident from the decreasing trend of the channel gain as the antenna spacing decreases. 

% Figure environment removed


% \subsection{Impact of Array and System Parameters}
% The results of Fig. ... have been obtained with $\zeta = R_d /R_r =10^{-3}$. To show the impact of $R_d$ on the system performance, in Fig. 11a and 11.b we report the spectral efficiency, for different values of $\zeta$. The number of UEs is $K=10$. In particular, Fig. 11a shows SE as a function of $d_H/\lambda$ for a fixed number of antennas, namely $M_{\rm BS}=32$, whereas in Fig. 11b the array size is $L_H=6/\lambda$ and the number of antennas vary according to $M_{\rm BS} = L_H/d_H+1$. The results of ...


% \subsection{Impact of Dissipation Resistance}
% To assess the effects of the dissipation resistance on the system performance, in Fig.~\ref{fig:SE_vs_dH_5zeta} we plot the average sum SE as a function of the antenna spacing for different values of $\zeta=R_{\rm d}/R_{\rm r}$.\textcolor{blue}{e' stata ottenuta con $M_{\rm BS}=32$ e $K=10$.} \textcolor{red}{Riportare i valori dei parametri con cui sono state ottenute le curve.} As expected, performance worsens as $R_{\rm d}$ increases. However, as can be seen the effects of $R_{\rm d}$ are more significant for $d_H < \lambda/2$ while a marginal impact is observed for large antenna spacings (i.e, $d_H > \lambda/2$).


% The spatial correlation matrix of UE $k$ is modelled according to~\eqref{eq:spatial-correlation} , e.g.,~\cite[Sec. 2.6]{massivemimobook}, with $f_k(\theta, \phi)$ being the joint probability density function of the azimuth angle $\theta$ and elevation angle $\phi$. We assume that $\theta = \theta_k + \delta_\theta$, $\phi = \phi_k + \delta_\phi$ where $\delta_\theta$ $\delta_\phi$ are random deviations from the nominal angles $\theta_k$ and $\phi_k$, uniformly distributed with standard deviations $\sigma^2_{\theta}$ and $\sigma_{\phi}$.




% % Figure environment removed


\subsection{Impact of uplink and downlink duality}
We now consider the downlink with MMSE precoding, and with either a full or an SI matching network. From Table~\ref{tab:duality} it is seen that, with a full matching network, ${\bf h}_k^{\rm ul}$ and ${\bf h}_k^{\rm dl}$ differ only for a scaling factor. Accordingly, it is correct to design the MMSE precoder in downlink by using the measured value of ${\bf h}_k^{\rm ul}$ in uplink. On the other hand, when an SI matching network is employed, the uplink-downlink channel duality requires to apply a linear transformation to ${\bf h}_k^{\rm ul}$. A performance loss is incurred if this is not done.



Fig.~\ref{fig:SE_vs_dH_M32K8_DownLink} shows the average SE per UE in the same setup of Fig.~\ref{fig:SE_vs_dH_M32_K8,24}, i.e., with $M_{\rm BS} = 32$ antennas and $K = 8 $ UEs. We see that, with a full matched network, the performance in uplink and downlink is the same. As for the SI matching design, two different cases have been considered. In the first case, the MMSE precoder is computed by using ${\bf h}_k^{\rm ul}$ instead of ${\bf h}_k^{\rm dl} = \dfrac {\alpha_{\rm dl}} {\alpha_{\rm ul}} {\bf B}_{\rm dl}^{-\Ttran/2}{\bf A}_{\rm dl,ul}{\bf h}_k^{\rm ul}$, as indicated in Table~\ref{tab:duality}. In the second case, the MMSE precoder is correctly computed taking the matrix ${\bf B}_{\rm dl}^{-\Ttran/2}{\bf A}_{\rm dl,ul}$ into account. Comparing the results in Fig.~\ref{fig:SE_vs_dH_M32K8_DownLink} with those in 
Fig.~\ref{fig:SE_vs_dH_M32_K8,24}, we see that in the latter case the average SE is the same in uplink and downlink, while a considerable loss is observed in the former case (thicker line), especially at low values of $d_H/\lambda$. The same conclusions can be drawn from Fig.~\ref{fig:SE_vs_dH_Lh6K10_DownLink}, obtained in the simulation setting of Fig.~\ref{SE_vs_dH_K10_LH61224}, which shows the average SE per UE for a fixed size $L_H = 6 \lambda$ of the array and $K=10$.


% Figure environment removed