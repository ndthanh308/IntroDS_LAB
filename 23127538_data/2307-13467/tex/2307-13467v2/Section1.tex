 %!TEX root = jsac_v6.tex
\section{Introduction} 
Communication theorists are always on the lookout for new technologies to improve the speed and reliability of wireless communications. Chief among the technologies that blossomed into major advances is the multiple antenna technology, whose latest implementation is Massive MIMO (multiple-input multiple-output)~\cite{marzetta2010noncooperative, massivemimobook}. Inspired by its potential benefits~\cite{sanguinettiTCOM2020}, new research directions are taking place under different names~\cite{BJORNSON20193}, e.g., Holographic MIMO~\cite{Huang2020} and large intelligent surfaces~\cite{Rusek2018}. Particularly, the former concept refers to an array (possibly \emph{electromagnetically large}, i.e., compared to the wavelength) with a massive number of closely spaced antennas whose electromagnetic interactions inevitably results into mutual coupling~\cite{balanis}. Although few exceptions exist, e.g., \cite{7831497,6843218,8350292,9048753,9838533}, the vast majority of the MIMO literature has entirely neglected mutual coupling since it is all about using (possibly \emph{physically large}) arrays with \emph{half-wavelength} antenna spacing~\cite{massivemimobook}. Another major caveat of the classical MIMO literature (in general) is that it mostly relies on the abstractions of signal processing and information theories, which are not always consistent with the physical context of the underlying system.  
Fortunately, there exists a thin, but solid, literature that can be used to overcome these limitations~\cite{Janaswamy2002,Svantesson_ICASSP2001,Wallace2004,Nossek2010,Nossek2014} but its development has been relatively slow due to the less tractable analysis.
% Unfortunately, its important insights and messages are easily missed since they are a minor fraction compared to the vast literature that neglects it. 
% The primary objectives of this paper are two fold: $i$) to help (among others) in bringing to the attention of MIMO communications theorists such line of research; and $ii$) to use it for understanding
% the effects of having closely spaced antennas in the uplink and downlink of multi-user
% Holographic MIMO communications. To the best of authors knowledge, a comprehensive treatment in this direction is currently missing in the relevant literature.

% \subsection{Motivation and relevant literature} 
 The first attempts in this direction can be found in~\cite{Janaswamy2002,Svantesson_ICASSP2001,Wallace2004}. Particularly, in~\cite{Wallace2004} the authors derived the model of a single-user MIMO communication system as an electrical network described by scattering matrices. This allows to account for the mutual coupling between transmit and/or receive antennas. A matching network was also introduced at the receiver to maximize the power transfer from the source to the loads. The framework developed in~\cite{Wallace2004} is also among the first to connect the physical power to the abstract concept used in signal and information theories. An alternative framework is developed in~\cite{Nossek2010,Nossek2014} based on the multiport communication theory. This involves a circuit theoretic approach where the inputs and outputs of the multiple antenna communication system are associated with ports of a multi-port black-box, described by impedance matrices. Notice that the two frameworks above are almost equivalent (except for constructed special cases) and the multiport communication theory has been used in the MIMO literature to study several aspects. 
 %The authors in \cite{Wallace2004} found the use of scattering matrices more convenient for capacity computation. \textcolor{red}
 {For example, in~\cite{yordanov2009arrays,Ivrlac2009ICC,Laas2020} the transmit/receive array gain is evaluated (with and without matching networks) for uniform linear and circular arrays. The diversity gain is investigated in \cite{ivrlavc2011diversity}, while the effects of the antenna separation on the mutual information of two Hertzian dipoles are analyzed in~\cite{Nossek2014}. The multiport communication theory is also used in~\cite{Laas2020_Reciprocity} for studying the uplink/downlink reciprocity and mutual information of multi-user MIMO systems. More recently, \cite{Bamelak_2023} used it to investigate the impact of mutual coupling in the channel estimation of single-user MIMO communications.}    

 The main objectives of this paper are two fold: $i$) to use the multiport communication theory to derive physically consistent uplink and downlink models for multi-user Holographic MIMO communications with linear processing; and $ii$) to use the developed models to answer the following question: \textit{what are the spectral efficiency advantages (if any) of having closely spaced antennas?} To answer this question, we first consider a simple uplink scenario with two side-by-side half-wavelength dipoles at the base station (BS), two user equipments (UEs) and single path line-of-sight propagation. In this context, we show
both analytically and numerically that the channel gain, interference gain and spectral efficiency depend strongly on
the directions from which the UE signals are received and on the array matching network used at the BS. Advantages can be obtained only with impedance matching (e.g., \cite{Volodymyr_2022}) and under certain conditions, which may not be met in practical
systems. In these cases, the gains may be marginal or even non-existent.
The internal losses within the dipole antennas are also shown to significantly impact the
spectral efficiency as the spacing reduces. Numerical results are then used to show that similar conclusions hold true in more practical scenarios with an arbitrary number of UEs and an arbitrary number of dipole antennas at the BS. Particularly, the analysis is conducted in the following two cases: $i$) the number of dipoles is fixed as we vary their spacing; $i$) the array size is fixed as we vary the dipole spacing. In the latter case, it turns out that the spectral efficiency increases s the antenna distance reduces. However, this comes from the larger energy that is collected by the larger number of dipoles, not from the mutual coupling. Interestingly, the spectral efficiency tends to increase less and less as the size of the antenna array increases (compared to the wavelength). 

Although most of the analysis focuses on the uplink, we also investigate the downlink. Particular attention is given to the uplink and downlink duality in the presence of different matching networks. {Specifically, we show that the downlink and uplink channels are reciprocal up to a linear transformation. In line with \cite{Laas2020_Reciprocity}, the ordinary channel reciprocity (i.e., no linear transformation) holds true only if full matching networks (that are hard to implement in arrays with many antennas) are employed at both sides.} Numerical results are used to quantify the spectral efficiency loss when the linear transformation is not applied.     

 


% The first studies on the effect of mutual coupling on the capacity of single-user MIMO systems are dated back to the beginning of  2000s~\cite{Janaswamy2002,Svantesson_ICASSP2001,Wallace2004}. Particularly,~\cite{Wallace2004} represented the MIMO communication system as an electrical network described by scattering matrices that account for mutual coupling between transmit and/or receive antennas. A matching network was also introduced at the receiver to maximize the power transfer from the source to the loads. The framework developed in~\cite{Wallace2004} is also among the first to connect abstract mathematical parameters (such as transmit power) with physical quantities. %Indeed, the analysis and design of MIMO systems in the communications society have historically evolved around the abstractions of information theory. The latter serves well as the mathematical theory of communication but it contains no provision that makes sure its abstractions are consistent with the physical laws that govern any system.
% % As a matter of fact, there was a gap between the mathematical models adopted by the communication and information theorists and the physics of electromagnetic propagation (of which mutual coupling is only one aspect). 
% To better understand this point, consider a narrowband communication system equipped with $M$ antennas at the receiver and $N$ antennas at the source. This is commonly described by the following information-theoretic discrete-time input-output relation:%~\cite{TseBook}:
% \begin{equation}\label{eq:MIMO_channel}
% {\bf y} = {\bf H}{\bf x} + {\bf n}
% \end{equation} 
% where ${\bf y}\in \mathbb{C}^{M}$ and ${\bf x}\in \mathbb{C}^{N}$ denote the received and transmitted signal vectors, respectively. The vector ${\bf x}$ must satisfy $\mathbb{E}\{{{\bf x}^{\Htran}{\bf x}}\}\le P_{\rm T}$ to constrain the total transmit power. Also, ${\bf n}\sim \mathcal{N}_\mathbb{C}({\bf 0}, {\bf R}_n)$ is the additive Gaussian noise and ${\bf H}\in \mathbb{C}^{M \times N}$ is the MIMO channel matrix. The input-output relationship given in \eqref{eq:MIMO_channel} provides a \textit{mathematical} model in which the various building blocks are not necessarily related to \textit{physical} quantities and phenomena (among which mutual coupling is one of them). This is the point where the multiport communication theory developed by Ivrla\v{c} and Nossek comes into the play~\cite{Nossek2010,Nossek2014}. This framework involves a circuit theoretic approach where the inputs and outputs of the communication system are associated with ports of a multi- port black-box. It establishes an interface between the physical and information worlds, and, thus, it ensures the applicability of mathematical theories of communication to the physical world.


% They are pure numbers and do not obey any physical law. On the other hand, transmission of information is always connected with some physical process, and hence the relevant equations must be consistent with the fundamental principles of physics, such as, for example, the law of conservation of energy. The Multiport Communication Theory (MCT), developed by Ivrla\v{c} and Nossek~\cite{Nossek2010,Nossek2014}, provides a description of the communication link in terms of voltages and currents which are physical quantities related to the transmission process. Since the publication of \cite{Nossek2010}, a lot of papers have been devoted...      

% \subsection{Contribution}
% The primary objective of this paper is that of analyzing the spectral efficiency of multi-user holographic MIMO communications, characterized by a large number of closely spaced antennas at the base station (BS). We limit our study to uniform linear arrays (ULAs) of half-wavelength dipoles, but the provided framework can be used to extend the results to different array configurations and different types of antennas. Both the downlink and uplink directions are analyzed, and we assume that linear precoding (in the downlink) or linear combining (in the uplink) techniques are used at the BS. In particular, we focus on \textit{maximum ratio} (MR) and \textit{minimum mean square error} (MMSE) schemes, for both transmission and reception. 

% The analysis is conducted on the basis of the Multiport Communication Theory (MCT) developed by Ivrla\v{c} and Nossek~\cite{Nossek2014,Nossek2010}. For convenience, the main results of MCT are discussed in the first part of this paper. A key ingredient of MCT is represented by the impedance matrix that accounts for the mutual coupling between the transmit and/or receive antennas (\textit{intra-array} and \textit{inter-array coupling}). The computation of this matrix derives from electromagnetic principles, which are discussed in a dedicated section where it is studied the impact of the antenna spacing on the spatial correlation properties of signal and noise.

% The important question we aim to answer is the following: \textit{in a multi-user holographic MIMO  communication system, what are the effects of the mutual coupling on the spectral efficiency? In particular, what happens when the antennas are packed close to each other?} In order to answer this question we start with a case study with two single-antenna users and a BS with two antennas, and we provide analytical expressions for the array gain and the interference gain, which help understanding the impact of the mutual coupling and the antenna spacing on the spectral efficiency. Most of the conclusions that can be drawn in this simplified scenario are maintained when we consider a more practical situation with an arbitrary number of users and an arbitrary number of antennas at the BS. In particular, in the general scenario the effects of varying the antenna spacing (in conjunction with other system parameters, such as the transmit/receive matching networks) have been analyzed in two cases of significant interest: in one case, we consider a fixed number of antennas and we vary their distances; in the other, we fix the array size and we vary the number of antennas, reducing or increasing the spacing. It turns out that the behavior of the spectral efficiency is quite different in the two cases. \textcolor{red}{Forse si pu√≤ anticipare qualche conclusione}

% Though most of the paper is devoted to the study of the system performance in the uplink direction, we also investigate the duality between the uplink and downlink channels. It turns out that such a duality exists depending on the particular matching networks employed at the transmit and receive sides. In this respect, we analyze (by simulation) the impact of the antenna spacing and the mutual coupling on the downlink spectral efficiency, when it is erroneously assumed that the downlink and the uplink vector channels coincide (within a scale factor).     


% The primary objective of this paper is that of giving an answer to the following question: in an holographic MIMO communication system, characterized by a large number of antennas (possibly close to each other), what are the effects of the antenna spacing on the system performance? In particular, does mutual coupling have a positive impact on the communication process? In order to answer this question we consider a practical scenario in which single-antenna users communicate with a base station (BS) endowed with multiple antennas. We limit our study to uniform linear arrays (ULAs) of half-wavelength dipoles, but the provided framework can be used to extend the results to different array configurations and different types of antennas. Both the downlink and uplink directions are analyzed, and we assume that linear precoding (in the downlink) or linear combining (in the uplink) techniques are used at the BS. In particular, we focus on \textit{maximum ratio} (MR) and \textit{minimum mean square error} (MMSE) schemes, for both transmission and reception. The system performance is assessed in terms of spectral efficiency (SE). 



% \subsection{Paper outline and reproducible research}
The remainder of this paper is organized as follows. In Section~\ref{sec:system_model}, we review the Multiport Communication Theory from~\cite{Nossek2014}. In Section~III, we show how to compute the mutual coupling impedance matrix when a uniform linear array made of half-wavelength dipoles is used at both sides. In Section IV, the uplink and downlink signal models for Holographic MIMO communications are derived on the basis of the
multiport communication model. The concept of uplink and downlink duality is also discussed. To showcase what is the impact of mutual coupling, a simple case study with two dipole antennas and two UEs is considered in Section V. The analysis is then extended in Section VI to more realistic scenarios with multiple antennas, multiple UEs and arrays of varying or fixed aperture. Conclusions are drawn in Section VI. 

\textit{Reproducible research:} The Matlab code used to obtain the simulation results will be made available upon completion of the review process.

% We use $\rank({\bf A})$ to denote the rank of matrix $\bf {A}$. For a given vector ${\bf p}$, $\hat {\bf p}$ is a unit vector along its direction and $||{\bf p}||$ denotes its magnitude. $\nabla \times$ denotes the curl operation, $\delta(x)$ the Dirac delta function, and $\floor*{x}$ the greatest integer less than or equal to $x$. $\delta(\cdot)$ denotes the Dirac delta function.
