

\begin{restatable}[\textbf {Strongly convex \(F\) with adaptive QV and Decreasing Stepsize}]{lemma}{prAtEndRestatexvi}\label{thm:prAtEndxvi}\label {thm:projsgd_stronglyconvex_decstepsize_adaptive_complexity} For a \(\mu \)-strongly convex \(F : \Lambda \to \mathbb {R}\) on a convex set \(\Lambda \) with a unique global minimizer \(\vlambda ^* \in \Lambda \), the last iterate \(\vlambda _T\) of projected SGD with a gradient estimator satisfying an adaptive QVC bound (\cref {assumption:adaptiveqvc}) and a decreasing stepsize satisfies a suboptimality of \(\mathbb {E}\norm {\vlambda _T - \vlambda _{*}}_2^2 < \epsilon \) if { \begin {align*} \gamma _t &= \min \Bigg ( \frac { \mu }{ 2 \widetilde {\alpha } + \sqrt {2 \norm {\vlambda _0 - \vlambda ^*}_2 } \, \epsilon ^{1/4} \, \widetilde {\alpha }^{3/2} \widetilde {\beta }^{-1/2} }, \frac {4 t + 2 }{ \mu \, {\left ( t + 1\right )}^2 } \Bigg ) \\ T &\geq \frac {16 \widetilde {\beta } }{ \mu ^2 } \frac {1}{\epsilon } + \frac {16 \sqrt {2}}{ \mu ^2 } \sqrt { \norm {\vlambda _0 - \vlambda ^*}_2 } \, \sqrt { \widetilde {\alpha } \widetilde {\beta } } \, \frac {1}{\epsilon ^{3/4}} + \frac {8 \widetilde {\alpha } \, \norm {\vlambda _0 - \vlambda ^*}_2 }{ \mu ^2} \frac {1}{\sqrt {\epsilon }}. \end {align*} }\end{restatable}

\makeatletter\Hy@SaveLastskip\label{proofsection:prAtEndxvi}\ifdefined\pratend@current@sectionlike@label\immediate\write\@auxout{\string\gdef\string\pratend@section@for@proofxvi{\pratend@current@sectionlike@label}}\fi\Hy@RestoreLastskip\makeatother\begin{proof}[Proof]\phantomsection\label{proof:prAtEndxvi}\label {proof:projsgd_stronglyconvex_decstepsize_adaptive_complexity} Recall that, for a stepsize \(\gamma \) and a number of steps \(T\) such that \begin {align*} \gamma _t = \min \left ( \frac {\mu }{2 \alpha }, \frac {4 t + 2 }{ \mu \, {\left ( t + 1\right )}^2 } \right ) \quad \text {and}\quad T \geq \frac {16 \beta }{ \mu ^2 } \frac {1}{\epsilon } + \frac {8 \alpha \, \norm {\vlambda _0 - \vlambda ^*}_2 }{ \mu ^2} \frac {1}{\sqrt {\epsilon }}, \end {align*} we can guarantee that the iterate \(\vlambda _t\) can guarantee \(\mathbb {E} \norm {\vlambda ^* - \vlambda _T}_2^2 \leq \epsilon \). \par We optimize the parameter \(\delta \) to minimize the required number of steps \(T\). That is, we maximize \begin {align*} \frac {16 \beta }{ \mu ^2 } \frac {1}{\epsilon } + \frac {8 \sqrt {2} \, \alpha \, \norm {\vlambda _0 - \vlambda ^*}_2 }{ \mu ^2} \frac {1}{\sqrt {\epsilon }} = \frac {16 \left (1 + C \delta \right ) \widetilde {\beta } }{ \mu ^2 } \frac {1}{\epsilon } + \frac {8 \left (1 + C^{-1} \delta ^{-1}\right ) \widetilde {\alpha } \, \norm {\vlambda _0 - \vlambda ^*}_2 }{ \mu ^2} \frac {1}{\sqrt {\epsilon }}. \end {align*} This is clearly a convex function with respect to \(\delta \). Thus, we only need to find a first-order stationary point {\small \begin {align*} \frac {\mathrm {d}}{\mathrm {d} \delta } \left ( \frac {16 \left (1 + C \delta \right ) \widetilde {\beta } }{ \mu ^2 } \frac {1}{\epsilon } + \frac {8 \left (1 + C^{-1} \delta ^{-1}\right ) \widetilde {\alpha } \, \norm {\vlambda _0 - \vlambda ^*}_2 }{ \mu ^2} \frac {1}{\sqrt {\epsilon }} \right ) &= 0. \end {align*} }Differentiating, we have \begin {alignat*}{3} && \frac {16 C \widetilde {\beta } }{ \mu ^2 } \frac {1}{\epsilon } - \frac {8 \, C^{-1} \delta ^{-2} \widetilde {\alpha } \, \norm {\vlambda _0 - \vlambda ^*}_2 }{ \mu ^2} \frac {1}{\sqrt {\epsilon }} &= 0, \shortintertext {multiplying \(\delta ^2\) to both sides,} &\Leftrightarrow &\qquad \delta ^2 \frac {16 C \widetilde {\beta } }{ \mu ^2 } \frac {1}{\epsilon } - \frac {8 \sqrt {2} \, C^{-1} \widetilde {\alpha } \, \norm {\vlambda _0 - \vlambda ^*}_2 }{ \mu ^2} \frac {1}{\sqrt {\epsilon }} &= 0. \end {alignat*} Reorganizing, \begin {alignat*}{3} &\Leftrightarrow &\qquad \delta ^2 \frac {16 C \widetilde {\beta } }{ \mu ^2 } \frac {1}{\epsilon } &= \frac {8 \sqrt {2} \, C^{-1} \widetilde {\alpha } \, \norm {\vlambda _0 - \vlambda ^*}_2 }{ \mu ^2} \frac {1}{\sqrt {\epsilon }} \\ &\Leftrightarrow &\qquad \delta ^2 &= \left ( \frac {\mu ^2 \epsilon }{ 16 C \widetilde {\beta } } \right ) \left ( \frac {8 C^{-1} \widetilde {\alpha } \, \norm {\vlambda _0 - \vlambda ^*}_2 }{ \mu ^2} \frac {1}{\sqrt {\epsilon }} \right ) \\ &\Leftrightarrow &\qquad \delta ^2 &= \frac {C^{-2} \widetilde {\alpha } \, \norm {\vlambda _0 - \vlambda ^*}_2}{ 2 \widetilde {\beta }} \sqrt {\epsilon }, \shortintertext {and taking the square-root of both sides,} &\Leftrightarrow &\qquad \delta &= \frac { \sqrt { \norm {\vlambda _0 - \vlambda ^*}_2 } \, \epsilon ^{1/4} \, \sqrt {\widetilde {\alpha }} }{ \sqrt {2} \, C \sqrt {\widetilde {\beta }} }. \end {alignat*} Recall that the required number of iterations is \begin {align*} T &\geq \frac {16 \left (1 + C \delta \right ) \widetilde {\beta } }{ \mu ^2 } \frac {1}{\epsilon } + \frac {8 \left (1 + C^{-1} \delta ^{-1}\right ) \widetilde {\alpha } \, \norm {\vlambda _0 - \vlambda ^*}_2 }{ \mu ^2} \frac {1}{\sqrt {\epsilon }} \\ &= \underbrace { \frac {16 \widetilde {\beta } }{ \mu ^2 } \frac {1}{\epsilon } + \frac {16 \widetilde {\beta } }{ \mu ^2 } \frac {1}{\epsilon } C \delta }_{T_{\text {\ding {172}}}} + \underbrace { \frac {8 \widetilde {\alpha } \, \norm {\vlambda _0 - \vlambda ^*}_2 }{ \mu ^2} \frac {1}{\sqrt {\epsilon }} + \frac {8 \widetilde {\alpha } \, \norm {\vlambda _0 - \vlambda ^*}_2 }{ \mu ^2} \frac {1}{\sqrt {\epsilon }} C^{-1} \delta ^{-1} }_{T_{\text {\ding {173}}}}. \end {align*} Plugging \(\delta \) in, we have \begin {align*} T_{\text {\ding {172}}} &= \frac {16 \widetilde {\beta } }{ \mu ^2 } \frac {1}{\epsilon } + \frac {16 \widetilde {\beta } }{ \mu ^2 } \frac {1}{\epsilon } C \left ( \frac { \sqrt { \norm {\vlambda _0 - \vlambda ^*}_2 } \, \epsilon ^{1/4} \, \sqrt {\widetilde {\alpha }} }{ \sqrt {2} \, C \sqrt {\widetilde {\beta }} } \right ) \\ &= \frac {16 \widetilde {\beta } }{ \mu ^2 } \frac {1}{\epsilon } + \frac {8 \sqrt {2} }{ \mu ^2 } \sqrt { \widetilde {\alpha } \widetilde {\beta } } \, \sqrt { \norm {\vlambda _0 - \vlambda ^*}_2 } \, \epsilon ^{-3/4} \\ \\ T_{\text {\ding {173}}} &= \frac {8 \, \widetilde {\alpha } \, \norm {\vlambda _0 - \vlambda ^*}_2 }{ \mu ^2} \frac {1}{\sqrt {\epsilon }} + \frac {8 \, \widetilde {\alpha } \, \norm {\vlambda _0 - \vlambda ^*}_2 }{ \mu ^2} \frac {1}{\sqrt {\epsilon }} C^{-1} \left ( \frac { \sqrt {2} \, C \sqrt {\widetilde {\beta }} }{ \sqrt { \norm {\vlambda _0 - \vlambda ^*}_2 } \, \epsilon ^{1/4} \, \sqrt {\widetilde {\alpha }} } \right ) \\ &= \frac {8 \widetilde {\alpha } \, \norm {\vlambda _0 - \vlambda ^*}_2 }{ \mu ^2} \frac {1}{\sqrt {\epsilon }} + \frac {8 \sqrt {2}}{ \mu ^2} \sqrt { \norm {\vlambda _0 - \vlambda ^*}_2 } \, \sqrt { \widetilde {\alpha } \widetilde {\beta } } \, \epsilon ^{-3/4}. \end {align*} Combining the results, \begin {align*} T \geq T_{\text {\ding {172}}} + T_{\text {\ding {173}}} &= \frac {16 \widetilde {\beta } }{ \mu ^2 } \frac {1}{\epsilon } + \frac {8 \sqrt {2} }{ \mu ^2 } \sqrt { \widetilde {\alpha } \widetilde {\beta } } \, \sqrt { \norm {\vlambda _0 - \vlambda ^*}_2 } \, \epsilon ^{-3/4} \\ &\qquad + \frac {8 \widetilde {\alpha } \, \norm {\vlambda _0 - \vlambda ^*}_2 }{ \mu ^2} \frac {1}{\sqrt {\epsilon }} + \frac {8 \sqrt {2}}{ \mu ^2} \sqrt { \norm {\vlambda _0 - \vlambda ^*}_2 } \, \sqrt { \widetilde {\alpha } \widetilde {\beta } } \, \epsilon ^{-3/4} \\ &= \frac {16 \widetilde {\beta } }{ \mu ^2 } \frac {1}{\epsilon } + \frac {16 \sqrt {2}}{ \mu ^2 } \sqrt { \norm {\vlambda _0 - \vlambda ^*}_2 } \, \sqrt { \widetilde {\alpha } \widetilde {\beta } } \, \epsilon ^{-3/4} + \frac {8 \widetilde {\alpha } \, \norm {\vlambda _0 - \vlambda ^*}_2 }{ \mu ^2} \frac {1}{\sqrt {\epsilon }}. \end {align*} \par For the stepsize \begin {align*} \gamma = \min \left ( \frac {\mu }{2 \alpha }, \frac {4 t + 2 }{ \mu \, {\left ( t + 1\right )}^2 } \right ) = \min \left ( \frac {\mu }{2 \left (1 + C \delta \right ) \widetilde {\alpha }}, \frac {4 t + 2 }{ \mu \, {\left ( t + 1\right )}^2 } \right ), \end {align*} we have \begin {align*} 2 \left (1 + C \delta \right ) \widetilde {\alpha } &= 2 \widetilde {\alpha } + 2 \widetilde {\alpha } C \delta \\ &= 2 \widetilde {\alpha } + 2 \widetilde {\alpha } C \left ( \frac { \sqrt { \norm {\vlambda _0 - \vlambda ^*}_2 } \, \epsilon ^{1/4} \, \sqrt {\widetilde {\alpha }} }{ \sqrt {2} \, C \sqrt {\widetilde {\beta }} } \right ) \\ &= 2 \widetilde {\alpha } + \sqrt {2} \sqrt { \norm {\vlambda _0 - \vlambda ^*}_2 } \, \epsilon ^{1/4} \, \widetilde {\alpha }^{3/2} \widetilde {\beta }^{-1/2}. \end {align*} Therefore, \begin {align*} \gamma = \min \left ( \frac {\mu }{2 \left (1 + C \delta \right ) \widetilde {\alpha }}, \frac {4 t + 2 }{ \mu \, {\left ( t + 1\right )}^2 } \right ) = \min \left ( \frac { \mu }{ 2 \widetilde {\alpha } + \sqrt {2 \norm {\vlambda _0 - \vlambda ^*}_2 } \, \epsilon ^{1/4} \, \widetilde {\alpha }^{3/2} \widetilde {\beta }^{-1/2} }, \frac {4 t + 2 }{ \mu \, {\left ( t + 1\right )}^2 } \right ). \end {align*}\end{proof}
