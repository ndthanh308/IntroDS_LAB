

\prAtEndRestatexiv*

\makeatletter\Hy@SaveLastskip\label{proofsection:prAtEndxiv}\ifdefined\pratend@current@sectionlike@label\immediate\write\@auxout{\string\gdef\string\pratend@section@for@proofxiv{\pratend@current@sectionlike@label}}\fi\Hy@RestoreLastskip\makeatother\begin{proof}[Proof]\phantomsection\label{proof:prAtEndxiv}Recall that, for a stepsize \begin {align*} \gamma \leq \min \left ( \frac {\epsilon \mu }{4 \beta }, \frac {\mu }{2 \alpha }, \frac {2}{\mu } \right ), \end {align*} with a number of steps at least \begin {align*} T \geq \max \left ( \frac { 4 \beta }{\mu ^2 } \frac {1}{\epsilon }, \frac {2 \alpha }{\mu ^2} \right ) \log \left ( 2 \norm {\vlambda _0 - \vlambda ^*}_2^2 \, \frac {1}{\epsilon } \right ), \end {align*} we can guarantee that the iterate \(\vlambda _t\) can guarantee \(\mathbb {E} \norm {\vlambda ^* - \vlambda _T}_2^2 \leq \epsilon \). \par We optimize the parameter \(\delta \) to minimize the number of steps. That is, \begin {align*} &\max \left ( \frac { 4 \beta }{\mu ^2 } \frac {1}{\epsilon }, \frac {2 \alpha }{\mu ^2} \right ) \log \left ( 2 \norm {\vlambda _0 - \vlambda ^*}_2^2 \, \frac {1}{\epsilon } \right ) \\ &\;= \frac {2}{\mu ^2} \max \left ( 2 (1 + C^{-1} \delta ^{-1}) \,\widetilde {\beta } \frac {1}{\epsilon }, (1 + C \delta ) \widetilde {\alpha } \right ) \log \left ( 2 \norm {\vlambda _0 - \vlambda ^*}_2^2 \, \frac {1}{\epsilon } \right ). \end {align*} Since each term in the max function are monotonic with respect to \(\delta \), the optimum is unique, and achieved when the two terms are equal. That is, \begin {alignat*}{2} & & 2 (1 + C^{-1} \delta ^{-1}) \,\widetilde {\beta } \frac {1}{\epsilon } &= (1 + C \delta ) \widetilde {\alpha } \\ &\Leftrightarrow &\qquad \frac {2 \widetilde {\beta }}{\epsilon } + \frac {2 \widetilde {\beta } C^{-1}}{\epsilon } \delta ^{-1} \, &= \widetilde {\alpha } + \widetilde {\alpha } C \delta \\ &\Leftrightarrow &\qquad \frac {2 \widetilde {\beta }}{\epsilon } \delta + \frac {2 \widetilde {\beta } C^{-1}}{\epsilon } \, &= \widetilde {\alpha } \delta + \widetilde {\alpha } C \delta ^2 \\ &\Leftrightarrow &\qquad \widetilde {\alpha } C \delta ^2 + \left ( \widetilde {\alpha } - \frac {2 \widetilde {\beta }}{\epsilon } \right ) \delta - \frac {2 \widetilde {\beta } C^{-1}}{\epsilon } &= 0 \end {alignat*} Conveniently, this is a quadratic with the unique solution \begin {alignat*}{2} \delta &= \frac { - \left ( \widetilde {\alpha } - \frac {2 \widetilde {\beta }}{\epsilon } \right ) + \sqrt { {\left (\widetilde {\alpha } - \frac {2 \widetilde {\beta }}{\epsilon } \right )}^2 + 8 \frac {\widetilde {\alpha } \widetilde {\beta } C C^{-1}}{\epsilon } } }{ 2 \widetilde {\alpha } C } \\ &= \frac { - \left ( \widetilde {\alpha } - \frac {2 \widetilde {\beta }}{\epsilon } \right ) + \sqrt { \widetilde {\alpha }^2 - 4 \frac {\widetilde {\alpha } \widetilde {\beta }}{\epsilon } + {\left ( \frac {2 \widetilde {\beta }}{\epsilon } \right )}^2 + 8 \frac {\widetilde {\alpha } \widetilde {\beta } }{\epsilon } } }{ 2 \widetilde {\alpha } C } \\ &= \frac { - \left ( \widetilde {\alpha } - \frac {2 \widetilde {\beta }}{\epsilon } \right ) + \sqrt { \widetilde {\alpha }^2 + 4 \frac {\widetilde {\alpha } \widetilde {\beta }}{\epsilon } + {\left ( \frac {2 \widetilde {\beta }}{\epsilon } \right )}^2 } }{ 2 \widetilde {\alpha } C } \\ &= \frac { - \left ( \widetilde {\alpha } - \frac {2 \widetilde {\beta }}{\epsilon } \right ) + \sqrt { {\left ( \widetilde {\alpha } + \frac {2 \widetilde {\beta }}{\epsilon } \right )}^2 } }{ 2 \widetilde {\alpha } C } \\ &= \frac { - \widetilde {\alpha } + \frac {2 \widetilde {\beta }}{\epsilon } + \widetilde {\alpha } + \frac {2 \widetilde {\beta }}{\epsilon } }{ 2 \widetilde {\alpha } C } \\ &= 2 \frac { \widetilde {\beta } }{ \widetilde {\alpha } } C^{-1} \epsilon ^{-1}. \end {alignat*} \par Thus, the optimal bound is obtained by setting \( \delta = 2 \frac { \widetilde {\beta } }{ \widetilde {\alpha } } C^{-1} \epsilon ^{-1}, \) such that \begin {align*} T &\geq \frac {2}{\mu ^2} \max \left ( 2 \beta \frac {1}{\epsilon }, \alpha \right ) \log \left ( 2 \norm {\vlambda _0 - \vlambda ^*}_2^2 \, \frac {1}{\epsilon } \right ) \\ &= \frac {2}{\mu ^2} \max \left ( 2 \left ( 1 + C^{-1} \delta ^{-1} \right ) \widetilde {\beta } \frac {1}{\epsilon }, \left ( 1 + C \delta \right ) \widetilde {\alpha } \right ) \log \left ( 2 \norm {\vlambda _0 - \vlambda ^*}_2^2 \, \frac {1}{\epsilon } \right ) \\ &= \frac {2}{\mu ^2} \left (\widetilde {\alpha } + 2 \widetilde {\beta } \frac {1}{\epsilon }\right ) \log \left ( 2 \norm {\vlambda _0 - \vlambda ^*}_2^2 \, \frac {1}{\epsilon } \right ) \end {align*} The stepsize with the optimal \(\delta \) is consequently \begin {align*} \gamma &\leq \min \left ( \frac {\epsilon \mu }{4 \beta }, \frac {\mu }{2 \alpha }, \frac {2}{\mu } \right ) \\ &= \min \left ( \frac {\epsilon \mu }{4 (1 + C^{-1} \delta ^{-1}) \widetilde {\beta }} \,, \; \frac {\mu }{2 (1 + C \delta ) \widetilde {\alpha }}, \frac {2}{\mu } \right ) \\ &= \min \left ( \frac {1}{2} \frac { \mu }{ \widetilde {\alpha } + 2 \widetilde {\beta } \epsilon ^{-1} }\, ,\; \frac {2}{\mu } \right ). \end {align*}\end{proof}

\begin{restatable}[\textbf {Strongly convex \(F\) with adaptive QVC and Decreasing Stepsize}]{lemma}{prAtEndRestatexv}\label{thm:prAtEndxv}\label {thm:projsgd_stronglyconvex_decstepsize_adaptive_complexity} For a \(\mu \)-strongly convex \(F\), the last iterate \(\vlambda _T\) of projected SGD with a gradient estimator satisfying an adaptive QVC bound (\cref {assumption:adaptiveqvc}) and a decreasing stepsize satisfies a suboptimality of \(\norm {\vlambda _T - \vlambda _{*}}_2^2 < \epsilon \) if \begin {align*} \gamma _t &= \min \left ( \frac { \mu }{ 2 \widetilde {\alpha } + 2^{3/4} \sqrt { \norm {\vlambda _0 - \vlambda ^*}_2 } \, \epsilon ^{1/4} \, \widetilde {\alpha }^{3/2} \widetilde {\beta }^{-1/2} }, \frac {4 t + 2 }{ \mu \, {\left ( t + 1\right )}^2 } \right ) \\ T &\geq \frac {16 \widetilde {\beta } }{ \mu ^2 } \frac {1}{\epsilon } + \frac {32}{ \mu ^2 } \sqrt { \norm {\vlambda _0 - \vlambda ^*}_2 } \, \sqrt { \widetilde {\alpha } \widetilde {\beta } } \, \frac {1}{\epsilon ^{3/4}} + \frac {16 \widetilde {\alpha } \, \norm {\vlambda _0 - \vlambda ^*}_2 }{ \mu ^2} \frac {1}{\sqrt {\epsilon }}. \end {align*}\end{restatable}

\makeatletter\Hy@SaveLastskip\label{proofsection:prAtEndxv}\ifdefined\pratend@current@sectionlike@label\immediate\write\@auxout{\string\gdef\string\pratend@section@for@proofxv{\pratend@current@sectionlike@label}}\fi\Hy@RestoreLastskip\makeatother\begin{proof}[Proof]\phantomsection\label{proof:prAtEndxv}Recall that, for a stepsize \begin {align*} \gamma _t = \min \left ( \frac {\mu }{2 \alpha }, \frac {4 t + 2 }{ \mu \, {\left ( t + 1\right )}^2 } \right ), \end {align*} with a number of steps at least \begin {align*} T \geq \frac {16 \beta }{ \mu ^2 } \frac {1}{\epsilon } + \frac {8 \sqrt {2} \, \alpha \, \norm {\vlambda _0 - \vlambda ^*}_2 }{ \mu ^2} \frac {1}{\sqrt {\epsilon }}, \end {align*} we can guarantee that the iterate \(\vlambda _t\) can guarantee \(\mathbb {E} \norm {\vlambda ^* - \vlambda _T}_2^2 \leq \epsilon \). \par We optimize the parameter \(\delta \) to minimize the required number of steps \(T\). That is, we maximize \begin {align*} &\frac {16 \beta }{ \mu ^2 } \frac {1}{\epsilon } + \frac {8 \sqrt {2} \, \alpha \, \norm {\vlambda _0 - \vlambda ^*}_2 }{ \mu ^2} \frac {1}{\sqrt {\epsilon }} \\ &= \frac {16 \left (1 + C \delta \right ) \widetilde {\beta } }{ \mu ^2 } \frac {1}{\epsilon } + \frac {8 \sqrt {2} \, \left (1 + C^{-1} \delta ^{-1}\right ) \widetilde {\alpha } \, \norm {\vlambda _0 - \vlambda ^*}_2 }{ \mu ^2} \frac {1}{\sqrt {\epsilon }}. \end {align*} This is clearly a convex function with respect to \(\delta \). Thus we only need to find a first order stationary point \begin {alignat*}{3} && \frac {\mathrm {d}}{\mathrm {d} \delta } \left ( \frac {16 \left (1 + C \delta \right ) \widetilde {\beta } }{ \mu ^2 } \frac {1}{\epsilon } + \frac {8 \sqrt {2} \, \left (1 + C^{-1} \delta ^{-1}\right ) \widetilde {\alpha } \, \norm {\vlambda _0 - \vlambda ^*}_2 }{ \mu ^2} \frac {1}{\sqrt {\epsilon }} \right ) &= 0 \\ &\Leftrightarrow &\qquad \frac {16 C \widetilde {\beta } }{ \mu ^2 } \frac {1}{\epsilon } - \frac {8 \sqrt {2} \, C^{-1} \delta ^{-2} \widetilde {\alpha } \, \norm {\vlambda _0 - \vlambda ^*}_2 }{ \mu ^2} \frac {1}{\sqrt {\epsilon }} &= 0, \shortintertext {multiplying \(\delta ^2\) to both hand sides,} &\Leftrightarrow &\qquad \delta ^2 \frac {16 C \widetilde {\beta } }{ \mu ^2 } \frac {1}{\epsilon } - \frac {8 \sqrt {2} \, C^{-1} \widetilde {\alpha } \, \norm {\vlambda _0 - \vlambda ^*}_2 }{ \mu ^2} \frac {1}{\sqrt {\epsilon }} &= 0. \end {alignat*} Reorganizing, \begin {alignat*}{3} \\ &\Leftrightarrow &\qquad \delta ^2 \frac {16 C \widetilde {\beta } }{ \mu ^2 } \frac {1}{\epsilon } &= \frac {8 \sqrt {2} \, C^{-1} \widetilde {\alpha } \, \norm {\vlambda _0 - \vlambda ^*}_2 }{ \mu ^2} \frac {1}{\sqrt {\epsilon }} \\ &\Leftrightarrow &\qquad \delta ^2 &= \left ( \frac {\mu ^2 \epsilon }{ 16 C \widetilde {\beta } } \right ) \left ( \frac {8 \sqrt {2} \, C^{-1} \widetilde {\alpha } \, \norm {\vlambda _0 - \vlambda ^*}_2 }{ \mu ^2} \frac {1}{\sqrt {\epsilon }} \right ) \\ &\Leftrightarrow &\qquad \delta ^2 &= \frac {C^{-2} \widetilde {\alpha } \, \norm {\vlambda _0 - \vlambda ^*}_2}{ \sqrt {2} \widetilde {\beta }} \sqrt {\epsilon }, \shortintertext {and square-rooting both hand sides,} &\Leftrightarrow &\qquad \delta &= \frac { \sqrt { \norm {\vlambda _0 - \vlambda ^*}_2 } \, \epsilon ^{1/4} \, \sqrt {\widetilde {\alpha }} }{ C \, 2^{1/4} \sqrt {\widetilde {\beta }} }. \end {alignat*} Recall that the required number of iteration is \begin {align*} T &\geq \frac {16 \left (1 + C \delta \right ) \widetilde {\beta } }{ \mu ^2 } \frac {1}{\epsilon } + \frac {8 \sqrt {2} \, \left (1 + C^{-1} \delta ^{-1}\right ) \widetilde {\alpha } \, \norm {\vlambda _0 - \vlambda ^*}_2 }{ \mu ^2} \frac {1}{\sqrt {\epsilon }} \\ &= \underbrace { \frac {16 \widetilde {\beta } }{ \mu ^2 } \frac {1}{\epsilon } + \frac {16 \widetilde {\beta } }{ \mu ^2 } \frac {1}{\epsilon } C \delta }_{T_{\text {\ding {172}}}} + \underbrace { \frac {8 \sqrt {2} \, \widetilde {\alpha } \, \norm {\vlambda _0 - \vlambda ^*}_2 }{ \mu ^2} \frac {1}{\sqrt {\epsilon }} + \frac {8 \sqrt {2} \, \widetilde {\alpha } \, \norm {\vlambda _0 - \vlambda ^*}_2 }{ \mu ^2} \frac {1}{\sqrt {\epsilon }} C^{-1} \delta ^{-1} }_{T_{\text {\ding {173}}}}. \end {align*} Plugging \(\delta \) in, we have \begin {align*} T_{\text {\ding {172}}} &= \frac {16 \widetilde {\beta } }{ \mu ^2 } \frac {1}{\epsilon } + \frac {16 \widetilde {\beta } }{ \mu ^2 } \frac {1}{\epsilon } C \delta \\ &= \frac {16 \widetilde {\beta } }{ \mu ^2 } \frac {1}{\epsilon } + \frac {16 \widetilde {\beta } }{ \mu ^2 } \frac {1}{\epsilon } C \left ( \frac { \sqrt { \norm {\vlambda _0 - \vlambda ^*}_2 } \, \epsilon ^{1/4} \, \sqrt {\widetilde {\alpha }} }{ C \, 2^{1/4} \sqrt {\widetilde {\beta }} } \right ) \\ &= \frac {16 \widetilde {\beta } }{ \mu ^2 } \frac {1}{\epsilon } + \frac {2^{15/4} }{ \mu ^2 } \sqrt { \widetilde {\alpha } \widetilde {\beta } } \, \sqrt { \norm {\vlambda _0 - \vlambda ^*}_2 } \, \epsilon ^{-3/4} \\ \\ T_{\text {\ding {173}}} &= \frac {8 \sqrt {2} \, \widetilde {\alpha } \, \norm {\vlambda _0 - \vlambda ^*}_2 }{ \mu ^2} \frac {1}{\sqrt {\epsilon }} + \frac {8 \sqrt {2} \, \widetilde {\alpha } \, \norm {\vlambda _0 - \vlambda ^*}_2 }{ \mu ^2} \frac {1}{\sqrt {\epsilon }} C^{-1} \delta ^{-1} \\ &= \frac {8 \sqrt {2} \, \widetilde {\alpha } \, \norm {\vlambda _0 - \vlambda ^*}_2 }{ \mu ^2} \frac {1}{\sqrt {\epsilon }} + \frac {8 \sqrt {2} \, \widetilde {\alpha } \, \norm {\vlambda _0 - \vlambda ^*}_2 }{ \mu ^2} \frac {1}{\sqrt {\epsilon }} C^{-1} \left ( \frac { C \, 2^{1/4} \sqrt {\widetilde {\beta }} }{ \sqrt { \norm {\vlambda _0 - \vlambda ^*}_2 } \, \epsilon ^{1/4} \, \sqrt {\widetilde {\alpha }} } \right ) \\ &= \frac {8 \sqrt {2} \widetilde {\alpha } \, \norm {\vlambda _0 - \vlambda ^*}_2 }{ \mu ^2} \frac {1}{\sqrt {\epsilon }} + \frac {2^{15/4}}{ \mu ^2} \sqrt { \norm {\vlambda _0 - \vlambda ^*}_2 } \, \sqrt { \widetilde {\alpha } \widetilde {\beta } } \, \epsilon ^{-3/4} \end {align*} Combining the results, \begin {align*} T &\geq T_{\text {\ding {172}}} + T_{\text {\ding {173}}} \\ &= \frac {16 \widetilde {\beta } }{ \mu ^2 } \frac {1}{\epsilon } + \frac {2^{15/4} }{ \mu ^2 } \sqrt { \widetilde {\alpha } \widetilde {\beta } } \, \sqrt { \norm {\vlambda _0 - \vlambda ^*}_2 } \, \epsilon ^{-3/4} \\ &\quad + \frac {8 \sqrt {2} \widetilde {\alpha } \, \norm {\vlambda _0 - \vlambda ^*}_2 }{ \mu ^2} \frac {1}{\sqrt {\epsilon }} + \frac {2^{15/4}}{ \mu ^2} \sqrt { \norm {\vlambda _0 - \vlambda ^*}_2 } \, \sqrt { \widetilde {\alpha } \widetilde {\beta } } \, \epsilon ^{-3/4} \\ &= \frac {16 \widetilde {\beta } }{ \mu ^2 } \frac {1}{\epsilon } + \frac {2^{19/4}}{ \mu ^2 } \sqrt { \norm {\vlambda _0 - \vlambda ^*}_2 } \, \sqrt { \widetilde {\alpha } \widetilde {\beta } } \, \epsilon ^{-3/4} + \frac {8 \sqrt {2} \widetilde {\alpha } \, \norm {\vlambda _0 - \vlambda ^*}_2 }{ \mu ^2} \frac {1}{\sqrt {\epsilon }} \end {align*} \par For the stepsize \begin {align*} \gamma &\leq \min \left ( \frac {\mu }{2 \alpha }, \frac {4 t + 2 }{ \mu \, {\left ( t + 1\right )}^2 } \right ) \\ &= \min \left ( \frac {\mu }{2 \left (1 + C \delta \right ) \widetilde {\alpha }}, \frac {4 t + 2 }{ \mu \, {\left ( t + 1\right )}^2 } \right ), \end {align*} we have \begin {align*} 2 \left (1 + C \delta \right ) \widetilde {\alpha } &= 2 \widetilde {\alpha } + 2 \widetilde {\alpha } C \delta \\ &= 2 \widetilde {\alpha } + 2 \widetilde {\alpha } C \left ( \frac { \sqrt { \norm {\vlambda _0 - \vlambda ^*}_2 } \, \epsilon ^{1/4} \, \sqrt {\widetilde {\alpha }} }{ C \, 2^{1/4} \sqrt {\widetilde {\beta }} } \right ) \\ &= 2 \widetilde {\alpha } + 2^{3/4} \sqrt { \norm {\vlambda _0 - \vlambda ^*}_2 } \, \epsilon ^{1/4} \, \widetilde {\alpha }^{3/2} \widetilde {\beta }^{-1/2}. \end {align*} Therefore, \begin {align*} \gamma &= \min \left ( \frac {\mu }{2 \left (1 + C \delta \right ) \widetilde {\alpha }}, \frac {4 t + 2 }{ \mu \, {\left ( t + 1\right )}^2 } \right ) \\ &= \min \left ( \frac { \mu }{ 2 \widetilde {\alpha } + 2^{3/4} \sqrt { \norm {\vlambda _0 - \vlambda ^*}_2 } \, \epsilon ^{1/4} \, \widetilde {\alpha }^{3/2} \widetilde {\beta }^{-1/2} }, \frac {4 t + 2 }{ \mu \, {\left ( t + 1\right )}^2 } \right ). \end {align*}\end{proof}
