

\prAtEndRestateiii*

\makeatletter\Hy@SaveLastskip\label{proofsection:prAtEndiii}\ifdefined\pratend@current@sectionlike@label\immediate\write\@auxout{\string\gdef\string\pratend@section@for@proofiii{\pratend@current@sectionlike@label}}\fi\Hy@RestoreLastskip\makeatother\begin{proof}[Proof]\phantomsection\label{proof:prAtEndiii}From the definition of the STL estimator~\cref {def:stl}, \begin {align*} \mathbb {E} \norm {\rvvg _{\mathrm {STL}}\left (\vlambda \right )}_2^2 &= \mathbb {E} \norm { \nabla _{\vlambda } \log \pi \left (\mathcal {T}_{\vlambda }\left (\rvvu \right )\right ) - \nabla _{\vlambda } \log q_{\vnu }\left (\mathcal {T}_{\vlambda }\left (\rvvu \right )\right ) }_2^2 \;\Big \lvert _{\vnu = \vlambda }, \shortintertext {by \cref {thm:jacobian_reparam_inner},} &= \mathbb {E} J_{\mathcal {T}}\left (\rvvu \right ) \norm { \nabla \log \pi \left (\mathcal {T}_{\vlambda }\left (\rvvu \right )\right ) - \nabla \log q_{\vnu }\left (\mathcal {T}_{\vlambda }\left (\rvvu \right )\right ) }_2^2 \;\Big \lvert _{\vnu = \vlambda } \shortintertext {adding the terms \(\nabla \log \pi \left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right )\) and \(\nabla \log q_{\vlambda ^*}\left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right )\) that cancel,} &= \mathbb {E} J_{\mathcal {T}}\left (\rvvu \right ) \lVert \nabla \log \pi \left (\mathcal {T}_{\vlambda }\left (\rvvu \right )\right ) - \nabla \log \pi \left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) \\ &\quad \qquad \qquad + \nabla \log \pi \left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) - \nabla \log q_{\vlambda ^*}\left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) \\ &\quad \qquad \qquad + \nabla \log q_{\vlambda ^*}\left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) - \nabla \log q_{\vlambda }\left (\mathcal {T}_{\vlambda }\left (\rvvu \right )\right ) {\rVert }_2^2, \shortintertext {applying \cref {thm:peterpaul},} &\leq \mathbb {E} J_{\mathcal {T}}\left (\rvvu \right ) \Big ( \left ( 2 + \delta \right ) \lVert \nabla \log \pi \left (\mathcal {T}_{\vlambda }\left (\rvvu \right )\right ) - \nabla \log \pi \left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) {\rVert }_2^2 \\ &\quad \qquad \qquad + \left ( 2 + \delta \right ) \lVert \nabla \log q_{\vlambda ^*}\left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) - \nabla \log q_{\vlambda }\left (\mathcal {T}_{\vlambda }\left (\rvvu \right )\right ) {\rVert }_2^2 \\ &\quad \qquad \qquad + \left (1 + 2 \delta ^{-1}\right ) \lVert \nabla \log \pi \left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) - \nabla \log q_{\vlambda ^*}\left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) {\rVert }_2^2 \Big ), \shortintertext {and distributing \(J_{\mathcal {T}}\) and the expectation,} &= \left ( 2 + \delta \right ) \underbrace { \mathbb {E} J_{\mathcal {T}}\left (\rvvu \right ) \lVert \nabla \log \pi \left (\mathcal {T}_{\vlambda }\left (\rvvu \right )\right ) - \nabla \log \pi \left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) {\rVert }_2^2 }_{T_{\text {\ding {182}}}} \\ &\quad + \left ( 2 + \delta \right ) \underbrace { J_{\mathcal {T}}\left (\rvvu \right ) \mathbb {E} \lVert \nabla \log q_{\vlambda ^*}\left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) - \nabla \log q_{\vlambda }\left (\mathcal {T}_{\vlambda }\left (\rvvu \right )\right ) {\rVert }_2^2 }_{T_{\text {\ding {183}}}} \\ &\quad + \left (1 + 2 \delta ^{-1}\right ) \underbrace { \mathbb {E} J_{\mathcal {T}}\left (\rvvu \right ) \lVert \nabla \log \pi \left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) - \nabla \log q_{\vlambda ^*}\left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) {\rVert }_2^2 }_{T_{\text {\ding {184}}}}. \end {align*}\end{proof}
