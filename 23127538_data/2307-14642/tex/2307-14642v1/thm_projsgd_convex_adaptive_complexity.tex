
\begin{theoremEnd}{lemma}\label{thm:projsgd_stronglyconvex_adaptive_complexity}
  For the Projected SGD with a gradient estimator satisfying  
  \[
    \norm{\rvvg\left(\vlambda\right)}_2^2 \leq (1 + C \delta) \widetilde{\alpha} \, \norm{\vlambda - \vlambda^*}_2^2 + (1 + C^{-1} \delta^{-1}) \,\widetilde{\beta}
  \]
  for some arbitrary constant \(\delta \geq 0\).
  An suboptimality of \(\norm{\vlambda^* - \vlambda_{T}}_2^2\) can be achieved as long as
  \[
    \gamma \leq
    \min\left(
    \right)  \quad\text{and}\quad
    %
    T \geq
  \]
\end{theoremEnd}
\begin{proofEnd}
  Recall that, for a stepsize
  \begin{align*}
    \gamma \leq \min\left( \frac{\epsilon}{\beta}, \frac{1}{\sqrt{2 \alpha}} \right),
  \end{align*}
  with a number of steps at least
  \begin{align*}
    T \geq \max\left( \frac{ \alpha }{ \beta } + \frac{\beta}{\epsilon^2}, \frac{\sqrt{2 \alpha}}{\epsilon} \right) \norm{\vlambda_0 - \vlambda^*}_2^2,
  \end{align*}
  we can guarantee that the iterate \(\vlambda_t\) can guarantee \(F\left(\vlambda\right) - F^* \leq \epsilon\).

  We optimize the parameter \(\delta\) to minimize the number of steps.
  That is,
  \begin{align*}
    &\max\left( \frac{ \alpha }{ \beta } + \frac{\beta}{\epsilon^2}, \frac{\sqrt{2 \alpha}}{\epsilon} \right)
    \\
    &\;=
    \max\left( \frac{\left(1 + C \delta\right) \widetilde{\alpha} }{\left(1 + C^{-1} \delta^{-1}\right) \widetilde{\beta} } + \frac{\left(1 + C^{-1} \delta^{-1}\right) \widetilde{\beta}}{\epsilon^2}, \frac{\sqrt{2 \left(1 + C \delta\right) \widetilde{\alpha} }}{\epsilon} \right).
  \end{align*}
  Since each term in the max function are monotonic with respect to \(\delta\), the optimum is unique, and achieved when the two terms are equal.
  That is,
  \begin{alignat*}{2}
    & &
    2 (1 + C^{-1} \delta^{-1}) \,\widetilde{\beta} \frac{1}{\epsilon}
    &=
    (1 + C \delta) \widetilde{\alpha}
    \\
    &\Leftrightarrow&\qquad
    \frac{2 \widetilde{\beta}}{\epsilon} + \frac{2 \widetilde{\beta} C^{-1}}{\epsilon} \delta^{-1} \,
    &=
    \widetilde{\alpha} + \widetilde{\alpha} C \delta 
    \\
    &\Leftrightarrow&\qquad
    \frac{2 \widetilde{\beta}}{\epsilon} \delta +  \frac{2 \widetilde{\beta} C^{-1}}{\epsilon}  \,
    &=
    \widetilde{\alpha} \delta + \widetilde{\alpha} C \delta^2
    \\
    &\Leftrightarrow&\qquad
    %
    \widetilde{\alpha} C \delta^2 + \left( \widetilde{\alpha} - \frac{2 \widetilde{\beta}}{\epsilon} \right) \delta - \frac{2 \widetilde{\beta} C^{-1}}{\epsilon}
    &=
    0
  \end{alignat*}
  Conveniently, this is a quadratic with the unique solution
  \begin{alignat*}{2}
    \delta
    &=
    \frac{
      - \left( \widetilde{\alpha} - \frac{2 \widetilde{\beta}}{\epsilon} \right)
      +
      \sqrt{
        {\left(\widetilde{\alpha} - \frac{2 \widetilde{\beta}}{\epsilon} \right)}^2
        +
        8 \frac{\widetilde{\alpha} \widetilde{\beta} C C^{-1}}{\epsilon}
      }
    }{
      2 \widetilde{\alpha} C 
    }
    \\
    &=
    \frac{
      - \left( \widetilde{\alpha} - \frac{2 \widetilde{\beta}}{\epsilon} \right)
      +
      \sqrt{
        \widetilde{\alpha}^2 - 4 \frac{\widetilde{\alpha} \widetilde{\beta}}{\epsilon} +  {\left( \frac{2 \widetilde{\beta}}{\epsilon} \right)}^2
        +
        8 \frac{\widetilde{\alpha} \widetilde{\beta} }{\epsilon}
      }
    }{
      2 \widetilde{\alpha} C 
    }
    \\
    &=
    \frac{
      - \left( \widetilde{\alpha} - \frac{2 \widetilde{\beta}}{\epsilon} \right)
      +
      \sqrt{
        \widetilde{\alpha}^2
        + 4 \frac{\widetilde{\alpha} \widetilde{\beta}}{\epsilon}
        + {\left( \frac{2 \widetilde{\beta}}{\epsilon} \right)}^2
      }
    }{
      2 \widetilde{\alpha} C
    }
    \\
    &=
    \frac{
      - \left( \widetilde{\alpha} - \frac{2 \widetilde{\beta}}{\epsilon} \right)
      +
      \sqrt{
        {\left(
          \widetilde{\alpha}
          +
          \frac{2 \widetilde{\beta}}{\epsilon} 
        \right)}^2
      }
    }{
      2 \widetilde{\alpha} C
    }
    \\
    &=
    \frac{
      - \widetilde{\alpha} + \frac{2 \widetilde{\beta}}{\epsilon}
      +
      \widetilde{\alpha}
      +
      \frac{2 \widetilde{\beta}}{\epsilon}
    }{
      2 \widetilde{\alpha} C
    }
    \\
    &=
    2 
    \frac{
      \widetilde{\beta}
    }{
      \widetilde{\alpha} 
    }
    C^{-1}
    \epsilon^{-1}.
  \end{alignat*}

  Thus, the optimal bound is obtained by setting
  \(
    \delta
    = 2 
    \frac{
      \widetilde{\beta}
    }{
      \widetilde{\alpha} 
    }
    C^{-1}
    \epsilon^{-1}.
  \)
  \begin{align*}
    T
    &\geq
    \frac{2}{\mu^2} \max\left(  2 \beta \frac{1}{\epsilon}, \alpha \right) \log \left( 2 \norm{\vlambda_0 - \vlambda^*}_2^2 \, \frac{1}{\epsilon} \right)
    \\
    &=
    \frac{2}{\mu^2} \max\left( 2 \left( 1 + C^{-1} \delta^{-1} \right) \widetilde{\beta}  \frac{1}{\epsilon},  \left( 1 + C \delta \right) \widetilde{\alpha} \right) \log \left( 2 \norm{\vlambda_0 - \vlambda^*}_2^2 \, \frac{1}{\epsilon} \right)
    \\
    &=
    \frac{2}{\mu^2} \left(\widetilde{\alpha} + 2 \widetilde{\beta} \frac{1}{\epsilon}\right) \log \left( 2 \norm{\vlambda_0 - \vlambda^*}_2^2 \, \frac{1}{\epsilon} \right)
  \end{align*}

  \begin{align*}
    \gamma
    &\leq
    \min\left( \frac{\epsilon \mu}{4 \beta}, \frac{\mu}{2 \alpha}, \frac{2}{\mu} \right)
    \\
    &=
    \min\left( \frac{\epsilon \mu}{4 (1 + C^{-1} \delta^{-1}) \widetilde{\beta}} \,, \; \frac{\mu}{2 (1 + C \delta) \widetilde{\alpha}}, \frac{2}{\mu} \right)
    \\
    &=
    \min\left(
      \frac{1}{2}
      \frac{
        \mu
      }{
        \widetilde{\alpha} + 2 \widetilde{\beta} \epsilon^{-1} 
      }\, ,\;
      \frac{2}{\mu}
    \right).
  \end{align*}
  
\end{proofEnd}
