
% \subsection{Auxiliary Lemmas}
% \vspace{1ex}

\begin{theoremEnd}[all end, category=external]{lemma}[\citealt{domke_provable_2019}, Lemma 9]
\label{thm:u_identities}
  Let \(\rvvu = \left(\rvu_1, \rvu_2, \ldots, \rvu_d\right)\) be a \(d\)-dimensional vector-valued random variable with zero-mean independently and identically distributed components.
  Then,
  \begin{alignat*}{4}
    &\mathbb{E}\rvvu \rvvu^{\top} &&= \left( \mathbb{E} \rvu_i^2 \right) \boldupright{I}\qquad
    &&\mathbb{E}\norm{\rvvu}_2^2 &&= d \, \mathbb{E} \rvu_i^2
    \\
    &\mathbb{E} \rvvu \left( 1 + \norm{\rvvu}_2^2 \right) &&= \left( \mathbb{E} \rvu_i^3 \right) \mathbf{1}\qquad
    &&\mathbb{E} \rvvu \rvvu^{\top} \rvvu \rvvu^{\top} &&= \left( \left(d - 1\right) \, {\left( \mathbb{E} \rvu_i^2 \right)}^2 + \mathbb{E}\rvu_i^4 \right) \boldupright{I}.
  \end{alignat*}
\end{theoremEnd}

%% \begin{theoremEnd}[all end, category=external]{lemma}\label{thm:reparam_u_identity}
%%   Let \(\vt_{\vlambda}: \mathbb{R}^d \rightarrow \mathbb{R}^d\) be a location-scale reparameterizaiton function (\cref{def:reparam}).
%%   Also, let \(\vz \in \mathbb{R}^d\) be some vector and \(\rvvu \sim \varphi\) satisfy~\cref{assumption:symmetric_standard}.
%%   Then,
%%   \begin{alignat*}{2}
%%     \mathbb{E} J_{\mathcal{T}}\left(\rvvu\right) \norm{\mathcal{T}_{\vlambda}\left(\rvvu\right) - \vz}_2^2 
%%     =
%%     C_1\left(d, \varphi\right) \norm{ \vm - \vz }_2^2
%%     +
%%     C_2\left(d, \varphi\right) \norm{ \mC }_{\mathrm{F}}^2
%%   \end{alignat*}
%% \end{theoremEnd}

\begin{theoremEnd}[all end, category=external]{lemma}\label{thm:jacobian_reparam_inner}
  Let \(\mathcal{T}_{\vlambda}: \mathbb{R}^p \times \mathbb{R}^d \rightarrow \mathbb{R}^d\) be the location-scale reparameterization function (\cref{def:reparam}).
  Then, for any differentiable function \(f\), we have
  \[
    \norm{\nabla_{\vlambda} f\left( \mathcal{T}_{\vlambda}\left(\vu\right) \right) }_2^2 
    = 
    J_{\mathcal{T}}\left(\rvvu\right) \norm{\nabla f\left( \mathcal{T}_{\vlambda}\left(\vu\right) \right) }_2^2.
  \]
  for any \(\vlambda \in \mathbb{R}^p\) and \(\vu \in \mathbb{R}^d\), where \(J_{\mathcal{T}}\left(\vu\right) : \mathbb{R}^d \to \mathbb{R}\) is a function defined as
  \begin{alignat*}{2}
    J_{\mathcal{T}}\left(\vu\right) &= 1 + {\textstyle\sum^{d}_{i=1} u_i^2} \quad                        &&\quad \text{for the full-rank and} \\
    J_{\mathcal{T}}\left(\vu\right) &= 1 + {\textstyle\sqrt{\sum^{d}_{i=1} u_i^4}} &&\quad \text{for the mean-field parameterizations.}
  \end{alignat*}
\end{theoremEnd}
\begin{proofEnd}
  The result is a collection of the results of \citet[Lemma 1]{domke_provable_2019} for the full-rank parameterization and \citet[Lemma 2]{kim_practical_2023} for the mean-field parameterization.
\end{proofEnd}

\begin{theoremEnd}[all end, category=external]{lemma}[Corollary 3; \citealp{kim_blackbox_2023}]\label{thm:u_normsquared_marginalization}
  Assume \cref{assumption:symmetric_standard} and let \(\mathcal{T}_{\vlambda}: \mathbb{R}^d \rightarrow \mathbb{R}^d\) (\cref{def:reparam}) be the location-scale reparameterization function.
  Then, for any \(\vlambda, \vlambda^{\prime} \in \mathbb{R}^p\),
  \[
    \mathbb{E} J_{\mathcal{T}}\left(\rvvu\right) \norm{\mathcal{T}_{\vlambda^{\prime}}\left(\rvvu\right) - \mathcal{T}_{\vlambda}\left(\rvvu\right) }_2^2
    \leq
    C\left(d, \varphi\right) \norm{\vlambda - \vlambda'}_2^2,
  \]
  where 
  \begin{alignat*}{2}
    C\left(d, \varphi\right) &= d + k_{\varphi}            &&\quad \text{for the full-rank and} \\
    C\left(d, \varphi\right) &= 2 k_{\varphi} \sqrt{d} + 1 &&\quad \text{for the mean-field parameterizations.}
  \end{alignat*}
\end{theoremEnd}

\begin{theoremEnd}[all end, category=external]{lemma}[Lemma 2; \citealp{domke_provable_2019}]\label{thm:normdist_1pnormu}
  Assume \cref{assumption:symmetric_standard} and let \(\mathcal{T}_{\vlambda}: \mathbb{R}^d \rightarrow \mathbb{R}^d\) (\cref{def:reparam}) be the location-scale reparameterization function.
  Then, for the full-rank parameterization,
  \[
    \mathbb{E} J_{\mathcal{T}}\left(\rvvu\right) \norm{\mathcal{T}_{\vlambda}\left(\rvvu\right) - \bar{\vz}}_2^2
    =
    C_1\left(d, \varphi\right) \norm{ \vm - \bar{\vz} }_2^2 + C_2\left(d, \varphi\right) \norm{\mC}_{\mathrm{F}}^2.
  \]
  where
  \begin{alignat*}{4}
    C_1\left(d, \varphi\right)  &= d + 1,\quad
    &C_2\left(d, \varphi\right) &= d + k_{\varphi},
    &&\quad \text{for the full-rank and} \\
    C_1\left(d, \varphi\right)  &= \sqrt{d k_{\varphi}} + k \sqrt{d} + 1,\quad
    &C_2\left(d, \varphi\right) &= 2 \kappa \sqrt{d} + 1,
    &&\quad \text{for the mean-field parameterizations.}
  \end{alignat*}
\end{theoremEnd}
\begin{proofEnd}
  The result is a collection of the results of \citet[Lemma 2]{domke_provable_2019} for the full-rank parameterization and \citet[Lemma 2]{kim_practical_2023} for the mean-field parameterization.
\end{proofEnd}
