

\prAtEndRestateiv*

\makeatletter\Hy@SaveLastskip\label{proofsection:prAtEndiv}\ifdefined\pratend@current@sectionlike@label\immediate\write\@auxout{\string\gdef\string\pratend@section@for@proofiv{\pratend@current@sectionlike@label}}\fi\Hy@RestoreLastskip\makeatother\begin{proof}[Proof]\phantomsection\label{proof:prAtEndiv}We analyze each of the terms in \cref {thm:stl_decomposition}. \par \paragraph {Bound on \(T_{\text {\ding {182}}}\)} For \(T_{\text {\ding {182}}}\), we obtain the quadratic bound from the optimum as \begin {align} T_{\text {\ding {182}}} &= \mathbb {E} J_{\mathcal {T}}\left (\rvvu \right ) \norm { \nabla \log \pi \left (\mathcal {T}_{\vlambda }\left (\rvvu \right )\right ) - \nabla \log \pi \left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) }_2^2, \nonumber \shortintertext {due to \(L\)-log-smoothness,} &\leq L^2 \, \mathbb {E} J_{\mathcal {T}}\left (\rvvu \right ) \norm { \mathcal {T}_{\vlambda }\left (\rvvu \right ) - \mathcal {T}_{\vlambda ^*}\left (\rvvu \right ) }_2^2, \label {eq:stl_upperbound_t1_inter} \shortintertext {and by \cref {thm:u_normsquared_marginalization},} &\leq L^2 \left (d + k_{\varphi }\right ) \norm {\vlambda - \vlambda ^*}_2^2. \label {eq:stl_upperbound_t181} \end {align} \par \paragraph {Bound on \(T_{\text {\ding {183}}}\)} Now for, \begin {align*} T_{\text {\ding {183}}} = \mathbb {E} J_{\mathcal {T}}\left (\rvvu \right ) \norm { \nabla \log q_{\vlambda ^*}\left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) - \nabla \log q_{\vlambda }\left (\mathcal {T}_{\vlambda }\left (\rvvu \right )\right ) }_2^2, \end {align*} we use the fact that, for location-scale family distributions, the log-probability density is \[ \log q_{\vlambda }\left ( \vz \right ) = \log \phi \left ( \mC ^{-1}\left (\vz - \vm \right ) \right ) - \log \abs {\mC }. \] Considering reparameterization, \begin {align*} \log q_{\vlambda }\left ( \mathcal {T}_{\vlambda }\left (\vu \right ) \right ) &= \log \varphi \left ( \mC ^{-1}\left ( \mathcal {T}_{\vlambda }\left (\vu \right ) - \vm \right ) \right ) - \log \abs {\mC } \\ &= \log \varphi \left ( \mC ^{-1}\left ( \left ( \mC \vu + \vm \right ) - \vm \right ) \right ) - \log \abs {\mC } \\ &= \log \varphi \left ( \vu \right ) - \log \abs {\mC }. \end {align*} This implies \begin {align*} \nabla \log q_{\vlambda }\left ( \mathcal {T}_{\vlambda }\left (\vu \right ) \right ) = \nabla _{\vlambda } \log \phi \left ( \vu \right ) - \nabla \log \abs {\mC } = - \nabla \log \abs {\mC } = \nabla h\left (\vlambda \right ). \end {align*} \par Thus, \begin {align*} \norm { \nabla \log q_{\vlambda }\left ( \mathcal {T}_{\vlambda }\left (\vu \right ) \right ) - \nabla \log q_{\vlambda '}\left ( \mathcal {T}_{\vlambda '}\left (\vu \right ) \right ) }_2^2 &= \norm { \nabla h\left (\vlambda \right ) - \nabla h\left (\vlambda ^{\prime }\right ) }_2^2, \shortintertext {and since the entropy is \(S\)-smooth in \(\Lambda _{S}\) with respect to \(\mC \) \citep [Lemma 12]{domke_provable_2020},} &\leq S^2 \, \norm { {\mC } - {\mC '} }^2_{\mathrm {F}}. \end {align*} Therefore, \begin {align} T_{\text {\ding {183}}} &= \mathbb {E} J_{\mathcal {T}}\left (\rvvu \right ) \norm { \nabla \log q_{\vlambda ^*}\left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) - \nabla \log q_{\vlambda }\left (\mathcal {T}_{\vlambda }\left (\rvvu \right )\right ) }_2^2 \nonumber \\ &\leq S^{2} J_{\mathcal {T}}\left (\rvvu \right ) \norm { {\mC } - {\mC ^*} }^2_{\mathrm {F}}, \label {eq:stl_upperbound_t2_inter} \shortintertext {by the definition of \(J_{\mathcal {T}}\) in \cref {thm:jacobian_reparam_inner},} &= S^{2} \left (1 + \mathbb {E} \sum ^{d}_{i=1} \rvu _i^2 \right ) \norm { {\mC } - {\mC ^*} }^2_{\mathrm {F}}, \nonumber \shortintertext {by \cref {assumption:symmetric_standard},} &= S^2 \left ( 1 + d \right ) \norm { {\mC } - {\mC ^*} }^2_{\mathrm {F}} \nonumber \shortintertext {adding the term \(\norm {\vm - \vm ^*}_2^2 \geq 0\),} &\leq S^2 \left ( 1 + d \right ) \left ( \norm { \vm - \vm ^* }_2^2 + \norm { {\mC } - {\mC ^*} }^2_{\mathrm {F}} \right ) \nonumber \\ &= S^2 \left ( 1 + d \right ) \norm {\vlambda - \vlambda ^*}_2^2. \label {eq:stl_upperbound_t182} \end {align} \par \paragraph {Bound on \(T_{\text {\ding {184}}}\)} Finally, for \(T_{\text {\ding {184}}}\), \begin {align} T_{\text {\ding {184}}} &= \mathbb {E} J_{\mathcal {T}}\left (\rvvu \right ) \lVert \nabla \log \pi \left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) - \nabla \log q_{\vlambda ^*}\left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) {\rVert }_2^2, \nonumber \shortintertext {by the definition of \(J_{\mathcal {T}}\) in \cref {thm:jacobian_reparam_inner},} &= \mathbb {E} \left (1 + \sum ^{d}_{i=1} \rvu _i^2 \right ) \lVert \nabla \log \pi \left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) - \nabla \log q_{\vlambda ^*}\left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) {\rVert }_2^2 \nonumber \\ &= \mathbb {E} \left (1 + \norm {\rvvu }_2^2 \right ) \lVert \nabla \log \pi \left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) - \nabla \log q_{\vlambda ^*}\left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) {\rVert }_2^2, \nonumber \shortintertext {through the Cauchy-Schwarz inequality,} &\leq \sqrt { \mathbb {E} {\left (1 + \norm {\rvvu }_2^2 \right )}^2 } \sqrt { \lVert \nabla \log \pi \left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) - \nabla \log q_{\vlambda ^*}\left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) {\rVert }_2^4 } \nonumber \\ &= \sqrt { \left ( 1 + 2 \mathbb {E} \norm {\rvvu }_2^2 + \mathbb {E} \norm {\rvvu }_2^4 \right )} \, \sqrt { \mathbb {E} \lVert \nabla \log \pi \left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) - \nabla \log q_{\vlambda ^*}\left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) {\rVert }_2^4 }, \nonumber \shortintertext {by \cref {thm:u_identities,assumption:symmetric_standard}, the \(2 \, \mathbb {E} \norm {\rvvu }_2^2\) term becomes} &= \sqrt { 1 + 2 d + \mathbb {E} \norm {\rvvu }_2^4 \, } \sqrt { \mathbb {E} \lVert \nabla \log \pi \left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) - \nabla \log q_{\vlambda ^*}\left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) {\rVert }_2^4 }. \label {eq:stl_upperbound_t183} \end {align} \par Meanwhile, \(\mathbb {E} \norm {\rvvu }_2^4\) can be bounded as \begin {align*} \mathbb {E} \norm {\rvvu }_2^4 &= \mathbb {E} {\left ( \norm {\rvvu }_2^2 \right )}^2 = \mathbb {E} {\left ( \sum ^{d}_{i=1} \rvu _i^2 \right )}^2, \\ &= \mathbb {E} \left ( \sum ^{d}_{i=1} \rvu _i^4 + \sum _{i \neq j} \rvu _i^2 \rvu _j^2 \right ), \shortintertext {while from \cref {assumption:symmetric_standard}, \(u_i \neq u_j\) are independent for \(i \neq j\). Thus} &= \sum ^{d}_{i=1} \mathbb {E} \rvu _i^4 + \sum _{i \neq j} \mathbb {E}\rvu _i^2 \, \mathbb {E}\rvu _j^2, \shortintertext {and by \cref {assumption:symmetric_standard}, we have \(\mathbb {E} \rvu _i^4 = k_{\varphi }\), \(\mathbb {E}\rvu _i^2 = 1\), and \(\mathbb {E}\rvu _j^2\). Therefore,} &= d k_{\varphi } + {d \choose 2}, \shortintertext {and applying the well-known upper bound on the binomial coefficient \({d \choose 2} \leq {\left (\frac {\mathrm {e} d}{2}\right )}^2\),} &\leq d k_{\varphi } + {\left (\frac {\mathrm {e}}{2}\right )}^2 d^2. \end {align*} \par Applying this to first term in \cref {eq:stl_upperbound_t183}, \begin {align} \sqrt { 1 + 2 d + \mathbb {E}\norm {\rvvu }_2^4 } &\leq \sqrt { 1 + 2 d + k_{\varphi } d + {\left (\frac {\mathrm {e}}{2}\right )}^2 d^2 } \nonumber \\ &= \sqrt { 1 + 2 \left ( 1 + \frac {k_{\varphi }}{2} \right ) d + {\left (\frac {\mathrm {e}}{2}\right )}^2 d^2 }, \nonumber \shortintertext {and since \(k_{\varphi } \geq 1\), \quad \(\mathrm {e}/2 \leq \sqrt {3}\), \quad \(1 + k_{\varphi }/2 \leq \sqrt {3} k_{\varphi }\), and \quad \(1 \leq 3 k_{\varphi }^2\),} &\leq \sqrt { 3 k_{\varphi }^2 + 2 \sqrt {3} k_{\varphi } d + 3 d^2 } \nonumber \\ &= \sqrt { {\left ( \sqrt {3} k_{\varphi } + \sqrt {3} d \right )}^2 } \nonumber \\ &= \sqrt {3} \left ( k_{\varphi } + d \right ) \label {eq:stl_upperbound_t183_eq2} \end {align} \par Thus, \(T_{\text {\ding {184}}}\) can be bounded as \begin {align} T_{\text {\ding {184}}} &\leq \sqrt { 1 + 2 d + \mathbb {E} \norm {\rvvu }_2^4 \, } \sqrt { \mathbb {E} \lVert \nabla \log \pi \left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) - \nabla \log q_{\vlambda ^*}\left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) {\rVert }_2^4 }, \nonumber \shortintertext {applying \cref {eq:stl_upperbound_t183_eq2},} &\leq \sqrt {3} \left ( d + k_{\varphi }\right ) \sqrt { \mathbb {E} \lVert \nabla \log \pi \left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) - \nabla \log q_{\vlambda ^*}\left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) {\rVert }_2^4 } \nonumber \shortintertext {applying Change-of-Variable on the score term,} &= \sqrt {3} \left ( d + k_{\varphi }\right ) \sqrt { \mathbb {E}_{\rvvz \sim q_{\vlambda ^*}} \lVert \nabla \log \pi \left ( \rvvz \right ) - \nabla \log q_{\vlambda ^*}\left ( \rvvz \right ) {\rVert }_2^4 }, \nonumber \shortintertext {and by the definition of the 4th order Fisher-Hyv\"arinen divergence,} &\leq \sqrt {3} \left ( d + k_{\varphi } \right ) \sqrt {\mathrm {D}_{\mathrm {F}^4}\left (q_{\vlambda ^*}, \pi \right )}. \label {eq:stl_upperbound_t183_eq3} \end {align} \par Combining \cref {eq:stl_upperbound_t181,eq:stl_upperbound_t182,eq:stl_upperbound_t183_eq3} with \cref {thm:stl_decomposition}, \begin {align*} \mathbb {E} \norm {\rvvg _{\mathrm {STL}}\left (\vlambda \right )}_2^2 &\leq (2 + \delta ) T_{\text {\ding {182}}} + (2 + \delta ) T_{\text {\ding {183}}} + (1 + 2 \delta ^{-1}) T_{\text {\ding {184}}} \\ &\leq L^2 (2 + \delta ) \left (d + k_{\varphi }\right ) \norm {\vlambda - \vlambda ^*}_2^2 + S^{2} (2 + \delta ) \left ( d + 1 \right ) \norm { \vlambda - \vlambda ^* }^2_{2} \\ &\qquad + (1 + 2 \delta ^{-1}) \sqrt {3} \left ( d + k_{\varphi } \right ) \sqrt {\mathrm {D}_{\mathrm {F}^4}\left (q_{\vlambda ^*}, \pi \right )} \\ &= (2 + \delta ) \left ( L^2 \, \left (d + k_{\varphi }\right ) + S^{2} \left (d + 1\right ) \right ) \norm {\vlambda - \vlambda ^*}_2^2 \\ &\qquad + (1 + 2 \delta ^{-1}) \sqrt {3} \left ( d + k_{\varphi } \right ) \sqrt {\mathrm {D}_{\mathrm {F}^4}\left (q_{\vlambda ^*}, \pi \right )}. \end {align*}\end{proof}
