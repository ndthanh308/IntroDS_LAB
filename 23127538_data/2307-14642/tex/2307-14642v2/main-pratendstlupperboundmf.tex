

\begin{restatable}[]{theorem}{prAtEndRestatev}\label{thm:prAtEndv}\label {thm:stl_upperbound_mf} Assume \cref {assumption:variation_family} and that \(\pi \) is \(L\)-log-smooth. For the mean-field parameterization, the expected-squared norm of the STL estimator is bounded as { \begin {align*} \mathbb {E} \norm {\rvvg _{\mathrm {STL}}\left (\vlambda \right )}_2^2 \leq (2 + \delta ) \left ( L^2 \, \left ( 2 k_{\varphi } \sqrt {d} + 1 \right ) + S^{2} \left ( \sqrt { d k_{\varphi } } + 1 \right ) \right ) \norm {\vlambda - \vlambda ^*}_2^2 + (1 + 2 \delta ^{-1}) \left ( 1 + \sqrt { d k_{\varphi } } \right ) \sqrt {\mathrm {D}_{\mathrm {F}^4}\left (q_{\vlambda ^*}, \pi \right )} \end {align*} }for any \(\vlambda , \vlambda ^* \in \Lambda _S\) and any \(\delta > 0\).\end{restatable}

\makeatletter\Hy@SaveLastskip\label{proofsection:prAtEndv}\ifdefined\pratend@current@sectionlike@label\immediate\write\@auxout{\string\gdef\string\pratend@section@for@proofv{\pratend@current@sectionlike@label}}\fi\Hy@RestoreLastskip\makeatother\begin{proof}[Proof]\phantomsection\label{proof:prAtEndv}\label {proof:stl_upperbound_mf} Similarly with \cref {thm:stl_upperbound}, we analyze each term in \cref {thm:stl_decomposition}. \par \paragraph {Bound on \(T_{\text {\ding {182}}}\)} The process for \(T_{\text {\ding {182}}}\) is more or less identical to \cref {thm:stl_upperbound}. Starting from~\cref {eq:stl_upperbound_t1_inter}, \begin {align} T_{\text {\ding {182}}} &\leq L^2 \, \mathbb {E} J_{\mathcal {T}}\left (\rvvu \right ) \norm { \mathcal {T}_{\vlambda }\left (\rvvu \right ) - \mathcal {T}_{\vlambda ^*}\left (\rvvu \right ) }_2^2, \nonumber \shortintertext {and applying \cref {thm:u_normsquared_marginalization},} &\leq \left ( 2 k_{\varphi } \sqrt {d} + 1 \right ) \norm {\vlambda - \vlambda ^*}_2^2. \label {eq:stl_upperbound_mf_182} \end {align} \par \paragraph {Bound on \(T_{\text {\ding {183}}}\)} This is also identical to \cref {thm:stl_upperbound} apart from \(J_{\mathcal {T}}\). Resuming from~\cref {eq:stl_upperbound_t2_inter}, \begin {align} T_{\text {\ding {183}}} &\leq S^{2} \mathbb {E} J_{\mathcal {T}} \norm { {\mC } - {\mC ^*} }^2_{\mathrm {F}} \nonumber \shortintertext {by the definition of \(J_{\mathcal {T}}\) in \cref {thm:jacobian_reparam_inner},} &= S^{2} \left ( 1 + \mathbb {E} \sqrt { \sum _{i=1}^d \rvu _i^4 } \right ) \norm { {\mC } - {\mC ^*} }^2_{\mathrm {F}}, \nonumber \shortintertext {by Jensen's inequality,} &\leq S^{2} \left ( 1 + \sqrt { \sum _{i=1}^d \mathbb {E} \rvu _i^4 } \right ) \norm { {\mC } - {\mC ^*} }^2_{\mathrm {F}}, \nonumber \shortintertext {from \cref {assumption:symmetric_standard},} &= S^{2} \left ( 1 + \sqrt { d k_{\varphi } } \right ) \norm { {\mC } - {\mC ^*} }^2_{\mathrm {F}}, \nonumber \shortintertext {and adding the \(\norm {\vm - \vm ^*}_2^2\) term,} &\leq S^{2} \left ( 1 + \sqrt { d k_{\varphi } } \right ) \norm { {\vlambda } - {\vlambda ^*} }^2_{2}. \label {eq:stl_upperbound_mf_183} \end {align} \par \paragraph {Bound on \(T_{\text {\ding {184}}}\)} The derivation for \(T_{\text {\ding {184}}}\) is less technical than the full-rank case. Denoting \(\rvmU = \mathrm {diag}\left (\rvu _1, \ldots , \rvu _d\right )\) for clarity, we have \begin {equation} \textstyle {\sqrt {\sum _{i=1}^d \rvu _i^4 } = {\lVert \rvmU ^2 \rVert }_{\mathrm {F}}}. \label {eq:stl_upperbound_meanfield_J} \end {equation} Then, \begin {align*} T_{\text {\ding {184}}} &= \mathbb {E} J_{\mathcal {T}}\left (\rvvu \right ) \lVert \nabla \log \pi \left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) - \nabla \log q_{\vlambda ^*}\left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) {\rVert }_2^2 \shortintertext {by the definition of \(J_{\mathcal {T}}\) in \cref {thm:jacobian_reparam_inner} and \cref {eq:stl_upperbound_meanfield_J},} &= \mathbb {E} \left ( 1 + {\lVert \rvmU ^2 \rVert }_{\mathrm {F}} \right ) \lVert \nabla \log \pi \left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) - \nabla \log q_{\vlambda ^*}\left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) {\rVert }_2^2, \shortintertext {through the Cauchy-Schwarz inequality,} &\leq \underbrace { \sqrt { \mathbb {E} {\left ( 1 + 2 \norm {\rvmU ^2}_{\mathrm {F}} + \norm {\rvmU ^2}_{\mathrm {F}}^2 \right )} } }_{T_{\text {\ding {172}}}} \sqrt { \mathbb {E} \lVert \nabla \log \pi \left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) - \nabla \log q_{\vlambda ^*}\left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) {\rVert }_2^4 }. \end {align*} \par \(T_{\text {\ding {172}}}\) follows as \begin {align} T_{\text {\ding {172}}} &= \sqrt { \mathbb {E} {\left ( 1 + 2 {\lVert \rvmU ^2 \rVert }_{\mathrm {F}} + {\lVert \rvmU ^2 \rVert }_{\mathrm {F}}^2 \right )} } \nonumber \\ &= \textstyle { \sqrt { \mathbb {E} {\left ( 1 + 2 \sqrt { \sum _{i=1}^d \rvu _i^4 } + \sum _{i=1}^d \rvu _i^4 \right )} }, } \nonumber \shortintertext {distributing the expectation,} &= \textstyle { \sqrt { 1 + 2 \mathbb {E} \left ( \sqrt { \sum _{i=1}^d \rvu _i^4 } \right ) + \sum _{i=1}^d \mathbb {E} \rvu _i^4 }, } \nonumber \shortintertext {applying Jensen's inequality to the middle term,} &\leq \textstyle { \sqrt { 1 + 2 \sqrt { \sum _{i=1}^d \mathbb {E} \rvu _i^4 } + \sum _{i=1}^d \mathbb {E} \rvu _i^4 }, } \nonumber \shortintertext {and from \cref {assumption:symmetric_standard},} &= \sqrt { 1 + 2 \sqrt { d k_{\varphi } } + d k_{\varphi } } = \sqrt { {\left ( 1 + \sqrt { d k_{\varphi } }\right )}^2 } \nonumber \\ &= 1 + \sqrt { d k_{\varphi } }. \label {eq:stl_upperbound_mf_184} \end {align} As in the proof of \cref {thm:stl_decomposition}, we obtain the 4th order Fisher-Hyv\"arinen divergence after Change-of-Variable. Combining this fact with \cref {eq:stl_upperbound_mf_182,eq:stl_upperbound_mf_183,eq:stl_upperbound_mf_184,thm:stl_decomposition}, \begin {align*} \mathbb {E} \norm {\rvvg _{\mathrm {STL}}\left (\vlambda \right )}_2^2 &\leq (2 + \delta ) T_{\text {\ding {182}}} + (2 + \delta ) T_{\text {\ding {183}}} + (1 + 2 \delta ^{-1}) T_{\text {\ding {184}}} \\ &\leq L^2 (2 + \delta ) \left ( 2 k_{\varphi } \sqrt {d} + 1 \right ) \norm {\vlambda - \vlambda ^*}_2^2 + S^{2} (2 + \delta ) \left ( \sqrt { d k_{\varphi } } + 1 \right ) \norm { \vlambda - \vlambda ^* }^2_{2} \\ &\qquad + (1 + 2 \delta ^{-1}) \left (\sqrt { d k_{\varphi } } + 1\right ) \sqrt {\mathrm {D}_{\mathrm {F}^4}\left (q_{\vlambda ^*}, \pi \right )} \\ &= (2 + \delta ) \left ( L^2 \, \left ( 2 k_{\varphi } \sqrt {d} + 1 \right ) + S^{2} \left ( \sqrt { d k_{\varphi } } + 1 \right ) \right ) \norm {\vlambda - \vlambda ^*}_2^2 \\ &\qquad + (1 + 2 \delta ^{-1}) \left ( \sqrt { d k_{\varphi } } + 1 \right ) \sqrt {\mathrm {D}_{\mathrm {F}^4}\left (q_{\vlambda ^*} \pi \right )}. \end {align*}\end{proof}
