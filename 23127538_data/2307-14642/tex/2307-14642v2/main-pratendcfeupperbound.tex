

\prAtEndRestatex*

\makeatletter\Hy@SaveLastskip\label{proofsection:prAtEndx}\ifdefined\pratend@current@sectionlike@label\immediate\write\@auxout{\string\gdef\string\pratend@section@for@proofx{\pratend@current@sectionlike@label}}\fi\Hy@RestoreLastskip\makeatother\begin{proof}[Proof]\phantomsection\label{proof:prAtEndx}\label {proof:cfe_upperbound} Following the notation of \citet {domke_provable_2023}, we denote \( \log \pi = f \). Then, starting from the definition of the variance, \begin {align} \mathbb {E} \norm { \rvvg _{\mathrm {CFE}}\left (\vlambda \right ) }_2^2 &= \mathrm {tr}\mathbb {V}\rvvg \left (\vlambda \right ) + \norm { \mathbb {E} \rvvg _{\mathrm {CFE}}\left (\vlambda \right ) }_2^2, \nonumber \shortintertext {and by the unbiasedness of \(\rvvg _{\mathrm {CFE}}\),} &= \mathrm {tr}\mathbb {V}\rvvg \left (\vlambda \right ) + \norm { \nabla F\left (\vlambda \right ) }_2^2, \nonumber \shortintertext {by the definition of \(\rvvg _{\mathrm {CFE}}\) (\cref {def:cfe}),} &= \mathrm {tr}\mathbb {V}_{\rvvz \sim q_{\vlambda }} \left ( \nabla _{\vlambda } f\left ( \rvvz \right ) + \nabla \mathbb {H}\left (q_{\vlambda }\right ) \right ) + \norm { \nabla F\left (\vlambda \right ) }_2^2. \nonumber \shortintertext {We now apply the property of the variance: the deterministic components are neglected as} &= \mathrm {tr}\mathbb {V}_{\rvvz \sim q_{\vlambda }} \nabla _{\vlambda } f\left ( \rvvz \right ) + \norm { \nabla F\left (\vlambda \right ) }_2^2 \nonumber \\ &\leq \mathbb {E}_{\rvvz \sim q_{\vlambda }} \norm { \nabla _{\vlambda } f\left ( \rvvz \right ) }_2^2 + \norm { \nabla F\left (\vlambda \right ) }_2^2. \label {eq:thm_cfe} \end {align} \par For \(L\)-log-smooth posteriors (\(L\)-smooth \(f\)), \citet [Theorem 3]{domke_provable_2019} show that \begin {align*} \mathbb {E}_{\rvvz \sim q_{\vlambda }} \norm { \nabla _{\vlambda } f\left ( \rvvz \right ) }_2^2 &\leq L^2 \left ( \left ( d + k_{\varphi } \right ) \norm { \vm - \bar {\vz } }_2^2 + \left ( d + 1 \right ) \norm { \mC }_{\mathrm {F}}^2 \right ), \shortintertext {and since \(k_{\varphi } \geq 1\),} &\leq L^2 \left ( \left ( d + k_{\varphi } \right ) \norm { \vm - \bar {\vz } }_2^2 + \left ( d + k_{\varphi } \right ) \norm { \mC }_{\mathrm {F}}^2 \right ) \\ &= L^2 \left ( d + k_{\varphi } \right ) {\lVert \vlambda - \bar {\vlambda } \rVert }_2^2, \end {align*} which is tight. \par Applying \cref {eq:peterpaul}, we have \begin {align} \mathbb {E}_{\rvvz \sim q_{\vlambda }} {\lVert \nabla _{\vlambda } f\left ( \rvvz \right ) \rVert }_2^2 &\leq L^2 \left ( d + k_{\varphi } \right ) {\lVert \vlambda - \bar {\vlambda } \rVert }_2^2 \nonumber \\ &= L^2 \left ( d + k_{\varphi } \right ) {\lVert \vlambda - \vlambda ^* + \vlambda ^* - \bar {\vlambda } \rVert }_2^2 \nonumber \\ &\leq L^2 \left ( d + k_{\varphi } \right ) \left ( \left (1 + \delta \right ) {\lVert \vlambda - \vlambda ^* \rVert }_2^2 + \left (1 + \delta ^{-1} \right ) {\lVert \vlambda ^* - \bar {\vlambda } \rVert }_2^2 \right ). \label {eq:thm_cfe_energy} \end {align} \par Now, for \(\vlambda \in \Lambda _S\),~\citet [Theorem 1 \& Lemma 12]{domke_provable_2020} show that the negative ELBO \(F\) is (\(L + S\))-smooth as \begin {align} \norm { \nabla F\left (\vlambda \right ) }_2^2 = \norm { \nabla F\left (\vlambda \right ) - \nabla F\left (\vlambda ^*\right ) }_2^2 \leq {\left (L + S \right )}^{2} \norm { \vlambda - \vlambda ^* }_2^2. \label {eq:thm_cfe_entropy} \end {align} \par Now back to \cref {eq:thm_cfe}, \begin {align*} \mathbb {E} \norm { \rvvg _{\mathrm {CFE}}\left (\vlambda \right ) }_2^2 &\leq \mathbb {E}_{\rvvz \sim q_{\vlambda }} \norm { \nabla _{\vlambda } f\left ( \rvvz \right ) }_2^2 + \norm { \nabla F\left (\vlambda \right ) }_2^2 \shortintertext {applying \cref {eq:thm_cfe_energy},} &\leq L^2 \left ( d + k_{\varphi } \right ) \left ( \left (1 + \delta \right ) {\lVert \vlambda - \vlambda ^* \rVert }_2^2 + \left (1 + \delta ^{-1} \right ) {\lVert \vlambda ^* - \bar {\vlambda } \rVert }_2^2 \right ) + \norm { \nabla F\left (\vlambda \right ) }_2^2 \shortintertext {and \cref {eq:thm_cfe_entropy},} &\leq L^2 \left ( d + k_{\varphi } \right ) \left ( \left (1 + \delta \right ) {\lVert \vlambda - \vlambda ^* \rVert }_2^2 + \left (1 + \delta ^{-1} \right ) {\lVert \vlambda ^* - \bar {\vlambda } \rVert }_2^2 \right ) + {\left (L + S \right )}^{2} \norm { \vlambda - \vlambda ^* }_2^2 \\ &= \left ( L^2 \left ( d + k_{\varphi } \right ) \left (1 + \delta \right ) + {\left (L + S \right )}^{2} \right ) {\lVert \vlambda - \vlambda ^* \rVert }_2^2 + L^2 \left ( d + k_{\varphi } \right ) \left (1 + \delta ^{-1} \right ) {\lVert \vlambda ^* - \bar {\vlambda } \rVert }_2^2. \end {align*}\end{proof}
