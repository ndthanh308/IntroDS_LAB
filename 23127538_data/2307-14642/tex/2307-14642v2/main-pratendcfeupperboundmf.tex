

\begin{restatable}[]{theorem}{prAtEndRestatexi}\label{thm:prAtEndxi}\label {thm:cfe_upperbound_mf} Assume \cref {assumption:variation_family} and that \(\pi \) is \(L\)-log-smooth. For the mean-field parameterization, the expected-squared norm of the CFE estimator is bounded as {\small \begin {align*} \mathbb {E} \norm { \rvvg _{\mathrm {CFE}}\left (\vlambda \right ) }_2^2 &\leq \big ( \left (2 k_{\varphi } \sqrt {d} + 1 \right ) \left (1 + \delta \right ) + {\left (L + S \right )}^{2} \big ) {\lVert \vlambda - \vlambda ^* \rVert }_2^2 \\ &\quad + \left (2 k_{\varphi } \sqrt {d} + 1 \right ) \left (1 + \delta ^{-1} \right ) {\lVert \vlambda ^* - \bar {\vlambda } \rVert }_2^2. \end {align*} }for any \(\vlambda \in \Lambda _S\) and \(\delta \geq 0\), where \(\bar {\vlambda } = \left (\bar {\vz }, \mathbf {0}\right )\) and \(\bar {\vz }\) is any stationary point of \(f\).\end{restatable}

\makeatletter\Hy@SaveLastskip\label{proofsection:prAtEndxi}\ifdefined\pratend@current@sectionlike@label\immediate\write\@auxout{\string\gdef\string\pratend@section@for@proofxi{\pratend@current@sectionlike@label}}\fi\Hy@RestoreLastskip\makeatother\begin{proof}[Proof]\phantomsection\label{proof:prAtEndxi}\label {proof:cfe_upperbound_mf} For the mean-field case, the only difference with \cref {thm:cfe_upperbound} is the upper bound on the energy term. The key step is the mean-field part of \cref {thm:normdist_1pnormu}, first proven by \citet {kim_practical_2023}. The remaining steps are similar to Theorem 1 of \citet {kim_practical_2023}. That is, \begin {align} \mathbb {E}_{\rvvz \sim q_{\vlambda }} \norm { \nabla _{\vlambda } f\left ( \rvvz \right ) }_2^2 &= \mathbb {E} \norm { \nabla _{\vlambda } f\left ( \mathcal {T}_{\vlambda }\left (\rvvu \right ) \right ) }_2^2, \nonumber \shortintertext {applying \cref {thm:jacobian_reparam_inner},} &= \mathbb {E} J_{\mathcal {T}}\left (\rvvu \right ) \norm { \nabla f\left ( \mathcal {T}_{\vlambda }\left (\rvvu \right ) \right ) }_2^2 \nonumber \\ &= \mathbb {E} J_{\mathcal {T}}\left (\rvvu \right ) \norm { \nabla f\left ( \mathcal {T}_{\vlambda }\left (\rvvu \right ) \right ) - \nabla f\left (\bar {\vz }\right ) }_2^2, \nonumber \shortintertext {from \(L\)-smoothness of \(f = \log \pi \),} &\leq L^2 \, J_{\mathcal {T}}\left (\rvvu \right ) \mathbb {E} \norm { \mathcal {T}_{\vlambda }\left (\rvvu \right ) - \bar {\vz } }_2^2, \nonumber \shortintertext {applying \cref {thm:normdist_1pnormu},} &\leq L^2 \left (\sqrt {dk_{\varphi }} + k_{\varphi } \sqrt {d} + 1 \right ) \norm { \vm - \bar {\vz } }_2^2 + L^2 \left (2 k_{\varphi } \sqrt {d} + 1\right ) \norm {\mC }_{\mathrm {F}}^2. \nonumber \shortintertext {and since \(k_{\varphi } \geq 1\), we have \(k_{\varphi } > \sqrt {k_{\varphi }}\), and thus} &\leq L^2 \left (2 k_{\varphi } \sqrt {d} + 1 \right ) \left ( \norm { \vm - \bar {\vz } }_2^2 + \norm {\mC }_{\mathrm {F}}^2 \right ) \nonumber \\ &= L^2 \left (2 k_{\varphi } \sqrt {d} + 1 \right ) {\lVert \vlambda - \bar {\vlambda } \rVert }_2^2. \nonumber \shortintertext {We finally apply \cref {eq:peterpaul} as} &\leq L^2 \left (2 k_{\varphi } \sqrt {d} + 1 \right ) \left ( \left (1 + \delta \right ) {\lVert \vlambda - \vlambda ^* \rVert }_2^2 + \left (1 + \delta ^{-1} \right ) {\lVert \vlambda ^* - \bar {\vlambda } \rVert }_2^2 \right ). \label {eq:cfe_meanfield_energy} \end {align} \par Combining this with \cref {eq:thm_cfe,eq:thm_cfe_entropy}, we have \begin {align*} \mathbb {E} \norm { \rvvg _{\mathrm {CFE}}\left (\vlambda \right ) }_2^2 &= \mathbb {E}_{\rvvz \sim q_{\vlambda }} \norm { \nabla _{\vlambda } f\left ( \rvvz \right ) }_2^2 + \norm { \nabla F\left (\vlambda \right ) }_2^2 \shortintertext {and applying \cref {eq:cfe_meanfield_energy},} &\leq \mathbb {E}_{\rvvz \sim q_{\vlambda }} \norm { \nabla _{\vlambda } f\left ( \rvvz \right ) }_2^2 + {\left (L + S \right )}^{2} \norm { \vlambda - \vlambda ^* }_2^2 \\ &\leq \left (2 k_{\varphi } \sqrt {d} + 1 \right ) \left ( L^2 \left (1 + \delta \right ) {\lVert \vlambda - \vlambda ^* \rVert }_2^2 + L^2 \left (1 + \delta ^{-1} \right ) {\lVert \vlambda ^* - \bar {\vlambda } \rVert }_2^2 \right ) + {\left (L + S \right )}^{2} \norm { \vlambda - \vlambda ^* }_2^2 \\ &= \left ( \left (2 k_{\varphi } \sqrt {d} + 1 \right ) L^2 \left (1 + \delta \right ) + {\left (L + S \right )}^{2} \right ) {\lVert \vlambda - \vlambda ^* \rVert }_2^2 + L^2 \left (2 k_{\varphi } \sqrt {d} + 1 \right ) \left (1 + \delta ^{-1} \right ) {\lVert \vlambda ^* - \bar {\vlambda } \rVert }_2^2. \end {align*} \par \end{proof}
