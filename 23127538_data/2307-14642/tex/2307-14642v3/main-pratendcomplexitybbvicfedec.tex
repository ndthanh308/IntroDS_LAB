

\begin{restatable}[\textbf {Complexity of Decreasing Stepsize BBVI with CFE}]{theorem}{prAtEndRestatexviii}\label{thm:prAtEndxviii}\label {thm:projsgd_bbvicfe_decstepsize_complexity} The last iterate \(\vlambda _T \in \Lambda _L\) of BBVI with the CFE estimator and projected SGD with a decreasing stepsize schedule applied to a \(\mu \)-strongly log-concave and \(L\)-log-smooth posterior is \(\epsilon \)-close to \(\vlambda ^* = \argmin _{\vlambda \in \Lambda _L} F\left (\vlambda \right ) \) such that \(\norm { \vlambda _T - \vlambda ^* }_2^2 \leq \epsilon \) if \begin {align*} T &\geq 16 \kappa ^2 \left (d + k_{\varphi } + 4\right ) \bigg ( {\lVert \bar {\vlambda } - \vlambda ^* \rVert }_2^2 \frac {1}{\epsilon } + 2 \sqrt { \norm {\vlambda _0 - \vlambda ^*}_2 } \, {\lVert \bar {\vlambda } - \vlambda ^* \rVert }_2 \, \frac {1}{\epsilon ^{3/4}} + \norm {\vlambda _0 - \vlambda ^*}_2 \frac {1}{\sqrt {\epsilon }} \bigg ). \end {align*} for some decreasing stepsize schedule \(\gamma _1, \ldots , \gamma _T\), where \(\kappa = L/\mu \) is the condition number and \(\vlambda ^* \in \Lambda \) is the optimal variational parameter.\end{restatable}

\makeatletter\Hy@SaveLastskip\label{proofsection:prAtEndxviii}\ifdefined\pratend@current@sectionlike@label\immediate\write\@auxout{\string\gdef\string\pratend@section@for@proofxviii{\pratend@current@sectionlike@label}}\fi\Hy@RestoreLastskip\makeatother\begin{proof}[Proof]\phantomsection\label{proof:prAtEndxviii}\label {proof:projsgd_bbvicfe_decstepsize_complexity} From \cref {thm:cfe_upperbound}, the CFE estimator with \(S = L\) satisfies adaptive QV with the constants \begin {align*} \alpha _{\mathrm {CFE}} = L^2 \left ( d + k_{\varphi } + 4 \right ) \left (1 + \delta \right )\qquad \text {and}\qquad \beta _{\mathrm {CFE}} = L^2 \left ( d + k_{\varphi } \right ) \left ( 1 + \delta ^{-1} \right ) {\lVert \bar {\vlambda } - \vlambda ^* \rVert }_2^2. \end {align*} Furthermore, for a \(\mu \)-strongly log-concave posterior and our variational parameterization,~\citet [Theorem 9]{domke_provable_2020} show that the ELBO is \(\mu \)-strongly convex. \par We thus invoke \cref {thm:projsgd_stronglyconvex_decstepsize_adaptive_complexity} with \begin {alignat*}{3} \widetilde {\alpha } = L^2 \left (d + k_{\varphi } + 4\right ), \qquad \quad \widetilde {\beta } = L^2 \left (d + k_{\varphi }\right ) {\lVert \bar {\vlambda } - \vlambda ^* \rVert }_2^2, \qquad \text {and} \qquad C = 1. \end {alignat*} This yields a lower bound on the number of iterations: \begin {align*} &\frac {16 \widetilde {\beta } }{ \mu ^2 } \frac {1}{\epsilon } + \frac {16 \sqrt {2}}{ \mu ^2 } \sqrt { \norm {\vlambda _0 - \vlambda ^*}_2 } \, \sqrt { \widetilde {\alpha } \widetilde {\beta } } \, \frac {1}{\epsilon ^{3/4}} + \frac {8 \widetilde {\alpha } \, \norm {\vlambda _0 - \vlambda ^*}_2 }{ \mu ^2} \frac {1}{\sqrt {\epsilon }} \\ &= \frac {16 L^2 \left (d + k_{\varphi }\right ) {\lVert \bar {\vlambda } - \vlambda ^* \rVert }_2^2 }{ \mu ^2 } \frac {1}{\epsilon } + \frac {16 \sqrt {2}}{ \mu ^2 } \sqrt { \norm {\vlambda _0 - \vlambda ^*}_2 } \, \sqrt { \left ( L^2 \left (d + k_{\varphi } + 4\right ) \right ) \left ( L^2 \left (d + k_{\varphi }\right ) {\lVert \bar {\vlambda } - \vlambda ^* \rVert }_2^2 \right ) } \, \frac {1}{\epsilon ^{3/4}} \\ &\qquad + \frac {8 L^2 \left (d + k_{\varphi } + 4\right ) \, \norm {\vlambda _0 - \vlambda ^*}_2 }{ \mu ^2} \frac {1}{\sqrt {\epsilon }}, \shortintertext {using the trivial bound \(d + k_{\varphi } < d + k_{\varphi } + 4\),} &< \frac {16 L^2 \left (d + k_{\varphi } + 4\right ) {\lVert \bar {\vlambda } - \vlambda ^* \rVert }_2^2 }{ \mu ^2 } \frac {1}{\epsilon } + \frac {16 \sqrt {2}}{ \mu ^2 } \sqrt { \norm {\vlambda _0 - \vlambda ^*}_2 } \, \sqrt { L^4 \left (d + k_{\varphi } + 4\right ) \left (d + k_{\varphi } + 4\right ) {\lVert \bar {\vlambda } - \vlambda ^* \rVert }_2^2 } \, \frac {1}{\epsilon ^{3/4}} \\ &\qquad + \frac {8 L^2 \left (d + k_{\varphi } + 4\right ) \, \norm {\vlambda _0 - \vlambda ^*}_2 }{ \mu ^2} \frac {1}{\sqrt {\epsilon }}, \shortintertext {pulling out the \(16 \left ( d + k_{\varphi } + 4 \right ) L^2 / \mu ^2 \) factors,} &= 16 \left (d + k_{\varphi } + 4\right ) \frac {L^2}{ \mu ^2 } \bigg ( {\lVert \bar {\vlambda } - \vlambda ^* \rVert }_2^2 \frac {1}{\epsilon } + \sqrt {2} \sqrt { \norm {\vlambda _0 - \vlambda ^*}_2 } \, {\lVert \bar {\vlambda } - \vlambda ^* \rVert }_2 \, \frac {1}{\epsilon ^{3/4}} + \frac {1}{2} \norm {\vlambda _0 - \vlambda ^*}_2 \frac {1}{\sqrt {\epsilon }} \bigg ) \\ &= 16 \kappa ^2 \left (d + k_{\varphi } + 4\right ) \bigg ( {\lVert \bar {\vlambda } - \vlambda ^* \rVert }_2^2 \frac {1}{\epsilon } + \sqrt {2} \sqrt { \norm {\vlambda _0 - \vlambda ^*}_2 } \, {\lVert \bar {\vlambda } - \vlambda ^* \rVert }_2 \, \frac {1}{\epsilon ^{3/4}} + \frac {1}{2} \norm {\vlambda _0 - \vlambda ^*}_2 \frac {1}{\sqrt {\epsilon }} \bigg ). \end {align*} The optimal \(\delta \) is given as \begin {align*} \delta &= \frac { \sqrt { \norm {\vlambda _0 - \vlambda ^*}_2 } \, \epsilon ^{1/4} \, \sqrt {\widetilde {\alpha }} }{ \sqrt {2} \, C \sqrt {\widetilde {\beta }} } = \frac { \sqrt { \norm {\vlambda _0 - \vlambda ^*}_2 } \, \epsilon ^{1/4} \, \sqrt { L^2 \left (d + k_{\varphi } + 4\right ) } }{ \sqrt {2} \sqrt { L^2 \left (d + k_{\varphi }\right ) {\lVert \bar {\vlambda } - \vlambda ^* \rVert }_2^2 } } = \frac {1}{\sqrt {2} } \, \frac {\sqrt { \norm {\vlambda _0 - \vlambda ^*}_2 }}{{\lVert \bar {\vlambda } - \vlambda ^* \rVert }_2} \, \sqrt { \frac { d + k_{\varphi } + 4 }{ d + k_{\varphi } } } \, \epsilon ^{-1/4}. \end {align*}\end{proof}
