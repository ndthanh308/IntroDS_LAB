

\prAtEndRestatev*

\makeatletter\Hy@SaveLastskip\label{proofsection:prAtEndv}\ifdefined\pratend@current@sectionlike@label\immediate\write\@auxout{\string\gdef\string\pratend@section@for@proofv{\pratend@current@sectionlike@label}}\fi\Hy@RestoreLastskip\makeatother\begin{proof}[Proof]\phantomsection\label{proof:prAtEndv}\label {proof:stl_upperbound} We analyze each of the terms in \cref {thm:stl_decomposition}. \par \paragraph {Bound on \(V_{1}\)} For \(V_{1}\), we obtain the quadratic bound from the optimum as \begin {alignat}{3} V_{1} &= \mathbb {E} J_{\mathcal {T}}\left (\rvvu \right ) \norm { \nabla \log \ell \left (\mathcal {T}_{\vlambda }\left (\rvvu \right )\right ) - \nabla \log \ell \left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) }_2^2 \nonumber \\ &\leq L^2 \, \mathbb {E} J_{\mathcal {T}}\left (\rvvu \right ) \norm { \mathcal {T}_{\vlambda }\left (\rvvu \right ) - \mathcal {T}_{\vlambda ^*}\left (\rvvu \right ) }_2^2 &&\qquad \text {(\(L\)-log-smoothness)} \label {eq:stl_upperbound_t1_inter} \\ &\leq L^2 \left (d + k_{\varphi }\right ) \norm {\vlambda - \vlambda ^*}_2^2. &&\qquad \text {(\cref {thm:u_normsquared_marginalization})} \label {eq:stl_upperbound_t181} \end {alignat} \par \paragraph {Bound on \(V_{2}\)} Now for, \begin {align*} V_{2} = \mathbb {E} J_{\mathcal {T}}\left (\rvvu \right ) \norm { \nabla \log q_{\vlambda ^*}\left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) - \nabla \log q_{\vlambda }\left (\mathcal {T}_{\vlambda }\left (\rvvu \right )\right ) }_2^2, \end {align*} we use the fact that, for location-scale family distributions, the log-probability density is \[ \log q_{\vlambda }\left ( \vz \right ) = \log \varphi \left ( \mC ^{-1}\left (\vz - \vm \right ) \right ) - \log \abs {\mC }. \] Considering reparameterization, \begin {align*} \log q_{\vlambda }\left ( \mathcal {T}_{\vlambda }\left (\vu \right ) \right ) &= \log \varphi \left ( \mC ^{-1}\left ( \mathcal {T}_{\vlambda }\left (\vu \right ) - \vm \right ) \right ) - \log \abs {\mC } \\ &= \log \varphi \left ( \mC ^{-1}\left ( \left ( \mC \vu + \vm \right ) - \vm \right ) \right ) - \log \abs {\mC } \\ &= \log \varphi \left ( \vu \right ) - \log \abs {\mC }. \end {align*} This implies \begin {align*} \nabla \log q_{\vlambda }\left ( \mathcal {T}_{\vlambda }\left (\vu \right ) \right ) &= \nabla _{\vlambda } \log \phi \left ( \vu \right ) - \nabla \log \abs {\mC } \\ &= - \nabla \log \abs {\mC } \\ &= \nabla _{\vlambda } \mathbb {H}\left (q_{\vlambda }\right ). \end {align*} \par Thus, \begin {alignat}{2} V_2 &= \mathbb {E} J_{\mathcal {T}}\left (\rvvu \right ) \norm { \nabla \log q_{\vlambda ^*}\left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) - \nabla \log q_{\vlambda }\left (\mathcal {T}_{\vlambda }\left (\rvvu \right )\right ) }_2^2 \nonumber \\ &\leq S^{2} \mathbb {E} J_{\mathcal {T}}\left (\rvvu \right ) \norm { \vlambda - \vlambda ^* }^2_{2} &&\qquad \text {(\cref {thm:entropy_smoothness})} \label {eq:stl_upperbound_t2_inter} \\ &= S^{2} \left (1 + \mathbb {E} \sum ^{d}_{i=1} \rvu _i^2 \right ) \norm { \vlambda - \vlambda ^* }^2_{2} \nonumber &&\qquad \text {(definition of \(J_{\mathcal {T}}\) in \cref {thm:jacobian_reparam_inner})} \\ &= S^2 \left ( 1 + d \right ) \norm { \vlambda - \vlambda ^* }^2_{2} &&\qquad \text {(\cref {assumption:symmetric_standard})} \label {eq:stl_upperbound_t182} \end {alignat} \par \paragraph {Bound on \(V_3\)} Finally, for \(V_3\), \begin {align} V_3 &= \mathbb {E} J_{\mathcal {T}}\left (\rvvu \right ) \lVert \nabla \log \ell \left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) - \nabla \log q_{\vlambda ^*}\left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) {\rVert }_2^2, \nonumber \shortintertext {by the definition of \(J_{\mathcal {T}}\) in \cref {thm:jacobian_reparam_inner},} &= \mathbb {E} \left (1 + \sum ^{d}_{i=1} \rvu _i^2 \right ) \lVert \nabla \log \ell \left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) - \nabla \log q_{\vlambda ^*}\left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) {\rVert }_2^2 \nonumber \\ &= \mathbb {E} \left (1 + \norm {\rvvu }_2^2 \right ) \lVert \nabla \log \ell \left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) - \nabla \log q_{\vlambda ^*}\left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) {\rVert }_2^2, \nonumber \shortintertext {through the Cauchy-Schwarz inequality,} &\leq \sqrt { \mathbb {E} {\left (1 + \norm {\rvvu }_2^2 \right )}^2 } \sqrt { \mathbb {E} \lVert \nabla \log \ell \left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) - \nabla \log q_{\vlambda ^*}\left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) {\rVert }_2^4 } \nonumber \\ &= \sqrt { \left ( 1 + 2 \mathbb {E} \norm {\rvvu }_2^2 + \mathbb {E} \norm {\rvvu }_2^4 \right )} \, \sqrt { \mathbb {E} \lVert \nabla \log \ell \left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) - \nabla \log q_{\vlambda ^*}\left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) {\rVert }_2^4 }, \nonumber \shortintertext {by \cref {thm:u_identities,assumption:symmetric_standard}, the \(2 \, \mathbb {E} \norm {\rvvu }_2^2\) term becomes} &= \sqrt { 1 + 2 d + \mathbb {E} \norm {\rvvu }_2^4 \, } \, \sqrt { \mathbb {E} \lVert \nabla \log \ell \left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) - \nabla \log q_{\vlambda ^*}\left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) {\rVert }_2^4 }. \label {eq:stl_upperbound_t183} \end {align} \par Meanwhile, \(\mathbb {E} \norm {\rvvu }_2^4\) follows as \begin {align*} \mathbb {E} \norm {\rvvu }_2^4 &= \mathbb {E} {\left ( \norm {\rvvu }_2^2 \right )}^2 = \mathbb {E} {\left ( \sum ^{d}_{i=1} \rvu _i^2 \right )}^2 = \mathbb {E} \left ( \sum ^{d}_{i=1} \rvu _i^4 + \sum _{i \neq j} \rvu _i^2 \rvu _j^2 \right ), \shortintertext {while from \cref {assumption:symmetric_standard}, \(u_i\) and \(u_j\) are independent for \(i \neq j\). Thus} &= \sum ^{d}_{i=1} \mathbb {E} \rvu _i^4 + \sum _{i \neq j} \mathbb {E}\rvu _i^2 \, \mathbb {E}\rvu _j^2, \shortintertext {and by \cref {assumption:symmetric_standard}, we have \(\mathbb {E} \rvu _i^4 = k_{\varphi }\), \(\mathbb {E}\rvu _i^2 = 1\), and \(\mathbb {E}\rvu _j^2 = 1\). Therefore,} &= d k_{\varphi } + 2 {d \choose 2}, \shortintertext {and applying the well-known upper bound on the binomial coefficient \({d \choose 2} \leq {\left (\frac {\mathrm {e} d}{2}\right )}^2\),} &\leq d k_{\varphi } + 2 \, {\left (\frac {\mathrm {e}}{2} d\right )}^2 = d k_{\varphi } + \frac {\mathrm {e}^2}{2} d^2, \end {align*} where \(\mathrm {e}\) is Euler's constant. \par Applying this to first term in \cref {eq:stl_upperbound_t183}, \begin {align} \sqrt { 1 + 2 d + \mathbb {E}\norm {\rvvu }_2^4 } &\leq \sqrt { 1 + 2 d + k_{\varphi } d + \frac {\mathrm {e}^2}{2} d^2 } = \sqrt { \frac {\mathrm {e}^2}{2} d^2 + \left ( 2 + k_{\varphi }\right ) d + 1 }, \nonumber \shortintertext {and since \(k_{\varphi } \geq 1\), \quad \(d \geq 1\), and \quad \(\mathrm {e}^2/2 \leq 4 \),} &\leq \sqrt { 4 d^2 + \left ( 2 k_{\varphi } + k_{\varphi }\right ) d + k_{\varphi } } = \sqrt { 4 d^2 + 3 k_{\varphi } d + k_{\varphi }^2 } \nonumber \\ &\leq \sqrt { 4 d^2 + 4 d k_{\varphi } + k_{\varphi }^2 } \nonumber \\ &= \left ( 2 d + k_{\varphi } \right ) \label {eq:stl_upperbound_t183_eq2} \end {align} \par Thus, \(V_3\) can be bounded as \begin {align} V_3 &\leq \sqrt { 1 + 2 d + \mathbb {E} \norm {\rvvu }_2^4 \, } \sqrt { \mathbb {E} \lVert \nabla \log \ell \left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) - \nabla \log q_{\vlambda ^*}\left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) {\rVert }_2^4 }, \nonumber \shortintertext {applying \cref {eq:stl_upperbound_t183_eq2},} &\leq \left ( 2 d + k_{\varphi }\right ) \sqrt { \mathbb {E} \lVert \nabla \log \ell \left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) - \nabla \log q_{\vlambda ^*}\left (\mathcal {T}_{\vlambda ^*}\left (\rvvu \right )\right ) {\rVert }_2^4 } \nonumber \shortintertext {applying Change-of-Variable on the score term,} &= \left ( 2 d + k_{\varphi }\right ) \sqrt { \mathbb {E}_{\rvvz \sim q_{\vlambda ^*}} \lVert \nabla \log \ell \left ( \rvvz \right ) - \nabla \log q_{\vlambda ^*}\left ( \rvvz \right ) {\rVert }_2^4 } \nonumber \\ &= \left ( 2 d + k_{\varphi }\right ) \sqrt { \mathbb {E}_{\rvvz \sim q_{\vlambda ^*}} \lVert \nabla \log \pi \left ( \rvvz \right ) - \nabla \log q_{\vlambda ^*}\left ( \rvvz \right ) {\rVert }_2^4 }, \nonumber \shortintertext {and by the definition of the 4th order Fisher-Hyv\"arinen divergence,} &\leq \left ( 2 d + k_{\varphi } \right ) \sqrt {\mathrm {D}_{\mathrm {F}^4}\left (q_{\vlambda ^*}, \ell \right )}. \label {eq:stl_upperbound_t183_eq3} \end {align} \par Combining \cref {eq:stl_upperbound_t181,eq:stl_upperbound_t182,eq:stl_upperbound_t183_eq3} with \cref {thm:stl_decomposition}, \begin {align*} \mathbb {E} \norm {\rvvg _{\mathrm {STL}}\left (\vlambda \right )}_2^2 &\leq (2 + \delta ) V_1 + (2 + \delta ) V_2 + (1 + 2 \delta ^{-1}) V_3 \\ &\leq L^2 (2 + \delta ) \left (d + k_{\varphi }\right ) \norm {\vlambda - \vlambda ^*}_2^2 + S^{2} (2 + \delta ) \left ( d + 1 \right ) \norm { \vlambda - \vlambda ^* }^2_{2} \\ &\qquad + (1 + 2 \delta ^{-1}) \left ( 2 d + k_{\varphi } \right ) \sqrt {\mathrm {D}_{\mathrm {F}^4}\left (q_{\vlambda ^*}, \ell \right )} \\ &\;= (2 + \delta ) \left ( L^2 \, \left (d + k_{\varphi }\right ) + S^{2} \left (d + 1\right ) \right ) \norm {\vlambda - \vlambda ^*}_2^2 \\ &\qquad + (1 + 2 \delta ^{-1}) \left ( 2 d + k_{\varphi } \right ) \sqrt {\mathrm {D}_{\mathrm {F}^4}\left (q_{\vlambda ^*}, \ell \right )}. \end {align*}\end{proof}
