

\prAtEndRestatex*

\makeatletter\Hy@SaveLastskip\label{proofsection:prAtEndx}\ifdefined\pratend@current@sectionlike@label\immediate\write\@auxout{\string\gdef\string\pratend@section@for@proofx{\pratend@current@sectionlike@label}}\fi\Hy@RestoreLastskip\makeatother\begin{proof}[Proof]\phantomsection\label{proof:prAtEndx}\label {proof:stl_lowerbound_unimprovability} The worst case is achieved by the following: \begin {enumerate}[label=\textbf {(\roman *)}] \item \textbf {\(\log \ell \) is ill-conditioned such that the smoothness constant is large.} This results in the domain \(\Lambda _{L}\) to include ill-conditioned \(\mC \)s, which has the largest impact on the gradient variance. Furthermore, \item \textbf {\(\pi \) and \(q_{\vlambda }\) need to have the least overlap in probability volume.} This means the variance reduction effect will be minimal. \end {enumerate} For Gaussians, this is equivalent to minimizing \( {\lVert \mS ^{-1} \mSigma ^{-1} \rVert }_{\mathrm {F}}^2 \) while maximizing \({\lVert \mSigma ^{-1} \rVert }_{\mathrm {F}}^2\) and \({\lVert \mS ^{-1} \rVert }_{\mathrm {F}}^2\). \par We therefore choose \[ \pi = \mathcal {N}\left (\bar {\vz }, \mSigma \right ) \qquad q_{\vlambda } = \mathcal {N}\left (\widetilde {\vm }, \widetilde {\mS }\right ), \] where \[ \mSigma = \begin {bmatrix} L^{-1} & & & \\ & L & & \\ & & \ddots & \\ & & & L \\ \end {bmatrix}, \qquad \widetilde {\mS } = L^{-1} \boldupright {I}, \;\quad \text {and}\quad \widetilde {\vm } = \begin {bmatrix} \bar {z}_1 \\ m_2 \\ \vdots \\ m_d \end {bmatrix}, \] where \(\bar {z}_1\) is the 1st element of \(\bar {\vz }\) such that \(\widetilde {m}_1 = \bar {z}_1\). The choice of \(\widetilde {m}_1 = \bar {z}_1\) is purely for clarifying the derivation. Notice that \(\mSigma \) has \(d-1\) entries set as \(L\), only one entry set as \(L^{-1}\), and \(\widetilde {\mS } = \widetilde {\mC }\widetilde {\mC }\). Here, \(\pi \) is \(L^{-1}\)-strongly log-concave, \(L\)-log smooth, and \(\widetilde {\vlambda } = \left (\widetilde {\vm }, \widetilde {\mC }\right ) \in \Lambda _{L}\). \par \paragraph {General Gaussian \(\pi \) Lower Bound} As usual, we start from the definition of the STL estimator as \begin {align*} \mathbb {E} \norm {\rvvg _{\mathrm {STL}}\left (\vlambda \right )}_2^2 &= \mathbb {E} \norm { \nabla _{\vlambda } \log \ell \left (\mathcal {T}_{\vlambda }\left (\rvvu \right )\right ) - \nabla _{\vlambda } \log q_{\vnu }\left (\mathcal {T}_{\vlambda }\left (\rvvu \right )\right ) }_2^2 \;\Big \lvert _{\vnu = \vlambda } \shortintertext {by \cref {thm:jacobian_reparam_inner},} &= \mathbb {E} J_{\mathcal {T}}\left (\rvvu \right ) \norm { \nabla \log \ell \left (\mathcal {T}_{\vlambda }\left (\rvvu \right )\right ) - \nabla \log q_{\vnu }\left (\mathcal {T}_{\vlambda }\left (\rvvu \right )\right ) }_2^2 \;\Big \lvert _{\vnu = \vlambda }, \shortintertext {since both \(\pi \) and \(q_{\vlambda }\) are Gaussians,} &= \mathbb {E} \left (1 + \textstyle {\sum ^{d}_{i=1} \rvu _i^2} \right ) \norm { \nabla \log \ell \left (\mathcal {T}_{\vlambda }\left (\rvvu \right )\right ) - \nabla \log q_{\vlambda }\left (\mathcal {T}_{\vlambda }\left (\rvvu \right )\right ) }_2^2 \\ &= \mathbb {E} \left (1 + \textstyle {\sum ^{d}_{i=1} \rvu _i^2} \right ) \norm { \mSigma ^{-1} \left (\mathcal {T}_{\vlambda }\left (\rvvu \right ) - \bar {\vz }\right ) - \mS ^{-1} \left (\mathcal {T}_{\vlambda }\left (\rvvu \right ) - \vm \right ) }_2^2 \\ &= \mathbb {E} \left (1 + \textstyle {\sum ^{d}_{i=1} \rvu _i^2} \right ) \norm { \mSigma ^{-1} \left (\mathcal {T}_{\vlambda }\left (\rvvu \right ) - \bar {\vz }\right ) - \mS ^{-1} \left (\mathcal {T}_{\vlambda }\left (\rvvu \right ) - \bar {\vz }\right ) + \mS ^{-1} \left (\vm - \bar {\vz }\right ) }_2^2 \\ &= \mathbb {E} \left (1 + \textstyle {\sum ^{d}_{i=1} \rvu _i^2} \right ) \Big ( {\lVert \mSigma ^{-1} \left (\mathcal {T}_{\vlambda }\left (\rvvu \right ) - \bar {\vz }\right ) \rVert }_2^2 + {\lVert \mS ^{-1} \left (\mathcal {T}_{\vlambda }\left (\rvvu \right ) - \bar {\vz }\right ) \rVert }_2^2 + {\lVert \mS ^{-1} \left (\vm - \bar {\vz }\right ) \rVert }_2^2 \\ &\quad \qquad \qquad \qquad \qquad -2 \inner { \mSigma ^{-1} \left (\mathcal {T}_{\vlambda }\left (\rvvu \right ) - \bar {\vz }\right ) }{ \mS ^{-1} \left (\mathcal {T}_{\vlambda }\left (\rvvu \right ) - \bar {\vz }\right ) } \\ &\quad \qquad \qquad \qquad \qquad +2 \inner { \mSigma ^{-1} \left (\mathcal {T}_{\vlambda }\left (\rvvu \right ) - \bar {\vz }\right ) }{ \mS ^{-1} \left (\vm - \bar {\vz }\right ) } \\ &\quad \qquad \qquad \qquad \qquad -2 \inner { \mS ^{-1} \left (\mathcal {T}_{\vlambda }\left (\rvvu \right ) - \bar {\vz }\right ) }{ \mS ^{-1} \left (\vm - \bar {\vz }\right ) } \Big ), \shortintertext {distributing the expectation and \(1 + \textstyle {\sum ^{d}_{i=1} \rvu _i^2}\),} &= \mathbb {E} \left (1 + \textstyle {\sum ^{d}_{i=1} \rvu _i^2} \right ) \Big ( {\lVert \mSigma ^{-1} \left (\mathcal {T}_{\vlambda }\left (\rvvu \right ) - \bar {\vz }\right ) \rVert }_2^2 + {\lVert \mS ^{-1} \left (\mathcal {T}_{\vlambda }\left (\rvvu \right ) - \bar {\vz }\right ) \rVert }_2^2 \Big ) \\ &\quad + \mathbb {E} \left (1 + \textstyle {\sum ^{d}_{i=1} \rvu _i^2} \right ) {\lVert \mS ^{-1} \left (\vm - \bar {\vz }\right ) \rVert }_2^2 \\ &\quad -2 \, \mathbb {E} \left (1 + \textstyle {\sum ^{d}_{i=1} \rvu _i^2} \right ) \inner { \mSigma ^{-1} \left ( \mathcal {T}_{\vlambda }\left (\rvvu \right ) - \bar {\vz }\right ) }{ \mS ^{-1} \left (\mathcal {T}_{\vlambda }\left (\rvvu \right ) - \bar {\vz }\right ) } \\ &\quad +2 \, \inner { \mSigma ^{-1} \mathbb {E} \left (1 + \textstyle {\sum ^{d}_{i=1} \rvu _i^2} \right ) \left ( \mathcal {T}_{\vlambda }\left (\rvvu \right ) - \bar {\vz }\right ) }{ \mS ^{-1} \left (\vm - \bar {\vz }\right ) } \\ &\quad -2 \, \inner { \mS ^{-1} \mathbb {E} \left (1 + \textstyle {\sum ^{d}_{i=1} \rvu _i^2} \right ) \left ( \mathcal {T}_{\vlambda }\left (\rvvu \right ) - \bar {\vz }\right ) }{ \mS ^{-1} \left (\vm - \bar {\vz }\right ) }, \shortintertext {applying \cref {lemma:unorm_times_reparam,thm:u_identities} to the second term and the last two inner product terms,} &= \mathbb {E} \left (1 + \textstyle {\sum ^{d}_{i=1} \rvu _i^2} \right ) \Big ( {\lVert \mSigma ^{-1} \left (\mathcal {T}_{\vlambda }\left (\rvvu \right ) - \bar {\vz }\right ) \rVert }_2^2 + {\lVert \mS ^{-1} \left (\mathcal {T}_{\vlambda }\left (\rvvu \right ) - \bar {\vz }\right ) \rVert }_2^2 \Big ) \\ &\quad + \left (d + 1\right ) {\lVert \mS ^{-1} \left (\vm - \bar {\vz }\right ) \rVert }_2^2 \\ &\quad -2 \, \mathbb {E} \left (1 + \textstyle {\sum ^{d}_{i=1} \rvu _i^2} \right ) \inner { \mSigma ^{-1} \left ( \mathcal {T}_{\vlambda }\left (\rvvu \right ) - \bar {\vz }\right ) }{ \mS ^{-1} \left (\mathcal {T}_{\vlambda }\left (\rvvu \right ) - \bar {\vz }\right ) } \\ &\quad +2 \, \left (d + 1\right ) \inner { \mSigma ^{-1} \left ( \vm - \bar {\vz }\right ) }{ \mS ^{-1} \left (\vm - \bar {\vz }\right ) } \\ &\quad -2 \, \left (d + 1\right ) \inner { \mS ^{-1} \left (\vm - \bar {\vz }\right ) }{ \mS ^{-1} \left (\vm - \bar {\vz }\right ) }. \shortintertext {The last two inner products can be denoted as norms such that} &\;= \mathbb {E} \left (1 + \textstyle {\sum ^{d}_{i=1} \rvu _i^2} \right ) \Big ( {\lVert \mSigma ^{-1} \left (\mathcal {T}_{\vlambda }\left (\rvvu \right ) - \bar {\vz }\right ) \rVert }_2^2 + {\lVert \mS ^{-1} \left (\mathcal {T}_{\vlambda }\left (\rvvu \right ) - \bar {\vz }\right ) \rVert }_2^2 \Big ) \\ &\quad + \left (d + 1\right ) {\lVert \mS ^{-1} \left (\vm - \bar {\vz }\right ) \rVert }_2^2 \\ &\quad -2 \, \mathbb {E} \left (1 + \textstyle {\sum ^{d}_{i=1} \rvu _i^2} \right ) {\lVert \mB ^{-1} \mC ^{-1} \left ( \mathcal {T}_{\vlambda }\left (\rvvu \right ) - \bar {\vz }\right ) \rVert }_2^2 \\ &\quad +2 \left (d + 1\right ) {\lVert \mB ^{-1} \mC ^{-1} \left (\vm - \bar {\vz }\right ) \rVert }_2^2 -2 \left (d + 1\right ) {\lVert \mS ^{-1} \left (\vm - \bar {\vz }\right ) \rVert }_2^2, \end {align*} where \(\mB \) is the matrix square root of \(\mSigma \) such that \(\mB ^{-1} \mB ^{-1} = \mSigma ^{-1}\). The derivation so far applies to any Gaussian \(\pi , q_{\vlambda }\) and \(\vlambda \in \Lambda _{S}\) for any \(S > 0\). \par \paragraph {Worst-Case Lower Bound} Now, for our worst-case example, \begin {align*} \mathbb {E} {\lVert \rvvg _{\mathrm {STL}}\left (\widetilde {\vlambda }\right ) \rVert }_2^2 &= \mathbb {E} \left (1 + \textstyle {\sum ^{d}_{i=1} \rvu _i^2} \right ) \Big ( {\lVert \mSigma ^{-1} \left (\mathcal {T}_{\widetilde {\vlambda }}\left (\rvvu \right ) - \bar {\vz }\right ) \rVert }_2^2 + {\lVert \widetilde {\mS }^{-1} \left (\mathcal {T}_{\widetilde {\vlambda }}\left (\rvvu \right ) - \bar {\vz }\right ) \rVert }_2^2 \Big ) \\ &\quad + \left (d + 1\right ) {\lVert \widetilde {\mS }^{-1} \left (\widetilde {\vm } - \bar {\vz }\right ) \rVert }_2^2 \\ &\quad -2 \, \mathbb {E} \left (1 + \textstyle {\sum ^{d}_{i=1} \rvu _i^2} \right ) {\lVert \mB ^{-1} \widetilde {\mC }^{-1} \left ( \mathcal {T}_{\widetilde {\vlambda }}\left (\rvvu \right ) - \bar {\vz }\right ) \rVert }_2^2 \\ &\quad +2 \left (d + 1\right ) {\lVert \mB ^{-1} \widetilde {\mC }^{-1} \left (\widetilde {\vm } - \bar {\vz }\right ) \rVert }_2^2 -2 \left (d + 1\right ) {\lVert \widetilde {\mS }^{-1} \left (\widetilde {\vm } - \bar {\vz }\right ) \rVert }_2^2, \shortintertext {since \(\pi \) is \(\mu \)-strongly log-concave and \(\widetilde {\mS }^{-1} = L \boldupright {I}\),} &\geq \mathbb {E} \left (1 + \textstyle {\sum ^{d}_{i=1} \rvu _i^2} \right ) \Big ( L^{-2} \norm {\mathcal {T}_{\widetilde {\vlambda }}\left (\rvvu \right ) - \bar {\vz }}_2^2 + L^2 \norm {\mathcal {T}_{\widetilde {\vlambda }}\left (\rvvu \right ) - \bar {\vz }}_2^2 \Big ) \\ &\quad + \left (d + 1\right ) L^2 \norm {\widetilde {\vm } - \bar {\vz }}_2^2 \\ &\quad -2 \, \mathbb {E} \left (1 + \textstyle {\sum ^{d}_{i=1} \rvu _i^2} \right ) {\lVert \mB ^{-1} \widetilde {\mC }^{-1} \left ( \mathcal {T}_{\widetilde {\vlambda }}\left (\rvvu \right ) - \bar {\vz }\right ) \rVert }_2^2 \\ &\quad +2 \left (d + 1\right ) \, {\lVert \mB ^{-1} \widetilde {\mC }^{-1} \left (\widetilde {\vm } - \bar {\vz }\right ) \rVert }_2^2 -2 \left (d + 1\right ) L^2 \norm { \widetilde {\vm } - \bar {\vz } }_2^2, \shortintertext {and grouping the terms,} &= \underbrace { \left ( L^{-2} + L^2 \right ) \, \mathbb {E} \left (1 + \textstyle {\sum ^{d}_{i=1} \rvu _i^2} \right ) \norm {\mathcal {T}_{\widetilde {\vlambda }}\left (\rvvu \right ) - \bar {\vz }}_2^2 - \left (d + 1\right ) L^2 \norm {\widetilde {\vm } - \bar {\vz }}_2^2 }_{T_{\text {\ding {172}}}} \\ &\qquad \underbrace { -2 \, \mathbb {E} \left (1 + \textstyle {\sum ^{d}_{i=1} \rvu _i^2} \right ) {\lVert \mB ^{-1} \widetilde {\mC }^{-1} \left ( \mathcal {T}_{\widetilde {\vlambda }}\left (\rvvu \right ) - \bar {\vz }\right ) \rVert }_2^2 }_{T_{\text {\ding {173}}}} \\ &\qquad \underbrace { +2 \left (d + 1\right ) \, {\lVert \mB ^{-1} \widetilde {\mC }^{-1} \left (\widetilde {\vm } - \bar {\vz }\right ) \rVert }_2^2. }_{T_{\text {\ding {174}}}} \end {align*} \par \paragraph {Lower Bound on \(T_{\text {\ding {172}}}\)} For \(T_{\text {\ding {172}}}\), we have \begin {align} T_{\text {\ding {172}}} &= \left (L^{-2} + L^2 \right ) \mathbb {E} \left (1 + \textstyle {\sum ^{d}_{i=1} \rvu _i^2} \right ) \norm {\mathcal {T}_{\widetilde {\vlambda }}\left (\rvvu \right ) - \bar {\vz }}_2^2 - \left (d + 1\right ) L^2 \norm {\widetilde {\vm } - \bar {\vz }}_2^2, \nonumber \shortintertext {applying \cref {thm:normdist_1pnormu},} &= \left (L^{-2} + L^2 \right ) \left ( \left ( d + 1 \right ) \norm {\widetilde {\vm } - \bar {\vz }}_2^2 + \left ( d + k_{\varphi } \right ) {\lVert \widetilde {\mC } \rVert }_{\mathrm {F}}^2 \right ) - \left (d + 1\right ) L^2 \norm {\widetilde {\vm } - \bar {\vz }}_2^2, \nonumber \shortintertext {and since \(L^{-2} > 0\) and is negligible for large \(L\)s,} &\geq L^2 \left ( \left ( d + 1 \right ) \norm {\widetilde {\vm } - \bar {\vz }}_2^2 + \left ( d + k_{\varphi } \right ) {\lVert \widetilde {\mC } \rVert }_{\mathrm {F}}^2 \right ) - \left (d + 1\right ) L^2 \norm {\widetilde {\vm } - \bar {\vz }}_2^2 \nonumber \\ &= L^2 \left ( d + k_{\varphi } \right ) {\lVert \widetilde {\mC } \rVert }_{\mathrm {F}}^2. \label {eq:unimprovability_term1} \end {align} \par \paragraph {Lower Bound on \(T_{\text {\ding {173}}}\)} For \(T_{\text {\ding {173}}}\), we now use the covariance structures of our worst case through \cref {thm:lowerbound_matrix_innerproduct_lemma}. That is, \begin {align*} T_{\text {\ding {173}}} &= -2 \, \mathbb {E} \left (1 + \textstyle {\sum ^{d}_{i=1} \rvu _i^2} \right ) {\lVert \mB ^{-1} \widetilde {\mC }^{-1} \left ( \mathcal {T}_{\widetilde {\vlambda }}\left (\rvvu \right ) - \bar {\vz }\right ) \rVert }_2^2. \shortintertext {Noting that \(\mathcal {T}_{\widetilde {\vlambda }}\left (\rvvu \right ) = \widetilde {\mC } \rvvu + \widetilde {\vm }\) by definition, we can apply \cref {thm:lowerbound_matrix_innerproduct_lemma} Item (i) as} &= -2 \, \mathbb {E} \left (1 + \textstyle {\sum ^{d}_{i=1} \rvu _i^2} \right ) \left ( \norm {\mathcal {T}_{\widetilde {\vlambda }}\left (\rvvu \right ) - \bar {\vz }}_2^2 + {\left (L - L^{-1} \right )} \rvu _1^2 \right ), \shortintertext {distributing the expectation and \(1 + \textstyle {\sum ^{d}_{i=1} \rvu _i^2}\),} &= -2 \, \Big ( \mathbb {E} \left (1 + \textstyle {\sum ^{d}_{i=1} \rvu _i^2} \right ) \norm {\mathcal {T}_{\widetilde {\vlambda }}\left (\rvvu \right ) - \bar {\vz }}_2^2 + \underbrace { \mathbb {E} \left (1 + \textstyle {\sum ^{d}_{i=1} \rvu _i^2} \right ) {\left (L - L^{-1} \right )} \rvu _1^2 }_{T_{\text {\ding {175}}}} \Big ), \end {align*} \par \(T_{\text {\ding {175}}}\) follows as \begin {align} T_{\text {\ding {175}}} &= \mathbb {E} \left (1 + \textstyle {\sum ^{d}_{i=1} \rvu _i^2} \right ) {\left (L - L^{-1} \right )} \rvu _1^2 \nonumber \\ &= {\left (L^1 - L^{-1} \right )} \mathbb {E} \left (1 + \textstyle {\sum ^{d}_{i=1} \rvu _i^2} \right ) \rvu _1^2 \nonumber \\ &= {\left (L - L^{-1} \right )} \left (\mathbb {E} \rvu _1^2 + \mathbb {E} \rvu _1^4 + \textstyle {\sum ^{d}_{i=2} \mathbb {E} \rvu _i^2 \mathbb {E} \rvu _1^2} \right ) , \nonumber \shortintertext {applying \cref {thm:u_identities},} &= {\left (L - L^{-1} \right )} \left (1 + k_{\varphi } + d - 1 \right ) \nonumber \\ &= {\left (L - L^{-1} \right )} \left (d + k_{\varphi }\right ). \label {eq:stl_lowerbound_173} \end {align} \par Then, \begin {align} T_{\text {\ding {173}}} &= -2 \, \Big ( \mathbb {E} \left (1 + \textstyle {\sum ^{d}_{i=1} \rvu _i^2} \right ) \norm {\mathcal {T}_{\widetilde {\vlambda }}\left (\rvvu \right ) - \bar {\vz }}_2^2 + T_{\text {\ding {175}}} \Big ), \nonumber \shortintertext {bringing \cref {eq:stl_lowerbound_173} in,} &= -2 \, \Big ( \mathbb {E} \left (1 + \textstyle {\sum ^{d}_{i=1} \rvu _i^2} \right ) \norm {\mathcal {T}_{\widetilde {\vlambda }}\left (\rvvu \right ) - \bar {\vz }}_2^2 + {\left (L - L^{-1} \right )} \left (d + k_{\varphi }\right ) \Big ), \nonumber \shortintertext {applying \cref {thm:normdist_1pnormu},} &= -2 \, \Big ( \left (d + k_{\varphi }\right ) \norm { \widetilde {\vm } - \bar {\vz } }_2^2 + \left (d + 1 \right ) {\lVert \widetilde {\mC } \rVert }_{\mathrm {F}}^2 + \left (d + k_{\varphi }\right ) {\left (L - L^{-1} \right )} \Big ) \label {eq:unimprovability_term2} \end {align} \par \paragraph {Lower Bound on \(T_{\text {\ding {174}}}\)} Similarly for \(T_{\text {\ding {174}}}\), we can apply \cref {thm:lowerbound_matrix_innerproduct_lemma} Item (ii) as \begin {align} T_{\text {\ding {174}}} = 2 \left (d+1\right ) {\lVert \mB ^{-1} \widetilde {\mC }^{-1} \left ( \widetilde {\vm } - \bar {\vz }\right ) \rVert }_2^2 = 2 \left (d+1\right ) \norm {\widetilde {\vm } - \bar {\vz }}_2^2. \label {eq:unimprovability_term3} \end {align} \par Combining \cref {eq:unimprovability_term1,eq:unimprovability_term2,eq:unimprovability_term3}, \begin {align*} \mathbb {E} {\lVert \rvvg _{\mathrm {STL}}\left (\widetilde {\vlambda }\right ) \rVert }_2^2 &\geq T_{\text {\ding {172}}} + T_{\text {\ding {173}}} + T_{\text {\ding {174}}} \\ &\geq L^2 \left ( d + k_{\varphi } \right ) {\lVert \widetilde {\mC } \rVert }_{\mathrm {F}}^2 -2 \, \Big ( \left (d + k_{\varphi }\right ) \norm { \widetilde {\vm } - \bar {\vz } }_2^2 + \left (d + 1 \right ) {\lVert \widetilde {\mC } \rVert }_{\mathrm {F}}^2 + \left (d + k_{\varphi }\right ) {\left (L - L^{-1} \right )} \Big ) + 2 \left (d + 1\right ) \norm {\widetilde {\vm } - \bar {\vz }}_2^2 \\ &= \left ( L^2 \left ( d + k_{\varphi } \right ) -2 \left (d + 1 \right ) \right ) {\lVert \widetilde {\mC } \rVert }_{\mathrm {F}}^2 - 2 \left (k_{\varphi } - 1\right ) \norm { \widetilde {\vm } - \bar {\vz } }_2^2 + \left (d + k_{\varphi }\right ) {\left (L - L^{-1} \right )} , \shortintertext {and when \(L \geq 1\), we have \(L - L^{-1} > 0\). Therefore, we can simply the bound as} &\geq \left ( L^2 \left ( d + k_{\varphi } \right ) -2 \left (d + 1 \right ) \right ) {\lVert \widetilde {\mC } \rVert }_{\mathrm {F}}^2 - 2 \left (k_{\varphi } - 1\right ) \norm { \widetilde {\vm } - \bar {\vz } }_2^2. \end {align*} \par \end{proof}
