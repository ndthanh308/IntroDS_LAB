

\documentclass[a4paper]{spie} 
\usepackage{amsmath,amsfonts,amssymb}
\usepackage{graphicx}
\usepackage{setspace}
\usepackage{tocloft}
\usepackage{graphicx}
\usepackage{epstopdf}
\usepackage{subcaption}
\usepackage{empheq}
\usepackage{url,xurl}
\usepackage[colorlinks=true, allcolors=blue]{hyperref}
%\urlstyle{same}

\usepackage{float}
\usepackage[skip=1em , belowskip=4pt]{caption}
\usepackage{subcaption}
\usepackage{booktabs}
\usepackage{tikz}
\usetikzlibrary{angles,quotes}
\usetikzlibrary{quantikz}
\usepackage[most]{tcolorbox}


\title{Simulation and analysis of quantum phase estimation algorithm in the presence of incoherent quantum noise channels}
\author{Muhammad Faizan,\supit{1} Muhammad Faryad,\supit{2}
\skiplinehalf
\supit{1,2}Lahore University of Management Sciences, Department of Physics,  Lahore 54792, Pakistan
}


\authorinfo{$^\ast$Corresponding author: \href{mailto:muhammad.faryad@lums.edu.pk}{muhammad.faryad@lums.edu.pk}}

%\date{Received: date / Accepted: date}
% The correct dates will be entered by the editor

\begin{document}
\maketitle

\begin{abstract}
The quantum phase estimation (QPE) is one of the fundamental algorithms based on the quantum Fourier transform (QFT). It has applications in order-finding, factoring, and finding the eigenvalues of unitary operators. The major challenge in running QPE and other quantum algorithms is the noise in quantum computers. This noise is due to the interactions of qubits with the environment and due to the faulty gate operations. In the present work, we study the impact of incoherent noise on QPE, modeled as trace-preserving and completely positive quantum channels. Different noise models such as depolarizing, phase flip, bit flip, and bit-phase flip are taken to understand the performance of the QPE in the presence of noise. The simulation results indicate that the standard deviation of the eigenvalue of the unitary operator has strong exponential dependence upon the error probability of individual qubits. Furthermore, the standard deviation increases with the number of qubits for fixed error probability.
\end{abstract}


\section{Introduction}
The major stumbling block in realizing the full potential of quantum computers is the noise in the currently available quantum hardware. Furthermore, the noise will be a continuing feature of near-term quantum computers. The noise in the qubits can be classified as coherent or incoherent. The coherent noise is primarily due to the calibration of pulses implementing various gate sequences. In contrast, the incoherent noise arises due to the interaction of qubits with the environment and other qubits. It gives rise to the qubitâ€™s decoherence and limits the available time to implement quantum algorithms, thus producing statistical noise in the output. Therefore, understanding incoherent noise and its impact on the performance of quantum algorithms is important in evaluating the performance of various quantum algorithms. In this work, we analyze the impact of some key incoherent noise processes on the quantum phase estimation (QPE) algorithm.
QPE is one of the most important subroutines in quantum computation, based on quantum Fourier transform and serves as a building block for many other algorithms, including Shor's Algorithm \cite{shor1994algorithms}. 


Various studies investigating the performance of QPE in the noisy environment have been conducted. The performance of QPE has been studied in the presence of static gate defect, residual coupling between qubits, decoherence, and coherent phase errors \cite{garcia2008quantum,wei2004quantum,barenco1996approximate}. The robustness of QPE has been investigated while implementing it physically to simulate the molecular energy in the presence of noise and decoherence \cite{paesani2017experimental}. But the performance of QPE in the context of fundamental noise channels is not explored. Therefore, the goal of this paper is to bridge this gap. We explore the impact of four basic noise processes on the output of the QPE. This analysis will help understand the operation of algorithms where QPE is used as a subroutine.

A qubit is the fundamental unit of quantum computing. It is a microscopic system governed by laws of quantum mechanics, making it hard to control and isolate from the environment simultaneously. Despite the great potential of quantum hardware, qubits are still highly fragile and prone to noise due to interaction with the environment. In the presence of noise, the evolution of a qubit is no longer unitary. Instead, its evolution can be captured using completely positive and trace-preserving maps of the density operators \cite{fano1957description}, commonly known as quantum channels.  Mathematically, quantum channels can be decomposed using various representations and can be viewed as modeling the interaction of a quantum system with an environment \cite{choi1975completely,kraus1983states,stinespring1955positive}. In this paper, we will study the impact of (1) bit flip, (2) phase flip, (3) bit-phase flip, and (4) depolarizing channels on QPE. These four noise processes are fundamental in the sense that other single-qubit noise processes can be described in terms of these processes.

This paper is organized as follows: In Section \ref{methods}, we provide a brief overview of the QPE algorithm, noise models, and incorporation of noise models in the QPE algorithm. The simulation results and discussion is presented in Section \ref{srd}. The conclusions  are presented in Section \ref{conclusion}.
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\section{Modeling Noise in QPE}\label{methods}
The QPE  algorithm  finds the eigenvalue of a unitary operator $U$ such that $U\ket{v}=e^{2\pi i\theta}\ket{v}$ where $0\leq\theta\leq 1$. The main idea of this algorithm is to provide an $n$-bit approximation of $\theta$ in a single run.
This algorithm uses two registers. The first register is initialized to $\ket{0}^{\otimes n}$, where $n$ is the number of qubits to estimate $\theta$. The second register starts in the state $\ket{v}$ and contains the number of qubits necessary to store $\ket{v}$. The algorithm is performed in four steps: (1) creating superposition of all possible states and performing the controlled-$U^{2^j}$ operation for $j\geq 0$, (2) applying the \emph{inverse} quantum Fourier transform on the first register, (3) measurement in the computational basis to read out the state of the first register, and (4) classical post-processing to extract estimated $\theta$. The circuit for quantum phase estimation is illustrated in Fig. (\ref{QPECircuit}) for the simplest unitary operator $U$ acting on a single qubit \cite{nielsen2002quantum}.

% Figure environment removed







For the simulation results in this paper, we considered four noisy quantum channels to represent noise processes. The first is the bit flip channel that represents a noise process that flips the qubit with probability $p$ and is given as$$\Phi(\rho)=(1-p)\rho + p X\rho X,$$ where $\rho$ is the density matrix representing the state of the qubit and $X$ is the Pauli $X$ gate.

The second noise model we used in this work is the phase-flip channel that models the random flipping of the phase of a qubit state $\ket{1}$. This noise model can be written as $$\Phi(\rho)=(1-p)\rho+pZ\rho Z,$$where $Z$ is the Pauli $Z$ gate.

The third noise model we considered is the combination of bit-flip and phase flip channel, called bit-phase flip channel defined as$$\Phi(\rho)=(1-p)\rho+pY\rho Y.$$

The fourth channel is called depolarizing channel. Under this noise model,  the environment interacts with the system in such a way that with the probability $p$, a qubit is depolarized, i.e., the state of the system is transformed into a maximally mixed state, $I/2$. This channel is described by the map $$\Phi(\rho)=(1-p)\rho+p{I}/{2},$$where $I$ is the identity matrix describing a maximally mixed state of a single qubit.

To investigate the performance of QPE in the presence of noise, we transpiled the circuit to the one containing basic gates set $\{I , X , \sqrt{X} , R_z , CX\}$ and then incorporated one of the noise models into the circuit that adds errors to all the basic gates acting on each qubit. To do this, we used qiskit's inbuilt noise models \cite{NoiseMod21:online}. 
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Simulation Results and Discussion}\label{srd}
To estimate the impact of four different noise processes on the value of the eigenvalue of the unitary operator, we ran the QPE with noise for three different actual values $\theta_{\text{actual}}$ as a function of error probability $p$. We computed the average value of $\theta$ as $\overline{\theta}$ by running the algorithm $N_{\text{runs}}$ number of times for each value of $p$. We also computed the standard deviation $\Delta \theta$. The results for four noise models are presented in Fig. \ref{qpeplots5} for $n=5$ qubits to estimate the value of $\theta$. All the figures indicate that the average value of $\theta$ approach $0.5$ as the error probability increases. Also, the standard deviation of the results increases with $p$ and then saturates as illustrated in Fig. \ref{stdvsp}. This is consistent with the interpretation of the noise processes leading towards depolarization of the quantum state in the circuit. Since $0\leq\theta\leq 1$, the approach of $\overline{\theta}$ to $0.5$ indicates that the quantum state is approaching a maximally mixed state with all measurement outcomes equally likely at the output. For the higher value of $p$, the state depolarizes quickly. Furthermore, we see that all channels have similar dependence and show rapid divergence of the measured $\theta$ from $\theta_{\text{actual}}$ as $p$ increases from zero but saturates around $p=0.1$.



% Figure environment removed

% Figure environment removed

% Figure environment removed






To understand the dependence of QPE output on the number of qubits $n$ for a fixed value of error probability $p$, we computed the average value of $\theta$ as a function of $n$ for two actual values of $\theta$. The results are plotted in Fig. \ref{fixedp}. The figure indicates that the increase in the number of qubits $n$ makes the output of the circuit diverge from the actual value of $\theta$ even though the noise level $p$ is fixed. Therefore, the increase in the number of qubits has an adverse impact on the results of the QPE algorithm as opposed to the expectation from  a noiseless quantum computer where an increase in the number of qubits is expected to result in a better estimate of the $\theta$. 


To model the dependence of standard deviation  $\Delta\theta$ as a function of $p$, when $p$ is small, we fitted the data to the function
\begin{equation}
	\Delta\theta(p) = k_1 + k_2e^{-k_3p}\,,\quad\,0\leq p\leq0.01\,,
\end{equation}
for all four channels and obtained parameters of the curve that best models the data with more than $97.5\%$ accuracy. The parameters are provided in Table \ref{tabb}. The table shows that $\Delta\theta$ has strong exponential dependence upon $p$. The plot of standard deviation $\Delta\theta$ vs. noise level $p$ such that $0<p<1\%$ is illustrated in Fig. \ref{stdvsp}.



\begin{table}[H]
	\centering
	
	\begin{subtable}[c]{0.48\textwidth}
		
		\centering
		\subcaption{For $\theta_{\text{actual}}=0.03125$}
		\begin{tabular}[t]{lcccc}
			\toprule
			Noise Channel  & $k_1$ & $k_2$ & $k_3$\\
			\midrule
			Depolarizing  & 0.20 & -0.18 & 220\\
			Bit flip  & 0.11 & -0.10 & 220 \\
			Phase flip  & 0.22 & -0.20 & 240\\
			Bit-phase flip  & 0.22 & -0.20 & 240\\
			\bottomrule
		\end{tabular}
		
		
		
	\end{subtable}
	\begin{subtable}[c]{0.48\textwidth}
		\centering
		\subcaption{For $\theta_{\text{actual}}=0.96875$}
		\begin{tabular}[t]{lcccc}
			\toprule
			$k_1$ & $k_2$ & $k_3$\\
			\midrule
			0.26 & -0.23 & 248\\
			0.26 & -0.24 & 236 \\
			0.23 & -0.20 & 240\\
			0.29 & -0.26 & 270\\
			\bottomrule
		\end{tabular}
		
	\end{subtable}
	\medskip
	
	\caption{The optimal set of parameters for the function $\Delta\theta(p) = k_1 + k_2e^{-k_3p}$ that best fits the standard deviation for $0\leq p\leq 0.01$ with more than $97.5\%$ accuracy.}
	\label{tabb}
\end{table}








%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\color{black}
\section{Conclusions}\label{conclusion}
We simulated the quantum phase estimation (QPE) algorithm with four noise processes: bit flip, phase flip, bit-phase flip, and depolarizing. We transpiled the algorithms into $ \{I , X , \sqrt{X} , R_z , CX\}$ gate set and introduced the noise channel after every gate with error probability $p$ for each qubit. The simulation results indicated that the average value of the eigenvalue of the unitary operator converged to $0.5$ regardless of the actual value of the eigenvalue $0\leq\theta\leq1$ as the error probability increases from $0$. This seems to be because the noise processes force the overall quantum state towards the maximally mixed state. The standard deviation of the output increased exponentially for a small value of $p$ as $p$ increased from $0$ and then saturates. Furthermore, the average value of the eigenvalue diverged away from the actual value when the number of qubits was increased for fixed error probability, contrary to the noiseless QPE where increasing the number of qubits increases the precision of the eigenvalue. The results obtained in this work can be used to analyze the algorithms utilizing QPE as a subroutine on the noisy intermediate-scale quantum  (NISQ) hardware \cite{preskill2018quantum}.







\newpage
\nocite{*}
\bibliographystyle{spiebib}
\bibliography{generic}

\end{document}
