\begin{algorithm}[t!]
\caption{}
\label{alg:rl_wcj}
\renewcommand{\algorithmiccomment}[1]{// #1}
\begin{small}
\begin{algorithmic}[1]
\State \textbf{Input:} SPJ query $q$, budget of each episode $b$
\State \textbf{Output:} Result $r$
\Function{RL\_WCJ}{$q, b$}
\State $q \gets$ \Call{ApplyUnaryPredicates}{$q$}
\State $q \gets$ \Call{DistinctJoinValues}{$q$}
\State $finish \gets true$ 
\While {$\lnot finish$}
\State \Comment{Retrieve an attribute order to evaluate}
\State $o \gets$ \Call{MCTSSample}{q}
\State \Comment{Restore execution state for this join order}
\State $s \gets$ \Call{RestoreState}{$o$}
\State \Comment{Execute join order during time budget}
\State $finish, rw \gets$ \Call{ContinueJoin}{s, o, b}
\State \Call{RewardUpdate}{$rw$}
\EndWhile
\EndFunction
\end{algorithmic}
\end{small}
\end{algorithm}

\begin{algorithm}[t!]
\caption{}
\label{alg:rl_wcj}
\renewcommand{\algorithmiccomment}[1]{// #1}
\begin{small}
\begin{algorithmic}[1]
\State \textbf{Input:} State $s$, attribute order $o$ and budget $b$
\State \textbf{Output:} Reward $rw$
\Function{ContinueJoin}{$s, o, b$}
\State \Comment{$s.tuplevalue$ include keys to seek for each attribute}
\State \Comment{$s.l$ is the length of shared prefix}
\State $stv \gets s.tuplevalue$
\If{$s.l == o.len$}
\State \Comment{Continue from the last position}
\State \Call{LFTJ}{}
\Else
\State \Comment{Change the position of iterators}
    \State \Comment{Reset all iterators to the begining}
    \For{$it \in iters$}
    \State \Call{Reset}{$it$}
    \EndFor
    \For{$i\gets0,\ldots,s.l$}
    \State \Comment{Get the seek value for $i$-th attribute}
    \State $k \gets stv[i]$
    \For{$it \in iters[i]$}
    \State \Comment{Get each iterator for i-th attribute}
    \State \Call{it.open}{ }
    \State \Call{it.seek}{k}
    \EndFor
    \EndFor
    \State $vid \gets s.l$
    \State \Call{LFTJ}{$vid$}
\State
\EndIf 
\EndFunction
\end{algorithmic}
\end{small}
\end{algorithm}



\begin{algorithm}[t!]
\caption{}
\label{alg:rl_wcj}
\renewcommand{\algorithmiccomment}[1]{// #1}
\begin{small}
\begin{algorithmic}[1]
\State \textbf{Input:} State $s$, attribute order $o$ and budget $b$
\State \textbf{Output:} Reward $rw$
\Function{ContinueJoin}{$s, o, b$}
\State \Comment{$s.tuplevalue$ include keys to seek for each attribute}
\State \Comment{$s.l$ is the length of shared prefix}
\State $stv \gets s.tuplevalue$
\If{$s.l == o.len$}
\State \Comment{Continue from the last position}
\State \Call{LFTJ}{}
\Else
\State \Comment{Change the position of iterators}
    \State \Comment{Reset all iterators to the begining}
    \For{$it \in iters$}
    \State \Call{Reset}{$it$}
    \EndFor
    \For{$i\gets0,\ldots,s.l$}
    \State \Comment{Get the seek value for $i$-th attribute}
    \State $k \gets stv[i]$
    \For{$it \in iters[i]$}
    \State \Comment{Get each iterator for i-th attribute}
    \State \Call{it.open}{ }
    \State \Call{it.seek}{k}
    \EndFor
    \EndFor
    \State $vid \gets s.l$
    \State \Call{LFTJ}{$vid$}
\State
\EndIf 
\EndFunction
\end{algorithmic}
\end{small}
\end{algorithm}