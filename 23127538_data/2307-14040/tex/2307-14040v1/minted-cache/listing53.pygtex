\begin{Verbatim}[commandchars=\\\{\}]
\PYG{n}{E}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{ones}\PYG{p}{(}\PYG{n+nb}{size}\PYG{p}{(}\PYG{n}{A}\PYG{p}{));}\PYG{+w}{                }\PYG{c}{\PYGZpc{} Correction matrix}
\PYG{n}{X0}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n+nb}{diag}\PYG{p}{(}\PYG{n+nb}{sum}\PYG{p}{(}\PYG{n+nb}{triu}\PYG{p}{(}\PYG{n+nb}{ones}\PYG{p}{(}\PYG{n+nb}{size}\PYG{p}{(}\PYG{n}{A}\PYG{p}{))),}\PYG{l+m+mi}{2}\PYG{p}{))}\PYG{o}{\PYGZbs{}}\PYG{n+nb}{triu}\PYG{p}{(}\PYG{n+nb}{ones}\PYG{p}{(}\PYG{n+nb}{size}\PYG{p}{(}\PYG{n}{A}\PYG{p}{)));}\PYG{+w}{ }\PYG{c}{\PYGZpc{} Initial guess}
\PYG{n}{X0}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{gam}\PYG{o}{*}\PYG{n}{E}\PYG{+w}{ }\PYG{o}{+}\PYG{+w}{ }\PYG{p}{(}\PYG{l+m+mi}{1}\PYG{o}{\PYGZhy{}}\PYG{n}{gam}\PYG{p}{)}\PYG{o}{*}\PYG{n}{X0}\PYG{p}{;}\PYG{+w}{          }\PYG{c}{\PYGZpc{} Nonzero matrix}
\PYG{n}{X0}\PYG{+w}{ }\PYG{p}{=}\PYG{+w}{ }\PYG{n}{modifiedsinkhorn}\PYG{p}{(}\PYG{n}{X0}\PYG{p}{,}\PYG{n+nb}{pi}\PYG{p}{,}\PYG{l+m+mi}{100}\PYG{p}{);}\PYG{+w}{ }\PYG{c}{\PYGZpc{} Scaled to be on the manifold}
\end{Verbatim}
