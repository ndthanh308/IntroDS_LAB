\documentclass[twocolumn,floatfix,superscriptaddress,amsmath,amssymb,aps,prl]{revtex4-2}
\pdfoutput=1
\usepackage{graphicx}% Include figure files
\graphicspath{ {Figures/} }

\usepackage{dcolumn}% Align table columns on decimal point
\usepackage{bm}% bold math
\usepackage{bbold}
\usepackage[export]{adjustbox}

\usepackage{multirow}

\usepackage{mathtools} % Braket notation
\DeclarePairedDelimiter\bra{\langle}{\rvert}
\DeclarePairedDelimiter\ket{\lvert}{\rangle}
\DeclarePairedDelimiterX\braket[2]{\langle}{\rangle}{#1 \delimsize\vert #2}
\DeclareMathOperator{\tr}{tr}

\usepackage{array,colortbl,xcolor}%Table color
%box in a table
\def\boxit#1{%
	\smash{\color{black}\fboxrule=1pt\relax\fboxsep=2pt\relax%
		\llap{\rlap{\fbox{\vphantom{0}\makebox[#1]{}}}~}}\ignorespaces}
%-----------------------------------------------------------------------------%
% Language:
%-----------------------------------------------------------------------------%
%\usepackage[brazilian]{babel}
\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
%-----------------------------------------------------------------------------%
% Font:
%-----------------------------------------------------------------------------%
\usepackage{mathrsfs,bbm}
%\usepackage{mathpazo}
\usepackage{dsfont}
\renewcommand{\rmdefault}{ptm}
%\usepackage{mathptmx}
\usepackage{amssymb}
\usepackage{amsmath}
%\usepackage{latexsym}
\usepackage{amsfonts}
\usepackage{amsthm}
\usepackage{mathtools}
%-----------------------------------------------------------------------------%
% PDF:
%-----------------------------------------------------------------------------%
\usepackage{hyperref}
\hypersetup{pdfpagemode=UseNone}
\hypersetup{colorlinks=true}
\hypersetup{citecolor=blue}
\hypersetup{linkcolor=blue}
\hypersetup{urlcolor=blue}
\usepackage{cleveref}
%-----------------------------------------------------------------------------%
% New environments:
%-----------------------------------------------------------------------------%
\newtheorem{theorem}{Theorem}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}
%\newtheorem{remark}{Remark}
\newtheorem{program}{Program}
\newcounter{rem}
\setcounter{rem}{1}
\newenvironment{remark}{ \emph{Remark \arabic{rem}:}}{\medskip\addtocounter{rem}{1}}
%-----------------------------------------------------------------------------%
% My Macros:
%-----------------------------------------------------------------------------%
\renewcommand{\b}[1]{\mathbf{#1}}
\newcommand{\bi}[1]{\boldsymbol{#1}}
\newcommand{\mc}[1]{\mathcal{#1}}
\newcommand{\g}[1]{\mathfrak{#1}}
\renewcommand{\r}[1]{\mathrm{#1}}
\newcommand{\s}[1]{\mathsf{#1}}

\DeclarePairedDelimiter\ceil{\lceil}{\rceil}
\DeclarePairedDelimiter\floor{\lfloor}{\rfloor}
\def\>{\rangle}
\def\<{\langle}
\newcommand{\proj}[1]{| #1 \rangle\! \langle #1 |}
%\renewcommand{\rho}{\varrho}
\newcommand{\idty}{\mathds{1}}
\def\tr{{\rm tr}}
\def\pr{{\rm Pr}}
\def\pf{{\rm Pf}}
\def\ii{{\rm i}}
\def\conv{{\rm conv}}
\def\textbf#1{{\bf #1}}
\newcommand{\Cx}{\mathbb{C}}
\newcommand{\Ir}{\mathbb{Z}}
\newcommand{\Nl}{\mathbb{N}}
\newcommand{\Ra}{\mathbb{Q}}
\newcommand{\Rl}{\mathds{R}}
\usepackage{dsfont}
\DeclareMathOperator{\id}{\mathds{1}}
\DeclareMathOperator{\range}{range}
\DeclareMathOperator{\linspan}{span}
%-----------------------------------------------------------------------------%
% Editorial:
%-----------------------------------------------------------------------------%
\renewcommand{\paragraph}[1]{\addcontentsline{toc}{section}{#1}\emph{#1.}---}
\usepackage{xcolor}
\newcommand{\cm}{\textcolor{red}{[XXX]}}
\newcommand{\isa}[1]{\textcolor{blue}{#1}}
\newcommand{\mar}[1]{\textcolor{olive}{#1}}
\newcommand{\lee}[1]{\textcolor{orange}{#1}}
%\usepackage{ulem} %line across text \sout{text}
\usepackage{soul}
%-----------------------------------------------------------------------------%
% Document:
%-----------------------------------------------------------------------------%


\begin{document}

\title{Semi-device-independent certification of number of measurements}

\author{Isadora Veeren}
\affiliation{Centro Brasileiro de Pesquisas FÃ­sicas, Rua Dr. Xavier Sigaud, 150, Rio de Janeiro, RJ, Brasil}

\author{Martin Pl\'{a}vala}
\affiliation{Naturwissenschaftlich-Technische Fakult\"{a}t, Universit\"{a}t Siegen, Walter-Flex-Stra\ss e 3, 57068 Siegen, Germany}

\author{Leevi Lepp\"{a}j\"{a}rvi}
\affiliation{RCQI, Institute of Physics, Slovak Academy of Sciences,
D\'ubravsk\'a cesta 9, 84511 Bratislava, Slovakia}

\author{Roope Uola}
\affiliation{Department of Applied Physics, University of Geneva, 1211 Geneva, Switzerland}

\date{\today}

\begin{abstract} 
We develop a method for semi-device-independent certification of number of measurements. We achieve this by testing whether Bob's steering equivalent observables (SEO) can be simulated by $k$ measurements, which we do by testing whether they are $k$-compatible with separable joint observable. This test can be performed with the aid of hierarchy of semidefinite programs, and whenever it fails one can conclude that Alice must have access to at least $k+1$ incompatible measurements.
\end{abstract}

\maketitle

\paragraph{Introduction}
The theory of quantum measurements is at the heart of our understanding of quantum theory. Originally developed to describe and understand the measurement process on the foundational level, recently the advantages of this theory for quantum information processing have become clear, see \cite{heinosaari2016invitation,JMreviewOtfried} for reviews on the topic.

So far, the measurement theoretic approach to quantum correlations and communication has concentrated mainly on measurements acting on a single system. This is despite the fact that quantum networks have gone through a rapid development in recent years \cite{networkreview}, and the investigation of such platforms necessitates the use of multipartite measurements. On top of the fundamental results, such as the refutation of real-number-based models of quantum theory \cite{Renouimaginary}, the approach has resulted in an improved understanding of measurements acting on compound systems, for example, in the form of the elegant joint measurement \cite{GisinEJM}. However, the full theory of quantum measurements on such systems is still developing, and the exact role of known concepts, such as entangled measurements and measurements simulable by local operations supported by classical communication \cite{JakubISOentangled,LOCCreview}, in networks remains unclear.

In this manuscript, we contribute to the theory of measurements in compound systems by exploiting a link between two central concepts, resulting in a hierarchy for certifying the number of measurements in a semi-device independent manner. These concepts are simulability of measurements and compatibility of measurements on many copies. On the one hand, simulability asks whether the statistics of a given set of quantum measurements can be explained by using a pre-fixed set of measurements assisted by, for example, randomness and classical data processing. Recently, the concept has drawn a considerable amount of interest especially for the cases when the pre-fixed measurements are sharp \cite{Oszmaniecprojsim}, contributing to improving known bounds on the Grothendieck constant $K_G(3)$ \cite{Hirschconstant}, have fixed number of outcomes \cite{guerini2017,Shi2020}, showing that there are truly non-projective measurements in quantum theory \cite{Gomeznonprojective}, have a limited dimensionality \cite{Ioannousimulability}, allowing for a record high semi-device independent certification of entanglement dimensionality \cite{Designolle21HDSteer}, and the number of simulating measurements is fixed \cite{guerini2017}. Here we concentrate on the fourth case. On the other hand, compatibility on many copies asks whether one can recover the statistics of a set of measurements from a single measurement on a compound system \cite{carmeli2016}. This forms a natural generalization of compatibility of measurements, which is recovered when compound system is not used. So far, this special case has found deep connections with an advantage in quantum correlations in bipartite \cite{Wolf09,quintino2014,Uola14}, prepare-and-measure \cite{Tavakoli20,Saha23}, and temporal \cite{Carmeli19,Skrzypczyk19,Uola19quantifying,Uola19leggettgrag,Oszmaniecoperational,Uola20,Buscemi20,Uola22} scenarios, but the more recent and more general many-copy case has not yet found applications in such setting.

We demonstrate the use of the proposed hierarchy in a quantum steering scenario. Steering manifests itself in asymmetric scenarios where Alice and Bob cannot be inter-exchanged \cite{Midgley10,Olsen2013,Bowles2014,Evans2014,Skrzypczyk2014,Bowles2016,Sekatski2023}. Because of the way this scenario is designed, steering can be formulated in one-way-device-independent approaches. As a result, it can also be exploited for many practical applications, such as quantum key distribution \cite{branciard2012}, randomness certification \cite{law2014,Passaro2015,Skrzypczyk2018} or secret sharing \cite{xiang2017,Kogias17}, where such asymmetry can be an advantage.

Beyond its applications, steering has a considerable role in foundations of quantum mechanics. Though a completely distinct and independent phenomenon, it is closely related to Bell non-locality, entanglement and incompatibility of measurements \cite{Cavalcanti2016,steering-review}. In fact, steering can only be observed if the shared state is entangled and the measurements performed by Alice are incompatible \cite{quintino2014,Uola14}. Such requirement makes the detection of steering a strategy to certify that these measurements are incompatible in a one-way-device-independent approach \cite{Chen2016,Cavalcanti16quantitative}, a feat that is relevant on its own since incompatibility is central in many protocols.

Using our results on measurements, we go beyond witnessing incompatibility of measurements through the violation of a steering inequality. Indeed, we provide a strategy to actually certify the number of incompatible measurements to which Alice has access. In a bipartite steering scenario, we develop a series of tests that Bob can perform with the information he has on his side of the experiment and establish a lower bound to how many incompatible measurements his colleague must have performed on her part of a shared quantum state. Our method also displays the main advantage of admitting a semi-definite programming (SDP) formulation, and our tests can, as a consequence, be efficiently computed with well-established methods.

\paragraph{Compatibility and simulability}
Joint measurability of a set of positive-operator valued measures (POVMs) encapsulates the notion of whether a set of measurements can be performed simultaneously by a single device. Formally, a measurement assemblage, i.e., a set of POVMs $\{M_{a|x}\}_{a,x}$ obeying $M_{a|x} \geq 0 $ and $\sum_a M_{a|x} = \id$ for all $a,x$, is said to be compatible or jointly measurable if there exist a POVM $\{G_{\lambda}\}_{\lambda}$ and a probability distribution $p$ such that, for any state $\rho$,
\begin{equation}
    \tr[\rho M_{a|x}] =\sum_{\lambda} p(a|x,\lambda) \tr[\rho G_{\lambda}].
\end{equation}
When this condition is met, it means that the joint observable $\{G_\lambda\}_\lambda$ represents a simultaneous measurement of $\{M_{a|x}\}_{a,x}$ and can recover its statistics through a suitable post-processing. Equivalently, this condition can be put in terms of the marginalization of some joint measurement. In this case, there must be a POVM $G$ with effects $G_{a_1, \dots, a_n}$ such that $M_{a|x} = \sum_{a_i, i \neq x} G_{a_1, \dots, a_{x-1}, a, a_{x+1}, \dots ,a_n}$. Then it is said that $M_{a|x}$ can be recovered as the $x$\textsuperscript{th} marginal of $G$.

The notion of joint measurability can be extended to the concept of $k$-compatibility \cite{carmeli2016}, that is central for our work. The idea is that we are allowed to perform the joint measurement on $k$ copies of the state $\rho$. Thus a set of measurements $\{M_{a|x}\}_{a,x}$ is said to be $k$-compatible if there exists a joint observable $\{G_{\lambda}\}_{\lambda}$ such that for any state $\rho$ we have
\begin{equation}
    \tr[\rho M_{a|x}] = \sum_{\lambda} p(a|x,\lambda) \tr[\rho^{\otimes k} G_{\lambda}].
\end{equation}
In such case $G$ is called a $k$-copy joint observable of $\{M_{a|x}\}_{a,x}$. This is a relaxation of the usual concept of compatibility, which is recovered in the case where one has access to only one copy of $\rho$, meaning $k=1$. Also, notice that any set of $k$ measurements is $k$-compatible. An example of incompatible but $2$-compatible POVMs is given by the hollow triangle POVMs \cite{Heinosaari2008}, i.e. a set of 3 incompatible POVMs that are compatible pairwise. Such triplet of POVMs is clearly $2$-compatible, as one can construct the $2$-copy joint POVM by measuring one of the POVMs on one copy of $\rho$ and measuring the joint observable of the other two on the other copy of $\rho$.

Another central concept for our work is that of $k$-simulability \cite{guerini2017}. In contrast to having many copies of the state, in $k$-simulability one has $k$ measurements. Also, in contrast to joint measurability that uses only classical post-processing, in $k$-simulability one is allowed to use classical pre-processing as well. %A set of measurements given by POVM elements $\{M_{a|x}\}_{a,x}$ is said to be $k$-simulable if we can obtain their statistics as mixtures of post-processings of statistics of $k$ POVMs $\{B_{b|y}\}_{b|y}$, $y \in \{1, \ldots, k\}$.
Formally, a set of measurements given by POVM elements $\{M_{a|x}\}_{a,x}$ is $k$-simulable if there exist probability distributions $p$ and $q$, as well as $k$ POVMs with elements $B_{b|y}$ such that
\begin{equation} \label{eq:ksim}
    M_{a|x} = \sum_{y=1}^{k} p(y|x) \sum_{b} q(a|x,b,y)B_{b|y}.
\end{equation}
When that is the case, $\{B_{b|y}\}_{b,y}$ are called $k$-simulators of $\{M_{a|x}\}_{a|x}$. Notice that, similarly to $k$-compatibility, any set of $k$ POVMs is $k$-simulable and we recover the notion of usual compatibility when $k=1$. As an example of $2$-simulable but incompatible measurements one can again take the hollow triangle POVMs and apply a construction analogous to the previous one.

\paragraph{Steering and steering equivalent observables}
Consider a scenario where two parties, Alice and Bob, share a quantum state $\rho_{AB}$, upon which they can perform measurements and classically exchange its results. On Alice's side, she has access to a set of measurements labeled by $x$ with outcomes $a$, described by the POVM effects $\{M_{a|x}\}_{a,x}$. After Alice measures, Bob is left with reduced states conditioned to Alice's measurement choice and measurement outcome. That is, Bob will have access to a state assemblage $\{\rho_{a|x}\}_{a,x}$ given as $\rho_{a|x} = \tr_{A}[(M_{a|x} \otimes \id)\rho_{AB}]$. %The core of steering is determining whether Alice can collapse Bob's system into different states by performing different measurements on her side of the bipartite state they share.
Upon determining his state assemblage, Bob can check whether the assemblage can be explained by a local hidden state (LHS) model. An assemblage is said to allow LHS model if there are probabilities $p(a|x,\lambda)$ and sub-normalized states $\sigma_{\lambda}$ such that $\rho_{a|x} = \sum_{\lambda} p(a|x,\lambda)\sigma_{\lambda}$. In this case, Bob could just claim the states he observes come from local states $\sigma_{\lambda}$ in his laboratory whose probability distributions are simply updated by finding out Alice's measurement outcomes. When that is not the case,% and there are no $p(a|x,\lambda)$ and $\sigma_{\lambda}$ that can fulfill this requirement,
then Bob is concludes that Alice is able to steer his states, i.e. the state assemblage can not be realized using a separable state.

Steerability of any state assemblage can be put in terms of a joint measurability problem. Let $\rho_B = \tr_A[\rho_{AB}]$ be Bob's reduced state and $\Pi_B$ be the projection onto $\range(\rho_B)$. The steering equivalent observables (SEO) of Bob's state assemblage $\{\rho_{a|x}\}_{a,x}$ are defined as $S_{a|x} = \tilde{\rho}_B^{-\frac{1}{2}} \tilde{\rho}_{a|x} \tilde{\rho}_B^{-\frac{1}{2}}$, where $\tilde{\rho}_{a|x} = \Pi_B \rho_{a|x} \Pi_B^{\dagger} $ and $\tilde{\rho}_B = \Pi_B \rho_B \Pi_B^{\dagger} $. It is known that $\{\rho_{a|x}\}_{a,x}$ has LHS model if and only if $\{S_{a|x}\}_{a|x}$ is jointly measurable \cite{uola2015one}.

\paragraph{Constructing the test}
We will now introduce a string of implications that will lead to a test that certifies that Alice must have access to more than $k$ incompatible measurements. We start by showing that if a measurement assemblage is $k$-simulable, then the SEO of the corresponding state assemblage is also $k$-simulable. Consider a measurement assemblage $\{M_{a|x}\}_{a,x}$. If the assemblage is $k$-simulable, then there exist probability distributions $p$ and $q$, as well as $k$ POVMs with effects $\{B_{b|y}\}_{b,y}$ that satisfy Eq.~\eqref{eq:ksim}. Bob's SEO are given by
\begin{equation}
    S_{a|x} = \tilde{\rho}_B^{-\frac{1}{2}} \Pi_B \tr_{A}[(M_{a|x} \otimes \id) \rho_{AB}] \Pi_B^{\dagger} \tilde{\rho}_B^{-\frac{1}{2}}. 
\end{equation}
Using Eq. \eqref{eq:ksim} we have that
\begin{equation}
\begin{split}
    S_{a|x} = &\sum_{y=1}^k \sum_{b} p(y|x) q(a|b,x,y) \\
    &\tilde{\rho}_B^{-\frac{1}{2}} \Pi_B  \tr_{A}[(B_{b|y} \otimes \id) \rho_{AB}] \Pi_B^{\dagger} \tilde{\rho}_B^{-\frac{1}{2}}.
\end{split}
\end{equation}
We can then simply identify $\tilde{B}_{b|y}$, the simulators of $S_{a|x}$, as  
\begin{align}\label{eq:decompose}
    \tilde{B}_{b|y} &= \tilde{\rho}_B^{-\frac{1}{2}} \Pi_B \tr_{A}[(B_{b|y} \otimes \id) \rho_{AB}] \Pi_B^{\dagger} \tilde{\rho}_B^{-\frac{1}{2}}.
\end{align}
$p,q$ are assumed to be probability distributions, so as long as $\{\tilde{B}_{b|y}\}_{b,y}$ is a measurement assemblage of $k$ POVMs then, by definition, $S_{a|x}$ is $k$-simulable. All that is left is to show that $\tilde{B}_{b|y} \geq 0 $ and $\sum_a \tilde{B}_{b|y} = \id$ for all $b,y$.

It is easy to see that the first condition holds since $B_{b|y} \geq 0$, we thus only need to check that $\sum_b \tilde{B}_{b|y} = \id$. We have
\begin{equation}
    \sum_b \tilde{B}_{b|y}
    = \tilde{\rho}_B^{-\frac{1}{2}} \Pi_B \rho_B \Pi_B^{\dagger} \tilde{\rho}_B^{-\frac{1}{2}} 
    = \tilde{\rho}_B^{-\frac{1}{2}}  \tilde{\rho}_B  \tilde{\rho}_B^{-\frac{1}{2}}
    = \id.
\end{equation}
With that we conclude that if a measurement assemblage is $k$-simulable, then the steering equivalent observables of the state assemblage it generates will also be $k$-simulable. Notice however that the converse is not true: if the SEO of a state assemblage is $k$-simulable it does not mean that the measurement assemblage that generated it is also $k$-simulable. As a counter example, whenever Alice and Bob share a separable state, Bob's steering equivalent observables will be $k$-simulable for any $k \geq 1$, regardless of whether Alice's measurement assemblage is $k$-simulable or not.

We now recall the result of \cite{Filippov2018} where it was shown (in the framework of general probabilistic theories) that $k$-simulability implies $k$-compatibility of the measurement assemblage such that the $k$-copy joint measurement can be chosen to be of the product form. For completeness, we formulate the proof in the case of quantum theory. We prove it by directly constructing a joint measurement for the assemblage. Consider the set $\{ M_{a|x} \}_{a,x}$ that is $k$-simulable, meaning there must exist probability distributions $p,q$ and measurement assemblage $\{B_{b|y}\}_{b,y}$ of $k$ POVMs that satisfy \eqref{eq:ksim}. Define
\begin{equation}
N_{b|y} = \underbrace{\id \otimes \dots \otimes \overbrace{B_{b|y}}^{\text{$y$\textsuperscript{th} term}} \otimes \dots \otimes \id}_{\text{$k$ terms}},
\end{equation}
it follows that
\begin{align}
    \tr[\rho M_{a|x}] &= \sum_{y=1}^k \sum_{b} p(y|x) q(a|b,x,y) \tr[\rho^{\otimes k} N_{b|y}].
\end{align}
Now, notice that the POVM elements $N_{b|y}$ can be obtained as $y$\textsuperscript{th} marginal of $\tilde{N}_{\vec{b}} = B_{b_1|1} \otimes \dots \otimes B_{b_y|y} \otimes \dots \otimes B_{a_k|k}$, namely
\begin{equation}
    N_{b|y} = \sum_{b_{i}, i \neq y} B_{b_1|1} \otimes \dots \otimes B_{b|y} \otimes \dots \otimes B_{a_k|k}.
\end{equation}
So one can conclude that
\begin{equation}
    \tr[\rho M_{a|x}] = \sum_{y=1}^k \sum_{b_1 \ldots b_k} p(y|x) q(a|b_y,x,y) \tr[\rho^{\otimes k} \tilde{N}_{\vec{b}}].
\end{equation}
We thus conclude that the set $\{ M_{a|x} \}_{a,x}$ must be $k$-compatible with $k$-copy joint observable in a product form.

The conditions that we have derived here are necessary and, hence, they enable us to develop a hierarchy of conditions to check $k$-simulability in a semi-device-independent scenario. It is an open question whether the conditions are also sufficient, or whether one needs to add additional conditions. We present sufficient conditions for $2$-compatibility in the Appendix and we relegate the question of necessary and sufficient conditions to future research.

\paragraph{Constructing the SDP hierarchy}
%These results will allow us to construct an SDP hierarchy that will be able to certify that Alice must have access to at least $k+1$ incompatible measurements.
Given Bob's state assemblage $\{\rho_{a|x}\}_{a,x}$, one can construct its SEO $\{S_{a|x}\}_{a,x}$. We know that if Alice's measurement assemblage $\{M_{a|x}\}_{a,x}$ is $k$-simulable then so is Bob's SEO, which means that if $\{S_{a|x}\}_{a,x}$ is not $k$-simulable then neither is $\{M_{a|x}\}_{a,x}$. This way, by checking the $k$-simulability of $\{S_{a|x}\}_{a,x}$ one can extract information about Alice's measurements: if Bob's SEO are $k$-simulable the test is inconclusive, but if $\{S_{a|x}\}_{a,x}$ is not $k$-simulable then we can conclude that Alice's measurement assemblage must consist of at least $k+1$ incompatible measurements.

%\textcolor{red}{This paragraph needs reformulation: we should not state that our method has a caveat. That is a red flag for a referee.} 
The task of checking the $k$-simulability of a set of POVMs cannot in general be easily computed, but one can perform the following tests: One can test the $k$-compatibility of $\{S_{a|x}\}_{a,x}$ using an SDP, or one can test the $k$-compatibility of $\{S_{a|x}\}_{a,x}$ and enforce that the $k$-copy joint observable has positive partial transpose using an SDP, or one can test whether $\{S_{a|x}\}_{a,x}$ is $k$-compatible with $k$-copy joint observable in a separable form through an SDP hierarchy. These SDPs give a series of tests and if any of these SDPs is not feasible, then we know that Alice's assemblage must consist of at least $k+1$ incompatible measurements. If all of these SDPs are feasible, then the result of the tests is inconclusive, since the existence of a separable $k$-copy joint observable does not imply that it can be selected to be in a product form.

Even though SDPs for computing the joint measurability of a set $\{M_{a|x}\}$ can be directly written from the definition of compatibility, it takes some further investigation to be able to formulate an analogous construction to $k$-compatibility. We must recall the main result in \cite{carmeli2016}, stating that the $k$-compatibility of a set $\{M_{a|x}\}_{a,x}$ is equivalent to compatibility of the set $\{\tilde{M}^k_{a|x}\}_{a,x}$, defined as
\begin{equation} \label{eq:k-comp-to-comp}
    \tilde{M}^k_{a|x} = \dfrac{1}{k} \sum_{\ell=0}^{k-1} \id^{\ell} \otimes M_{a|x} \otimes \id^{\otimes k-\ell-1}.
\end{equation}
With this result, one can construct an SDP formulation to check the $k$-compatibility of Bob's SEO. All that is left is to also require that the $k$-copy joint observables are also separable. From Eq. \eqref{eq:k-comp-to-comp} it is clear that if the $k$-copy joint observable of $\{M_{a|x}\}$ is of the product form then the joint observable of $\{\tilde{M}_{a|x}\}$ is separable.
%\textcolor{red}{This part is confusing: it seems that the focus shifts from product form joint measurements to separable joint measurements. From the text it is not clear why having a product form joint measurement for $\{M_{a|x}\}$ implies the existence of a separable joint measurement for $\{\tilde{M}^k_{a|x}\}$.}

%\textcolor{red}{This paragraph talks about bipartite operators, whereas above the product form is required in the multipartite setting. Should there be some small bridge here explaining why the focus shifts to bipartite?}
A bipartite operator $X \in \mathcal{L}(\mathcal{H}_A \otimes \mathcal{H}_B)$, where $\mathcal{L}(\mathcal{H}_A \otimes \mathcal{H}_B)$ denotes the set of linear operators on the tensor product of Hilbert spaces $\mathcal{H}_A$ and $\mathcal{H}_B$, is said to be separable if it can be written as $X = \sum_i Y_i \otimes Z_i$, where $Y_i, Z_i$ are positive operators on $\mathcal{H}_A$ and $\mathcal{H}_B$ respectively. Determining whether an operator can be put in this form is an NP-hard problem but there are many separability criteria that can be used tackle this problem, most famously the Positive Partial Transpose (PPT) criterion, stating that if $X$ is separable then its partial transpose must be positive, i.e. $X^{T_A} \geq 0$. Here $T_A$ denotes the partial transpose over the system $A$, defined as $(X_A \otimes X_B)^{T_A} = X_A^T \otimes X_B$.

%\textcolor{red}{Is it directly clear why the DPS hierarchy, which seems to be designed for bipartite states and their extensions, applies to multipartite operators.}
One can consider the DPS hierarchy of criteria established in \cite{dps}, where symmetric extensions of $X \in \mathcal{L}(\mathcal{H}_A \otimes \mathcal{H}_{B_1})$ are constructed, namely operators $\tilde{X}_N \in \mathcal{L}(\mathcal{H}_A \otimes \mathcal{H}_{B_1} \otimes \ldots \otimes \mathcal{H}_{B_N})$ such that $\tr_{B_2, \ldots, B_N}[\tilde{X}_N] = X$ and $\tilde{X}_N = P \tilde{X}_N P$, where $P$ is the operator that performs any permutation of $\mathcal{H}_{B_1}, \ldots, \mathcal{H}_{B_N}$. If a certain operator $X$ has symmetric extension for arbitrary $N \in \Nl$, then $X$ is separable. This construction can be easily generalized to proving full separability of multipartite operators. In this case one needs to search for symmetric extensions over all parties but one, see \cite{aubrun2022monogamy}.

With this construction, one can build an SDP hierarchy to test whether Bob's SEO is $k$-compatible with separable $k$-copy joint observable. Since the $N$\textsuperscript{th} level of the hierarchy corresponds to symmetrically extending its POVM elements to $N$ copies, we can also apply the PPT criterion to them to improve convergence of the hierarchy. Whenever the test fails one can be sure that $\{S_{a|x}\}_{a,x}$ are not $k$-compatible with $k$-copy joint observable in a product form, and hence, after evaluating the string of implications we constructed, Alice must have access to at least $k+1$ incompatible measurements. For $N=2$ we obtain the following SDP:
\begin{align*}
 &\text{given} && \tilde{S}^k \\
 &\text{find} && \tilde{G}  \\
 &\text{s.t.} && \\
 &\text{$k$-compatibility} &&
 \begin{cases}
    & \tilde{S}^k_{a|x} = \sum_{\lambda} p(a|x,\lambda)G_{\lambda}, \forall a,x \\
    & \sum_{\lambda}G_{\lambda} = \id \\
    & G_{\lambda} \geq 0, \forall \lambda
 \end{cases} \\
 &\text{PPT} &&
 \begin{cases}
    & \tilde{G}_{\lambda}^{T_X} \geq 0, X = \{ A, B_1, B_2 \} \\
 \end{cases} \\
 &\text{first level of DPS} &&
 \begin{cases}
    & \tr_{B_2}[\tilde{G}_{\lambda}] = \tr_{B_1}[\tilde{G}_{\lambda}] = G_{\lambda} \\
    & \tilde{G}_{\lambda} \geq 0
 \end{cases}
\end{align*}
Whenever this task has no solution one can conclude that Alice has access to at least $k+1$ incompatible measurements. If there is $\tilde{G}$ that obeys these constraints the test is inconclusive and one can consider higher levels of the separability hierarchy.

\paragraph{Examples}
To test the efficiency of this test in certifying a lower bound for the number of Alice's measurements, one can investigate the typical example of measurements in mutually unbiased bases (MUB). Consider the noisy version of Alice's measurement assemblage $\{M_{a|x}\}$, consisting of $n_m$ measurements with $n_a$ outcomes each, parameterized by the visibility $t \in [0,1]$ as $M^t_{a|x} = t M_{a|x} + (1-t) \frac{\id}{n_a}$. For $t=0$ we have simply a trivial set of measurements, which is clearly $k$-compatible with separable $k$-copy joint measurement, and for $t=1$ we recover the original MUB measurements. One can evaluate what is the lowest value of the critical visibility $t_c$ for which $\{M^t_{a|x}\}_{a,x}$ passes the test, meaning for $t \geq t_c$ we can certify that Alice's assemblage consists of at least $k+1$ incompatible measurements.

For qubits we do not need to consider the DPS hierarchy, since in this case an operator is separable if and only if it is PPT. We thus obtain that for all three MUBs, the critical visibility for 2-compatibility is $\frac{\sqrt{3}}{2}$, while the critical visibility for 2-compatibility with separable $k$-copy joint observable is $\sqrt{\frac{2}{3}}$.

For qutrits our findings are summarized in Table~\ref{tab-qutrit}. The full criteria to be evaluated is that the set $\{{S}^k_{a|x}\}_{a,x}$ must be $k$-compatible with separable $k$-copy joint observable. We provide three upper estimates: $k$-compatibility, $k$-compatibility with PPT, that is, the case when we enforce that the $k$-copy joint observable is PPT, and $k$-compatiblity with PPT and first level DPS, that is, the case when we enforce that the $k$-copy joint observable is PPT and satisfies the first level of the DPS hierarchy.

\begin{table}
\begin{ruledtabular}
\begin{tabular}{ccccc}
$n_m$  & $k$ & $k$-compatibility  & PPT & first level DPS  \\
3 & 2 & 0.8553 & 0.7975 & 0.7393 \\
4 & 2 & 0.7681 & 0.6959 & 0.6933 \\
4 & 3 & 0.9310 & 0.8959 & 0.8592 \\
\end{tabular}
\end{ruledtabular}
\caption{Critical values $t_c$ for the visibility below which the set $\{{S}^k_{a|x}\}$ is $k$-compatible, $k$-compatibile with PPT, i.e., we enforce that the $k$-copy joint observable is PPT, and $k$-compatible with PPT and first level DPS, i.e., we enforce that the $k$-copy joint observable is PPT and satisfies the first level of the DPS hierarchy. $n_m$ denotes the number of measurements used to generate $\{{S}^k_{a|x}\}$, the state was taken to be the maximally entangled state.\label{tab-qutrit}}
\end{table}

\paragraph{Conclusion}
We have developed a hierarchy of conditions that enable semi-device-independent certification of number of measurements. We implemented the first levels of the hierarchy using freely accessible software. As a special case of interest, we investigated mutually unbiased bases measured on a maximally entangled state under a noisy environment, a setting that is well in the reach of today's experimental techniques. To be more specific, our results show that if Bob wants to verify that Alice has access to more than 2 measurements, this can be done in presence of significant background noise.

Our results can also be used to check $k$-simulability of POVMs. Our conditions are necessary, which is in contrast to the fact that previously there were no known conditions. There are also several possible directions for future work. The most significant is to find conditions for $k$-simulability that are both necessary and sufficient, and can be efficiently checked numerically. There are several scenarios in quantum information that can benefit from the use of notions researched in this work, we will demonstrate this by presenting two examples: One of the main obstacles in applications of device-independent quantum key distribution protocols \cite{nadlinger2022experimental,zhang2022device} is the low robustness of the protocols to various forms of noise present in the experiments. It is known that using higher dimensional Bell inequalities and Bell inequalities with more than two inputs and outcomes \cite{zapatero2023advances,miklin2022exponentially,xu2023graph,brown2021computing,gonzales2021device} can improve the noise thresholds necessary for secure quantum key distribution. The methods developed in this paper can be used by the parties in the quantum key distribution protocol to certify to each other that they have the necessary number of incompatible measurements, which are necessary to implement these protocols. Also the results hint at the possibility of semi-device-independent cryptography based on more than two measurements, which may again improve the feasibility of experimental applications. Another potential use is in attacking unknown quantum device; in every such attack there is a discovery phase where the attacker's goal is to learn as much as possible about the unknown device. The presented results show that if the attacker is able to send entangled states to the unknown device, then they can bound the number of incompatible measurements the unknown device can perform. %An important open question is how the notions researched in this work and the presented hierarchy apply to quantum networks, and the certification of non-classical properties therein.

\begin{acknowledgments}
\paragraph{Acknowledgments}
IV acknowledges the financial support of National Council for Scientific and Technological Development, CNPq Brazil, and thanks Carlos de Gois and Ties-A. Ohst for discussions.

MP acknowledges support from the Deutsche Forschungsgemeinschaft (DFG, German Research Foundation, project numbers 447948357 and 440958198), the Sino-German Center for Research Promotion (Project M-0294), the ERC (Consolidator Grant 683107/TempoQ), the German Ministry of Education and Research (Project QuKuK, BMBF Grant No. 16KIS1618K), and the Alexander von Humboldt Foundation.

LL acknowledges support from the European Unionâ€™s Horizon 2020 Research and Innovation Programme under the Programme SASPRO 2 COFUND Marie Sklodowska-Curie grant agreement No. 945478 as well as from projects APVV-22-0570 (DeQHOST) and VEGA 2/0183/21 (DESCOM).

RU is thankful for the financial support from the Swiss National Science Foundation (Ambizione PZ00P2-202179).
\end{acknowledgments}

\bibliography{refs}

%\cleardoublepage
\onecolumngrid
\appendix
\section{Sufficient conditions for $2$-simulability based on $2$-compatibility}

We make the following simple observation: Consider a set of $k$-compatible measurements $\{M_{a|x}\}_{a,x}$ with a $k$-copy joint observable $G_\lambda$ so that  
\begin{equation}\label{eq:k-comp}
    \tr[\rho M_{a|x}] = \sum_{\lambda} p(a|x,\lambda) \tr[\rho^{\otimes k} G_{\lambda}]
\end{equation}
for all states $\rho$ for some conditional probability distributions $p$. Suppose now that the POVM $\{G_{\lambda}\}_{\lambda}$ is a mixture of $k$ POVMs $\{\id^{\otimes y-1} \otimes B_{\lambda|y} \otimes \id^{\otimes k-y}\}_{\lambda,y}$, where $y \in \{1, \ldots,k\}$ and $\{B_{\lambda|y}\}_{b,y}$ are some $k$ POVMs. Thus, there exists a probability distribution $q$ such that
\begin{equation}
G_\lambda = \sum_{y=1}^k q(y) \left( \id^{\otimes y-1} \otimes B_{\lambda|y} \otimes \id^{\otimes k-y} \right).
\end{equation} 
Now we see that the original measurements $\{M_{a|x}\}_{a,x}$ are in fact $k$-simulable:
\begin{equation}
 \tr[\rho M_{a|x}] = \sum_{\lambda} p(a|x,\lambda) \tr[\rho^{\otimes k} G_{\lambda}] = \tr\left[\rho \left(\sum_{y=1}^k q(y) \sum_\lambda p(a|x,\lambda)  B_{\lambda|y}\right) \right].
\end{equation}

Consider now a set of $2$-compatible measurements $\{M_{a|x}\}_{a,x}$ with a joint observable $G_\lambda$. Let us take any two different states $\rho_1$ and $\rho_2$ and consider their mixture $\rho = \mu \rho_1 +(1-\mu) \rho_2$ by some weight $\mu \in (0,1)$. By the linearity of the trace we naturally have that $\tr[\rho M_{a|x}] = \mu \tr[\rho_1 M_{a|x}] + (1- \mu) \tr[\rho_2 M_{a|x}]$ and by using Eq. \eqref{eq:k-comp} for $k=2$ one can easily rephrase the condition as
\begin{equation}\label{eq:2-comp-vanish}
	\sum_{\lambda} p(a|x,\lambda) \tr\left[ \left( \rho_1 - \rho_2 \right)^{\otimes 2}G_\lambda \right] = 0 .
\end{equation}
Since this must hold for any two states $\rho_1$ and $\rho_2$, we must have that for all $a,x, \lambda$ such that $p(a|x,\lambda)\neq0$ we have that $G_\lambda = \tilde{B}_{\lambda|1} \otimes \id_B + \id_A \otimes \tilde{B}_{\lambda|2} + W_{\lambda}$ for some operators $\tilde{B}_{\lambda|1},\tilde{B}_{\lambda|2}, W_{\lambda}$ such that in particular $\tr\left[ \left( \rho_1 - \rho_2 \right)^{\otimes 2} W_{\lambda} \right] = 0$. In the case when $W_\lambda = 0$ and the operators $\tilde{B}_{\lambda|1}$ and $\tilde{B}_{\lambda|2}$ are selfadjoint we can show that the observation described above applies.

\begin{proposition}
Let $\{M_{a|x}\}_{a,x}$ be a set of $2$-compatible POVMs with a $2$-copy joint POMV $G$. If $G_\lambda \in \linspan(\{ B_1 \otimes \id_B + \id_A \otimes B_2 : B_1 \in \mathcal{L}(\mathcal{H}_A), B_2 \in \mathcal{L}(\mathcal{H}_B), B_1, B_2 \text{ are selfadjoint}\})$ for all $\lambda$, then $\{M_{a|x}\}_{a,x}$ are $2$-simulable.
\end{proposition}
\begin{proof}
    Since $G$ is a 2-copy joint POVM for $\{M_{a|x}\}_{a,x}$, there exists a conditional probability ditribution $p$ such that $\tr[\rho M_{a|x}] = \sum_{\lambda} p(a|x,\lambda) \tr[\rho^{\otimes 2} G_{\lambda}]$ for all $a,x$. If now $G \in \linspan(\{ B_1 \otimes \id_B + \id_A \otimes B_2 : B_1 \in \mathcal{L}(\mathcal{H}_A), B_2 \in \mathcal{L}(\mathcal{H}_B), B_1, B_2 \text{ are selfadjoint}\})$, then there exists some  selfadjoint $\tilde{A}_\lambda \in \mathcal{L}(\mathcal{H}_A),  \tilde{B}_\lambda \in \mathcal{L}(\mathcal{H}_B)$ such that $G_\lambda = \tilde{A}_\lambda \otimes \id_B +  \id_A \otimes \tilde{B}_\lambda$. We see that in fact we can choose another decomposition $G_\lambda = A_\lambda \otimes \id_B +  \id_A \otimes B_\lambda$ such that $A_\lambda$ and $B_\lambda$ are positive semidefinite: Namely, let us consider the spectral decompositions $\tilde{A}_\lambda = \sum_i \nu_\lambda^{(i)} \ket{\phi_\lambda^{(i)}}\bra{\phi_\lambda^{(i)}}$ and $\tilde{B}_\lambda = \sum_j \mu_\lambda^{(j)} \ket{\psi_\lambda^{(j)}}\bra{\psi_\lambda^{(j)}}$ for some real numbers $\nu_\lambda^{(i)}, \mu_\lambda^{(j)}$ and some orthonormal bases $\{\phi_\lambda^{(i)}\}_i$ and $\{\psi_\lambda^{(j)}\}_j$ of $\mathcal{H}_A$ and $\mathcal{H}_B$, respectively. Then we clearly have that 
    \begin{equation}
        G_\lambda = \tilde{A}_\lambda \otimes \id_B +  \id_A \otimes \tilde{B}_\lambda = \sum_{i,j} (\nu_\lambda^{(i)}+ \mu_\lambda^{(j)}) \ket{\phi_\lambda^{(i)}}\ket{\psi_\lambda^{(j)}}\bra{\psi_\lambda^{(j)}}\bra{\phi_\lambda^{(i)}}.
    \end{equation}
    The above equation defines a spectral decomposition for $G_\lambda$ so that from the positive semidefiniteness of $G_\lambda$ it follows that $\nu_\lambda^{(i)}+ \mu_\lambda^{(j)} \geq 0$ for all $i,j,\lambda$. Thus, in particular we must have that either $\tilde{A}_\lambda$ or $\tilde{B}_\lambda$ or both of them are positive semidefinite for all $\lambda$. Without loss of generality, we assume that $\tilde{A}_\lambda \geq 0$ so that $\nu^{(i)}_\lambda \geq 0$ for all $i,\lambda$. By denoting $\nu^{min}_\lambda := \min_i \nu^{(i)}_\lambda$ and defining $A_\lambda := \tilde{A}_\lambda - \nu^{min}_\lambda \id_A$ we see that also $A_\lambda \geq 0$. Now we see that 
    \begin{equation*}
        G_\lambda = \tilde{A}_\lambda \otimes \id_B +  \id_A \otimes \tilde{B}_\lambda = A_\lambda \otimes \id_B +  \nu^{min}_\lambda \id_A \otimes \id_B + \id_A \otimes \tilde{B}_\lambda = A_\lambda \otimes \id_B +  \id_A \otimes \left(\nu^{min}_\lambda \id_B + \tilde{B}_\lambda \right)
    \end{equation*}
    so that by denoting $B_\lambda := \nu^{min}_\lambda \id_B + \tilde{B}_\lambda$ we must have that $B_\lambda$ is positive semidefinite because $\nu_\lambda^{min}+ \mu_\lambda^{(j)} \geq 0$ for all $j$.

    By taking the partial traces separately with respect to $\mathcal{H}_A$ and $\mathcal{H}_B$ from the normalization condition $\sum_\lambda G_\lambda = \id_A \otimes \id_B$ we see now that
    \begin{align}
        \sum_\lambda A_\lambda &=  \left(1-\frac{\sum_\lambda \tr[B_\lambda]}{d_B} \right) \id_A \\
        \sum_\lambda B_\lambda &=  \left(1-\frac{\sum_\lambda \tr[A_\lambda]}{d_A} \right) \id_B \, .
    \end{align}
    Since $A_\lambda$ and $B_\lambda$ are positive semidefinite, we must have that $q :=  \left(1-\frac{\sum_\lambda \tr[B_\lambda]}{d_B} \right) \geq 0$ and $q' := \left(1-\frac{\sum_\lambda \tr[A_\lambda]}{d_A} \right) \geq 0$, and from the normalization of $G$ it also follows that $q' = 1- q$. By denoting $C_\lambda := \frac{1}{q} A_\lambda$ and $D_\lambda := \frac{1}{1-q} B_\lambda$ whenever $q,1-q \neq 0$ and $C_\lambda := 0 =: D_\lambda$ otherwise, we  have that $\{C_\lambda\}_{\lambda}$ and $\{D_\lambda\}_{\lambda}$ are in fact two POVMs such that
    \begin{equation}
        G_\lambda = q C_\lambda \otimes \id_B + (1-q) \id_A \otimes D_\lambda
    \end{equation}
    for all $\lambda$. Now we see that we are in the case described by the observation in the beginning of this section so that $\{M_{a|x}\}_{a,x}$ are $2$-simulable.

    %By using the fact that $G$ is a $2$-copy joint POVM for $\{M_{a|x}\}_{a,x}$ we finally have that
   % \begin{equation}
        %\tr[\rho M_{a|x}] = \sum_{\lambda} p(a|x,\lambda) \tr[\rho^{\otimes 2} G_{\lambda}] = \tr\left[\rho \left(  q \sum_{\lambda} p(a|x,\lambda)  C_\lambda  + (1-q) \sum_{\lambda} p(a|x,\lambda) D_\lambda \right) \right]
    %\end{equation}
\end{proof}

We note that both the $2$-compatibility and the previously described condition for the $2$-copy joint POVM can be checked by using SDPs.

\end{document}