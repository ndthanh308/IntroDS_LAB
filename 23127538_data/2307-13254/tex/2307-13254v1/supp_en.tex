\clearpage

\begin{center}
\textbf{\large Supplementary material for \\ ``Conditional Cross Attention Network for Multi-space Embedding without Entanglement in Only a SINGLE Network''}
\end{center}
%\author{
%Chull Hwan Song$^1$ \ \ \ \ Jooyoung Yoon$^1$ \ \ \ \ Shunghyun %Choi$^1$ \ \ \ \ Yannis Avrithis$^{2,3}$\\
%\normalsize $^1$Dealicious Inc.\quad
%\normalsize $^2$Institute of Advanced Research on Artificial %Intelligence (IARAI)\quad
%\normalsize $^3$Athena RC\\
%}

\maketitle
\thispagestyle{empty}

% PAGE NUMBER SET TO 1
%\setcounter{page}{1}

% LINE NUMBER SET TO 1
%\iccvrulercount=1

% START APPENDIX
\appendix

% NUMBERING
\renewcommand{\theequation}{A\arabic{equation}}
\renewcommand{\thetable}{A\arabic{table}}
\renewcommand{\thefigure}{A\arabic{figure}}

%------------------------------------------------------------------------------

\section{Datasets}
\label{sec:data_examples}



\paragraph{FashionAI \cite{Zou2019FashionAIAH}}
The data published in the FashionAI Global Challenge 2018 has 180,335 apparel images. This dataset comprises 8 fashion attributes containing 55 classes each. 
%\footnote{https://tianchi.aliyun.com/competition/entrance/231671/introduction}
\vspace*{-15pt}
%
\paragraph{DARN \cite{Huang01}} 
An open dataset for attribute classification and street-to-shop image retrieval, comprising 253,983 images and 9 attributes. Each attribute contains 185 classes. The data is provided as image URLs; excluding broken URLs that cannot be downloaded, we used 195,771 URLs. 
\vspace*{-15pt}
%
\paragraph{DeepFashion \cite{liu2016deepfashion}}
This dataset comprises 289,222 images and 6 attributes. Each attribute contains 1000 classes. 
\vspace*{-26pt}
%
\paragraph{Zappos50K \cite{Zappos}}
This dataset comprises 50,025 shoe images collected from Zappos.com. It consists of 4 attributes containing 34 classes each.

%\label{sec:Datasets}
\autoref{fig:app2} presents actual examples using the four training sets. The figure shows four examples in the order of FashionAI \cite{Zou2019FashionAIAH}, DARN \cite{Huang01}, DeepFashion \cite{liu2016deepfashion}, Zappos50k \cite{Zappos}. 

%\label{sec:Datasets}


%\subsection{Datasets}
%\label{sec:Datasets}


% \begin{table} [tb!]
% %\tiny
% \renewcommand{\arraystretch}{1.0}
% \centering 
% \resizebox{0.9\columnwidth}{!}{
% \begin{tabular}{lcc}
% \toprule
% \textbf{DataSets} & \textbf{\#Attributes} & \textbf{\#Classes In Attributes} \\
% \midrule
% FashionAI \cite{Zou2019FashionAIAH} & 8 & 55 \\
% DARN \cite{Huang01} & 9 & 185 \\
% DeepFashion \cite{liu2016deepfashion} & 5 & 1000 \\
% Zappos50k \cite{Zappos} & 4 & 34 \\
% \bottomrule
% \end{tabular}
%  }
%  \vspace{-8pt}
%  \caption{ The number of attributes and the number of classes within attributes about our trainsets.}
% \label{tab:datasets}
% \end{table}

\section{More experiments}
\label{sec:more_exp}

%\input{exp/sota_zappos.tex}
%\input{exp/sota_deepfashion.tex}

\subsection{Benchmarking : DeepFashion}
\label{sec:more_DeepFashion}



\autoref{tab:DeepFashion} presents the experimental results for DeepFashion, described in detail in \autoref{sec:eval}. 

%\subsection{Benchmarking : Zappos50K}
%\label{sec:more_Zappos}
%\autoref{tab:zappos50k} presents the experimental results for Zappos50K, described in detail in \autoref{sec:eval}



\section{More Visualization}
\label{sec:more_vis}

% Figure environment removed

\subsection{Ranking and Attention Heat map}
\label{sec:more_ranking}

\autoref{fig:app3} shows the Top 3 results along with each actual attention map. Each part of each attribute is considered, interpreted as the result of disentanglement multi-space modeling. The order in the figure is lapel design (notched), neckline design (round), skirt length (floor), pant length (midi), sleeve length (short), neck design (low turtle), coat length (midi), and collar design (peter pan).



% Figure environment removed

\subsection{Ours \vs Previous Works : Multi-Space Embedding}
\label{sec:more_previouswork}

% Figure environment removed

\autoref{fig:fig7} comparatively analyzed the embedding results of our study and previous studies. Of the 8 categories, the results for Neck Design, Sleeve Length, and Coat Length were presented. \autoref{fig:app4} shows the expanded results for all 8 categories. Our method solves the entanglement problem much better than ASEN \cite{ma2020fine} and CAMNet \cite{song2022}.

% % Figure environment removed


\algrenewcommand{\algorithmiccomment}[1]{$\triangleright$ #1}
\begin{algorithm}[t!]
%\footnotesize
\small
\caption{Pseudo-Code for CCA Training}
\label{alg_train}
\begin{algorithmic}[1]
\State \textbf{input:} 
Image $\mathcal{I}$, Condition $c$ \\
batch  $\mathcal{B}$, training epochs $K$, triplet set $\mathcal{T}$ \\
Self Attention Block $SA$, Conditional Cross Attention $CCA$
\For{$epoch= 1,...,K $}
    \For{$\mathcal{B}=1,...,M \in \mathcal{T} $}
        \State $Triplet(\mathcal{A}_c, \mathcal{P}_c, \mathcal{N}_{c})\gets \mathcal{B}$
        \State $\mathcal{I}, c \gets \mathcal{A}_c, \mathcal{P}_c, \mathcal{N}_{c}$
        %\State \# Patch, Position Encoding etc 
        \State $\mathcal{Q}_i, \mathcal{K}_i, \mathcal{V}_i \gets Token\_{Embedding}(\mathcal{I})$
        \For{$l=1,...,(\mathcal{L}-1) $}  
            \State $ \mathcal{Q}_i, \mathcal{K}_i, \mathcal{V}_i \gets SA (\mathcal{Q}_i, \mathcal{K}_i, \mathcal{V}_i)$               
        \EndFor    
        \State \textbf{Last iteration} $ l = \mathcal{L} $ \textbf{do} 
        \State \hspace{\algorithmicindent} $ \mathcal{Q}_c \gets Conditional\_Token\_Embedding(c) $
        \State \hspace{\algorithmicindent} $ \cls \gets CCA (\mathcal{Q}_c, \mathcal{K}_i, \mathcal{V}_i)$
        \State \hspace{\algorithmicindent} $ f \gets l2(FC(\cls))$
        \State calculate $ f_a, f_p, f_n \gets Triplet(\mathcal{A}_c, \mathcal{P}_c, \mathcal{N}_{c})$
        \State calculate triplet loss $\mathcal{L} (f_a, f_p, f_n | c)$
        \State calculate gradients of $\nabla\mathcal{L}(\theta)$
        \State $\theta \gets Adam(\nabla\mathcal{L}(\theta)$)
    \EndFor
\EndFor
\end{algorithmic}
\end{algorithm}