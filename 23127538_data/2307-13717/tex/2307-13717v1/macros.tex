% Type macros:
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\party}[1]{\ensuremath{\mathit{#1}}}  % Parties are just in math font
\newcommand{\poracle}[2]{\ensuremath{\pi_{\myuser{#1}}^{\myuser{#2}}}} % Party oracles. Lower index for party, upper index for session number

\newcommand{\set}[1]{\ensuremath{\mathcal{#1}}}
\newcommand{\binset}[1]{\ensuremath{\{0,1\}^{#1} }}
\newcommand{\mystate}[2]{\ensuremath{\msg{st}_{\mathsf{#1}}^{#2}}} % Party oracles. Lower index for session number, upper index for party (type)

\newcommand{\myphase}{\ensuremath{\mathsf{phase}}}

\newcommand{\msg}[1]{\ensuremath{\mathsf{#1}}} % Protocol messages are in SF
\providecommand{\primitive}[1]{\ensuremath{\textnormal{#1}}} % primitives are in normal font

\newcommand{\alg}[1]{\ensuremath{\mathtt{a{#1}}}} % algorithms are in TT
\newcommand{\oracle}[1]{\ensuremath{\mathsf{o{#1}}}}

\newcommand{\makett}[1]{\ensuremath{\mathtt{{#1}}}} % algorithms are in TT


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Parties:
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\myparty}{\party{P}}

\newcommand{\myuser}[1]{\party{#1}}
\newcommand{\mysu}{\party{\hat{S}}}


\newcommand{\myalice}{\party{A}}
\newcommand{\mybob}{\party{B}}
\newcommand{\myA}{\myalice}
\newcommand{\myB}{\mybob}

\newcommand{\id}{\ensuremath{\mathsf{ID}}}
\newcommand{\myid}[1]{\ensuremath{{\myuser{#1}}}}
\newcommand{\idp}{\ensuremath{{P} }}
\newcommand{\idq}{\ensuremath{{Q} }}
\newcommand{\elechat}{\ensuremath{\poracle{P}{Q}}}
\newcommand{\aux}{\ensuremath{\mathsf {AD}}}


\newcommand{\myP}{\ensuremath{\party{P}}}
\newcommand{\myQ}{\ensuremath{\party{Q}}}
\newcommand{\myR}{\ensuremath{{\party{R}[s]}}}
\newcommand{\myS}{\ensuremath{{\party{S}[s]}}}

\newcommand{\PARTIES}{\set{P}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Attributes:
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\newcommand{\mystage}{\ensuremath{\mathsf{stages}}}
\newcommand{\pstage}[2]{\ensuremath{\poracle{#1}{#2}.\mystage}}

\newcommand{\ptau}[2]{\ensuremath{\poracle{#1}{#2}.T}}
\newcommand{\annosent}{\ensuremath{\mathsf{SentM}}}
\newcommand{\annorec}{\ensuremath{\mathsf{RecM}}}

\newcommand{\ptaurec}[2]{\ensuremath{\ptau{#1}{#2}_{\annorec}}}
\newcommand{\ptausent}[2]{\ensuremath{\ptau{#1}{#2}_{\annosent}}}
\newcommand{\pastptau}[3]{\ensuremath{\ptau{#1}{#2}[#3]}}


\newcommand{\freshbit}[2]{\ensuremath{\poracle{#1}{#2}.\phi}}
\newcommand{\statusbit}[2]{\ensuremath{\poracle{#1}{#2}.{\sf status}}}

\newcommand{\bitreject}{\ensuremath{0}}
\newcommand{\bitaccept}{\ensuremath{1}}
\newcommand{\bitindec}{\ensuremath{\bot}}
\newcommand{\testbit}[3]{\ensuremath{\poracle{#1}{#2}.\mathsf{b}[#3]}}
\newcommand{\authbit}[2]{\ensuremath{\poracle{#1}{#2}.\alpha}}
\newcommand{\prole}[2]{\ensuremath{\poracle{#1}{#2}.\msg{role}}}
\newcommand{\roleinit}{\ensuremath{\texttt{Initiator}}}
\newcommand{\roleresp}{\ensuremath{\texttt{Responder}}}
\newcommand{\myrole}{\textnormal{\ensuremath{\texttt{role}}}}

\newcommand{\pastauthbit}[3]{\ensuremath{\poracle{#1}{#2}.\alpha[#3]}}

\newcommand{\pid}{\ensuremath{\mathsf{pid}}}
\newcommand{\sid}{\ensuremath{\mathsf{sid}}}

\newcommand{\psid}[2]{\ensuremath{\poracle{#1}{#2}.\msg{sid}}}
\newcommand{\ppid}[2]{\ensuremath{\poracle{#1}{#2}.\msg{pid}}}

\newcommand{\pastpstate}[3]{\ensuremath{\poracle{#1}{#2}.[#3]}}

\newcommand{\nbparties}{\ensuremath{\mathsf{n}_\PARTIES}}

\newcommand{\qtype}{\ensuremath{\mathsf{q.type}}}
\newcommand{\qinput}{\ensuremath{\mathsf{q.input}}}
\newcommand{\qresp}{\ensuremath{\mathsf{q.rsp}}}

\newcommand{\prchp}[3]{\ensuremath{\poracle{#1}{#2}.\mathsf{rchpk}[#3]}} % the public rch key of stage #3 for #1
\newcommand{\pfrec}[2]{\ensuremath{\poracle{#1}{#2}.\mathsf{rec}}}



%=====================================
% SAID
%=======================================

\newcommand{\said}{\textsf{SAID}}
\newcommand{\imam}{\textsf{iMAM}}
\newcommand{\SAIDmsk}{\ensuremath{\msg{msk}}}
\newcommand{\SAIDrchk}{\ensuremath{\mathsf{rchk}}}
\newcommand{\SAIDrchpk}{\ensuremath{\mathsf{rchpk}}}
\newcommand{\SAIDmsg}{\ensuremath{\mathsf{M}}}
\newcommand{\SAIDct}{\ensuremath{\mathsf{C}}}
\newcommand{\KDC}{\ensuremath{{KDC}}}


%=====================================
% SCEKE
%=======================================

\newcommand{\sceke}{\textsf{SCEKE}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Keys:
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\sk}{\msg{sk}}
\newcommand{\pk}{\msg{pk}}
\newcommand{\ks}{\msg{K}}
\newcommand{\ipk}[1]{\ensuremath{\mathsf{ipk}_{\myuser{#1}}}}
\newcommand{\prek}[1]{\ensuremath{\mathsf{prek}_{\myuser{#1}}}}
\newcommand{\prepk}[1]{\ensuremath{\mathsf{prepk}_{\myuser{#1}}}}
\newcommand{\ephpk}[1]{\ensuremath{\mathsf{ephpk}_{\myuser{#1}}}}
\newcommand{\ephk}[1]{\ensuremath{\mathsf{ephk}_{\myuser{#1}}}}

\newcommand{\epk}[1]{\ensuremath{\mathsf{Epk}_{\myuser{#1}}}}
\newcommand{\esk}[1]{\ensuremath{\mathsf{ek}_{\myuser{#1}}}}


\newcommand{\ik}[1]{\ensuremath{\mathsf{ik}_{\myuser{#1}}}}
\newcommand{\presk}[1]{\ensuremath{\mathsf{presk}_{\myuser{#1}}}}
\newcommand{\ephsk}[2]{\ensuremath{\mathsf{ephsk}_{\myuser{#1}}^{#2}}}

\newcommand{\sidsk}[2]{\ensuremath{\mathsf{sidsk}_{\myuser{#1}}^{#2}}}
\newcommand{\sidpk}[2]{\ensuremath{\mathsf{sidpk}_{\myuser{#1}}^{#2}}}


\newcommand{\sidcsk}[2]{\ensuremath{\myuser{#1}.X\sid}}
\newcommand{\sidcsgk}[2]{\ensuremath{\poracle{\myuser{#1}}{#2}.X\textsf{stage}}}
\newcommand{\sidssgk}[2]{\ensuremath{\poracle{\myuser{#1}}{#2}.\mathtt{1}\textsf{stage}}}


\newcommand{\currentck}[2]{\ensuremath{\poracle{#1}{#2}.\msg{bk}}}
\providecommand{\currentmk}[2]{\ensuremath{ \poracle{#1}{#2}.k[s]}}
\providecommand{\currentrk}[2]{\ensuremath{ \poracle{#1}{#2}.\rk{s}}}

\newcommand{\pastck}[3]{\ensuremath{\poracle{#1}{#2}.\msg{ck}[{#3}]}}

\newcommand{\msgk}[3]{\ensuremath{\myuser{#1}.\mathsf{k}^{{#2},{#3}}}}

\newcommand{\msk}{\ensuremath{\msg{msk}}}
%\newcommand{\msk}{\ensuremath{\msg{msk}}}
\newcommand{\mpk}{\ensuremath{\msg{mpk}}}


\newcommand{\rchk}[2]{\ensuremath{\mathsf{rchk}_{\myuser{#1}}^{#2}}}
\newcommand{\rchpk}[2]{\ensuremath{\mathsf{Rchpk}_{\myuser{#1}}^{#2}}}
%super ratchet keys
\newcommand{\RCHK}[2]{\ensuremath{\mathsf{t}^{\myuser{#1}}_{#2}}}
\newcommand{\RCHPK}[2]{\ensuremath{\mathsf{T}^{\myuser{#1}}_{#2}}}

\newcommand{\skm}[1]{\ensuremath{\mathsf{SKM}_{\myuser{#1}}}}
\newcommand{\pkm}[1]{\ensuremath{\mathsf{PKM}_{\myuser{#1}}}}

\newcommand{\ski}[1]{sk_{#1}}
\newcommand{\pki}[1]{pk_{#1}}

\newcommand{\rk}[1]{\ensuremath{\mathsf{rk}_{#1}}}
\newcommand{\ck}[2]{\ensuremath{\mathsf{ck}_{\myuser{#1}}^{#2}}}
\newcommand{\tagk}[1]{\ensuremath{\mathsf{tag}^{#1}}}
\newcommand{\mk}[2]{\ensuremath{\mathsf{mk}_{\myuser{#1}}^{#2}}}

\newcommand{\expo}[2]{\ensuremath{\mathsf{(#1)}^{#2}}}

%key space
\newcommand{\kspace}{\ensuremath{\mathcal{K}}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Protocol messages//variables:
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\pastlist}{\set{D}}
%\newcommand{\rand}{\stackrel{{}_{\$}}{\leftarrow}}
\newcommand{\rand}{\ensuremath{\xleftarrow{\$}}}
\newcommand{\atrandom}{\ensuremath{{\leftarrow}_{\text{R}}}}
\newcommand{\expogroup}{\ensuremath{\mathbb{Z}_\myprime}}
\newcommand{\dhgroup}{\ensuremath{\mathbb{G}_\myprime}}

\newcommand{\ms}[1]{\ensuremath{\msg{ms}_{\myuser{#1}}}}
\newcommand{\ltstate}[1]{\ensuremath{\mathsf{lt.st}_{#1}}}
\newcommand{\ephstatek}{\ensuremath{\mathsf{var}}}
\newcommand{\keytypes}{\ensuremath{\mathsf{ktypes}}}
\newcommand{\keyset}{\ensuremath{\mathsf{key.set}}}
\newcommand{\ephstateK}{\mathcal{V}}
\newcommand{\ephstate}[2]{\ensuremath{\poracle{#1}{#2}.\ephstatek}}
\newcommand{\myad}{\ensuremath{\msg{AD}}}

\newcommand{\pastephstate}[3]{\ensuremath{\poracle{#1}{#2}.\mathsf{keys}[#3]}}

\newcommand{\pubstate}[2]{\ensuremath{\poracle{#1}{#2}.\mathsf{pub.st}}}

\newcommand{\emptystring}{\ensuremath{\varepsilon}}

\newcommand{\KDF}[1]{\ensuremath{{\mathsf{KDF}}_{#1}}}
\newcommand{\HKDF}[1]{\ensuremath{{\mathsf{HKDF}}_{#1}}}
\newcommand{\HMAC}{\ensuremath{\mathsf{HMAC}}}

\newcommand\extracteval[1]{\mathsf{HKDF}.\makett{Ext}(#1)}
\newcommand\expandeval[1]{\mathsf{HKDF}.\makett{XP}(#1)}
\newcommand{\pair}[1]{\ensuremath{e(#1)}}

\newcommand{\trsc}[3]{\poracle{#1}{#2}.Tr[#3]} % transcript for a stage #3, on user #1's side for the convo with #2


%=====================================
% Algorithms
%-=====================================

\newcommand{\fivegp}{\textsf{5GAKE}$_{3}$}
\newcommand{\myprimitive}{\texttt{SCEKE}}
\newcommand{\xnplus}{\texttt{XN}$^{+}$}

\newcommand{\algStart}{\ensuremath{\alg{Start}}}% CRISTINA
\newcommand{\algSend}{\ensuremath{\alg{Send}}}% CRISTINA
\newcommand{\algRKGen}{\ensuremath{\alg{RGen}}}
\newcommand{\algKGen}{\ensuremath{\alg{KeyGen}}}
\newcommand{\algSetup}{\ensuremath{\alg{Setup}}}
\newcommand{\protUReg}{\ensuremath{\Pi_{\mathtt{UReg}}}}
\newcommand{\protStart}{\ensuremath{\Pi_{\mathtt{Start}}}}


\newcommand{\algReceive}{\ensuremath{\alg{Receive}}}
\newcommand{\algextract}{\ensuremath{\makett{Extr}}}

\newcommand{\algttSetup}{\ensuremath{\makett{Setup}}}
\newcommand{\algSIGN}{\ensuremath{\makett{SIGN}}}
\newcommand{\algsign}{\ensuremath{\makett{Sign}}}
\newcommand{\algverify}{\ensuremath{\makett{Vrfy}}}
\newcommand{\algenc}[1]{\ensuremath{\makett{Enc}\left(#1\right)}}
\newcommand{\algdec}[1]{\ensuremath{\makett{Dec}\left(#1\right)}}
\newcommand{\algprf}{\ensuremath{\makett{PRF}}}
\newcommand{\algae}{\ensuremath{\makett{AE}}}
\newcommand{\algaead}{\ensuremath{\makett{AEAD}}}
\newcommand{\algaeadenc}{\ensuremath{\algaead \ensuremath{\makett{.Enc}}}}
\newcommand{\algaeaddec}{\ensuremath{\algaead \ensuremath{\makett{.Dec}}}}

\newcommand{\algmess}{\ensuremath{\makett{Message}}}
\newcommand{\algnonce}{\ensuremath{\makett{Nonce}}}
\newcommand{\algheader}{\ensuremath{\makett{Header}}}

\newcommand{\algmac}{\ensuremath{\makett{MAC}}}

\newcommand{\algaegen}{\ensuremath{\makett{Gen}}}
\newcommand{\algaeinit}{\ensuremath{\makett{AE.Init}}}
\newcommand{\algaedec}{\ensuremath{\makett{AE.Dec}}}
\newcommand{\algaeenc}{\ensuremath{\makett{AE.Enc}}}
\newcommand{\algaestE}{\ensuremath{\mathsf{st}_{\mathsf{E}}}}
\newcommand{\algaestD}{\ensuremath{\mathsf{st}_{\mathsf{D}}}}
\newcommand{\insync}{\ensuremath{\operatorname{\mathsf{in-sync}}}}

\newcommand{\algmain}{\ensuremath{\alg{Main.Exp}}}

\newcommand{\oEnc}{\ensuremath{\oracle{AEnc}}}
\newcommand{\oDec}{\ensuremath{\oracle{ADec}}}
\newcommand{\oRDec}{\ensuremath{\oracle{RoR.ADec}}}
\newcommand{\oMess}{\ensuremath{\oracle{Messaging}}}
\newcommand{\oSign}{\ensuremath{\oracle{Sign}}}

\newcommand{\algcommit}{\ensuremath{\makett{Commit}}}
\newcommand{\algmaul}{\ensuremath{\makett{Maul}}}
\newcommand{\algrerand}{\ensuremath{\makett{ReRand}}}
\newcommand{\algopen}{\ensuremath{\makett{Open}}}

\newcommand{\mylist}[1]{\ensuremath{\mathcal{L}_{\mathsf{#1}}}}
\newcommand{\revlist}{\mylist{rev}}
\newcommand{\potlist}{\mylist{maybe}}
\newcommand{\corrlist}{\mylist{corr}}
\newcommand{\tmlist}{\mylist{tm}}
\newcommand{\mallist}{\mylist{mal}}
\newcommand{\lorlist}{\mylist{LoR}}
\newcommand{\cipherlist}{\mylist{ctxt}}
\newcommand{\userlist}{\mylist{usr}}
\newcommand{\sessionlist}{\mylist{\pi}}
\newcommand{\qlist}{\mylist{sign}}
\newcommand{\enclist}{\mylist{enc}}
\newcommand{\qulist}{\mylist{query}}

\newcommand{\shu}[3]{\ensuremath{\mathsf{SHU}(\poracle{#1}{#2},{#3})}} % to know if Send was given honest AD
\newcommand{\rhu}[3]{\ensuremath{\mathsf{RHU}(\poracle{#1}{#2},{#3})}} % to know if Receive was given honest AD


\providecommand{\addtolist}{\ensuremath{\hookleftarrow}}

\providecommand{\successor}[1]{\ensuremath{ {\sf next}(#1)}}
\providecommand{\rdec}{\ensuremath{m}}
\providecommand{\renc}{\ensuremath{c}}
\providecommand{\achoice}{\ensuremath{\beta}}

\providecommand{\forgery}[1]{\ensuremath{{#1}^*}}

\newcommand{\myrelation}{\mathcal{R}}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Oracles:
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\oUReg}{\ensuremath{\oracle{UReg}}}
\newcommand{\oInit}{\ensuremath{\oracle{Start}}}
\newcommand{\oSend}{\ensuremath{\oracle{Send}}}
\newcommand{\oReceive}{\ensuremath{\oracle{Receive}}}
\newcommand{\oReveal}{\ensuremath{\oracle{Reveal}}}
\newcommand{\oRevealCS}{\ensuremath{\oracle{Reveal.XStage}}}
\newcommand{\oRevealSS}{\ensuremath{\oracle{Reveal.\mathtt{1}Stage}}}
\newcommand{\oCorrupt}{\ensuremath{\oracle{Reveal.XSid}}}
\newcommand{\oEncrypt}{\ensuremath{\oracle{AEnc}}}
\newcommand{\oDecrypt}{\ensuremath{\oracle{ADec}}}
\newcommand{\oHSM}{\ensuremath{\oracle{AccessSK}}}
\newcommand{\oracleSet}{\ensuremath{\mathcal{O}}}
\newcommand{\oRevMed}{\ensuremath{\oracle{RevMedKey}}}

\newcommand{\oTest}{\ensuremath{\oracle{Test}}}
\newcommand{\ROM}{\ensuremath{\mathcal{RO}}}

\newcommand{\danger}[1]{\mathsf{Danger(#1)}}
\newcommand{\actdan}[1]{\mathsf{Act.Dan(#1)}}
\newcommand{\hijack}[1]{\mathsf{Hijack(#1)}}
\newcommand{\leak}[1]{\mathsf{Leak(#1)}}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Adversaries
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\newcommand{\adv}{\ensuremath{\mathcal{A}}}
\newcommand{\adversary}{\ensuremath{\mathcal{A}}}
\newcommand{\challenger}{\ensuremath{\mathcal{C}}}
\newcommand{\bdv}{\ensuremath{\mathcal{B}}}
\newcommand{\cdv}{\ensuremath{\mathcal{C}}}
\newcommand{\ddv}{\ensuremath{\mathcal{D}}}
\newcommand{\edv}{\ensuremath{\mathcal{E}}}
\newcommand{\fdv}{\ensuremath{\mathcal{F}}}
\newcommand{\gdv}{\ensuremath{\mathcal{G}}}
\newcommand{\idv}{\ensuremath{\mathcal{I}}}

\providecommand{\advstate}[1]{\ensuremath{\mathsf{state}_{#1}}}

\newcommand{\simulator}{\ensuremath{\mathsf{Sim}}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Advantages & security properties
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\newcommand{\secpar}{\ensuremath{1^\lambda}}
\newcommand{\spar}{\ensuremath{\mathsf{s\param}}}
\newcommand{\ppar}{\ensuremath{\mathsf{p\param}}}
\newcommand{\param}{\ensuremath{\mathsf{param}}}

\newcommand{\myprot}{\ensuremath{\Pi}}

%\newcommand{\proto}[2]{\ensuremath{\mathsf{\Pi^{\myuser{#1}}_{\myuser{#2}}}}}

\newcommand{\scprop}{\ensuremath{\mathsf{SC}}}
\newcommand{\sacce}{\ensuremath{\mathsf{SACCE}}}
\newcommand{\acce}{\ensuremath{\mathsf{ACCE}}}
\newcommand{\ake}{\ensuremath{\mathsf{AKE}}}
\newcommand{\sake}{\ensuremath{\mathsf{S\text{-}AKE}}}

\newcommand{\expgame}[1]{\ensuremath{\mathsf{Exp}_\myprot^{#1}(\lambda ,\adv)}}
\newcommand{\pcsakegame}{\ensuremath{\expgame{\mathsf{PCS\text{-}AKE}}}}
\newcommand{\ooogame}{\ensuremath{\expgame{\mathsf{MLR}}}}



\newcommand{\pfsgame}{\ensuremath{\expgame{\mathsf{AKE}}}}
\newcommand{\exfgame}{\ensuremath{\expgame{\mathsf{Exf}}}}
\newcommand{\pfsexfgame}{\ensuremath{\expgame{\mathsf{Exf}}}}
\newcommand{\eufcmagame}{\ensuremath{\expgame{\mathsf{EUF-CMA}}}}
\newcommand{\kdfgame}{\ensuremath{\expgame{\mathsf{KDF}}}}
\newcommand{\lhaegame}{\ensuremath{\expgame{\mathsf{LHAE}}}}
\newcommand{\aeadgame}{\ensuremath{\expgame{\mathsf{AEAD}}}}

\newcommand{\akefwgame}{\ensuremath{\expgame{\operatorname{\mathsf{FW\text{-}S\text{-}AKE}}}}}
\newcommand{\pfsfwgame}{\ensuremath{\expgame{\operatorname{\mathsf{FW\text{-}AKE}}}}}


\newcommand{\eaprop}{\ensuremath{\mathsf{EA}}}
\newcommand{\accprop}{\ensuremath{\mathsf{Acc}}}
\newcommand{\csoundprop}{\ensuremath{\mathsf{CSound}}}

\newcommand{\csound}{\ensuremath{\mathsf{CSound}}}

\newcommand{\nbparty}{\ensuremath{\mathsf{n_P}}}
\newcommand{\nbstages}{\ensuremath{\mathsf{n_S}}}
\newcommand{\nbinstances}{\ensuremath{\mathsf{n_\pi}}}
\newcommand{\nbmedkeys}{\ensuremath{\mathsf{n_{\prek{}}}}}


\newcommand{\Prob}{\mathbb{P}}

\newcommand{\gadvantage}[1]{\ensuremath{\mathsf{Adv}_{#1}}}
\newcommand{\padvantage}[3]{\ensuremath{\mathsf{Adv}^{#3}_{#2}({#1})}}
\newcommand{\advsc}[1]{\ensuremath{\padvantage{#1}{\myprot}{\scprop}}}
\newcommand{\advea}[1]{\ensuremath{\padvantage{#1}{\myprot}{\eaprop}}}
\newcommand{\advacc}[1]{\ensuremath{\padvantage{#1}{\myprot}{\accprop}}}
\newcommand{\advcsound}[1]{\ensuremath{\padvantage{#1}{\myprot}{\csoundprop}}}
%\newcommand{\advsake}[1]{\ensuremath{\padvantage{#1}{\myprot}}}
\newcommand{\advunf}[1]{\ensuremath{\padvantage{#1}{\mathsf{Sign}}{\mathsf{Unf}}}}
\newcommand{\advprop}[1]{\ensuremath{\padvantage{#1}{\myprot}{\mathsf{prop}}}}

\newcommand{\advake}[1]{\ensuremath{\padvantage{#1}{\Psi}{\mathsf{AKE}}}}

\newcommand{\advpcs}[1]{\ensuremath{\padvantage{#1}{\Pi}{\mathsf{PCS-AKE}}}}


\newcommand{\advcres}[1]{\ensuremath{\padvantage{#1}{H}{\mathsf{C.Res}}}}
\newcommand{\adveufcma}[1]{\ensuremath{\padvantage{#1}{\mathsf{Sign}}{\mathsf{EUF-CMA}}}}

\newcommand{\advgdh}[1]{\ensuremath{\padvantage{#1}{\mathsf{}}{\mathsf{GDH}}}}


\newcommand{\advlhae}[1]{\ensuremath{\padvantage{#1}{\mathsf{\algaead}}{\mathsf{LHAE}}}}

\newcommand{\advsacce}[2]{\ensuremath{\padvantage{#1}{#2}{\sacce}}}
\newcommand{\advacce}[2]{\ensuremath{\padvantage{#1}{#2}{\acce}}}

\newcommand{\advpfs}[2]{\ensuremath{\padvantage{#1}{#2}{\mathsf{AKE}}}}
\newcommand{\advsake}[2]{\ensuremath{\padvantage{#1}{#2}{\sake}}}


\newcommand{\advexf}[2]{\ensuremath{\padvantage{#1}{#2}{\mathsf{Exf}}}}
\newcommand{\advpfsexf}[2]{\ensuremath{\padvantage{#1}{#2}{\mathsf{Exf}}}}


\newcommand{\advfwpfs}[2]{\ensuremath{\padvantage{#1}{#2}{\mathsf{FW\text{-}PFS}}}}
\newcommand{\advfwsake}[2]{\ensuremath{\padvantage{#1}{#2}{\mathsf{FW}\text{-}\sake}}}
\newcommand{\advAKE}[2]{\ensuremath{\padvantage{#1}{#2}{\ake}}}
\newcommand{\advae}[1]{\ensuremath{\padvantage{#1}{\mathsf{AE}}{\mathsf{stLHAE}}}}
\newcommand{\advaead}[1]{\ensuremath{\padvantage{#1}{\mathsf{Enc,Dec}}{\mathsf{AEAD}}}}

\newcommand{\clock}{\ensuremath{\mathsf{clock}}}
\newcommand{\game}[1]{\ensuremath{\mathbb{G}\mathsf{ame}_{#1}}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% names
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\pname}{A Comprehensive Analysis on the Leakage of Fuzzy Matchers}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% Layout and style:
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\myparagraph}[1]{\vspace{2mm} \noindent \textbf{#1.}}
\newcommand{\mysubpar}[1]{\noindent \hspace{1mm} \textbf{\underline{#1.}} \hspace{1mm}}
\newcommand{\gamehop}[1]{\ensuremath{\mathbb{G}_{#1}} \vspace{1mm}}
\newcommand{\accro}{\ensuremath{\mathsf{3(S)ACCE}}}
\newcommand{\nth}[1]{\ensuremath{{#1}\textnormal{-th}}}

\newcommand{\exec}{\ensuremath{\leftarrow}}

\newcommand{\ie}{\emph{i.e.}, }
\newcommand{\eg}{\emph{e.g.}, }
\newcommand{\etal}{\emph{et al.}}

\newcommand{\Gr}{\mathbb{G}}
\newcommand{\Z}{\mathbb{Z}}
\newcommand{\Zq}{\mathbb{Z}_q}
\newcommand{\Zp}{\mathbb{Z}_p}
\newcommand{\N}{\mathbb{N}}
\newcommand{\Q}{\mathbb{Q}}
\newcommand{\R}{\mathbb{R}}
\newcommand{\A}{\mathcal{A}}
\newcommand{\mymax}[2]{\ensuremath{\textsc{MAX}\big[#1, #2\big]}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%
% proocol's variables
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\alghash}{\ensuremath{\makett{H}}}
\newcommand{\randomness}{\ensuremath{r}}
\newcommand{\gtor}{\ensuremath{h}}
\newcommand{\generator}{\ensuremath{g}}
\newcommand{\idsign}{\ensuremath{\alg{ID}\algsign}}
\newcommand{\idverify}{\ensuremath{\alg{ID}\algverify}}
\newcommand{\abort}{\ensuremath{\msg{abort}}}
\newcommand{\concat}{\ensuremath{||}}
\newcommand{\ibe}{\ensuremath{\makett{IBE}}}



\newcommand{\ibs}{\ensuremath{\mathsf{IBSig}}}
\newcommand{\ibsSetup}{\ensuremath{\alg{IBS.Setup}}}
\newcommand{\ibsExtract}{\ensuremath{\alg{IBS.Extract}}}
\newcommand{\ibsSign}{\ensuremath{\alg{IBS.Sign}}}
\newcommand{\ibsVf}{\ensuremath{\alg{IBS.Vfy}}}

\newcommand{\ibsparams}{\ensuremath{\mathsf{IBS.ppar}}}
\newcommand{\ibsmpk}{\ensuremath{\mathsf{IBS.mpk}}}
\newcommand{\ibsmsk}{\ensuremath{\mathsf{IBS.msk}}}

\newcommand{\ibssk}{\ensuremath{\mathsf{IBS.sk}}}
\newcommand{\ibsusk}[1]{\ensuremath{\ibssk_{\myid{#1}}}}

\newcommand{\idmpk}{\ensuremath{\mathsf{ID.mpk}}}
\newcommand{\idmsk}{\ensuremath{\mathsf{ID.msk}}}
\newcommand{\idsk}[1]{\ensuremath{\mathsf{ID.sk}_{#1}}}
\newcommand{\mytag}[1]{\ensuremath{\mathsf{tag}^{#1}}}

\newcommand{\meta}{\ensuremath{\mathsf{meta}}}





\newcommand{\idenc}{\ensuremath{\makett{ID}\algenc}}
\newcommand{\signature}{\ensuremath{\mathsf{sgn}}}
\newcommand{\AD}{\textnormal{AD}}
\newcommand{\M}{M}
\newcommand{\dhoutput}{\ensuremath{\Delta}}
\newcommand{\dhout}[1]{\ensuremath{\mathsf{DH}^{#1}}}
% signature on stage x,y
\newcommand{\sig}[1]{\ensuremath{\sigma_{#1}}}
%%%%%%%%%%%%%%
%% ENVIRONMENTS %%
%%%%%%%%%%%%%%
\newtheorem{definition}{Definition}      %commented for LNCS
\newtheorem{theorem}{Theorem}      %commented for LNCS
\newtheorem{proof}{Proof}

%scale (equation)
\newcommand*{\Scale}[2][4]{\scalebox{#1}{$#2$}}%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%% 5G-AKA %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\aka}{\ensuremath{\mathsf{AKA}}}
\newcommand{\topc}{\ensuremath{\mathsf{Top}_C}}
\newcommand{\UE}{\party{UE}}
\newcommand{\HN}{\party{HN}}
\newcommand{\SN}{\party{SN}}
\newcommand{\gNB}{\party{gNB}}
\newcommand{\core}{\party{Core}}

\newcommand{\USIM}{\ensuremath{\mathsf{USIM}}}
\newcommand{\TMSI}{\ensuremath{\mathsf{TMSI}}}
\newcommand{\SUPI}{\ensuremath{\mathsf{SUPI}}}
\newcommand{\SUCI}{\ensuremath{\mathsf{SUCI}}}
\newcommand{\GUTI}{\ensuremath{\mathsf{GUTI}}}
\newcommand{\AG}{Assign-\ensuremath{\mathsf{GUTI}}}
\newcommand{\IMSI}{\ensuremath{\mathsf{IMSI}}}
\newcommand{\SQNU}{\ensuremath{\mathsf{SQN_U}}}
\newcommand{\SQNN}{\ensuremath{\mathsf{SQN_H}}}
\newcommand{\SQNs}{\ensuremath{\mathsf{SQN_s}}}
\newcommand{\pubenc}[2]{\ensuremath{\{#1\}^{#2}_\pk}}

\newcommand{\mycard}{\ensuremath{\mathsf{U}}}
%\newcommand{\sk}{\ensuremath{\mathsf{sk}}}
\newcommand{\sksub}[1]{\ensuremath{\sk_{#1}}}
\newcommand{\skop}{\ensuremath{\sk_\mathsf{op}}}
\newcommand{\sqn}[1]{\ensuremath{\mathsf{SQN_{#1}}}}
\newcommand{\myop}{\ensuremath{\mathsf{H}}}
\newcommand{\av}{\ensuremath{\mathsf{AV}}}
\newcommand{\autn}{\ensuremath{\mathsf{Autn}}}
\newcommand{\res}{\ensuremath{\mathsf{Res}}}
\newcommand{\akey}{\ensuremath{\mathsf{AK}}}
\newcommand{\myterm}{\ensuremath{\mathsf{T}}}
\newcommand{\Mac}{\ensuremath{\mathsf{Mac}}}
\newcommand{\Macsn}{\ensuremath{\Mac_{\mathsf{\myterm}}}}
\newcommand{\MAC}{\ensuremath{\mathsf{MAC}}}
\newcommand{\ckey}{\ensuremath{\mathsf{CK}}}
\newcommand{\ikey}{\ensuremath{\mathsf{IK}}}
\newcommand{\Macns}{\ensuremath{\Mac_{\mathsf{\mycard}}}}
\newcommand{\amf}{\ensuremath{\mathsf{AMF}}}
\newcommand{\RAND}[1]{\ensuremath{\mathsf{R}_{#1}}}
\newcommand{\nametl}{\ensuremath{\mathsf{VLR}}}
\newcommand{\namebackend}{\ensuremath{\mathsf{HLR}}}
\newcommand{\lai}{\ensuremath{\mathsf{LAI}}}
\newcommand{\uid}{\ensuremath{\mathsf{UID}}}
\newcommand{\func}[1]{\ensuremath{#1}}
\newcommand{\funcF}[1]{\ensuremath{\func{\mathcal{F}}_{#1}}}
\newcommand{\funcFstar}[1]{\ensuremath{\funcF{#1}^*}}


\newcommand{\xor}{\ensuremath{\oplus}}

\newcommand{\stack}{\emph{5G-SCEKE}}
\newcommand{\stackplus}{\emph{5G-SCEKE$^{+}$}}



%=================================================
% Comments :
%=================================================
%\usepackage{pifont}
\newlength{\strutdepth}%
\settodepth{\strutdepth}{\strutbox}%
\newcommand{\mycomment}[3]{%
    \noindent{\bfseries
        \color{#2}{#1}\color{black}}%
    \strut\vadjust{\kern-\strutdepth%
        \vtop to \strutdepth{%
            \baselineskip\strutdepth%
            \vss\llap{{\large\color{#2}#3\quad\color{black}}}\null%
        }%
    }%
}

\newcommand{\axel}[1]{\mycomment{#1}{magenta}{Axel}}
\newcommand{\kev}[1]{\mycomment{#1}{blue}{Kevin}}
\newcommand{\pascal}[1]{\mycomment{#1}{olive}{Pascal}}
\newcommand{\leo}[1]{\mycomment{#1}{orange}{Leo}}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% tikz:
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\newcommand{\link}{ \draw[<->,>=latex]}
\newcommand{\att}{ \draw[-latex,dashed,ultra thick]}

\newcommand*{\QEDB}{\null\nobreak\hfill\ensuremath{\square}}%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% modifications:
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\newcommand{\removetext}[1]{{\color{red}{\sout{#1}}}}
\newcommand{\addtext}[1]{{\color{teal}{#1}}}
\newcommand{\replacetext}[2]{\removetext{#1} \addtext{#2}}

\newcommand{\serveur}[0]{\ensuremath{\mathcal{S}}}
\newcommand{\client}[0]{\ensuremath{\mathcal{C}}}
\newcommand{\pwd}[0]{\ensuremath{\mathsf{pwd}}}

\newcommand{\databio}[0]{\ensuremath{\mathsf{bio}}}
\newcommand{\helpvalue}[0]{\ensuremath{\mathcal{\nu}}}
\newcommand{\pubclient}[0]{\ensuremath{\mathsf{P_u}}}
\newcommand{\privclient}[0]{\ensuremath{\mathsf{p_u}}}

\newcommand{\pubserv}[0]{\ensuremath{\mathsf{P_s}}}
\newcommand{\privserv}[0]{\ensuremath{\mathsf{p_s}}}

\newcommand{\keyserv}[0]{\ensuremath{\mathsf{k_s}}}

\newcommand{\rw}[0]{\ensuremath{\mathsf{rw}}}
\newcommand{\hash}[1]{\ensuremath{\mathcal{H}\left(#1\right)}}
\newcommand{\authenv}[1]{\ensuremath{\mathsf{AuthEnv}\left(#1\right)}}
\newcommand{\authenvrw}[1]{\ensuremath{\mathsf{AuthEnv}_{\rw}\left(#1\right)}}
\newcommand{\aec}[0]{\ensuremath{\mathsf{c}}}
\newcommand{\cval}[0]{\ensuremath{\alpha}}
\newcommand{\sval}[0]{\ensuremath{\beta}}


\newcommand{\algen}[2]{\ensuremath{\makett{Enc}_{#1}\left(#2\right)}}

\newcommand{\algencbio}[1]{\ensuremath{\makett{Enc}_{\databio}\left(#1\right)}}
\newcommand{\algdecbio}[1]{\ensuremath{\makett{Dec}_{\databio}\left(#1\right)}}


\newcommand{\Fq}[0]{\ensuremath{\mathbb{F}_q}}
\newcommand{\Fqn}[0]{\ensuremath{\mathbb{F}_q^n}}
\newcommand{\Fdn}[0]{\ensuremath{\mathbb{F}_2^n}}
\newtheorem{theo}{Theorem}[section]
\newtheorem{rem}{Remark}[subsection]
\newtheorem{ex}{Example}[subsection]

\newcounter{protocol}
\newenvironment{protocol}[1]
{\par\addvspace{\topsep}
    \noindent
    \tabularx{\linewidth}{@{} X @{}}
    \hline
    \refstepcounter{protocol}\textbf{Protocol \theprotocol} #1 \\
    \hline}
{\\
    \hline
    \endtabularx
    \par\addvspace{\topsep}}

\newcommand{\sbline}{\\[.5\normalbaselineskip]}% small blank line
