\documentclass{svjour3}
\usepackage{graphicx}
\usepackage{float}
\usepackage[justification=centering]{subfig}
\usepackage{cite}
\usepackage{hyperref}
\hypersetup{hidelinks}
\usepackage{url}
\usepackage{listings}
\usepackage{xcolor}
\usepackage{tcolorbox}
\usepackage{caption}
\usepackage{booktabs}
\usepackage{multirow}
\usepackage{enumerate}
\usepackage{textcomp}
\usepackage{booktabs}
\usepackage[sort,compress]{natbib}
\usepackage{diagbox}
\usepackage{enumitem}
\usepackage[misc,geometry]{ifsym}

\newtcolorbox{qoutebox}[3][]
{
  colframe = gray!30!white,
  colback  = #2!10,
  #1,
}

\begin{document}

\title{Demystifying Code Snippets in Code Reviews: A Study of the OpenStack and Qt Communities and A Practitioner Survey}
\titlerunning{Code Snippets in Code Reviews}

\author{Beiqi Zhang   \and
        Liming Fu     \and
        Peng Liang    \and
        Jiaxin Yu     \and
        Chong Wang
}

\institute{Beiqi Zhang \and Liming Fu \and Peng Liang (\Letter) \and Jiaxin Yu \and Chong Wang (\Letter) \at School of Computer Science, Wuhan University, Wuhan, China \\ 
            Hubei Luojia Laboratory, Wuhan, China\\
            \email{\{zhangbeiqi, limingfu, liangp, jiaxinyu, cwang\}@whu.edu.cn}
}

\date{Received: date / Accepted: date}

\maketitle

\begin{abstract}
Code review is widely known as one of the best practices for software quality assurance in software development. In a typical code review process, reviewers check the code committed by developers to ensure the quality of the code, during which reviewers and developers would communicate with each other in review comments to exchange necessary information. As a result, understanding the information in review comments is a prerequisite for reviewers and developers to conduct an effective code review. Code snippet, as a special form of code, can be used to convey necessary information in code reviews. For example, reviewers can use code snippets to make suggestions or elaborate their ideas to meet developers' information needs in code reviews. However, little research has focused on the practices of providing code snippets in code reviews.
To bridge this gap, we conduct a mixed-methods study to mine information and knowledge related to code snippets in code reviews, which can help practitioners and researchers get a better understanding about using code snippets in code review. Specifically, our study includes two phases: mining code review data and conducting practitioners' survey. In Phase 1, we conducted an exploratory study to mine code review data from two popular developer communities (i.e., OpenStack and Qt). We manually labelled 55,673 review comments and finally identified 3,197 review comments that contain code snippets. Based on the code review data collected, we analyzed the extent of using code snippets, the reviewers' purposes of providing code snippets, the developers' acceptance of code snippet suggestions, and the reasons that developers do not accept code snippet suggestions in code reviews. In Phase 2, we used an online questionnaire to survey practitioners from industry. By analyzing the 63 valid responses we received, we explored the scenarios reviewers provide code snippets, the developers' attitudes towards code snippets, and the characteristics of code snippets developers expect reviewers to provide in code reviews.
Our results show that: (1) code snippets are not frequently used in code reviews, and most of the code snippets are provided by reviewers rather than developers; (2) the purposes of reviewers providing code snippets in code reviews are \textit{Suggestion} and \textit{Citation}, in which \textit{Suggestion} is the main purpose; (3) most developers would accept reviewers' comments containing code snippets with the aim of \textit{Suggestion}; (4) the most common reasons that developers do not accept reviewers' code snippet suggestions in code reviews are \textit{difference in the opinions between developers and reviewers} and \textit{reviewer's suggestion is flawed}; (5) reviewers often provide code snippets in code reviews \textit{when code is more illustrate than words}; (6) most developers hold positive attitudes towards code snippet comments in code reviews; and (7) most developers expect that code snippets in review comments are \textit{concise}, \textit{correct}, and \textit{executable}. The study results highlight that reviewers can provide code snippets in appropriate scenarios to meet developers' specific information needs in code reviews, which will facilitate and accelerate the code review process.
\keywords{Modern Code Review \and Code Snippets \and Mining Software Repositories \and Empirical Study}
\end{abstract}

\input{introduction}
\input{relatedwork}
\input{methodology}
\input{results}
\input{discussion}
\input{threats}

\section{Conclusions}
\label{sec:conclusions}
In this work, we conducted a mixed-methods study on code snippets in code reviews. We first analyzed the code review data mined from four most active projects of the OpenStack (Nova and Neutron) and Qt (Qt Base and Qt Creator) communities. We then conducted an industrial survey to get the practitioners' perspective on code snippets in code reviews. More specifically, we manually analyzed the extent of using code snippets, the reviewers' purposes of providing code snippets, the developers’ acceptance of code snippet suggestions, and the reasons developers do not accept code snippet suggestions in code reviews through the repository mining study, and we explored the scenarios in which reviewers provide code snippets, the developers’ attitudes towards code snippets, and the characteristics of code snippets developers expect reviewers to provide in code reviews through the industrial survey study. 

According to the study results, code snippets are not frequently used in code reviews, and most of the code snippets in review comments are provided by reviewers. Reviewers use code snippets in code reviews with the aim of \textit{Suggestion} and \textit{Citation}, in which \textit{Suggestion} is the main purpose, and most developer would accept reviewers' code snippet suggestions. \textit{Difference in the opinions between developers and reviewers} and \textit{Reviewer's suggestion is flawed} are the main reasons why developers do not accept reviewers' code snippet suggestions. Reviewers tend to provide code snippets in code reviews \textit{when code is more illustrate than words}. Most developers hold positive attitudes towards provided code snippets in code reviews, and they expect that the provided code snippets can be \textit{Concise}, \textit{Correct}, and \textit{Executable}.

Based on the study results, we found that code snippets can be used as a special way to meet developers' information needs in code reviews, and appropriately using code snippets in code reviews will make the communication between developers and reviewers more effective. We suggested novel insights and future directions related to code snippets in code reviews for researchers. Meanwhile, we provided useful knowledge and information about using code snippets in code reviews in practices for practitioners, which can guide practitioners towards a more effective code review process.

In the next step, we plan to extend this work by studying code snippets in code reviews in a larger set of data sources, including pull request data from GitHub, more diverse projects from different communities (e.g., projects mainly written in Java from the Apache community). Besides, we intend to expand the scope of the industrial survey by including more participants from various development groups (e.g., inner source development). We also plan to explore the purposes of developers providing code snippets in code reviews through interviews and thus attain a more comprehensive understanding of code snippets in code reviews.

\section*{Acknowledgements}
This work is supported by the National Natural Science Foundation of China (NSFC) under Grant No. 62172311 and the Special Fund of Hubei Luojia Laboratory.

\section*{Data Availability Statements}
The data generated and analyzed during the current study is available in the Zenodo repository at \citep{replpack}.

\bibliographystyle{spbasic}
\bibliography{references}

\end{document}