%!TEX root = ../main.tex

%\newcommand{\xihat}{}
\section{Generalization to Initial Conditions}
 We shall bound this difference when $\sfkhat$ states are $\xihat$, $\sfkst$ at $\xist$ \ab{this sentence does not make sense}. Standard imitation bounds can be obtained by setting $\xihat = \xist = \xi$, and integrating of $\xi$ from some initial condition.
We use the variable $\xi \in \cS$ to denote intial conditions, and let $\Dist_{\pol}(\xi)$ denote the law of the sequence $\traj = (s_{1:H},a_{1:H},\sfk_{1:H})$, where $s_{1} = \xi$, each $\sfk_h$ is distributed according to $\pi_h(s_h)$, and $a_h = \eval(s_h, sfk_h)$ for each $1 \leq h \leq H$.

\begin{definition}\label{defn:fis_beta}We say that $\pi$ is $(\betafs,\gamfs,\pfs)$-\emph{feedback-incrementally stable} (FIS) on $\Dinit$ ($(\betafs,\gamfs,\pfs)$-FIS) if for every initial state $\xi' \in \cS$ and sequence of actions $a_{1:H}' \in \cA^H$,  it holds with probability at least $1-\pfs$ over the trajectory $\traj = (s_{1:H},a_{1:H},\sfk_{1:H}) \sim \Dist_{\pol}$ that the dynamics $s_{1:H}'$ given by $s_{h+1}' = F_h(s_h',a_h')$ and $s_1' = \xi'$ 
satisy, for all $h \in [H]$,
\begin{align}
\dists(s_h,s_h') \le \betafs( \dists(\xi,\xi')) + \gamfs\left(\max_{j \in [h-1]}\dista(\eval_h(s_h',\sfk_h), a_j' )\right).
\end{align}
In words, the policy is FIS if the distance between states $s_h$ and $s_h'$ is small if both the inital states are close and the actions $a_h'$ are close to those provided by the policy. \ab{More explanation/motivation needed here.  Explain that $\pfs$ comes from randomness in $\sfk \sim \pol$.}

\mscomment{argue probabilisitc st}
%We say $\sfk$ is $(\betafs,\gamfs,\etaiss,\etaisa)$-locally FIS if the above only holds for all $\dists(\xi,\xi') \le \etais$ and $\dista(a_h,a_h') \le $
\end{definition} 


Can sharpen to this  \mscomment{sharper when using smoothing by $H$ factor}


Given all the above discussion, the following is our result.
\begin{proposition}\label{prop:IS_general_beta} Let $\sfkst$ be $(\gamfs,\betafs)$-FIS  \ab{what happened to $\pfs$?} at $\xi^\star \in \cS$ and let $\sfkhat$ be $\gamtvc$-TVC. Then for any $\hat\xi \in \cS$ and $\epsilon,\epsilon_0, \eta > 0$ satisfying   
\begin{align}
\max\left\{\epsilon_0,~ \betafs( \epsilon_0) + \gamfs(\eta)\right\} \le \epsilon, \label{eq:eps_cond}
\end{align}
then letting $\Psth \in \laws(\cS)$ denote the marginal distribution of $s_h$under $\Dist_{\pist}$ \ab{the definition of $\Psth$ should be moved up to where we are defining other quantities.},
\begin{align}
\Gamrob(\polhat \parallel \pist) \le \pfs + H\gamtvc(\epsilon) + \sum_{h=1}^H \Exp_{\sstar_h \sim \Psth}\left[\drob(\polhat,\polst \mid \sstar_h,h)\right].
\end{align}
\end{proposition}