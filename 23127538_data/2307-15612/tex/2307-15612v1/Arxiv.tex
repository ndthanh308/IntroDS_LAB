%% 
%% Copyright 2007-2020 Elsevier Ltd
%% 
%% This file is part of the 'Elsarticle Bundle'.
%% ---------------------------------------------
%% 
%% It may be distributed under the conditions of the LaTeX Project Public
%% License, either version 1.2 of this license or (at your option) any
%% later version.  The latest version of this license is in
%%    http://www.latex-project.org/lppl.txt
%% and version 1.2 or later is part of all distributions of LaTeX
%% version 1999/12/01 or later.
%% 
%% The list of all files belonging to the 'Elsarticle Bundle' is
%% given in the file `manifest.txt'.
%% 

%% Template article for Elsevier's document class `elsarticle'
%% with numbered style bibliographic references
%% SP 2008/03/01
%%
%% 
%%
%% $Id: elsarticle-template-num.tex 190 2020-11-23 11:12:32Z rishi $
%%
%%
\documentclass[preprint,12pt]{article}

%% Use the option review to obtain double line spacing
%% \documentclass[authoryear,preprint,review,12pt]{elsarticle}

%% Use the options 1p,twocolumn; 3p; 3p,twocolumn; 5p; or 5p,twocolumn
%% for a journal layout:
%% \documentclass[final,1p,times]{elsarticle}
%% \documentclass[final,1p,times,twocolumn]{elsarticle}
%% \documentclass[final,3p,times]{elsarticle}
%% \documentclass[final,3p,times,twocolumn]{elsarticle}
%% \documentclass[final,5p,times]{elsarticle}
%% \documentclass[final,5p,times,twocolumn]{elsarticle}

%% For including figures, graphicx.sty has been loaded in
%% elsarticle.cls. If you prefer to use the old commands
%% please give \usepackage{epsfig}

%% The amssymb package provides various useful mathematical symbols
\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{mathtools}
\usepackage{booktabs}
%\usepackage{authblk}

\usepackage{todonotes}
\newcommand{\rocco}[1]{\todo[color=green!40]{#1}}
\newcommand{\roccoinline}[1]{\todo[inline,color=green!40]{#1}}

\usepackage{tikz}
\usepackage{tikz-cd}
\tikzcdset{arrow style=tikz, diagrams={>=latex}}
\usepackage{enumerate}

%% The amsthm package provides extended theorem environments
\usepackage{amsthm}

\usepackage{color,colortbl}
\usepackage{tcolorbox}
\usepackage{hyperref}
\usepackage{xspace}
\usepackage{hhline}
%\usepackage{enumitem}

\theoremstyle{plain}
\newtheorem{teor}{Theorem}
\newtheorem*{teor*}{Theorem}
\newtheorem{lem}[teor]{Lemma}
\newtheorem{prop}[teor]{Proposition}
\newtheorem{cor}[teor]{Corollary}

\theoremstyle{definition}
\newtheorem{defn}[teor]{Definition}
\newtheorem*{defn*}{Definition}

\theoremstyle{remark}
\newtheorem{ex}[teor]{Example}
\newtheorem{rk}[teor]{Remark}
\newtheorem{observation}{Observation}

\newcommand{\tT}{{\widetilde{T}}}
\newcommand{\tJ}{{\widetilde{J}}}
\newcommand{\tI}{{\widetilde{I}}}

\newcommand{\RS}{\mathcal{RS}}

\newcommand{\res}{\mathrm{res}}
\newcommand{\en}{\textnormal{en}}

\newcommand{\mN}{\mathbb{N}}

\newcommand{\sA}{\mathcal{A}}
\newcommand{\sB}{\mathcal{B}}
\newcommand{\sfR}{\mathsf{R}}
\newcommand{\sfI}{\mathsf{I}}
\newcommand{\sfP}{\mathsf{P}}
\newcommand{\sfS}{\mathsf{S}}
\newcommand{\sfT}{\mathsf{T}}
\newcommand{\sfU}{\mathsf{U}}
\newcommand{\sfV}{\mathsf{V}}
\newcommand{\SO}{\mathsf{SO}}


\newcommand{\coNP}{\textnormal{\textbf{coNP}}\xspace}
\newcommand{\NP}{\textnormal{\textbf{NP}}\xspace}
\newcommand{\Pp}{\textnormal{\textbf{P}}\xspace}


\newcommand{\posV}{\text{pos}}
\newcommand{\negV}{\text{neg}}
\newcommand{\nV}{\overline{V}}

\colorlet{myBlue}{cyan!10!white}
\colorlet{myGray}{lightgray!30!white}

%% The lineno packages adds line numbers. Start line numbering with
%% \begin{linenumbers}, end it with \end{linenumbers}. Or switch it on
%% for the whole article with \linenumbers.
%% \usepackage{lineno}


\begin{document}

%\begin{frontmatter}

%% Title, authors and addresses

%% use the tnoteref command within \title for footnotes;
%% use the tnotetext command for theassociated footnote;
%% use the fnref command within \author or \address for footnotes;
%% use the fntext command for theassociated footnote;
%% use the corref command within \author for corresponding author footnotes;
%% use the cortext command for theassociated footnote;
%% use the ead command for the email address,
%% and the form \ead[url] for the home page:
%\title{Title\tnoteref{label1}}
%% \tnotetext[label1]{}
%\author{Rocco Ascone\corref{cor1}\fnref{label2}}
\author{Rocco Ascone$^\dag$\footnote{Corresponding author} \and Giulia Bernardini$^\dag$ \and Luca Manzoni\footnote{University of Trieste, Italy}}
%\ead{rocco.ascone@phd.units.it}
 %\fntext[label2]{}
%\cortext[cor1]{} 

          % addressline={},
            % city={},
            %postcode={},
            %state={}
% \fntext[label3]{}
\date{}

\title{Fixed Points and Attractors of Reactantless and Inhibitorless Reaction Systems}%titolo provvisorio. Alternativa 1: Fixed Points and Attractors of Reaction Systems with Limited Resources
\maketitle
%% use optional labels to link authors explicitly to addresses:
%% \author[label1,label2]{}
%% \affiliation[label1]{organization={},
%%             addressline={},
%%             city={},
%%             postcode={},
%%             state={},
%%             country={}}
%%
%% \affiliation[label2]{organization={},
%%             addressline={},
%%             city={},
%%             postcode={},
%%             state={},
%%             country={}}


\begin{abstract}
Reaction systems are discrete dynamical systems that model biochemical processes in living cells using finite sets of reactants, inhibitors, and products.
We investigate the computational complexity of a comprehensive set of problems related to the existence of fixed points and attractors in two constrained classes of reaction systems, in which either reactants or inhibitors are disallowed. These problems have biological relevance and have been extensively studied in the unconstrained case; however, they remain unexplored in the context of reactantless or inhibitorless systems. Interestingly, we demonstrate that although the absence of reactants or inhibitors simplifies the system's dynamics, it does not always lead to a  reduction in the complexity of the considered problems.
%compared to unconstrained reaction systems.
\end{abstract}
%% \linenumbers

%% main text
\section{Introduction}
\label{sec:intro}
Reaction systems are an abstract model of computation inspired by the chemical reactions in living cells, introduced by Ehrenfeucht and Rozenberg almost two decades ago~\cite{DBLP:conf/dlt/EhrenfeuchtR04, DBLP:journals/fuin/EhrenfeuchtR07}. The idea at the basis of reaction systems is that the processes carried out by biochemical reactions within a cell can be described through a finite set of entities, modelling different substances, and a finite set of rules, modelling reactions. A reaction is defined by a set of reactants, a set of inhibitors and a set of products: if any current set of entities (defining a \emph{state} of the reaction system) includes the set of reactants and does not contain any of the inhibitors, the reaction takes place and the products are generated. 

Reaction systems are a \emph{qualitative model}: 
they assume that if a reactant is present at a certain state, then its amount is always enough for all the reactions that use it to take place (i.e., reactions do not conflict even if they share some resources).
The next state of the reaction system is then given by the union of the products of the reactions that took place. 

Despite the simplicity of this formulation, it has been proven that reaction systems can simulate a variety of real-world biological processes~\cite{DBLP:journals/tcs/CorolliMMBM12}, including heat shock response~\cite{DBLP:journals/fuin/AzimiIP14}, gene regulatory networks~\cite{DBLP:journals/fuin/BarbutiBGGLM21} and oncogenic signalling~\cite{DBLP:journals/jmemcom/IvanovP20}.
Studying the computational complexity of the dynamics of reaction systems is also a rich and active research area~\cite{DBLP:journals/nc/FormentiMP15,DBLP:journals/tcs/AzimiG0MPP16,DBLP:journals/tcs/BarbutiGLM16,DBLP:journals/fuin/NobilePSMCMB17,DBLP:journals/iandc/DennunzioFMP19}; while the standard model for reaction systems does not pose any constraints on the number of reactants and inhibitors involved in the reactions, a different line of research is focused on the study of reaction systems with limited resources (i.e., bounding the number of reactants and/or inhibitors involved in any reaction)~\cite{DBLP:journals/ijfcs/EhrenfeuchtMR11,dennunzio2016reachability,DBLP:journals/tcs/Azimi17}.

This work is in the latter vein and studies the computational complexity of deciding the occurrence of behaviors related to fixed points, attractors and result functions in the special classes of \emph{reactantless} and \emph{inhibitorless} reaction systems. Since reaction systems can be used to model biological processes, these questions have biological relevance: for instance, determining whether fixed points and cycles are present is crucial in modelling gene regulatory networks~\cite{kauffman2004ensemble,bornholdt2008boolean}; and attractors can represent cellular types or states~\cite{DBLP:journals/pieee/ShmulevichDZ02}. 

To the best of our knowledge, the only existing works studying the complexity of dynamical behaviors in reactantless and inhibitorless reaction systems are concerned with the reachability problem~\cite{dennunzio2016reachability} and the evolvability problem~\cite{teh2022evolvability} (the latter work considering a different type of reaction systems, recently introduced by Ehrenfeucht et al.~\cite{ehrenfeucht2017evolving}). This work is thus an important step towards a full understanding of the dynamics in these constrained models.

\begin{table}[t]\resizebox{\textwidth}{!}{
    %\footnotesize
    \centering
    \renewcommand{\arraystretch}{1.1}
    \begin{tabular}{l c|c|c}%|c}
    %\hline
     \textbf{Problem} 
     &\multicolumn{1}{|c|}{$\RS(\infty,\infty)$}
     &$\RS(0,\infty)$ 
     &$\RS(\infty,0)$ 
     \\%&$\RS(1,0)$\\
     
     \toprule
    A given state is a fixed point attractor 
    &\multicolumn{1}{|c|}{\NP-c~\cite{formenti2014fixed}}  
    &\cellcolor{myBlue}{\Pp (Cor.~\ref{cor: reactnatless_T_fixed_att})} 
    &\cellcolor{myBlue}{$\Pp$ (Cor.~\ref{cor: inibithorless_T_fixed_att})}\\
    %&\multicolumn{2}{c}{\cellcolor{myBlue}\hyperlink{cor: inibithorless_T_fixed_att}{$\Pp$}}\\
    \hhline{====}
     
    $\exists$ fixed point 
    &\multicolumn{1}{|c|}{\NP-c~\cite{formenti2014fixed}}  
    &\cellcolor{myBlue}{\NP-c (Thm.~\ref{teor: reactantless_exist_fix_point}) }
    &Knaster-Tarski~\cite{Granas2003}\\%&\multicolumn{2}{c}{Knaster-Tarski} \\
    
    \hline
    $\exists$ common fixed point
    &\multicolumn{1}{|c|}{\NP-c~\cite{formenti2014fixed}}  
    &\cellcolor{myBlue}{\NP-c (Cor.~\ref{cor: reactantless_common_fix_point})}
    &\cellcolor{myBlue}{\NP-c (Thm.~\ref{teor: inhibitorless_common_fix_point})}
    \\%&\cellcolor{myGray}{\Pp} \\
    
    \hline
    sharing all fixed points 
    &\multicolumn{1}{|c|}{\coNP-c~\cite{formenti2014fixed}}  
    &\cellcolor{myBlue}{\coNP-c (Thm.~\ref{teor: reactantless_all_fix_point})}
    &\cellcolor{myBlue}{\coNP-c (Thm.~\ref{teor: inhibitorless_all_fix_point})}
    \\%&\cellcolor{myGray}{\Pp} \\ 

    \hhline{====}
    $\exists$ fixed point attractor 
    &\multicolumn{1}{|c|}{\NP-c~\cite{formenti2014fixed}}  
    &\cellcolor{myBlue}{\NP-c (Thm.~\ref{teor: reactantless_fix_point_attr})} 
    &\cellcolor{myBlue}{$\Pp$ (Cor.~\ref{cor: reactnatless_exists_fixed_att})}\\
    %&\multicolumn{2}{c}{\cellcolor{myBlue}\hyperlink{cor: reactnatless_exists_fixed_att}{$\Pp$}} \\
    
    \hline
    $\exists$ common fixed point attractor 
    &\multicolumn{1}{|c|}{\NP-c~\cite{formenti2014fixed}}  
    &\cellcolor{myBlue}{\NP-c (Cor.~\ref{cor: reactantless_common_fix_point_attr})} 
    &\cellcolor{myBlue}{\NP-c (Cor.~\ref{cor: inhibitorless_common_fix_point_attr})} 
    \\%&\cellcolor{myGray}{\Pp}\\
    
    \hline
    sharing all fixed points attractors 
    &\multicolumn{1}{|c|}{$\mathbf{\Pi}_2^{\Pp}$-c~\cite{formenti2014fixed}} 
    &\cellcolor{myBlue}{\coNP-c (Cor.~\ref{cor: reactantless_all_fix_point_attr})} 
    &\cellcolor{myBlue}{\coNP-c (Cor.~\ref{cor: inhibitorless_all_fix_point_attr})} 
    %&\cellcolor{myGray}{\Pp}
    \\ \hhline{====} 
    $\exists$ fixed point not attractor  
    & \multicolumn{1}{|c|}{\cellcolor{myBlue}{$\mathbf{\Sigma}_2^{\Pp}$-c} (Prop.~\ref{prop: fix_pointge_c})}
    &\cellcolor{myBlue}{\NP-c (Cor.~\ref{cor: reactantless_fix_pointge})}
    &\cellcolor{myBlue}{\NP-c (Cor.~\ref{cor: inhibitorless_fix_pointge})}
    \\%&\cellcolor{myGray}{\Pp}\\

    \hline
    %\color{red}
    $\exists$ common fixed point not attractor  
    & \multicolumn{1}{|c|}{\cellcolor{myBlue}{$\mathbf{\Sigma}_2^{\Pp}$-c (Cor.~\ref{cor: common_fix_pointge_c})}}
    &\cellcolor{myBlue}{\NP-c (Cor.~\ref{cor: reactantless_common_fix_pointge})}
    &\cellcolor{myBlue}{\NP-c (Cor.~\ref{cor: inhibitorless_common_fix_pointge})}
    \\%&\cellcolor{myGray}{\Pp}\\
    
    \hline
    %\color{red}
    sharing all fixed points not attractors  
    &\multicolumn{1}{|c|}{\cellcolor{myBlue}{\coNP-c (Cor.~\ref{cor: all_fix_pointge})}}
    & \cellcolor{myBlue}{\coNP-c (Cor.~\ref{cor: reactantless_all_fix_pointge})}
    &\cellcolor{myBlue}{\coNP-c (Cor.~\ref{cor: inhibitorless_all_fix_pointge})}
    \\%&\cellcolor{myGray}{\Pp}
        \hhline{====}
    $\res_{\sA} = \res_{\sB}$ 
    &\multicolumn{1}{|c|}{\cellcolor{myBlue}{\coNP-c (Thm.~\ref{teor: res_A=res_B})}}
    &\cellcolor{myBlue}{\Pp(Cor.~\ref{cor: reactantless_resA=resB})} 
    &\cellcolor{myBlue}{\Pp (Cor.~\ref{cor: inibithorless_resA=resB})}\\
    %&\multicolumn{2}{c}{\cellcolor{myBlue}\hyperlink{cor: inibithorless_resA=resB}{\Pp}}\\
    
    \hline
    res bijective 
    &\multicolumn{1}{|c|}{\coNP-c~\cite{formenti2014cycles}}  
    &\cellcolor{myBlue}{\Pp (Cor.~\ref{cor: res_A_bijective_reactantless})} 
    &\cellcolor{myBlue}{$\Pp$ (Cor.~\ref{cor: res_A_bijective_inhibitorless})}
    %&\multicolumn{2}{c}{\cellcolor{myBlue}\hyperlink{cor: res_A_bijective_inhibitorless}{$\Pp$}}
    \\ 
    
    \hline
    \end{tabular}}
    \caption{Computational complexity of the problems studied in this work for different classes of reaction systems. \NP-c, \coNP-c, $\mathbf{\Sigma}_2^{\Pp}$-c and $\mathbf{\Pi}_2^{\Pp}$-c are shorthands for \NP-complete, \coNP-complete, $\mathbf{\Sigma}_2^{\Pp}$-complete and $\mathbf{\Pi}_2^{\Pp}$-complete, respectively; $\RS(\infty,\infty)$, $\RS(0,\infty)$ and $\RS(\infty,0)$ denote unconstrained, reactantless and inhibitorless reaction systems, respectively (see Def.~\ref{def:classes}). Light-blue cells contain the results proved in this paper.}
    \label{tab: problems_complexity}
\end{table}

The main contributions of this study are summarized in Table~\ref{tab: problems_complexity} (light-blue cells). It is interesting to notice that, although the dynamical behaviors of the resource-bounded systems are less rich than those of unrestricted systems, the complexities of the considered problems are not necessarily reduced. For example, the complexity of deciding whether two reaction systems have a common fixed point is \NP-complete in the general case and it remains so in both the resource-bounded classes we consider. 

In contrast, deciding whether a given state is a fixed point attractor is \NP-complete in the unconstrained case, while it can be done in polynomial time in reactantless and inhibitorless systems; as a consequence, the complexity of other problems (e.g., deciding on the existence of a fixed point which is not an attractor) is reduced in the constrained classes compared to the general model. 
Furthermore, the complexity of a problem in reactantless reaction systems is not always the same as in inhibitorless systems: e.g., deciding on the existence of a fixed point attractor can be done in polynomial time in inhibitorless reaction systems, while it is an $\NP$-complete problem in reactantless systems. The complexities of different problems for different classes of reaction systems thus vary in a non-uniform way.

This paper is organized as follows. In Section~\ref{sec:basics}, we provide basic notions on reaction systems 
and introduce the notation we use throughout the paper. In Section~\ref{sec:logic} we report a description of reaction systems and their dynamics in terms of logical formulae which will be useful to prove most of our results. 
In Section~\ref{sec: T_fix_attr}, we study the problem of deciding whether a given state is a fixed point attractor in both constrained models.
In Section~\ref{sec: fix_point_0_infty} we study the complexities of fixed point problems in reactantless systems; in Section~\ref{sec: fix_point_infty_0} we study the same problems in inhibitorless systems. In Section~\ref{sec:resultFunction} we study the problem of deciding whether two reaction systems have the same result function both in the general model and in the constrained classes. In Section~\ref{sec: bij_res_A} we consider the problem of deciding whether the result function is bijective both in reactantless and inhibitorless systems.  Finally, in Section~\ref{sec:conclusions} we discuss our results and suggest future research directions.

\section{Basics Notions}\label{sec:basics}

In this section, we introduce the notation used in the paper and the main definitions concerning reaction systems.

Given a finite set $S$ of \emph{entities}, a \emph{reaction} $a$ over $S$ is a triple $( R_a,I_a,P_a)$ of subsets of $S$; the set $R_a$ is the set of \emph{reactants}, $I_a$ is the set of \emph{inhibitors}, and $P_a$ is the nonempty set of \emph{products}. 
We remark that in this paper the set of reactants and inhibitors of a reaction are allowed to be empty as in the original definition \cite{DBLP:conf/dlt/EhrenfeuchtR04}.
The set of all reactions over $S$ is denoted by $\text{rac}(S)$.
A \emph{reaction system} (RS) is a pair $\sA = (S,A)$ where $S$ is a finite set of entities, called the \emph{background set}, and $A \subseteq \text{rac}(S)$.

Given a \emph{state} $T \subseteq S$, a reaction $a$ is said to be \emph{enabled} in T when $R_a \subseteq  T$ and $I_a \cap T = \varnothing$.
The \emph{result function} $\res_a: 2^S \to 2^S$ of $a$, where $2^S$
denotes the power set of $S$, is defined as 
\begin{equation*}
    \res_a(T) \coloneqq
    \begin{cases}
        P_a & \text{if $a$ is enabled by $T$}\\
        \varnothing & \text{otherwise}.
    \end{cases}
\end{equation*}
The definition of $\res_a$ naturally extends to sets of reactions.
Indeed, given $T \subseteq S$ and $A\subseteq \text{rac}(S)$, define $\res_{A} (T)\coloneqq \bigcup_{a \in A} \res_a(T)$.
The result function $\res_{\sA}$ of a RS $\sA = (S, A)$ is defined to be equal to $\res_A$, i.e., the result function on the whole set of reactions. 


In this way, any RS $\sA = (S, A)$ induces a discrete dynamical system where the state set is $2^S$ and the next state function is $\res_{\sA}$. 

In this paper, we are interested in the dynamics of RS, i.e., the study of the successive states of the system under the action of the result function $\res_{\sA}$ starting from some initial set of entities.
The set of reactions of $\sA$ enabled in a state $T$ is denoted by $\en_{\sA}(T)$.
The \emph{orbit} or \emph{state sequence} of a given state $T$ of a RS $\sA$ is defined as the sequence of states obtained by subsequent iterations of $\res_{\sA}$ starting from $T$, namely the sequence $(T,\res_{\sA}(T),\res_{\sA}^2(T), \dots)$.
We remark that since $S$ is finite, for any state $T$ the sequence $(\res_{\sA}^n(T))_{n \in \mN}$ is ultimately periodic.%, i.e., for any $T \subseteq S$, there exist $h, p \in \mN$ such that for all $t \in \mN$ we have $\res_{\sA}^{h+pt}(T) = \res_{\sA}^{h+t}(T)$; here $h$ is the \emph{length of the transient}.

%A state $T \subseteq S$ is part of a \emph{cycle} if the sequence of states starting from $T$ is ultimately periodic with a transient of length 0; in this case, the least $p$ satisfying the previous equation is called the \emph{period} of the cycle. 

Given a RS $\sA$ with background set $S$, a \emph{fixed point} $T\subseteq S$ is a state such that $\res_{\sA}(T) = T$.
A \emph{fixed point attractor} is a fixed point $T$ for which there exists a state $U\ne T$ such that $\res_{\sA}(U) = T$.
A \emph{fixed point not attractor} is a fixed point that is not an attractor, i.e., not reachable from any state other than $T$ itself.

We now recall the classification of RS in terms of the number of resources employed
per reaction \cite{manzoni2014simple}.

\begin{defn}\label{def:classes}
    Let $i,r\in \mN$. The class $\RS(r,i)$ consists of all RS having at most $r$ reactants and $i$ inhibitors for reaction. 
    We also define the unbounded classes $\RS(\infty,i) = \bigcup_{r = 0}^\infty \RS(r,i)$, $\RS(r,\infty) = \bigcup_{i = 0}^\infty \RS(r,i)$, and $\RS(\infty, \infty) = \bigcup_{r= 0}^{\infty}\bigcup_{i = 0}^\infty \RS(r,i)$.
\end{defn}

In the following, we will call $\RS(0,\infty)$ the class of \emph{reactantless} systems, and $\RS(\infty,0)$ the class of \emph{inhibitorless} systems.

\begin{defn}[\cite{manzoni2014simple}]
    Let $\sA = (S, A)$ and $\sA' = (S', A)$, with $S \subseteq S'$, be two reaction systems, and let $k \in \mN$. 
    We say that $\sA'$ \emph{$k$-simulates} $\sA$ if and only if, for all $T \subseteq S$ and all $n \in \mN$, we have
    \begin{equation*}
        \res_{\sA}^n(T) = \res_{\sA'}(T)^{kn} \cap S.
    \end{equation*}
\end{defn}
\begin{defn}[\cite{manzoni2014simple}]
    Let $X$ and $Y$ be classes of reaction systems, and let $k \in \mN$.
    We define the binary relation $\preceq_k$ as follows: $X \preceq_k Y$ if and only if for all $\sA \in X$ there exists a reaction system in Y that $l$-simulates $\sA$ for some $l\le k$.
    We say that $X \preceq Y$ if and only if $X \preceq_k Y$ for some $k \in \mN$. 
    We write $X \approx_k Y$ if $X \preceq_k Y$ and $Y \preceq_k X$, and $X \approx Y$ for $X \preceq Y \land Y \preceq X$.
    Finally, the notation $X \prec Y$ is shorthand for $X \preceq Y \land Y \npreceq X$.
\end{defn}

The relation $\preceq$ is a preorder and the relation $\approx$ induces exactly five equivalence classes \cite[Theorem 30]{manzoni2014simple}:
\begin{equation}
    \label{eq: equiv_classes}
    \RS(0,0) \prec \RS(1,0) \prec \RS(\infty,0) \prec (0,\infty) \prec \RS(\infty, \infty).
\end{equation}


We remark that this classification does not include the number of products as a parameter because RS can always be assumed to be in \emph{singleton product normal form} \cite{brijder2011reaction}: any reaction $(R, I, \{p_1,\dots, p_m\})$ can be replaced by the set of reactions $(R, I, \{p_1\}),\dots,(R, I, \{p_m\})$ since they produce the same result.

The five equivalence classes in (\ref{eq: equiv_classes}) have a characterisation in terms of functions over the Boolean lattice $2^S$ \cite{manzoni2014simple}, see Table~\ref{tab: class&function}.
\begin{table}
    \centering
    \begin{tabular}{ll}
         \textbf{Class of RS} & \textbf{Subclass of $2^S\to 2^S$} \\
         \hline
         $\RS(\infty,\infty)$   & all \\
         $\RS(0,\infty)$        & antitone \\
         $\RS(\infty,0)$        & monotone \\
         $\RS(1,0)$             & additive \\
         $\RS(0,0)$             & constant
    \end{tabular}
    \caption{Functions computed by restricted classed of RS.}
    \label{tab: class&function}
\end{table}
Recall that a function $f : 2^S \to 2^S$ is \emph{antitone} if $X \subseteq Y$ implies $f(X) \supseteq f(Y)$, \emph{monotone} if $X \subseteq Y$ implies $f(X) \subseteq f(Y)$, \emph{additive} (or an \emph{}{upper-semilattice endomorphism}) if $f(X \cup Y ) = f(X) \cup f(Y)$ for all $X,Y \in 2^S$.
We say that the RS $\sA = (S, A)$ computes the function $f : 2^S \to 2^S$ if $\res_{\sA} = f$.

\section{Logical Description}\label{sec:logic}

In this section, we recall a logical description of RS and formulae related to their dynamics (see \cite{formenti2014fixed} for its first introduction).
This description is sufficient for proving membership in many complexity classes. For the background notions of logic and descriptive complexity, we refer the reader to the classical book of Neil Immerman \cite{immerman1999descriptive}.

%In the following, we will study several classes of problems over RS, and each of them can be characterised by a logical formula.
Each of the problems studied in this work can be characterised by a logical formula.
A RS $\sA = (S, A)$ with background set $S \subseteq \{0,\dots, n-1\}$ and $|A| \le n$ can be described by the vocabulary $(\sfS, \sfR_{\sA}, \sfI_{\sA}, \sfP_{\sA})$, where $\sfS$ is a unary relation symbol and $\sfR_{\sA}, \sfI_{\sA}, \sfP_{\sA}$ are binary relation symbols.
The intended meaning of the symbols is the following: the set of entities is $S = \{i : \sfS(i)\}$ and each reaction $a_j = (R_j , I_j , P_j ) \in A$ is described by the sets $R_j = \{i \in S : \sfR_{\sA}(i, j)\}$, $I_j = \{i \in S : \sfI_{\sA}(i, j)\}$, and $P_j = \{i \in S : \sfP_{\sA}(i, j)\}$.
We will also need some additional vocabularies: $(\sfS, \sfR_{\sA}, \sfI_{\sA}, \sfP_{\sA},\sfT)$, where $\sfT$ is a unary relation representing a subset of $S$, $(\sfS, \sfR_{\sA}, \sfI_{\sA}, \sfP_{\sA},\sfT_1,\sfT_2)$ with two additional unary relations representing sets, and $(\sfS, \sfR_{\sA}, \sfI_{\sA}, \sfP_{\sA}, \sfR_{\sB}, \sfI_{\sB}, \sfP_{\sB})$ denoting two RS's over the same background set.

The following formulae, introduced in~\cite{formenti2014fixed}, describe the basic properties of $\sA$. 
The first is true if a reaction $a_j$ is enabled in $T$:
\begin{equation*}
    \textsc{en}_{\sA}(j, \sfT) \equiv \forall i(\sfS(i) \Rightarrow (\sfR_{\sA}(i, j) \Rightarrow \sfT(j)) \land (\sfI_{\sA}(i, j) \Rightarrow \neg \sfT(j)))
\end{equation*}
and the following is verified if $\res_{\sA}(T_1) = T_2$ for $T_1, T_2 \subseteq S$:
\begin{equation*}
    \textsc{res}_{\sA}(\sfT_1,\sfT_2) \equiv \forall i(\sfS(i) \Rightarrow (\sfT_2(i) \Leftrightarrow \exists j(\textsc{en}_{\sA}(j, \sfT_1) \land \sfP_{\sA}(i, j))).
\end{equation*}
Notice that $\textsc{en}_{\sA}$ and $\textsc{res}_{\sA}$ are both first-order ($\mathsf{FO}$) formulae.
We define the bounded second-order quantifiers $(\forall X \subseteq Y) \varphi$ and $(\exists X \subseteq Y) \varphi$ as a short-hand for $\forall X (\forall i(X(i) \Rightarrow Y(i)) \Rightarrow \varphi)$ and $\forall X (\forall i(X(i) \Rightarrow Y(i)) \land  \varphi)$.
We will use the following formulae (given in~\cite{formenti2014fixed}) to describe our problems:
\begin{align*}
    \textsc{fix}_{\sA}(\sfT) &\equiv \textsc{res}_{\sA}(\sfT,\sfT)
    \\
    \textsc{reach}_{\sA}(\sfT) &\equiv (\exists \sfU \subseteq \sfS) (\textsc{res}_{\sA}(\sfU,\sfT) \land \neg\textsc{res}_{\sA}(\sfT,\sfU)) 
    \\
    \textsc{att}_{\sA}(\sfT) &\equiv \textsc{fix}_{\sA}(\sfT) \land \textsc{reach}_{\sA}(\sfT)  
    \\
    \textsc{fixge}_{\sA}(\sfT) &\equiv \textsc{fix}_{\sA}(\sfT) \land \neg\textsc{reach}_{\sA}(\sfT)  
    \\    
    \textsc{res\textunderscore eq}_{\sA,\sB} &\equiv (\forall \sfT \subseteq \sfS) (\forall \sfV\subseteq \sfS)(\textsc{res}_{\sA}(\sfT,\sfV) \Leftrightarrow \textsc{res}_{\sB}(\sfT,\sfV)).
\end{align*}

We say that a formula is $\SO\exists$, $\SO\forall$, or $\SO\forall\exists$ if it is logically equivalent to a formula in the required prenex normal form.

In Table~\ref{tab: problem_logic_class}, we give the logic formulae associated with the problems considered in this work. The first six formulae were already given in~\cite{formenti2014fixed}; we added the last four to describe the new problems studied in this paper.
\begin{table}[t]\resizebox{\textwidth}{!}{
    \centering
    \renewcommand{\arraystretch}{1.1}
    
    \begin{tabular}{|l|l|c|}%c|}
    \hline
    \textbf{Problem} & \textbf{Formula} & \textbf{Logic class} \\%& Complexity class  \\
     
     \hline
    $\exists$ fixed point & $(\exists \sfT \subseteq \sfS) \textsc{fix}_{\sA}(\sfT)$ &$\SO\exists$ \\%& \NP \\
    
    
    \hline
    $\exists$ common fixed point &$(\exists \sfT \subseteq \sfS) (\textsc{fix}_{\sA}(\sfT) \land \textsc{fix}_{\sB}(\sfT))$ &$\SO\exists$ \\%& \NP \\
    
    \hline
    sharing all fixed points  & $(\forall \sfT \subseteq \sfS) (\textsc{fix}_{\sA}(\sfT) \Leftrightarrow \textsc{fix}_{\sB}(\sfT))$ & $\SO\forall$  \\%& \coNP\\
    
    \hline
    A given state is a fixed point attractor  & $\textsc{att}_{\sA}(\sfT)$ & $\SO\exists$ \\%& \NP\\
    
    \hline
    $\exists$ fixed point attractor  & $(\exists \sfT \subseteq \sfS) \textsc{att}_{\sA}(\sfT)$ &  $\SO\exists$ \\%& \NP\\
    
    \hline
    $\exists$ common fixed point attractor  & $(\exists \sfT \subseteq \sfS) \textsc{att}_{\sA}(\sfT) \land \textsc{att}_{\sB}(\sfT)$ & $\SO\exists$ \\%& \NP\\
    
    \hline
    sharing all fixed points attractors  & $(\forall \sfT \subseteq \sfS) (\textsc{att}_{\sA}(\sfT) \Leftrightarrow \textsc{att}_{\sB}(\sfT))$ & $\SO\forall\exists$  \\%& $\Pi_2^P$\\ 
    
    %\hline
    %every fixed point is attractor (\textcolor{red}{togliere}) & $(\forall \sfT \subseteq \sfS) (\textsc{fix}(\sfT) \Rightarrow \textsc{att}(\sfT))$ & $\SO\forall\exists$ \\%&$\Pi_2^P$\\
    
    \hline
    $\exists$ fixed point not attractor  
    &  $(\exists \sfT \subseteq \sfS) \textsc{fixge}(\sfT)$ 
    & $\SO\exists\forall$ \\

    \hline
    $\exists$ common fixed point not attractor  
    & $(\exists \sfT \subseteq \sfS) (\textsc{fixge}_{\sA}(\sfT) \land \textsc{fixge}_{\sB}(\sfT))$ 
    &$\SO\exists\forall$ \\
    
    \hline
    sharing all fixed points not attractors  &
    $(\forall \sfT \subseteq \sfS) (\textsc{fixge}_{\sA}(\sfT) \Leftrightarrow \textsc{fixge}_{\sB}(\sfT))$ &
    $\SO\forall$ \\%&$\Pi_2^P$\\
    
    \hline
    $\res_{\sA} = \res_{\sB}$  & $\textsc{res\textunderscore eq}_{\sA,\sB}$ & $\SO\forall$ \\%& \coNP\\
    
    \hline
    \end{tabular}}
    \caption{Problems with the associated formula and logic class.}
    \label{tab: problem_logic_class}
\end{table}

Remark that existential second-order logic $\SO\exists$ characterizes $\NP$ (Faginâ€™s theorem~\cite{immerman1999descriptive});
universally quantified second-order logic $\SO\forall$ gives \coNP; second-order logic with one alternation of existential and universal quantifiers $\SO\exists\forall$ gives $\mathbf{\Sigma}_2^{\Pp}$, and, in a dual way, second-order logic with one alternation of universal and existential quantifiers $\SO\forall\exists$ gives $\mathbf{\Pi}_2^{\Pp}$~\cite{immerman1999descriptive}.

\section{A Given State is a Fixed Point Attractor}
\label{sec: T_fix_attr}
In this section, we study the problem of deciding whether a given state is a fixed point attractor.
The problem is \NP-complete for $\RS(\infty,\infty)$ \cite[Theorem 4]{formenti2014fixed}.
In contrast, we prove that for inhibitorless and reactantless RS, the problem is in \Pp;
%As a consequence, we show that some of the problems studied in Sections~\ref{sec: fix_point_0_infty} and \ref{sec: fix_point_infty_0} are actually in \NP-complete or \coNP-complete.
as a consequence, we show that for inhibitorless and reactantless RS some of the problems we will study are in \NP or \coNP instead of $\mathbf{\Sigma}_2^{\Pp}$ or $\mathbf{\Pi}_2^{\Pp}$, as shown in Table \ref{tab: problem_logic_class}.

Let $\sA= (S,A) \in \RS(\infty,0)$ and let $T$ a fixed point for $\res_{\sA}$.
We define 
\begin{align*}
    A_T &\coloneqq \{a\in A :\res_{\sA}(R_a)\subseteq T\},\\  % A_T &\coloneqq \{a\in A : P_a \subseteq T\},\\
    \tT &\coloneqq \bigcup_{a\in A_T} R_a,\\
    T_R &\coloneqq \bigcup_{a \in \en_{\sA}(T)} R_a.
\end{align*}
Note that since there are no inhibitors in the reactions of $\sA$, we have that $\en_{\sA}(T)=\{a \in A: R_a \subseteq T\}$.
\begin{rk}
    \label{rk: enables_A_T}
    If $T$ enables $a=(R_a,\varnothing, P_a)\in A$ then $a\in A_T$, because if $R_a\subseteq T$ then $\res_{\sA}(R_a)\subseteq \res_{\sA}(T)=T$. Hence, $T_R\subseteq \tT$. %$P_a \subseteq \res_{\sA}(R_a)\subseteq \res_{\sA}(T)=T$. Hence $T_R\subseteq \tT$.
\end{rk}
The state $T_R$ gives the same products as the associated state $T$, as shown in the following lemma.
\begin{lem}
    \label{lem: res_enables_T=res_T}
    Given $\sA= (S,A) \in \RS(\infty,0)$ and $T\subseteq S$, then
    \begin{equation*}
        \res_{\sA}(T)=\res_{\sA} (T_R).
    \end{equation*}
    \begin{proof}
        By monotonicity,
        \begin{equation*}
            \res_{\sA}(T_R) = \res_{\sA} \left(\bigcup_{a\in \en_{\sA}(T)} R_a\right) \subseteq \bigcup_{a\in A: R_a\subseteq T}  \res_{\sA}(R_a)\subseteq \res_{\sA}(T).
        \end{equation*}
        Furthermore, we have that
        \begin{equation*}
            \res_{\sA}(T_R) = \bigcup_{b \in A} \res_b (T_R) \supseteq \bigcup_{a\in A: R_a\subseteq T} \res_{a}(R_a) = \res_{\sA}(T).\qedhere
        \end{equation*}
    \end{proof}        
\end{lem}
The following technical proposition will be useful to classify the fixed points in two classes: those reachable from \emph{above} (i.e., from a superset) and those reachable from \emph{below} (i.e., from a subset).
\begin{prop}
    \label{prop: T_fixed_attractor}
    Let $\sA= (S,A) \in \RS(\infty,0)$ and let $T$ be a fixed point for $\res_{\sA}$. Then:
    \begin{enumerate}
        \item if $\tT \ne T$ then $T$ is a fixed point attractor reachable from $\tT$;
        \item if $\tT = T$ and $T$ is a fixed point attractor then $T$ is reachable from a state $T'$ such that either $T'\subsetneq T$ or $T'\supsetneq T$.%\footnote{enunciato e dimostrazione leggermente diversi dalla prima versione}
    \end{enumerate}
    \begin{proof} 1) By definition of $\tT$, we have
        %\begin{equation*}
            $\res_{\sA}(\tT) \subseteq \bigcup_{a\in A_T} \res_{\sA} (R_a) \subseteq T$.
        %\end{equation*}
        Moreover, by Remark~\ref{rk: enables_A_T}, $T_R\subseteq \tT$, and we deduce from Lemma~\ref{lem: res_enables_T=res_T} that $T = \res_{\sA}(T) = \res_{\sA}(T_R) \subseteq \res_{\sA}(\tT)$, implying the first point.
        
        2) Let $T''\ne T$ such that $\res_{\sA}(T'') = T$. Note that if $T''$ enables $a\in A$, i.e., $R_a\subseteq T''$, then $\res_{\sA}(R_a) \subseteq \res_{\sA}(T'') = T$, that is $a\in A_T$. Then
        %\begin{equation*}
            $T''_R \subseteq \tT = T$.
        %\end{equation*}
        We divide two cases:
        \begin{enumerate}[(i)]
            \item  If $T''_R \subsetneq T$, then let $T'\coloneqq T''_R$, and by Lemma~\ref{lem: res_enables_T=res_T} we obtain
            \begin{equation*}
                \res_{\sA}(T''_R) = \res_{\sA}(T'') = T.
            \end{equation*}
            \item  If $T''_R = T$, note that $T''\ne T$ and $T''\supseteq T''_R$. Let $T'\coloneqq T''$, then $T'\supsetneq T$ and $T$ is reachable from $T'$.\qedhere
        \end{enumerate}
    \end{proof}
\end{prop}

\begin{rk}
    \label{rk: T'subsetT_or_viceversa}
    If $\tT \ne T$ then either $\tT\subsetneq T$ or $\tT\nsubseteq T$.
    In the second case, $T\subsetneq T\cup \tT$ and
   % \begin{equation*}
       $ T = \res_{\sA} (T) \subseteq \res_{\sA} (T\cup \tT) \subseteq T \cup \res_{\sA}(\tT) = T$.
    %\end{equation*}
    Therefore, in either case, $T$ is reachable from a state $T'\subsetneq T$ or $T\subsetneq T'$.
\end{rk}

\begin{rk} 
    \label{rk: T-x_Tux}
    Let $T$ be a fixed point for $\res_{\sA}$, where $\sA= (S,A) \in \RS(\infty,0)$.
    \begin{itemize}
        \item If there exists $T'\subsetneq T$ such that $\res_{\sA}(T') = T$, then for all $x \in T\setminus T'$ 
        \begin{equation*}
            T = \res_{\sA}(T') \subseteq \res_{\sA}(T \setminus \{x\}) \subseteq \res_{\sA}(T) = T,
        \end{equation*}
        i.e., $T$ is reachable by $T\setminus \{x\}$.
        \item If there exists $T'\supsetneq T$ such that $\res_{\sA}(T') = T$, then for all $x \in T'\setminus T$ 
        \begin{equation*}
            T = \res_{\sA}(T) \subseteq \res_{\sA}(T \cup \{x\}) \subseteq \res_{\sA}(T') = T,
        \end{equation*}
        i.e., $T$ is reachable by $T\cup \{x\}$.
    \end{itemize}
\end{rk}
Finally, we prove that deciding if a given state of an inhibitorless RS is a fixed point attractor can be done in polynomial time.
\begin{cor}
    \label{cor: inibithorless_T_fixed_att}
    \hypertarget{cor: inibithorless_T_fixed_att}{}
    Given $\sA \in \RS(\infty,0)$, it is in $\Pp$ to decide whether a given state $T$ is a fixed point attractor.
    \begin{proof}
        It is possible to check in polynomial time if $T$ is a fixed point. 
        By Proposition~\ref{prop: T_fixed_attractor} and Remarks~\ref{rk: T'subsetT_or_viceversa} and~\ref{rk: T-x_Tux}, we then just need to check if there exists a state of the form $T\setminus \{x\}$ for some $x\in T$ or $T\cup \{x\}$ for some $x\notin T$ that is attracted by $T$. 
    \end{proof}
\end{cor}
Recall that if a function $f:2^S\to 2^S$ is antitone, then $f^2$ is monotone.
We arrive at the following result for the case of reactantless systems.
\begin{cor}
    \label{cor: reactnatless_T_fixed_att}
    \hypertarget{cor: reactnatless_T_fixed_att}{}
    Given $\sA \in \RS(0,\infty)$, it is in $\Pp$ to decide whether a given state $T$ is a fixed point attractor.
    \begin{proof}
        Since $\res_{\sA}$ is antitone, $\res_{\sA}^2$ is monotone. 
        If $T$ is a fixed point for $\res_{\sA}$, then $T$ is a fixed point also for $\res_{\sA}^2$. 
        Moreover, $T$ is an attractor for $\res_{\sA}$ if and only if $T$ is an attractor for $\res_{\sA}^2$.
        If there exists $T'\ne T$ such that $\res_{\sA}(T') = T$, then $\res_{\sA}^2(T') = T$. 
        Viceversa, let $T'\ne T$ be such that $\res_{\sA}^2(T') = T$. If $\res_{\sA}(T') = T$ then $T$ is reachble from $T'$, otherwise $T$ is reachble from $\res_{\sA}(T')$. 
        By Corollary~\ref{cor: inibithorless_T_fixed_att}, deciding if $T$ is an attractor for $\res_{\sA}^2$ is in $\Pp$, so the statment follows.
    \end{proof}
\end{cor}

A first consequence of Corollary~\ref{cor: reactnatless_T_fixed_att} is that the problem of deciding whether two reactantless or inhibitorless RS share all their fixed points attractors is in \coNP.
In contrast, in the general case the problem is $\mathbf{\Pi}_2^{\Pp}$-complete \cite[Theorem 5]{formenti2014fixed}.
\begin{cor}
    \label{cor: reactantless_inhibitorless_all_fix_point_attr_coNP}
    Given $\sA, \sB \in \RS(0,\infty)$ or $\sA, \sB \in \RS(\infty,0)$ with a common background set $S$, deciding whether $\sA$ and $\sB$ share all their fixed point attractors is in \coNP.
    \begin{proof} 
        The problem is in \coNP, since there exists a non-deterministic algorithm guessing a state $T$ and checking in polynomial time (Corollary~\ref{cor: reactnatless_T_fixed_att} and Corollary~\ref{cor: inibithorless_T_fixed_att}) whether $T$ is a fixed point attractor of $\sA$ and $T$ is not a fixed point attractor of $\sB$, or vice-versa.
    \end{proof}
\end{cor}

In a similar manner, we can deduce that also the following problems are in \NP instead of $\mathbf{\Sigma}_2^{\Pp}$ (see Table \ref{tab: problem_logic_class}).

\begin{cor}\label{cor: reactantless_inhibitorless_fix_pointge_NP}
    \hypertarget{cor: reactantless_inhibitorless_fix_pointge_c}{}
    Given $\sA \in \RS(0,\infty)$ or $\sA \in \RS(\infty,0)$, deciding whether $\sA$ has a fixed point which is not an attractor is in \NP.
\end{cor}

\begin{cor}\label{cor: reactantless_inhibitorless_common_fix_pointge_NP}
    \hypertarget{cor: reactantless_inhibitorless_common_fix_pointge_c}{}
    Given $\sA, \sB \in \RS(0,\infty)$ or $\sA, \sB \in \RS(\infty,0)$ with a common background set $S$, deciding whether $\sA$ and $\sB$ have a common fixed point which is not an attractor is in \NP.
\end{cor}

%Besides being $\NP$-complete in the case of reactantless and inhibitorless RS, 

\section{Fixed Points for Reactantless RS}
\label{sec: fix_point_0_infty}

In this section, we prove \NP-hardeness and \coNP-hardness for problems of fixed points in the class of reactantless RS. 

The problem of deciding if there exists a fixed point is \NP-complete for $\RS(\infty,\infty)$ \cite[Theorem 2]{formenti2014fixed}; the following theorem shows that it remains difficult also in $\RS(0,\infty)$.
\begin{comment}
The same problem is proved to be in $\Pp$ for reactant and inhibitor-minimal reaction systems (i.e., for all reaction $a=(R_a,I_a,P_a)$, $|R_a|=|I_a|=1$), see \cite[Corollary 3.9]{DBLP:journals/tcs/Azimi17}.
\end{comment}

\begin{teor}
    \label{teor: reactantless_exist_fix_point}
    \hypertarget{teor: reactantless_exist_fix_point}{}
    Given $\sA=(S,A) \in \RS(0,\infty)$, it is \NP-complete to decide if $\sA$ has a fixed point.
    \begin{proof}
        The problem is in $\NP$ (see Table~\ref{tab: problem_logic_class}). 
        In order to show \NP-hardness, we reduce \textsc{sat} \cite{papadimitriou1994computational} to this problem. Given a Boolean formula $\varphi = \varphi_1 \land \cdots \land \varphi_m$ in CNF over the variables $V = \{x_1,\dots,x_n\}$, let $\nV\coloneqq\{\overline{x_j}: x_j \in V\}$.
        We define $\posV(\varphi_r) \subseteq V$ the set of variables that occurred non-negated in $\varphi_r$ and $\overline{\negV}(\varphi_r) \subseteq \nV$ the set of variables that occurred negated in $\varphi_r$. 
        Define $\sA$ a RS with background set $S\coloneqq V \cup \nV \cup \{\spadesuit\} \cup \{\clubsuit\}$ (where $\spadesuit$ and $\clubsuit$ represent entities which do not belong to $ V \cup \nV$) and the reactions 
        \begin{align}
            \label{eq: n-neg_pos_spade}
            &(\varnothing, \overline{\negV}(\varphi_j) \cup \posV(\varphi_j), \{\spadesuit\}) & \text{ for } &1\le j \le m\\
            \label{eq: 0,x_i,neg_x_i}
            \overline{a_i}\coloneqq&(\varnothing,\{x_i\}, \{\overline{x_i}\}) & \text{ for } &1\le i \le n\\
            \label{eq: 0,neg_x_i,x_i}
            a_i\coloneqq&(\varnothing,\{\overline{x_i}\}, \{x_i\}) & \text{ for } &1\le i \le n\\
            \label{eq: club,club,spade}
            &(\varnothing,\{\clubsuit\},\{\clubsuit,\spadesuit\})\\
            \label{eq: spade,club}
            &(\varnothing,\{\spadesuit\},\{\clubsuit\}).
        \end{align}
        Given a state $T\subseteq S$, let $X = T \cap V$ and $\overline{X} = T \cap \nV$. 
        When $x_j \in X \Leftrightarrow \overline{x_j} \notin \overline{X}$ for every $j$, then $X\cup \overline{X}$ encodes an assignment of $\varphi$ in which the variables having true value are those in $X$ and the variables having false value are those in $\overline{X}$. 
        In this case we say that $T$ is a \textit{well-formed} state of $\sA$ and the reactions of type (\ref{eq: 0,x_i,neg_x_i}),(\ref{eq: 0,neg_x_i,x_i}) preserves $X \cup \overline{X}$, i.e., $X \cup \overline{X} \subseteq \res_{\sA}(T)$. 
        Instead, if $T$ is not a well-formed state then we distinguish two cases:
        \begin{itemize}
            \item if $\exists x_i,\overline{x_i} \in X \cup \overline{X}$ then $x_i,\overline{x_i} \notin \res_{\sA}(T)$, since either $a_i$ or $\overline{a_i}$ is enable;
             \item if $\exists x_i,\overline{x_i} \notin X \cup \overline{X}$ then $x_i,\overline{x_i} \in \res_{\sA}(T)$, since both $a_i$ and $\overline{a_i}$ are enable.
        \end{itemize}
        In both cases $T\ne \res_{\sA}(T)$; so if $T$ is a fixed point, $T$ is a well-formed state. 
        For well-formed states, we can also give an interpretation of the reactions of type (\ref{eq: n-neg_pos_spade}): they evaluate each disjunctive clause (which is not satisfied if and only if no positive variables are set to true and no negative ones to false) and generate $\spadesuit$ when $\varphi$ itself is not satisfied by $X \cup \overline{X}$. 
        
        Consider the dynamic of the reaction system restricted to a well-formed state $Y\subseteq V \cup \nV$. If $Y$ does not satisfy $\varphi$ then there are no fixed points because of the following (the arrows represent function $\res_{\sA}$):
        \begin{comment}
        \begin{align*}
            Y                   &\longmapsto Y \cup \{\clubsuit,\spadesuit\} \\
            Y \cup\{\clubsuit\} &\longmapsto Y \cup\{\clubsuit,\spadesuit\}\\
            Y \cup\{\spadesuit\}&\longmapsto Y \cup\{\clubsuit,\spadesuit\} \\
            Y \cup\{\clubsuit,\spadesuit\} & \longmapsto Y \cup \{\spadesuit\},
        \end{align*}
        \end{comment}        
        \begin{center}
            \begin{tikzcd}[row sep=tiny]
             Y \arrow[dr]    &   &\\
                                        & Y \cup \{\clubsuit,\spadesuit\} \arrow[r, bend left] &Y \cup \{\spadesuit\} \arrow[l, bend left] \\
              Y \cup\{\clubsuit\}  \arrow[ru] & &
        \end{tikzcd}
        \end{center}
        Instead, if $Y$ satisfies $\varphi$, then $Y \cup \{\clubsuit\}$ is a fixed point since:
        %\begin{align*}
        %    Y                   &\longmapsto Y \cup \{\clubsuit,\spadesuit\} \\
        %    Y \cup\{\clubsuit\} &\longmapsto Y \cup \{\clubsuit\}\\
        %    Y \cup\{\spadesuit\}&\longmapsto Y \cup \{\clubsuit,\spadesuit\} \\
        %    Y \cup\{\clubsuit,\spadesuit\} & \longmapsto Y.
        %\end{align*}
        \begin{center}
            \begin{tikzcd}[row sep=tiny]
              Y \cup\{\spadesuit\}  \arrow[r] & Y \cup\{\clubsuit,\spadesuit\} \arrow[r, bend left] & Y \arrow[l, bend left] &Y \cup\{\clubsuit\}\arrow[loop right]&\quad
        \end{tikzcd}
        \end{center}
        In particular, $\sA$ has a fixed point if and only $\varphi$ is satisfiable. 
        The mapping $\varphi \mapsto \sA$ is computable in polynomial time, hence deciding the existence of fixed points for reactantless RS is \NP-hard.
    \end{proof}
\end{teor}

 A closer look at the proof of Theorem~\ref{teor: reactantless_exist_fix_point} reveals that the fixed points in the reduction are not attractors; together with Corollary~\ref{cor: reactantless_inhibitorless_fix_pointge_NP}, we obtain the following.

\begin{cor}
    \label{cor: reactantless_fix_pointge}
    %\color{red} 
    Given $\sA=(S,A) \in \RS(0,\infty)$, it is \NP-complete to decide if $\sA$ has a fixed point which is not an attractor.
    %\begin{proof}
    %    The \NP-hardness follows from the same construction in the proof of Theorem \ref{teor: reactantless_exist_fix_point}.
    %\end{proof}
\end{cor}

As an immediate consequence of Theorem~\ref{teor: reactantless_exist_fix_point} and Corollary~\ref{cor: reactantless_fix_pointge} we obtain that deciding if there exists a state that is a common fixed point of two reactantless RS remains \NP-complete, as well as deciding whether two systems share a fixed point which is not an attractor.

\begin{cor}
    \label{cor: reactantless_common_fix_point}
    \hypertarget{cor: reactantless_common_fix_point}{}
    Given $\sA, \sB \in \RS(0,\infty)$ with a common background set $S$, it is \NP-complete to decide whether $\sA$ and $\sB$ have a common fixed point.
    \begin{proof}
        The problem is in $\NP$ (see Table~\ref{tab: problem_logic_class}). 
        By Theorem~\ref{teor: reactantless_exist_fix_point}, when $\sA = \sB$ the problem is \NP-complete.
    \end{proof}
\end{cor}

\begin{cor}
    \label{cor: reactantless_common_fix_pointge}
    %\color{red} 
    Given $\sA, \sB \in \RS(0,\infty)$ with a common background set $S$, it is \NP-complete to decide whether $\sA$ and $\sB$ have a common fixed point which is not an attractor.
    \begin{proof}
       The problem is in \NP by Corollary~\ref{cor: reactantless_inhibitorless_common_fix_pointge_NP}; by Corollary~\ref{cor: reactantless_fix_pointge}, when $\sA = \sB$ the problem is \NP-complete.
    \end{proof}
\end{cor}

With a small adaptation of the proof of Theorem~\ref{teor: reactantless_exist_fix_point}, deciding if a fixed point attractor exists is still an \NP-complete problem. 
The \NP-completeness for $\RS(\infty,\infty)$ is proved in \cite[Corollary 3]{formenti2014fixed}; the following theorem proves it for the case of reactantless systems.

\begin{teor}
    \label{teor: reactantless_fix_point_attr}
    \hypertarget{teor: reactantless_fix_point_attr}{}
    Given $\sA=(S,A) \in \RS(0,\infty)$, it is \NP-complete to decide if $\sA$ has a fixed point attractor.
    \begin{proof}
        The problem is in $\NP$, as highlighted in Table~\ref{tab: problem_logic_class}. 
        %since $(\exists T \subseteq S) \textsc{att}_{\sA}(T)$ is a SO$\exists$ formula.
        In order to show \NP-hardness, we reduce \textsc{sat} \cite{papadimitriou1994computational} to this problem. Given a Boolean formula $\varphi = \varphi_1 \land \cdots \land \varphi_m$ in CNF, we construct the same reaction system $\sA$ of Theorem~\ref{teor: reactantless_exist_fix_point} and we substitute reaction (\ref{eq: club,club,spade}) with $(\varnothing, \{\clubsuit\},\{\clubsuit\})$. In this way, if $Y\subseteq V \cup \nV$ is a well-formed state satisfying $\varphi$ we have:
        %\begin{align*}
        %    Y                   &\longmapsto Y \cup \{\clubsuit\} \\
        %    Y \cup\{\clubsuit\} &\longmapsto Y \cup\{\clubsuit\}\\
        %    Y \cup\{\spadesuit\}&\longmapsto Y \cup\{\clubsuit\} \\
        %    Y \cup\{\clubsuit,\spadesuit\} & \longmapsto Y,
        %\end{align*}
        \begin{center}
            \begin{tikzcd}[row sep=tiny]
            Y \cup\{\clubsuit,\spadesuit\} \arrow[r]  &  Y \arrow[rd] &\\
                                        &  &Y \cup\{\clubsuit\}\arrow[loop right] \\
              &Y \cup\{\spadesuit\}  \arrow[ru] & 
            \end{tikzcd}
        \end{center}
        which means that $Y\cup \{\clubsuit\}$ is a fixed point reachable from $Y$ or $Y\cup \{\spadesuit\}$. 
        In the other cases (either a well-formed state not satisfying $\varphi$ or a not well-formed state), $T\subseteq S$ is never a fixed point, as in the proof of Theorem~\ref{teor: reactantless_exist_fix_point}. 
        Since the mapping  $\varphi \mapsto \sA$ is computable in polynomial time, deciding the existence of a fixed points attractor for reactantless RS is \NP-hard.
    \end{proof}
\end{teor}

\begin{cor}
    \label{cor: reactantless_common_fix_point_attr}
    \hypertarget{cor: reactantless_common_fix_point_attr}{}
    Given $\sA, \sB \in \RS(0,\infty)$ with a common background set $S$, it is \NP-complete to decide whether $\sA$ and $\sB$ have a common fixed point attractor.
    \begin{proof}
        The problem is in $\NP$ (see Table~\ref{tab: problem_logic_class}).
        By Theorem~\ref{teor: reactantless_fix_point_attr}, when $\sA = \sB$ the problem is \NP-hard.
    \end{proof}
\end{cor}

The last problem of this section is deciding if two RS share all their fixed points. 
The problem is \coNP-complete for $\RS(\infty,\infty)$ \cite[Theorem 3]{formenti2014fixed}, and this is true also for reactantless RS, as proved in the following theorem.

\begin{teor}
    \label{teor: reactantless_all_fix_point}
    \hypertarget{teor: reactantless_all_fix_point}{}
    Given $\sA, \sB \in \RS(0,\infty)$ with a common background set $S$, it is \coNP-complete to decide whether $\sA$ and $\sB$ share all their fixed points.
    \begin{proof}
        The problem lies in $\coNP$ (see Table~\ref{tab: problem_logic_class}). %, since $(\forall T \subseteq S) (\textsc{fix}_{\sA}(T) \Leftrightarrow \textsc{fix}_{\sB}(T))$ is a SO$\forall$ formula. 
        In order to show \coNP-completeness, we reduce \textsc{validity} \cite{papadimitriou1994computational} to this problem. Given a Boolean formula $\varphi = \varphi_1 \lor \cdots \lor \varphi_m$ in DNF over the variables $V = \{x_1,\dots,x_n\}$, let $\nV\coloneqq\{\overline{x_j}: x_j \in V\}$.
        We define $\overline{\posV}(\varphi_r) \subseteq \overline{V}$ the set of variables that occured non-negated in $\varphi_r$ and $\negV(\varphi_r) \subseteq V$ the set of variables that occured negated in $\varphi_r$.
        Define a RS $\sA$ with background set $S\coloneqq V \cup \nV \cup \{\heartsuit\} \cup \{\clubsuit\}$ (where $\heartsuit$ and $\clubsuit$ are two extra entities) and the reactions:
        \begin{align}
            \label{eq: neg_n-pos_heart}
            &(\varnothing, \negV(\varphi_j) \cup \overline{\posV}(\varphi_j) \cup \{\clubsuit\}, \{\heartsuit\}) & \text{ for } &1\le j \le m\\
            &(\varnothing, \{x_i\}, \{\overline{x_i}\}) & \text{ for } &1\le i \le n\\
            &(\varnothing,\{\overline{x_i}\}, \{x_i\}) & \text{ for } &1\le i \le n\\
            \label{eq: heart,heart}
            &(\varnothing,\{\heartsuit\},\{\heartsuit,\clubsuit\}).
        \end{align}
        As in the proof of Theorem~\ref{teor: reactantless_exist_fix_point}, if $T$ is not a well-formed state then $T$ is not a fixed point. 
        %Furthermore, if $\heartsuit \notin T$ then $\heartsuit \in \res_{\sA}(T)$, by reaction (\ref{eq: heart,heart}). 
        %Thus if $T$ is a fixed point then $\heartsuit \in T$ and $T$ is well-formed. 
        %Now, consider a well-formed state of the form $Y \cup \{\heartsuit\}$, where $Y \subseteq V \cup \nV$.
        Reactions of type (\ref{eq: neg_n-pos_heart}) evaluate each conjunctive clause (which is satisfied if and only if no positive variables are set to false and no negative ones to true) and generate $\heartsuit$ when $\varphi$ itself is satisfied by $T \cap (V \cup \nV)$.
        Consider the dynamic of the reaction system restricted to a well-formed state $Y \subseteq V \cup \nV$. 
        If $Y$ does not satisfy $\varphi$ there are no fixed points since:
        \begin{center}
            \begin{tikzcd}[row sep=tiny]
              Y \cup\{\heartsuit\}  \arrow[r] & Y \arrow[r, bend left] & Y \cup\{\heartsuit,\clubsuit\}\arrow[l, bend left] &Y \cup\{\clubsuit\}\arrow[l]
        \end{tikzcd}
        \end{center}
        where the arrow represent the function $\res_{\sA}$.
        Instead, if $Y$ satisfies $\varphi$, $Y \cup \{\heartsuit\}$ is a fixed point since:
        \begin{center}
            \begin{tikzcd}[row sep=tiny]
              Y \cup\{\heartsuit\}  \arrow[loop left] & Y \arrow[r, bend left] & Y \cup\{\heartsuit,\clubsuit\}\arrow[l, bend left] &Y \cup\{\clubsuit\}.\arrow[l]
            \end{tikzcd}
        \end{center}
        Finally, the fixed points of $\sA$ are the well-formed state $Y \cup \{\heartsuit\}$ such that $Y \vDash \varphi$.
        Now, let $\sB$ be defined by the following reactions:
        \begin{align*}
            &(\varnothing, \{x_i\}, \{\overline{x_i}\}) & \text{ for } &1\le i \le n\\
            &(\varnothing,\{\overline{x_i}\}, \{x_i\}) & \text{ for } &1\le i \le n\\
            &(\varnothing,\{\clubsuit\},\{\heartsuit\})\\
            &(\varnothing,\{\heartsuit\},\{\heartsuit,\clubsuit\}).
        \end{align*}
        In a similar way as above, the fixed points of $\sB$ are the state $Y \cup \{\heartsuit\}$ where $Y\subseteq V\cup \nV$ is well-formed.
        We can conclude that $\sA$ and $\sB$ share all fixed points exactly when all assignments satisfy $\varphi$, i.e., $\varphi$ is a tautology. 
        Since the mapping $\varphi \mapsto (\sA,\sB)$ is computable in polynomial time, the problem is \coNP-hard.
    \end{proof}
\end{teor}

Note that in the proof of Theorem~\ref{teor: reactantless_all_fix_point}, the fixed points of $\sA$ and $\sB$ are not attractors: this implies the following result.
\begin{cor}
    \label{cor: reactantless_all_fix_pointge}
    \hypertarget{cor: reactantless_all_fix_pointge}{}
    %\color{red}
    Given $\sA, \sB \in \RS(0,\infty)$ with a common background set $S$, it is \coNP-complete to decide whether $\sA$ and $\sB$ share all their fixed points which are not attractors. 
\end{cor}
Since the problem is \coNP-complete for $\RS(0,\infty)$, we have that it is also \coNP-complete for $\RS(\infty,\infty)$, as stated by the following corollary.
\begin{cor}
    \label{cor: all_fix_pointge}
    \hypertarget{cor: all_fix_pointge}{}
    %\color{red}
    Given $\sA, \sB \in \RS(\infty,\infty)$ with a common background set $S$, it is \coNP-complete to decide whether $\sA$ and $\sB$ share all their fixed points which are not attractors.
    %\begin{proof}
    %    The problem is \coNP-hard already in the case $\RS(0,\infty)$, and lies in $\coNP$ by Table \ref{tab: problem_logic_class}.
    %\end{proof}
\end{cor}

With a small modification in the proof of Theorem~\ref{teor: reactantless_all_fix_point}, we obtain that the problem is still \coNP-complete if we consider fixed points attractors.

\begin{cor}
    \label{cor: reactantless_all_fix_point_attr}
    Given $\sA, \sB \in \RS(0,\infty)$ with a common background set $S$, it is \coNP-complete to decide whether $\sA$ and $\sB$ share all their fixed point attractors.
    \begin{proof}
        The problem is in \coNP by Corollary~\ref{cor: reactantless_inhibitorless_all_fix_point_attr_coNP}.
        In order to show \coNP-hardness, we follow the proof of Theorem~\ref{teor: reactantless_all_fix_point} and we restrict the background set to $S\coloneqq V \cup \nV \cup \{\heartsuit\} $ (i.e., delete $\clubsuit$ from every reaction of $\sA$ and $\sB$) to ensure that all fixed points of $\sB$ and $\sA$ are attractors.
        Indeed, $\res_{\sB}(Y) = Y \cup \{\heartsuit\} = \res_{\sB}( Y \cup \{\heartsuit\})$ for every well-formed states $Y\subseteq V \cup \nV$ and $\res_{\sA}(Y) = Y \cup \{\heartsuit\} = \res_{\sA}( Y \cup \{\heartsuit\})$ for every well-formed states $Y\subseteq V \cup \nV$ satisfying $\varphi$.
    \end{proof}
\end{cor}

\section{Fixed Points for Inhibitorless RS}
\label{sec: fix_point_infty_0}

In this section, we prove \NP-hardeness and \coNP-hardness for problems of fixed points in the class of inhibitorless RS.

The problem of deciding the existence of a fixed point is entirely trivial for $\RS(\infty,0)$ thanks to the Knaster-Tarski theorem, as first remarked in \cite{manzoni2014simple}.
On the contrary, the following theorem shows that it is \NP-complete to decide whether two inhibitorless RS have a common fixed point.

\begin{teor}
    \label{teor: inhibitorless_common_fix_point}
    \hypertarget{teor: inhibitorless_common_fix_point}{}
    Given $\sA, \sB \in \RS(\infty,0)$ with a common background set $S$, it is \NP-complete to decide whether $\sA$ and $\sB$ have a common fixed point.
    \begin{proof}
        The problem is in $\NP$ (see Table~\ref{tab: problem_logic_class}). 
        In order to show \NP-hardness, we reduce \textsc{sat} \cite{papadimitriou1994computational} to this problem. Given a Boolean formula $\varphi = \varphi_1 \land \cdots \land \varphi_m$ in CNF over the variables $V = \{x_1,\dots,x_n\}$, let $\nV\coloneqq\{\overline{x_j}: x_j \in V\}$ and let $\heartsuit_S \coloneqq \{\heartsuit_i: 1\le i\le n\}$ be a set of extra entities that are not contained in $V\cup \nV$.
        We define $\overline{\posV}(\varphi_r) \subseteq \overline{V}$ as the set of variables that occurred non-negated in $\varphi_r$ and $\negV(\varphi_r) \subseteq V$ the set of variables that occurred negated in $\varphi_r$.
        Define a RS $\sA$ with background set $S\coloneqq V \cup \nV \cup \heartsuit_S \cup \{\spadesuit\}$ (with $\spadesuit\not\in V \cup \nV \cup \heartsuit_S $) and the reactions
        \begin{align}
            \label{eq: neg_n-pos-heart_spade}
            &(\negV(\varphi_j) \cup \overline{\posV}(\varphi_j) \cup \heartsuit_S, \varnothing, \{\spadesuit\}) & \text{ for } &1\le j \le m\\
            \label{eq: x_heart_S,,heart_i_x}
            &(\{x_i\} \cup \heartsuit_S,\varnothing, \{\heartsuit_i,x_i\}) & \text{ for } &1\le i \le n\\
            \label{eq: eq: negx_heart_S,,heart_i_negx}
            &(\{\overline{x_i}\} \cup \heartsuit_S,\varnothing, \{\heartsuit_i,\overline{x_i}\}) & \text{ for } &1\le i \le n\\
            \label{eq: eq: x_negx,,spade}
            &( \{x_i,\overline{x_i}\} \cup \heartsuit_S,\varnothing, \{\spadesuit\}) & \text{ for } &1\le i \le n\\
            \label{eq: spade,,spade}
            &(\{\spadesuit\}\cup \heartsuit_S,\varnothing,\{\spadesuit\}).
        \end{align}
        Note that for all $Y\subseteq  V \cup \nV$, and for every $Z_{\heartsuit} \subsetneq \heartsuit_{S}$ it holds
        \begin{equation}
            \label{eq: res_(Y + Z_heart)=empty}
            \res_{\sA}(Y \cup Z_{\heartsuit}) = \res_{\sA}(Y \cup Z_{\heartsuit}\cup \{\spadesuit\}) = \varnothing = \res_{\sA}(\varnothing)
        \end{equation}
        because no reaction is enabled. Thus we consider states $T\subseteq S$ such that $\heartsuit_{S} \subseteq T$.
        For every $Y \subseteq V \cup \nV$, define $\heartsuit_Y\coloneqq \{\heartsuit_i: x_i \in Y \lor \overline{x_i}\in Y\} \subseteq \heartsuit_S$. 
        Note that $\heartsuit_Y = \res_{\sA}(Y\cup \heartsuit_S) \cap \heartsuit_S = \res_{\sA}(Y\cup \heartsuit_S\cup \{\spadesuit\})\cap \heartsuit_S$, so when $\heartsuit_Y \subsetneq \heartsuit_S$, the states $Y\cup \heartsuit_S$ and $Y\cup \heartsuit_S\cup \{\spadesuit\}$ reach $\varnothing$ in two steps. 
        In particular, if $T\ne \varnothing$ is a fixed point then it must be of the form $T=Y\cup \heartsuit_Y$ or $T=Y\cup \heartsuit_Y \cup \{\spadesuit\}$ with $Y \subseteq V \cup \nV$ and $\heartsuit_Y = \heartsuit_S$.
        We divide two cases:
        \begin{enumerate}[(i)]
            \item $Y$ is not a well-formed state. 
            Since $\heartsuit_{Y} = \heartsuit_{S}$, there exist $x_i,\overline{x_i}\in Y$, so $\spadesuit$ is generated by one of the reactions of type (\ref{eq: eq: x_negx,,spade}). 
            We obtain that $Y\cup \heartsuit_S \cup \{\spadesuit\}$ is a fixed point reachable from $Y\cup \heartsuit_S$.
            \item $Y$ is a well-formed state. 
            If $Y\vDash \varphi$ then no reaction of type (\ref{eq: neg_n-pos-heart_spade}) is enabled, so $Y \cup \heartsuit_S$ is a fixed point (not reachable from any other state). 
            Also in this case, $Y \cup \heartsuit_S\cup \{\spadesuit\}$ is a fixed point, thanks to reaction (\ref{eq: spade,,spade}).
            On the other hand, if $Y\nvDash \varphi$ then $Y \cup \heartsuit_S\cup \{\spadesuit\}$ is a fixed point reachable from $Y \cup \heartsuit_S$.
        \end{enumerate}
        Now, consider the RS $\sB$ given by the following reactions:
        \begin{align}
            &(\varnothing, \varnothing, \heartsuit_S) \\
            &(\{x_i\} ,\varnothing, \{x_i\}) & \text{ for } &1\le i \le n\\
            &(\{\overline{x_i}\},\varnothing, \{\overline{x_i}\})& \text{ for } &1\le i \le n.
        \end{align}
        The fixed points of $\sB$ are the states $Y \cup \heartsuit_S$ for all $Y\subseteq V \cup \nV$. 
        We can conclude that $\sA$ and $\sB$ share a fixed point exactly when there exists an assignment satisfying $\varphi$, i.e.,$\varphi$ is satisfiable. 
        Since the mapping $\varphi \mapsto (\sA,\sB)$ is computable in polynomial time, the problem is \NP-hard.
    \end{proof}
\end{teor}

We observe that the RS $\sA$ in the proof of Theorem~\ref{teor: inhibitorless_common_fix_point} has a fixed point which is not an attractor if and only if $\varphi$ is satisfiable: together with Corollary~\ref{cor: reactantless_inhibitorless_fix_pointge_NP}, we thus obtain the following result.

\begin{cor}
    \label{cor: inhibitorless_fix_pointge}
    %\color{red}
    Given $\sA=(S,A)\in\RS(\infty,0)$, it is \NP-complete to decide whether $\sA$ has a fixed point which is not an attractor.
    %\begin{proof}
    %    If we consider the RS $\sA$ of Theorem \ref{teor: inhibitorless_common_fix_point}, we get that the problem is \NP-hard.
    %\end{proof}
\end{cor}
As an immediate consequence of Corollaries~\ref{cor: reactantless_inhibitorless_common_fix_pointge_NP} and~\ref{cor: inhibitorless_fix_pointge}, we also obtain the following.
\begin{cor}
    \label{cor: inhibitorless_common_fix_pointge}
    %\color{red}
    Given $\sA,\sB\in\RS(\infty,0)$, it is \NP-complete to decide whether $\sA$ and $\sB$ have a common fixed point which is not an attractor.
    %\begin{proof}
    %    The problem is \NP-hard in the case $\sA = \sB$ thanks to previous corollary.
    %\end{proof}
\end{cor}

%\todo[inline]{Risultati per R($\infty,\infty$) spostati qui}
Deciding the existence of (common) fixed points that are not attractors is thus \NP-complete for both reactantless (see Corollaries \ref{cor: reactantless_fix_pointge} and \ref{cor: reactantless_common_fix_pointge}) and inhibitorless RS. 
On the contrary, we can show that the problem is $\mathbf{\Sigma}_2^{\Pp}$-complete for a general $\sA \in \RS(\infty,\infty)$.

\begin{prop}\label{prop: fix_pointge_c}
\hypertarget{prop: fix_pointge_c}{}
    Given $\sA \in \RS(\infty,\infty)$, it is $\mathbf{\Sigma}_2^{\Pp}$-complete to decide whether $\sA$ has a fixed point which is not an attractor.
    \begin{proof}
        The problem is in $\mathbf{\Sigma}_2^{\Pp}$ (see Table~\ref{tab: problem_logic_class}).
        Consider the converse problem, i.e., deciding if all fixed points are attractors.
        The $\mathbf{\Pi}_2^{\Pp}$-hardness of the latter follows from the construction of the RS $\sA$ in the proof of Theorem 5 in \cite{formenti2014fixed}.
        Therefore our problem is $\mathbf{\Sigma}_2^{\Pp}$-complete.
    \end{proof}
\end{prop}


\begin{cor}\label{cor: common_fix_pointge_c}
\hypertarget{cor: common_fix_pointge_c}{}
    Given $\sA, \sB \in \RS(\infty,\infty)$ with a common background set $S$, it is $\mathbf{\Sigma}_2^{\Pp}$-complete to decide whether $\sA$ and $\sB$ have a common fixed point which is not attractor.
\end{cor}

Determining the existence of fixed point attractors for inhibitorless RS requires more work.
We start by giving the following result for the special case of the Boolean lattice $2^S$,
following the same approach as in the proof of the Knaster-Tarski theorem \cite{Granas2003}.

\begin{lem}
    \label{lem: S_not_fixed}
    Let $S$ be a finite set, $n\coloneqq |S|$, and $f:2^S\to 2^S$ monotone. If $S$ is not a fixed point, then the sequence
    \begin{equation*}
        S \supsetneq f(S) \supseteq f^2(S) \supseteq \dots \supseteq f^n(S)
    \end{equation*}
    contains a fixed point attractor.
    \begin{proof}
        If there exists $k$ such that $1\le k \le n$ and $f^k(S) = f^{k+1}(S)$ then $f^k(S)$ is a fixed point reachable from $f^{k-1}(S)$.
        Instead, if all inclusions are strict
        \begin{equation*}
            S \supsetneq f(S) \supsetneq f^2(S) \supsetneq \dots \supsetneq f^n(S)
        \end{equation*}
        then $|f^n(S)| = 0$, i.e., $f^n(S) = \varnothing$. In particular, $\varnothing$ is reachable from $f^{n-1}(S)$ and it is a fixed point since
        \begin{equation*}
           \varnothing = f^n(S) \supseteq f^{n+1}(S) = f(f^n(S)) \Rightarrow f(\varnothing) = \varnothing. \qedhere
        \end{equation*}
    \end{proof}
\end{lem}
\begin{comment}
    
\begin{lem}
     \label{lem: epmty_not_fixed}
    Let $S$ a finite set, $n\coloneqq |S|$, and $f:2^S\to 2^S$ monotone. If $\varnothing$ in not a fixed point, then the sequence
    \begin{equation*}
        \varnothing \subsetneq f(\varnothing) \subseteq f^2(\varnothing) \subseteq \dots \subseteq f^n(\varnothing)
    \end{equation*}
    contains a fixed point attractor.
\end{lem}

\end{comment}
Lemma~\ref{lem: S_not_fixed} implies that if $S$ is not a fixed point then there exists a fixed point attractor.
We also remark that if a function is injective then there exists no fixed points attractor.
It remains to discuss the case where $S$ is a fixed point and the result function is not injective.
We will make use of the following remark.

\begin{rk}
    Given a fixed point $T$ of a monotone function $f: 2^S \to 2^S$, for all $X\subseteq T$ we have that
        \begin{equation}
            \label{eq: S-f(X)<=f(S-X)}
            T\setminus f(X) \subseteq f(T\setminus X)
        \end{equation}
        since $T = f(T) = f(X \cup T\setminus X) \subseteq f(X) \cup f(T\setminus X)$.
\end{rk}

\begin{prop}
    \label{prop: S_fix}
    Let $S$ be a finite set and $f:2^S\to 2^S$ monotone non-injective. 
    If $S$ is a fixed point, then $S$ is a fixed point attractor.
    \begin{proof}
        %At first, remark that for all $X\subseteq S$ we have that
        %\begin{equation}
        %    \label{eq: S-f(X)<=f(S-X)}
        %    S\setminus f(X) \subseteq f(S\setminus X)
        %\end{equation}
        %since $S = f(S) = f(X \cup S\setminus X) \subseteq f(X) \cup f(S\setminus X)$.
        Since $f$ is not injective, there exist $X_1, X_2 \subseteq S$ such that $f(X_1) = f(X_2)$ and $X_1\ne X_2$. Without loss of generality, we suppose $X_2\ne \varnothing$. 
        Let $T \coloneqq S\setminus (X_1 \cup X_2)$, then $T \cup X_1 = S \setminus X_2 \subsetneq S$. 
        Furthermore, we have that $f(T \cup X_1) = f(S \setminus X_2) \supseteq S\setminus f(X_2)$ by Eq.(\ref{eq: S-f(X)<=f(S-X)}), and $f(X_1) \subseteq f(T \cup X_1)$ since $X_1 \subseteq T \cup X_1$.
        Putting everything together, we obtain
        \begin{equation*}
            f(T \cup X_1) \supseteq S\setminus f(X_2) \cup f(X_1) = S\setminus f(X_2) \cup f(X_2) = S% \Rightarrow f(T\cup X_1) = S,
        \end{equation*}
        thus $f(T\cup X_1) = S$, i.e., $S$ is reachable from $T \cup X_1 = S \setminus X_2$.
    \end{proof}
\end{prop}

It follows from Lemma~\ref{lem: S_not_fixed} and Proposition~\ref{prop: S_fix} that, given $\sA \in \RS(\infty,0)$, if $\res_{\sA}$ is not bijective then there always exists a fixed point attractor. 

The following corollary relies on the fact that injectivity can be checked in polynomial time. We will only prove this fact in Corollary~\ref{cor: res_A_bijective_inhibitorless} of Section~\ref{sec: bij_res_A}, however,
for ease of presentation, we decided to anticipate here this result.

\begin{cor}
    \label{cor: reactnatless_exists_fixed_att}
    \hypertarget{cor: reactnatless_exists_fixed_att}{}
    Given $\sA \in \RS(\infty,0)$, it is in $\Pp$ to decide if $\sA$ has a fixed point attractor.
    %\begin{proof}
     %   Due to Lemma~\ref{lem: S_not_fixed} and Proposition~\ref{prop: S_fix}, if $\res_{\sA}$ is not bijective there always exists a fixed point attractor. 
     %   By Corollary~\ref{cor: res_A_bijective_inhibitorless}, we know that check injectivity can be done in polynomial time.
    %\end{proof}
\end{cor}


In contrast, we next show that determining whether two inhibitorless RS have a common fixed point attractor is $\NP$-complete. The proof is an adaptation of the proof of Theorem~\ref{teor: inhibitorless_common_fix_point}.

\begin{cor}
    \label{cor: inhibitorless_common_fix_point_attr}
    \hypertarget{cor: inhibitorless_common_fix_point_attr}{}
    Given $\sA, \sB \in \RS(\infty,0)$ with a common background set $S$, it is \NP-complete to decide whether $\sA$ and $\sB$ have a common fixed point attractor.
    \begin{proof}
        The problem is in $\NP$ (see Table~\ref{tab: problem_logic_class}). %, since $(\exists T \subseteq S) \textsc{att}_{\sA}(T) \land \textsc{att}_{\sB}(T)$ is a SO$\exists$ formula. 
        Following the proof of Theorem~\ref{teor: inhibitorless_common_fix_point}, we just need to ensure that the fixed points of $\sA$ are attractors, so we delete reaction (\ref{eq: spade,,spade}) from the reactions of $\sA$. In this way, when $Y\subset V \cup \nV$ and $Y \vDash \varphi$, we have that
        \begin{equation*}
            \res_{\sA}(Y \cup \heartsuit_S\cup \{\spadesuit\}) =  Y \cup \heartsuit_S = \res_{\sA}(Y \cup \heartsuit_S),
        \end{equation*}
        thus $Y \cup \heartsuit_S$ is a fixed point reachable from $Y \cup \heartsuit_S\cup \{\spadesuit\}$.
        We can conclude that $\sA$ and $\sB$ share a fixed point attractor exactly when there exists an assignment satisfying $\varphi$, i.e., $\varphi$ is satisfiable.
        Since the mapping $\varphi \mapsto (\sA,\sB)$ is computable in polynomial time, the problem is \NP-hard.\qedhere
    \end{proof}
\end{cor}

%\roccoinline{Non ho capito perchÃ¨ spostare questo qua. Ahh forse ho sbagliato l'enunciato: Ã¨ common fixed point NOT attractor}
%\todo[inline]{OK ha tutto molto piÃ¹ senso allora!}

We conclude this section considering the problem of deciding if two RS share all their fixed points (both attractors and not attractors) and prove that, like in the case of reactantless systems, this problem is \coNP-complete.

\begin{teor}
    \label{teor: inhibitorless_all_fix_point}
    \hypertarget{teor: inhibitorless_all_fix_point}{}
    Given $\sA, \sB \in \RS(\infty,0)$ with a common background set $S$, it is \coNP-complete to decide whether $\sA$ and $\sB$ share all their fixed points.
    \begin{proof}
        The problem lies in $\coNP$ (see Table~\ref{tab: problem_logic_class}). %, since $(\forall T \subseteq S) (\textsc{fix}_{\sA}(T) \Leftrightarrow \textsc{fix}_{\sB}(T))$ is a SO$\forall$ formula. 
        In order to show \coNP-completeness, we reduce \textsc{validity} \cite{papadimitriou1994computational} to this problem. 
        Given a Boolean formula $\varphi = \varphi_1 \lor \cdots \lor \varphi_m$ in DNF over the variables $V = \{x_1,\dots,x_n\}$, let $\nV\coloneqq\{\overline{x_j}: x_j \in V\}$ and let $\heartsuit_S \coloneqq \{\heartsuit_i: 1\le i\le n\}$ be a set of extra entities. 
        We define $\posV(\varphi_r) \subseteq V$ as the set of variables that occur non-negated in $\varphi_r$ and $\overline{\negV}(\varphi_r) \subseteq \nV$ as the set of variables that occur negated in $\varphi_r$. 
        We define a RS $\sA$ with background set $S\coloneqq V \cup \nV \cup \heartsuit_S \cup \{\heartsuit\}$ (with $\heartsuit\notin V \cup \nV \cup \heartsuit_S$) and the reactions
        \begin{align}
            \label{eq: n-neg_pos-hearts_heart}
            &(\overline{\negV}(\varphi_j) \cup \posV(\varphi_j) \cup \heartsuit_S \cup \{\heartsuit\}, \varnothing, \{\heartsuit\}) & \text{ for } &1\le j \le m\\
            &(\{x_i\} \cup \heartsuit_S,\varnothing, \{\heartsuit_i,x_i\}) & \text{ for } &1\le i \le n\\
            &(\{\overline{x_i}\} \cup \heartsuit_S,\varnothing, \{\heartsuit_i,\overline{x_i}\}) & \text{ for } &1\le i \le n\\
            \label{eq: eq: x_negx,,heart}
            &( \{x_i,\overline{x_i}\} \cup \heartsuit_S,\varnothing, \{\heartsuit\}) & \text{ for } &1\le i \le n.
        \end{align}
         For every $Y \subseteq V \cup \nV$, define $\heartsuit_Y\coloneqq \{\heartsuit_i: x_i \in Y \lor \overline{x_i}\in Y\} \subseteq \heartsuit_S$. As in the proof of Theorem~\ref{teor: inhibitorless_common_fix_point}, if $T\ne \varnothing$ is a fixed point then must be of the form $T=Y\cup \heartsuit_Y$ or $T=Y\cup \heartsuit_Y \cup \{\heartsuit\}$ with $\heartsuit_Y = \heartsuit_S$. 
         We divide two cases:
        \begin{enumerate}[(i)]
            \item $Y$ is not a well-formed state. Then, since $\heartsuit_{Y} = \heartsuit_{S}$, there exist $x_i,\overline{x_i}\in Y$, so $\heartsuit$ is generated by one of the reactions of type (\ref{eq: eq: x_negx,,heart}). We get that $Y\cup \heartsuit_Y \cup \{\heartsuit\}$ is a fixed point reachable from $Y\cup \heartsuit_Y$.
            \item $Y$ is a well-formed state. Then, if $Y\vDash \varphi$, a reaction of type (\ref{eq: n-neg_pos-hearts_heart}) is enabled by $Y\cup \heartsuit_Y \cup \{\heartsuit\}$, so $Y\cup \heartsuit_Y \cup \{\heartsuit\}$ is a fixed point (not reachable from any other state). 
            In this case, also $Y \cup \heartsuit_S$ is a fixed point since reactions of type (\ref{eq: n-neg_pos-hearts_heart}) are not enabled.
            On the other hand, if $Y\nvDash \varphi$ then $Y \cup \heartsuit_S$ is a fixed point reachable from $Y \cup \heartsuit_S \cup \{\heartsuit\}$.
        \end{enumerate}
        Now, consider the RS $\sB$ given by the following reactions:
        \begin{align}
            \label{eq: hearts,,heart}
            &(\{\heartsuit\} \cup \heartsuit_S, \varnothing, \{\heartsuit\}) \\
            &(\{x_i\} \cup \heartsuit_S,\varnothing, \{\heartsuit_i,x_i\}) & \text{ for } &1\le i \le n\\
            &(\{\overline{x_i}\} \cup \heartsuit_S,\varnothing, \{\heartsuit_i,\overline{x_i}\}) & \text{ for } &1\le i \le n\\
            &( \{x_i,\overline{x_i}\} \cup \heartsuit_S,\varnothing, \{\heartsuit\}) & \text{ for } &1\le i \le n.
        \end{align}
        With a similar analysis as above, for every well-formed state $Y \subseteq V \cup \nV$ the states $Y \cup \heartsuit_S$, $Y\cup \heartsuit_Y \cup \{\heartsuit\}$ are fixed points (not attractors), and for every not-well-formed state $Y \subseteq V \cup \nV$ such that $\heartsuit_Y=\heartsuit_S$ the state $Y\cup \heartsuit_Y \cup \{\heartsuit\}$ is a fixed point reachable from $Y \cup \heartsuit_S$.
        We can conclude that $\sA$ and $\sB$ share all fixed points exactly when all assignments satisfy $\varphi$, i.e., $\varphi$ is a tautology. 
        Since the mapping $\varphi \mapsto (\sA,\sB)$ is computable in polynomial time, the problem is \coNP-hard.\qedhere  
    \end{proof}
\end{teor}

\begin{cor}
    \label{cor: inhibitorless_all_fix_pointge}
    \hypertarget{cor: inhibitorless_all_fix_pointge}{}
    %\color{red}
    Given $\sA, \sB \in \RS(\infty,0)$ with a common background set $S$, it is \coNP-complete to decide whether $\sA$ and $\sB$ share all their fixed points that are not attractors.
    \begin{proof}
        The problem is in \coNP (see Table~\ref{tab: problem_logic_class}).
        The \coNP-hardness follows from the same construction of Theorem~\ref{teor: inhibitorless_all_fix_point}.
    \end{proof}
\end{cor}

Modifying the reactions in the proof of Theorem~\ref{teor: inhibitorless_all_fix_point}, we get that the problem is \coNP-complete also for fixed point attractors.

\begin{cor}
    \label{cor: inhibitorless_all_fix_point_attr}
    Given $\sA, \sB \in \RS(\infty,0)$ with a common background set $S$, it is \coNP-hard to decide whether $\sA$ and $\sB$ share all their fixed point attractors.
    \begin{proof}
    The problem is in \coNP by Corollary~\ref{cor: reactantless_inhibitorless_all_fix_point_attr_coNP}.
        %Following the proof of Theorem~\ref{teor: inhibitorless_all_fix_point}, we just need to ensure that the fixed points of $\sA$ and $\sB$ are attractors. 
        In order to show \coNP-hardness, we follow the proof of Theorem~\ref{teor: inhibitorless_all_fix_point} and we just need to ensure that the fixed points of $\sA$ and $\sB$ are attractors.    
        So we substitute the reactions of type (\ref{eq: n-neg_pos-hearts_heart}) of $\sA$ with the following:
        \begin{equation*}
            (\overline{\negV}(\varphi_j) \cup \posV(\varphi_j) \cup \heartsuit_S , \varnothing, \{\heartsuit\}) \qquad \text{ for } 1\le j \le m,
        \end{equation*}
        i.e., avoiding $\heartsuit$ in the reactants.
        In a similar manner, we substitute the reaction (\ref{eq: hearts,,heart}) with $(\heartsuit_S, \varnothing, \{\heartsuit\})$.
        In this way, all the fixed points of $\sA$ and $\sB$ are attractors and we can conclude as in Theorem~\ref{teor: inhibitorless_all_fix_point}.
    \end{proof}
\end{cor}

\section{Equal Result function}\label{sec:resultFunction}
In this section, we study the problem of deciding if two RS have the same result function.
This problem lies in \coNP and is complete in general RS.
\begin{teor}
    \label{teor: res_A=res_B}
    \hypertarget{teor: res_A=res_B}{}
    Given $\sA, \sB \in \RS(\infty,\infty)$ with the same background set $S$, it is \coNP-complete to decide whether $\res_{\sA} = \res_{\sB}$.
    \begin{proof}
        The problem lies in $\coNP$ (see Table~\ref{tab: problem_logic_class}). %, since $(\forall T \subseteq S) (\res_{\sA}(T) = \res_{\sB}(T))$ is a SO$\forall$ formula. 
        In order to show \coNP-completeness, we reduce \textsc{validity} \cite{papadimitriou1994computational} to this problem. Given a Boolean formula $\varphi = \varphi_1 \lor \cdots \lor \varphi_m$ in DNF over the variables $V = \{x_1,\dots,x_n\}$, build the RS $\sA$ consisting of the background set $S \coloneqq V \cup \{\heartsuit\} $ (with $\heartsuit\notin V$, and $\posV(\varphi_r) \subseteq V$ and $\negV(\varphi_r) \subseteq V$ the set of variables that occur non-negated and negated in $\varphi_r$, respectively) and the following reactions:
        \begin{equation}
            \label{eq: res_A=res_B_A}
            (\posV(\varphi_j),\negV(\varphi_j),\{\heartsuit\}) \qquad \text{for } 1\le j\le m.
        \end{equation}
        For any state $T\subseteq S$, $T \cap V$ encodes a truth assignment of $\varphi$. In this way, the reactions of type (\ref{eq: res_A=res_B_A}) evaluate each conjunctive clause and produce the element $\heartsuit$ if the clause (and thus the whole formula $\varphi$) is satisfied.
        Then the RS behaves as follows:
        \begin{equation*}
            \res_{\sA} (T) = 
            \begin{cases}
            \heartsuit      &\text{if } T \cap V \vDash \varphi\\
            \varnothing     &\text{if } T \cap V \nvDash \varphi.
            \end{cases}
        \end{equation*}
        Now let $\sB$ be the constant RS defined by the reaction $(\varnothing,\varnothing, \{\heartsuit\})$ alone.
        
        By construction, $\res_{\sA} = \res_{\sB}$ when all assignments satisfy $\varphi$. Since the map $\varphi \mapsto (\sA,\sB)$ is computable in polynomial time, deciding if $\res_{\sA} = \res_{\sB}$ is \coNP-hard.
    \end{proof}
\end{teor}
Since in the previous proof the RS $\sB$ is constant, the problem of deciding if the result function of a RS is not constant is \coNP-complete in unconstrained RS.
In contrast, deciding if a result function is empty can be done in polynomial time.
\begin{cor}
    Given $\sA \in \RS(\infty,\infty)$, it is \coNP-complete to decide if $\res_{\sA}$ is a non-empty constant function; however, deciding if $\res_{\sA} = \varnothing$ is in \Pp.
    \begin{proof}
        The first part of the statement follows directly from the proof of Theorem~\ref{teor: res_A=res_B}. 
        Note that given a RS $\sA = (S,A)$ and a reaction $a = (R_a,I_a,P_a)\in A$, there exists a state $T\subseteq S$ that enables $a$ if and only if $R_a \cap I_a = \varnothing$. 
        Since, $\res_{\sA} = \varnothing$ if and only if any reaction is not enabled by all states, we just need to check that $R_a \cap I_a \ne \varnothing$ for all $a \in A$.
    \end{proof}
\end{cor}
We now consider the same problem for inhibitorless RS.
\begin{prop}
    \label{prop: res_A<res_B_inhibitorless}
    Given $\sA=(S,A),\sB = (S,B) \in \RS(\infty, 0)$, if 
    \begin{equation}
        \label{eq: res_A<res_B_inhibitorless}
        \res_{\sA} (R_a) \subseteq \res_{\sB} (R_a) \quad \forall a \in A,
    \end{equation}
    then $\res_{\sA} (T) \subseteq \res_{\sB} (T) $ for all states $T\subseteq S$.
    \begin{proof}
        Let $T\subseteq S$ such that $T\ne R_a$ for all $a\in A$. %, otherwise the statement is true.
        By definition we have
        \begin{equation*}
            \res_{\sA}(T) = \bigcup_{a\in A: R_a\subsetneq T} \res_a(T)
                        = \bigcup_{a\in A: R_a\subsetneq T} \res_a(R_a)
                        = \bigcup_{a\in A: R_a\subsetneq T} \res_{\sA}(R_a).
        \end{equation*}
        By monotonicity of $\res_\sB$, if $ R_a\subseteq T$ then $\res_{\sB} (R_a) \subseteq \res_{\sB} (T)$, so using (\ref{eq: res_A<res_B_inhibitorless}) we obtain
        \begin{equation*}
            \res_{\sA}(T) \subseteq \bigcup_{a\in A: R_a\subsetneq T} \res_{\sB}(R_a) \subseteq \res_{\sB}(T)\,.\qedhere
        \end{equation*}
    \end{proof}
\end{prop}

\begin{cor}
    \label{cor: inibithorless_resA=resB}
    \hypertarget{cor: inibithorless_resA=resB}{}
     Given $\sA,\sB \in \RS(\infty,0)$ with a common background set $S$, it is in $\Pp$ to decide whether $\res_{\sA} = \res_{\sB}$.
     \begin{proof}
         Applying Proposition~\ref{prop: res_A<res_B_inhibitorless} twice, it is possible to verify in polynomial time that $\res_{\sA}(T) \subseteq \res_{\sB} (T)$ and $\res_{\sB}(T) \subseteq \res_{\sA} (T)$ for all states $T\subseteq S$.
     \end{proof}
\end{cor}
With a proof similar to the one of Proposition~\ref{prop: res_A<res_B_inhibitorless}, we obtain the following result for reactantless RS.
\begin{prop}
    \label{prop: res_A<res_B_reactantless}
    Given $\sA=(S,A), \sB = (S,B) \in \RS(0,\infty)$, if 
    \begin{equation}
        \label{eq: res_A<res_B_reactantless}
        \res_{\sA} (S\setminus I_a) \subseteq \res_{\sB} (S\setminus I_a) \quad \forall a \in A,
    \end{equation}
    then $\res_{\sA} (T) \subseteq \res_{\sB} (T) $ for all states $T\subseteq S$.
    \begin{proof}
        Let $T\subseteq S$ such that $T\ne S\setminus I_a$ for all $a\in A$. %, otherwise the statement is true.
        By definition we have
        \begin{equation*}
            \res_{\sA}(T) = \bigcup_{a\in A: I_a\cap T = \varnothing} \res_a(T)
                        = \bigcup_{a\in A: I_a\cap T = \varnothing} \res_a(S\setminus I_a)
                        = \bigcup_{a\in A: I_a\cap T = \varnothing} \res_{\sA}(S\setminus I_a).
        \end{equation*}
        If $ I_a\cap T = \varnothing$ then $ T \subseteq S\setminus I_a$ and, since $\sB$ is antitone, we have $\res_{\sB} (T) \supseteq \res_{\sB} (S\setminus I_a)$. Using (\ref{eq: res_A<res_B_reactantless}), we obtain
        \begin{equation*}
            \res_{\sA}(T) \subseteq \bigcup_{a\in A: I_a\cap T = \varnothing} \res_{\sB}(S\setminus I_a) \subseteq \res_{\sB}(T)\,.\qedhere
        \end{equation*}
    \end{proof}
\end{prop}

\begin{cor}
    \label{cor: reactantless_resA=resB}
    \hypertarget{cor: reactantless_resA=resB}{}
     Given $\sA, \sB \in \RS(0,\infty)$ with a common background set $S$, it is in $\Pp$ to decide whether $\res_{\sA} = \res_{\sB}$.
\end{cor}

\section{Bijective Result Function}
\label{sec: bij_res_A}
In this section, we study the problem of deciding if the result function of a RS is bijective.
This problem is \coNP-complete for $\RS(\infty,\infty)$ \cite[Theorem 7]{formenti2014cycles}.
In this section, we prove that for inhibitorless and reactantless reaction systems, the problem is in \Pp.

\begin{prop}
    \label{prop: |f(T)|=|T|}
    Given $S$ a finite set and $f: 2^S \to 2^S$ monotone and bijective, then $|f(T)| = |T|$ for all $T\subseteq S$.
    \begin{proof}
        Fix $T\subseteq S$ and set $k \coloneqq |T|$, $n\coloneqq |S|$. Given $T_1, T_2\subseteq S$ such that $T_1 \subsetneq T \subsetneq T_2$ then, since $f$ is monotone and injective, it holds
        \begin{equation}
            \label{eq: f(T1)<f(T)<f(T2)}
            f(T_1) \subsetneq f(T) \subsetneq f(T_2).
        \end{equation}
        We can deduce two facts from (\ref{eq: f(T1)<f(T)<f(T2)}) and the injectivity of $f$:
        \begin{enumerate}[(i)]
            \item $f(T)$ strictly contains $2^k-1$ distinct subsets of $S$.
            \item $f(T)$ is strictly contained in $2^{n-k}-1$ distinct subsets of $S$.
        \end{enumerate}
        Now suppose towards a contradiction that $m\coloneqq|f(T)|< k$; then $f(T)$ can strictly contain at most $2^m-1<2^k-1$ different subsets of $S$, contradicting (i).
        On the other hand, if $m>k$ then $f(T)$ is strictly contained in $2^{n-m}-1 > 2^{n-k}-1$ different subsets of $S$, and this contradicts (ii).
        We thus conclude that $m=k$, i.e., $|f(T)| = |T|$.
    \end{proof}
\end{prop}
The first consequence of Proposition~\ref{prop: |f(T)|=|T|} is that bijective monotonic functions are completely determined by their values on the singletons.
\begin{cor}
    \label{cor: f(T)=cup_f(x)}
     Given $S$ a finite set and $f: 2^S \to 2^S$ monotone and bijective,
     then for all $T\subseteq S$
     \begin{equation}
        \label{eq: f(T)=cup_f(x)}
         f(T) = \bigcup_{x\in T} f(\{x\}).
     \end{equation}
     \begin{proof}
         Since $f$ is injective (thus, in particular, it is injective on singletons), we have $|\cup_{x\in T} f(\{x\})| = |T|$; and by Proposition~\ref{prop: |f(T)|=|T|} we have $|\cup_{x\in T} f(\{x\})| = |f(T)|$.
         By monotonicity of $f$, $\cup_{x\in T} f(\{x\}) \subseteq f(T)$; therefore, since the two sets have the same cardinality, they are equal. 
     \end{proof}
\end{cor}

\begin{prop}
    \label{prop: f(T)=cup_f(x)}
    Given $f: 2^S \to 2^S$ injective on singletons such that $f(\varnothing) = \varnothing$, $|f(\{x\})|=1$ for all $x\in S$ and Equation (\ref{eq: f(T)=cup_f(x)}) holds for all $T\subseteq S$, then $f$ is monotone and injective.
    \begin{proof}
        Monotonicity follows directly from Equation (\ref{eq: f(T)=cup_f(x)}). To prove injectivity, consider $T_1\ne T_2$, then there exists $x\in T_1$, $x\notin T_2$. Since $f$ is injective on singletons, $f(\{x\})\ne f(\{y\})$ for all $y\in T_2$. Then $f(\{x\}) \in f(T_1)$ and $f(\{x\})\notin f(T_2)$, so in particular $f(T_1)\ne f(T_2)$.
    \end{proof}
\end{prop}

\begin{rk}
    If we define $\RS(a,b)^{b} \coloneqq\{\sA \in \RS(a,b): \res_{\sA} \text{ bijective}\}$, by Propositions~\ref{prop: |f(T)|=|T|} and~\ref{prop: f(T)=cup_f(x)} and Corollary~\ref{cor: f(T)=cup_f(x)} we obtain
   % \begin{equation*}
        $\RS(\infty,0)^{b} \approx_1 \RS(1,0)^{b}$.
    %\end{equation*}
\end{rk}
The following sufficient and necessary conditions for a monotonic function to be bijective follow from Propositions~\ref{prop: |f(T)|=|T|} and~\ref{prop: f(T)=cup_f(x)} and Corollary~\ref{cor: f(T)=cup_f(x)}.
\begin{cor}
    \label{cor: mon_bij_iff}
    Given $\sA= (S,A) \in \RS(\infty,0)$, $\res_{\sA}$ is injective and monotone if and only if the following three conditions are satisfied:
    \begin{enumerate}
        \item $\res_{\sA}(\varnothing) = \varnothing$, $|\res_{\sA}(\{x\})| = 1$ for all $x\in S$.
        \item $\res_{\sA}$ is injective on singletons.
        \item for all $(R,\varnothing, P)\in A$, it holds
            $\res_{\sA}(R) = \bigcup_{x\in R} \res_{\sA} (\{x\})$.
    \end{enumerate}
    \begin{proof}
            ($\Rightarrow$) Follows directly from Proposition~\ref{prop: |f(T)|=|T|} and Corollary~\ref{cor: f(T)=cup_f(x)}.
            
            ($\Leftarrow$) Arguing as in the proof of Proposition~\ref{prop: res_A<res_B_inhibitorless}, we obtain that for all $T\subseteq S$,
            \begin{equation*}
                \res_{\sA} (T) = \bigcup_{a\in A: R_a\subseteq T} \res_{\sA}(R_a)
                = \bigcup_{a\in A: R_a\subseteq T} \bigcup_{x\in R_a} \res_{\sA}(\{x\}).
            \end{equation*}
            By Condition 2, every element $x\in T$ belongs to some reaction of the form $(\{x\}, \varnothing, P_x)\in A$ with $|P_x|=1$, so we obtain
        %    \begin{equation*}
                $\res_{\sA} (T) = \bigcup_{x\in T} \res_{\sA}(\{x\})$.
           % \end{equation*}
            The conclusion follows from Proposition~\ref{prop: f(T)=cup_f(x)}.
    \end{proof}
\end{cor}
Given an inhibitorless RS, we can check the three conditions of Corollary~\ref{cor: mon_bij_iff} in polynomial time, obtaining the following.
\begin{cor}
    \label{cor: res_A_bijective_inhibitorless}
    \hypertarget{cor: res_A_bijective_inhibitorless}{}
    Given $\sA \in \RS(\infty,0)$, deciding whether $\res_{\sA}$ is bijective is in $\Pp$. 
\end{cor}
Recall that if a function $f:2^S\to 2^S$ is antitone, then $f^2$ is monotone.
Due to this remark, we can decide in polynomial time if the result function of a reactantless RS is bijective.
\begin{cor}
    \label{cor: res_A_bijective_reactantless}
    \hypertarget{cor: res_A_bijective_reactantless}{}
    Given $\sA \in \RS(0,\infty)$, deciding whether $\res_{\sA}$ is bijective is in $\Pp$.
    \begin{proof}
        Since $\res_{\sA}$ is antitone, $\res_{\sA}^2$ is monotone. Furthermore, $\res_{\sA}$ is injective if and only if $\res_{\sA}^2$ is injective. By Corollary~\ref{cor: res_A_bijective_inhibitorless}, we can check in polynomial time whether $\res_{\sA}^2$ is injective, and since $\res_{\sA}^2(T)$ can be computed in polynomial time from $\res_{\sA}(T)$, the statement follows.
    \end{proof}
\end{cor}

\section{Conclusions}\label{sec:conclusions}
We have determined the computational complexity of an extensive set of decision problems regarding the dynamical behaviour of reactantless and inhibitorless reaction systems. This analysis contributes to providing a more comprehensive understanding of how problem complexity varies across different models. 
Our findings reveal that the simplification of models does not uniformly reduce complexity: some of the analyzed problems retain the same complexity as in the unconstrained model in both reactantless and inhibitorless systems, some become simpler in both the constrained settings, and some others are equally difficult in unconstrained and reactantless systems but become polynomially decidable in inhibitorless systems.

As future directions for extending this work, we plan to study the complexity of other problems related to the dynamics of resource-bounded reaction systems: for instance, studying cycles and global attractors, similar to what has been done for resource-unbounded systems~\cite{formenti2014cycles}. 
Moreover, it would be interesting to establish the computational complexity of the problems analyzed in this paper in even more constrained classes of reaction systems, such as the special case of inhibitorless reaction systems using only \emph{one} reactant per reaction.

\bibliographystyle{plain} 
\bibliography{bibdatabase.bib}

%% else use the following coding to input the bibitems directly in the
%% TeX file.

%%\begin{thebibliography}{00}

%% \bibitem{label}
%% Text of bibliographic item

%%\bibitem{}

\end{document}
\endinput
%%
%% End of file `elsarticle-template-num.tex'.
