\section{Numerical Results}\label{sec6}

This section provides a range of numerical results to assess the effectiveness of the GIM-B algorithm and the bottleneck edge search method. It is assumed that $M=19$ BSs and $N=5$ CSs are deployed across a $10\mathrm{km}\times 10\mathrm{km}$ region wherein the UAV flies from $\mathbf{u}_0=(-300\mathrm{m},300\mathrm{m})$ to $\mathbf{u}_F=(6650\mathrm{m},7900\mathrm{m})$ at the same altitude $H=100\mathrm{m}$.
The coverage radius of $\mathrm{BS}_m$ is established by $d_0=1484.6\mathrm{m}$ and $\lambda_m\in[0,800]\mathrm{m}$ for $m\in[1:M]$. Note that the base coverage radius $d_0$ can be obtained via the communication model in \eqref{eq:3.1}-\eqref{eq:6}, whose parameters are described in Table \ref{Tabcomm}.  
%%%%% Table_comm %%%%%%%%%%%%%%%%
\begin{table}
\caption{Parameters for communication model}\label{Tabcomm}
\centering
\begin{tabular}{@{} c || c | c @{}}
\cline{1-3}
Symbol &  Definition &  Value\\ \cline{1-3}
$H_\mathrm{BS}$ & Height of BS & $35\mathrm{m}$\\ \cline{1-3}
$\mathrm{SINR_\mathrm{th}}$ & Hard SINR threshold & $12\mathrm{dB}$\\ \cline{1-3}
$\mathrm{SNR_\mathrm{ref}}$ & SNR at distance $1\mathrm{m}$ in free space & $95\mathrm{dB}$\\ \cline{1-3}
$\mu_1$ & Parameter for LoS probability & $4.880$\\ \cline{1-3}
$\mu_2$ & Parameter for LoS probability & $0.429$\\ \cline{1-3}
$\zeta_1$ & Excessive pathloss (LoS) & $0.1\mathrm{dB}$\\ \cline{1-3}
$\zeta_2$ & Excessive pathloss (NLoS) & $21\mathrm{dB}$\\ \cline{1-3}
\end{tabular}
\end{table}
%%%%%%%%%%%%%%%%%%%%%
\sh{The total delay for battery replacement at each CS is set to 100s, i.e., $\tau_{C_n}=100\mathrm{s}$ for $n\in[1:N]$, by considering approximately 60 seconds for the replacement itself \cite{Lee:2015} and about 40 seconds of excessive penalty factors, but we note that  our proposed algorithms also operate when the delay at each CS is not the same.} 
 The UAV can adjust its speed $v$ in the set $\mathcal{V}=[0:1:30]\mathrm{m/s}$. The total UAV weight, inclusive of its payload, is assumed to be $w=2.97\mathrm{kg}$, where $w_1=1.07\mathrm{kg}$, $w_2=0.9\mathrm{kg}$, and $w_3=1\mathrm{kg}$. In the propulsion power consumption model \eqref{eq:1}, $P_1$, $P_2(w)$, and the mean rotor induced speed for hovering $v_0(w)$  are given as the following:
\begin{align}
P_1&={(\delta_p\rho/ 8)} (N_rN_bL_cR_r) v_\mathrm{tip}^3,\label{eq:s1}\\
P_2(w)&=(1+k_\mathrm{cf}){(wg)^{3/2}/\sqrt{2\rho N_r\pi R_r^2}},\label{eq:s2}\\
v_0(w)&=\sqrt{{wg}/({2\rho N_r\pi R_r^2})},\label{eq:s3}
\end{align}
where the parameters in \eqref{eq:s1}-\eqref{eq:s3} are described in Table \ref{Tab3}. 
%For simulations, our choice of parameter values for the communication model \eqref{eq:3.1}-\eqref{eq:6}, the power consumption model \eqref{eq:s1}-\eqref{eq:s3}, and the battery model  \eqref{eq:2}-\eqref{eq:3} are summarized in Tables \ref{Tabcomm}, \ref{Tab3}, and \ref{Tab4}, respectively.
For simulations, our choice of parameter values for the communication model \eqref{eq:3.1}-\eqref{eq:6}, and the power consumption model \eqref{eq:s1}-\eqref{eq:s3} and battery model \eqref{eq:2}-\eqref{eq:3} are summarized in Tables \ref{Tabcomm} and \ref{Tab3}, respectively.\footnote{We refered to the communication parameters for suburban environment in \cite{Al-Hourani:2014,Al-Hourani:2014_2,TR:2018} and the power consumption and battery parameters in \cite{Zhang:2021_2,Zeng:2019}.}
%%%%% Table3%%%%%%%%%%%%%%%%
\begin{table}
\caption{Parameters for power consumption and battery model}\label{Tab3}
\centering
\begin{tabular}{@{} c || c | c @{}}
\cline{1-3}
Symbol &  Definition &  Value\\ \cline{1-3}
$\delta_p$ & Profile drag coefficient & $0.012$\\ \cline{1-3}
$N_r$ & Number of rotors (quadcopter) & $4$\\ \cline{1-3}
$N_b$ & Number of blades per rotor & $4$\\ \cline{1-3}
$L_c$ & Blade chord length & $0.0157\mathrm{m}$\\ \cline{1-3}
$R_r$ & Rotor radius & $0.07\mathrm{m}$\\ \cline{1-3}
$v_\mathrm{tip}$ & Tip speed of a blade & $14\mathrm{m/s}$\\ \cline{1-3}
$k_\mathrm{cf}$ & Incremental correlation factor & $0.1$\\ \cline{1-3}
$S_\mathrm{FP}$ & Fuselage equivalent flat area & $0.03\mathrm{m^2}$\\ \cline{1-3}
$\rho$ & Air density & $1.225\mathrm{kg/m^3}$\\ \cline{1-3}
$g$ & Gravitational acceleration & $9.807\mathrm{m/s^2}$\\ \cline{1-3}
$\epsilon_\mathrm{batt}$ & Energy density of battery per kg & $540\mathrm{kJ/kg}$\\ \cline{1-3}
$\gamma$ & Depth of discharge & $0.7$\\ \cline{1-3}
$\eta$ & Ratio of transferable energy & $0.7$\\ \cline{1-3}
$r_\mathrm{safe}$ & Energy reserving factor & $1.2$\\ \cline{1-3}
\end{tabular}
\end{table}
%%%%%%%%%%%%%%%%%%%%%
\begin{comment}
%%%%% Table4%%%%%%%%%%%%%%%%
\begin{table}
\caption{Parameters for battery model}\label{Tab4}
\centering
\begin{tabular}{@{} c || c | c @{}}
\cline{1-3}
Symbol &  Definition &  Value\\ \cline{1-3}
$\epsilon_\mathrm{batt}$ & Energy density of battery per kg & $540\mathrm{kJ/kg}$\\ \cline{1-3}
$\gamma$ & Depth of discharge & $0.7$\\ \cline{1-3}
$\eta$ & Ratio of transferable energy & $0.7$\\ \cline{1-3}
$r_\mathrm{safe}$ & Energy reserving factor & $1.2$\\ \cline{1-3}
\end{tabular}
\end{table}
%%%%%%%%%%%%%%%%%%%%%
\end{comment}
\begin{comment}
Fig. \ref{Figs1} plots the propulsion power consumption $P_\mathrm{UAV}(v)$ according to the flying speed $v$ in different payload weights $w_3$, where we can numerically check that $P_\mathrm{UAV}(v)$ is a convex function for $v\in[0,30]\mathrm{m/s}$ and hence the conditions in Theorems \ref{Thm3} and \ref{Thm4} hold. 
%%%%% Figs1%%%%%%%%%%%%%%%%
% Figure environment removed
%%%%%%%%%%%%%%%%%%%%%
\end{comment}

Fig. \ref{Figs2} illustrates the flight trajectory and the corresponding mission time $T$ for both the GIM-B and existing algorithms in \cite{Zhang:2019,Chen:2020}.
%%%%% Figs2%%%%%%%%%%%%%%%%
% Figure environment removed 
%%%%%%%%%%%%%%%%%%%%% 
The ES-FA algorithm \cite{Zhang:2019} and intersection method \cite{Chen:2020} yield the identical trajectory, which differs from the optimal result of our approach and the ES algorithm \cite{Zhang:2019}. The ES-Q algorithm \cite{Zhang:2019} at $Q=2$ fails to output any UAV trajectory owing to the battery limit. At $Q=4$, it exhibits a higher time complexity compared to our algorithm since $QN>M$. Nonetheless, it achieves a considerably longer mission time $T$ even than the other sub-optimal algorithms, because it fails to derive a path between $\mathbf{u}_0$ and $\mathbf{c}_2$ under the quantization points that can be traveled within the battery capacity.
Tables \ref{TabTime} and \ref{TabEnergy} show the excessive  mission time and the excessive propulsion energy consumption of the existing algorithms \cite{Zhang:2019,Chen:2020} compared to those of GIM-B algorithm,  respectively,  over 100 distinct maps. In the process of constructing each map, we first randomly select the locations of the initial and final points, BSs, and CSs according to the 2D uniform distribution over the $10\mathrm{km}\times 10\mathrm{km}$ region, and the coverage offsets of BSs according to the uniform distribution over the range $[0.800]\mathrm{m}$. Then, we accept it as a feasible map only if there exists a feasible trajectory between the initial and the final points under the connectivity and battery constraints. In Table \ref{TabTime}, the ES-FA algorithm \cite{Zhang:2019} and the intersection method \cite{Chen:2020} achieve the optimal travel time for more than half of the maps, because they can search an optimal trajectory if they succeed in finding an optimal BS association sequence. The ES-Q algorithm \cite{Zhang:2019} with $Q=4$ does not achieve the optimal travel time for all the maps, as it restricts the trajectories to lie on a weighted graph constructed based on the quantization points. We note that for a few maps, some suboptimal algorithms fail to yield any feasible UAV trajectory. Such infeasible cases occur due to the battery constraint, i.e., for the set of breakpoints that the corresponding algorithm considers, there is no path that the UAV can travel under the battery constraint. In Table \ref{TabEnergy}, we can see that some suboptimal algorithms achieve lower energy consumption compared to that of GIM-B algorithm for a few maps, since the GIM-B algorithm aims to minimize the mission time. It is desirable to use the EGIM-B algorithm in Section \ref{sec5A} if the focus is on the energy efficiency.  
\begin{comment}
%%%%% Figs2.1%%%%%%%%%%%%%%%%
% Figure environment removed 
%%%%%%%%%%%%%%%%%%%%%
\end{comment}
%%%%% Table_Time %%%%%%%%%%%%%%%%
\begin{table}
\caption{Excessive mission time compared to that of GIM-B algorithm over 100 random maps}\label{TabTime}
\centering
\begin{tabular}{@{} c || c | c @{}}
\cline{1-3}
\multirow{2}{2.0cm}{\centering Excessive mission time  [\%]} & \multicolumn{2}{c}{Number of maps}\\ \cline{2-3}
 & \makecell{ES-FA \cite{Zhang:2019} \\ Intersection method \cite{Chen:2020}} & \makecell{ES-Q \cite{Zhang:2019}\\ $(Q=4)$ }\\ \cline{1-3}
$0\%$ & 66 & 0 \\ \cline{1-3}
$(0,1]\%$ & 21 & 85 \\ \cline{1-3}
$(1,5]\%$ & 10 & 13 \\ \cline{1-3}
$(5,10]\%$ & 3 & 0 \\ \cline{1-3}
Infeasible & 1 & 2 \\ \cline{1-3}
\end{tabular}
\end{table}
%%%%%%%%%%%%%%%%%%%%%
%%%%% Table_Energy %%%%%%%%%%%%%%%%
\begin{table}
\caption{Excessive energy consumption compared to that of GIM-B algorithm over 100 random  maps}\label{TabEnergy}
\centering
\begin{tabular}{@{} c || c | c @{}}
\cline{1-3}
\multirow{2}{2.5cm}{\centering Excessive energy consumption [\%]} & \multicolumn{2}{c}{Number of maps}\\ \cline{2-3}
 & \makecell{ES-FA \cite{Zhang:2019} \\ Intersection method \cite{Chen:2020}} & \makecell{ES-Q \cite{Zhang:2019}\\ $(Q=4)$ }\\ \cline{1-3}
$(-20,-1]\%$ & 1 & 2 \\ \cline{1-3}
$(-1,0)\%$ & 4 & 9 \\ \cline{1-3}
$0\%$ & 65 & 0 \\ \cline{1-3}
$(0,1]\%$ & 21 & 87 \\ \cline{1-3}
$(1,5]\%$ & 8 & 0 \\ \cline{1-3}
Infeasible & 1 & 2 \\ \cline{1-3}
\end{tabular}
\end{table}
%%%%%%%%%%%%%%%%%%%%%
Fig. \ref{Figs3} shows the optimal graph at the global level and the corresponding maximum possible speed $v_\mathrm{max}$ for each edge under the environment in Fig. \ref{Figs2}. We can see that for each edge, the maximum travel speed $v_\mathrm{max}$ decreases as its travel distance increases.
%%%%% Figs3%%%%%%%%%%%%%%%%
% Figure environment removed
%%%%%%%%%%%%%%%%%%%%%

Fig. \ref{Figs4} compares the optimal UAV trajectory and the corresponding mission time $T$ for different payload weight $w_3$, battery weight $w_2$, and delay $\tau_{C_1}$ at charging station $C_1$, where the locations of CSs are changed from Fig. \ref{Figs2}.
%\footnote{In Fig. \ref{Figs4}, the locations of CSs $C_3$ and $C_4$ are changed from Fig. \ref{Figs2}.} 
We can see that the UAV avoids $C_1$ with the higher delay $\tau_{C_1}=200\mathrm{s}$ for battery replacement (red), it visits more CSs with the larger payload weight $w_3=1.5\mathrm{kg}$ (blue), and it visits less CSs with the larger battery weight $w_2=1.2\mathrm{kg}$ (green).
%%%%% Figs4%%%%%%%%%%%%%%%%
% Figure environment removed
%%%%%%%%%%%%%%%%%%%%%
Fig. \ref{Figs5} plots the optimal mission time $T$ across different delays for battery replacement and payload weights $w_3\in[0:0.1:3.5]\mathrm{kg}$ under the same environment as in Fig. \ref{Figs4}. We can verify that $T$ increases as the delay for battery replacement and the payload weight increase and that the payload cannot be delivered from $\mathbf{u}_0$ to $\mathbf{u}_F$ if $w_3$ is too large, i.e., if it exceeds $2.8\mathrm{kg}$ under this setting.
%%%%% Figs5%%%%%%%%%%%%%%%%
% Figure environment removed
%%%%%%%%%%%%%%%%%%%%%

%%%%%%%%% Added in journal %%%%%%%%%%%%%
%In Fig. \ref{Figs6}, the optimal delivery time $T$ is plotted for the different battery swapping delays and the battery weights $w_2\in[0:0.05:1.5]\mathrm{kg}$ under the same environment as in Fig. \ref{Figs4}. We can see that $T$ increases as $w_2$ decreases and the payload cannot be delivered from $\mathbf{u}_0$ to $\mathbf{u}_F$ if $w_2$ is too small, i.e., if it is less than $0.6\mathrm{kg}$ under this setting.
\begin{comment}
%%%%% Figs6%%%%%%%%%%%%%%%%
% Figure environment removed
%%%%%%%%%%%%%%%%%%%%%
\end{comment}

Fig. \ref{Figs7} compares the optimal mission time $T$ for the case that the UAV can  fly with a fixed speed of $v_\mathrm{fix}\in [15:1:30]\mathrm{m/s}$ (fixed speed) and for the case that it can change its speed in the speed set $\mathcal{V}$ (dynamic speed) under the same environment as in Fig. \ref{Figs4}. Note that in the fixed speed case, the UAV chooses its speed in the set $\{0,v_\mathrm{fix}\}$.  We can check that the dynamic speed case has a lower travel time than the fixed speed case for every $v_\mathrm{fix}\in [15:1:30]\mathrm{m/s}$ because the maximum allowable speed between each pair of CSs at the local level depends on its travel distance as shown in Fig. \ref{Figs3}. In small battery weight $w_2=0.6\mathrm{kg}$, any trajectory from $u_0$ to $u_F$ cannot be derived in the fixed speed case with $v_\mathrm{fix}>22\mathrm{m/s}$ since flying at a high speed is not efficient in terms of the energy consumption. %as shown in Fig. \ref{Figs1}.
%%%%% Figs7%%%%%%%%%%%%%%%%
% Figure environment removed
%%%%%%%%%%%%%%%%%%%%%

%%% EGIM-B %%%%
% Fig. 16: error barëŠ” standard deviation. 
Fig. \ref{Figs7.1} illustrates the UAV trajectory and the corresponding mission time $T$ and propulsion energy consumption $E_\mathrm{tot}$ for the GIM-B and EGIM-B algorithms, where the locations of CSs are changed from Fig. \ref{Figs2}. We can see that for the GIM-B algorithm, the UAV flies at the maximum possible speed under the battery constraint and frequently visits CSs to increase its flight speed thereby decreasing the mission time, with the sacrifice of the travel distance and the energy consumption. On the other hand, for the EGIM-B algorithm, the UAV always flies at the fixed speed $v_\mathrm{eff}=20\mathrm{m/s}$ which minimizes its energy consumption per unit distance and   minimizes the travel distance to reduce the propulsion energy consumption, with the sacrifice of the mission time. To evaluate the average performance of the GIM-B and EGIM-B algorithms, for the same 100 maps used for Tables \ref{TabTime} and \ref{TabEnergy}, we calculate the average relative performance. On average, the mission time and the energy consumption from the EGIM-B algorithm are $28.39\%$ longer and $14.10\%$ lower than those from the GIM-B algorithm, respectively. 
%%%%% Figs7.1%%%%%%%%%%%%%%%%
% Figure environment removed
%%%%%%%%%%%%%%%%%%%%%
\begin{comment}
Fig. \ref{Figs7.2} compares the average values of normalized mission time $T^*$ and normalized propulsion energy consumption $E_\mathrm{tot}^*$ for those two algorithms over 100 maps that are identical to the maps for Fig. \ref{Figs2.1}, where the baselines to normalize the mission time and the energy consumption are the GIM-B and EGIM-B algorithms, respectively, and both of them are normalized to $100\%$ in each map. In this figure, each error bar represents one standard deviation for the corresponding normalized values over 100 maps. We can check that the GIM-B algorithm outperforms the EGIM-B algorithm in terms of mission time, while the opposite result is shown in the aspect of energy consumption.
%%%%% Figs7.2%%%%%%%%%%%%%%%%
% Figure environment removed 
%%%%%%%%%%%%%%%%%%%%%
\end{comment}
Fig. \ref{Figs8} plots the maximum deliverable weight $w_3$ according to the battery weights $w_2\in[0.5:0.02:1]\mathrm{kg}$ for different unavailable CSs under the same environment as in Fig. \ref{Figs4}, where we say that charging station $C_n$ is unavailable if its delay for battery replacement is $\tau_{C_n}=\infty$.
We can check that the maximum deliverable weight decreases as $w_2$ decreases and the number of unavailable CSs increases.
%%%%% Figs8%%%%%%%%%%%%%%%%
% Figure environment removed
%%%%%%%%%%%%%%%%%%%%%

\sh{Finally, let us compare the actual execution time of our GIM-B algorithm with existing graph theory-based algorithms: ES-Q algorithm with $Q=4$ \cite{Zhang:2019} and intersection method \cite{Chen:2020}, for the same 100 maps used for Tables \ref{TabTime} and \ref{TabEnergy}. On average\footnote{\sh{These three algorithms were executed by MATLAB R2024a using Intel Core i5-8250U  and 8GB DDR4-2400 RAM.}}, the execution time of ours is $2.45\mathrm{s}$, which is smaller than $7.21\mathrm{s}$ of the ES-Q algorithm  and $4.46\mathrm{s}$ of the intersection method. This is due to the following reasons. First, the ES-Q algorithm exhibits a higher complexity than ours when $QN>M$. Next, the intersection method performs outage tests separately for each pair of CSs, and this can cause a larger increase in complexity compared to considering all BS associations in our algorithm, especially when there are not many other BSs whose coverage regions overlap with the coverage region of each BS. The complexity analysis in Table \ref{Tab2} is based on worst-case assumptions, and under the aforementioned sparse BS scenarios, our GIM-B algorithm has the complexity order of $\Theta(M^4)$. 
} 

 %Consequently, for an appropriate value of $M$, the actual execution time of ours is comparable to the existing algorithms while still achieving an optimal solution.