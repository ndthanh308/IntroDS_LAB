\documentclass[11pt]{imsart}
\usepackage[utf8]{inputenc}
\usepackage[dvipsnames]{xcolor}
\usepackage{amsthm}
\usepackage{amsmath,bbm, amssymb, dsfont, amsfonts}
\usepackage{array}
\usepackage{url}		% Für urls
\usepackage{xspace}		% Korrekte Leerzeichen nach Makros
\usepackage{booktabs}
\usepackage{ulem}
\usepackage{rotating}	% For rotated graphics
\usepackage{pdflscape}  % For rotated graphics
\usepackage{fancyvrb}   % Für R-Code (5.4.2009)
\usepackage{epstopdf}
\usepackage{graphicx}
\usepackage{latexsym}
\usepackage{amssymb}
\usepackage{a4wide}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{natbib}
\usepackage{multirow}
\usepackage{hhline}


\graphicspath{{img/}}

\usepackage[pdftex,                %
bookmarks         = true,%     % Signets
bookmarksnumbered = true,%     % Signets numÃ�rotÃ�s
pdfpagemode       = None,%     % Signets/vignettes fermÃ� Ã  l'ouverture
pdfstartview      = FitH,%     % La page prend toute la largeur
pdfpagelayout     = SinglePage,% Vue par page
colorlinks        = true,%     % Liens en couleur
linkcolor		  = magenta,%  % Liens equations
citecolor		  = blue,%  %Liens biblio
urlcolor          = orange,%  % Couleur des liens externes
pdfborder         = {0 0 0}%   % Style de bordure : ici, pas de bordure
]{hyperref}%   % Utilisation de HyperTeX

% address after reference
\makeatletter
\newcommand{\addresseshere}{%
  \enddoc@text\let\enddoc@text\relax
}
\makeatother
\setlength{\parskip}{0mm}

%macros for usual proba/stat maths symbols
\renewcommand{\emph}[1]{{\it #1}}
\newcommand{\wh}{\widehat}
\newcommand{\mbf}{\mathbf}
%\newcommand{\E}{\mathbf{E}}
\newcommand{\bias}{\textnormal{Bias}}
\newcommand{\var}{\textnormal{Var}}
\newcommand{\E}{\mathbb{E}}
\newcommand{\R}{\mathbb{R}}
\renewcommand{\l}{\ell}
\renewcommand{\P}{\mathbf{P}}
\newcommand{\cH}{\mathcal{H}}
\newcommand{\Bmtilde}{\tilde{B}_m}
\newcommand{\PBin}{\mathbf{PBin}}
\newcommand{\Bin}{\mathbf{Bin}}
\newcommand{\ind}[1]{{\mbf{1}\{#1\}}}
\newcommand{\unifrv}{\mathcal{U}}
%\newcommand{\expov}{\textnormal{Exp}}
\newcommand{\expov}{\mathcal{E}}

%macros for comments
\newcommand{\iq}[1]{\textcolor{Purple}{#1}}
\newcommand{\et}[1]{\textcolor{magenta}{#1}}
\newcommand{\seb}[1]{\textcolor{cyan}{#1}}

%macros for MT error criteria
\newcommand{\FDR}{\textnormal{FDR}}
\newcommand{\mFDR}{\textnormal{mFDR}}
\newcommand{\FDP}{\textnormal{FDP}}
\newcommand{\FDX}{\textnormal{FDX}}
\newcommand{\FWER}{\textnormal{FWER}}

% macros for the MT procedures
\newcommand{\ol}{\overline} 
\newcommand{\wt}{\widetilde}
\newcommand{\BH}{[\textnormal{BH}]} 
\newcommand{\LR}{[\textnormal{LR}]} 
\newcommand{\GR}{[\textnormal{GR}]} 
\newcommand{\PB}{[\textnormal{PB}]}
\newcommand{\HLR}{[\textnormal{HLR}]} 
\newcommand{\HGR}{[\textnormal{HGR}]} 

%\newcommand{\WLR}{[\textnormal{wLR}]} 
%\newcommand{\WLRAM}{[\textnormal{wLR-AM}]} 
%\newcommand{\WLRGM}{[\textnormal{wLR-GM}]} 
%\newcommand{\WPBAM}{[\textnormal{wPB-AM}]}
%\newcommand{\WPBGM}{[\textnormal{wPB-GM}]} 
%\newcommand{\WGR}{[\textnormal{wGR}]} 
%\newcommand{\WGRAM}{[\textnormal{wGR-AM}]}
%\newcommand{\WGRGM}{[\textnormal{wGR-GM}]}
%
%\newcommand{\DLR}{[\textnormal{DLR}]} 
%\newcommand{\DGR}{[\textnormal{DGR}]} 
%\newcommand{\DPB}{[\textnormal{DPB}]}
%
%\newcommand{\FAM}{F^{\textnormal{AM}}}
%\newcommand{\FGM}{F^{\textnormal{GM}}}

%\newcommand{\Abonf}{\mathcal{A}^{\mbox{\tiny OB}}}
%\newcommand{\AAbonf}{\mathcal{A}^{\mbox{\tiny AOB}}}
%\newcommand{\alphabonf}{\alpha^{\mbox{\tiny OB}}}
%\newcommand{\alphaAbonf}{\alpha^{\mbox{\tiny AOB}}}
%\newcommand{\alphaLORD}{\alpha^{\mbox{\tiny LORD}}}
%\newcommand{\ALORD}{\mathcal{A}^{\mbox{\tiny LORD}}}
%\newcommand{\alphaALORD}{\alpha^{\mbox{\tiny ALORD}}}
%\newcommand{\AALORD}{\mathcal{A}^{\mbox{\tiny ALORD}}}
%
%\newcommand{\AOBSURE}{\mathcal{A}^{\mbox{\tiny $\rho$OB}}}
%\newcommand{\AAOBSURE}{\mathcal{A}^{\mbox{\tiny $\rho$AOB}}}
%\newcommand{\alphaOBSURE}{\alpha^{\mbox{\tiny $\rho$OB}}}
%\newcommand{\alphaAOBSURE}{\alpha^{\mbox{\tiny $\rho$AOB}}}
%\newcommand{\ALORDSURE}{\mathcal{A}^{\mbox{\tiny $\rho$LORD}}}
%\newcommand{\AALORDSURE}{\mathcal{A}^{\mbox{\tiny $\rho$ALORD}}}
%\newcommand{\alphaLORDSURE}{\alpha^{\mbox{\tiny $\rho$LORD}}}
%\newcommand{\alphaALORDSURE}{\alpha^{\mbox{\tiny $\rho$ALORD}}}


%macros for estimators
\newcommand{\mPCmidp}{\widehat{m}_0^{\text {mid-PC}}}
\newcommand{\mPC}{\widehat{m}_0^{\text {PC}}}
\newcommand{\mPCNew}{\widehat{m}_0^{\text {PC,new}}}
\newcommand{\mPoly}{\widehat{m}_0^{\text {Poly}}(r, \lambda)}
\newcommand{\mPol}{\widehat{m}_0^{\text {Poly}}}


\newcommand{\mPCOrig}{\widehat{m}_0^{\text {PC,2006}}}
\newcommand{\mresStorey}{\widehat{m}_0^{\text {resc-Storey}}}
\newcommand{\mresPC}{\widehat{m}_0^{\text {resc-PC}}}
\newcommand{\mrandom}{\widehat{m}_0^r}
\newcommand{\mStorey}{\widehat{m}_0^{\text {Storey}}}
\newcommand{\mdu}{\widehat{m}_0^{\text {du}}}
\newcommand{\mmidp}{\widehat{m}_0^{\text {mid}}}
\newcommand{\mrand}{\widehat{m}_0^{\text {rand}}}
%\newcommand{\mZZKA}{\widehat{m}_0^{\text {A}}}
%\newcommand{\mZZKB}{\widehat{m}_0^{\text {B}}}
\newcommand{\mZZKA}{\widehat{m}_0^{\text {Exp}}}
\newcommand{\mZZKB}{\widehat{m}_0^{\text {PC,ZZD}}}
\newcommand{\mZZKC}{\widehat{m}_0^{\text {C}}}

\newcommand{\nudu}{\nu^{\text {du}}}
\newcommand{\nuduStorey}{\nu^{\text {du-Storey}}}
\newcommand{\nuduPC}{\nu^{\text {du-PC}}}
\newcommand{\numid}{\nu^{\text {mid}}}
\newcommand{\numidStorey}{\nu^{\text {mid-Storey}}}
\newcommand{\numidPC}{\nu^{\text {mid-PC}}}

\newcommand{\Fdu}{F^{\text{sd}}}
\newcommand{\Fmid}{F^{\text{mid}}}


%macros for convex ordering
%\newcommand{\lecx}{\le_{\text{cx}}}

% other macros
%\newcommand{\loosum}{\sum_{i \in \mathcal{H}_{0} \backslash  \{ h \} } }
%\newcommand{\nullset}{\mathcal{H}_{0}}
\newcommand{\cxorder}{\leqslant_{\text{cx}}}
\newcommand{\stoorder}{\leqslant_{\text{st}}}
\newcommand{\gest}{\geqslant_{\text{st}}}

% other macros
\newcommand{\loosum}{\sum_{i \in \mathcal{H}_{0} \backslash  \{ h \} } }
\newcommand{\nullset}{\mathcal{H}_{0}}
\newcommand{\altset}{\mathcal{H}_{1}}



\newtheorem{theorem}{Theorem}[section]
\newtheorem{corollary}{Corollary}[section]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{algorithm}{Algorithm}[section]
\newtheorem{definition}[theorem]{Definition}
\newtheorem{remark}{Remark}[section]
\newtheorem{example}{Example}[section]
\newtheorem{lemma}[theorem]{Lemma}


\defcitealias{ZZD2011}{[ZZD]}
\defcitealias{shaked2007stochastic}{[SS]}

%\oddsidemargin-4mm
%\topmargin-20mm
%\textwidth167mm
%\textheight240mm

%\renewcommand\arraystretch{1.3}
%\pagestyle{empty}


\begin{document}
%\frontmatter
\title{ A unified class of null proportion estimators with plug-in FDR control
%Some new results on plug-in estimators for FDR control
}
\author{Sebastian D\"ohler, Iqraa Meah}
%\affil[1]{Hochschule Darmstadt, Darmstadt}
%\affil[2]{LPSM, Sorbonne University and Hochschule Darmstadt, Darmstadt}
\runtitle{Unified class of $\pi_{0}$ estimators with plug-in control}
\date{\today}
%\subjclass[2000]{Primary 62P05; Secondary 91G40, 62J15}
%   % AMS keywords (used in AMS journals)
\begin{abstract}
%	The Benjamini-Hochberg (BH) procedure for controlling the false discovery rate (FDR) is an indispensable tool in modern high dimensional data analysis. 
	Since the work of \cite{Storey2004}, it is well-known that the performance of the Benjamini-Hochberg (BH) procedure can be improved by incorporating estimators of the number (or proportion) of null hypotheses, yielding an adaptive BH procedure which still controls FDR. 
	Several such plug-in estimators have been proposed since then, for some of these, like Storey's estimator, plug-in FDR control has been established, while for some others, e.g. the estimator of \cite{PC2006}, some gaps remain to be closed. 
	In this work we introduce a unified class of estimators, which encompasses existing and new estimators and unifies proofs of  plug-in FDR control using simple convex ordering arguments. 
%	We also show that \iq{estimators from the class can be combined with a convex combination without compromising plug-in FDR control.}
	{We also show that any convex combination of such  estimators once more yields  estimators with guaranteed plug-in FDR control.}
%	any such estimators, multiplied with fixed weights can be combined into a single estimator without compromising plug-in FDR control. 	
	Additionally, the flexibility of the new class of estimators also allows incorporating distributional informations on the $p$-values. 
	We illustrate this for the case of discrete tests, where the null distributions of the $p$-values are typically known. 
	In that setting, we describe two generic approaches for adapting any estimator from the general class to the discrete setting while guaranteeing plug-in FDR control. 
	While the focus of this paper is on presenting the generality and flexibility of the new class of estimators, we also include some analyses on simulated and real data.
	
%	Incorporating an estimator of the number of nulls $m_{0}$ in the BH procedure, termed as performing an adaptive plug-in procedure, should allow the practitioner to make more discoveries while keeping the FDR under control. 
%	Since the work of \cite{Storey2004}, a pool of different estimators has been proposed, however some of the estimators do not come with valid plug-in FDR control or require cumbersome parameter tuning.
%	Additionally, some of these estimators are introduced with different intuitions when in fact they could be regarded as particular cases of a general underlying estimator. 
%	In this work, we propose to introduce a class of estimators with a general formula, based on local estimates of $m_{0}$, that encompasses existing and new estimators.
%	We prove plug-in FDR control for any estimator of this general class, hence unifying plug-in FDR control proofs for existing and new estimators using simple convex ordering arguments.
%	This generalization also allows the incorporation of available distributional information of $p$-values when these are more conservative as is often the case in discrete settings.
%	At last, we analyze existing and new estimators belonging to the general class on empirical data and provide a heuristic on the choice of the estimator. 
	
	
%	The issue of designing performant estimators have been well addressed so a pool of different estimators exists. However, some of these estimators, althougth providing good performance in practice, do not come with a control guarantee for the plug-in FDR.
%	Additionally, some of the estimators are not the best suited for heteregeneous and more conservative p-values as one can encounter in a discrete setting. 
%	In this work we propose a class of estimators with a general shape unifying different types of existing and novel estimators with proven plug-in FDR control.
%	This general class seizes the idea of rescaling : the estimator sums transformed p-values and rescales this sum by the expectation of the transformation under the null. 
%	The general class allows to have hybrid estimators between different well-known types of estimators and also to make a convex combination between different estimators.
	
	
\end{abstract}
%\begin{keyword}[class=AMS]
%	\kwd[Primary ]{62H15}
%	\kwd[; secondary ]{62Q05}
%\end{keyword}
\begin{keyword}
	\kwd{False discovery rate}\kwd{Adaptive BH procedure}\kwd{Convex ordering of random variables}  \kwd{Discrete hypothesis testing} \kwd{Multiple hypothesis testing} %\sout{\kwd{Estimation of the number of null hypotheses} \kwd{Irwin-Hall distribution}}
\end{keyword}

\maketitle
\tableofcontents

%\iq{ 
%Status quo:
%\begin{itemize}
%	\item verify BR condition for slightly modified PC estimator under uniform setting : until now gap in lit 
%	\item going from estimation in the uniform setting to estimation in the discrete setting
%	\begin{enumerate}
%		\item PC with mid-p-values (gap in lit)
%		\item Storey rescaled
%		\item Randomization approach (check name in ref + check if there is formula). This is a generic approach for improving unif estimators to the discrete case (indep of the method).
%	\end{enumerate}
%\end{itemize}
%Further ideas:
%\begin{itemize}
%	\item perf for plug-in BH procedure 
%	\item general recipe to derive estimator verifying BR condition 
%	\item Storey with mid-p-values ? 
%	\item PC after selection Storey-like selection phase 
%	\item Rescaled PC ? 
%	\item properties for estimator of FDP
%	\item BR condition analog for discrete FDR procedures (check DDR)
%\end{itemize}
%}
%
%\newpage 


\input{Introduction}
\input{Preliminaries}
\input{Uniform}
\input{ExampleHomogeneous}
\input{Discrete}
%\input{Simulations}
%\input{EmpiricalData}
\input{Conclusion}
\appendix
\input{Supplement}
%\input{AdditionalMaterial}








\pagebreak
\bibliographystyle{apalike}
\bibliography{biblio}
\end{document}