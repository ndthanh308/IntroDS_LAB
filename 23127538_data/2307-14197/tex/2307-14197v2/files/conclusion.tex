\section{Conclusions}
\label{sec:conclusion}

We have implemented an HOD model to assign galaxies on the \textsc{FastPM} halo cubic mocks, such that the resulting clustering -- monopole and quadrupole -- matches the \textsc{SLICS} reference one. In order to remove the cosmic variance, we have used 20 \textsc{SLICS} galaxy catalogues  and 20 halo \textsc{FastPM} mocks (low resolution or high resolution) that share the initial conditions with the \textsc{SLICS} simulations. Given the shared white noise, the standard covariance matrix is obsolete, thus we have performed a two-steps HOD fitting:
\begin{enumerate}
    \item use a simple diagonal covariance matrix to get Initial-Guess best-fitting \textsc{FastPM} galaxy mocks;
    \item compute the covariance matrix of the 123 realisations of the difference between the IG-\textsc{FastPM} and the \textsc{SLICS} clustering, and use it to perform the final HOD fitting. 
\end{enumerate}
The final HOD fitting has been performed on three different fitting ranges for both power spectrum $k\in[0.02, k_\mathrm{max}]\,\ku$ and 2PCF $s\in[s_\mathrm{min}, 50]\,\su$: ($k_\mathrm{max}=0.5$, $k_\mathrm{max}=0.4$, $k_\mathrm{max}=0.3$) and ($s_\mathrm{min}=0$, $s_\mathrm{min}=5$, $s_\mathrm{min}=10$), respectively.

On one hand, the HR \textsc{FastPM} generally performs better than the LR at modelling the \textsc{SLICS} clustering. On the other hand, LR is also able to provide a $\chi^2_\nu\approx1$ for $k_\mathrm{max}=0.5$, $k_\mathrm{max}=0.4$, $k_\mathrm{max}=0.3$ and $s_\mathrm{min}=10$. The $k_\mathrm{max}=0.5$ case is one of the most valuable as it additionally offers $2\sigma$ matching:
\begin{enumerate}
    \item power spectrum hexadecapole for $k<0.4\,\ku$;
    \item 2PCF monopole and quadrupole for $s>10\,\su$;
    \item bi-spectrum. 
\end{enumerate}
Nevertheless, fitting the 2PCF with $s_\mathrm{min}=10$, produce a $1\sigma$ matching power spectrum monopole and quadrupole for $k\lesssim 0.2$, but a strongly biased bi-spectrum. In a similar way as the power spectrum, one must include the smallest scales to better reproduce the \textsc{SLICS} bi-spectrum, i.e. for $s_\mathrm{min}=0$ the bi-spectrum tension drops from $20\sigma$ to $5\sigma$. 
As a general remark, the power spectrum hexadecapoles can be slightly tuned by changing the values of $k_\mathrm{max}$ or $s_\mathrm{min}$, but the 2PCF hexadecapole is practically independent on the fitting range.


The fact that there is no HOD fitting case that provides both power spectrum and 2PCF $1\sigma$ matching with the reference might raise the question whether one needs two sets of catalogues for the DESI analysis. Therefore, it could be interesting for future studies to perform a joint fitting of both Fourier and Configuration clustering statistics to test for possible improvements in modelling non-linear scales. Future studies could test also the necessary level of agreement between the \textsc{FastPM} and the full $N$-body reference in order to have a similar behaviour when observational systematic effects are included. Nonetheless, for the purpose of this article, in the second part of the study, we have exposed and compared the resulting covariance matrices. 

Firstly, we have briefly shown with the 123 \textsc{FastPM} realisations -- that share the initial conditions with \textsc{SLICS} -- that the standard deviations of the $k_\mathrm{max}=0.5$ case agree within five per cent with the \textsc{SLICS} reference case for $s>10\,\su$ and $k<0.35\,\ku$. Secondly, we have focused on the 778 LR \textsc{FastPM} realisations corresponding to the six best-fitting cases, where $k_\mathrm{max}=0.5$ is considered the reference. 

Since \citet{2018MNRAS.480.2535B} have shown that the bi-spectrum computed with a configuration that includes the BAO and RSD effects -- i.e. $2 \times k_1 = k_2 = 0.2 \,\ku$ -- affects the covariance matrix, we have compared the six bi-spectra and checked how this comparison reflects into the two-point clustering covariance matrices. Lastly, we have examined the constraining power of these covariance matrices using a simplified clustering model with two scaling parameters, i.e. $b_0$ and $b_2$ for the monopole and quadrupole. We have focused on fitting intervals similar to the ones used in standard BAO and RSD analyses i.e. $\mathcal{K} \lesssim 0.20\,\ku$ and $\mathcal{S} \gtrsim20\,\su$ \citep[e.g. ][]{2020MNRAS.499.5527T, 2021MNRAS.501.5616D}.

The $s_\mathrm{min}=0$ bi-spectrum is at most five per cent different than the $k_\mathrm{max}=0.5$, while the other cases can reach a discrepancy of 15 per cent. However, each of these pairs ($k_\mathrm{max}=0.4$, $k_\mathrm{max}=0.3$), ($s_\mathrm{min}=5$, $s_\mathrm{min}=10$) yield similar bi-spectra. 
These observations are in a good agreement with a qualitative description of the shown correlation matrices and the standard deviations.

Quantitatively, the power spectrum standard deviations of $s_\mathrm{min}=0$ and ($k_\mathrm{max}=0.4$, $k_\mathrm{max}=0.3$) are within two percent from the reference for $k<0.5\,\ku$ and $k<0.27\,\ku$, respectively. Furthermore, the 2PCF standard deviations of all cases are within two percent from the reference for $s>30\,\su$.

Using the simplified clustering model, $b_0$ and $b_2$ are measured accurately for both power spectrum and 2PCF using all six covariance matrices. The six estimations of $\sigma_{b_0}$ from the power spectrum fitting up to $\mathcal{K}=0.20\,\ku$ are scattered within at most 20 per cent from the reference, whereas the values of $\sigma_{b_2}$ are within two per cent agreement, given the error bars. Lastly, the covariances between $b_0$ and $b_2$ are scattered within 5 per cent from the reference.

In contrast, the estimations of $\sigma_{b_0}$ from the 2PCF fitting down to $\mathcal{S} = 20\,\su$ are found within five per cent from each other. Similarly to the power spectrum case, the $\sigma_{b_2}$ values agree at the level of two per cent. Given the error bars, the covariances between $b_0$ and $b_2$ are consistent at the level of five per cent.

Lastly, analysing individual cases in the following pairs of HOD fitting cases: ($s_\mathrm{min}=0$, $k_\mathrm{max}=0.5$), ($k_\mathrm{max}=0.4$, $k_\mathrm{max}=0.3$), ($s_\mathrm{min}=5$, $s_\mathrm{min}=10$), one can observe that each pair provides similar uncertainty estimation $\sigma_{b_\ell}$, irrespective of the level of matching between the \textsc{FastPM} and \textsc{SLICS} two-point clustering. In order words, it seems that the estimations of the uncertainties are closer when the bi-spectra -- computed for $2 \times k_1 = k_2 = 0.2 \,\ku$ -- are more similar. The most striking case is the 2PCF for $s_\mathrm{min}=0$ which is more than $2\sigma$ different than the $k_\mathrm{max}=0.5$ 2PCF, for $s<40\,\su$, but the 2PCF standard deviations and the $\sigma_{b_\ell}$ estimations are practically identical.

In conclusion, one can use an HOD model on the low resolution \textsc{FastPM} halo catalogues to tune the galaxy clustering such that it matches the \textsc{SLICS} reference down to certain minimum scales. Additionally, the HOD fitting intervals can have an impact on the final \textsc{FastPM} based covariances. This influence is observed as a scatter in the uncertainty estimation of up to 20 per cent for power spectrum and five per cent for 2PCF at the scales interesting for BAO and RSD analyses. Nevertheless, more accurate analyses could be performed in the future using actual BAO and RSD models and a larger sample of mocks, such as \textsc{AbacusSummit}.


% \textcolor{blue}{In addition, we have asses-ed if the 5-10\% difference in certain specific configuration of bi-spectrum closed to BAO and RSD scale affects the covariance matrix and errors derived on cosmological parameters using our toy model. We showed that this level of difference can affect the error estimates but when analysis is limited to more linear scales the effects on errors are less pronounced. }