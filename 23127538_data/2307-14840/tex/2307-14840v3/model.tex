\section{The \texorpdfstring{$\LAQCC$}{LAQCC} model}
\label{sec:LAQCC_model}
This section formally defines the $\LAQCC$ model.
Next, we show that all Clifford circuits have an efficient and equivalent $\LAQCC$ circuit.
We then give quantum gates and tools constructable within $\LAQCC$, such as the quantum fan-out gate and weighted threshold gate, and we conclude by showing that any $\LAQCC$-circuit has an equivalent $\QNC^1$-circuit.

\subsection{Model definition}
We define the computational model \emph{Local Alternating Quantum-Classical Computations} ($\LAQCC$) as follows:
\begin{definition}[Local Alternating Quantum-Classical computations]
Let $\LAQCC(\mathcal{Q}, \mathcal{C}, d)$ be the class of circuits such that
\begin{itemize}
\item every quantum layer implements a quantum circuit $Q\in\mathcal{Q}$ constrained to a grid topology;
\item every classical layer implements a classical circuit $C\in\mathcal{C}$;
\item there are $d$ alternating layers of quantum and classical circuits;
\item after every quantum circuit $Q$ a subset of the qubits is measured;
\item the classical circuit receives input from the measurement outcomes of previous quantum layers;
\item the classical circuit can control quantum operations in future layers.
\end{itemize}
The allowed gates in the quantum and classical layers are given by $\mathcal{Q}$ and $\mathcal{C}$ respectively. 
Furthermore, we require a circuit in $\LAQCC(\mathcal{Q}, \mathcal{C}, d)$ to deterministically prepare a pure state on the all-zeroes initial state. 
\end{definition}

The grid topology imposed on the quantum operations implies that qubits can only interact with their direct neighbors on the grid. 
A circuit in $\LAQCC(\mathcal{Q}, \mathcal{C}, d)$ can use the results of the classical intermediate layers and control quantum operations in future layers. 
In a sense, information is fed forward in the circuit. Note, as classical computations are in general significantly faster than the quantum operations, we only count the quantum operations towards the depth of the circuit, unless specified otherwise.

\begin{remark}
Note that there exists ambiguity in the choices for $\mathcal{Q}$ and $\mathcal{C}$.
For example, we have $\LAQCC(\mathsf{QPoly}(n), \mathsf{P}, \mathO(1)) = \LAQCC(\QNC^0, \mathsf{P}, \mathO(\mathrm{poly}(n)))$. 
This follows as any $\mathsf{P}$-circuit is in $\mathsf{QPoly}(n)$, and we can concatenate $\mathrm{poly}(n)$ constant-depth quantum circuits with trivial intermediate classical computations. 

This ambiguity is non-trivial: consider for instance 
$$\LAQCC(\QNC^1, \NC^1, \mathO(1))\subseteq \LAQCC(\QNC^0, \NC^1, \mathO(\log(n))).$$ 
The inclusion from left to right follows immediately by same argument as above.
It is however not obvious if the logarithmic number of measurement rounds, allowed in the right hand side, can be simulated by a $\QNC^1$ circuit.
Even stronger, we will show in Section~\ref{sec:gates_created_in_LAQCC} that threshold gates are available in $\LAQCC(\QNC^0, \NC^1, \mathO(1))$. From this fact it follows immediately that any $\TC^1$-circuit is contained in $\LAQCC(\QNC^0, \NC^1, \mathO(\log(n)))$. 
It is unclear these circuits are also contained in $\LAQCC(\QNC^1, \NC^1, \mathO(1))$. 
\end{remark}

In the remainder of this work, we consider a specific instantiation of $\LAQCC(\mathcal{Q},\mathcal{C}, d)$.
\begin{notation}
We let $\LAQCC$ refer to the instance $\LAQCC(\QNC^0, \NC^1, \mathO(1))$, together with a grid nearest-neighbor topology and a quantum gate-set of all single-qubit gates and the two-qubit CNOT gate. 
The classical computations are bounded to logarithmic depth and of bounded-fan-in. 
\end{notation}
The class $\NC^1$ is a natural non-trivial class beyond constant-depth complexity classes.
As the depth of these circuits remains low, they can be implemented quickly. 
In this work, we assume qubits will not decohere during the classical computation.
Incorporating the errors throughout the whole $\LAQCC$-computation, including the classical intermediate computations, proves an interesting direction for future research.
Interesting, $\LAQCC$ contains many useful gates and subroutines already, as outlined in the next section, specifically the fan-out gate, implying directly that threshold gates are also contained in $\LAQCC$.

In its current definition, $\LAQCC(\mathcal{Q},\mathcal{C}, d)$, and hence also $\LAQCC$, are classes of circuits. 
When considering the capabilities of $\LAQCC(\mathcal{Q},\mathcal{C}, d)$ in preparing states, it is helpful to define a related class that consists of states preparable by a circuit in $\LAQCC(\mathcal{Q},\mathcal{C}, d)$. 
\begin{restatable}{definition}{StateClassX}
Let $\mathcal{H}_n$ be a Hilbert space on $n$ qubits, then define 
$$\mathsf{StateX}_{n,\varepsilon}=\{\ket{\psi}\in\mathcal{H}_n\mid \exists\, \mathsf{X}\text{-circuit }A:
\bra{\psi}A\ket{0}^{\otimes n} \ge 1-\varepsilon\}.$$

This is the subset of $n$-qubit states $\ket{\psi}$ such that there exists a circuit corresponding to the class~$\mathsf{X}$ that prepares a quantum state that has inner product at least $1-\varepsilon$ with $\ket{\psi}$. 

Define $\mathsf{StateX}_{\varepsilon} =\bigcup_{n\in\mathbb{N}}\mathsf{StateX}_{n,\varepsilon}$.
\end{restatable}
This definition extends already existing ideas and definitions of state-complexity~\cite{aaronson2020hardness,RosenthalYuen:2022,susskind2018lectures}. Our definition is very similar to state complexity defined in \cite{MetgerYuen:2023}, where we are interested in which states are contained in a class, however we drop the uniformity requirement and instead study the set of states that can be generated by a specific class of circuits.
An example of a circuit class is $\mathsf{State}$$\LAQCC(\mathcal{Q},\mathcal{C}, d)_{n,\varepsilon}$.
\begin{notation}
The class $\mathsf{State}$$\LAQCC(\mathcal{Q},\mathcal{C}, d)_{n,\varepsilon}$ consists of all $n$-qubit states $\ket{\psi}$ for which an $\LAQCC(\mathcal{Q},\mathcal{C}, d)$ exists that prepares a state that has inner product at least $1-\varepsilon$ with $\ket{\psi}$. 
\end{notation}

Another example is the circuit class of $\mathsf{PostQPoly}$. 
\begin{restatable}{definition}{PostQPolyDef}
\label{def:PostQPoly}
The class $\mathsf{PostQPoly}$ consists of all polynomial-sized quantum circuits with one extra qubit, where the outcome state is considered conditional on the extra qubit being in the one state. 
If the extra qubit is in the zero state, the output state may be anything. 

The class $\mathsf{StatePostQPoly}_{n,\varepsilon}$ consists of all $n$-qubit states $\ket{\psi}$ for which a polynomial-sized quantum circuit exists that prepares a state that, conditional on the extra qubit being one, has inner product at least $1-\varepsilon$ with $\ket{\psi}$. 
\end{restatable}

The next section shows that all polynomial-size Clifford circuits are in $\LAQCC$. 
As a result, the quantum fan-out gate is also in $\LAQCC$, a multi-qubit gate which enables many different subroutines (by applying Lemma~\ref{lem:unitar_parallelization}).
We give a list of such quantum gates and quantum subroutines accessible $\LAQCC$ in Section~\ref{sec:gates_created_in_LAQCC}. 
We conclude by showing that any $\LAQCC$-circuit corresponds to a $\QNC^1$-circuit.

\subsection{Clifford circuits}
\label{sec:clifford_circuits}
The concept of intermediate measurements with subsequent computations is closely related to measurement-based quantum computing. 
A famous result from measurement-based quantum computing us that all Clifford circuits can be paralellized using measurements. In this section we borrow techniques from this result to show that any Clifford circuit has an $\LAQCC$ implementation. 

This result is best understood in the teleportation based quantum computing model~\cite{jozsa2006introduction}, a specific instance of measurement-based quantum computing that applies quantum operations using bell measurements. 
In teleportation, qubits are measured in the Bell basis, which projects the measured qubits onto an entangled two-qubit, or ebit, state, up to local Pauli gates. This projection combined with an ebit state teleports a quantum state between qubits. After teleportation, one needs to correct the local Pauli gate created by the bell measurement. A similar process can be used to apply quantum gates. However, the Pauli gates that arise during teleportation have to be corrected before the calculations can proceed, which necessitates subsequent adaptive operations.

With Clifford circuits, these subsequent operations can be omitted. 
Clifford circuits stabilize the Pauli group, which allows for simultaneous measurements and hence parallelization of the full Clifford circuit~\cite{jozsa2006introduction}. 
Consider a simple example of teleporting a single-qubit quantum state. 
A Bell basis measurement projects two qubits on $\sum_{i\in \{0,1\}} \bra{ii}P^{a,b}\otimes I$, where $P^{a,b} = Z^a X^b$ and $a,b \in \{0,1\}$ correspond to the four possible measurement outcomes.

By using one Bell-basis measurement, we can apply two sequential Clifford gates $U_1$ and $U_2$ on a quantum state $\ket{\psi}$, which gives:
\begin{align*}
    \sum_{i, j\in \{0,1\}} \big[ (\bra{ii} (P^{a,b} \otimes I) \otimes I \big] U_1 \otimes I \otimes U_2 \ket{\psi}\ket{jj} &= \sum_{i,j \in \{0,1\}} \bra{i} P^{a,b} U_1 \ket{\psi} \braket{i}{j} U_2\ket{j}\\
    &=  \sum_{i \in \{0,1\}}  U_2\kb{i} P^{a,b} U_1 \ket{\psi} = U_2 P^{a,b} U_1\ket{\psi}.
\end{align*}
Note that besides projecting on a Bell state, an initial entangled Bell-state is required. 
$U_2$ is a Clifford gate, hence there exists a $P^{\hat{a},\hat{b}}$ such that $U_2 P^{a,b} U_1\ket{\psi} = P^{\hat{a},\hat{b}} U_2  U_1\ket{\psi}$, allowing the correction term to be pushed to the end of the circuit.
Repeating the same argument for multiple Clifford unitaries gives the quantum state $...P^{a_2,b_2}_2 U_2P^{a_1,b_1}_1 U_1\ket{\psi}$. 
Due to the conjugation relation of Clifford and Pauli gates, all correction terms can be postponed to the end of the computation. 

\subsubsection{Clifford-ladder circuit}
A similar argument holds when looking at \textit{Clifford-ladder circuits}. 
\begin{definition}[Clifford-ladder circuit]
Let $\{U^{i}\}_{i=0}^{n-1}$ be a collection of $n$ $2$-qubit Clifford unitaries. 
A Clifford-ladder circuit $C_{ladder}$ is a circuit of depth $\mathO(n)$ and width $\mathO(n)$ of the following form:
\[
C_{ladder} = \prod_{i=0}^{n-1} U^{(i)}_{i,i+1}
\]
where $U^{(i)}_{i,i+1}$ denotes that unitary $U^{(i)}$ is applied on qubits $i$ and $i+1$.
\end{definition}
Note that each 2-qubit Clifford unitary $U^{(i)}$ itself is of constant-depth. 

The next lemma shows that any Clifford-ladder circuit has an equivalent $\LAQCC$ circuit. 
Figure~\ref{fig:clifford_ladder} shows this mapping graphically.
Each two-qubit unitary is parallelized using gate teleportation and with the Clifford commutation relations, the Pauli correction terms are pushed to the end of the computation. 
\begin{lemma}
\label{lem:clifford_ladder}
Any Clifford-ladder circuit has an $\LAQCC$ implementation of depth $\mathO(1)$ and width $\mathO(n)$.
\end{lemma}
\begin{proof}
Figure~\ref{fig:clifford_ladder} shows the construction of a $\LAQCC$ circuit of width $\mathO(n)$ and depth $\mathO(1)$ implementing a Clifford-ladder circuit.
The caps and cups denote Bell-state measurements and Bell-state creation, respectively. 
What remains to show is that an $\NC^1$ circuit computes the Pauli-correction terms.

The $i$-th Bell measurement results in Pauli error $P_i = Z^{a_i}X^{b_i}$. 
A Clifford-ladder circuit of size $n$ hence has an error vector $\big(a\,b\big)$ of length $2n$. 
The correction terms that have to be applied have the same form: we can label every corrective Pauli by an index $j$, such that $\hat{P}_j = Z^{\hat{a}_j}X^{\hat{b}_j}$. 
This gives a correction vector $\big(\hat{a}\,\hat{b}\big)$. 
Note that Pauli matrices anti-commute, hence reordering them will only incur a global phase.
This implies a binary linear map $M:\big(a\,b\big)\mapsto\big(\hat{a}\,\hat{b}\big)$. 
As matrix vector multiplication is in $\NC^1$, this error calculation is in $\NC^1$ and Clifford-ladder circuits have an $\LAQCC$ implementation.
\end{proof}
% Figure environment removed

\begin{remark}
Constructing the binairy linear map $M$ is not in $\NC^1$, but it does follow directly from the quantum circuit.
Instead, an $\mathsf{L}$ (logspace) precomputation gives the matrix associated to $M$.
\end{remark}

This result directly implies that in $\LAQCC$ we can apply two-qubit gate on any two any non-adjacent qubits. 
\begin{corollary}
Any $SWAP$ circuit needed to do an operation between non-adjacent qubits is a Clifford-ladder circuit and hence in $\LAQCC$.

This effectively removes the locality constraint in $\LAQCC$ for applying a single $2$-qubit gate on non-adjacent qubits. 
\end{corollary}

An example of a Clifford-ladder circuit is the creation of a GHZ state. 
We can parallelize this directly, for instance following the poor man's cat state approach of~\cite{WattsKothariSchaefferTal:2019}. 
Figure~\ref{fig:q_circuit:GHZ_3_state} shows a $\LAQCC$ circuit using $2n-1$ qubits placed on a line that prepares an $n$-qubit GHZ state.
% Figure environment removed

\subsubsection{Clifford-grid circuit}
Any Clifford unitary can be mapped to a linear-depth circuit given a linear nearest-neighbor architecture~\cite{maslov2018shorter}. 
The most general representation of these circuits are so-called Clifford-grid circuits.
\begin{definition}[Clifford-grid circuit]
Let $n$ be the number of qubits. 
A Clifford-grid circuit of depth $d$ is a circuit of the form
\[
   C_{grid} =  \prod_{i=0}^{d}\bigotimes_{j=0}^{\frac{n}{2}}U_{i,j},
\]
for Clifford unitaries $U_{i,j}$ and such that gate $U_{i,j}$ acts on qubits $2j$ and $2j + 1$ if $i$ is even, and $2j+1$ and $2j+2$ is $i$ is odd. 
\end{definition}

The next lemma shows that Clifford-grid circuits also have an efficient $\LAQCC$ implementation. 
\begin{lemma}
Any Clifford-grid circuit of depth $\mathO(n)$ has an $\LAQCC$ implementation of depth $\mathO(1)$ and width $\mathO(n^2)$.
\label{lem:clifford_grid}
\end{lemma}
\begin{proof}
Similar to the Clifford-ladder circuits, gate teleportation allows parallelization to obtain a $\LAQCC$ circuit. 
With a total of $\mathO(n^2)$ Clifford gates, this also requires $\mathO(n^2)$ qubits. 
Figure~\ref{fig:clifford_grid} illustrates the transformation. 

Any Bell measurement in the circuit can incur a Pauli error, which has to be dealt with at the end of the circuit. 
The number of Pauli gates now scales with $\mathO(n^2)$. 
Similar to the Clifford-ladder circuits, there now is a vector $(a b)$ of length $\mathO(n^2)$ containing the information of the Pauli errors. 
The vector of correction terms, the vector $(\hat{a} \hat{b})$, has length $\mathO(n)$.

As these Pauli errors anti-commute, there again is a binary linear map $M: (a b)\mapsto (\hat{a}\hat{b})$. 
The corresponding matrix is rectangular and the error-correction calculations are in $\NC^1$.
\end{proof}
% Figure environment removed

Finding the matrix $M$ for correcting a Clifford-grid circuit is more complex than for a Clifford-ladder circuit. 
An error occurring in the grid can have multiple paths contributing to a single output wire. 
For the final correction, the parity of each contributing error-path is needed. 
This computation is in $\oplus\mathsf{L}\subseteq\NC^2$~\footnote{This is not too surprising as simulating Clifford circuits classically is a complete problem for $\oplus \mathsf{L}$}.
A precomputation again gives the matrix corresponding to the bilinear map $M$. 

\subsection{Useful gates and routines with an \texorpdfstring{$\LAQCC$}{LAQCC} implementation\label{sec:gates_created_in_LAQCC}}
This section groups useful multi-qubit gates with an $\LAQCC$ implementation.
The construction of $W$-states and Dicke states uses these gates, but their use might be of broader interest. 

The tables give the action of the gates on computational basis states. 
Their effect on arbitrary states follows by linearity. 
The tables also give the width of the implementation and a reference to the implementation.

The first two gates directly follow from the Clifford-parallelization results described in Section~\ref{sec:clifford_circuits}.  
\begin{table}[htb]
\centering
\begin{tabular}{l|l|l|l}
\textbf{Gate} & \textbf{Operation on basis states} & \textbf{Width} & \textbf{Implementation}\\
\hline
$\text{Fanout}_{n}$ & $ \ket{x}\ket{y_1}\hdots\ket{y_{n}} \mapsto\ket{x}\ket{y_1\oplus x}\hdots\ket{y_{n}\oplus x}$ & $\mathO(n)$ & Clifford-ladder circuit~\ref{lem:clifford_ladder} \\
Permutation$(\pi)_n$ &  $\ket{y_1}\hdots\ket{y_n} \mapsto \ket{y_{\pi(1)}}\hdots\ket{y_{\pi(n)}}$ & $\mathO(n^2)$ & Clifford-grid circuit~\ref{lem:clifford_grid}
\end{tabular}
\caption{Operations contained in $\LAQCC$ based on Clifford parallelization. 
Here $\pi\in S_n$ denotes a permutation of $n$ elements.}
\label{tab:Fanout_Perm}
\end{table}

Prior works extensively studied the fanout gate, for instance to construct a constant-depth $\text{OR}_n$ function with one-sided error~\cite{HoyerSpalek:2005} and with an exact implementation~\cite[Theorem~1]{TakahashiTani_CollapseOfHierarchyConstantDepthExactQuantumCircuits_2013}, both assuming the fanout gate to be a native gate.
The $\text{OR}_n$ gate also implies two other gates, as the following table shows.
\begin{table}[htb]
\centering
\begin{tabular}{l|l|l|l}
\textbf{Gate} & \textbf{Operation on basis states} & \textbf{Width} & \textbf{Implementation}\\
\hline
$\text{OR}_{n}$ & $ \ket{y_1}\hdots\ket{y_{n}} \ket{x} \mapsto\ket{y_1}\hdots\ket{y_n}\ket{\text{OR}_n(y)\oplus x}$ & $\mathO(n\log(n))$ & Appendix~\ref{gate:OR_implementation} \\
$\text{AND}_n$ &  $\ket{y_1}\hdots\ket{y_{n}} \ket{x} \mapsto\ket{y_1}\hdots\ket{y_n}\ket{\text{AND}_n(y)\oplus x}$ & $\mathO(n\log(n))$ & negate input and output of $\text{OR}_n$\\  
$\text{Equal}_i$ &  $\ket{j}\ket{b} \mapsto \begin{cases} \ket{j}\ket{1\oplus b} & \text{if } \ket{j} = \ket{i} \\
    \ket{j}\ket{b} & \text{else}
    \end{cases}$ & $\mathO(n\log(n))$ & negate part of input of $\text{AND}_n$ 
\end{tabular}
\caption{Operations contained in $\LAQCC$ based on Fanout and local $1$-qubit unitaries.}
\label{tab:Or_And_Equal}
\end{table}

With these unbounded-fan-in OR and AND gates, all $\AC^0$ circuits can be implemented. 
The next step is implementing $\LAQCC$-type modular addition circuits, which gives circuits to check for equality and greater-than. 
These three gates take $n$-qubit quantum states as input. 
We introduce the indicator variable $\mathbbm{1}_{A}$ for a Boolean expression $A$, which evaluates to $1$ if $A$ is true. 
Similarly, $\ket{\mathbbm{1}_{A}}=\ket{1}$ if and only if $A$ is true. 
\begin{table}[htb]
\centering
\begin{tabular}{l|l|l|l}
\textbf{Gate} & \textbf{Operation on $n$-qubit integers $\ket{x}$, $\ket{y}$} & \textbf{Width} & \textbf{Implementation}\\
\hline
$\text{Add}_{n}$ & $ \ket{x}\ket{y} \mapsto\ket{x}\ket{y + x \bmod 2^n}$ & $\mathO(n^2)$ & $\AC^0$ circuit \\
Equality &  $\ket{x}\ket{y}\ket{0}  \mapsto\ket{x}\ket{y}\ket{\mathbbm{1}_{x = y}}$ & $\mathO(n^2)$ & Appendix~\ref{gate:equality}\\  
Greatherthan &  $\ket{x}\ket{y}\ket{0} \mapsto \ket{x}\ket{y}\ket{\mathbbm{1}_{x > y}}$ & $\mathO(n^2)$ & Appendix~\ref{gate:greaterthan}
\end{tabular}
\caption{Operations contained in $\LAQCC$ based on $\AC^0$ circuits.}
\label{tab:Add_Equality_Greaterthan}
\end{table}

\citeauthor{HoyerSpalek:2005} showed that fanout-gates imply efficient constant-depth implementations of for instance the quantum Fourier transform~\cite{HoyerSpalek:2005}.
They use this constant-depth quantum Fourier transform to construct a constant-depth circuit for weighted counting. 
In particular, this circuit can be used to calculate the Hamming weight of an $n$-bit string, and to implement an ``Exact~$t$"-gate and a threshold gate. 
Appendix~\ref{gate:threshold_t} also explains how to modify the threshold gate to a weighted threshold gate. 
 \begin{table}[htbp]
\centering
\begin{tabular}{l|l|l|l}
\textbf{Gate} & \textbf{Operation on $n$-qubit basis state $\ket{x}$ } & \textbf{Width} & \textbf{Implementation}\\
\hline
$\text{QFT}$ & $\ket{x} \mapsto \frac{1}{\sqrt{2^{n-1}}}\sum_{j=0}^{2^{n-1}} e^{i 2 \pi \frac{x \cdot j}{2^n}}\ket{j}$ & $\mathO(n^3\log(n))$& \cite[Theorem~4.12]{HoyerSpalek:2005} \\
Hammingweight & $ \ket{x}_{n}\ket{0}_{\log(n)} \mapsto \ket{x}_n\ket{|x|}_{\log(n)} $& $\mathO(n\log(n))$ & \cite[Lemma~4]{TakahashiTani_CollapseOfHierarchyConstantDepthExactQuantumCircuits_2013} \\  
$\text{Exact}_t$ &  $\ket{x}\ket{0} \mapsto \ket{x}\ket{\mathbbm{1}_{|x| = t}}$ & $\mathO(n\log(n))$ & Appendix~\ref{gate:exact_t} \\
$\text{Threshold}_{t}$ &  $\ket{x}\ket{0} \mapsto \ket{x}\ket{\mathbbm{1}_{\sum_i x_i \ge t}}$ & $\mathO(t n \log(n))$ & Appendix~\ref{gate:threshold_t}
\end{tabular}
\caption{Quantum subroutines in $\LAQCC$ based on \citeauthor{HoyerSpalek:2005}.}
\label{tab:QFT_Hammingweight_Threshold}
\end{table} 

\begin{remark}
    As the $\text{Threshold}_{t}$ gate is in $\LAQCC$, any classical $\TC_0$ circuit is in $\LAQCC$.
\end{remark}

This section concludes not with a gate, but with a tool used for preparing uniform superpositions. 
This lemma extends Lemma~\ref{lem:exact_grover} to preparing states instead of finding marked items. 
\begin{lemma}\label{lem:grover_constant_fraction}
Given an $n$-qubit unitary $U$, that is implementable by a constant-depth circuit, a basis $\mathcal{C}$ and a partition of $\mathcal{C}$ in $\mathcal{G}$ and $\mathcal{B}$ such that $\frac{|\mathcal{G}|}{|\mathcal{C}|}$ is a known constant $c$. 
Suppose that $U$ implements the map
$$U:\ket{y}\ket{b}\mapsto\begin{cases}
\ket{y}\ket{b\oplus 1} & \qquad \text{if }y\in\mathcal{G} \\
\ket{y}\ket{b} & \qquad \text{if }y\in\mathcal{B} 
\end{cases}.$$
Then there exists a $\LAQCC$ circuit that prepares the state $\frac{1}{\sqrt{|\mathcal{G}|}}\sum_{y\in\mathcal{G}} \ket{y}$ by using $U$ a constant number of times.
\end{lemma}
\begin{proof}
Define $\ket{\mathcal{G}}=\frac{1}{\sqrt{|\mathcal{G}|}}\sum_{y\in\mathcal{G}}\ket{y}$ and $\ket{\mathcal{B}}=\frac{1}{\sqrt{|\mathcal{B}|}}\sum_{y\in\mathcal{B}}\ket{y}$. 
As $\mathcal{B}$ and $\mathcal{G}$ partition $\mathcal{C}$, it follows that $\braket{\mathcal{G}}{\mathcal{B}}=0$. Lemma~\ref{lem:exact_grover} implies the existence of a circuit that prepares the desired state. Below, we explicitly construct the circuit. 

First, prepare a uniform superposition $\sum_{i=0}^{2^n-1}\ket{i}$. 
Then, iteratively reflect over the state $\ket{\mathcal B}$ using $U$, and reflect over the uniform superposition state $\sum_{i=0}^{2^n-1}\ket{i}$. 
Both reflections have a $\LAQCC$ implementation and we only need to apply them a constant number of iterations. 

To reflect over the uniform superposition, we have to implement the operation $2\kb{s} - I$, with $\ket{s}=\frac{1}{\sqrt{N}}\sum_{i=0}^{2^n-1}\ket{i}$. 
To implement this operation, we first apply a layer of Hadamards, which implements a basis transformation mapping the uniform superposition state to the all zeroes state; Then apply the $\text{Exact}_0$-gate producing an output qubit that marks only the all zeroes-state and finally negate the output qubit and applies a $Z$-gate on it. Running this circuit in reverse, excluding the $Z$-gate, resets the output qubit and reverts the basis transformation. 
The last step of Lemma~\ref{lem:grover_constant_fraction} requires a reflection using an $R_Z$-gate (rotational $Z$-gate) instead of the $Z$-gate.
As the $\text{Exact}_0$-gate has an $\LAQCC$ implementation (see Table~\ref{tab:QFT_Hammingweight_Threshold}), this second inversion operation has a $\LAQCC$ implementation. 

The total number of iterations is $\mathO(\sqrt{N/m})$, where $N=|\mathcal{C}|$ and $m=|\mathcal{G}|$. 
As their fraction is the constant $c$, it follows that $\mathO(\sqrt{c})=\mathO(1)$ iterations are needed. 
\end{proof}

\subsection{Non-simulatability of \texorpdfstring{$\LAQCC$}{LAQCC}}
\label{sec:IQP_in_LAQCC}
Most of the power of $\LAQCC$ circuits seems to come from the classical intermediate calculations, which makes one wonder if these circuits are classically simulatable. 
Even if these circuits were indeed efficiently simulatable, they still have value as ``fast'' alternatives for state preparation.
However, it is unlikely that all $\LAQCC$ circuits can be simulated efficiently by a classical simulator. 
Lemma~\ref{lem:unitar_parallelization} and the inclusion of the fan-out gate in $\LAQCC$ show that circuits consisting of commuting gates have an $\LAQCC$ implementation and in particular, the class of Instantaneous Quantum Polynomial-time ($\mathsf{IQP}$) circuits, first introduced in~\cite{Shepherd2009}, has equivalent $\LAQCC$ implementations. 

\begin{definition}[Definition 2~\cite{Nakata_2014}]
An $\mathsf{IQP}$ circuit on $n$ qubits is a quantum circuit with the following structure: each gate in the circuit is diagonal in the Pauli-$Z$ basis, the input state is $\ket{+}^{\otimes n}$, and the output is the result of a measurement in the Pauli-X basis on a specified set of output qubits.
\end{definition}
\begin{lemma}
Any $\mathsf{IQP}$ circuit has an $\LAQCC$ implementation.
\end{lemma}
\begin{proof}
The following $\LAQCC$ circuit prepares the desired state:
First prepare $\ket{+}^{\otimes n}$ by a single layer of Hadamard gates on all qubits. 
In this basis, all gates in with respect to the Pauli-$Z$ basis commute, and hence by Lemma~\ref{lem:unitar_parallelization}, we can parallelize all gates using poly$(n)$ ancilla qubits. 
Next, we can again apply a layer of Hadamard gates and finally measure the desired qubits. 
\end{proof}

\citeauthor{Bremner2010} showed that efficient weak classical simulation of all possible IQP circuits up to small multiplicative error implies a collapse of the polynomial hierarchy~\cite{Bremner2010}. Note that a circuit family is weakly simulatable if given the description of the circuit family, its output distribution can be sampled by purely classical means in poly$(n)$ time.

\begin{lemma}[Corollary 1~\cite{Bremner2010}]
If the output probability distributions generated by uniform families of $\mathsf{IQP}$ circuits could be weakly classically simulated to within multiplicative error $1 \leq c < \sqrt{2}$ then the polynomial hierarchy would collapse to the third level, in particular, $\mathsf{PH} = \Delta^p_3$.
\end{lemma}

\begin{corollary}
If the output probability distributions generated by uniform families of $\LAQCC$ circuits could be weakly classically simulated to within multiplicative error $1 \leq c < \sqrt{2}$ then the polynomial hierarchy would collapse to the third level, in particular, $\mathsf{PH} = \Delta^p_3$.
\end{corollary}

\subsection{\texorpdfstring{$\LAQCC$}{LAQCC} containment in \texorpdfstring{$\QNC^1$}{QNC1}}
\label{sec:LAQCC_in_QNC1}
Let $A$ be an $\LAQCC$-circuit. 
We can write this circuit as a composition of unitary quantum layers $U_i$, measurements $M_i$ and classical calculation layers $C_i$:
$$A = M_k U_k C_k \dots M_i U_i C_i \dots M_1 U_1 C_1,$$
for some constant $k$. 
Any unitary $U_i$ is a $\QNC^0$ circuit and any $C_i$ is an $\NC^1$-circuit. 
The measurements $M_i$ can measure any subset of the qubits.
By the principle of deferred measurements, we can always postpone them to the end of the circuit using $CNOT$ gates and fresh ancilla qubits~\cite[Section~4.4]{nielsen_chuang_2010}, which gives the following lemma. 
\begin{lemma}
\label{lem:LAQCC_QNC1}
For any $\LAQCC$-circuit $A$ there is a $\QNC^1$-circuit $B$ without intermediate measurements that outputs the same state as $A$.
\end{lemma}
\begin{proof}
The $\LAQCC$-circuit $A$ contains classical computation layers $C_i$ that use the intermediate measurement results as input. 
These measurements can be delayed until the end of the circuit by applying a CNOT from the qubit to a fresh ancilla qubit.
This replaces the classical output wires by quantum wires. 

Lemma~\ref{lem:NC1toQauntum} shows that any $\NC^1$-circuit can be run on a log-depth quantum circuit with $\mathO(\mathrm{poly}(n))$ ancilla qubits. 
Hence, a $\QNC^1$-circuit without topology constraints can take the role of the classical intermediate circuits $C_i$.

Now, let $V_i$ be the quantum circuit implementing $C_i$.
Then the quantum circuit
$$B = U_k V_k \dots U_1 V_1$$
is a quantum circuit of logarithmic depth simulating $A$.
\end{proof}



\subsection{Complexity results for \texorpdfstring{$\LAQCC(\mathcal{Q}, \mathcal{C},d)$}{LAQCC(Q,C,d)}}
\label{sec:Complexity results}

In the definition of $\LAQCC(\mathcal{Q}, \mathcal{C},d)$, we have freedom to choose $\mathcal{Q}$ and $\mathcal{C}$. 
If we give more power to both the quantum and the classical routines, we see that we can solve more complex problems and prepare a wider variety of quantum states. 
Yet, even with polynomial depth quantum circuits and unbounded classical computational power, limits exist.

\begin{notation}
The class $\LAQCC^*$ is the instantiation $\LAQCC(\mathsf{QPoly}(n), \mathsf{ALL}, \mathrm{poly}(n))$:
The class of polynomially many alternating polynomial-sized quantum circuits and arbitrary powerful classical computations, together with feed-forward of the classical information to future quantum operations. 
The quantum computations are restricted to all single-qubit gates and the two-qubit CNOT gate. 
\end{notation}
This directly gives us a definition of $\mathsf{State}$$\LAQCC^*_{\varepsilon}$ for $\varepsilon>0$. 
\begin{remark}
Note that for any non-zero $\varepsilon$, we can restrict ourselves to finite universal gate-sets. 
The Solovay-Kitaev theorem~\cite{Kitaev1997,nielsen_chuang_2010} says that any multi-qubit unitary can be approximated to within precision $\delta$ by a quantum circuit with size depending on $\delta$. 
Therefore, with a finite universal gate-set, any $\LAQCC^*$ circuit with a continuous gate-set can be approximated by an $\LAQCC^*$ circuit with gates from the finite set. 
\end{remark}

Next, we prove $\mathsf{State}$$\LAQCC^*_{\varepsilon}\subseteq\mathsf{StatePostQPoly}_{\varepsilon}$. 
Following the same decomposition as in the previous section, we find that any $\LAQCC^*$ can be written as 
\begin{equation}
    \Pi_{i=0}^{\text{poly}(n)} M_i U_i(y_i) C_i(x_i)\ket{0}^{\otimes \text{poly}(n)},
\end{equation}
where again, $M_i$ denotes the $i$-th measurement layer, $U_i$ the $i$-th quantum layer and $C_i$ the $i$-th unbounded classical computation layer. 
The $x_i\in\{0,1\}^*$ denote the outcomes of $M_i$ and $y_i\in \{0,1\}^*$ the bitstring outputted by $C_i$. 
Note, all $x_i$ and $y_i$ have length at most polynomial in $n$. 

\begin{theorem}
\label{thm:state_prep_post-BQP}
It holds that $\mathsf{State}$$\LAQCC^*_{\varepsilon}\subseteq\mathsf{StatePostQPoly}_{\varepsilon}$.
\end{theorem}
\begin{proof}
Fix $\varepsilon>0$ and a positive integer $n$ and 
let $\ket{\psi}\in\mathsf{State}$$\LAQCC^*_{\varepsilon}$. 
By definition, there exists an $\LAQCC^*$ circuit $A=\Pi_{i=0}^{\text{poly}(n)} M_i U_i(y_i) C_i(x_i)$, which prepares a state $\ket{\phi}$ with inner product at least $1-\varepsilon$ with $\ket{\psi}$.

Then consider the following $\mathsf{PostQPoly}$-circuit:
Let $B=\Pi_{i=0}^{\text{poly}(n)} \text{Equal}_{x_i}(x_i)U_i(y_i)\ket{0}^{\otimes \text{poly}(n)}$, where the $y_i$ are hardwired. 
The Equal$_{x_i}$ gate replaces the measurement layer $M_i$, by checking if the subset of qubits that would be measured are in $\ket{x_i}$ computational basis state. It stores the output in an ancilla qubit. 
As a last step, apply an $\text{AND}_{\text{poly}(n)}$-gate on the ancilla qubits, which hold the outputs of the Equal$_{x_i}$ gates, and store the result in an ancilla qubit. 
Conditional on this last ancilla qubit being one, the circuit prepares the state $\ket{\phi}$.
\end{proof}

Figure~\ref{fig:laqcc_to_post_bqp} gives a schematic overview of the proof and the translation of an $\LAQCC^*$ circuit in a $\mathsf{PostQPoly}$-circuit. 
% Figure environment removed

\paragraph{Further complexity studies of \texorpdfstring{$\LAQCC$}{LAQCC}:}
An interesting direction for future work is to extend the inclusion proved above to a true separation or an oracular separation. 
One approach is to use a similar oracle as used in~\cite{AaronsonKuperberg:2007} to separate $\mathsf{QMA}$ and $\mathsf{QCMA}$ with respect to an oracle and use a counting argument to argue that $\mathsf{State}$${\LAQCC^*_{\varepsilon}}^{\mathcal{O}}\neq \mathsf{StatePostQPoly}_{\varepsilon}^{\mathcal{O}}$, for some oracle $\mathcal{O}$ and $\varepsilon=1-\frac{1}{\text{poly}(n)}$.

Another interesting direction for studying the state complexity of $\LAQCC$ is in the fact that the $\LAQCC$ model allows for a constant number, more than one, of rounds of measurements and corrections. This was required for our three new state generation protocols. However other models considered only one round of measurements and corrections, for instance in the paper \cite{Cirac:2021}. One may wonder if there is a hierarchy of model power allowing one or multiple measurements, and if there is a way to reduce the number of measurements rounds. A starting effort towards classifying types of states based on such a hierarchy can be found in \cite{Tantivasadakarn_2023}. It would be interesting to see a more extensive complexity theoretic analysis comparing models with different number of allowed rounds.

