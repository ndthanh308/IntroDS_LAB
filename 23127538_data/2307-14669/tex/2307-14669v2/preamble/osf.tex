\newif\ifcolors%
\newcommand{\with}{\&}
\renewcommand{\S}{\sortcol{\mathcal{S}}}
\newcommand{\F}{\featcol{\mathcal{F}}}
\newcommand{\V}{\tagcol{\mathcal{V}}}
\renewcommand{\ss}{(\S, \F, \isa)}
\newcommand{\fss}{(\S, \F, \fisa)}
\newcommand{\tax}{\poset[\isa][\S]}
\newcommand{\decs}{\poset[\isadec][\S]}
\newcommand{\ctax}{\poset[\isa][\coc[\S]]}

\newcommand\rtag{\mathop{\mathit{RootTag}}}
\newcommand\rsort{\mathop{\mathit{RootSort}}}

\definecolor{tagcol}{rgb}{0.72, 0.1, 0.26}
\definecolor{sortcol}{rgb}{0.06, 0.22, 0.61}
\definecolor{featcol}{rgb}{0.0, 0.45, 0.0}
\definecolor{relcol}{rgb}{0.8, 0.52, 0.0}
\definecolor{stringcol}{rgb}{0.1, 0.1, 0.1}

\newcommand{\s}[1][s]{\sortcol{#1}}
\newcommand{\su}[1][s]{\s[s']}
\newcommand{\cc}[1][c]{\s[c]}
\newcommand{\ci}[1][1]{\s[c_{#1}]}
\newcommand{\co}[1][0]{\s[c_{#1}]}
\newcommand{\cd}[1][2]{\s[c_{#1}]}
\newcommand{\cu}{\s[c']}
\newcommand{\si}[1][1]{\s[s_{#1}]}
\newcommand{\sii}[1][1]{\s_{\sortcol{#1}}^\ii}
\newcommand{\sgg}[1][1]{\s_{\sortcol{#1}}^\gg}
\newcommand{\sic}[1][1]{\s_{\sortcol{#1}}^{\ii[D]}}
\newcommand{\fcl}[1][D]{\F^*(#1)}
\newcommand{\siu}[1][1]{\s[s'_{#1}]}
\newcommand{\str}[1][s]{\strcol{\text{\lstinline|#1|}}}
\newcommand{\nat}[1][s]{\natcol{\text{\lstinline|#1|}}}
\newcommand{\bots}{\s[\bm{\bot}]}
\newcommand{\tops}{\s[\bm{\top}]}

\newcommand{\f}[1][f]{\featcol{#1}}
\newcommand{\fu}{\featcol{f'}}
\newcommand{\fj}[1][1]{\f[f_{#1}]}
\newcommand{\fjp}[1][1]{\f[f'_{#1}]}
\newcommand{\fji}[1][1]{\mymathcolor{featcol}{f}_{\mymathcolor{featcol}{#1}}^\ii}
\newcommand{\fjj}[1][1]{\mymathcolor{featcol}{f}_{\mymathcolor{featcol}{#1}}^\jj}
\newcommand{\fjg}[1][1]{\mymathcolor{featcol}{f}_{\mymathcolor{featcol}{#1}}^\gg}
\newcommand{\fjc}[1][1]{\mymathcolor{featcol}{f}_{\mymathcolor{featcol}{#1}}^\canon}
\newcommand{\fto}{\xrightarrow{\f}}
\newcommand{\fti}[1][1]{%
    \ensuremath{\f[f_{#1}] \to t_{#1}}
}
\newcommand{\X}[1][X]{\tagcol{#1}\xspace}
\newcommand{\Y}[1][Y]{\X[#1]}
\newcommand{\Z}[1][Z]{\X[#1]}
\newcommand{\Xj}[1][1]{\tagcol{X_{#1}}}
\newcommand{\Yj}[1][1]{\tagcol{Y_{#1}}}
\newcommand{\Zj}[1][1]{\tagcol{Z_{#1}}}
\NewDocumentCommand{\xs}{O{X} O{s}}{%
    \ensuremath{\tagcol{#1}:\sortcol{#2}}
}
\newcommand{\osfterm}{%
    \ensuremath{\xs(\fti, \ldots, \fti[n])}
}
\newcommand{\psiterm}{%
  \ensuremath{\xs(\fj[1]\to\psi_1, \ldots, \fj[n]\to\psi_n)}
}

\newcommand{\osfwith}{\;\with\;}
\NewDocumentCommand{\osfce}{O{\X} O{\X[X']}}{%
    \ensuremath{#1 \doteq #2}
}
\newcommand{\fail}{\ensuremath{\mathit{fail}}\xspace}
\newcommand{\nullv}{\ensuremath{\mathit{null}}\xspace}
\NewDocumentCommand{\osfcf}{O{\X} O{\f} O{\X[X']}}{%
    \ensuremath{#1.#2 \doteq #3}
}

\newcommand{\gstick}{\rule[-1.5ex]{0pt}{4ex}}
\newcommand{\rulename}[1]{%
  \ifcolors \bluebf{#1}%
  \else     \textbf{#1} \fi
}
\newcommand{\osfref}[1]{\rulename{\ref{#1}}}

\newcommand{\osfrule}[4][0pt]{\ensuremath{%
\begin{array}[t]{ll}
                 & \rulename{#2}         %
\\ %
                 & #3             %
\\               \cmidrule(r{#1}){2-2}   %
                 & #4             %
\end{array}}}

\newcommand{\osfrulec}[5][0pt]{\ensuremath{
\begin{array}[t]{ll}
                 & \rulename{#3}         %
\\ %
 & \multicolumn{1}{l}{\left[#2\right]}   %
\\ \\
                 & #4\gstick             %
\\               \cmidrule(r{#1}){2-2}   %
                 & #5\gstick             %
\end{array}}}

\renewcommand{\osfrulec}[5][0pt]{\ensuremath{
\begin{array}[t]{lll}
   & \rulename{#3} &                                    %
\\
& #4     &  \multirow{2}{*}{$\left[#2\right]$} %
\\
\cmidrule(r{#1}){2-2}                                %
   & #5     &                                    %
\end{array}}}

\newcommand{\sym}{\vdash}
\newcommand{\fosfrule}[6][0pt]{\ensuremath{%
\begin{array}[t]{lll}
                 & \multicolumn{2}{l}{\rulename{#2}} %
\\ %
                 & #3 & \sym #5\gstick             %
\\               \cmidrule(r{#1}){2-2}   %
                 & #4 & \sym #6\gstick             %
\end{array}}}

\newcommand{\fosfrulec}[7][0pt]{\ensuremath{
\begin{array}[t]{llll}
   & \multicolumn{2}{l}{\rulename{#3}} &                                    %
\\
   & &               & \multirow{2}{*}{$\left[#2\right]$} %
\\ & #4 & \sym #6\gstick     &                                    %
\\ \cmidrule(r{#1}){2-2}                                %
   & #5& \sym #7\gstick     &                                    %
\end{array}}}

\newcommand{\iljm}[1]{%
    \ensuremath{
    \mathchoice
    {\text{\mintinline{java}{#1}}}
    {\text{\mintinline{java}{#1}}}
    {\text{\scriptsize\mintinline{java}{#1}}}
    {\text{\mintinline{java}{#1}}}
}}
\newcommand{\ilp}[1]{\mintinline{python}{#1}}
\renewcommand{\iljm}[1]{\ensuremath{\texttt{#1}}}
\newcommand{\code}     [1]{#1\iljm{.code}}
\newcommand{\sortindex}[1]{#1\iljm{.index}}
\newcommand{\coded}    [1]{#1\iljm{.coded}}
\newcommand{\parents}[1]{\mathit{Parents}(\textcolor{sortcol}{#1})}
\newcommand{\children}[1]{\mathit{Children}(\textcolor{sortcol}{#1})}
\newcommand{\osfeq}{\mathop{\mathit{Eq}}} %
\newcommand{\solved}{\mathop{\mathit{Solved}}}
\newcommand{\features}{\mathop{\mathit{Features}}}
\newcommand{\appropr}{\mathop{\mathit{Appropr}}}
\newcommand{\tags}{\mathop{\mathit{Tags}}}
\newcommand{\osftags}{\mathop{\mathit{Tags}}}
\newcommand{\sort}{\mathbin{\mathit{Sort}}}
\newcommand{\bor}{\textsf{OR}\xspace}
\newcommand{\bi}{\textsf{1}\xspace}
\newcommand{\bo}{\textsf{0}\xspace}

\newcommand{\ii}{\mathcal{I}}
\newcommand{\jj}{\mathcal{J}}
\newcommand{\kk}{\mathcal{K}}
\renewcommand{\gg}{\mathcal{G}}
\renewcommand{\jj}{\mathcal{J}}
\newcommand{\iimod}{\ii, \alpha \models}
\newcommand{\iimodb}{\ii, \alpha \models_{\beta}}
\newcommand{\dom}[1][\ii]{\varDelta^{{#1}}}
\newcommand{\obj}[1]{\mathit{#1}}
\newcommand{\osfa}{(\dom, \cdot^\ii)}
\newcommand{\osfg}{(\dom[\gg], \cdot^\gg)}
\NewDocumentCommand{\denot}{O{t} O{\ii}}{[\![#1]\!]^{#2}}
\NewDocumentCommand{\denota}{O{t} O{\alpha}}{[\![#1]\!]^{\ii,#2}}
\NewDocumentCommand{\denoti}{O{t} O{\ii} }{[\![#1]\!]^{#2,\alpha}}
\newcommand\dblwr{\wr\mkern-2mu\wr}
\newcommand{\adenot}[1][t]{\mathopen{\dblwr}{#1}\mathclose{\dblwr}^{\ii}}

\newcommand{\PhiR}{\ensuremath\Phi_{R}}
\newcommand{\osfval}{\alpha:\V\to\dom}
\newcommand{\val}{\mathit{Val}}
\newcommand{\reach}{\mathrel{\overset{\phi}{\rightsquigarrow}}}

\newcommand{\ograph}{\ensuremath(N, E, \lambda_N, \lambda_E, \X)}
\NewDocumentCommand{\tgraph}{O{f} O{g}}{G(\Z_{\f[#1],#2}:\tops)}
\NewDocumentCommand{\tvar}{O{f} O{g}}{\Z_{\f[#1],#2}}
\newcommand{\pshi}{\psi_{\phi}}
\newcommand{\psig}{\psi_{G}}
\newcommand{\canon}[1][\phi]{\gg[\dom[\gg,#1]]}
\newcommand{\gequiv}{\equiv}

\newcommand{\approximates}[1][\gg]{\sqsubseteq^{#1}}
\NewDocumentCommand{\fapproximates}{O{\gg}}{\mathop{\sqsubseteq^{#1}}}
\NewDocumentCommand{\fapprel}{O{\gg} O{\beta}}{\mathbin{\sqsubseteq^{#1}_{#2}}}
