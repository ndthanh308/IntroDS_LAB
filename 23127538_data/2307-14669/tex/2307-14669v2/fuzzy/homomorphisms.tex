\section{Fuzzy \osf algebra homomorphisms}%
\label{sec:homomorphisms}

In this section we introduce fuzzy $\beta$-homomorphisms, mappings between
fuzzy \osf interpretations that preserve feature applications
and, to some degree,
the sorts of the elements of the domain.
Fuzzy $\beta$-morphisms allow us to prove several
results regarding the satisfaction of \osf clauses in fuzzy \osf
interpretations. In particular, we prove that the \osf graph algebra $\gg$
is canonical
in the sense that any \osf clause is satisfiable if and only if it is
satisfiable in $\gg$. We also prove that the denotation of a normal \osf
term $\psi$ in a fuzzy \osf interpretation can be characterized through the
existence of fuzzy homomorphisms from the subalgebra of $\gg$ generated by
$G(\psi)$.
In the next section, $\beta$-morphisms will be used to define a fuzzy
ordering on the domain of any fuzzy \osf interpretation,
which will eventually lead to the fuzzy subsumption ordering
between \osf terms.

\begin{definition}[Fuzzy \osf algebra $\beta$-homomorphism]
\label{def:osf_algebra_homomorphism}
  A \textit{$\beta$-morphism}
  (or \textit{$\beta$-homomorphism})
  $\gamma:\ii\to\jj$
  between two fuzzy \osf interpretations $\ii$
  and $\jj$ is a function $\gamma:\dom\to\dom[\jj]$ such that,
    for all $\f\in\F$, all $\s\in\S$, and all $d\in\dom$:
    $\gamma(\f^\ii(d)) = \f^\jj(\gamma(d))$ and
      $\s^\ii(d)\land \beta \leq \s^\jj(\gamma(d))$.
\end{definition}

Our definition of fuzzy \osf algebra $\beta$-morphism generalizes the
analogous crisp one from \cite{AitKaci1993b}. The condition on features
is unchanged: a $\beta$-morphism must preserve the structure of the input
algebra $\ii$, i.e., it must commute with function
applications. The original
crisp condition on sorts states that, whenever $d$ is an element of the
interpretation of $\s$ in $\ii$, then its image $\gamma(d)$ must be an
element of the interpretation of $\s$ in $\jj$. A direct fuzzy
generalization of this statement would specify that, for all
$\s\in\S$ and $d\in\dom[\ii]$,
\begin{align}
  \label{eq:morphism_direct}
  \s^\ii(d)\leq\s^\jj(\gamma(d)).
\end{align}
Similarly to our definition of a fuzzy subsumption relation,
we further generalize
this constraint by requiring that, in order for $\gamma$ to be a
$\beta$-morphisms, whenever $d$ is a member of $\s^\ii$ with degree
$\beta_0$, then $\gamma(d)$ must be a member of $\s^\jj$ with degree
greater than or equal to the minimum of $\beta$ and $\beta_0$. Clearly
\cref{eq:morphism_direct} is recovered simply by setting $\beta = 1$.

\begin{example}[Fuzzy \osf algebra $\beta$-homomorphism]
\label{ex:algebra_morphism}
  Consider
  the fuzzy interpretation $\ii$,
  the assignment $\alpha$
  and
  the term $t = \X:\thriller \left( \dirby \to \Y:\director \right)$
  from \cref{ex:osf_term_denotaion}. Consider the
  subalgebra of $\gg$ generated from the element $G(t)$ and define a
  function $\gamma:\dom[{\gg[G(t)]}] \to \dom[\ii]$ by setting, for $g =
  w^\gg(G(t))\in\dom[{\gg[G(t)]}]$, $\gamma(g) \defeq w^\ii(\halloween)$,
  where $w\in \F^*$. In particular we have $\gamma(G(t)) = \halloween$ and
  $\gamma(G(\Y:\director)) = \carpenter$. This is easily verified to be a
  $\appdegree$-morphism.
  This is depicted in \cref{fig:algebra_morphism} (where trivial graphs are
  not shown, and some names have been shortened).
\end{example}
\input{figures/beta_morph}

\begin{restatable}%
  [{\protect\hyperlink{proof:homs}{Homomorphisms}}]%
  {prop}{prophoms}
\label{prop:homs}
Let $\gamma:\ii\to\jj$ be a $\beta$-morphism.
\begin{enumerate}
  \item If $\gamma':\jj\to\kk$ is a $\beta'$-morphism, then
    $\gamma'\circ\gamma:\ii\to\kk$ is a $\beta\land\beta'$-morphism.
  \item For all $\beta'\leq\beta$: $\gamma$ is a $\beta'$ morphism.
  \item There is a maximum $\beta'$ such that $\gamma$ is a
    $\beta'$-morphism.
\end{enumerate}
\end{restatable}

In general it is not true that, for any fuzzy
interpretations $\ii$ and $\jj$,
there is a maximum $\beta$ such that there exists a $\beta$-morphism
$\gamma:\ii\to\jj$.
This property -- which will be valuable later  -- holds
however for specific
homomorphisms relating subalgebras generated by singletons.
\myrestatable%
  {{Homomorphisms originating from singletons}} %
  {prop} %
  {prop:homsel} %
  {proof:homsel} %
  {prophomsel} %
  {%
  Let $\ii$ and $\jj$ be fuzzy \osf interpretations and fix $d\in\dom$. Let
  $\gamma:\ii[d]\to\jj$ be a $\beta$-morphism.
  \begin{enumerate}
    \item
      For every $d'\in\ii[d]$, $\gamma(d')$ is an element of
      the domain of $\jj[\gamma(d)]$, i.e.,
      $\gamma:\ii[d]\to\jj[\gamma(d)]$.
    \item For any $\beta'$-homomorphism $\gamma':\ii[d]\to\jj$: if
      $\gamma'(d) = \gamma(d)$, then $\gamma = \gamma'$, i.e., for all
      $d'\in\dom[{\ii[d]}]$, $\gamma(d') = \gamma'(d')$.
    \item
      There is a maximum
      $\beta'$ such that there exists a $\beta'$-morphism
      $\gamma':\ii[d]\to\jj$ that satisfies $\gamma'(d) = \gamma(d)$.%
  \end{enumerate}%
  }

As should be expected, the satisfiability of an \osf clause is preserved
(modulo degree $\beta$) under \osf algebra $\beta$-morphisms.

\myrestatable%
  {Extending solutions}
  {prop}
  {thm:extending}
  {proof:extending}
  {thmextending}
  {%
    Let $\ii$ and $\jj$ be two fuzzy \osf
    interpretations and $\gamma:\ii\to\jj$
    be a $\beta$-morphism. For every \osf clause $\phi$ and assignment
    $\alpha:\V\to\dom$, if
    $\iimod_{\beta_\ii}\phi$, then
    $\jj,\gamma\circ\alpha\models_{\beta_\ii\land\beta}\phi$.%
  }

An interesting property that carries over from crisp \osf logic
\cite{AitKaci1993b} is that it is always possible to define a
$\beta$-morphism from any fuzzy interpretation $\ii$ into the
fuzzy \osf graph algebra for some positive \mbox{degree
$\beta$.}

\begin{restatable}%
  [{\protect\hyperlink{proof:finality}
    {Fuzzy morphisms into {$\gg$}}}]%
  {theorem}{thmfinality}
\label{thm:weak_finality}
For any fuzzy \osf interpretation $\ii$ there exists a
$\beta$-homomorphism into the fuzzy \osf graph algebra $\gg$ for some
$\beta\in(0,1]$.
\end{restatable}

The following corollary follows directly from the last result and
\cref{thm:extending}.
\myrestatable%
  {Canonicity of {$\gg$}}
  {corollary}
  {cor:canonicity}
  {proof:canonicity}
  {corcanonicity}
  {%
  An \osf clause is satisfiable if and only if it is satisfiable in the
  fuzzy \osf graph algebra.%
  }

Another interesting property is that
any solution $\alpha$ for a clause $\phi$ in any fuzzy
interpretation $\ii$
can be obtained as a homomorphism from the canonical graph algebra induced
by $\phi$, as stated next.
An example of the application of this theorem was given in
\cref{ex:algebra_morphism}.

\begin{restatable}%
  [{\protect\hyperlink{proof:extracting}{Extracting solutions}}]%
  {theorem}{thmextracting}
\label{thm:extracting}
  For any solved \osf clause $\phi$, fuzzy interpretation
  $\ii$, assignment
  $\alpha:\V\to\dom$ and $\beta\in(0,1]$ such that $\iimodb\phi$
  there exists an \osf algebra
  $\beta$-homomorphism $\gamma:\canon\to\ii$ such that $\alpha(\X) =
  \gamma(G(\phi(\X)))$ for each $\X\in\osftags(\phi)$.
\end{restatable}

Thanks to \cref{prop:equivalence_terms_constraints,thm:extracting} we can
show that the denotation
of a normal \osf term $\psi$ in a fuzzy \osf interpretation can be
characterized through the existence of fuzzy homomorphisms from the
canonical graph algebra induced by $G(\psi)$.
\begin{restatable}%
  [{\protect\hyperlink{proof:interpretability}
  {Denotation of $\psi$-terms via fuzzy morphisms}}]%
  {theorem}{thminterpretability}
\label{thm:interpretability}
  Let $\psi$ be a normal \osf term, let $\phi = \phi(\psi)$ and
  let $\ii$ be a fuzzy \osf interpretation. Then, for all
  $d\in\dom$
    and $\beta\in(0,1]$:
  \[
    \denot[\psi](d) \geq\beta \;\Iff\;~\text{there is a $\beta$-morphism}~
    \gamma:\canon\to\ii~\text{such that}~d=\gamma(G(\psi))
  \]
  and thus
    $\denot[\psi](d) =
    \sup(\{ \beta\in[0,1]
    \mid \exists\text{$\beta$-morphism}~
  \gamma:\canon\to\ii~\text{such that}~d=\gamma(G(\psi)) \})$.
\end{restatable}
