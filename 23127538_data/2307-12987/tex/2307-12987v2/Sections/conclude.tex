\section{Conclusion}\label{sec: conclude}

Multi-agent market model enables the market simulation of stock trading by creating an environment 
where multiple agents spontaneously trade and interact over an order book. 
In this paper, 
we study calibrating the agent variable of the model in order to generate the order flow of any historical trading day. 
Traditional calibration approaches are inefficient because they rely on the iterative search algorithm. 
For the first time, We propose \sysname{}, 
the search-free approach that calibrates the multi-agent market model using deep learning. 
\sysname{} uses a novel surrogate-trading loss function to address the non-differentiable issue of the multi-agent model 
and employs a condition-aware variable estimator to correlate the agent variable and market condition, enhancing the explainbility of the calibration and simulation. 
We have conducted large-scale experiments and verified \sysname{} in the order-book level data of the A-share market over a whole year. 
\sysname{} has demonstrated comparable simulation accuracy with the search-based calibration approaches without any need of variable search, achieving less than 0.36 Kolmogorovâ€“Smirnov statistic of simulation accuracy.
Through case studies, \sysname{} can effectively capture the correlation between the agent variable and multiple indexes of market conditions, including PPI, PMI, CPI, market trend and market noise. 

Our future work will focus on how to leverage the trading simulation to improve the return of an untested trading strategy. 
Specifically, we may consider an enhanced calibration approach to adversely trade against the trading strategy, 
understanding the strategy under different scenarios. 


\iffalse

Fintech multi-agent market simulation mimics both investor behavior and their interactions,
which is catching increasing attention in the field of quantitative finance.
To reconstruct the order flow of a specific period,
the multi-agent system requires a calibration of agent behaviors~(behavior variables).
The existing calibration approaches for multi-agent simulation are search-based,
which is inefficient and suffers the scalability issue in extensive experiments that the industry usually necessitates.
Furthermore,
they have not fully considered the redundancy issue of calibration, where multiple behavior parameters can lead to similar order flows,
resulting in the simulation results being unstable, unconvincing, and hard to interpret. 

In this paper,
we propose \sysname{},
the first search-free {\bf cali}bra-tion approach for {\bf m}ulti-{\bf a}gent {\bf s}imulation, considering market states.
\sysname{} leverages the features from order flows to reconstruct the order flows 
and use market states to reduce redundancy in calibration.
Specifically,
\sysname{} uses a novel state-aware calibration model that employs a meta-design to consolidate order flow and market state for calibration, 
and proposes two consistency constraints (temporal and market-state constraints) to train the calibration model. 
To tackle the non-differentiability issue, arising from the sampling nature of multi-agent systems, we propose a surrogate trading system. 
We have conducted extensive experiments~(the largest, to the best of our knowledge, on calibration research for fintech multi-agent simulation) to verify our approach by market replay and a case study.
The experimental results of market replay show that \sysname{}
can reconstruct order flows comparably with the search-based approach while observing consistent and interpretable behavior variables.
The case study shows that \sysname{} can capture some patterns of real markets in calibration. 


To enable the simulation that reflects reality, 
the agents need careful calibration of their behaviors.
% where the agents require calibration on behavior parameters.
Existing calibration approaches heuristically search behavior parameters 
for reproducing the target order stream.
However, failing to accumulate calibration episteme, 
existing approaches undergo the tedious searching process, independently, for each trading day, 
making their applications hard to scale up.
Furthermore, due to the randomness and dynamics of the system, 
it is possible that more than one sets of parameters~(redundancy) contribute to similar order streams --
% which may lead to false calibration that jeopardizes further interventional studies on the simulation system.
% leading to different simulation results with further interventional studies, such as trading strategy back-testing.
these parameters can perform differently with further interventional studies, such as trading strategy back-testing, 
making simulation unstable and random.

In this paper,
we aim to build a calibration system without parameter searching.
Since behavior parameters dominate the simulation system, resulting in the generated order streams,
we can explore behavior information from the target order stream for reproduction,
which captures the calibration knowledge between trading days.
To tackle the parameter redundancy, 
we argue that calibration should observe some patterns of the real market and propose two consistency rules:
temporal and market state consistency.
% In this paper, 
% we argue that calibration on the multi-agent simulation should comply with some market regularities.
% We observe that the overall behaviors of the market participants are dependent over time; thus,
% we propose two  consistency rules besides order stream reproduction: temporal and market state consistency.
To enforce the observations, 
we propose \sysname{}, a behavior-consistent calibration system for multi-agent simulation.
\sysname{} is the first searching-free calibration system that directly 
analyzes order stream and market states to produce behavior parameters in an end-to-end manner.
To achieve calibration generality to unseen trading days, 
% \sysname{} jointly considers order stream and market state by a meta-market.
\sysname{} is designed based on meta-learning and trained 
by a proposed surrogate trading system. 
To observe the two consistency rules,
we propose a consistency loss function.
% and a consistency loss function, respectively,
% facilitating the meta-market to learn to reproduce while observing behavior consistency.
% \sysname{} accumulates historical episteme  on calibration by training once and can be applied to unseen scenarios.
We have conducted large-scale experiments~(the largest, to the best of our knowledge) to verify our approach by market replay and case studies.
The experimental results of market replay show that \sysname{}
can achieve similar order stream reproduction while observing the consistency rules.
 The case studies show that \sysname{} can reflect some patterns of the real market.



fail to consider the dependency of behavior over time, 
which makes the simulation possibly deviate from reality.
In this paper, 
we calibrate behaviors based on the observation 
that
\fi
