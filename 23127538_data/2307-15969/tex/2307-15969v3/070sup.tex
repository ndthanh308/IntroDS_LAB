% !TeX root = main. tex
\begin{proof}[Proof of Corollary 1]
     For DkS, we set $|\subnode|=k$, it has an upper bound as follows:
        \begin{equation*}
            \footnotesize
            \begin{aligned}
                \rho( \subnode) &=\frac{\sum_{e \in \edges(\subnode)} w_e}{|\subnode|}=\frac{\sum_{e=(u,v),\,u,v\in \subnode} f_e(u)+f_e(v)}{|\subnode|}\\
                &\le\frac{\sum_{e=(u,v),\,u,v\in \subnode}{(f_e(u)+f_e(v))}+\sum_{e=(u,v),\,u\in \subnode,v\not\in \subnode}{f_e(u)}}{|\subnode|}\\
                &=\frac{\sum_{u\in \subnode}{\sum_{e\ni u}{f_e(u)}}}{|\subnode|}=\frac{\sum_{u\in \subnode}{l_u}}{|\subnode|}\\
                &=\frac{\sum_{i=0}^{j-1}{\lambda_{i}*|B_i|}+(k-|B_{j-1}|)*\lambda_{j}}{k}\\
            \end{aligned}
        \end{equation*}
    Therefore, result 2 holds up. As for result 1, if $k=|B_j|$, according to property 3 the equivalency condition in line 2 holds up because $f_e(u)=0$ if $u\in\subnode$ and $v\not\in\subnode$, then result 1 holds up. These
    results also hold up for DalkS because if $|S|>k$, it will add more nodes into $\subnode$ with lower upper bounds on their loads.
\end{proof}


Before proofs of Lemma 2, we introduce the definition of $k$-core from \cite{seidman1983network}: $k$-core is the maximal subgraph $G_k$ in graph G, the degree of where any vertex $v$ in $G_k$ is satisfied with $\setndeg{G_k}{v} \ge k$.

\begin{proof}[proof of Lemma 2]
    The Greedy algorithm just moves any node whose degree is the lowest in the remaining graph $\mathcal{H}$. Let us remark $A(k)$ as the nodeset of k-core for specific k. We claim that when deleting a node $u\in A(k)$, there mustn't be any node $v\not\in A(k)$ in the remaining graph $\mathcal{H}$. We prove it by way of contradiction, w.l.o.g,  we set $u$ as the first node to be deleted in $A(k)$ in Greedy, therefore $u$ has the lowest degree in $\mathcal{H}$ and $\setndeg{\mathcal{H}}{v}\ge \setndeg{\mathcal{H}}{u}\ge \setndeg{A(k)}{u}\ge k$ for any node $v$ in $\mathcal{H}$, which produces a k-core subgraph with a larger size, and it leads to a contradiction.
\end{proof}


\begin{proof}[Proof of Theorem 5]
     We set $\mathcal{H}_k (k>0)$ is the remaining graph after k iterations in Algorithm 2 and $\mathcal{H}_0$ is the initial whole graph, $\mathcal{H}_{k+1}^{'}$ is the nodeset to be deleted in k+1 iteration. Therefore, $\mathcal{H}_{k+1}=\mathcal{H}_{k} \setminus \mathcal{H}_{k+1}^{'}$,
     
     \begin{equation*}
         \begin{aligned}
            \rho(\mathcal{H}_{k+1})
            &=\rho(\mathcal{H}_{k}\setminus \mathcal{H}_{k+1}^{'}) \\
            &=\frac{\weights(\edges(\mathcal{H}_{k}))-\weights(\edges(\mathcal{H}_{k+1}^{'}))}{|\mathcal{H}_{k}|-|\mathcal{H}_{k+1}^{'}|}\\
            &\ge\frac{\rho(\mathcal{H}_{k})\cdot |\mathcal{H}_{k}|-\sum_{v \in \mathcal{H}_{k+1}^{'}}{\setndeg{\mathcal{H}_k}{v}}}{|\mathcal{H}_{k}|-|\mathcal{H}_{k+1}^{'}|}\\
            &> \frac{\rho(\mathcal{H}_{k})\cdot |\mathcal{H}_{k}|-\sum_{v \in \mathcal{H}_{k+1}^{'}}{\rho(\mathcal{H}_{k})}}{|\mathcal{H}_{k}|-|\mathcal{H}_{k+1}^{'}|}\\
            &=\frac{\rho(\mathcal{H}_{k})\cdot |\mathcal{H}_{k}|-\rho(\mathcal{H}_{k})\cdot |\mathcal{H}_{k+1}^{'}|}{|\mathcal{H}_{k}|-|\mathcal{H}_{k+1}^{'}|}\\
            &=\rho(\mathcal{H}_{k})
         \end{aligned}
     \end{equation*}

    That means the density of graph $\mathcal{H}$ monotonically increases in iterations, then any deleted node has a lower degree (when it is being deleted) than the final density, i.e., $\delta$. Therefore, the remaining graph $\mathcal{H}$ is a $\delta$-core and it is the graph of some time of the greedy search according to Lemma 2. 

    We claim that the process before getting the $\delta$-core is a monotonic increasing phase of density in Greedy. We can confirm two facts:
    \begin{enumerate}[label={\arabic*.}]
    \item During Greedy, if there is a node $u\in\mathcal{H}_{1}^{'}$ existing in the remaining graph, the deletion in Greedy will increase the density of the remaining graph. That's because if Greedy deletes a node $v\not\in \mathcal{H}_{1}^{'}$, then $\setndeg{\mathcal{H}}{v}\le \setndeg{\mathcal{H}}{u}<\rho(\graph)\le\rho(\mathcal{H})$. $\rho(\mathcal{H})$ will increase and $\rho(\graph)\le\rho(\mathcal{H})$ still holds up. If Greedy deletes the node $u$, now that $\setndeg{\mathcal{H}}{u}\le \rho(\mathcal{H})$, then $\rho(\mathcal{H})$ will also increase and $\rho(\graph)\le\rho(\mathcal{H})$ holds up.
    \item During Greedy, if there is a node $u\in\mathcal{H}_{k+1}^{'}$ existing in the remaining graph $\mathcal{H}>\mathcal{H}_k$, and there isn't any node belonging to $\mathcal{H}_{k}^{'}$. Then: $\rho(\mathcal{H})\ge\rho(\mathcal{H}_k)$ because we delete more nodes with lower degrees. Therefore, when we deletes a node $v\not\in\mathcal{H}_{k+1}^{'}$, then $\setndeg{\mathcal{H}}{v}\le \setndeg{\mathcal{H}}{u}<\rho(\graph)\le\rho(\mathcal{H}_{k})\le\rho(\mathcal{H})$, then $\rho(\mathcal{H})$ will increase and $\rho(\graph)\le\rho(\mathcal{H})$ holds up. If Greedy deletes the node $u$, now that $\setndeg{\mathcal{H}}{v}\le\rho(\mathcal{H})$, $\rho(\mathcal{H})$ will also increase and $\rho(\graph)\le\rho(\mathcal{H})$ holds up.
\end{enumerate}

Therefore, the density monotonically increases in Greedy before getting $\delta$-core.
\end{proof}


\begin{table*}[htbp]
    \centering
    \vspace{-0.1in}
    \caption{Dataset source and density of algorithms}
    \label{tab:density}
    \resizebox{0.98\linewidth}{!}{
    \begin{tabular}{l|c|c|c|c|c||c|c} \toprule
    \textbf{Dataset}&\textbf{Source}&\textbf{Type}&\textbf{Pruning}&\textbf{w\_app}&\textbf{exact}&\textbf{DLL}&\textbf{uw\_Pruning+DLL}\\
    \midrule
    ca-HepPh                    & Stanford’s SNAP database&scholar collaboration network
                       & 119     & 119     & 119     & 119     & 119        \\
    comm-EmailEnron             & Stanford’s SNAP database&communication
                      & 37.316  & 37.344  & 37.344  & 37.337  & 37.337     \\
    ca-AstroPh                  & Stanford’s SNAP database&scholar collaboration network
                       & 28.481  & 29.616  & 32.11   & 29.552  & 29.552     \\
    PP-Pathways                 & Stanford’s SNAP database&protein interaction network
& 74.159  & 77.995  & 77.995  & 77.995  & 77.995     \\
    soc-Twitter\_ICWSM          & konect&social network
                                         & 25.678  & 25.683  & 25.69   & 25.686  & 25.685    \\
    soc-sign\_slashdot          & Stanford’s SNAP database&social network
                      & 39.376  & 42.132  & 42.132  & 42.132  & 42.132     \\
    rating-StackOverflow        & konect& social network
                                         & 20.209  & 20.209  & 20.21   & 20.209  & 20.209     \\
    soc-sign\_epinion           & Stanford’s SNAP database&social network
                        & 80.168  & 85.599  & 85.637  & 85.589  & 85.589     \\
    ego-twitter       &  Stanford’s SNAP database&social network
                        & 59.281  & 68.414  & 69.622  & 68.414  & 68.414     \\
    soc-Youtube                 &  Stanford’s SNAP database&social network
                        & 45.545  & 45.58   & 45.599  & 45.576  & 45.577     \\
    comm-WikiTalk               &  Stanford’s SNAP database&communication
                       & 114.139 & 114.139 & 114.139 & 114.139 & 114.139    \\
    nov\_user\_msg\_time        & We own it privately.&social network
                           & 278.815 & 278.815 & 278.815 & 278.815 & 278.815    \\
    cit-Patents                 & AMiner scholar datasets&scholar collaboration network
                        & 132.776 & 135.706 & 137.261 & 135.706 & 135.706    \\
    soc-Twitter\_ASU            & ASU&social network
        & 593.847 & 593.847 & 593.847 & 593.847 & 593.847    \\
    soc-Livejournal             & Livejournal&social network
                                    & 104.596 & 104.601 & 104.609 & 104.603 & 104.603   \\
    soc-Orkut                   & Stanford’s SNAP database&social network
                    & 227.861 & 227.872 & 227.874 & 227.872 & 227.872   \\
    soc-SinaWeibo               & Network Repository&social network
                             & 164.967 & 165.193 & 165.415 & 165.196 & 165.191    \\
    \hline
    wang-tripadvisor            & konect&rating network
                                         & 13.442  & 13.873  & 14.082  &--         &--           \\
    rec-YelpUserBusiness        & Network Repository&rating network
                             & 87.825  & 87.912  & 87.921  &--         &--            \\
    bookcrossing                & konect &rating network
                                        & 92.148  & 92.322  & 92.374  &--         &--            \\
    librec-ciaodvd-review       & konect&rating network
                                         & 233.553 & 233.59  & 233.597 &--         &--            \\
    movielens-10m   & konect &rating network
                                        & 1351.35 & 1351.35 & 1351.35 &--         &--           \\
    epinions         & konect &rating network
                                         & 595.302 & 595.314 & 595.316 &--        &--           \\
    libimseti               & konect &social network
                                         & 1645.71 & 1645.73 & 1645.73 &--         &--       \\
    rec-movielens & Network Repository &rating network
                             & 1801.16 & 1801.16 & 1801.16 &--         &--            \\
    yahoo-song              & konect   &rating network
                                    & 46725.2 & 46725.2 & 46725.2 &--     &-- \\
    \hline
    \multicolumn{8}{l}{\multirow{2}{0.95\textwidth}{\textbf{note:} : \textbf{Pruning} (w\_Pruning,uw\_Pruning). \textbf{w\_app}: approximation algorihtms on weighted graph(Priority Tree,Pruning+Priority Tree,BBST). \textbf{exact}: exact algorithms(maxflow,w\_Pruning+maxflow). \textbf{DLL}:Doubly-linked list.}} \\
    \multicolumn{8}{l}{}   \\
    \bottomrule
    \end{tabular}
    }
\end{table*}



\begin{table*}[htbp]
    \centering
    \caption{Comparison between LOWD and baselines without the pruning.}
    \label{tab:withoutpruning}
    \vspace{-0.1in}
    \resizebox{0.95\textwidth}{!}{
        \begin{tabular}{l|l|l|l|l|l|l|l|l|l|l}\toprule
        &\multicolumn{5}{|c|}{Running time}&\multicolumn{5}{c}{The number of iteration rounds}\\
        \midrule
        \textbf{Dataset} & \textbf{LOWD} & \textbf{Greedy++} & \textbf{FW} & \textbf{FISTA} & \textbf{MWU} & \textbf{LOWD} & \textbf{Greedy++} & \textbf{FW} & \textbf{FISTA} & \textbf{MWU}\\
        \midrule
        ca-HepPh                 & 0.0168      & \first{0.0159}     & 0.0208        & 0.0411    & \second{0.0161}    & 1             & 1            & 2               & 2         & 1        \\
        comm-EmailEnron         & \second{0.1516}      & \first{0.0714}     & 0.5551        & 4.9384    & 0.3012    & 19            & 2            & 88              & 255       & 46       \\
        ca-AstroPh               & \first{0.3158}      & 0.8396     & 2.312         & 4.4843    & \second{0.6593}    & 36            & 33           & 343             & 211       & 92       \\
        PP-Pathways                    & \second{0.1174}      & \first{0.0333}     & 0.3214        & 2.8722    & 1.7086    & 9             & 1            & 28              & 79        & 164      \\
        soc-Twitter\_ICWSM             & \first{1.8343}      & 30.6654    & 96.3405       & 43.7426   & \second{6.1467}    & 49            & 114          & 2816            & 401       & 175      \\
        soc-sign\_slashdot       & \second{0.2275}      & \first{0.0704}     & 0.7881        & 9.033     & 1.1051    & 11            & 1            & 44              & 162       & 64       \\
        rating-StackOverflow  & \second{2.1887}      & \first{1.0537}     & 10.0728       & 227.1931  & 18.7819   & 32            & 2            & 178             & 1266      & 341      \\
        soc-sign\_epinion        & \first{0.3213}      & 1.4706     & 1.1853        & 8.0435    & \second{0.9581}    & 9             & 12           & 40              & 90        & 33       \\
        ego-twitter                   & \first{1.6001}      & 2.9768     & 22.0971       & 51.1176   & \second{1.7266}    & 34            & 21           & 550             & 384       & 41       \\
        soc-Youtube             & \first{6.5253}      & 133.3086   & 82.3855       & 812.4268  & \second{22.0866}   & 46            & 129          & 612             & 1792      & 161      \\
        comm-WikiTalk            & \second{4.6758}      & \first{1.984}      & 118.307       & 1942.7338 & 414.9261  & 15            & 1            & 407             & 2022      & 1386     \\
        nov\_user\_msg\_time          & \first{341.1144}    & 4464.4998  & 2581.9086     &  $>$16117.208         & \second{718.8805}  & 97            & 174          & 624             &   $>$1200        & 177      \\
        cit-Patents\_AMINER           & \first{291.4452}    & 846.3628   & \second{837.8446}      & 2172.7049 & 1523.2698 & 104           & 56           & 259             & 196       & 471      \\
        soc-Twitter\_ASU              & \second{120.8906}    & \first{19.2912}    &    511.3170         &    15208.9590       &   2047.9598       & 40            & 1            &     156            &   1244        &  603     \\
        soc-Livejournal & \makecell[c]{--}          & \makecell[c]{--}         & \makecell[c]{--}            & \makecell[c]{--}       & \makecell[c]{--}    & \makecell[c]{--}    & \makecell[c]{--}       & \makecell[c]{--}            & \makecell[c]{--}      & \makecell[c]{--}     \\
        soc-Orkut               & \makecell[c]{--}        & \makecell[c]{--}      & \makecell[c]{--}            & \makecell[c]{--}      & \makecell[c]{--}     & \makecell[c]{--}           & \makecell[c]{--}           & \makecell[c]{--}         & \makecell[c]{--}      & \makecell[c]{--}  \\
        soc-SinaWeibo\_NETREP          & \makecell[c]{--}       & \makecell[c]{--}      & \makecell[c]{--}      & \makecell[c]{--}    & \makecell[c]{--}   & \makecell[c]{--}    & \makecell[c]{--}     & \makecell[c]{--}    & \makecell[c]{--}     & \makecell[c]{--}   \\
        \hline
        wang-tripadvisor                    & \first{0.6686}      & 23.6761    & 30.209        & \makecell[c]{--}  & \second{15.6705}   & 93            & 187          & 3894            & \makecell[c]{--}  & 2007     \\
        rec-YelpUserBusiness  & \first{0.4621}      & 24.5879    & 5.1698        & \makecell[c]{--}    & \second{2.1192}    & 54            & 228          & 626             & \makecell[c]{--} & 239      \\
        bookcrossing        & \first{1.5177}      & 92.9406    & 27.4916       &\makecell[c]{--}& \second{8.877}     & 78            & 259          & 1398            &\makecell[c]{--} & 448      \\
        librec-ciaodvd-review      & \first{4.2248}      & 75.7599    & 231.5822      &\makecell[c]{--}& \second{38.6405}   & 79            & 143          & 4635            &\makecell[c]{--}& 773      \\
        movielens-10m               & \second{49.2341}     & \first{2.7029}     & 129.6344      &\makecell[c]{--}& 60.719    & 159           & 1            & 450             &\makecell[c]{--}& 211      \\
        epinions                     & \first{30.4071}     &  3957.2229        & 4302.242      &\makecell[c]{--} & \second{743.6429}  & 64            &     688
       & 8893            &\makecell[c]{--}& 1582     \\
        libimseti                           & \first{25.7101}     & 5276.5399        & 751.3750            &\makecell[c]{--}& \second{146.2627}        & 39            & 710     & 1196              &\makecell[c]{--}& 234       \\
        rec-movielens            & \first{50.4427}     & 6928.9143       & 306.0513       &\makecell[c]{--} & \second{148.2539}       & 54            & 733          & 355         & \makecell[c]{--} & 172      \\
        yahoo-song                          & \makecell[c]{--}    & \makecell[c]{--} & \makecell[c]{--}        & \makecell[c]{--}      & \makecell[c]{--} & \makecell[c]{--}           & \makecell[c]{--}  & \makecell[c]{--}  & \makecell[c]{--}     & \makecell[c]{--} \\
        \hline
        \multicolumn{11}{l}{\multirow{2}{0.95\textwidth}{\textbf{note:} We ignore some datasets which are very large."$>$1200" and "$>$16117.208" means we run 1200 iterations(running time: 16117.208s) and can't still detect the densest subgraph.}} \\
        \multicolumn{11}{l}{} \\
        \bottomrule
        \end{tabular}
    }
\end{table*}

% Figure environment removed



% Figure environment removed


\begin{algorithm}[htbp]
\caption{\textsc{Greedy DSPSolver}}
\label{alg:greedy}
\KwIn{Undirected graph $\graph$; density metric $\rho(\cdot)$}
\KwOut{$\optset$: the nodeset of the densest subgraph of $\graph$.}
   $\subnode, \, \optset \leftarrow \nodes$

   \While{$\subnode \ne \emptyset$}{
       \linecomment{find the vertex $u^{*}$ with the lowest degree in $\subnode$}
       
       $u^{*} \leftarrow \argmin_{u \in \subnode} \setndeg{\subnode}{u})$
       
       Remove $u^{*}$ and all its adjacent edges from $\graph$.

       \linecomment{$\subnode \backslash \{u\}$: the remaining nodeset without $u$}

       $\subnode \leftarrow \subnode \backslash \{u\}$

        \If{$\rho(\subnode) > \rho(\optset)$}{
        
            $\optset \leftarrow \subnode$
        }
       
   }

    \Return{$\optset$.}
\end{algorithm}
