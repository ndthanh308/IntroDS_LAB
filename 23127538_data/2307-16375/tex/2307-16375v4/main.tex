\documentclass{article}
\pdfoutput=1
\usepackage{natbib}
\setcitestyle{numbers,square}

\usepackage[preprint]{main}

\usepackage[utf8]{inputenc} 
\usepackage[T1]{fontenc}    
\usepackage{hyperref}       
\usepackage{url}

\usepackage[toc,page,header]{appendix}
\usepackage{minitoc}

\usepackage{booktabs}       
\usepackage{amsfonts}       
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{amsthm}
\usepackage{nicefrac}       
\usepackage{microtype}      
\usepackage{xcolor}         
\usepackage{graphicx}
\usepackage{subcaption}
\usepackage{multirow}
\usepackage{makecell}
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage{threeparttable}
\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{assumption}[theorem]{Assumption}
\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}


\title{UniAP: Unifying Inter- and Intra-Layer Automatic Parallelism by Mixed Integer Quadratic Programming}



\author{%
  Hao Lin\footnotemark[1],~~Ke Wu\footnotemark[1],~~Jie Li,~~Jun Li,~~Wu-Jun Li\footnotemark[2]\\
  National Key Laboratory for Novel Software Technology \\
  Department of Computer Science and Technology \\
  Nanjing University, Nanjing 210023, China \\
  \texttt{\{}\href{mailto:hao.lin@smail.nju.edu.cn}{\texttt{hao.lin}}\texttt{,} \href{mailto:ke.wu@smail.nju.edu.cn}{\texttt{ke.wu}}\texttt{,} \href{mailto:jie-li@smail.nju.edu.cn}{\texttt{jie-li}}\texttt{,} \href{mailto:lijun@smail.nju.edu.cn}{\texttt{lijun}}\texttt{\}@smail.nju.edu.cn}\texttt{,} \href{mailto:liwujun@nju.edu.cn}{\texttt{liwujun@nju.edu.cn}}
}

\begin{document}
\include{symbol_def}

\maketitle
\renewcommand{\thefootnote}{\fnsymbol{footnote}}
\footnotetext[1]{Equal contribution.}
\footnotetext[2]{Corresponding author.\par
}

\renewcommand{\thefootnote}{\arabic{footnote}}

\begin{abstract}
 Distributed learning is commonly used for training deep learning models, especially large models. In distributed learning, manual parallelism~(MP) methods demand considerable human effort and have limited flexibility. Hence, automatic parallelism~(AP) methods have recently been proposed for automating the parallel strategy optimization process. Existing AP methods suffer from sub-optimal solutions because they do not jointly optimize the two categories of parallel strategies~(i.e., inter-layer parallelism and intra-layer parallelism). In this paper, we propose a novel AP method called UniAP, which unifies inter- and intra-layer automatic parallelism by mixed integer quadratic programming. To the best of our knowledge, UniAP is the first parallel method that can jointly optimize the two categories of parallel strategies to find an optimal solution. Experimental results show that UniAP outperforms state-of-the-art methods by up to 3.80$\times$ in throughput and reduces strategy optimization time by up to 107$\times$ across five Transformer-based models.
\end{abstract}



\input{1_introduction}

\input{2_background}

\input{3_method}

\input{4_experiments}


\input{5_conclusion}




\bibliography{bibiliography}
\bibliographystyle{unsrt}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

%\appendix
\input{7_supplementary}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%


\end{document}