\documentclass{article}


\PassOptionsToPackage{numbers, sort&compress}{natbib}
\usepackage[preprint]{conference}


\usepackage[utf8]{inputenc}
\usepackage[T1]{fontenc}
\usepackage{hyperref}
\usepackage{url}
\usepackage{booktabs}
\usepackage{amsfonts}
\usepackage{nicefrac}
\usepackage{microtype}
\usepackage{xcolor}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsthm}
\usepackage{algorithm}
\usepackage{algorithmic}
\usepackage{multirow}
\usepackage{caption}
\usepackage{subcaption}


\newtheorem{myDef}{Definition}
\newtheorem{myTheo}{Theorem}
\newtheorem{myProof}{Proof}
\allowdisplaybreaks[1]

\title{UniAP: Unifying Inter- and Intra-Layer Automatic Parallelism by Mixed Integer Quadratic Programming}

\author{
  Hao Lin\footnotemark[1],\quad Ke Wu\footnotemark[1],\quad Jun Li,\quad Wu-Jun Li\footnotemark[2]\\
  National Key Laboratory for Novel Software Technology \\
  Department of Computer Science and Technology \\
  Nanjing University, Nanjing 210023, China \\
  \texttt{\{}\href{mailto:hao.lin@smail.nju.edu.cn}{\texttt{hao.lin}}\texttt{,} \href{mailto:ke.wu@smail.nju.edu.cn}{\texttt{ke.wu}}\texttt{,} \href{mailto:lijun@smail.nju.edu.cn}{\texttt{lijun}}\texttt{\}@smail.nju.edu.cn}\texttt{,} \href{mailto:liwujun@nju.edu.cn}{\texttt{liwujun@nju.edu.cn}}
}


\begin{document}


\maketitle
\renewcommand{\thefootnote}{\fnsymbol{footnote}}
\footnotetext[1]{Equal contribution.}
\footnotetext[2]{Corresponding author.}


\begin{abstract}
Deep learning models have demonstrated impressive performance in various domains. However, the prolonged training time of these models remains a critical problem. Manually designed parallel training strategies could enhance efficiency but require considerable time and deliver little flexibility. Hence, \emph{automatic parallelism} is proposed to automate the parallel strategy searching process. Even so, existing approaches suffer from sub-optimal strategy space because they treat automatic parallelism as two independent stages, namely inter- and intra-layer parallelism. To address this issue, we propose UniAP, which utilizes mixed integer quadratic programming to unify inter- and intra-layer automatic parallelism. To the best of our knowledge, UniAP is the first work to unify these two categories to search for a globally optimal strategy. The experimental results show that UniAP outperforms state-of-the-art methods by up to 1.70$\times$ in throughput and reduces strategy searching time by up to 16$\times$ across four Transformer-like models.
\end{abstract}

\input{1_introduction}

\input{2_background}

\input{3_method}

\input{4_experiments}

\input{5_conclusion}

\newpage
\input{bibliography.bbl}

\newpage
\input{supplementary}

\end{document}
\typeout{get arXiv to do 4 passes: Label(s) may have changed. Rerun}