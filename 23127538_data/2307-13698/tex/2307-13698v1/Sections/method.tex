\noindent\textbf{Overview.}
We train a neural network $\displaystyle f:\mathcal{X} \rightarrow \mathcal{Y}$, taking images $\mathcal{X}$ as input to predict the labels $\mathcal{Y} \in \mathbb{R}^K$, $K$ being the number of classes. 
% We denote the output logit for the $k^{th}$ class label and image $x$ as $f_k(x) = h_k(\Phi(x)$. 
We assume that $\displaystyle f$ is a composition $\displaystyle h \circ \Phi $, where $\displaystyle \Phi: \mathcal{X} \rightarrow \mathbb{R}^l $ is the  image embedding and $\displaystyle h: \mathbb{R}^l \rightarrow \mathcal{Y}$ is a classifier. 
Figure \ref{fig:schematic} shows an overview of our approach.
% We denote the binary classifier $\displaystyle t_C: \mathbb{R}^l \rightarrow\mathbb{R}$ aiming to estimate a unit linear CAV $v_C \in \mathbb{R}^l$ as for the concept $C$, orthogonal to the classification boundary.
\subsection{Pruning Methodology} 
\emph{LTH}~\cite{frankle2018lottery} aims to find a pruned subnetwork within a deep neural network that achieves similar accuracy as the original network -- \emph{when trained in isolation}. These pruned networks are finetuned for a small number of iterations to achieve accuracy. 
 We prune and fine-tune the network $f$ simultaneously for $n$ rounds using the strategy of iterative magnitude pruning in \emph{LTH}~\cite{frankle2018lottery}. Thus we obtain $f^1, f^2, \dots, f^n$ subnetworks where the network $f$ for the $i^{th}$ round is denoted as $f^i(.) = h^i(\Phi^i(.))$. 
 For brevity, we drop \emph{round index} $i$ from the notations in the following sections.

% Figure environment removed

\begin{table*}[t]
\caption{The top-3 concepts with the highest weights of the carved interpretable models ($g$) using PCBM from the pruned subnetworks for various pruning iterations for the bird species of CUB-200 dataset. Due to the space constraint, we only report the concepts from $g$ extracted from the model for iterations 1, 2, 4, and 15 with 100\%, 90\% 72.9\%, and 23\% weights remaining.}
\fontsize{6.2pt}{0.20cm}\selectfont
\label{tab:cub}
\begin{center}
\begin{tabular}{l l l l  l}
\toprule 
        \textbf{LABEL} 
       & \textbf{100.0 \% WEIGHTS REMAINING} 
       & \textbf{90.0 \% WEIGHTS REMAINING} 
       % & \textbf{81.0 \% WEIGHTS REMAINING} 
       & \textbf{72.9 \% WEIGHTS REMAINING} 
       % & \textbf{25.5 \% WEIGHTS REMAINING} 
       & \textbf{23.0 \% WEIGHTS REMAINING} \\
\midrule 
    Black footed Albatross & 
    \vtop{
        \hbox{\strut 1. \textbf{bill\_shape\_hooked\_seabird}}
        \hbox{\strut 2. \textbf{under\_tail\_color\_black}}
        \hbox{\strut 3. \textbf{size\_medium\_9\_16\_in}}
    }& 
    \vtop{
        \hbox{\strut 1. \textbf{bill\_shape\_hooked\_seabird}}
        \hbox{\strut 2. \textbf{under\_tail\_color\_black}}
        \hbox{\strut 3. wing\_pattern\_solid}
    }
    % & 
    % \vtop{
    %     \hbox{\strut 1. \textbf{bill\_shape\_hooked\_seabird}}
    %     \hbox{\strut 2. wing\_pattern\_solid}
    %     \hbox{\strut 3. \textbf{size\_medium\_9\_16\_in}}
    % }
    & 
    \vtop{
        \hbox{\strut 1. \textbf{bill\_shape\_hooked\_seabird}}
        \hbox{\strut 2. leg\_color\_grey}
        \hbox{\strut 3. \textbf{size\_medium\_9\_16\_in}}
    }
    % & 
    % \vtop{
    %     \hbox{\strut 1. \textbf{bill\_shape\_hooked\_seabird}}
    %     \hbox{\strut 2. crown\_color\_white}
    %     \hbox{\strut 3.  \textbf{size\_medium\_9\_16\_in}}
    % }
    & 
    \vtop{
        \hbox{\strut 1. \textbf{bill\_shape\_hooked\_seabird}}
        \hbox{\strut 2. underparts\_color\_grey}
        \hbox{\strut 3. wing\_pattern\_solid}
    }\\  
    
\midrule    
Rusty Blackbird &\vtop{
        \hbox{\strut 1. \textbf{back\_color\_brown}}
        \hbox{\strut 2. \textbf{breast\_color\_brown}}
        \hbox{\strut 3. \textbf{wing\_color\_black}}
    }& 
    \vtop{
        \hbox{\strut 1. underparts\_color\_buff}
        \hbox{\strut 2. \textbf{breast\_color\_brown}}
        \hbox{\strut 3. \textbf{back\_color\_brown}}
    }
    % & 
    % \vtop{
    %     \hbox{\strut 1. \textbf{breast\_color\_brown}}
    %     \hbox{\strut 2. \textbf{back\_color\_brown}}
    %     \hbox{\strut 3. bill\_shape\_allpurpose}
    % }
    & 
    \vtop{
        \hbox{\strut 1. \textbf{breast\_color\_brown}}
        \hbox{\strut 2. belly\_color\_grey}
        \hbox{\strut 3. underparts\_color\_grey}
    }
    % & 
    % \vtop{
    %     \hbox{\strut 1. \textbf{back\_color\_brown}}
    %     \hbox{\strut 2. bill\_shape\_hooked\_seabird}
    %     \hbox{\strut 3. bill\_shape\_allpurpose}
    % }
    & 
    \vtop{
        \hbox{\strut 1. underparts\_color\_buff}
        \hbox{\strut 2. \textbf{back\_color\_brown}}
        \hbox{\strut 3. belly\_color\_grey}
    } \\
\midrule    
White Pelican &\vtop{
        \hbox{\strut 1. \textbf{bill\_shape\_dagger}}
        \hbox{\strut 2. \textbf{upper\_tail\_color\_white}}
        \hbox{\strut 3. \textbf{back\_pattern\_multicolored}}
    }&  
    \vtop{
        \hbox{\strut 1. wing\_pattern\_solid}
        \hbox{\strut 2. bill\_color\_grey}
        \hbox{\strut 3. \textbf{upper\_tail\_color\_white}}
    }
    % & 
    % \vtop{
    %     \hbox{\strut 1. underparts\_color\_yellow}
    %     \hbox{\strut 2. \textbf{upper\_tail\_color\_white}}
    %     \hbox{\strut 3. leg\_color\_grey}
    % }
    &
    \vtop{
        \hbox{\strut 1. belly\_color\_yellow}
        \hbox{\strut 2. primary\_color\_yellow}
        \hbox{\strut 3. underparts\_color\_yellow}
    }
    % &
    % \vtop{
    %     \hbox{\strut 1. wing\_pattern\_multicolored}
    %     \hbox{\strut 2. under\_tail\_color\_grey}
    %     \hbox{\strut 3. belly\_pattern\_solid}
    % }
    & 
    \vtop{
        \hbox{\strut 1. wing\_pattern\_multicolored}
        \hbox{\strut 2. bill\_color\_grey}
        \hbox{\strut 3. wing\_color\_white}
    } \\ 
\midrule
Grasshopper Sparrow &\vtop{
        \hbox{\strut 1. \textbf{back\_color\_buff}}
        \hbox{\strut 2. \textbf{wing\_pattern\_striped}}
        \hbox{\strut 3. \textbf{back\_pattern\_striped}}
    }& 
    \vtop{
        \hbox{\strut 1. \textbf{back\_color\_buff}}
        \hbox{\strut 2. \textbf{wing\_pattern\_striped}}
        \hbox{\strut 3. belly\_color\_buff}
    }
    % & 
    % \vtop{
    %     \hbox{\strut 1. \textbf{back\_color\_buff}}
    %     \hbox{\strut 2. wing\_color\_white}
    %     \hbox{\strut 3. upperparts\_color\_buff}
    % }
    & 
    \vtop{
        \hbox{\strut 1. belly\_color\_buff}
        \hbox{\strut 2. wing\_color\_white}
        \hbox{\strut 3. upperparts\_color\_buff}
    }
    % & 
    % \vtop{
    %     \hbox{\strut 1. breast\_color\_buff}
    %     \hbox{\strut 2. primary\_color\_buff}
    %     \hbox{\strut 3. belly\_pattern\_solid}
    % }
    & 
    \vtop{
        \hbox{\strut 1. \textbf{back\_color\_buff}}
        \hbox{\strut 2. belly\_color\_buff}
        \hbox{\strut 3. underparts\_color\_buff}
    } \\
\midrule 
Vesper Sparrow &\vtop{
        \hbox{\strut 1. \textbf{leg\_color\_black}}
        \hbox{\strut 2. \textbf{nape\_color\_buff}}
        \hbox{\strut 3. \textbf{primary\_color\_buff}}
    }& 
    \vtop{
        \hbox{\strut 1. \textbf{nape\_color\_buff}}
        \hbox{\strut 2. \textbf{primary\_color\_buff}}
        \hbox{\strut 3. head\_pattern\_plain}
    }
    % &
    % \vtop{
    %     \hbox{\strut 1. \textbf{nape\_color\_buff}}
    %     \hbox{\strut 2. leg\_color\_black}
    %     \hbox{\strut 3. forehead\_color\_brown}
    % }
    & 
    \vtop{
        \hbox{\strut 1. \textbf{nape\_color\_buff}}
        \hbox{\strut 2. back\_color\_buff}
        \hbox{\strut 3. wing\_color\_buff'}
    }
    % &
    % \vtop{
    %     \hbox{\strut 1. breast\_pattern\_striped}
    %     \hbox{\strut 2. \textbf{nape\_color\_buff}}
    %     \hbox{\strut 3. breast\_color\_black}
    % }
    & 
    \vtop{
        \hbox{\strut 1. under\_tail\_color\_buff}
        \hbox{\strut 2. breast\_color\_black}
        \hbox{\strut 3. wing\_color\_buff}
    } \\
\midrule
Heermann Gull &\vtop{
        \hbox{\strut 1. \textbf{breast\_color\_grey}}
        \hbox{\strut 2. \textbf{upper\_tail\_color\_black}}
        \hbox{\strut 3. \textbf{underparts\_color\_grey}}
    }& 
    \vtop{
        \hbox{\strut 1. \textbf{breast\_color\_grey}}
        \hbox{\strut 2. \textbf{underparts\_color\_grey}}
        \hbox{\strut 3. throat\_color\_grey}
    }
    % &
    % \vtop{
    %     \hbox{\strut 1. \textbf{breast\_color\_grey}}
    %     \hbox{\strut 2. belly\_color\_grey}
    %     \hbox{\strut 3. leg\_color\_black}
    % }
    & 
    \vtop{
        \hbox{\strut 1. belly\_color\_grey}
        \hbox{\strut 2. \textbf{breast\_color\_grey}}
        \hbox{\strut 3. \textbf{underparts\_color\_grey}}
    }
    % &
    % \vtop{
    %     \hbox{\strut 1. head\_pattern\_plain}
    %     \hbox{\strut 2. primary\_color\_grey}
    %     \hbox{\strut 3. wing\_pattern\_solid}
    % }
    & 
    \vtop{
        \hbox{\strut 1. head\_pattern\_plain}
        \hbox{\strut 2. back\_color\_grey}
        \hbox{\strut 3. primary\_color\_grey}
    } \\ 
\midrule
American Crow &\vtop{
        \hbox{\strut 1. \textbf{crown\_color\_grey}}
        \hbox{\strut 2. \textbf{forehead\_color\_grey}}
        \hbox{\strut 3. \textbf{wing\_shape\_roundedwings}}
    }& 
    \vtop{
        \hbox{\strut 1. \textbf{wing\_shape\_roundedwings}}
        \hbox{\strut 2. \textbf{forehead\_color\_grey}}
        \hbox{\strut 3. primary\_color\_grey}
    }
    % & 
    % \vtop{
    %     \hbox{\strut 1. throat\_color\_grey}
    %     \hbox{\strut 2. \textbf{wing\_shape\_roundedwings}}
    %     \hbox{\strut 3. back\_color\_grey}
    % }
    & 
    \vtop{
        \hbox{\strut 1. throat\_color\_grey}
        \hbox{\strut 2. \textbf{wing\_shape\_roundedwings}}
        \hbox{\strut 3. back\_color\_grey}
    }
    % &
    % \vtop{
    %     \hbox{\strut 1. \textbf{wing\_shape\_roundedwings}}
    %     \hbox{\strut 2. wing\_pattern\_solid}
    %     \hbox{\strut 3. breast\_color\_black}
    % }
    & 
    \vtop{
        \hbox{\strut 1. underparts\_color\_grey}
        \hbox{\strut 2. back\_color\_grey}
        \hbox{\strut 3. belly\_color\_black}
    } \\ 
\midrule
Winter Wren &\vtop{
        \hbox{\strut 1. \textbf{breast\_color\_brown}}
        \hbox{\strut 2. \textbf{forehead\_color\_brown}}
        \hbox{\strut 3. \textbf{under\_tail\_color\_brown}}
    }& 
    \vtop{
        \hbox{\strut 1. \textbf{breast\_color\_brown}}
        \hbox{\strut 2. underparts\_color\_brown}
        \hbox{\strut 3. \textbf{forehead\_color\_brown}}
    }
    % & 
    % \vtop{ 
    %     \hbox{\strut 1. \textbf{breast\_color\_brown}}
    %     \hbox{\strut 2. underparts\_color\_brown}
    %     \hbox{\strut 3. \textbf{forehead\_color\_brown}}
    % }
    & 
    \vtop{
        \hbox{\strut 1. \textbf{breast\_color\_brown}}
        \hbox{\strut 2. underparts\_color\_brown}
        \hbox{\strut 3. \textbf{under\_tail\_color\_brown}}
    }
    % &
    % \vtop{
    %     \hbox{\strut 1. size\_very\_small\_3\_5\_in}
    %     \hbox{\strut 2. \textbf{breast\_color\_brown}}
    %     \hbox{\strut 3. nape\_color\_brown}
    % }
    & 
    \vtop{
        \hbox{\strut 1. size\_very\_small\_3\_5\_in}
        \hbox{\strut 2. \textbf{forehead\_color\_brown}}
        \hbox{\strut 3. crown\_color\_brown}
    } \\ 
\midrule
House Sparrow &\vtop{
        \hbox{\strut 1. \textbf{breast\_color\_grey}}
        \hbox{\strut 2. \textbf{upperparts\_color\_black}}
        \hbox{\strut 3. \textbf{primary\_color\_brown}}
    }&  
    \vtop{
        \hbox{\strut 1. \textbf{breast\_color\_grey}}
        \hbox{\strut 2. \textbf{primary\_color\_brown}}
        \hbox{\strut 3. bill\_shape\_cone}
    }
    % & 
    % \vtop{ 
    %     \hbox{\strut 1. \textbf{breast\_color\_grey}}
    %     \hbox{\strut 2. bill\_shape\_cone}
    %     \hbox{\strut 3. back\_color\_brown}
    % }
    & 
    \vtop{
        \hbox{\strut 1. bill\_shape\_cone}
        \hbox{\strut 2. \textbf{breast\_color\_grey}}
        \hbox{\strut 3. nape\_color\_grey}
    }
    % &
    % \vtop{
    %     \hbox{\strut 1. underparts\_color\_grey}
    %     \hbox{\strut 2. \textbf{breast\_color\_grey}}
    %     \hbox{\strut 3. upper\_tail\_color\_brown}
    % }
    & 
    \vtop{
        \hbox{\strut 1. \textbf{breast\_color\_grey}}
        \hbox{\strut 2. tail\_shape\_notched\_tail}
        \hbox{\strut 3. bill\_shape\_cone}
    } \\ 
\midrule
Prothonotary Warbler &\vtop{
        \hbox{\strut 1. \textbf{under\_tail\_color\_grey}}
        \hbox{\strut 2. \textbf{head\_pattern\_plain}}
        \hbox{\strut 3. \textbf{back\_pattern\_multicolored}}
    }&  
    \vtop{
        \hbox{\strut 1. head\_pattern\_plain}
        \hbox{\strut 2. leg\_color\_grey}
        \hbox{\strut 3. \textbf{back\_pattern\_multicolored}}
    }
    % & 
    % \vtop{
    %     \hbox{\strut 1. \textbf{back\_pattern\_multicolored}}
    %     \hbox{\strut 2. upper\_tail\_color\_grey}
    %     \hbox{\strut 3. \textbf{under\_tail\_color\_grey}}
    % }
    & 
    \vtop{
        \hbox{\strut 1. \textbf{back\_pattern\_multicolored}}
        \hbox{\strut 2. \textbf{under\_tail\_color\_grey}}
        \hbox{\strut 3. crown\_color\_yellow}
    }
    % &
    % \vtop{
    %     \hbox{\strut 1. crown\_color\_yellow}
    %     \hbox{\strut 2. \textbf{back\_pattern\_multicolored}}
    %     \hbox{\strut 3. \textbf{under\_tail\_color\_grey}}
    % }
    & 
    \vtop{
        \hbox{\strut 1. nape\_color\_yellow}
        \hbox{\strut 2. \textbf{back\_pattern\_multicolored}}
        \hbox{\strut 3. crown\_color\_yellow}
    } \\ 
% \midrule
% Cerulean Warbler &\vtop{ 
%         \hbox{\strut 1. \textbf{forehead\_color\_blue}}
%         \hbox{\strut 2. \textbf{crown\_color\_blue}}
%         \hbox{\strut 3. \textbf{nape\_color\_blue}}
%     }&  
%     \vtop{
%         \hbox{\strut 1. \textbf{forehead\_color\_blue}}
%         \hbox{\strut 2. \textbf{nape\_color\_blue}}
%         \hbox{\strut 3. \textbf{crown\_color\_blue}}
%     }
%     & 
%     \vtop{
%         \hbox{\strut 1. \textbf{crown\_color\_blue}}
%         \hbox{\strut 2. \textbf{forehead\_color\_blue}}
%         \hbox{\strut 3. \textbf{nape\_color\_blue}}
%     }
%     & 
%     \vtop{
%         \hbox{\strut 1. \textbf{crown\_color\_blue}}
%         \hbox{\strut 2. \textbf{nape\_color\_blue}}
%         \hbox{\strut 3. size\_very\_small\_3\_5\_in}
%     }
%     &
%     \vtop{
%         \hbox{\strut 1. size\_very\_small\_3\_5\_in}
%         \hbox{\strut 2. \textbf{nape\_color\_blue}}
%         \hbox{\strut 3.  \textbf{forehead\_color\_blue}}
%     }
%     & 
%     \vtop{
%         \hbox{\strut 1. size\_very\_small\_3\_5\_in}
%         \hbox{\strut 2. \textbf{nape\_color\_blue}}
%         \hbox{\strut 3. \textbf{forehead\_color\_blue}}
%     } \\ 
% \midrule
% Rock Wren &\vtop{ 
%         \hbox{\strut 1. \textbf{breast\_color\_buff}}
%         \hbox{\strut 2. \textbf{belly\_color\_buff}}
%         \hbox{\strut 3. \textbf{underparts\_color\_grey}}
%     }& 
%     \vtop{
%         \hbox{\strut 1. \textbf{belly\_color\_buff}}
%         \hbox{\strut 2. \textbf{breast\_color\_buff}}
%         \hbox{\strut 3. upperparts\_color\_grey}
%     }
%     & 
%     \vtop{
%         \hbox{\strut 1. \textbf{belly\_color\_buff}}
%         \hbox{\strut 2. upperparts\_color\_grey}
%         \hbox{\strut 3. under\_tail\_color\_brown}
%     }
%     & 
%     \vtop{ 
%         \hbox{\strut 1. \textbf{belly\_color\_buff}}
%         \hbox{\strut 2. \textbf{breast\_color\_buff}}
%         \hbox{\strut 3. throat\_color\_grey}
%     }
%     &
%     \vtop{
%         \hbox{\strut 1. \textbf{breast\_color\_buff}}
%         \hbox{\strut 2. throat\_color\_grey}
%         \hbox{\strut 3.  nape\_color\_grey}
%     }
%     & 
%     \vtop{
%         \hbox{\strut 1. breast\_color\_grey}
%         \hbox{\strut 2. \textbf{belly\_color\_buff}}
%         \hbox{\strut 3. leg\_color\_black}
%     } \\ 
\bottomrule
\end{tabular}
% \end{sc}
% \end{small}
\end{center}
% \vskip -0.1in
\end{table*}


\subsection{Retrieving the concepts from embeddings}
\noindent\textbf{Learn the concept predictor.}
For datasets with the concept annotation $\mathcal{C} \in \mathbb{R}^{N_c}$ ($N_c$ being the number of concepts per image $\mathcal{X}$), the learnable $t: R^l \rightarrow\mathcal{C}$ classifies the concepts using the embeddings $\Phi$ of each pruned networks. Per this definition, $t$ outputs a scalar value $c$ representing each concept in the concept vector for each input image. 
For datasets without concept annotation, we leverage a set of image embeddings with the concept being present and absent)~\cite{yuksekgonul2022post} and learn a linear SVM ($t$) to construct the concept activation matrix~\cite{kim2017interpretability} as $\boldsymbol{Q} \in\mathbb{R}^{N_c \times l}$. 
Finally we estimate the concept value as $c = \frac{<\Phi(x), q^i>}{||q_i||_2^2}$ $ \in \mathbb{R}$ utilizing each row $\boldsymbol{q^i}$ of $\boldsymbol{Q}$. Thus, the complete tuple of $j^{th}$ sample is $\{x_j, y_j, c_j\}$, denoting the image, label, and learned concept vector, respectively.

\noindent\textbf{Learn PCBM.}
Following~\cite{yuksekgonul2022post}, we carve the interpretable classifier $g: \mathcal{C} \rightarrow \mathcal{Y}$ from $f$ to predict the labels from the concepts using the following loss:
\begin{align}
\label{equ:unconstrained_risk}
\min_g \mathbb{E}_{c, y\sim\mathcal{C}, \mathcal{Y}} \big[\mathcal{L}(g(c), y) \big] + \frac{\lambda}{N_cK}\Omega(g),
\end{align}

where $g(c) = w^Tc + b$, $\lambda$ is the regularization strength, $\Omega$ is the elastic net penalty~\cite{yuksekgonul2022post}. $g$ associates each concept with a weight after training, implying its predictive significance to the class labels.

\subsection{Local explanations using Grad-CAM}
Saliency maps are heatmap-based techniques, highlighting essential features (pixels for images) in the input space responsible for the model's prediction as a class label $k$. In this paper, we adopt GRAD-CAM method~\cite{selvaraju2016grad}. We calculate the heatmap by choosing an intermediate convolutional layer and then linearizing the rest of the network to be interpretable. 


