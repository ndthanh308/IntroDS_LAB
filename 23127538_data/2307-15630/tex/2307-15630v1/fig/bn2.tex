\documentclass[tikz]{standalone} 
\usepackage{xcolor}

\begin{document}
	\usetikzlibrary{dsp}
	\usetikzlibrary{chains}
	\usetikzlibrary{shapes.geometric}
	\usetikzlibrary{calc}

\begin{tikzpicture}[scale = .7]

\tikzstyle{arrow} = [thick,->,>=stealth]
\pgfmathsetmacro{\rootx}{0}
\pgfmathsetmacro{\rooty}{0}

\pgfmathsetmacro{\topconvs}{-1}
\pgfmathsetmacro{\convsep}{1.5}

\pgfmathsetmacro{\leftrow}{-3.0}
\pgfmathsetmacro{\rightrow}{8.5}
\pgfmathsetmacro{\middlerow}{(\rightrow+\leftrow)/2}
\pgfmathsetmacro{\boxheight}{1.8}
\pgfmathsetmacro{\boxwidth}{10}
\pgfmathsetmacro{\quadboxwidth}{34}

	% \fill [white] (-3,-0.1) rectangle (10,-4.6);
	
	\draw   (\leftrow,\rooty+\convsep-1.5)   coordinate    (NoisyInput)    {}
	       (\rightrow,\rooty+\convsep-1.5)  coordinate    (MaskOut)    {}
              (\middlerow,{\topconvs-0.65*\convsep}) node    (backdrop)     [dspfilter, minimum width=\quadboxwidth em, minimum height=7.0 em, fill=black!10, draw=white] {}
	       (\leftrow+.75,{\topconvs-0*\convsep}) node    (bottIn)     [dspfilter, minimum width=\boxwidth em, minimum height=\boxheight em, fill=white] {Conv($F, N\times 1$)}
	       (\rightrow-0.75,{\topconvs-0*\convsep}) node    (bottOut)     [dspfilter, minimum width=\boxwidth em, minimum height=\boxheight em, fill=white] {Conv($3F, N\times 1$)}
		   (\leftrow,{\topconvs-(0.55*\convsep)})   coordinate    (bottIn_)    {}
		   (\rightrow,{\topconvs-(0.55*\convsep)})   coordinate    (bottOut_)    {}
              (\leftrow+.75,{\topconvs-1*\convsep}) node    (clstm1)     [dspfilter, minimum width=\boxwidth em, minimum height=\boxheight em, fill=yellow!20] {Channel Divide}
	       (\rightrow-0.75,{\topconvs-1*\convsep}) node    (clstm2)     [dspfilter, minimum width=\boxwidth em, minimum height=\boxheight em, fill=yellow!20] {Reshape}
              ({\middlerow},{\topconvs-1*\convsep}) node    (rr)     [dspfilter, minimum width=0.7*\boxwidth em, minimum height=1.5*\boxheight em, fill=white] {}
              ({\middlerow},{\topconvs-1.55*\convsep}) node (text) 
              % [label=10 $\times$ \\ gGRU($LF/80$)] 
              [label=\vtop{\hbox{\strut{10 $\times$}} \hbox{GRU($LF/80$)}}]
              {};
     %          ({\middlerow},{\topconvs-2*\convsep}) node    (rr)     [dspfilter, minimum width=\boxwidth em, minimum height=\boxheight em, fill=white] {10 $\times$ gGRU($LF/80$)}
     %          (\leftrow,{\topconvs-(2*\convsep)})   coordinate    (clstm1_)    {}
		   % (\rightrow,{\topconvs-(2*\convsep)})   coordinate    (clstm2_)    {};

% \vtop{\hbox{\strut{\tt FCRN}} \hbox{after \cite{}}}

	%%% labels for named Signals
	% \draw  ([xshift=-0mm, yshift=-3mm] NoisyInput)   node    (inputTop)       [label=above:$\mathbf{Y}_{\ell}(k)$] {};
	% \draw  (MaskOut)   node    (inputTop)       [label=right:$\mathbf{G}_{\ell}(k)$] {};
	
    \draw ([xshift=8mm, yshift=-2mm] bottIn.north) coordinate (bottIn_data_in);
    \draw ([xshift=8mm, yshift=-2mm] clstm1.north) coordinate (clstm1_data_in);
    \draw ([xshift=8mm, yshift=2mm] clstm1.south) coordinate (clstm1_data_out);
    \draw ([xshift=-8mm, yshift=-2mm] clstm2.north) coordinate (clstm2_data_out);
    \draw ([xshift=-8mm, yshift=2mm] clstm2.south) coordinate (clstm2_data_in);
	\draw ([xshift=-8mm, yshift=-2mm] bottOut.north) coordinate (bottOut_data_out);	

    \draw  ([yshift=-2mm] rr.north)   node    (out_data_node)       [label=above:gGRU layer:] {};

    \draw  (bottIn_data_in)   node    (out_data_node)       [label=above:\scriptsize $L/8 \times 1 \times 3F$] {};
    \draw  (clstm1_data_in)   node    (out_data_node)       [label=above:\scriptsize $L/8 \times 1 \times F$] {};
    \draw  ([xshift=+8mm, yshift=+0.0mm]clstm1_data_out)   node    (clstm1_out)       [label=below:\scriptsize $LF/80 \times 1 \times 10$] {};
    \draw  ([xshift=-8mm, yshift=+0.0mm]clstm2_data_in)   node    (clstm1_out)       [label=below:\scriptsize $LF/80 \times 1 \times 10$] {};
    \draw  (clstm2_data_out)   node    (out_data_node)       [label=above:\scriptsize $L/8 \times 1 \times F$] {};
	\draw  (bottOut_data_out)   node    (out_data_node)       [label=above:\scriptsize $L/8 \times 1 \times 3F$] {};
	
	% \draw ([xshift=-35mm] quadconv1.north) coordinate (quadconv1.in1);
	% \draw ([xshift=35mm] quadconv1.north) coordinate (quadconv1.out2);
	% \draw ([xshift=-35mm] quadconv1.south) coordinate (quadconv1.out1);
	% \draw ([xshift=35mm] quadconv1.south) coordinate (quadconv1.in2);
	
	% \draw ([xshift=-35mm] quadconv2.north) coordinate (quadconv2.in1);
	% \draw ([xshift=35mm] quadconv2.north) coordinate (quadconv2.out2);
	% \draw ([xshift=-35mm] quadconv2.south) coordinate (quadconv2.out1);
	% \draw ([xshift=35mm] quadconv2.south) coordinate (quadconv2.in2);
	
	% \draw ([xshift=-35mm] quadconv3.north) coordinate (quadconv3.in1);
	% \draw ([xshift=35mm] quadconv3.north) coordinate (quadconv3.out2);
	% \draw ([xshift=-35mm] quadconv3.south) coordinate (quadconv3.out1);
	% \draw ([xshift=35mm] quadconv3.south) coordinate (quadconv3.in2);

    \draw ([xshift=-7.5 mm] bottIn.north) coordinate (bottIn.in);
	\draw ([xshift=-7.5mm] bottIn.south) coordinate (bottIn.out);
	
	\draw ([xshift=+7.5mm] bottOut.north) coordinate (bottOut.out);
	\draw ([xshift=+7.5 mm] bottOut.south) coordinate (bottOut.in);
	
	\draw ([xshift=-7.5 mm] clstm1.north) coordinate (clstm1.in);
	\draw ([xshift=-7.5mm] clstm1.south) coordinate (clstm1.out);
	
	\draw ([xshift=+7.5mm] clstm2.north) coordinate (clstm2.out);
	\draw ([xshift=+7.5 mm] clstm2.south) coordinate (clstm2.in);
	
	\draw ([xshift=+7.5mm] out_conv.north) coordinate (out_conv.out);
	\draw ([xshift=+7.5 mm] out_conv.south) coordinate (out_conv.in);
	

	\begin{scope}[start chain]
	
	\chainin (NoisyInput);

    \chainin (bottIn.in)        [join=by dspconn];
    \chainin (bottIn.out) ;
	\chainin (clstm1.in) 		[join=by dspconn];
 
	\chainin (clstm1);
	% \chainin (clstm1_) 		[join=by dspline];
    \chainin (rr) 		    [join=by dspconn];
	% \chainin (clstm2_) 		[join=by dspline];
	\chainin (clstm2) 		[join=by dspconn];
	
	\chainin (clstm2.out);
    \chainin (bottOut.in)        [join=by dspconn];
    \chainin (bottOut.out) ;

	\chainin (MaskOut) 	[join=by dspconn];


    \end{scope}

    \draw ([xshift=-6.5mm, yshift=-1.0mm] rr.west) coordinate (wiggle_A1);
	\draw ([xshift=+2.5mm, yshift=-0.5cm] clstm1.east) coordinate (wiggle_A2);
    \draw (wiggle_A1) to [out=-70, in=+110] (wiggle_A2);

    \draw ([xshift=+4.5mm, yshift=-1.0mm] rr.east) coordinate (wiggle_B1);
	\draw ([xshift=-4.5mm, yshift=-0.5cm] clstm2.west) coordinate (wiggle_B2);
    \draw (wiggle_B1) to [out=-110, in=+70] (wiggle_B2);
	
\end{tikzpicture}



\end{document}