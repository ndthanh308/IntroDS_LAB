\documentclass[tikz]{standalone} 
\usepackage{xcolor}

\begin{document}
	\usetikzlibrary{dsp}
	\usetikzlibrary{chains}
	\usetikzlibrary{shapes.geometric}
	\usetikzlibrary{calc}
	
\newcommand{\QuadConv}{EDBlock}

\begin{tikzpicture}[scale = .7]

\pgfarrowsdeclare{dsparrow}{dsparrow}
{
	\arrowsize=0.50pt
	\advance\arrowsize by .5\pgflinewidth
	\pgfarrowsleftextend{-4\arrowsize}
	\pgfarrowsrightextend{4\arrowsize}
}
{
	\arrowsize=0.50pt
	\advance\arrowsize by .5\pgflinewidth
	\pgfsetdash{}{0pt} % Solid line (do not dash)
	\pgfsetmiterjoin	 % Fixed miter join of line
	\pgfsetbuttcap		 % Fixed butt cap of line
	\pgfpathmoveto{\pgfpoint{-4\arrowsize}{2.5\arrowsize}}
	\pgfpathlineto{\pgfpoint{4\arrowsize}{0pt}}
	\pgfpathlineto{\pgfpoint{-4\arrowsize}{-2.5\arrowsize}}
	\pgfpathclose
	\pgfusepathqfill
}


\tikzstyle{arrow} = [thick,->,>=stealth]
\pgfmathsetmacro{\rootx}{0}
\pgfmathsetmacro{\rooty}{0}

\pgfmathsetmacro{\topconvs}{-1}
\pgfmathsetmacro{\convsep}{1.35}

\pgfmathsetmacro{\leftrow}{-0.75}
\pgfmathsetmacro{\rightrow}{7.25}
\pgfmathsetmacro{\middlerow}{(\rightrow+\leftrow)/2}
\pgfmathsetmacro{\boxheight}{1.55}
\pgfmathsetmacro{\boxwidth}{10}
\pgfmathsetmacro{\quadboxwidth}{24.35}

	\fill [white] (-3,-0.1) rectangle (10,-4.6);
	
	\draw   (\leftrow,\rooty+\convsep)   coordinate    (NoisyInput1)    {}
            (\leftrow+7.75mm,\rooty+\convsep)   coordinate    (NoisyInput2)    {}
	       (\rightrow,\rooty+\convsep)  coordinate    (MaskOut)    {}
            (\leftrow+.75,{\topconvs-0*\convsep}) node    (conv1)     [dspfilter, minimum width=\boxwidth em, minimum height=\boxheight em, fill=white] {Conv($F, N\times 1$)}
	       (\rightrow-0.75,{\topconvs-0*\convsep}) node    (convd1)     [dspfilter, minimum width=\boxwidth em, minimum height=\boxheight em, fill=white] {Conv($F, N\times 1$)}
            (\leftrow,{\topconvs-0.75*\convsep})   node    (skip_branch1)      [dspnodefull] {}
            ({\middlerow},{\topconvs-0.75*\convsep}) node    (dwconv1)     [dspfilter, minimum width=2.5em, minimum height=0.75em, fill=white] {$1\times 1$}
            (\rightrow,{\topconvs-0.75*\convsep})  node    (adder1)     [dspadder, scale=0.7, fill=white] {}
            (\leftrow+.75,{\topconvs-1.5*\convsep}) node    (conv2)     [dspfilter, minimum width=\boxwidth em, minimum height=\boxheight em, fill=white] {Conv($F, N\times 1$)$_{/2}$}
	       (\rightrow-0.75,{\topconvs-1.5*\convsep}) node    (convd2)     [dspfilter, minimum width=\boxwidth em, minimum height=\boxheight em, fill=white] {DeConv($F, N\times 1$)$_{/2}$}
        
            (\leftrow+.75,{\topconvs-2.5*\convsep}) node    (conv3)     [dspfilter, minimum width=\boxwidth em, minimum height=\boxheight em, fill=white] {Conv($2F, N\times 1$)}
	       (\rightrow-0.75,{\topconvs-2.5*\convsep}) node    (convd3)     [dspfilter, minimum width=\boxwidth em, minimum height=\boxheight em, fill=white] {Conv($2F, N\times 1$)}
        (\leftrow,{\topconvs-3.25*\convsep})   node    (skip_branch2)      [dspnodefull] {}
        ({\middlerow},{\topconvs-3.25*\convsep}) node    (dwconv2)     [dspfilter, minimum width=2.5em, minimum height=0.75em, fill=white] {$1\times 1$}
        (\rightrow,{\topconvs-3.25*\convsep})  node    (adder2)     [dspadder, scale=0.7, fill=white] {}
        (\leftrow+.75,{\topconvs-4*\convsep}) node    (conv4)     [dspfilter, minimum width=\boxwidth em, minimum height=\boxheight em, fill=white] {Conv($2F, N\times 1$)$_{/2}$}
	       (\rightrow-0.75,{\topconvs-4*\convsep}) node    (convd4)     [dspfilter, minimum width=\boxwidth em, minimum height=\boxheight em, fill=white] {DeConv($2F, N\times 1$)$_{/2}$}
        
        (\leftrow+.75,{\topconvs-5*\convsep}) node    (conv5)     [dspfilter, minimum width=\boxwidth em, minimum height=\boxheight em, fill=white] {Conv($3F, N\times 1$)}
	       (\rightrow-0.75,{\topconvs-5*\convsep}) node    (convd5)     [dspfilter, minimum width=\boxwidth em, minimum height=\boxheight em, fill=white] {Conv($3F, N\times 1$)}
        (\leftrow,{\topconvs-5.75*\convsep})   node    (skip_branch3)      [dspnodefull] {}
        ({\middlerow},{\topconvs-5.75*\convsep}) node    (dwconv3)     [dspfilter, minimum width=2.5em, minimum height=0.75em, fill=white] {$1\times 1$}
        (\rightrow,{\topconvs-5.75*\convsep})  node    (adder3)     [dspadder, scale=0.7, fill=white] {}
        (\leftrow+.75,{\topconvs-6.5*\convsep}) node    (conv6)     [dspfilter, minimum width=\boxwidth em, minimum height=\boxheight em, fill=white] {Conv($3F, N\times 1$)$_{/2}$}
	       (\rightrow-0.75,{\topconvs-6.5*\convsep}) node    (convd6)     [dspfilter, minimum width=\boxwidth em, minimum height=\boxheight em, fill=white] {DeConv($3F, N\times 1$)$_{/2}$}
                
              (\middlerow,{\topconvs-7.5*\convsep}) node    (BN)     [dspfilter, minimum width=\quadboxwidth em, minimum height=\boxheight em, fill=black!10] {Recurrent Bottleneck}
	       (\rightrow-0.75,{\topconvs+1*\convsep}) node    (out_conv)     [dspfilter, minimum width=\boxwidth em, minimum height=\boxheight em, fill=white] {Conv($2, N\times 1$)}
              (\leftrow+0.75,{\topconvs+1*\convsep}) node    (in_conc)     [dspfilter, minimum width=\boxwidth em, minimum height=\boxheight em, fill=yellow!20] {Concat};

	% labels for named Signals
	\draw  ([xshift=-5mm, yshift=-8mm] NoisyInput1)   node    (inputTop)       [label=above:$\mathbf{Y}_{\ell}$] {};
    \draw  ([xshift=-5mm, yshift=-8mm] NoisyInput2)   node    (inputTop)       [label=above:$\mathbf{X}_{\ell}$] {};
	\draw  ([xshift=5mm, yshift=-8mm] MaskOut)   node    (inputTop)       [label=above:$\mathbf{G}_{\ell}$] {};
	

    \draw ([xshift=8mm, yshift=-2mm] conv1.north) coordinate (conv1_data_in);
    \draw ([xshift=8mm, yshift=-2mm] conv2.north) coordinate (conv2_data_in);
    \draw ([xshift=8mm, yshift=-2mm] conv3.north) coordinate (conv3_data_in);
    \draw ([xshift=8mm, yshift=-2mm] conv4.north) coordinate (conv4_data_in);
    \draw ([xshift=8mm, yshift=-2mm] conv5.north) coordinate (conv5_data_in);
    \draw ([xshift=8mm, yshift=-2mm] conv6.north) coordinate (conv6_data_in);

    \draw ([xshift=-8mm, yshift=-2mm] convd1.north) coordinate (convd1_data_out);
    \draw ([xshift=-8mm, yshift=-2mm] convd2.north) coordinate (convd2_data_out);
    \draw ([xshift=-8mm, yshift=-2mm] convd3.north) coordinate (convd3_data_out);
    \draw ([xshift=-8mm, yshift=-2mm] convd4.north) coordinate (convd4_data_out);
    \draw ([xshift=-8mm, yshift=-2mm] convd5.north) coordinate (convd5_data_out);
    \draw ([xshift=-8mm, yshift=-2mm] convd6.north) coordinate (convd6_data_out);

	\draw ([xshift=-8mm, yshift=-2mm] out_conv.north) coordinate (out_data);

    \draw  (conv1_data_in)   node    (conv1_in)       [label=above:\scriptsize $L \times 1 \times C_\mathrm{in}$] {};
    \draw  (conv2_data_in)   node    (conv2_in)       [label=above:\scriptsize $L \times 1 \times F$] {};
    \draw  ([xshift=-0mm, yshift=-1mm] conv3_data_in)   node    (conv3_in)       [label=above:\scriptsize $L/2 \times 1 \times F$] {};
    \draw  ([xshift=-0mm, yshift=-0.5mm]conv4_data_in)   node    (conv4_in)       [label=above:\scriptsize $L/2 \times 1 \times 2F$] {};
    \draw  ([xshift=-0mm, yshift=-1mm] conv5_data_in)   node    (conv5_in)       [label=above:\scriptsize $L/4 \times 1 \times 2F$] {};
    \draw  ([xshift=-0mm, yshift=-0.5mm]conv6_data_in)   node    (conv6_in)       [label=above:\scriptsize $L/4 \times 1 \times 3F$] {};

    \draw  ([xshift=-0mm, yshift=-4mm] conv6_in)   node    (quadconv3_out_left)       [label=below:\scriptsize $L/8 \times 1 \times 3F$] {};
	\draw  ([xshift=-0mm, yshift=-4mm] convd6_data_out)   node    (quadconv3_out_right)       [label=below:\scriptsize $L/8 \times 1 \times C_\mathrm{rb}$] {};

    \draw  (convd1_data_out)   node    (convd1_out)       [label=above:\scriptsize $L \times 1 \times F$] {};
    \draw  (convd2_data_out)   node    (convd2_out)       [label=above:\scriptsize $L \times 1 \times F$] {};
    \draw  ([xshift=-0mm, yshift=-1mm] convd3_data_out)   node    (convd3_out)       [label=above:\scriptsize $L/2 \times 1 \times 2F$] {};
    \draw  ([xshift=-0mm, yshift=-0.5mm]convd4_data_out)   node    (convd4_out)       [label=above:\scriptsize $L/2 \times 1 \times 2F$] {};
    \draw  ([xshift=-0mm, yshift=-1mm] convd5_data_out)   node    (convd5_out)       [label=above:\scriptsize $L/4 \times 1 \times 3F$] {};
    \draw  ([xshift=-0mm, yshift=-0.5mm]convd6_data_out)   node    (convd6_out)       [label=above:\scriptsize $L/4 \times 1 \times 3F$] {};
	
	
	\draw  (out_data)   node    (out_data_node)       [label=above:\scriptsize $L \times 1 \times C_\mathrm{out}$] {};

    \draw ([xshift=-7.5mm] conv1.south) coordinate (conv1.out);
	\draw ([xshift=-7.5 mm] conv1.north) coordinate (conv1.in);
    \draw ([xshift=-7.5mm] conv2.south) coordinate (conv2.out);
	\draw ([xshift=-7.5 mm] conv2.north) coordinate (conv2.in);
    \draw ([xshift=-7.5mm] conv3.south) coordinate (conv3.out);
	\draw ([xshift=-7.5 mm] conv3.north) coordinate (conv3.in);
    \draw ([xshift=-7.5mm] conv4.south) coordinate (conv4.out);
	\draw ([xshift=-7.5 mm] conv4.north) coordinate (conv4.in);
    \draw ([xshift=-7.5mm] conv5.south) coordinate (conv5.out);
	\draw ([xshift=-7.5 mm] conv5.north) coordinate (conv5.in);
    \draw ([xshift=-7.5mm] conv6.south) coordinate (conv6.out);
	\draw ([xshift=-7.5 mm] conv6.north) coordinate (conv6.in);

    \draw ([xshift=7.5mm] convd1.south) coordinate (convd1.in);
	\draw ([xshift=7.5 mm] convd1.north) coordinate (convd1.out);
    \draw ([xshift=7.5mm] convd2.south) coordinate (convd2.in);
	\draw ([xshift=7.5 mm] convd2.north) coordinate (convd2.out);
    \draw ([xshift=7.5mm] convd3.south) coordinate (convd3.in);
	\draw ([xshift=7.5 mm] convd3.north) coordinate (convd3.out);
    \draw ([xshift=7.5mm] convd4.south) coordinate (convd4.in);
	\draw ([xshift=7.5 mm] convd4.north) coordinate (convd4.out);
    \draw ([xshift=7.5mm] convd5.south) coordinate (convd5.in);
	\draw ([xshift=7.5 mm] convd5.north) coordinate (convd5.out);
    \draw ([xshift=7.5mm] convd6.south) coordinate (convd6.in);
	\draw ([xshift=7.5 mm] convd6.north) coordinate (convd6.out);
    
	
	% \draw ([xshift=-35mm] quadconv1.north) coordinate (quadconv1.in1);
	% \draw ([xshift=35mm] quadconv1.north) coordinate (quadconv1.out2);
	% \draw ([xshift=-35mm] quadconv1.south) coordinate (quadconv1.out1);
	% \draw ([xshift=35mm] quadconv1.south) coordinate (quadconv1.in2);
	
	% \draw ([xshift=-35mm] quadconv2.north) coordinate (quadconv2.in1);
	% \draw ([xshift=35mm] quadconv2.north) coordinate (quadconv2.out2);
	% \draw ([xshift=-35mm] quadconv2.south) coordinate (quadconv2.out1);
	% \draw ([xshift=35mm] quadconv2.south) coordinate (quadconv2.in2);
	
	% \draw ([xshift=-35mm] quadconv3.north) coordinate (quadconv3.in1);
	% \draw ([xshift=35mm] quadconv3.north) coordinate (quadconv3.out2);
	% \draw ([xshift=-35mm] quadconv3.south) coordinate (quadconv3.out1);
	% \draw ([xshift=35mm] quadconv3.south) coordinate (quadconv3.in2);

    \draw ([xshift=-40mm] BN.north) coordinate (BN.in);
	\draw ([xshift=40mm] BN.north) coordinate (BN.out);
	
	% \draw ([xshift=-7.5 mm] clstm1.north) coordinate (clstm1.in);
	% \draw ([xshift=-7.5mm] clstm1.south) coordinate (clstm1.out);
	
	% \draw ([xshift=+7.5mm] clstm2.north) coordinate (clstm2.out);
	% \draw ([xshift=+7.5 mm] clstm2.south) coordinate (clstm2.in);
	
	\draw ([xshift=+7.5mm] out_conv.north) coordinate (out_conv.out);
	\draw ([xshift=+7.5 mm] out_conv.south) coordinate (out_conv.in);

    \draw ([xshift=-7.5mm] in_conc.south) coordinate (in_conc.out);
	\draw ([xshift=-7.5 mm] in_conc.north) coordinate (in_conc.in1);
    \draw ([xshift=+7.5 mm] in_conc.north) coordinate (in_conc.in2);
	
    % \begin{scope}[start chain]
    %     \chainin (NoisyInput2);
    %     \chainin (in_conc.in2)      [join=by dspconn];
    % \end{scope}

	\begin{scope}[start chain]
        \chainin (NoisyInput2);
        \chainin (in_conc.in2)      [join=by dspconn];

        \chainin (skip_branch1);
    	\chainin (dwconv1) [join=by dspconn];
    	\chainin (adder1) [join=by dspconn];
        \chainin (skip_branch2);
    	\chainin (dwconv2) [join=by dspconn];
    	\chainin (adder2) [join=by dspconn];
        \chainin (skip_branch3);
    	\chainin (dwconv3) [join=by dspconn];
    	\chainin (adder3) [join=by dspconn];

        \chainin (NoisyInput1);
        \chainin (in_conc.in1)      [join=by dspconn];
    	\chainin (in_conc.out);
        \chainin (conv1.in) 	[join=by dspconn];
    	\chainin (conv1.out);
        \chainin (conv2.in) 	[join=by dspconn];
    	\chainin (conv2.out); 
        \chainin (conv3.in) 	[join=by dspconn];
    	\chainin (conv3.out); 
        \chainin (conv4.in) 	[join=by dspconn];
    	\chainin (conv4.out); 
        \chainin (conv5.in) 	[join=by dspconn];
    	\chainin (conv5.out); 
        \chainin (conv6.in) 	[join=by dspconn];
    	\chainin (conv6.out); 

    	\chainin (BN.in) 		[join=by dspconn];
    	\chainin (BN.out);

        \chainin (convd6.in) 	[join=by dspconn];
        \chainin (convd6.out);
        \chainin (adder3) 	    [join=by dspconn];
        \chainin (convd5.in) 	[join=by dspconn];
        \chainin (convd5.out);
        \chainin (convd4.in) 	[join=by dspconn];
        \chainin (convd4.out);
        \chainin (adder2) 	    [join=by dspconn];
        \chainin (convd3.in) 	[join=by dspconn];
        \chainin (convd3.out);
        \chainin (convd2.in) 	[join=by dspconn];
        \chainin (convd2.out);
        \chainin (adder1) 	    [join=by dspconn];
        \chainin (convd1.in) 	[join=by dspconn];
        \chainin (convd1.out);

    	\chainin (out_conv.in) 	[join=by dspconn];
    	\chainin (out_conv.out);
    	\chainin (MaskOut) 	[join=by dspconn];

    \end{scope}
	
\end{tikzpicture}



\end{document}
