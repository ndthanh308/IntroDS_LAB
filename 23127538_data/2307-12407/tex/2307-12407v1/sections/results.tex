\section{Examples}

JAX FDM features a rich bank of goal functions that simplify the modeling of inverse-form-finding problems on various structural systems (Fig.~\ref{fig:structures}).
Here, we present two specific use cases with the current version of the library.

% Figure environment removed

\subsection{Shape approximation for shell structures}\label{sec:results:shell}

We want to calculate a network in static equilibrium for a shell that approximates the geometry $\hat{U}$ pictured in Fig.~\ref{fig:fdm_inverse}~\cite{panozzo_designing_2013}.
This target shape is supplied by the project architect as a COMPAS network~\cite{van_mele_compas_2017}.
JAX FDM offers functions to convert such a network into a JAX-friendly \texttt{jfe.EquilibriumStructure}.
This \texttt{structure} encodes the graph representation $G$ of the shell and its connectivity matrix $\mathbf{C}$ (Section~\ref{sec:method:fdm}).

% Code snippet
\inputminted[firstline=1,lastline=7]{python}{code/shell.py}

To compute a state of static equilibrium \texttt{eq\_state} with the FDM, we instantiate an \texttt{jfe.EquilibriumModel} and define $\theta$ as a tuple of design parameters, \texttt{params}.

% Code snippet
\inputminted[firstline=8,lastline=16]{python}{code/shell.py}

The \texttt{fdm} model is a callable object that expresses $f(\theta,G)$ and implements Eqs.~\ref{eq:xyz_free}-\ref{eq:forces}.
The initial vector of force densities is set to $\mathbf{q}=-\mathbf{1}$.
The negative values denote compressive internal forces in the edges of $G$.
The other arrays, \texttt{xyz\_fixed} and \texttt{loads}, store the 3D coordinates of the supports $\mathbf{X}_s$, and the loads $\mathbf{P}$ applied to the vertices of $G$, respectively.
Next, we set up an inverse form-finding problem in terms of $\mathbf{q}$ with two functions:

% Code snippet
\inputminted[firstline=19,lastline=26]{python}{code/shell.py}

The first one is a goal function $g(f(\theta,G))$, which quantifies the fitness of the shape approximation by measuring the cumulative distance between the \texttt{xyz} coordinates in static equilibrium of the vertices $V$ produced by \texttt{fdm}, and the \texttt{xyz\_target} coordinates on the objective surface.
% Additional target properties could be expressed with other target functions.
The second function represents Eq.~\ref{eq:loss}, which we minimize with an \texttt{optax} optimizer~\cite{babuschkin_deepmind_2020}:

% Code snippet
\inputminted[firstline=28, lastline=44]{python}{code/shell.py}

The object abstractions and equilibrium calculations in JAX FDM are compatible with JAX transformations, such as \texttt{jit} and \texttt{value\_and\_grad}.
This compatibility allows us to write the optimization step for $\mathbf{q}$ with the same code blocks conventionally used to train neural networks.

Post-optimization, the distance between the solution provided by $\mathbf{q}^{\star}$ and the target shape decreases by four orders of magnitude.
% from $17$\% to $0.001$\% of the diagonal length of the bounding box of the vault.
The fit is comparable with an input graph $G_{II}$ that has three times more edges and design parameters (Fig.~\ref{fig:fdm_inverse}).
This example is available in a Colab notebook at \href{https://tinyurl.com/25czahvh}{https://tinyurl.com/25czahvh}.


\subsection{Equalizing edge lengths in a cable net}\label{sec:results:cablenet}

% Figure environment removed

We design a self-stressed cable net inspired by the roof of the Rh√∂n Klinikum~\cite{oval_topology_2019}.
Building cable nets from standardized components is important for fabrication efficiency.
Therefore, we calculate a tension-only shape for the net that has a target edge length of $0.15$ m.
Fig.~\ref{fig:rhoen} displays the solution to the inverse form-finding problem.
The goal function $g(f(\theta,G))$ in this problem is:
% \vspace{-0.2in}
% \vskip -0.2in
\inputminted[firstline=2,lastline=5]{python}{code/rhoen.py}
% \vspace{-0.2in}
% \vskip -0.2in
After modeling the connectivity of the cable net as a \texttt{structure}, we can reuse the code blocks presented in Section~\ref{sec:results:shell} to obtain $\mathbf{q}^{\star}$.
The only requirement is to swap \texttt{goal\_fn} in the body of the loss function \texttt{loss\_fn}.
The composition and interchangeability of such atomic goal functions simplify the formulation of custom inverse form-finding problems with JAX FDM.
We applied a similar approach to generate the planar cable net shown in Fig.~\ref{fig:jax_logo}.