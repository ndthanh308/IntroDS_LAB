\usepackage{comment}
\usepackage{tikz}
\usetikzlibrary{bayesnet}

\usepackage{adjustbox}
\usepackage[inline]{enumitem}
\usepackage{subcaption}
\usepackage{multirow}


\usepackage[makeroom]{cancel}
%\usepackage[section]{placeins}



\newcommand{\R}{\mathbb{R}}

\newcommand{\vh}{\mathbf{h}}
\newcommand{\vv}{\mathbf{v}}
\newcommand{\vu}{\mathbf{u}}
\newcommand{\vvw}{\vv_{w}}
\newcommand{\vvwprime}{\vv_{w'}}
\newcommand{\nvb}{\mathrm{b}}
\newcommand{\bw}{\boldsymbol{w}}
\newcommand{\vtheta}{\boldsymbol{\theta}}
\newcommand{\vthetaopt}{\hat\vtheta}
\newcommand{\bb}{{\color{gray} \boldsymbol{b}}}
\newcommand{\ptheta}{p_{\vtheta}}
\newcommand{\pvu}{p_{\vu}}
\newcommand{\dataset}{\mathcal{D}}
\newcommand{\vocab}{\Sigma}

\newcommand{\loss}{\mathcal{L}}

%\newcommand{\argmax}{\mathrm{argmax}}

%\newcommand{\word}[1]{\textit{#1}}

%\usepackage{fontspec}

\newcommand{\vthetasub}{\vtheta \vtheta^\intercal}
\newcommand{\vthetasubnorm}{\frac{\vthetasub}{\mid\mid\vtheta\mid\mid^2_2}}
\newcommand{\vthetaoptsub}{\vthetaopt \vthetaopt^\intercal}
\newcommand{\vthetaoptsubnorm}{\frac{\vthetaoptsub}{\mid\mid\vthetaopt\mid\mid^2_2}}

\newcommand{\Ptheta}{\mathbf{P}_{\vtheta}}
\newcommand{\identity}{\mathbf{I}}
\newcommand{\wordcorrect}{w_{\mathrm{corr}}}
\newcommand{\wordincorrect}{w_{\mathrm{foil}}}
\newcommand{\wordfact}{w_{\mathrm{fact}}}
\newcommand{\wordfoil}{w_{\mathrm{foil}}}

\newcommand{\causaldo}{\mathrm{do}}
\newcommand{\boldg}{{\color{gray} \boldsymbol{g}}}


\newcommand{\V}{\mathbf{V}}
\newcommand{\Vsingular}{\V_{singular}}
\newcommand{\Vplural}{\V_{plural}}
\newcommand{\vsingular}{\mathbf{v}_{singular}}
\newcommand{\vplural}{\mathbf{v}_{plural}}

\newcommand{\calS}{\mathcal{S}}
\newcommand{\vA}{\mathrm{A}}
\newcommand{\va}{\mathbf{a}}
\newcommand{\calA}{\mathcal{A}}

\newcommand{\vV}{\mathbf{V}}
\newcommand{\vx}{\mathbf{x}}
\newcommand{\vy}{\mathbf{y}}
\newcommand{\vY}{\mathbf{Y}}
\newcommand{\calY}{\mathcal{Y}}
\newcommand{\singular}{\mathtt{singular}}
\newcommand{\plural}{\mathtt{plural}}
\newcommand{\softmax}{\mathrm{softmax}}
%\newcommand{\max}{\mathrm{max}}
%\newcommand{\min}{\mathrm{min}}
% \newcommand{\dataset}{\mathcal{D}}
\newcommand{\trainset}{\dataset_{\mathtt{train}}}
\newcommand{\proj}{\mathbf{P}}
\newcommand{\projtheta}{\proj_{\vtheta}}

\newcommand{\calW}{\mathcal{W}}
\newcommand{\calWcorrect}{\calW^{\mathtt{corr}}}
\newcommand{\calWincorrect}{\calW^{\mathtt{inc}}}

\newcommand{\context}{\mathbf{c}}
\newcommand{\vw}{\boldsymbol{v}_w}
\renewcommand{\vh}{\boldsymbol{h}}
\newcommand{\vwprime}{\boldsymbol{v}_{w'}}
\newcommand{\vhc}{\vh_{\context}}
\newcommand{\vP}{P}
\newcommand{\pvP}{p_{\vP}}
\newcommand{\ent}{\mathrm{H}}
\newcommand{\entq}{\ent_q}
\newcommand{\entz}{\ent_z}
\newcommand{\entV}{\ent_{\mathcal{V}}}
\newcommand{\vphi}{\boldsymbol{\phi}}
\newcommand{\projphi}{\proj_{\vphi}}
\newcommand{\pphi}{p_{\vphi}}
\newcommand{\funcphi}{f_{\vphi}}

\newcommand{\acc}{\mathrm{ACC}}

\newcommand{\one}{\mathbbm{1}}



\newcommand{\alphabet}{{\color{teal} \Sigma}}
\newcommand{\kleene}[1]{#1^*}
\newcommand{\plm}{p_{\mathrm{LM}}}
\newcommand{\pquestion}{p_{\mathrm{?}}}
\newcommand{\str}{{\color{teal} \boldsymbol{x}}}

\newcommand{\ct}{{\color{violet} c}_t}

\newcommand{\word}{{\color{teal} x}}
\newcommand{\wordt}{\word_t}

\newcommand{\cxt}{\str_{<t}}
\newcommand{\bh}{{\color{gray} \boldsymbol{h}}}
\newcommand{\eos}{{\color{teal} \textsc{eos}}}
\newcommand{\bos}{{\color{teal} \textsc{bos}}}
\newcommand{\eosalphabet}{{\color{teal} \overline{\alphabet}}}
%\newcommand{\cxtenc}{\small \textsf{enc}}
\newcommand{\cxtenc}{\bh(\cxt)}
\newcommand{\strenc}{\bh(\str)}
\newcommand{\wrdenc}{\mathbf{e}}
\newcommand{\bE}{\mathbf{E}}
\newcommand{\Rd}{\mathbb{R}^d}
\newcommand{\bHstr}{{\color{gray} \boldsymbol{H}(\str)}}
\newcommand{\punigram}{p_{u}}
\newcommand{\qunigram}{q_{u}}
\newcommand{\zunigram}{z_{u}}
% \newcommand{\rvW}{\mathrm{W}}
\newcommand{\rvX}{{\color{teal} X}}
\newcommand{\rvbX}{{\color{teal} \boldsymbol{X}}_{<t}}
\newcommand{\rvC}{{\color{violet} C}}
\newcommand{\rvCbin}{{\color{violet} C_{bin}}}
\newcommand{\rvH}{{\color{gray} \boldsymbol{H}}}
\newcommand{\rvHconcept}{\rvH_{\parallel}}
\newcommand{\rvHerase}{\rvH_{\bot}}
\newcommand{\repspace}{{\color{gray} \mathrm{H}}}
\newcommand{\repspacebot}{\repspace_{\bot}}
\newcommand{\repspacepar}{\repspace_{\parallel}}
%\newcommand{\linspace}{\mathcal{S}}
%\newcommand{\linspacec}{\mathcal{S}_{c}}
\newcommand{\linspace}{\mathrm{S}}
\newcommand{\linspacecomp}{\linspace^\bot}
\newcommand{\linspacec}{\linspace_{\concepts}}
%\newcommand{\linspacecortho}{\linspace_{\concept, \bot}}
\newcommand{\linspaceccomp}{\linspace^\bot_{\concepts}}



\newcommand{\MI}{\mathrm{I}}
\newcommand{\MIq}{\MI_q}
\newcommand{\MIz}{\MI_z}
\newcommand{\XMI}{\mathrm{XMI}}
\newcommand{\CE}{\mathrm{CE}}

\newcommand{\concepts}{{\color{violet} \mathcal{C}}}
\newcommand{\identc}{\iota_{c,\,\str_{<t}}}
%\newcommand{\identc}{\iota_{c}}
\newcommand{\identcw}{\identc(\xt)}
\newcommand{\identcinv}{\identc^{-1}}
\newcommand{\identcinvv}{\identcinv(v)}
\newcommand{\conceptvals}{\mathcal{V}_c}
\newcommand{\bv}{\boldsymbol{v}}

\newcommand{\bP}{\boldsymbol{P}}
\newcommand{\bQ}{\boldsymbol{Q}}

\newcommand{\MILM}{\MI_{\mathrm{LM}}}
\newcommand{\pair}{\conceptf{pair}}
\newcommand{\pairs}{\conceptf{pairs}}
\newcommand{\Npairs}{\mathrm{N}_{\pairs}}
\newcommand{\concepteosalphabet}{\eosalphabet_{c}}
\newcommand{\KL}{\mathrm{D}_{\mathrm{KL}}}

\newcommand{\expectation}{\mathop{\mathbb{E}}}

%\newcommand{\identctx}{\iota_{\str}}
\newcommand{\conceptseq}{{\color{violet} \boldsymbol{c}}}
\newcommand{\pconcept}{p}
\newcommand{\pdo}{p_{\mathrm{do}}}

\newcommand*{\myfont}{\fontfamily{pcr}\selectfont}
\newcommand{\wordf}[1]{{\color{teal}  \textit{#1}}}
\newcommand{\conceptf}[1]{{{\color{violet}\texttt{#1}}}}

\newcommand{\lemmarv}{\color{blue} l}
\newcommand{\lemmaf}[1]{{\color{blue}  \textit{#1}}}

\usepackage{relsize}
\newcommand*{\mysecondfont}{\fontfamily{lmr}\selectfont}
\newcommand{\conceptval}[1]{{\color{violet} \textnormal{\textsf{\small #1}}}}
\newcommand{\conceptvalfootnote}[1]{{\color{violet} \textsf{\footnotesize #1}}}
\newcommand{\concept}{{\color{violet} c}}

\newcommand{\bS}{\mathbf{S}}
\newcommand{\eye}{\boldsymbol{I}}

\newcommand{\bQk}{\bQ_k}
\newcommand{\bPk}{\bP}
\newcommand{\eyeminusP}{\eye_d - \bP}
\newcommand{\eyeminusPk}{\eye_d - \bPk}
\newcommand{\eyeminusPkh}{(\eyeminusPk)\,\bh}
\newcommand{\bPkh}{\bPk\,\bh}

\newcommand{\projspace}{\mathcal{P}}
\newcommand{\projspacek}{\projspace_{k}}

\newcommand{\ci}{\perp\!\!\!\perp}
\newcommand{\bgc}{\boldg(\concept)}



% colors
\newcommand{\edgecolor}[1]{{\color{Mahogany} #1}}
\newcommand{\backdoorcolor}[1]{{\color{BlueViolet} #1}}
 
\newcommand{\graphG}{{\color{olive} \mathrm{G}}}
\newcommand{\justify}[1]{\text{\color{darkblue} (#1)}}

%\newcommand{\citeposs}[1]{\citeauthor{#1}'s (\citeyear{#1})}

% new samples
\newcommand{\ptilde}{\widetilde{p}}
\newcommand{\ptildeunigram}{\widetilde{p}_u}
%\newcommand{\MInat}{\MI_{\ptilde_{\textit{nat}}}}
%\newcommand{\MInuc}{\MI_{\ptilde_{\textit{nuc}}}}
\newcommand{\MInat}{\widetilde{\MI}_{\textit{nat}}}
\newcommand{\MInuc}{\widetilde{\MI}_{\textit{nuc}}}

\renewcommand{\ryanchange}[1]{{\color{red} #1}}

\newcommand{\modelnamef}[1]{\texttt{#1}}

\newcommand{\bhbot}{\bh_\bot}
\newcommand{\bhpar}{\bh_\parallel}

\makeatletter
\setlength{\@fptop}{0pt}
\makeatother

\usepackage{array}
\newcommand{\PreserveBackslash}[1]{\let\temp=\\#1\let\\=\temp}
\newcolumntype{C}[1]{>{\PreserveBackslash\centering}p{#1}}
\newcolumntype{R}[1]{>{\PreserveBackslash\raggedleft}p{#1}}
\newcolumntype{L}[1]{>{\PreserveBackslash\raggedright}p{#1}}


% new macros for detailed MI breakdown in appendix
\newcommand{\bword}{{\color{teal} \boldsymbol{w}}}
\newcommand{\rvW}{{\color{teal} W}}
\newcommand{\cxtencprime}{\bh(\cxtprime)}

\newcommand{\eosalphabetnewword}{{\eosalphabet_{nw}}}
\newcommand{\cxtprime}{\str'_{<t'}}

\newcommand{\qunigrambot}{\qunigram^\bot}
\newcommand{\qunigrampar}{\qunigram^\parallel}
\newcommand{\MIqbot}{\MI_{q^\bot}}
\newcommand{\MIqpar}{\MI_{q^\parallel}}
\newcommand{\entqbot}{\ent_{q^\bot}}
\newcommand{\entqpar}{\ent_{q^\parallel}}

\newcommand{\wordsum}{\sum_{\word \in \alphabet}}
\newcommand{\wordsumprime}{\sum_{\word' \in \alphabet}}
\newcommand{\conceptsum}{\sum_{\concept \in \concepts}}
\newcommand{\conceptsumprime}{\sum_{\concept' \in \concepts}}
\newcommand{\bhsum}{\sum_{\bh \in \repspace}}
\newcommand{\bhsumprime}{\sum_{\bh' \in \repspace}}
\newcommand{\bhbotsum}{\sum_{\bhbot \in \repspacebot}}
\newcommand{\bhbotsumprime}{\sum_{\bhbot' \in \repspacebot}}
\newcommand{\bhparsum}{\sum_{\bhpar \in \repspacepar}}
\newcommand{\bhparsumprime}{\sum_{\bhpar' \in \repspacepar}}
\newcommand{\bwordsum}{\sum_{\bword \in {\color{teal}\mathcal{W}}}}
\newcommand{\bwordsumprime}{\sum_{\bword' \in {\color{teal}\mathcal{W}}}}
\newcommand{\cxtsum}{\sum_{\cxt \in \kleene{\alphabet}}}
\newcommand{\cxtsumprime}{\sum_{\cxtprime \in \kleene{\alphabet}}}
