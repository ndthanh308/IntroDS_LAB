\documentclass[%
%reprint,
%superscriptaddress,
%groupedaddress,
%unsortedaddress,
%runinaddress,
%frontmatterverbose, 
 preprint,
%preprintnumbers,
%nofootinbib,
%nobibnotes,
%bibnotes,
 amsmath,
 amssymb,
 aps, 
%prl,
%pra,
%prb,
%rmp,
%prstab,
%prstper,
%floatfix,
]{revtex4-2}

% \usepackage{CJK}
\usepackage{graphicx}
\usepackage{caption}
% \usepackage{subcaption}
\usepackage{xcolor}
\usepackage{mathtools}
\usepackage{physics}

\usepackage{amsmath}
\DeclareFontFamily{U}{mathb}{}
\DeclareFontShape{U}{mathb}{m}{n}{
  <-5.5> mathb5
  <5.5-6.5> mathb6
  <6.5-7.5> mathb7
  <7.5-8.5> mathb8
  <8.5-9.5> mathb9
  <9.5-11.5> mathb10
  <11.5-> mathb12
}{}
\DeclareSymbolFont{mathb}{U}{mathb}{m}{n}
\DeclareMathSymbol{\ulsh}{3}{mathb}{"E8}
\DeclareMathSymbol{\ursh}{3}{mathb}{"E9}
\DeclareMathSymbol{\dlsh}{3}{mathb}{"EA}
\DeclareMathSymbol{\drsh}{3}{mathb}{"EB}

\newcommand{\com}[1]{{\color{red}#1}}

% \usepackage{newtxmath}
\bibliographystyle{apsrev4-2}

\begin{document}

% \begin{CJK*}{GB}{} % Use default fonts from CJK (see below)

% Title of the paper
\title{{\normalsize\normalfont Near-wall depletion and layering affect contact line friction of multicomponent liquids}\\Supplementary Information}

\author{M.~Pellegrino}
\author{B.~Hess}
\affiliation{Swedish e-Science Research Centre, Science for Life Laboratory,
Department of Applied Physics KTH, 100 44 Stockholm, Sweden}

\maketitle

%%%%%%%%%%%%%%%%%%%%%%%
%%% MATERIAL PARAMS %%%
%%%%%%%%%%%%%%%%%%%%%%%
\section{Material parameters}  \label{app:material-parameters}

In this section we report the results of the calculation of some material and kinetic parameters which substantiate the finding of the main article. We also report the Gromacs commands used to compute said parameters.

The density profile of aqueous glycerol solutions along one direction can be computed from configurations of type BOX (table 1 in the main article) by simply running \texttt{gmx density} and supplying the molecular trajectory (\texttt{.trr} file, \texttt{-f} flag) and the binary topology file (\texttt{.tpr} file, \texttt{-s} flag). The average density is then obtained simply by running \texttt{gmx analyze -av} and supplying the \texttt{density.xvg} file to the \texttt{-f} flag.

% Figure environment removed

Figure \ref{fig:density} reports the average density as a function of the mass fraction of glycerol and a comparison with the experimental data by Volk and KÃ¤hler \cite{volk2018glydens}.

\vspace{\abovedisplayskip}
\begin{minipage}[htbp]{\textwidth}
    \begin{minipage}[b]{0.49\textwidth}
        \centering
        % Figure removed
    \end{minipage}
    \hspace{-0.07\textwidth}
    % \hfill
    \begin{minipage}[b]{0.49\textwidth}
        \centering
        \begin{tabular}{ l | l | l }
            $\alpha_g$ & SASA water & SASA glycerol \\
                & [nm$^2$] & [nm$^2$] \\
            \hline
            0.2 & 123.3$\pm$0.6 & 31.3$\pm$0.5 \\  
            0.4 & 90.9$\pm$0.6 & 54.0$\pm$0.4 \\  
            0.6 & 61.6$\pm$0.6 & 88.1$\pm$0.6 \\  
            0.8 & 30.1$\pm$0.3 & 116.4$\pm$0.3
        \end{tabular}
        \vspace{0.5cm}
    \end{minipage}
    \captionof{figure}{Left: visualization of a system of type SLAB. Right: solvent accessible surface area of water and glycerol w.r.t. the interface with vapor.}
    \label{fig:param2}
\end{minipage}
\vspace{\belowdisplayskip}

The SASA (solvent accessible surface area) is computed from systems of type SLAB using the command \texttt{gmx sasa}; we refer to Gromacs documentation for a detailed explanation of the command functionality \cite{gmxdoc}. 

\begin{table}
    \centering
    \begin{tabular}{ r | r || l l l l | c | c }
    & & $r_c=$ & & & & PME & Experimental \\
    & $\alpha_g$ & 1.0 nm & 1.2 nm & 1.4 nm & 1.6 nm & Lennard-Jones & from \cite{takamura2012glycerol} \\
    \hline
    $\sigma$ [10$^{-2}$ Pa$\cdot$m] & 0   & 5.59$\pm$0.03 &5.80$\pm$0.01 & 5.89$\pm$0.01 & 5.97$\pm$0.01 & 6.22$\pm$0.06 & 7.22 \\
    & 0.2	& 5.56$\pm$0.08 & 5.79$\pm$0.01 & 5.91$\pm$0.02 & 6.03$\pm$0.02 & 6.10$\pm$0.03 & 7.1 \\
    & 0.4	& 5.56$\pm$0.04 & 5.85$\pm$0.03	& 6.03$\pm$0.03 & 6.16$\pm$0.02	& 6.50$\pm$0.02 & 6.91 \\
    & 0.6	& 5.60$\pm$0.12 & 5.90$\pm$0.02	& 6.05$\pm$0.04 & 6.20$\pm$0.05	& 6.61$\pm$0.06 & 6.77 \\
    & 0.8	& 5.49$\pm$0.24 & 5.89$\pm$0.04	& 6.10$\pm$0.04 & 6.20$\pm$0.06	& 6.57$\pm$0.06 & 6.67 \\
    & 1	& 5.89$\pm$0.29 & 5.62$\pm$0.20	&6.10$\pm$0.21 & 6.24$\pm$0.17	& 6.53$\pm$0.29 & 6.3 \\
    \end{tabular}
    \caption{Liquid-vapour surface tension for different glycerol concentrations and different Lennard-Jones cutoff radii, compared to PME Lennard-Jones and experimental results.}
    \label{tab:surftens-cutoff}
\end{table}

% Figure environment removed

The calculation of surface tension may be inaccurate due to the long-range treatment of dispersion forces or due to limitations in the water model. Table \ref{tab:surftens-cutoff} reports the effect of the real-space truncation of the Lennard-Jones potential, in relation to the full PME calculation and the experimental results. Figure \ref{fig:surftens-tip4-exp} compares the results for SPC/E with the ones obtained with TIP4P/2005, again alongside experimental data \cite{takamura2012glycerol}.

% Figure environment removed

% Figure environment removed

We have quantified how sensitive the estimate of contact line friction (from equation 1 in the main article) is to the change of surface tension, assuming the spreading dynamics remains the same and fixing either (i) the equilibrium contact angle, or (ii) the difference between solid-vapour and solid-liquid surface energies ($\sigma_{SV}-\sigma_{SL}$). We then estimated the error in the calculation of contact line friction using:
\begin{equation}    \label{eq:sensitivity-cl-friction}
    \begin{dcases}
        \widehat{\mu}_f = \frac{\widehat{\sigma}}{\sigma} \mu_f & \mbox{case (i)} \\
        \widehat{\mu}_f = \mu_f - \expval{\frac{\cos\theta(t)}{u_{cl}(t)}}\big(\widehat{\sigma}-\sigma\big) & \mbox{case (ii)} \\
    \end{dcases} \; ,
\end{equation}
where $\widehat{\sigma}$ is either the experimental surface tension or (a) the one computed using TIP4P/2005 and 1 nm LJ cutoff; (b) the one computed using SPC/E and LJ PME . The symbol $\expval{\cdot}$ indicates the average over the spreading process. Figures \ref{fig:sensitivity} and \ref{fig:pme-lj} show the effect of the perturbation of surface tension on the scaling between contact line friction and viscosity (figure 3b in the manuscript under revision), which is negligible. This result is not surprising, since the change of surface tension for different values of $\alpha_g$, computed either from MD or obtained experimentally, is much smaller than the change in viscosity.\\

%%%%% UPDATE %%%%%
% {\color{red}

% \vspace{\abovedisplayskip}
% \begin{minipage}[htbp]{\textwidth}
%     \begin{minipage}[b]{0.49\textwidth}
%        \centering
%        % Figure removed
%    \end{minipage}
    % \hspace{-0.07\textwidth}
    % \hfill
%    \begin{minipage}[b]{0.49\textwidth}
%        \centering
%        % Figure removed
%        \vspace{-0.2cm}
%    \end{minipage}
%    \captionof{figure}{Left: visualization of a three-dimensional droplet sitting on silica. Right distribution of h-bond lifetime for $\alpha_g=0.4$ (mean reported in the legend).}
%    \label{fig:param4}
%\end{minipage}
%\vspace{\belowdisplayskip}

%The lifetime of hydrogen bonds between liquid and solid molecules is computed using the command \texttt{gmx hbond -life}. In order to maximize the area of the liquid-solid interface trajectories from fully three-dimensional droplets in equilibrium on silica surfaces were used (figure \ref{fig:param4}), instead of systems of type DROP I or DROP II. This is necessary due to the computational cost of the h-bond lifetime computation, which is feasible only for short detailed trajectories (2 ns, sampled every 10 ps).

%}
%%%%%%%%%%%%%%%%%%


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%%% Best fit of the linear friction model %%%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Best fit of the linear friction model}   \label{app:best-fit}

In this section we illustrate some of the technical aspects of the data processing for systems of type DROP II. The contact line displacement (obtained according to the procedure mentioned in appendix B in the main article) and the spreading time are first made non-dimensional by dividing by the initial radius $R_0=20$ nm and the viscous-capillary time $\tau=303.5$ ps. A characteristic spreading velocity is obtained as $V_0=R_0/\tau$ and it is used to re-obtain dimensional spreading velocities after data processing.
Since the spreading process slows down in time, a uniform sampling of contact line displacements and contact angles produces a distribution of observations biased towards smaller values. In order to alleviate undesirable over-fitting of the long-time dynamics and under-fitting of the fast dynamics, we re-sample observations in order to obtain a uniform distribution of contact line velocities.

\begin{table}
\begin{center}
\begin{tabular}{ l | l || l | l | l | l | l } 
                  & $\alpha_g$ & $\zeta=0.001$ & $\zeta=0.01$ & $\zeta=0.1$ & $\zeta=1$ & $\zeta=10$    \\
\hline 
 $\mu_f/\eta$ []  & 0   & 5.46$\pm$0.07 & 5.45$\pm$0.08 & 5.46$\pm$0.06 & 5.45$\pm$0.03 & 5.45$\pm$0.06 \\ 
                  & 0.2 & 4.08$\pm$0.05 & 4.07$\pm$0.06 & 4.09$\pm$0.06 & 4.17$\pm$0.07 & 4.44$\pm$0.10 \\ 
                  & 0.4 & 3.77$\pm$0.12 & 3.77$\pm$0.10 & 3.78$\pm$0.08 & 3.93$\pm$0.09 & 4.22$\pm$0.07 \\ 
                  & 0.6 & 2.60$\pm$0.07 & 2.61$\pm$0.07 & 2.61$\pm$0.06 & 2.71$\pm$0.06 & 2.82$\pm$0.02 \\ 
                  & 0.8 & 1.28$\pm$0.03 & 1.28$\pm$0.03 & 1.29$\pm$0.04 & 1.34$\pm$0.03 & 1.44$\pm$0.01 \\
\hline
 $\theta_0$ [deg] & 0   & 48.9$\pm$0.4  & 49.0$\pm$0.4  & 48.9$\pm$0.3  & 48.9$\pm$0.1  & 48.9$\pm$0.1 \\ 
                  & 0.2 & 50.2$\pm$0.5  & 50.3$\pm$0.5  & 50.1$\pm$0.5  & 49.6$\pm$0.5  & 47.6$\pm$0.1 \\ 
                  & 0.4 & 50.0$\pm$0.8  & 49.9$\pm$0.6  & 49.8$\pm$0.6  & 49.0$\pm$0.6  & 47.1$\pm$0.3 \\ 
                  & 0.6 & 53.7$\pm$0.7  & 53.6$\pm$0.7  & 53.7$\pm$0.6  & 52.5$\pm$0.6  & 51.4$\pm$0.1 \\ 
                  & 0.8 & 57.3$\pm$0.8  & 57.3$\pm$0.7  & 57.2$\pm$0.9  & 55.8$\pm$0.8  & 53.4$\pm$0.1 \\ 
\end{tabular}
\caption{Results of the uncertainty quantification procedure (average $\pm$ standard deviation) for each of the model parameters, for different weight values.}
\label{tab:uncert}
\end{center}
\end{table}

The contact line friction is obtained by minimizing the loss function presented in equation 9 in the main article. Table \ref{tab:uncert} reports the value of contact line friction and equilibrium contact angle obtained upon changing the value of the penalization coefficient $\zeta$. The error bars refer to the standard deviation obtained by performing bootstrapping with 20\% of the data, repeated 25 times.

%%%%%%%%%%%%%%%%%
%%% VISCOSITY %%%
%%%%%%%%%%%%%%%%%
\section{Viscosity}     \label{sec:viscosity}

In this last section we provide additional technical details on the calculation of viscosity using Einstein's relation. In order to obtain an accurate estimate of viscosity we follow the approach of Zhang et al. \cite{zhang2015viscosity} and combine averaging over time to averaging over independent realization of the same observable. The integral in time of the off-diagonal stress tensor components used in Einstein's relation behaves as a Browinan process with correlated noise. Computing viscosity from a single realization would require a surprisingly long trajectory. Running several short replicas in parallel is much more time efficient.

Several independent replicas can be sampled from a sufficiently long NVT equilibrium simulation by sequentially running:\\
\texttt{gmx trjconv -dump <time-to-dump> -f traj.trr -s topol.tpr}\\
$\drsh$ \texttt{-o frame-<frame-number>.gro}\\
The integral of the off-diagonal components of the stress tensor can be obtained given the energy file (\texttt{.edr}) by running:\\
\texttt{gmx energy -f ener.edr -vis -evisco -eviscoi}

For an accurate computation we set \texttt{nstcalcenergy=1} in the molecular dynamics configuration file (\texttt{.mdp}), i.e. energy observables are computed every time step. This is necessary in order to correctly sample the velocity autocorrelation function in time. Since we are interested in the long-time behavior of the integral it is unnecessary to output energy every step and it is sufficient to set \texttt{nstenergy=100}.

% Figure environment removed

% Figure environment removed

Figures \ref{fig:visco1}a and \ref{fig:visco2}a report the integral returned by \texttt{gmx energy -eviscoi} for each replica and its average, for $\alpha_g=0$ and $\alpha_g=0.8$. It can be noted how the Brownian behavior of the observable leads to more uncertain estimates for longer times. We compute the relative standard error for each fixed time frame across 60 replicas and impose an arbitrary threshold of $7.5\%$. 

% Figure environment removed

Viscosity is obtained via linear regression of the integral up to the time when the estimated relative standard error reaches the threshold. The regression is inversely weighted on the relative standard error. We also discard an initial time window corresponding to a `spin-up time': it is know from linear response theory that the long-time behavior in time of the average of the integral should be linear; the initial super-linear growth rate regime is identified by visual inspection (figure \ref{fig:visco3}) and discarded. The uncertainty on the value of the shear viscosity coefficient is estimated by randomly removing 20\% of replicas and repeating the coefficient estimation 20 times.

\bibliography{apssamp}

\end{document}