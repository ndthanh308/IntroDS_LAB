base_img_to_pos_txt_sim = [0.4281, 0.4301, 0.4338, 0.4361, 0.4369, 0.4375, 0.4432, 0.4414, 0.4438, 0.4421, 0.4465, 0.4468, 0.4451, 0.4427, 0.4462, 0.4422, 0.4414, 0.444, 0.4431, 0.4407, 0.4445, 0.4437, 0.4396, 0.4387, 0.4355, 0.4343, 0.4296, 0.4232, 0.4147, 0.4087, 0.4047, 0.4032]
base_img_to_neg_txt_sim = [0.1638, 0.1558, 0.1625, 0.1579, 0.1579, 0.1592, 0.1656, 0.1687, 0.1684, 0.1693, 0.164, 0.1639, 0.1659, 0.1635, 0.1697, 0.1619, 0.1671, 0.1647, 0.1622, 0.1634, 0.1661, 0.1625, 0.1584, 0.1587, 0.1527, 0.1487, 0.1421, 0.1273, 0.1142, 0.1009, 0.0892, 0.0837]
base_txt_to_pos_img_sim = [0.4281, 0.4301, 0.4338, 0.4361, 0.4369, 0.4375, 0.4432, 0.4414, 0.4438, 0.4421, 0.4465, 0.4468, 0.4451, 0.4427, 0.4462, 0.4422, 0.4414, 0.444, 0.4431, 0.4407, 0.4445, 0.4437, 0.4396, 0.4387, 0.4355, 0.4343, 0.4296, 0.4232, 0.4147, 0.4087, 0.4047, 0.4032]
base_txt_to_neg_img_sim = [0.1638, 0.1558, 0.1625, 0.1579, 0.1579, 0.1592, 0.1656, 0.1687, 0.1684, 0.1693, 0.164, 0.1639, 0.1659, 0.1635, 0.1697, 0.1619, 0.1671, 0.1647, 0.1622, 0.1634, 0.1661, 0.1625, 0.1584, 0.1587, 0.1527, 0.1487, 0.1421, 0.1273, 0.1142, 0.1009, 0.0892, 0.0837]


kd_img_to_pos_txt_sim=  [0.4104, 0.4154, 0.409, 0.4072, 0.4051, 0.4069, 0.4123, 0.4105, 0.4131, 0.414, 0.4139, 0.4199, 0.4201, 0.4224, 0.422, 0.4266, 0.4243, 0.4288, 0.4284, 0.4297, 0.4322, 0.4364, 0.4368, 0.4389, 0.4414, 0.4416, 0.4426, 0.4463, 0.4474, 0.4492, 0.45, 0.4502]
kd_img_to_neg_txt_sim = [0.0732, 0.0702, 0.0756, 0.0759, 0.0792, 0.0819, 0.0824, 0.0806, 0.0825, 0.0832, 0.0791, 0.0836, 0.0813, 0.0834, 0.0815, 0.0847, 0.0827, 0.0843, 0.0828, 0.084, 0.0826, 0.0821, 0.0835, 0.0832, 0.0841, 0.083, 0.0814, 0.0832, 0.0846, 0.0843, 0.0837, 0.0836]
kd_txt_to_pos_img_sim = [0.4104, 0.4154, 0.409, 0.4072, 0.4051, 0.4069, 0.4123, 0.4105, 0.4131, 0.414, 0.4139, 0.4199, 0.4201, 0.4224, 0.422, 0.4266, 0.4243, 0.4288, 0.4284, 0.4297, 0.4322, 0.4364, 0.4368, 0.4389, 0.4414, 0.4416, 0.4426, 0.4463, 0.4474, 0.4492, 0.45, 0.4502]
kd_txt_to_neg_img_sim = [0.0732, 0.0702, 0.0756, 0.0759, 0.0792, 0.0819, 0.0824, 0.0806, 0.0825, 0.0832, 0.0791, 0.0836, 0.0813, 0.0834, 0.0815, 0.0847, 0.0827, 0.0843, 0.0828, 0.084, 0.0826, 0.0821, 0.0835, 0.0832, 0.0841, 0.083, 0.0814, 0.0832, 0.0846, 0.0843, 0.0837, 0.0836]

import numpy as np

import matplotlib.pyplot as plt
base_img = np.array(base_img_to_pos_txt_sim) - np.array(base_img_to_neg_txt_sim)
base_txt = np.array(base_txt_to_pos_img_sim) - np.array(base_txt_to_neg_img_sim)

kd_img = np.array(kd_img_to_pos_txt_sim) - np.array(kd_img_to_neg_txt_sim)
kd_txt = np.array(kd_txt_to_pos_img_sim) - np.array(kd_txt_to_neg_img_sim)

epochs = np.arange(32)+1



kd_imagenet_top1=[0.1256, 0.1745, 0.1895, 0.1965, 0.2054, 0.2139, 0.2177, 0.2163, 0.2235, 0.2242, 0.2365, 0.241, 0.2433, 0.2519, 0.2566, 0.2579, 0.2634, 0.2715, 0.2734, 0.2826, 0.2875, 0.2981, 0.3011, 0.3107, 0.3154, 0.3238, 0.3296, 0.3367, 0.3434, 0.346, 0.3484, 0.3489]
kd_imagenet_top5= [0.3097, 0.3848, 0.4116, 0.4179, 0.4356, 0.4452, 0.4578, 0.4547, 0.4607, 0.4667, 0.4862, 0.4868, 0.4912, 0.5052, 0.5186, 0.5148, 0.5218, 0.5283, 0.5319, 0.5457, 0.5541, 0.5646, 0.5689, 0.5756, 0.5888, 0.5955, 0.6042, 0.6094, 0.6163, 0.6202, 0.6237, 0.624]
kd_img_anchor=[0.1159, 0.175, 0.2008, 0.2095, 0.2157, 0.2276, 0.233, 0.2389, 0.2423, 0.2458, 0.2529, 0.259, 0.2636, 0.2726, 0.2803, 0.2844, 0.2845, 0.2927, 0.3028, 0.3063, 0.318, 0.3258, 0.3308, 0.3341, 0.3449, 0.3563, 0.3607, 0.3689, 0.371, 0.38, 0.3821, 0.3821]
kd_txt_anchor=[0.115, 0.1739, 0.1933, 0.2061, 0.215, 0.2204, 0.2293, 0.2341, 0.238, 0.2401, 0.2484, 0.2549, 0.2576, 0.2637, 0.2713, 0.272, 0.2772, 0.2818, 0.2939, 0.2981, 0.3074, 0.3211, 0.3262, 0.3282, 0.3386, 0.3552, 0.3587, 0.3649, 0.3695, 0.3738, 0.379, 0.3793]

base_imagenet_top1=[0.0924, 0.13, 0.1468, 0.1558, 0.1642, 0.1691, 0.1753, 0.1791, 0.1834, 0.1871, 0.1911, 0.1939, 0.1982, 0.2067, 0.2086, 0.213, 0.2211, 0.2289, 0.2294, 0.236, 0.2426, 0.2558, 0.2613, 0.2707, 0.2749, 0.2821, 0.2862, 0.2922, 0.2988, 0.3026, 0.3023, 0.3019]
base_imagenet_top5=[0.2392, 0.3042, 0.3302, 0.3499, 0.3615, 0.3736, 0.3781, 0.3925, 0.3928, 0.3956, 0.4054, 0.4101, 0.4182, 0.432, 0.436, 0.4396, 0.4529, 0.4657, 0.4671, 0.4792, 0.4931, 0.5075, 0.5092, 0.5221, 0.5324, 0.5398, 0.5479, 0.5535, 0.5563, 0.562, 0.564, 0.5628]
base_img_anchor=[0.0833, 0.1269, 0.1449, 0.1571, 0.17, 0.1788, 0.1859, 0.184, 0.198, 0.1995, 0.2067, 0.2156, 0.2212, 0.2217, 0.2325, 0.2363, 0.2408, 0.2425, 0.2549, 0.2584, 0.269, 0.2822, 0.2908, 0.2946, 0.3024, 0.3098, 0.3199, 0.3226, 0.3215, 0.3254, 0.3238, 0.3239]
base_txt_anchor=[0.0757, 0.1178, 0.1323, 0.1511, 0.1574, 0.1659, 0.1762, 0.1735, 0.1857, 0.1864, 0.1947, 0.1943, 0.2046, 0.2121, 0.2195, 0.2195, 0.2215, 0.232, 0.2459, 0.251, 0.2498, 0.2661, 0.2777, 0.2808, 0.2875, 0.2986, 0.3096, 0.3159, 0.3194, 0.3208, 0.3235, 0.3228]

base_loss = [3.683, 2.210, 1.890, 1.762, 1.673,1.603,1.544,1.499,1.462,1.417,1.389,1.347,1.309,1.263,1.222,1.182,1.119,1.082,1.035,0.9757,0.9109,0.8488,0.7834,0.7125,0.6224,0.5433,0.4549,0.3702,0.2934,0.2365,0.1983,0.1851]
kd_task= [3.314, 1.716, 1.421, 1.313, 1.253, 1.205, 1.156, 1.121, 1.094, 1.056, 1.033, 1.004, 0.9724, 0.9363, 0.91, 0.8756, 0.8323, 0.7944, 0.7607, 0.7152, 0.6675, 0.6182, 0.5735, 0.5174, 0.4506, 0.4004, 0.3412, 0.2876, 0.2422, 0.211, 0.1898, 0.1813]
ICL =[5.183, 2.028, 0.9525, 0.6917, 0.6098, 0.5723, 0.5456, 0.5262, 0.5164, 0.4959, 0.4822, 0.4736, 0.4541, 0.4383, 0.4267, 0.4104, 0.3918, 0.3765, 0.362, 0.3414, 0.3227, 0.304, 0.2846, 0.2648, 0.2397, 0.2237, 0.2034, 0.1866, 0.1687, 0.1584, 0.1519, 0.1503]
kd_loss= [3.238, 1.638, 1.341, 1.234, 1.175, 1.127, 1.076, 1.042, 1.015, 0.9759, 0.9565, 0.9249, 0.8954, 0.8566, 0.8328, 0.7964, 0.754, 0.7159, 0.683, 0.6385, 0.592, 0.5453, 0.5014, 0.448, 0.3834, 0.3352, 0.282, 0.234, 0.1935, 0.1669, 0.1484, 0.141]
fd =[4.693, 2.831, 2.455, 2.31, 2.236, 2.174, 2.117, 2.072, 2.033, 1.988, 1.953, 1.914, 1.875, 1.833, 1.794, 1.748, 1.705, 1.661, 1.613, 1.565, 1.517, 1.464, 1.414, 1.363, 1.307, 1.257, 1.207, 1.158, 1.117, 1.082, 1.058, 1.049]


plt.subplot(141)
plt.plot(epochs,np.array(base_loss),label='Student: Task loss')
plt.plot(epochs,np.array(kd_task), label='CLIP-KD: Task loss')
plt.plot(epochs,np.array(ICL), label='CLIP-KD: ICL loss')
plt.plot(epochs,np.array(kd_loss), label='CLIP-KD: CRD loss')
plt.plot(epochs,np.array(fd), label='CLIP-KD: FD loss')
plt.legend(loc='upper right')
plt.xlabel('Epochs')
plt.ylabel('Training Loss on CC3M+12M')
plt.grid(linestyle='--')

plt.subplot(142)
plt.plot(epochs,np.array([0.3642]*32), label='Teacher')
plt.plot(epochs,base_img,label='Student')
plt.plot(epochs,kd_img, label='CLIP-KD')
plt.legend(loc='lower right')
plt.grid(linestyle='--')
plt.xlabel('Epochs')
plt.ylabel('(Positive - negative) pair similarity on CC3M Val')

plt.subplot(143)
plt.plot(epochs,np.array([0.4016]*32), label='Teacher: I2T')
plt.plot(epochs,np.array([0.3954]*32), label='Teacher: T2I')
plt.plot(epochs,np.array(base_img_anchor),label='Student: I2T')
plt.plot(epochs,np.array(base_txt_anchor),label='Student: T2I')
plt.plot(epochs,np.array(kd_img_anchor),label='CLIP-KD: I2T')
plt.plot(epochs,np.array(kd_txt_anchor),label='CLIP-KD: T2I')
plt.legend(loc='lower right')
plt.xlabel('Epochs')
plt.ylabel('R@1 (%) on CC3M Val')
plt.grid(linestyle='--')

plt.subplot(144)
plt.plot(epochs,np.array([0.3699]*32), label='Teacher: Top-1')
plt.plot(epochs,np.array([0.6458]*32), label='Teacher: Top-5')
plt.plot(epochs,np.array(base_imagenet_top1), label='Student: Top-1')
plt.plot(epochs,np.array(base_imagenet_top5), label='Student: Top-5')
plt.plot(epochs,np.array(kd_imagenet_top1), label='CLIP-KD: Top-1')
plt.plot(epochs,np.array(kd_imagenet_top5), label='CLIP-KD: Top-5')
plt.legend(loc='lower right')
plt.xlabel('Epochs')
plt.ylabel('Accuracy (%) on ImageNet')
plt.grid(linestyle='--')
plt.show()

