\vspace{.5 cm}
\section{General $CC\Phi$ gate protocol}
\label{Sec4}

RF-induced resonant interactions depicted in Fig.\ref{Res1} allow the direct control of phase and population dynamics of three-body Rydberg states in atomic ensemble. Thus, the presented resonances can be considered as promising candidates for the implementation of three-body quantum gate schemes. In this section, we present a quantum $CCPHASE$ gate (abbreviated here as $CC\Phi$ gate) protocol for arbitrary value of phase $\phi$, based on RF-induced FÃ¶rster resonant transfers.

The $CC\Phi$ gate is a generalization of the well-known $CCZ$ gate for an arbitrary phase $\phi$ of a final multiqubit state. If both control qubits are in the state $\ket{1}$, a transformation is applied to the target qubit that changes the phase difference between its logic states by $\phi$. The extensive applicability of this gate to quantum algorithm implementations (e.g., for QAOA \cite{Hill2021}, QPE \cite{RevModPhys.86.153} and QFT \cite{Coppersmith2002, Nielsen2011}) makes it highly demanded in modern atomic quantum computing.

%The gate protocol we present is a substantial modification of our previous proposal \cite{Ashkarin2022}. The same linear arrangement of atomic qubits is kept, which was considered in the previous section. We utilize the central atom as a target qubit, and two outer atoms as control ones. The significant improvement lies in the application of non-resonant dc electric field during the gate process, which allows us to limit unwanted interactions during laser excitation, as well as to avoid the influence of always-resonant zero-field interactions. We use RF field to induce the F\"{o}rster resonance (Eq. \ref{eq5}) for a chosen value of $F_S$ and thus implement a quantum doubly-controlled rotation gate $CC\Phi$. Note that the dc part of the electric field is being kept constant during the whole process, thus facilitating the experimental implementation of the scheme.

The gate protocol we present is a substantial modification of our previous proposal \cite{Ashkarin2022}. The same linear arrangement of atomic qubits is kept, which was considered in the previous section. We utilize the central atom as a target qubit, and two outer atoms as control ones. The significant improvement lies in the application of non-resonant DC electric field during the gate process, which allows us to limit unwanted interactions in the system. Thus, the DC field is specifically chosen to isolate the RF-induced channel from unwanted non-resonant and quasi-resonant interactions in the atomic ensemble, which can negatively affect the laser excitation coherence \cite{Cheinet2020}. The influence of zero-field always-resonant $S-P$ interactions is also limited. We use RF field to induce the F\"{o}rster resonance (Eq. \ref{eq5}) for a chosen value of $F_S$ and thus implement a quantum doubly-controlled rotation gate $CC\Phi$. Note that the DC part of the electric field is being kept constant during the whole process, thus facilitating the experimental implementation of the scheme.

\begin{center}
% Figure environment removed
\end{center}

%=========================================================================================================
%=========================================================================================================
%==========================================================
\vspace{-.5 cm}

The implementation of the desired $CC\Phi$ gate can be divided into a sequence of three steps (see Fig.\ref{Scheme}).

Step 1: The laser excitation $\pi$ pulses 1-3 are applied simultaneously to all three atomic qubits. We assume that prior to the excitation, the atoms were in their logical states (namely, $\ket{0}$ or $\ket{1}$). These states are represented by two pre-selected hyperfine sublevels of rubidium ground state $\ket{5S_{1/2}}$ \cite{Saffman2010, Beterov2021}. We consider fully resonant single-photon laser excitation in rotating wave approximation, assuming that only transitions of the form $\ket{1} \to \ket{R} = \ket{70P_{3/2}\left(m=1/2\right)}$ are allowed. For practical applications, a three-photon excitation scheme can be used to pair the logical states of qubits with Rydberg levels~\cite{Ryabtsev2011, Beterov2023}. The effects associated with the phase and intensity noise of the laser were considered in \cite{De2018} and are not taken into account in this study.

Step 2: An RF pulse of duration $T_{RF}$ is applied to the system, inducing resonance for a certain value of the DC electric field. This pulse is accompanied by two waiting times $T_{wait}^1$ and $T_{wait}^2$, which are as well configurable system parameters. The DC and AC parts of the electric field are co-directed, thus keeping the symmetry of the atomic system unchanged. The resonant interaction causes the phase of the collective state $\ket{RRR}$ to change by $\phi$ during the gate time. This corresponds to a $CC\Phi(\phi)$ gate implementation, provided that all other states of the system remain unchanged after the application of RF radiation is terminated.

Step 3: The de-excitation $-\pi$ pulses 4-6 are applied simultaneously to all three atomic qubits. The pulses phase values are inverted compared to excitation pulses 1-3 in order to prevent additional unwanted phase accumulation. The $\phi$ phase difference is thus mapped from collective Rydberg states into the logical states of the target qubit.














