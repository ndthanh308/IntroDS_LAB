
\section{Preliminary facts} \label{sec:tech_lemmas}
\input{technical_lemmas.tex}



%\section{Discussion for the Discounted MDP}
%In the discounted case, the random variables are more complicated. Using leave-one-out method, we can ensure $(\widehat{P}_{s,a}-P_{s,a})$ is independent of $V^{(s,a)}$, but the sum of error $\sum_{s,a}(\widehat{P}_{s,a}-P_{s,a}) V^{(s,a)}$ is not a martingale (actually it is hard to find a group of $\sigma$-field to make it a martingale), since $V^{(s,a)}$ also depends on $\{ \widehat{P}_{s',a'} \}_{(s',a')\neq (s,a)}$. Deeper analysis shows that to control the error term, we need to find concentration inequalities for a group of coupling random variables, e.g., to prove that $X+XY+Y\leq O(\sqrt{(\mathrm{Var}(X)+\mathrm{Var}(XY)+\mathrm{Var}(Y))\iota})$ with probability $1-\delta$. The example above seems easy, but we are not aware of efficient concentration when the number of random variables is large.


\section{Proofs of key lemmas in Section~\ref{sec:tec}}\label{app:mfsectec}
\input{proof-key-lemmas-decoupling.tex}


\section{Proofs of auxiliary lemmas in Section~\ref{app:thmmain}}\label{app:proof-lem-main}
\input{proof-lemmas-main-theorem.tex}


\section{Proof of the value-based regret bound (proof of Theorem~\ref{thm:first})}\label{sec:appfirst}
\input{first}

\section{Proof of the cost-based regret bound (proof of Theorem~\ref{thm:cost})}\label{app:cost}
\input{cost}

\section{Proof of the variance-dependent regret bounds (proof of Theorem~\ref{thm:var})}\label{app:var}

%\subsection{Main steps for the proof of Theorem~\ref{thm:var}} 

In this section, we turn to establishing Theorem~\ref{thm:var}. The proof primarily contains two parts, as summarized in the following lemmas. 
%
%which are concerned with regret bounds on $\widetilde{O}\left(\min\{\sqrt{SAHK\mathrm{var}_1} +SAH^2,KH\}  \right)$ and $\widetilde{O}\left(\min\{\sqrt{SAHK\mathrm{var}_2} +SAH^2,KH\}  \right)$ 
%separately. Formally, we are in need of proving the following lemmas.
%
\begin{lemma}\label{lemma:var1}
 With probability exceeding $1-\delta/2$, Algorithm~\ref{alg:main} obeys
	$$
		\mathsf{Regret}(K) \leq \widetilde{O}\Big(\min\big\{\sqrt{SAHK\mathrm{var}_1}+SAH^2,KH\big\}\Big). 
	$$
\end{lemma}
\begin{lemma}\label{lemma:var2}
 With probability at least $1-\delta/2$, Algorithm~\ref{alg:main} satisfies 
	$$
		\mathsf{Regret}(K) \leq \widetilde{O}\Big(\min\big\{\sqrt{SAHK\mathrm{var}_2}+SAH^2,KH\big\}\Big).
	$$
\end{lemma}

Putting these two regret bounds together and rescaling $\delta$ to $\delta/2$, we immediately conclude the proof of Theorem~\ref{thm:var}. 
The remainder of this section is thus devoted to establishing Lemma~\ref{lemma:var1} and Lemma~\ref{lemma:var2}. 

\subsection{Proof of Lemma~\ref{lemma:var1}}
\input{proof_var1}
\subsection{Proof of Lemma~\ref{lemma:var2}}
\input{proof_var2}


\section{Minimax lower bounds}\label{app:lb}

\input{lowerbound}
