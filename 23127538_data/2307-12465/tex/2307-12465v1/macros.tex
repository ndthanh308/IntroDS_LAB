\newcommand{\newtextsc}[1]{\textsc{\small #1}}
\newcommand{\sysname}{\textsc{StaticFixer}\xspace}
\newcommand{\codeql}{\newtextsc{CodeQL}\xspace}
\newcommand{\othersysname}[1]{\newtextsc{#1}\xspace}
%abbrevations
\newcommand{\sa}{\newtextsc{SA}\xspace}
\newcommand{\apr}{\newtextsc{APR}\xspace}
\newcommand{\pbe}{\newtextsc{PBE}\xspace}
\newcommand{\astree}{\newtextsc{AST}\xspace}
\newcommand{\astnode}{\newtextsc{Node}\xspace}
\newcommand{\pdg}{\newtextsc{AST}\xspace}
%\newcommand{\edgetype}{\ensuremath{ET}\xspace}
\newcommand{\repair}{repair\xspace}
\newcommand{\repairs}{repairs\xspace}

\newcommand{\taintprop}{information flow\xspace}
\newcommand{\Taintprop}{Information flow\xspace}
\newcommand{\taintpropedge}{datalow-edge\xspace}
\newcommand{\taintpropedges}{dataflow-edges\xspace}
\newcommand{\Taintpropedge}{Datalow-edge\xspace}
\newcommand{\Taintpropedges}{Dataflow-edges\xspace}
\newcommand{\safeprog}{witnessing-safe program\xspace}
\newcommand{\safeprogs}{witnessing-safe programs\xspace}
\newcommand{\Safeprogs}{Witnessing-safe programs\xspace}
\newcommand{\sawitnessfull}{static-analysis witnessing\xspace}
\newcommand{\sawitness}{\sa-witnessing\xspace}

%languages
\newcommand{\js}{\newtextsc{JavaScript}\xspace}
\newcommand{\cpp}{\newtextsc{C++}\xspace}
\newcommand{\csharp}{\newtextsc{C\#}\xspace}

% vulnerabilities
\newcommand{\unvalidatedmembership}{\newtextsc{UDC-MembershipCheck}\xspace}
\newcommand{\unvalidatedtype}{\newtextsc{UDC-TypeCheck}\xspace}
\newcommand{\unvalidatedcall}{\newtextsc{UDC}\xspace}
\newcommand{\protopoll}{\newtextsc{ProtoTypePollution}\xspace}
\newcommand{\xss}{\newtextsc{XSS}\xspace}

% remove function
\newcommand{\rmGuard}{\newtextsc{RemoveGuard}\xspace}
\newcommand{\rmSan}{\newtextsc{RemoveSanitizer}\xspace}


% dsl concepts
\newcommand{\dsl}{\newtextsc{DSL}\xspace}
\newcommand{\strategy}{\textit{S}\xspace}
\newcommand{\strategyone}{\textit{S}$_1$\xspace}
\newcommand{\strategytwo}{\textit{S}$_2$\xspace}

\newcommand{\edit}{\ensuremath{E}\xspace}
\newcommand{\insertsc}{\newtextsc{Insert}\xspace}
\newcommand{\replace}{\newtextsc{Replace}\xspace}

\newcommand{\location}{\textit{L}\xspace}

\newcommand{\editloc}{\textit{L}\ensuremath{_E}\xspace}
\newcommand{\editindex}{\textit{I}\ensuremath{_E}\xspace}

\newcommand{\semloc}{\textit{L}\ensuremath{_S}\xspace}
\newcommand{\refloc}{\textit{L}\ensuremath{_R}\xspace}
\newcommand{\reflocone}{\textit{L}\ensuremath{_{r1}}\xspace}
\newcommand{\refloctwo}{\textit{L}\ensuremath{_{r2}}\xspace}
\newcommand{\reflocthree}{\textit{L}\ensuremath{_{r3}}\xspace}
%\newcommand{\semloc}{\ensuremath{\mathit{SL}}\xspace}
%\newcommand{\semkleene}{\newtextsc{SemanticKleeneStar}\xspace}
\newcommand{\clauses}{\textit{C}\xspace}
\newcommand{\clause}{\textit{C}\xspace}
%\newcommand{\dslindex}{\ensuremath{\mathcal{I}}\xspace}

%\newcommand{\editpath}{\ensuremath{\mathit{EP}}\xspace}
%\newcommand{\rfpath}{\ensuremath{\mathit{RP}}\xspace} % \ref prefix in command not allowed :\
\newcommand{\insertcode}{\ensuremath{\mathcal{C}}\xspace}

\newcommand{\prog}{\ensuremath{P}\xspace}
\newcommand{\concedit}{\ensuremath{E}\xspace}
\newcommand{\conceditloc}{\ensuremath{\overline{\mathit{EL}}}\xspace}
\newcommand{\conceditpath}{\ensuremath{\overline{\mathit{EP}}}\xspace}
\newcommand{\concrefpath}{\ensuremath{\overline{\mathit{RP}}}\xspace}
\newcommand{\concinsertcode}{\ensuremath{\mathcal{C}}\xspace}
\newcommand{\concpath}{\ensuremath{\overline{\mathit{P}}}\xspace}
\newcommand{\concedge}{\ensuremath{\overline{\mathit{E}}}\xspace}


\newcommand{\kleeneedge}{\newtextsc{KleeneEdge}\xspace}
\newcommand{\kleeneedges}{\newtextsc{KleeneEdges}\xspace}

\newcommand{\editprog}{editprog\xspace}

\newcommand{\witness}{\textit{W}\xspace}
\newcommand{\witnesspar}{\textit{W}\ensuremath{_{par}}\xspace}
\newcommand{\witnessparpar}{\textit{W}\ensuremath{_{grandpar}}\xspace}

\newcommand{\traversal}{\newtextsc{Traversal}\xspace}
\newcommand{\gettraversal}{\newtextsc{GetTraversal}\xspace}
\newcommand{\getclauses}{\newtextsc{GetClauses}\xspace}
\newcommand{\getindex}{\newtextsc{GetIndex}\xspace}

\newcommand{\node}{\newtextsc{Node}\xspace}
\newcommand{\bool}{\newtextsc{Bool}\xspace}
\newcommand{\integer}{\newtextsc{Integer}\xspace}
\newcommand{\eastree}{\newtextsc{E-AST}\xspace}


\newcommand{\edgetype}{\I{ET}\xspace}


%%% AST concepts
\newcommand{\blockstmt}{\newtextsc{BlockStmt}\xspace}
\newcommand{\ifstmt}{\newtextsc{IfStmt}\xspace}
\newcommand{\callexpr}{\newtextsc{CallExpr}\xspace}
\newcommand{\varexpr}{\newtextsc{VarExpr}\xspace}
\newcommand{\indexexpr}{\newtextsc{IndexExpr}\xspace}
\newcommand{\dotexpr}{\newtextsc{DotExpr}\xspace}
\newcommand{\funcexpr}{\newtextsc{FuncExpr}\xspace}
\newcommand{\labelexpr}{\newtextsc{Label}\xspace}
\newcommand{\binaryexpr}{\newtextsc{BinaryExpr}\xspace}
\newcommand{\binaryop}{\newtextsc{BinaryOp}\xspace}
\newcommand{\expr}{\newtextsc{Expr}\xspace}
\newcommand{\assignexpr}{\newtextsc{AssignExpr}\xspace}
\newcommand{\declexpr}{\newtextsc{DeclExpr}\xspace}
\newcommand{\vardecl}{\newtextsc{VarDecl}\xspace}
\newcommand{\declarator}{\newtextsc{Declarator}\xspace}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcommand{\naman}[1]{{\color{purple}#1}}
\newcommand{\naga}[1]{{\color{orange}(NN: #1)}}
\newcommand{\unsure}[1]{{\color{black}#1}}
\newcommand{\spsays}[1]{{\color{red} \textbf{SP:} #1 }}
\newcommand{\aksays}[1]{{\color{blue} \textbf{AK:} #1 }}
\newcommand{\todo}[1]{{\color{red}#1}}
\newcommand{\new}[1]{{\color{blue}#1}}

\newcommand{\benchsmall}{\textbf{\newtextsc{PairedPrograms}}\xspace}
\newcommand{\benchwild}{\textbf{\newtextsc{CodeInTheWild}}\xspace}
\newcommand{\codetfive}{\newtextsc{CodeT5}}
\newcommand{\codetfivejs}{\newtextsc{CodeT5Js}}
\newcommand{\codex}{\newtextsc{Codex}\xspace}
\newcommand{\out}[1]{{}}

% definition
\newtheorem{theorem}{Theorem}
\newtheorem{proposition}{Proposition}
\newtheorem{remark}{Remark}
\newtheorem{definition}{Definition}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\newcounter{inlineenum}
\renewcommand{\theinlineenum}{\alph{inlineenum}}
\newenvironment{inlineenum}
  {\unskip\ignorespaces\setcounter{inlineenum}{0}%
   \renewcommand{\item}{\refstepcounter{inlineenum}{\textit{\theinlineenum})~}}}
  {\ignorespacesafterend}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\usepackage{listings}
\usepackage{color}
\definecolor{lightgray}{rgb}{.9,.9,.9}
\definecolor{darkgray}{rgb}{.4,.4,.4}
\definecolor{purple}{rgb}{0.65, 0.12, 0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.95}
\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codepurple}{RGB}{138,43,226}

\lstdefinelanguage{JavaScript}{
  keywords={break, case, catch, continue, debugger, default, delete, do, else, false, finally, function, in, instanceof, new, null, return, switch, this, throw, true, try, typeof, var, void, while, with, isSource, isSink, isSanitizer, isGuard, isWitness, succ, hasFlow},
  morecomment=[l]{//},
  morecomment=[s]{/*}{*/},
  morestring=[b]',
  morestring=[b]",
  ndkeywords={class, export, boolean, throw, implements, import, this},
  keywordstyle=\color{darkgray}\bfseries,
  ndkeywordstyle=\color{darkgray}\bfseries,
  identifierstyle=\color{black},
  commentstyle=\color{codepurple}\ttfamily,
  stringstyle=\color{codepurple}\ttfamily,
  sensitive=true,
  morekeywords={isSource, isSink, isSanitizer, isGuard, isWitness, hasOwnProperty, succ, hasFlow, and, or, none, parse, run, checkSafe, executeCritical, sanitize, loadActions, serveRequest, requestListener, escape, input, ApplyTraversal, GetKleeneStar, GetClause, GetOffsetIndex, GetEdge, GetConstant, ConstantAST, ReferenceAST, Insert, Replace, has}
}

\lstset{
   language=JavaScript,
   extendedchars=true,
   basicstyle=\footnotesize\ttfamily,
   showstringspaces=false,
   showspaces=false,
   numbers=left,
   numberstyle=\footnotesize,
   numbersep=9pt,
   tabsize=2,
   breaklines=true,
   showtabs=false,
   captionpos=b
   frameshape={RYR}{Y}{Y}{RYR},
   breaklines=true,
   keepspaces=true,                 
   escapeinside={<@}{@>},
   stepnumber=1,                   % the step between two line-numbers
   numbersep=1.5ex,                  % how far the line-numbers are from the code
   columns=flexible,
}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% dsl

\setlength{\grammarparsep}{3pt} % increase separation between rules
\setlength{\grammarindent}{16em} % increase separation between LHS/RHS
\renewcommand{\grammarlabel}[2]{\synt{#1} \ #2}
% Turn off angular bracketing
\let\syntleft\relax
\let\syntright\relax

\newcommand{\I}[1]{\textit{#1}}
\newcommand{\T}[1]{\texttt{\small #1}}
\newcommand{\DRule}[1]{<\textit{#1}>}

\makeatletter
\newcommand{\isempty}[1]{%
  \@ifmtarg{#1}{}{\ }}
\makeatother

\newcommand{\DRulenew}[3]{\textbf{#1}\isempty{#1}\textsc{#2}\ \textit{#3}}
% \newcommand{\DRulenew}[3]{<\newtextsc{#2} \textit{#3}>}
\makeatletter
% Courtesy of https://davidyat.es/2016/07/27/writing-a-latex-macro-that-takes-a-variable-number-of-arguments/
\newcommand{\DMethod}[1]{\texttt{\small #1(}\checknextarga}
\newcommand{\DMethodDSL}[1]{\texttt{#1(}\checknextarga}
\newcommand{\checknextarga}{\@ifnextchar\bgroup{\gobblenextarga}{\texttt{)}}}
\newcommand{\checknextargb}{\@ifnextchar\bgroup{\gobblenextargb}{\texttt{)}}}
\newcommand{\gobblenextarga}[1]{#1\checknextargb}
\newcommand{\gobblenextargb}[1]{, #1\checknextargb}
\makeatother
\newcommand{\DLambda}[1]{$\lambda\ \I{#1} \rightarrow$}
\newcommand{\IS}{$\leftarrow$}


%%%%% color 
\definecolor{ForestGreen}{RGB}{34,139,34}
\definecolor{newForestGreen}{RGB}{34,139,34}
\definecolor{newred}{RGB}{210, 43, 43}
