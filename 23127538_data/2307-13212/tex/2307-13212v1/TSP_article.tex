\documentclass[%
 reprint,
%superscriptaddress,
%groupedaddress,
%unsortedaddress,
%runinaddress,
%frontmatterverbose, 
%preprint,
%preprintnumbers,
%nofootinbib,
%nobibnotes,
%bibnotes,
 amsmath,amssymb,
 aps,
%pra,
%prb,
%rmp,
%prstab,
%prstper,
%floatfix,
]{revtex4-2}
\usepackage{physics}
\usepackage{float}
\usepackage{graphicx}% Include figure files
\usepackage{dcolumn}% Align table columns on decimal point
\usepackage{bm}% bold math
%\usepackage{hyperref}% add hypertext capabilities
%\usepackage[mathlines]{lineno}% Enable numbering of text and display math
%\linenumbers\relax % Commence numbering lines
\usepackage{amsmath}
\usepackage{witharrows}
%\usepackage[showframe,%Uncomment any one of the following lines to test 
%%scale=0.7, marginratio={1:1, 2:3}, ignoreall,% default settings
%%text={7in,10in},centering,
%%margin=1.5in,
%%total={6.5in,8.75in}, top=1.2in, left=0.9in, includefoot,
%%height=10in,a5paper,hmargin={3cm,0.8in},
%]{geometry}

\usepackage{hyperref}
\newcommand{\gt}[1]{{\color{blue} #1}}
\newcommand{\dr}[1]{{\color{red} #1}}
\def\taurel{{\tau_{\text{relax}}}}
\usepackage[normalem]{ulem}

\begin{document}


%Shortcut to Thermal Equilibrium: 
\title{Analytical Insights and Universal Behavior in 
Fast Thermal Equilibration Protocols }% Force line breaks with \\
%\thanks{A footnote to the article title}%
%Unveiling Analytical Solutions: Two-Step Protocol for Shortcut to Equilibrium and Universal Behavior in Thermodynamic Systems
\author{Diego Rengifo}
\email{d.rengifo@uniandes.edu.co}
 %\altaffiliation[Also at ]{Physics Department, Universidad de los Andes}%Lines break automatically or can be forced with \\
\author{Gabriel T\'ellez}%
 \email{gtellez@uniandes.edu.co}
\affiliation{%
 Physics Department, Universidad de los Andes, Bogot\'a, Colombia.\\
 %This line break forced with \textbackslash\textbackslash
}%



%\date{\today}% It is always \today, today,
             %  but any date may be explicitly specified

\begin{abstract}

When a system deviates from equilibrium, it is possible to manipulate and control it to drive it
towards equilibrium within a finite time $t_f$, even reducing its natural relaxation time scale $\taurel$. Although numerous theoretical and experimental studies have explored these shortcut protocols, few have yielded analytical results for the probability distribution of work, heat and entropy production. In this paper, we propose a two-step protocol that captures the essential characteristics of more general protocols and has analytical solution for the relevant thermodynamic probability distributions. Additionally, we demonstrate that for very short protocol duration $t_f\ll \taurel$, all protocols exhibit universal behavior in their shape and for the ratio of probability distribution functions of positive and negative work, heat and the entropy production. 
\end{abstract}

\keywords{Stochastic thermodynamics, control, fast thermalization, brownian motion}
\maketitle



\section{Introduction}


Almost every thermodynamic system in nature is out of equilibrium. Equilibrium states are therefore not common but desirable. When a system is out of equilibrium and left without any external intervention, it takes a finite time to reach an equilibrium state. Let us call $\taurel$ the time scale of relaxation. This time is an intrinsic characteristic of any physical system and depends on various factors, such as the underlying interactions, which are encoded in the friction, transport coefficients, the external parameters (if any), and the temperature \cite{kubo2}.


Technology is advancing very rapidly, and one of its trends is to create and control smaller devices. This miniaturization of devices has led to an increasing interest in the development of engineered techniques that can shorten the natural time scale for relaxation between equilibrium states. These procedures are designed to connect equilibrium states through a particular protocol that is considerably shorter than the natural equilibration time. Such techniques have been inspired by the so-called shortcut to adiabaticity \cite{UNANYAN97,chenSTA10, odelin1}. Since then, the term Engineered Swift Equilibration (ESE) has been coined to describe such protocols \cite{trizac1}. These protocols are also known as ``shortcut to isothermality" \cite{geng17} or ``swift state-to-state transformations" \cite{guery-odelinDrivingRapidlyRemaining2023}.

Several protocols have been established for the ESE process, including those for frictionless atom cooling in harmonic traps \cite{odelin2, odelin3} and nanosystems as micromechanical oscillators in contact with a thermostat, both in the overdamped or underdamped regime \cite{trizac1, trizac2}. These procedures enable the creation of a non-equilibrium state that can be controlled and manipulated, thereby allowing the exploration of novel physical phenomena \cite{guery-odelinDrivingRapidlyRemaining2023}.

Overall, the ESE process has shown great promise in the field of non-equilibrium statistical mechanics and has opened up new avenues for research in the development of novel techniques for controlling and manipulating the dynamics of physical systems, especially for nanodevices. Due to the miniaturization of chips, robots, and devices, understanding controlled dynamics has become mandatory in modern technology. The suitable framework to tackle such small systems is stochastic thermodynamics.





To advance our understanding of how protocols accelerate system equilibration, it is crucial to comprehend the stochastic thermodynamics of small systems. Therefore, it is vital to calculate the probability distribution functions (PDF) of work, heat, and entropy production for these distinct processes.

In this paper, we consider a Brownian particle, the system, immerse in a viscose medium, the environment at temperature $T$, whose particles have a smaller size than the Brownian particle. This justifies the validity of the commonly called overdamped regime, which is particularly applicable to colloidal particles. The particle is subjected to a time-dependent and externally controlled harmonic-type potential, which allows for precise manipulation and control. An experimental realization of this system has been made with colloidal particles trapped with laser beams~\cite{wang02,BlicklenonHarmonic06,trizac1} and has been used to build microscopic heat engines~\cite{BlickleBechinger12, martinezBrownianCarnotEngine2016}.  








When the stiffness of the potential is controlled through ESE protocols, the probability distributions of the relevant thermodynamic quantities like work and heat cannot generally be calculated analytically. Therefore, their theoretical study is limited to numerical simulations. In this paper, we introduce the two-step protocol as a novel approach. Our protocol enables us to derive exact analytical results. Remarkably, the analytical solution of the two-step protocol captures the essential characteristics of broader protocols, exhibiting a certain level of universality.







%In this article,  we will focus on a Brownian particle trapped in harmonic potential with time-dependent stiffness controlled externally. We will assume that the overdamped regime is valid, this is justified for colloidal particles

The structure of this article is as follows. In the first part, inspired by the ideas presented in \cite{trizac1}, we have developed a protocol that establishes a connection between two equilibrium states, theoretically reducing the equilibration time. The work from Ref.~\cite{trizac1} also proposed a similar protocol and carried out experimental realizations, achieving a two-order-of-magnitude reduction in equilibration time. However, due to the complex energetics involved, a detailed study of these protocols has proven to be extremely challenging \cite{Speck}.

In the second part, we propose a simplified toy model called the Two-Step Protocol (TSP), which allows for an analytical solution of the probability distribution functions of relevant thermodynamic quantities.  We calculate the work, heat, and entropy production PDF for the TSP and we check the validity of the Jarzynski equality~\cite{Jar97, jarzynski_equilibrium_1997}, Crooks relation~\cite{Crooks1998, crooks_entropy_1999}, and the entropy production fluctuation theorem~\cite{Evans1} for this specific protocol. A comprehensive comparison with more general protocols reveals some universal features of the shape of the protocols as well as in the ratio of PDF $P_A(A)/P_A(-A)$ (with $A$ being the work, heat and entropy production). These relations are different from the usual fluctuations theorems~\cite{Evans1, Evans2, gallavottiDynamicalEnsemblesStationary1995, Jar97, jarzynski_equilibrium_1997, Crooks1998, crooks_entropy_1999}, as both $P_A(A)$ and $P_A(-A)$ refer to the PDF of a forward process (we do not consider a backward process with the direction of time reversed). 



%A similar protocol have been  reported in \cite{trizac1} with its respective experimental realization. We follow some ideas exposed 



%The principal aim of this paper is to calculate the probability density function (PDF) for heat and work. However, obtaining the analytical expression for these functions is impossible for the protocol previous posted, as well as for the majority of other protocols \cite{speck}. As a result, we introduce a simplified model that incorporates the essential features of the broader problem and enables us to derive analytical solutions. The analytical solutions obtained from this model are particularly advantageous, as they can provide insights that extend beyond what numerical methods can achieve.


\section{ESE Protocol}

In this section, we present a review of the concepts underlying the ESE protocols~\cite{trizac1, guery-odelinDrivingRapidlyRemaining2023}. The central idea behind an ESE process is to construct a customized time-dependent protocol, denoted as $\lambda(t)$, for the externally controlled parameter. This protocol is specifically designed to guide the system from the initial equilibrium state characterized by $\lambda_i$ to the desired final equilibrium state characterized by $\lambda_f$ within a finite time interval $t_f$ that is shorter than the system's equilibration time $\taurel$.




Let us consider a Brownian particle trapped in a harmonic potential with time-dependent stiffness, given by
\begin{equation}
U(x,t)=\frac{1}{2}k(t)x^2.
\end{equation}
Here $x$ is the position of the particle and the protocol $\lambda(t)$ is essentially characterized by the stiffness $k(t)$.
Initially, the particle is in equilibrium with stiffness $k_i$. By controlling the stiffness of the potential $k(t)$, the system reaches a final equilibrium state with stiffness $k_f$. However, there are infinitely many possible protocols that can achieve this transformation, so we can impose constraints to obtain the desired solution. Since the goal is to reduce the equilibration time through external control, the problem falls within the realm of optimization theory \cite{trizac3, Bechhoefer_control21}.

A solution to this problem has been presented in \cite{trizac1}, where both experimental and theoretical results have been obtained in the overdamped limit, i.e., the acceleration term in the Langevin equation has been neglected. In this limit, the corresponding Langevin equation is given by
\begin{equation}\label{langevin}
\dot{x}=-\frac{k(t)}{\gamma}x+\sqrt{2\mathcal{D}}\xi(t),
\end{equation}
where $\xi(t)$ is a Gaussian white noise with zero average and auto-correlation function $\expval{\xi(t)\xi(t')}=\delta(t-t')$. Here, $\beta=1/(k_B T)$ and $\gamma$ are the inverse temperature and friction coefficient, respectively, and $\mathcal{D}$ is the diffusion constant $\mathcal{D}=k_B T/\gamma$. From now on, we will assume that the overdamped limit is valid.

%%% Discusión sobre unidades reducidas
%
%If the stiffness is fixed at a constant value $k_f$, the evolution is given by a Ornstein-Uhlenbeck process which has a natural relaxation time scale $\taurel=\gamma/k_f$. 
From the Langevin equation, we can infer that the natural time scale is given by $\taurel=\gamma/k_f$. It is useful to use a set of adimensional variables associated with this time scale and the final stiffness $k_f$ of the protocol: $\tilde{t}=t/\taurel$, $\tilde{x}(\tilde{t})=x(t)/\sqrt{\mathcal{D}\taurel}$, and $\tilde{k}(\tilde{t})=k(t)/k_f$. The natural energy scale is $k_B T$, given by $\tilde{U} = U/(k_B T) = (1/2) \tilde{k}(\tilde{t}) (\tilde{x}(\tilde{t}))^2$. With this set of units, the reduced Langevin equation reads
\begin{equation}
\frac{d\tilde{x}}{d\tilde{t}} = -\tilde{k}(\tilde{t}) \tilde{x}(\tilde{t}) +\sqrt{2} \tilde{\xi}(\tilde{t}),
\end{equation}
where $\tilde{\xi}(\tilde{t})=\sqrt{\taurel} \xi(t)$, which satisfies $\langle \tilde{\xi}(\tilde{t})\rangle = 0$ and $\langle \tilde{\xi}(\tilde{t})\tilde{\xi}(\tilde{t}')\rangle = \delta(\tilde{t}-\tilde{t}')$. Using these units, it is clear that there are only two parameters for our problem: the initial stiffness with respect to the final one, $\tilde{k}_i=k_i/k_f$, and the target duration of the protocol compared to the relaxation time scale, $\tilde{t}_f=t_f/\taurel$. From now on, we will use these non-dimensional units and remove the tilde to lighten the notation.


%TAREA por hacer: Usar unidades adimensionales en todo el resto del texto y quitar las tildes para simplificar notación. Esencialmente hay que poner $\beta=1$, $\gamma=1$, $\taurel=1$. También se tiene $k_f=1$ pero se puede dejar escrito como $k_f$ por si uno decide usar como referencia otro valor de $k$.

%%%%


The system is in an equilibrium state at the beginning, $t_i=0$, and the goal of the ESE protocol is that it reaches a new equilibrium state at time $t_f$. As a result, the position probability distributions can be described by Gaussian distributions, which are characterized by 
\begin{align}\label{PVI0}
    \expval{x(0)} &=0\\
    \sigma_i^2=\expval{x^2(0)}&=\frac{1}{k_i}
    \label{PVIa}\\
    \sigma_f^2=\expval{x^2(t_f)}&=\frac{1}{k_f}=1.
    \label{PVIb}
\end{align}
As is well-known \cite{risken}, the Langevin equation can be mapped to a Fokker-Planck equation 
\begin{equation}
\frac{\partial P}{\partial t}=\frac{\partial}{\partial x} \left[ k(t)xP\right]+\frac{\partial^2 P}{\partial x^2}
\end{equation}
for the probability density function $P(x,t)$ of position. To solve this equation, we performed a Fourier transform
\begin{equation}
    \hat{G}(p,t)=\int_{-\infty}^{\infty}P(x,t)e^{-ipx}\,dx
\end{equation}
leading to an equation of the form
\begin{equation}
\frac{\partial}{\partial t}(\ln \hat{G})=k(t)p \frac{\partial}{\partial p}(\ln \hat{G})-p^2.
\end{equation}
The combination $\ln(\hat{G})$ is the cumulant generating function whose Taylor series is
\begin{equation}
    \ln{\hat{G}(p,t)}=\sum _{n=0}^{\infty}\chi_{n}(t)\frac{(-ip)^n}{n!},
\end{equation}
where $\chi_n(t)$ are the cumulants of $P(x,t)$. The average value and variance correspond to $n=1$ and $n=2$, respectively. The insertion of this expansion leads to the derivation of a set of ordinary differential equations governing the time evolution of all cumulants for the position. Notably, the only non-trivial equation corresponds to $n=2$ ($\chi_2(t)=\langle x(t)^2 \rangle$)
\begin{equation}
    \dot{\chi}_2(t) + 2k(t)\chi_2(t)=2. \label{n2}
\end{equation}
The essence of the ESE protocols is to propose a particular functional form for the variance $\chi_2$ such that it satisfies the initial~(\ref{PVIa}) and final conditions~(\ref{PVIb}): $\chi_2(0)=1/k_i$ and $\chi_2(t_f)=1/k_f=1$. After that, the appropriate stiffness $k(t)$ can be extracted from equation~(\ref{n2}). Thus, the process of finding the appropriate stiffness is done in a reverse-engineered way.

To ensure a smooth transition to equilibrium, two additional conditions can be optionally imposed on $\chi_2(t)$, given by
\begin{equation}
\dot{\chi}_2(0)=\dot{\chi}_2(t_f)=0.
\end{equation}
We have four conditions that must be satisfied, and hence, we need four parameters to adjust. In addition, we aim to optimize the work done on the system during the process by adding an extra fifth parameter that allows us to tune it in such a way that the work is minimized. Based on this consideration, we propose a solution in the form of a fourth-degree polynomial for $\chi_2$:

\begin{equation}\label{proposal}
\chi_2(t)=A_0+A_1t+A_2t^2+A_3t^3+A_4t^4.
\end{equation}
Finding the parameters $A_i$ using the boundary conditions~(\ref{PVIa})-(\ref{PVIb}), the variance is given by
\begin{equation}
\chi_2(t)=\frac{1}{k_i}-\frac{\Delta k}{k_i k_f}\left(3s^2-2s^3\right)+A_4 t_{f}^4\left(s^2-2s^3+s^4\right),
\end{equation}
where $s=t/t_f$ is the reduced time and $\Delta k= k_f-k_i$. Replacing this in (\ref{n2}), the function $k(t)$ must be
\begin{equation}\label{kt}
k(t)=k_i \frac{1+\frac{3}{t_f}\frac{\Delta k}{k_i}(s-s^2)-\epsilon\frac{k_f}{k_i}\frac{1}{t_f}(s-3s^2+2s^3)}{1-\frac{\Delta k}{k_f}(3s^2-2s^3)+\epsilon(s^2-2s^3+s^4)},
\end{equation}
where $\epsilon=A_4k_it_f^4$. The stochastic work \cite{sekimoto,pelitibook} done on the system is given by
\begin{equation}\label{def work}
W=\frac{1}{2}\int_0^{t_{f}}x^2\frac{dk}{dt}dt.
\end{equation}
Computing the average and replacing (\ref{kt}), we obtain
\begin{align}
\expval{W}&=\frac{1}{2}\ln\left(\frac{k_f}{k_i}\right)+\frac{1}{4t_f}\frac{k_f}{k_i}\eta,
\nonumber\\
&=\Delta F + \expval{W_{\text{irr}}}
\end{align}
where $\eta$ has the expression
\begin{equation}
\eta=\int_0^1\frac{\left[\frac{-6\Delta k}{k_f}(s-s^2)+\epsilon (2s-6s^2+4s^3)\right]^2}{1-\frac{\Delta k}{k_f}(3s^2-2s^3)+\epsilon(s^2-2s^3+s^4)}ds,
\end{equation}
and $\Delta F=\frac{1}{2}\ln(k_f/k_i)$ is the free energy difference between the final and initial state and $\expval{W_{\text{irr}}}$ is the irreversible work.
The average work can be interpreted as a function of $\epsilon$, and numerical methods can be used to find the value of $\epsilon$ that minimizes the average work. It is worth noting that the irreversible work $\expval{W_{\text{irr}}}$ exhibits an inverse relationship with the duration of the protocol, $t_f$. This inverse correlation is consistent with our expectation for a process aimed at accelerating equilibration. The external control exerted on the system necessitates additional work to achieve equilibrium within a shorter timeframe.

Since the choice for the functional form of $\chi_2$ is arbitrary, there exist an infinite number of solutions to the fast equilibration problem. For example, in \cite{trizac1}, a polynomial of degree 3 form was proposed for the inverse of $\chi_2(t)$, and the corresponding experimental realization using optical tweezers has been done. The experimental realization has proved that their protocol has shortened the relaxation time by two orders of magnitude. In order to make a comparison, we use the same values reported in \cite{trizac1}, which in adimensional units are $k_i=0.5$ and $t_f=1/30$, as shown in Figure \ref{fig:stif}. The average work for the protocol $k(t)$ defined in Eq.~(\ref{kt}), optimizing $\epsilon$ to minimize the average work, is $\expval{W}=6.52$, while the result published in \cite{trizac1} is $\expval{W}=6.71$. It is worth noting that the optimal work protocol can be obtained using Pontryagin's principle (see Eq.~(\ref{eq:optimal})), with a result of $\expval{W}_{\text{opt}}=5.49$ \cite{trizac1, trizac3, schmiedlEfficiencyMaximumPower2007, Pontryagin64, Bechhoefer_control21}.

%The figure \ref{fig:stif} shows the difference between our protocol~(\ref{kt}) and the protocol reported at \cite{trizac1}.
% Figure environment removed


Once we have proposed a form for $\chi_2(t)$, it is possible to find the corresponding protocol $k(t)$ using Eq.~(\ref{n2}). It is clear that there are infinitely many protocols with different characteristics.
For example, for a variance of the form
\begin{equation}
    \chi_2(t)= \frac{1}{k_i} (1 + c t)^2,
\end{equation}
the protocol is
\begin{equation}\label{eq:optimal}
k_{\text{op}}(t) = \frac{k_i}{(1+c t)^2} - \frac{c}{1+c t},
\end{equation}
where $c = \frac{1}{t_f} (\sqrt{k_i/k_f}-1)$ and time interval $t\in (0,t_f)$. This protocol has the peculiarity that it minimizes the work, as it has been shown in Refs.~\cite{schmiedlEfficiencyMaximumPower2007,trizac3}.
A second example is a linear relation for the variance $\chi_2(t)$ that satisfy the boundary conditions Eqs.(\ref{PVIa})-(\ref{PVIb}):
\begin{equation}
    \chi_2(t)= \frac{1}{k_i}+(\frac{1}{k_f}-\frac{1}{k_i})\frac{t}{t_f},
\end{equation}
whose protocol $k_L(t)$ is of the form for $t\in (0,t_f)$
\begin{equation}\label{eq:linear}
    k_{L}(t)=\frac{2-(\frac{1}{k_f}-\frac{1}{k_i})\frac{1}{t_f}}{2\left(\frac{1}{k_i}+(\frac{1}{k_f}-\frac{1}{k_i})\frac{t}{t_f}\right)}.
\end{equation}
Both protocols are discontinuous at $t=0$ and $t=t_f$ and they will be called optimal and linear, respectively. 
Studying the energetics \cite{sekimoto} of these protocols, as well as almost all other protocols, can only be achieved through numerical simulations \cite{Speck}. This raises the question of whether it is possible to design a protocol for which analytical solutions can be obtained for the PDF of work, heat, and entropy production. The next section addresses this question.



\section{\label{sec:level2} Two-step protocol}

In this section, we propose a new fast thermalization protocol that provides analytical solutions for the PDF of relevant thermodynamic quantities. Upon careful examination of Figure \ref{fig:stif}, it is evident that the stiffness must be significantly greater than both the initial and final values of $k$. This is because, in order to accelerate the equilibration process, the stiffness needs to be increased to reduce the characteristic time scale evolution of the system. Therefore, it is reasonable to conclude that the large values of stiffness play a critical role in achieving a shortcut to adiabaticity.

Keeping this in mind, we propose a two-step protocol (TSP) defined as follows:

\begin{align}\label{eq:TSP}
    k(t)= 
    \begin{cases}
            k_i & \text{if } \, t \leq 0,\\
            k_m & \text{if } \,  0<t<t_f,\\
            k_f & \text{if }  \, t\geq t_f.  
    \end{cases}
\end{align}
As we will see, this toy model captures the essential features of general protocols. Using this stiffness, the variance in the time interval $0\leq t \leq t_f$ is obtained by solving Eq.~(\ref{n2}) with the initial condition~(\ref{PVIa}):
\begin{equation}\label{chi}
\chi_2(t)=\sigma_X(t)^2=\frac{1}{ k_m}+\left(\frac{1}{ k_i}-\frac{1}{ k_m}\right)e^{-2k_mt}.
\end{equation}
Using this variance, the expression for the probability distribution of the position at any time ($0\leq t\leq t_f$) can be written as:
\begin{equation}\label{position pdf}
P_X(x_t,t)=\frac{1}{\sqrt{2\pi}\sigma_X(t)}\exp\left(-\frac{x_t^2}{2\sigma_{X}^2(t)}\right).
\end{equation}
Now, by forcing the system to arrive at a final equilibrium state at $t=t_f$, the variance $\chi_2(t_f)$ has to be $1/k_f$. This leads us to a self-consistency equation for $k_m$ given by:
\begin{equation}\label{consistency}
\exp(-2k_m t_f)=\frac{\displaystyle\frac{1}{k_f}-\frac{1}{k_m}}{\displaystyle\frac{1}{k_i}-\frac{1}{k_m}}.
\end{equation}
This equation is transcendental and can be solved numerically to determine the value of $k_m$. Utilizing this value, the TSP is a control protocol that joins the equilibrium state at $k_i$ with the equilibrium state at $k_f$ in a finite time $t_f$. This equation is not symmetric under time inversion of the protocol, i.e., if the system evolves from $k_f$ to $k_i$, and the equilibrium distributions are desired at initial and final times, the value of $k_m$ changes because the roles of $k_i$ and $k_f$ need to be interchanged in Eq.~(\ref{consistency}), and therefore the system does not follow the same evolution under the reverse direction of time. This fact is related to the entropy production, as discussed below.

This approach differs from that of the previous section and previous works \cite{trizac1, bayatiDiffusiophoresisDrivenColloidal2021}, as here we propose a specific form of the protocol and determine the corresponding variance. Thus, this process can be referred to as direct engineering.

Although Eq.~(\ref{consistency}) cannot be solved analytically, we can derive the asymptotic behavior of $k_m$ for large and small values of the target final time $t_f$. If $t_f\gg 1$, $\exp(-2k_m t_f)\to 0$. From the right-hand side of (\ref{consistency}), we find $k_m=k_f=1$. This is to be expected as if we have an infinite amount of time to let the system equilibrate ($t_f\to\infty$), we can fix $k_m=k_f$ and wait for the system to reach equilibrium at this new value of the stiffness.

More interesting and pertinent is the behavior when $t_f\to 0$. In this limit, $k_m\to\infty$, which means that the shorter the target time is, the larger the stiffness needs to be. In this limit, the right-hand side of (\ref{consistency}) converges to a finite value $k_i/k_f$. Therefore, we deduce that $k_m t_f$ must remain finite, and we have:
\begin{equation}
\label{eq:km_tf_short}
k_m \sim \frac{1}{2t_f} \ln\frac{k_f}{k_i}.
\end{equation}
We observe that $k_m$ is inversely proportional to $t_f$. This quantifies the previous observation that to achieve fast relaxation to equilibrium, it is necessary to significantly increase the stiffness. Since the typical relaxation time at a fixed stiffness $k_m$ is of the order $1/k_m$, the TSP matches a transient relaxation time of the order $1/k_m$ to the target duration $t_f$ of the accelerated protocol. The specific relation is given by (\ref{eq:km_tf_short}).

By expanding the right-hand side of (\ref{consistency}) in powers of $1/k_m$, one can systematically compute the corrections to (\ref{eq:km_tf_short}). For example, the next-to-leading order term is given by:
\begin{equation}
\label{eq:km_tf_short2}
k_m t_f = \frac{1}{2}\ln\frac{k_f}{k_i}
+ t_f \frac{k_f-k_i}{\ln(k_f/k_i)} +O(t_f^2).
\end{equation}
It turns out that the leading order~(\ref{eq:km_tf_short}) is universal for more general protocols, if we replace $k_m$ by the average value of $k(t)$ over the protocol duration 
\begin{equation}
    k_m=\frac{1}{t_f} \int_0^{t_f} k(t)\,dt.
\end{equation}
Indeed, using Eq.~(\ref{n2}) for a general protocol, we find that the average of $k(t)$ is 
\begin{equation}
    k_m = \frac{1}{2t_f}\ln\frac{\chi_2(0)}{\chi_2(t_f)}
    + \int_0^{t_f} \frac{1}{\chi_2(t)}\frac{dt}{t_f}
    .
\end{equation}
Since $\chi_2$ is a continuous function of $t$, applying the mean value theorem 
and using the initial and final conditions~(\ref{PVIa})-(\ref{PVIb}) leads to
\begin{equation}
    k_m = \frac{1}{2t_f}\ln\frac{k_f}{k_i}
    + \frac{1}{\chi_2(t^*)}
\end{equation}
for some $t^*\in[0,t_f]$. 
Figure \ref{fig:kmtf_protocols} illustrates this by showing a plot of $k_m t_f$ as a function of $t_f$ for different values of $k_i$ and the ESE protocols discussed in the previous section and Ref.~\cite{trizac1}. As $t_f\to 0$, all the protocols converge to the same value given by (\ref{eq:km_tf_short}). However, the next-to-leading corrections differ from one protocol to another.


% Figure environment removed




%The parameter $k_m$ is a constant value that is fixed only if we assume a final equilibrium situation at time $t_f$. At present, $k_m$ remains general until further clarification is provided.

\subsection{Work distribution for two-step protocol}
Since the TSP seems to be analytically tractable and exhibits some general features of more complex ESE protocols, we now proceed to use it as a basis for understanding the stochastic energetics of the fast relaxation protocols. More specifically, in this section, we want to calculate the work probability distribution.
Using~(\ref{def work}), we obtain the work done on the system $W_D$ during the process
\begin{align}\label{eq:work done}
    W_D= \left\{ \begin{array}{lcc}
              \frac{1}{2}(k_m-k_i)x_i^2 &  \quad 0< t < t_f, \\
             \\\frac{1}{2}(k_m-k_i)x_i^2+\frac{1}{2}(k_f-k_m)x_f^2&  \quad  t>t_f.
             \end{array}
   \right. %para finalizar (delimitador invisible con el punto).
\end{align}
Since the initial and final positions are stochastic variables with normal distributions, the work done is also a stochastic variable. To compute the work distribution function, we consider the following cases:
%and using the boundary conditions \ref{PVI}, the average work after the two steps is \footnote{$\expval{W}_{eq}$ is the average work assuming a final equilibrium situation.}
%\begin{equation}
%    \beta\expval{W}_{eq} =k_m(\frac{1}{k_i}-\frac{1}{k_f}) 
%\end{equation}
\subsubsection{For $0<t<t_f$}
To study this time interval, we need to determine the position probabilities at two points described by $(x_i, t_i=0)$ and $(x_t, t)$. Therefore, the joint probability distribution (JPD) can be expressed as follows:
\begin{equation}\label{two points pdf}
P_2(x_i,t_i;x_t,t)=P(x_t,t|x_i,t_i)P(x_i,t_i).
\end{equation}
Computing $P_2$ is a straightforward task; $P(x_t,t|x_i,t_i)$ follows an Ornstein-Uhlenbeck process distribution \cite{gardiner}: 
\begin{equation}
\label{eq:OH-km}
    P(x_t,t_t|x_i,t_i)=\frac{1}{\sqrt{2\pi \sigma_m(t)^2}}\exp{-\frac{(x_t-x_ie^{-k_mt})^2}{2\sigma_m(t)^2}}
\end{equation}
where 
\begin{equation}\label{sigma m}
    \sigma_m(t)^2 =\frac{1-e^{-2k_mt} }{ k_m }.
\end{equation}
The initial Gaussian probability distribution is
\begin{equation}\label{pdf initial}
    P(x_i,t_i)=\frac{1}{\sqrt{2\pi}\sigma_i}\exp{-\frac{x_i^2}{2\sigma_i^2}}
\end{equation}
with $\sigma_i^2=1/k_i$ (eq.~(\ref{position pdf}) at $t=0$).

To compute the probability density function of the work, we adopt the following approach: while there exist an infinite number of paths connecting the points $(x_i, t_i)$ and $(x_t, t)$, we focus solely on the paths that yield a specific amount of work, denoted as $W$, regardless of the initial and final points. Hence, the PDF of the work can be expressed as follows:

%\begin{equation}\label{pdf work}
%P(W,t)=\int_{-\infty}^{\infty}dx_i dx_t \delta(W-W_D)P_2(x_i,t_i;x_t,t)
%\end{equation}

\begin{equation}\label{work}
  P_W(W,t)=\int_{-\infty}^{\infty}dx_i dx_t \delta(W-W_D)P_2(x_i,t_i;x_t,t).
\end{equation}
Since the work $W_D$ is independent of $x_t$ for $t < t_f$, the work probability is stationary, and the previous equation simplifies to:
\begin{equation}
    \label{eq:PWtfinf}
P_W(W, t) = \int_{-\infty}^{\infty} dx_i \delta\left(W - \frac{(k_m - k_i) x_i^2}{2}\right) P(x_i, t_i).
\end{equation}
If $W/(k_m - k_i) < 0$, the argument of the Dirac delta distribution never vanishes, resulting in $P(W, t) = 0$. However, when $W/(k_m - k_i) \geq 0$, there are two roots to the equation $W - (k_m - k_i) x_i^2/2 = 0$, yielding:
\begin{equation}
P_W(W, t) = \sqrt{\frac{k_i}{\pi (k_m - k_i) W}} \exp\left(-\frac{k_i}{k_m - k_i} W\right).
\end{equation}
This result can also be obtained using the methods described in \cite{Speck, pelitibook}.
Returning to~(\ref{eq:PWtfinf}), one can use the Fourier representation of the Dirac distribution
\begin{equation}
\label{eq:deltaWtinftf}
    \delta(W-(k_m-k_i)x_i^2/2) = \int_{-\infty}^{+\infty} e^{iz(W-(k_m-k_i)x_i^2/2)}
    \,\frac{dz}{2\pi}.
\end{equation}
to compute the characteristic function of $P_W(W,t)$. Using~(\ref{eq:deltaWtinftf}) into~(\ref{eq:PWtfinf}), the resulting gaussian integral over $x_i$ can be performed to obtain 
\begin{equation}\label{characterictic W1}
    P_W(W,t)=\frac{1}{2\pi}\int_{-\infty}^{\infty}dz\hat{P}_W(z)e^{i W z}
\end{equation}
where the characteristic function is
\begin{equation}\label{linear}
    \hat{P}_W(z)=\frac{1}{\sqrt{1+ia_1 z}}
\end{equation}
with $a_1=(k_m-k_i)/k_i$. From this we can obtain all the cumulants $c_n$ of $W$,
\begin{align}
    \ln \hat{P}_W(z) & = \sum_{n=1}^\infty 
    \frac{(-iz)^n}{n!} c_n 
    \nonumber\\
    &= \sum_{n=1}^\infty \frac{(-ia_1 z)^n}{n}
.
\end{align}
Thus 
\begin{equation}
    c_n = \frac{1}{2}(n-1)! a_1^n.
\end{equation}
In particular, the average work and variance for this time interval are
\begin{eqnarray}\label{average work and variance t lower}
  \expval{W}&=&\frac{k_m-k_i}{2k_i} ,\\
  \sigma_W^{2}&=&\frac{(k_m-k_i)^2}{2k_i^2}.
\end{eqnarray}
Note that $\sigma_W^{2}=2\expval{W}^2$. From the characteristic function one can check that the work distribution satisfies Jarzynski equality~\cite{Jar97} as it should:
\begin{equation}
    \left<e^{-W}\right> = \hat{P}_W(i)
    = \sqrt{\frac{k_i}{k_m}} = e^{-\Delta F},
\end{equation}
where $\Delta F=\frac{1}{2}\ln(k_m/k_i)$ is the free energy difference for the oscillator with final stiffness  $k_m$ (in the time interval $0<t<t_f$) and initial stiffness $k_i$.






\subsubsection{For $t\geq t_f$}
In the temporal range $t\geq t_f$, it is necessary consider the three-point joint probability distribution
\begin{equation}
    P_3(x_i,t_i;x_f,t_f;x,t)=P(x,t|x_f,t_f)P_{2}(x_f,t_f;x_i,t_i).
\end{equation}
Again, the work distribution is stationary, hence we only need the two-points JPD
\begin{align}
    P_2(x_i,t_i;x_f,t_f)&=\frac{1}{2\pi \sigma_i\sigma_m(t)}\exp{-\frac{(x_f-x_ie^{-k_mt_f})^2}{2\sigma_m(t_f)^2}
    }
    \nonumber\\
    &\times \exp{-\frac{x_i^2}{2\sigma_i^2}}
\end{align}
here $\sigma_m(t)$ is given by~(\ref{sigma m}).
Inserting the two-point JPD in an expression similar to~(\ref{work}) and using the Fourier representation of the Dirac distribution, we obtain a Gaussian integral in two variables that can easily be computed leading us to a characteristic function of the form
\begin{equation}\label{cuadratic}
    \hat{P}_W(z)=\frac{1}{\sqrt{1+a_1 z+a_2 z^2}}
\end{equation}
where the coefficients are given by 
\begin{eqnarray}
  a_1&=&\frac{i(k_f-k_i)}{k_i}+\frac{i(k_f-k_m)(k_i-k_m)\sigma_m^2(t_f)}{k_i} \\ 
  a_2&=&
\frac{i(k_f-k_m)(k_i-k_m)\sigma_m^2(t_f)}{k_i}
\end{eqnarray}
or utilizing the consistency equation~(\ref{consistency}), these expressions can be simplified to
\begin{eqnarray}
  a_1&=&\frac{i(k_f-k_i)k_m}{k_ik_f} \\ 
  a_2&=&\frac{(k_f-k_i)(k_m-k_f)}{k_fk_i}
\end{eqnarray}
Clearly, $P_W(W)$ is normalized ($\hat{P}_W(0)=1$) and satisfies the Jarzynski equality~\cite{Jar97}
\begin{equation}
    \expval{e^{- W}}=
    \hat{P}_W(i)=
    e^{- \Delta F},
\end{equation}
where now $\Delta F=\frac{1}{2}\ln(k_f/k_i)$ is the Helmholtz free energy difference between the two equilibrium states with stiffness $k_f$ and $k_i$.
%\begin{equation}\label{pdf work integral}
%    P(W)=\frac{\beta}{2\pi\sigma_i\sigma_m}\int_{-\infty}^{\infty}dz \frac{e^{i\beta W z}}{\sqrt{Det(A)}}
%\end{equation}
%where the matrix $A$ is given by
%\[
%A =
%\begin{pmatrix}
%i(k_m-k_i)\beta z+\frac{1}{\sigma_i^2}+\frac{e^{-2t_f/\tau_m}}{\sigma_m^2} & -\frac{e^{-t_f/\tau_m}}{\sigma_m^2} \\
%-\frac{e^{-t_f/\tau_m}}{\sigma_m^2} & i(k_f-k_m)\beta z+\frac{1}{\sigma_m^2}
%\end{pmatrix}
%\]
From the characteristic function, we can determine any moments of the work distribution, including the average work and variance:
\begin{eqnarray}
    \expval{W} &=& \frac{k_m}{2}\left(\frac{1}{k_i}-\frac{1}{k_f}\right), \\
    \sigma_W^2 &=& 2\expval{W}^2 + \frac{2(k_m - k_f)\expval{W}}{k_m}.
\end{eqnarray}
It is worth noting that $\sigma_W^2 > 2\expval{W}^2$ holds true when $(k_m - k_f)\expval{W} > 0$. Fig.~\ref{fig:work_metrics} shows the evolution of the average work and its standard deviation.

The exact computation of the inverse Fourier transform in Eq.~(\ref{characterictic W1}) can be achieved for the characteristic function given in Eq.~(\ref{cuadratic}). To accomplish this, it is imperative to use the vertex form of a quadratic polynomial. Subsequently, an elementary change of variable results in an integral representation of the modified Bessel function of the second kind of order zero $K_0$. The final expression is as follows:



\begin{widetext}
\begin{align}\label{eq:pdf work}
    P_W(W)&=\frac{1}{\pi\sqrt{\sigma_W^2-2\expval{W}^2}}\exp{\frac{\expval{W}}{\sigma_W^2-2\expval{W}^2}W}K_0\left(\frac{\sqrt{\sigma_W^2-\expval{W}^2}}{\sigma_W^2-2\expval{W}^2}\abs{W}\right).
    %\\
    %&
    %\gt{
    %=
    %\frac{1}{\pi\sqrt{
    %2\expval{W}(k_m-k_f)/k_m
    %}}
    %\exp{
    %\frac{k_m}{2(k_m-k_f)}
    %W}
    %K_0\left(\frac{k_m\sqrt{\sigma_W^2-\expval{W}^2}}{2(k_f-k_m)\expval{W}}\abs{W}%\right)
    %}
\end{align}
%\gt{XXX: \em Decidir cual de las dos formas dejamos. Propongo la segunda ya que el factor exponencial toma una forma más explícita en función de los $k$. Además tiene gran similitud con la del calor.}
\end{widetext}
The tails of this work distribution can be obtained from the asymptotic behavior of the Bessel function $K_0$, they are 
\begin{align}
    P_W(W) \sim\left\{ \begin{array}{lcc}
              \frac{1}{\sqrt{2\pi\sigma_r W}}\exp{\frac{-1}{\sigma_r+\expval{W}}W} &  \quad W\rightarrow\infty, \\
             \frac{1}{\sqrt{-2\pi\sigma_r W}}\exp{\frac{1}{\sigma_r-\expval{W}}W}&  \quad W\rightarrow -\infty  .
             \end{array}
   \right. %para finalizar (delimitador invisible con el punto).
\end{align}
where $\sigma_r^2=\sigma_W^2-\expval{W}^2$. 

To test this analytical result and compare it with the PDF for more complicated protocols, we performed simulations using a code developed by one of us~\cite{langesim}. The comparison between this exact solution and the simulation is depicted in figure~\ref{fig:work_pdf}.
% Figure environment removed
The probability density function of the work exhibits an intriguing structure characterized by the product of two components. The first component is a symmetric function of $W$, specifically the Bessel $K_0$ function with an argument proportional to the absolute value of $W$. The second component is an exponential function of $W$, introducing an asymmetry in the probabilities of obtaining positive or negative work values. Since the overall process is a compression ($k_f>k_i$), the average work on the particle is positive. Nevertheless there are rare events in which $W<0$ but those are less frequent than the ones where $W>0$: the tail of $P_W(W)$ for $W>0$ is larger than the one for $W<0$. Mathematically, this asymmetry factor can be expressed as follows:
\begin{equation}
\label{eq:PWP-W}
    \frac{P_W(W)}{P_W(-W)}=\exp{\frac{2\expval{W}}{\sigma_W^2-2\expval{W}^2}W}=
    \exp{\frac{k_m}{k_m-k_f}W}
    \,.
\end{equation}
Equivalently, this implies the symmetry relation for the characteristic function
\begin{equation}
    \hat{P}_W(z) = \hat{P}_W\left(-z-i\frac{k_m}{k_m-k_f}\right).
\end{equation}
The other protocols follow a similar relation, at least for $t_f \ll 1$, as observed in the plot shown in Figure \ref{fig:hypothesis_W}. This suggests that the relation given by Eq.~(\ref{eq:PWP-W}) is universal for protocols that achieve fast thermal equilibration in a short time, where $t_f \ll \taurel = 1$. However, this universality breaks down for longer times: when $t_f \sim 1$, the protocols exhibit slight deviations from the predicted behavior of the TSP protocol, as shown in Figure \ref{fig:scatter_wtf}. Nonetheless, the universality of Eq.~(\ref{eq:PWP-W}) remains a prominent feature, valid within the range of interest for fast thermalization protocols ($t_f \ll 1$).
% Figure environment removed
% Figure environment removed


% Figure environment removed

\subsubsection{Reverse protocol}
In the previous section, we computed the probability distribution connecting two equilibrium states, $k_i$ and $k_f$, through a suitable choice of $k_m$ as given by Eq.~(\ref{consistency}). However, our results are more general than this specific case. The probability density function of work retains the same expressions as before for arbitrary $k_m$, except that the average work and its variance will change. In this general setup, the expressions for $t\geq t_f$ are as follows:
\begin{eqnarray}\label{metrics general}
\expval{W}&=&\frac{k_f-k_i}{2k_i}+\frac{(k_m-k_f)(k_m-k_i)}{2k_i}\sigma_m^2(t_f),
\\  
\sigma_W^2&=& 2\expval{W}^2+\frac{(k_m-k_f)(k_m-k_i)}{k_i}\sigma_m^2(t_f).
\end{eqnarray}
For $t < t_f$, the expressions remain unchanged, as is shown in Eq.~(\ref{average work and variance t lower}). 

Let us consider a time-reversed protocol defined as
\begin{align}\label{eq:RTSP}
    k^R(t)= \begin{cases}
             k_f& \text{if } \, t \leq 0,\\
             k_m & \text{if } \,  0<t<t_f,\\
             k_i & \text{if }  \, t\geq t_f.
             \end{cases}
\end{align}
In this time-reversed protocol, we do not change the value of $k_m$, it is the same as in the forward protocol. As a result, the system will {\em not} be at thermal equilibrium at $t_f$, since the value of $k_m$ has not been adjusted properly (to obtain thermal equilibrium at $t_f$ in a reversed protocol, the roles of $k_i$ and $k_f$ had to be interchanged in Eq.~(\ref{consistency})).

The Crooks relation can be verified by utilizing the general expression for $\expval{W}$ and $\sigma_W^2$ \cite{crooks_entropy_1999}:
\begin{equation}\label{eq:crooks identity}
    \frac{P_W(W)}{P^R_W(-W)}=\exp{W-\Delta F},\quad \text{for any $t$}.
\end{equation}
%\vspace{0.3cm}
Here, $P^R_W(-W)$ represents the work probability distribution of the reverse protocol. The cancellation of Bessel functions occurs due to the symmetry of the argument under the interchange of $k_i$ and $k_f$. The factor $\Delta F$ arises from the ratio of normalization factors, while the appearance of $W$ stems from the exponential function (refer to Appendix \ref{app:1} for more details).





\subsection{Heat distribution function for TSP}
Now we move to the study of another relevant thermodynamics quantity: heat. In the realm of stochastic thermodynamics, the concept of heat, as defined in \cite{sekimoto}, is expressed as:
\begin{equation}
Q=\int_0^t k(t)x\dot{x}dt
\gt{.}
\end{equation}
Using the first law of thermodynamics, the heat can also be computed from $Q_D(t)= U(t)-U(0)-W_D(t)$.
For the two-step protocol (TSP), the stochastic heat is:
\begin{align}\label{eq:heat done}
    Q_D(t)= \left\{ \begin{array}{lcc}
             \frac{1}{2}k_m(x_t^2-x_i^2) & \quad t \leq t_f,\\
             \\\frac{1}{2}k_m(x_f^2-x_i^2)+\frac{1}{2}k_f(x_t^2-x_f^2)& \quad t>t_f.
             \end{array}
   \right. %para finalizar (delimitador invisible con el punto).
\end{align}
%Notably, the average heat after the two steps, assuming final equilibrium is reached at $t=t_f$ and utilizing the result from \ref{PVI}, can be calculated as:

%\begin{equation}\label{eq heat}
%\expval{Q}_{eq}=\frac{k_m}{2\beta}\left(\frac{1}{k_f}-\frac{1}{k_i}\right)
%\end{equation}
It is worth noting that the heat distribution is time-dependent because it involves $x_t$. This complication leads to a non-stationary heat probability density function (PDF). Similar to the work calculation, the analysis of heat needs to be performed in two distinct cases:
\subsubsection{For $0\leq t\leq t_f$}

By following a similar methodology as with the work distribution, we can obtain the characteristic function for the heat $\hat{P}_Q(z)=(1+b_1 z+b_2 z^2)^{-1/2}$  with the coefficients
\begin{eqnarray*}
  b_1&=&\frac{-i(k_m-k_i)k_m}{k_i}\sigma_m^{2}(t),\\
  b_2&=&\frac{ k_m^{2}}{k_i}\sigma_m^{2}(t),
\end{eqnarray*}
where $\sigma_m(t)$ is given at \ref{sigma m}. From this characteristic function, we can derive the average $\expval{Q}_t$:
\begin{equation}\label{eq:heat}
\expval{Q}_t=-\frac{k_m-k_i}{2 k_i}\left(1- e^{-2k_m t}\right),
\end{equation}
and the variance of the heat
\begin{equation}
\sigma_Q(t)^{2}=2\expval{Q}_t^2-\frac{2 k_m\expval{Q}_t}{k_m-k_i}.
\end{equation}
It is important to observe that the average heat and variance exhibit a characteristic time $\tau_m=1/k_m$. The characteristic function has a similar structure to that of the work probability density function for $t > t_f$. Therefore, the inverse Fourier transform can be computed explicitly, leading to the heat probability distribution for $0\leq t \leq t_f$,
\begin{widetext}    
\begin{align}
    %P(Q,t)=&\frac{1}{\pi}\sqrt{\frac{k_i-k_m}{2k_m\expval{Q}_t}}\exp{\frac{k_i-k_m}{2k_m} Q}K_0\left(\frac{(k_i-k_m)\sqrt{\sigma_Q^2-\expval{Q}_t^2}}{2k_m\expval{Q}_t}\abs{Q}\right)\\
    \label{eq:PQ_TSP}
    P_{Q}(Q,t)&=\frac{1}{\pi\sqrt{\sigma_Q(t)^2-2\expval{Q}_t^2}}\exp{\frac{\expval{Q}_t}{\sigma_Q(t)^2-2\expval{Q}_t^2}Q}K_0\left(\frac{\sqrt{\sigma_Q(t)^2-\expval{Q}_t^2}}{\sigma_Q(t)^2 -2\expval{Q}_t^2}\abs{Q}\right).
\end{align}
\end{widetext}
This result can also be obtained using the methods described in \cite{imparato}.

It is worth noting that the exponential term in the heat distribution is time-independent since $\frac{\expval{Q}_t}{\sigma_Q^2-2\expval{Q}_t^2}=\frac{k_i-k_m}{2k_m}$ does not depend on $t$. On the other hand, the argument of the Bessel function $K_0$ is time-dependent. The ratio of the heat probability distributions $P(Q,t)/P(-Q,t)$ satisfies a similar relation to the one found for the work in Eq.~(\ref{eq:PWP-W})
\begin{equation}\label{eq:PQP-Q}
    \frac{P_Q(Q,t)}{P_Q(-Q,t)}
    =\exp{\frac{2\expval{Q}_t}{{\sigma_Q^2}_t-2\expval{Q}_t^2}Q}=
    \exp{\frac{k_i-k_m}{k_m}Q}.
\end{equation}
A numerical test of this relation for other protocols in the range $t_f\ll \taurel=1$ is shown in Fig.~(\ref{fig:hypothesis_Q}) revealing again its universality. For longer protocols $t_f \sim 1$, the relation given by Eq.~(\ref{eq:PQP-Q}), which has been proven for the TSP protocol, remains valid at large values of $|Q|$ but shows some deviations at small values as illustrated in Fig.~\ref{fig:scatter_Qtf} for several protocols. A similar relation to~(\ref{eq:PQP-Q}) where $P_Q(Q,t)/P_Q(-Q,t)$ is a simple exponential function of $Q$ appears also in a different context when one considers the relaxation from the microcanonical to the canonical ensembles of this system~\cite{JDM23}.

% Figure environment removed


% Figure environment removed


%{\em
%\gt{XXX: Por hacer: gráficas de esta relación comparando con los otros protocolos
%}
%}





% Figure environment removed

\subsubsection{For $t>t_f$}

After the second step of the TSP, the average heat reaches its equilibrium value given by Eq.~(\ref{eq:heat}) evaluated at $t=t_f$. However, surprisingly, moments of order $n\geq 2$ of the heat distribution take longer to reach their equilibrium values. To investigate this phenomenon, we attempt to calculate the heat distribution for $t>t_f$, which necessitates the joint probability distribution of the three-points:
\begin{equation}
P_Q(Q,t)=\int dx_i dx_f dx ,\delta(Q-Q_D)P_3(x_i,t_i;x_f,t_f;x_t,t).
\end{equation}
Here, $P_3$ is a product of two Ornstein-Uhlenbeck processes with stiffness $k_m$ and $k_f$ and the initial probability distribution, 
\begin{align}
    P_3(x_i,t_i;x_f,t_f;x_t,t) = &
    P(x_i,t_i)P(x_f,t_f|x_i,t_i)
    \nonumber\\
    & \times P(x_t,t|x_f,t_f),
\end{align}
with 
\begin{equation}
\label{eq:OH-kf}
    P(x_t,t|x_f,t_f)=\frac{1}{\sqrt{2\pi \sigma_f(t)^2}}\exp{-\frac{(x_t-x_fe^{-k_f(t-t_f)})^2}{2\sigma_f(t)^2}},
\end{equation}
where 
\begin{equation}
    \sigma_f(t)^2=\frac{1-e^{-2k_f (t-t_f)}}{k_f},
\end{equation}
and $P(x_f,t_f|x_i,t_i)$ is given by~(\ref{eq:OH-km}).

By combining these expressions, utilizing the Fourier representation of the delta distribution, and performing the resulting Gaussian integrals, we can obtain the characteristic function.
\begin{equation}\label{cubic}
    \hat{P}_Q(z)=\frac{1}{\sqrt{1+c_1 z+c_2 z^2+c_3 z^3}}
\end{equation}
whose coefficients are given by
\begin{eqnarray*}
  c_1&=&A(1-e^{-2k_f(t-t_f)})-\frac{ik_m(k_m-k_i)}{k_i}\sigma_m^2(t_f),\\
  c_2&=&B(1-e^{-2k_f(t-t_f)})+\frac{ k_m^2}{k_i}\sigma_m^{2}(t_f),\\
  c_3&=&C(1-e^{-2k_f(t-t_f)}),
\end{eqnarray*}
where $A, B$ and $C$ are constants given by
\begin{eqnarray*}
    A&=&\frac{i(k_i-k_f)}{k_i}+\frac{ik_f(k_m-k_i)}{k_i}\sigma_m^2(t_f),\\
    B&=&\frac{k_f+(k_fk_i-2k_mk_f-k_ik_m+k_m^2)\sigma_m^{2}(t_f)}{k_i},\\
    C&=&\frac{i(k_m-k_f)k_m\sigma_m^2(t_f)}{k_i}.
\end{eqnarray*}
These coefficients are completely general, meaning that $k_m$ does not necessarily satisfy the consistency equation~(\ref{consistency}). If $k_m$ does satisfy the consistency equation, the coefficients $B$ and $C$ are nonzero, while the coefficient $A$ vanishes. As a result, the average heat for $t > t_f$ becomes time-independent. However, the variance and higher-order moments of the heat depend on time and have a characteristic time given by $1/(2k_f)$. If $k_m$ is a solution of the consistency equation (\ref{consistency}), the average heat and variance are given by:
\begin{eqnarray}
  \expval{Q}&=&-\frac{k_m}{2}\left(\frac{1}{k_i}-\frac{1}{k_f}\right),\\
  \sigma_Q^{2}&=&2\expval{Q}^2-\frac{2k_m\expval{Q}}{k_m-k_i}+D(1-e^{-2k_f(t-t_f)}),
\end{eqnarray}
here $D$ is 
\begin{equation}
     D=\frac{(k_f-k_m)(k_i^2+k_fk_m-k_ik_m)}{k_ik_f(k_i-k_m)}.
\end{equation}
Fig.~\ref{fig:heat_metrics} shows the evolution of the average heat and its standard deviation. When $t>t_f$, the average heat has stabilized but its standard deviation continues to change in time with a relaxation time of order $1/k_f$. This finding holds considerable importance as it indicates that the Brownian particle reaches a state of equilibrium in terms of its position and work probability distribution by the final time $t_f$. However, it is worth noting that the heat distribution requires additional time to reach its ultimate state of equilibrium. The primary aim of the shortcut protocols is to achieve equilibrium in the position distribution, while the attainment of equilibrium in other relevant distributions is not necessarily simultaneous with that of the position distribution. 

% Figure environment removed


\section{Entropy production}
In this section, we specifically focus on the entropy production associated with the two-step protocol. This quantity holds significant importance in understanding the inherent irreversibility within nonequilibrium systems and provides valuable insights into the fundamental thermodynamic principles that govern the TSP.

We recall the definition of total entropy in the realm of stochastic thermodynamics \cite{crooks_entropy_1999, jarzynski_equilibrium_1997}:
\begin{equation}
\Delta S = -\frac{Q}{T} + k_B\ln{\frac{P_i}{P_f}},
\end{equation}
where $\Delta S$ is the entropy change between two states with the probability density function (PDF) of the position given by $P_i$ and $P_f$, respectively. The first term corresponds to the increase in entropy of the environment, which is assumed to be in equilibrium at temperature $T$ and the last term represents the increase in entropy of the system. In our notation, we will use $\Delta S$ and $\Sigma$ interchangeably to represent entropy production.

By employing a methodology analogous to that used for calculating the probability density functions of heat and work, we can derive the PDF of entropy production. Due to the similarities with the previous derivations, we will omit several intermediate steps. Similar to before, the PDF of entropy production can be expressed as:
\begin{equation}\label{eq:entropy_repre}
P_{\Sigma}(\Sigma) = \frac{1}{2\pi}\int_{-\infty}^{\infty} dz \hat{P}_{\Sigma}(z) \exp{(iz(\Sigma-\Sigma_0))},
\end{equation}
where $\hat{P}_{\Sigma}(z)e^{-iz\Sigma_0}$ is the characteristic function associated with the entropy production random variable and 
\begin{equation}
    \Sigma_0=\frac{1}{2}\ln{\frac{\sigma_X(t)^2}{\sigma_i^2}}.
\end{equation}
Once again, it is necessary to consider two distinct cases:

\subsubsection{For $0\leq t\leq t_f$}
To calculate the second term in the entropy expression, we need the probability density function of the position at the initial time as well as the position PDF at $t \leq t_f$, as given by Eq.~(\ref{position pdf}). By utilizing the expression for the heat done, as shown in Eq.~(\ref{eq:heat done}), and the two-point probability distribution given in Eq.~(\ref{two points pdf}), we can determine the total entropy (in the chosen units) for $t \leq t_f$ as follows:
\begin{equation}
    \Sigma =\frac{1}{2}k_m(x_i^2-x_t^2)+\Sigma_0-\frac{x_i^2}{2\sigma_i^2}+\frac{x_t^2}{2\sigma_X(t)^2}.
\end{equation}
The function $\hat{P}_{\Sigma}(z)$ is 
\begin{equation}
    \hat{P}_{\Sigma}(z)=\frac{1}{\sqrt{1+d_1z+d_2z^2}},
\end{equation}
where 
\begin{eqnarray}
  d_1&=&\frac{i \left(-k_m \sigma_m ^4 k_i+k_m^2 \sigma_m ^4-k_m \sigma_m ^2+1\right)}{\sigma_m ^2 k_i},\\
  d_2&=&\frac{\left(k_m-k_i\right) \left(k_m \sigma_m ^2-1\right)}{k_i}.
\end{eqnarray}
Computing the integral (\ref{eq:entropy_repre}), we arrive to the expression
\begin{widetext}    
\begin{align}\label{pdf entropy}
    %P(Q,t)=&\frac{1}{\pi}\sqrt{\frac{k_i-k_m}{2k_m\expval{Q}_t}}\exp{\frac{k_i-k_m}{2k_m} Q}K_0\left(\frac{(k_i-k_m)\sqrt{\sigma_Q^2-\expval{Q}_t^2}}{2k_m\expval{Q}_t}\abs{Q}\right)\\
    P_{\Sigma}(\Sigma,t)&=\frac{1}{\pi\sqrt{\sigma_{ \Sigma}(t)^2-2\expval{ \Sigma- \Sigma_0}_t^2}}\exp{\frac{\expval{ \Sigma-\Sigma_0}_t}{\sigma_{ \Sigma}(t)^2-2\expval{ \Sigma - \Sigma_0}_t^2}(\Sigma - \Sigma_0)} K_0\left(\frac{\sqrt{\sigma_{ \Sigma}(t)^2-\expval{  \Sigma - \Sigma_0}_t^2}}{\sigma_{ \Sigma}(t)^2 -2\expval{ \Sigma - \Sigma_0}_t^2}\abs{  \Sigma - \Sigma_0}\right).
\end{align}
\end{widetext}
where 
\begin{eqnarray}
  \expval{\Sigma}_t&=&\Sigma_0+\frac{k_m-k_i}{2k_i}\left(1-e^{-2k_mt}\right),
  \label{eq:sigmat}
  \\
  \sigma_\Sigma^{2}(t)&=&2\expval{ \Sigma - \Sigma_0}^2+\frac{(k_i-k_m)^2\left(1-e^{-2k_mt}\right)}{k_i\left(k_m-k_i\left(1-e^{2k_mt}\right)\right)}.
  \label{eq:sigmavart}
\end{eqnarray}


\subsubsection{For $t\geq t_f$}

In this case, the entropy is given by
\begin{equation}
\Sigma = \frac{1}{2}k_m(x_i^2-x_f^2) + \frac{1}{2}k_f(x_f^2-x_t^2) + \Sigma_0 - \frac{x_i^2}{2\sigma_i^2} + \frac{x_t^2}{2\sigma_X(t)^2}.
\end{equation}
It is worth noting that if we ensure a final equilibrium situation at $t_f$ by imposing the consistency relation~(\ref{consistency}), there is a cancellation between $-k_f x_t^2/2$ and $x_t^2/(2\sigma_X(t)^2)$ making $\Sigma$ stationary.

In this time interval and  assuming that $k_m$ is  general, the function $\hat{P}_{\Sigma}(z)$ takes the form
\begin{equation}\label{eq:f-coe}
\hat{P}_{\Sigma}(z) = \frac{1}{\sqrt{1 + f_1z + f_2z^2 + f_3z^3}},
\end{equation}
where the coefficients $f_1, f_2,$ and $f_3$ are complex expressions of the system parameters (refer to Appendix \ref{app:2} for details). Due to the cubic polynomial inside the square root, the integral in Eq.~(\ref{eq:entropy_repre}) cannot be evaluated in closed form.

Therefore, in this section, we will impose a constraint on the variable $k_m$ to satisfy the consistency equation (\ref{consistency}). Under this constraint, the coefficient $f_3$ vanishes, allowing us to obtain a closed-form expression. This is similar to the result in the previous section, Eq.~(\ref{pdf entropy}), although the average and variance will exhibit modifications. Specifically, they are time-independent, given by:
\begin{eqnarray}
  \expval{\Sigma}&=&\Sigma_0+\frac{k_m}{2}\left(\frac{1}{k_i}-\frac{1}{k_f}\right),\\
  \sigma_\Sigma^{2}&=&2\expval{\Sigma-\Sigma_0}^2+\frac{2\expval{\Sigma-\Sigma_0}(k_m-k_f)}{k_m}.
\end{eqnarray}
with $\Sigma_0=\frac{1}{2}\ln(k_i/k_f)$. These computed values coincide with the final values obtained in the previous time interval, Eqs.~(\ref{eq:sigmat}) and~(\ref{eq:sigmavart}) for $t=t_f$. Furthermore, for $t > t_f$, these values remain constant as expected for an equilibrium situation. Fig.~\ref{fig:entropy_metrics} shows the evolution of the average entropy production and its standard deviation.

The entropy production distribution satisfies a relation similar to the ones for work and heat shown in Eqs.~(\ref{eq:PWP-W}) and~(\ref{eq:PQP-Q}) if we define $\tilde\Sigma=\Sigma-\Sigma_0$. This is given by
\begin{eqnarray}
     \frac{P_{\tilde\Sigma}(\tilde\Sigma)}{P_{\tilde\Sigma}(-\tilde\Sigma)}&=&\exp{\frac{2\expval{\Sigma-\Sigma_0}_t}{\sigma_\Sigma^2-2\expval{\Sigma-\Sigma_0}_t^2}\tilde\Sigma}
     \nonumber\\
     &=&\exp{\frac{k_m}{k_m-k_f}\tilde\Sigma}
    \,.\label{eq:psp-s}
\end{eqnarray} 
Fig.~\ref{fig:PSP-S} represents this relation for $t=t_f\ll 1$ and the simulation results for the other protocols considered in this paper. This figure shows the universality of the relation (\ref{eq:psp-s}) when $t_f\ll 1$. However this universality breaks down for longer protocols $t_f\sim 1$ as can be appreciated at Fig.~\ref{fig:scattertf}.
% Figure environment removed
% Figure environment removed


% Figure environment removed

\subsubsection{Fluctuation theorem for the entropy production}
The entropy distribution must satisfy a fluctuation theorem~\cite{Evans1, Evans2}, in the same way that work distribution must satisfy the Jarzynski equality and the Crocks relation. Hence, we will prove the integral fluctuation relation for the entropy production.
Using the definition of the expectation value and inserting the integral representation given in Eq.~(\ref{eq:entropy_repre}), we can obtain the following identity:
\begin{equation}
\langle e^{-\Sigma} \rangle = \hat{P}_{\Sigma}(-i)e^{-\Sigma_0}.
\end{equation}
For arbitrary $k_m$ (not necessarily a solution of the consistency equation (\ref{consistency})), we can compute $\hat{P}_{\Sigma}(-i)$ as:
\begin{equation}
\hat{P}(-i) = \frac{\sigma_X(t)}{\sigma_i}.
\end{equation}
As a result, the expectation value is given by:
\begin{equation}
\langle e^{-\Sigma} \rangle = 1.
\end{equation}
This is the well-known integral fluctuation theorem for the entropy production~\cite{Evans1,Evans2,gallavottiDynamicalEnsemblesStationary1995}.


\section{Conclusion}

We have reviewed how to construct ESE protocols, in particular, we have shown that for a Brownian particle in a harmonic potential with time-dependent stiffness and at equilibrium initially with a Gaussian distribution, the position distribution remains Gaussian for later times and the variance of the position distribution depends on the protocol. 
Moreover, we have thoroughly described the two-step protocol and examined its energetic behaviors. Notably, we obtained analytical expressions for the distribution functions of work, heat, and entropy production. These analytical solutions comply with the fluctuation theorems and identities well-established in the existing literature~\cite{Evans1, Evans2, gallavottiDynamicalEnsemblesStationary1995, Crooks1998, crooks_entropy_1999, Jar97, jarzynski_equilibrium_1997}.

The significance of the two-step protocol extends beyond analytical solutions, as it also characterizes more general protocols within the time range of interest of the shortcut protocols (i.e., when $t_f \ll \taurel$). Our findings unveil intriguing insights into the behavior of various protocols that are of common interest for theoretical and experimental investigations. The average value of the stiffness $k_m$ is inversely proportional to the protocol duration $t_f$, explicitly given by Eq.~(\ref{eq:km_tf_short}). This relation can serve as a guide for designing fast thermalization protocols. It also imposes some restrictions on them. If for some practical application the stiffness has to be bounded, Eq.~(\ref{eq:km_tf_short}) imposes a limit on how short the protocol can be~\cite{trizac3}. Regarding the energetics statistics, we obtained strong numerical evidence that suggest that the probability distribution functions of work, heat and entropy production satisfy universal simple relations given by Eqs.~(\ref{eq:PWP-W}), (\ref{eq:PQP-Q}) and~(\ref{eq:psp-s}) when we compare the positive versus the negative production of these quantities.

In summary, our research significantly advances the comprehension of stochastic thermodynamics in colloidal Brownian particles. We have gained valuable insights into the dynamics of overdamped Brownian particles under time-dependent potentials and external control, facilitating the acceleration of equilibration times. These findings hold great potential for the design and application of efficient protocols across diverse scientific and engineering disciplines. 

Despite the valuable insights gained, this study faced certain limitations, particularly in the context of the overdamped regime. Future research may involve finding analytical solutions in the underdamped regime and extending the analysis to systems of interacting particles. By addressing these aspects, future investigations can provide a more comprehensive understanding of the fast thermalization protocols for Brownian particles in complex environments, further enriching the field of stochastic thermodynamics.


\section{Acknowledgments}
This work was supported by Fondo de Investigaciones, Facultad de Ciencias,
Universidad de los Andes INV-2021-128-2267. We thank Emmanuel Trizac for fruitful discussions.



\section{Appendixes}
\appendix 
\section{}\label{app:1}
In order to prove the Crooks identity (\ref{eq:crooks identity}), it is necessary to demonstrate the symmetry under the permutation $k_i \leftrightarrow k_f$ of the Bessel function in (\ref{eq:pdf work}). To achieve this goal, we use the followings definitions
\begin{eqnarray}
 S &=& \frac{(k_m-k_f)(k_m-k_i)\sigma_m^2(t)}{2},\\
 A &=& \frac{k_f-k_i}{2},
\end{eqnarray}
where $S$ and $A$ stand for symmetric and anti-symmetric under the permutation, respectively.
The equations~(\ref{metrics general}) takes the form
\begin{eqnarray}
 \expval{W} &=& \frac{A+S}{k_i},\\
 \sigma_W^2 &=& \frac{2(A+S)^2+2k_iS}{k_i^2}.
\end{eqnarray}
Now, the combination in the argument of the Bessel function is 
\begin{equation}
    \frac{\sqrt{\sigma_W^2-\expval{W}^2}}{\sigma_W^2-2\expval{W}^2}=\frac{\sqrt{A^2+S^2+2S(A+k_i)}}{2S}.
\end{equation}
The only term that is not evident symmetric is the combination $A+k_i$, however
\begin{equation}
    A+k_i=\frac{k_i+k_f}{2}
\end{equation}
that is symmetric under the permutation.


\section{}\label{app:2}
In this appendix, where  give the intricate expression of the coefficients given intervening in Eq.~(\ref{eq:f-coe}):
\begin{eqnarray*}
    \sigma _t^2f_3 &=& i \sigma _f^2 \sigma _m^2 \left(k_f-k_m\right) \left(k_f \sigma _t^2-1\right) \left(\sigma _i^2 k_m-1\right),\\
    \sigma _t^2f_2 &=& \sigma _m^2 \left(\sigma _i^2 k_m-1\right) \left(k_m \sigma _t^2-1\right)
    -\sigma _f^2 \left(k_f \sigma _t^2-1\right)\\
    &&\times\left(\sigma _m^2 \left(2 k_f-k_m\right) \left(\sigma _i^2 k_m-1\right)-k_f \sigma _i^2+1\right),\\
    \sigma _t^2f_1 &=& -i\sigma _f^2 \left(k_f \sigma _t^2-1\right) \left(k_f \left(\sigma _m^2 \left(\sigma _i^2 k_m-1\right)-\sigma _i^2\right)+1\right)+\\
    &+&i\sigma _i^2 \left(k_m \sigma _m^2 \left(k_m \sigma _t^2-1\right)+1\right)-i\sigma _t^2 \left(k_m \sigma _m^2+1\right)+\\
    &+&i\sigma _m^2,
\end{eqnarray*}
where $\sigma_t$ is the solution of (\ref{n2}) in the interval $t\geq t_f$ given by
\begin{equation}
    \sigma^2_t=\left(-\frac{1}{k_f}+\frac{1-k_m \sigma _m^2}{k_i}+\sigma _m^2\right)e^{-2 k_f \left(t-t_f\right)}+\frac{1}{k_f}.
\end{equation}
Using the consistency equation, these coefficients collapse to
\begin{eqnarray}
    f_3 &=&0, \\
    f_2 &=& \frac{\left(k_i-k_f\right) \left(k_f-k_m\right)}{k_f k_i},\\
    f_1 &=& -i k_m \left(\frac{1}{k_f}-\frac{1}{k_i}\right).
\end{eqnarray}
Because $f_3$ is zero, the polynomial (\ref{eq:f-coe}) is of second order and the inverse Fourier transform can be computed in terms of Bessel functions~(Eq.~(\ref{pdf entropy})).


\nocite{*}

\bibliography{TSP_article} % Produces the bibliography via BibTeX.

\end{document}
%

