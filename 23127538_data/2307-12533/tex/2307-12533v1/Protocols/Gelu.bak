\subsection{Secure Design of $\gelu$}\label{sec:gelu}
\iffalse
As equation~\ref{eq:gelu} shows, the $\tanh$-based $\gelu$ function is composed of secure $\mathsf{add}$, $\mathsf{mult}$, and $\tanh$. $\mathsf{add}$ and $\mathsf{mult}$ are efficient in RSS-based 3-party computation, but $\tanh$ is much more expensive in both computation and communication costs. Therefore, we focus on approximating $\tanh$ to improve its efficiency while meeting the precision requirements.

\begin{equation}\label{eq:gelu}
    \gelu(x) = \frac{x}{2} \times \left(1 + \tanh \left( \sqrt{\frac{2}{\pi}} \times \left(x + 0.044715 \times x^3 \right) \right) \right)
\end{equation}

Inspired by, we approximate $\tanh$ by piece-wise polynomials. As illustrated in Figure~\ref{fig:tanhapp}, we divide the evaluation of $\tanh$ into 3 cases: 
\begin{itemize}
    \item $|x| > 3$: When $x>3$, $\tanh(x)$ is infinity close to $1$. Therefore, we approximate $\tanh(x)$ as $1$ when $x>3$. Similarly, we set $\tanh(x)$ as $-1$ when $x<-3$.
    
    \item $1 < |x| \le 3$: When $1< x < 3$, we approximate $\tanh(x)$ by polynomials. In practice, we find that Degree-3 polynomial is enough to meet our demands. Concretely, our Degree-3 polynomial for $1<x<3$ is \begin{equation}
        \tanh(x) \approx 0.04664113 \times x^3 -0.36342224 \times x^2 +  0.96372621\times x + 0.11870119
    \end{equation}
    Similarly, when $-3<x<-1$, the approximation polynomial is $\tanh(x) \approx 0.04664113 \times x^3 + 0.36342224 \times x^2 +  0.96372621\times x - 0.11870119$.
    
    \item $|x| \le 1$: In this case, we approximate $\tanh(x)$ by using Chebv polynomials.
\end{itemize}

\begin{figure}
    \centering
    \includegraphics[width=200pt]{Figs/tanh_app.eps}
    \caption{Approximations of function $\tanh$.}
    \label{fig:tanhapp}
\end{figure}
\fi

