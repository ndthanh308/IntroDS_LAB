\begin{algorithm}[tp]
\caption{Secure $\gelu$ Protocol $\Pi_{\mathsf{GeLU}}$}\label{protocol:gelu}
\begin{algorithmic}[1]
\REQUIRE
$P_i$ holds the 2-out-of-3 replicate secret share $\share{x}_i$ for $i\in \{0,1,2\}$ 
\ENSURE
$P_i$ gets the 2-out-of-3 replicate secret share $\share{y}_i$ for $i\in \{0,1,2\}$, where $y=\gelu(x)$.

\STATE $P_0$, $P_1$, and $P_2$ jointly compute
\begin{equation*}
\begin{split}
&\shareb{b_0} = \Pi_{\mathsf{LT}}(\share{x}, -4),~~~\vartriangleright b_0 = 1\{x<-4\}\\
&\shareb{b_1} = \Pi_{\mathsf{LT}}(\share{x}, -1.95),~~~\vartriangleright b_1 = 1\{x<-1.95\} \\
&\shareb{b_2} = \Pi_{\mathsf{LT}}(3, \share{x}),~~~~~~\vartriangleright b_2 = 1\{3<x\}
\end{split}
\end{equation*}
and compute 
$\shareb{z_0} = \shareb{b_0} \oplus \shareb{b_1}$,
$\shareb{z_1} = \shareb{b_1} \oplus \shareb{b_2} \oplus 1$, and $\shareb{z_2}=\shareb{b_2}$. Note that $z_0 = 1\{-4\le x < -1.95\}$, $z_1 = 1\{-1.95\le x\le 3\}$, and $z_2 = 1\{x>3\}$.

\STATE Jointly compute $\share{x^2} = \Pi_{\mathsf{Square}}(\share{x})$, $\share{x^3} = \Pi_{\mathsf{Mul}}(\share{x}, \share{x^2})$, $\share{x^4} = \Pi_{\mathsf{Square}}(\share{x^2})$, and $\share{x^6} = \Pi_{\mathsf{Square}}(\share{x^3})$.

\STATE Computing polynomials $\share{F_0(x)}$ and $\share{F_1(x)}$ based on $\{\share{x}, \share{x^2}, \share{x^3}, \share{x^4}, \share{x^6}\}$ as equation~(\ref{eq:geluapprox}) securely.


\RETURN$\share{y} = \Pi_{\mathsf{Mul_{BA}}}(\shareb{z_0}, \share{F_0(x)}) + \Pi_{\mathsf{Mul_{BA}}}(\shareb{z_1}, \share{F_1(x)})+\Pi_{\mathsf{Mul_{BA}}}(\shareb{z_2}, \share{x})$.

\end{algorithmic}
\end{algorithm}