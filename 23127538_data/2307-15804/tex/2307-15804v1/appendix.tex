%\tableofcontents

\vspace{0.5cm}

\section{Proof of Lemma \ref{lem:initialization}}
\label{sec:proof_lemma_1}

Let us first recall the Lemma before writing a proof of it.

\begin{lemma*}
    For all $a > 0$, we have $ \P_{\theta_0}(m_{\theta_0} \geq a/\sqrt{d}) \leq a^{-1}e^{-a^2/4}  $. Additionally, for any $\delta>0$ such that $ \max\{a, \delta\} \leq \sqrt{d}/4$, we have the lower bound:
    $\P_{\theta_0}(m_{\theta_0} \geq a/\sqrt{d}) \geq \frac{\delta}{4} e^ {- (a + \delta)^2} $.
   % $\P_{\theta_0}(m_{\theta_0} \geq b) \geq C e^{-\tau} -O(1/\sqrt{d})$ for a universal constant $C>0$. 
\end{lemma*}
%
\begin{proof}
%
By rotation invariance of the uniform distribution of the sphere, $m_{\theta_0}$ is distributed according to~$\theta_0[1]$, the first coordinate of the vector $\theta_0 \in \S$. By a particular case of Stamâ€™s formula \cite[relation (3)]{stam1982limit}, we know that for $d \geq 3$, both are distributed according to the probability of density, $\forall  t \in \R$,
%
\begin{align*}
    \tau(t):=\frac{\Gamma(d/2)}{\sqrt{\pi} \Gamma((d-1)/2)} \left(1 - t^2\right)^{(d-3)/2} \mathds{1}_{[-1, 1]}.
\end{align*}
%
First, note that we can upper and lower bound the constant by the following:
%
\begin{align*}
   \sqrt{\frac{d}{3}} \leq \frac{\Gamma(d/2)}{\Gamma((d-1)/2)} \leq \sqrt{\frac{d}{2}},
\end{align*}
%
for $d \geq 6$ by \cite[equality 3.2]{laforgia2013some}, which was already proved in \cite{gautschi1959some}. 

Hence, in terms of the upper bound, we have:
%
\begin{align*}
    \P_{\theta_0}(m_{\theta_0} \geq a/\sqrt{d}) &\leq \sqrt{\frac{d}{2\pi}} \int_{a/\sqrt{d}}^1  \left(1 - t^2\right)^{(d-3)/2} dt \\
    &\leq \sqrt{\frac{d}{2 \pi}} \int_{a/\sqrt{d}}^1  e^{-\frac{d-3}{2} t^2} dt \\
    &\leq \frac{1}{\sqrt{2\pi}}\frac{d}{a} \int_{a/\sqrt{d}}^1 t  e^{-\frac{d-3}{2} t^2} dt \\
    &\leq \frac{1}{2a}   e^{-a^2/4}~,
\end{align*}
%
which concludes the first part of the result.
%The second statement is established in \cite[Lemma 2.1]{cryptoeprint:2015/1128}.     

Second, let $a \leq \sqrt{d}/4$ and take any $0<\delta< \sqrt{d}/4$. We have, 
%
\begin{align*}
    \P_{\theta_0}(m_{\theta_0} \geq a/\sqrt{d}) &\geq \sqrt{\frac{d}{3\pi}} \int_{a/\sqrt{d}}^1  \left(1 - t^2\right)^{(d-3)/2} dt \\
    &\geq  \sqrt{\frac{d}{3\pi}} \int_{a/\sqrt{d}}^{(a + \delta)/\sqrt{d}}  \left(1 - t^2\right)^{(d-3)/2} dt \\
    &\geq \sqrt{\frac{d}{3\pi}} \frac{\delta}{\sqrt{d}} \left(1 - \frac{(a + \delta)^2}{d} \right)^{(d-3)/2},
\end{align*}   
where the last inequality simply comes from the fact that $t \to (1-t^2)^{(d-3)/2}$ is non-increasing. Going further, if we lower bound the term with the negative $-3/2$ power by $1$, we have
\begin{align*}
    \P_{\theta_0}(m_{\theta_0} \geq a/\sqrt{d}) &\geq \frac{\delta}{4} \exp\left( \frac{d}{2} \log\left(1 - \frac{(a + \delta)^2}{d} \right)\right) \\
    &\geq  \frac{\delta}{4} \exp\left( - \frac{(a + \delta)^2}{2 \left( 1 - (a + \delta)^2/d \right)} \right)~,
\end{align*}
%
where the last inequality come from the classical bound $\log (1 + x) \geq x/(1+x)$, for $x > - 1$. Furthermore, as, $(a+\delta)^2 \leq d/2$, we have finally
%
\begin{align*}
    \P_{\theta_0}(m_{\theta_0} \geq a/\sqrt{d}) &\geq  \frac{\delta}{4} e^ {- (a + \delta)^2},
\end{align*}
%
which finalizes the proof of the Lemma.
%
\end{proof}


\input{App_Proof_SGD}


\section{The \texorpdfstring{$\LPG$}{lol} property in the symmetric case: proofs of Section \ref{subsec:sym}}
\label{sec:symapp}

\subsection{Useful Facts about Gegenbauer Polynomials}

We recall known facts on Gegenbauer Polynomials.

\paragraph{Definitions.}
%Define Gegenbauer polynomials
Recall that $P_{j,d}$ denotes the Gegenbauer polynomial of degree $j$ and dimension $d$, normalized so that $P_{j,d}(1) = 1$ for all $j,d$. 
We denote also $\bar{P}_{j,\lambda}$ the Gegenbauer polynomials normalized so that $\| \bar{P}_{j,\lambda} \|^2_{L^2(\mathbb{R}, u_{2\lambda+2})} = \pi 2^{1-2\lambda} \frac{\Gamma(j + 2\lambda)}{(j+\lambda)\Gamma^2(\lambda)\Gamma(j+1)}$. Throughout the proof, we will use either $d$, and from time to time the mute symbol $\lambda$ to denote the dimension variable of Gegenbauer polynomials. They satisfy the following recurrence: 
%
\begin{align}
\label{eq:recurrgegen}
    (j+1)\bar{P}_{j+1, \lambda}(t) & = 2(j+\lambda) t \bar{P}_{j,\lambda}(t)-(j+2\lambda-1)\bar{P}_{j-1,\lambda}(t)~,
\end{align}
%
with first terms: $ \bar{P}_{0, \lambda}(t) = 1$ and $\bar{P}_{1, \lambda}(t)  = 2\lambda t$.

\paragraph{Rodrigues Formula for Gegenbauer Polynomials.} The Gegenbauer polynomials can be represented as repeated derivatives of a simple polynome. 
%
\begin{proposition}[{\cite[Proposition 4.19]{frye2012spherical}}]
We have the formula
   \begin{equation}
       P_{j,d}(t) = \frac{(-1)^j}{2^j (j + (d-3)/2)_j }(1-t^2)^{(3-d)/2} \left(\frac{d}{dt}\right)^j (1-t^2)^{j+ (d-3)/2}~, 
   \end{equation} 
   where $(x)_j=\prod_{k=0}^{j-1} (x-k)$ is the falling factorial. 
\end{proposition}

\paragraph{Hecke-Funk Formula. } Recall that we use the notation $\tau_d$ to denote the uniform distribution on the sphere and $u_d$ the distribution of, e.g., its first coordinate: $u_d \propto (1-t^2)^{(d-3)/2} \mathds{1}_{[-1,1]}$.
%
\begin{theorem}[{\cite[Theorem 4.24]{frye2012spherical}}]
    For $\theta, \theta' \in \S$, $f \in L^2_{u_d}(\mathbb{R})$ and $j \in \mathbb{N}$,
    %
    \begin{align}
        \langle f_\theta, (P_{j,d})_{\theta'} \rangle_{\tau_{d}} &= \Omega_{d-2} P_{j,d}( \theta \cdot \theta' ) \langle f, P_{j,d} \rangle_{u_d} \nonumber \\
        &= \Omega_{d-2} P_{j,d}( \theta \cdot \theta' ) \int_{-1}^1 f(t) P_{j,d}(t) (1-t^2)^{(d-3)/2} dt ~.
    \end{align}
    %
\end{theorem}


%Then it is a fact that {\color{red} cite}

\begin{fact}\label{fact:deriv}[Derivative Representation] We have the following derivation property for all $j,d$:
\begin{align}
 %   P_{j,d}'(m)= \frac{-j(j + d -2)}{(d-1)/2} P_{j-1,d+2}(m)
    P_{j,d}'  &= \frac{j (j+d-2)}{(d-1)} P_{j-1,d+2}~.
\end{align}
\end{fact}
\begin{proof}
 Recall the normalization relationships   $\lambda = \frac{d}{2}-1$, 
$\bar{P}_{j,\lambda}(1) = \frac{\Gamma(j+2\lambda)}{\Gamma(j+1)\Gamma(2\lambda)}$ , 
$P_{j,d} = \frac{\Gamma(j+1)\Gamma(d-2)}{\Gamma(j+d-2)}\bar{P}_{j, \frac{d}{2}-1}$, as well as the identity
$\bar{P}'_{j,\lambda} = 2 \lambda \bar{P}_{j-1,\lambda+1}$. Thus, 
\begin{align}
 %   P_{j,d}'(m)= \frac{-j(j + d -2)}{(d-1)/2} P_{j-1,d+2}(m)
    P_{j,d}' &=  \frac{\Gamma(j+1)\Gamma(d-2)}{\Gamma(j+d-2)}\bar{P}'_{j, \frac{d}{2}-1} \nonumber \\
            &=  2\frac{\Gamma(j+1)\Gamma(d-2)}{\Gamma(j+d-2)} (\frac{d}{2}-1) \bar{P}_{j-1,\frac{d}{2}} \nonumber \\ 
            & = (d-2)  \frac{\Gamma(j+1)\Gamma(d-2)}{\Gamma(j+d-2)}  \frac{\Gamma(j-1+d)}{\Gamma(j)\Gamma(d)} P_{j-1,d+2} \nonumber \\
            &= \frac{j (j+d-2)}{(d-1)} P_{j-1,d+2}
\end{align}
\end{proof}

We have the following bound of the location of the largest root $z_{j,d}$ of $P_{j,d}$:  %\cite[Corollary 2.3]{Area2004ZerosOG}:
\begin{fact}[Bound on the Largest Root,{\cite[Corollary 2.3]{Area2004ZerosOG}}]
\label{fact:largestroot}
\begin{equation}
    z_{j,d} \leq \sqrt{\frac{(j-1)(j+d-4)}{(j+d/2-3)(j+d/2-2)}} \cos(\pi/(j+1)) ~.
\end{equation}
\end{fact}

And we have the following bound on the Taylor expansion of the Gegenbauer polynomials:
\begin{fact}[Taylor Upper bound beyond largest root]
\label{fact:gegenwellbeh}
    $$P_{j,d}(t) \geq ( t - z_{j,d})^{j}~,~\text{for } t \geq z_{j,d}~,$$
\end{fact}
\begin{proof}
    Note that all families of orthogonal polynomials have exclusively real, simple roots.  Therefore, by Rolle's theorem, the $j-1$ critical points of  $P_{j,d}$ must be interlaced with the $j$ zeroes.  So all zeroes of $P_{j,d}'$ are upper bounded by $z_{j,d}$.  Futhermore, by Fact~\ref{fact:deriv}, $P_{j,d}'$ is itself an orthogonal polynomial.  So applying this argument recursively, we see the zeros of $P_{j,d}^{(k)}$ for $k \leq j$ are all upper bounded by $z_{j,d}$.

    Note also by Fact~\ref{fact:deriv} that, because $P_{j,d}(1) = 1$ for any choice of $j$ and $d$, it follows that $P_{j,d}^{(k)}(1) > 0$.  This implies $P_{j,d}^{(k)}(z_{j,d}) > 0$, as in order to flip signs there would need to be a zero in the range $[z_{j,d}, 1]$ which we've confirmed above cannot exist.

    Now, consider a Taylor expansion

    \begin{align}
        P_{j,d}(t) = \sum_{i=0}^j c_i (t - z_{j,d})^i
    \end{align}

    Observe that $P_{j,d}^{(k)}(z_{j,d}) = k! c_k$, and therefore by the above argument we have $c_k > 0$.  So it remains to show that $c_j \geq 1$.

    Consider applying Fact~\ref{fact:deriv} repeatedly, then we have:

    \begin{align}
        P_{j,d}^{(j)}(1) &= \frac{j! \prod_{l=1}^j (j+d-3 + l)}{\prod_{l=1}^j (d-3 + 2l)} \\
        &= j! \prod_{l=1}^j \frac{j+d-3 + l}{d-3 + 2l}\\
        &\geq j!
    \end{align}

    And from the fact that $P_{j,d}^{(j)}(1) = j!c_j$, we conclude $c_j \geq 1$.
\end{proof}

% \clearpage
% %
% \par\noindent\rule{\textwidth}{.5pt}
% \rule[.8\baselineskip]{\textwidth}{.5pt}
% %


\subsection{Proof of Proposition \ref{prop:basicdec}}
\label{secapp:basicdec}
\begin{proposition}[Loss representation, restated]
The $\beta_{j,d}$ defined in \eqref{eq:lossmain} have the integral representation
    \begin{equation}
        \beta_{j,d} = \langle \phi, \mathcal{K}_j \phi \rangle_{L^2(\mathbb{R},\eta)} ~,
    \end{equation}
    where $\mathcal{K}_j$ is a positive semi-definite integral operator of $L^2_\eta$ that depend solely on $\rho$ and $\phi$,     
    with kernel 
\begin{align}
\mathcal{K}_j(t,t') &= \frac{\Omega_{d-2}N(j,d)}{\Omega_{d-1}}  \int_0^\infty  P_j(r^{-1} t) P_j(r^{-1} t') \bar{u}_d(r^{-1} t) \bar{u}_d(r^{-1} t') \rho(dr)~,
\end{align}
where we defined the conditional density 
$$\bar{u}_d(r^{-1}t) = \frac{r^{-1} {u}_d(r^{-1} t)}{\int_0^\infty (r')^{-1} {u}_d((r')^{-1} t) \rho(dr')}~. $$
Moreover, we have 
\begin{equation}
   \mathbb{E}_\eta [\phi^2] = \frac{\Omega_{d-2}}{\Omega_{d-1}}\sum_j \beta_{j,d} = \frac{\Gamma((d-2)/2)}{\sqrt{\pi}\Gamma((d-1)/2)} \sum_j \beta_{j,d}~.
\end{equation}
\end{proposition}

% \begin{fact}
%     \begin{equation}
%         \beta_{j,d} = \langle \phi, \mathcal{K}_j \phi \rangle_{L^2(\mathbb{R},\eta)} ~,
%     \end{equation}
%     where $\mathcal{K}_j$ is the positive semi-definite integral operator in $L^2(\mathbb{R}, \eta)$ with kernel 
% \begin{align}
% \mathcal{K}_j(t,t') &= \frac{\Omega_{d-2}N(j,d)}{\Omega_{d-1}}  \int_0^\infty  P_j(r^{-1} t) P_j(r^{-1} t') \bar{u}_d(r^{-1} t) \bar{u}_d(r^{-1} t') \rho(dr)~,
% \end{align}
% where we defined the conditional density 
% $$\bar{u}_d(r^{-1}t) = \frac{r^{-1} {u}_d(r^{-1} t)}{\int_0^\infty (r')^{-1} {u}_d((r')^{-1} t) \rho(dr')}~. $$
% Moreover, we have 
% \begin{equation}
% \label{eq:enerconser}
%     \sum_j \beta_j = \mathbb{E}_\eta \phi^2~.
% \end{equation}
% \end{fact}
\begin{proof}
The marginal conditioned on $\|x\|=r$ is precisely given by 
$\eta(x_1=t ~|~\|x\|=r) = r^{-1} u_d(r^{-1} t)$, so 
$$\eta(t) = \int_0^\infty r^{-1} u_d(r^{-1} t) \rho(dr)~.$$

%$$\alpha_{j,r} = \langle T_r \phi, P_j \rangle_{\tau_d} = \langle \phi, T_r^* P_j \rangle_{r \tau_d}$$
We have 
\begin{align}
\alpha_{j,r} &= \| P_j\|^{-2} \int_{-1}^1 P_j(t) \phi^{(r)}(t) \tau_d(dt) =  \| P_j\|^{-2} \int_{-1}^1 P_j(t) \phi(r t) u_d(t) dt \nonumber\\
%&= r^{-1}\int_{-r}^r \phi(t) P_j(r^{-1} t) (1-r^{-2}t^2)^{(d-2)/3} dt \\
&= \frac{\Omega_{d-2}N(j,d)}{\Omega_{d-1}} r^{-1} \int_{-\infty}^\infty \phi(t) P_j(r^{-1} t) (1-r^{-2}t^2)^{(d-3)/2}_+ dt~, 
\end{align}
so
{\small
\begin{align}
    \beta_{j,d} &= \frac{\Omega_{d-2}N(j,d)}{\Omega_{d-1}}  \int_0^\infty r^{-2} \iint_{-\infty}^\infty \phi(t) P_j(r^{-1} t) (1-r^{-2}t^2)^{(d-3)/2}_+ \phi(t') P_j(r^{-1} t') (1-r^{-2}(t')^2)^{(d-3)/2}_+ dt dt' \rho(dr) \nonumber\\
    &= \langle \phi, \mathcal{K}_j \phi \rangle_{L^2(\mathbb{R}, \eta)}~,
\end{align} 
}
with the $L^2(\mathbb{R},\eta)$ positive semi-definite integral kernel operator 
{\small 
\begin{align}
\mathcal{K}_j(t,t') &= \frac{\Omega_{d-2}N(j,d)}{\Omega_{d-1}}  \eta(t)^{-1} \eta(t')^{-1} \int_0^\infty r^{-2} P_j(r^{-1} t) (1-r^{-2}t^2)^{(d-3)/2}_+ P_j(r^{-1} t') (1-r^{-2}(t')^2)^{(d-3)/2}_+ \rho(dr) \nonumber \\
&= \frac{\Omega_{d-2}N(j,d)}{\Omega_{d-1}}  \int_0^\infty  P_j(r^{-1} t) P_j(r^{-1} t') \bar{u}_d(r^{-1} t) \bar{u}_d(r^{-1} t') \rho(dr)~,
\end{align}}
where we defined the conditional density 
$$\bar{u}_d(r^{-1}t) = \frac{r^{-1} {u}_d(r^{-1} t)}{\int_0^\infty (r')^{-1} {u}_d((r')^{-1} t) \rho(dr')}~. $$
Finally, let us establish (\ref{eq:enercons1}). 
We have 
\begin{align}
\label{eq:enercons1}
    \mathbb{E}_\eta \phi^2 &= \mathbb{E}_\rho [\mathbb{E}_{x_1|\|x\|=r} \mathbb{E} \phi(x_1)^2 ] \nonumber \\
    & = \mathbb{E}_\rho [ \mathbb{E}_{u_d} (\phi^{(r)})^2] \nonumber \\
    & = \mathbb{E}_\rho \sum_j \alpha_{j,d,r}^2 \| P_j \|^2 \nonumber \\
    & = \mathbb{E}_\rho \sum_j \alpha_{j,d,r}^2 \frac{\Omega_{d-1}}{\Omega_{d-2} N(j,d)} \nonumber \\
    &= \frac{\Omega_{d-1}}{\Omega_{d-2}} \mathbb{E}_\rho \sum_j \bar{\alpha}_{j,r,d}^2 = \frac{\Omega_{d-1}}{\Omega_{d-2}} \sum_j \beta_{j,d}~.
\end{align}

    \end{proof}




\subsection{Proof of Proposition \ref{prop:infoexpo_sphere}}

\begin{proof}
    

If $\beta_{j,d}=0$ for $j < s$, then $\alpha_{j,r,d}=0$ for $j<s$ and $\rho$-ae $r$. We want to show that for any polynomial $Q$ of degree $j'<s$, we must have 
$\langle \phi, Q \rangle_\eta  = 0$. 

For each $r$, consider $Q^{(r)}(t) = Q(rt)$, which is also a polynomial of degree $j'<s$, and its decomposition as $Q^{(r)} = \sum_{j=0}^{j'} b_{j,j',r} P_{j,d}$, which only involves terms of degree $j'<s$ since Gegenbauer polynomials of degree up to $r$ span all polynomials of degree up to $r$.
We have 
\begin{align}
    \langle \phi, Q \rangle_\eta &= \mathbb{E}_\eta [ \phi(x) Q(x)] \nonumber \\
    &= \mathbb{E}_\rho \mathbb{E}_{x_1 | \|x\|=r} [\phi(x) Q(x)] \nonumber \\
    &= \mathbb{E}_\rho \mathbb{E}_{u_d} [\phi^{(r)}(x) Q^{(r)}(x)] \nonumber \\
    &= \mathbb{E}_\rho [\sum_{j \leq j'} b_{j,j',r} \alpha_{j,r,d} ] = 0~.
\end{align}
\end{proof}

%If $\langle \phi, q_j \rangle_\eta =0$ for $j=0\ldots \tilde{s}-1$, then 
%$\langle \phi, Q \rangle_\eta = 0$ for any polynomial $Q$ of degree smaller than %$\tilde{s}$. 
%But observe that $\mathcal{K}_j(t,t')$ is a polynomial kernel of degree $j$ 

\subsection{Proof of Proposition \ref{prop:sufficientcond}}
\sufficientcond*
% \begin{claim}[Spectral characterization of Local growth]
% \label{sufficientcond}
%     Suppose there exist universal constants $K,C>0$ and $s \in \mathbb{N}$ such that 
%     \begin{enumerate}
%         \item $\beta_{s,d} \geq C$. 
%         %\item $\frac{d^{(s-1)/2}}{s (s+d-2)} \sum_{j > s} \beta_{j,d} j (j+d-2)  \upsilon_{j-1,d+2} \leq K$. 
%         \item $\sum_{j > s} \beta_{j,d} j (j+d-2)  \upsilon_{j-1,d+2} \leq K d^{(3-s)/2} $. 
%        % \item $\sum_{j\geq d} \beta_{j,d} \leq h(s,d) \beta_{s,d}$. 
%     \end{enumerate}
%     Then $\ell(m)$ has $(s-1, O(1/\sqrt{d}))$ local polynomial growth. 
% \end{claim}
\begin{proof}
    Assume first that there are $\bar{C}, \bar{\zeta}$ such that 
\begin{equation}
\label{eq:bi0}
P'_{s,d}(t) \geq \bar{C}( t - \bar{\zeta})^{s-1}~,~\text{ for } t \geq \bar{\zeta}~.        
\end{equation}
Now, let 
\begin{equation}
\label{eq:bi1}
B = \frac{1}{d-1} \sum_{j \geq s} \beta_{j,d} j(j+d-2)  \upsilon_{j-1,d+2} < 1~,
\end{equation}
and define
\begin{equation}
\label{eq:bi2}
    \zeta^* := \left( \frac{B}{\beta_{s,d}\bar{C}}\right)^{1/(s-1)} + \bar{\zeta}~.
\end{equation}
From (\ref{eq:bi0}), (\ref{eq:bi1}) and (\ref{eq:bi2}) we verify that $\ell'(m) = \sum_j \beta_{j,d} P'_{j,d}(m)$ satisfies, for $m \geq \zeta^*$, 
$$\ell'(m) \geq \beta_{s,d} \bar{C} \left((m-\bar{\zeta})^{s-1} - (m-\zeta^*)^{s-1} \right) \geq  \beta_{s,d} \bar{C} \left[\left(\frac{1-\bar{\zeta}}{1-\zeta^*} \right)^{s-1} -1 \right] (m-\zeta^*)^{s-1}~.$$

Finally, we have that for any $j,d$, the largest root $z_{j,d}$ satisfies $z_{j,d} \leq \sqrt{\frac{(j-1)(j+2d-2)}{(j+d-2)(j+d-1)}} \simeq j/\sqrt{d}$ and 
$$P_{j,d}(t) \geq \frac12 ( t - z_{j,d})^{s}~,~\text{for } t \geq z_{j,d}~,$$
which implies that 
\begin{equation}
    P'_{s,d}(t) \geq \frac{s(s+d-2)}{2(d-1)} ( t - z_{s-1,d+2})^{s-1} ~,~\text{ for } t \geq z_{s-1,d+2}~. 
\end{equation}
We thus have $\bar{C} = \frac{s(s+d-2)}{2(d-1)}$ with $\bar{\zeta} = z_{s-1,d+2}$. 

Finally, we verify that 
\begin{align}
\label{eq:bi3}
    \frac{d^{(s-1)/2}}{s(s+d-2)} \sum_{j > s} \beta_{j,d} j (j+d-2) \upsilon_{j-1,d+2} &\leq K 
\end{align}
ensures a local polynomial growth of order $s-1$ at scale $O(1/\sqrt{d})$. 
Indeed, plugging (\ref{eq:bi3}) into (\ref{eq:bi1}), together with $\beta_{s,d} \geq C$ yields 
\begin{align}
    \left( \frac{B}{\beta_{s,d}\bar{C}}\right)^{1/(s-1)} &\leq (CK)^{1/(s-1)}d^{-1/2} ~, 
\end{align}
which shows that $\zeta^* = O(1/\sqrt{d})$. 
Finally, we observe that $\bar{C} \geq s=\Theta(1)$ if $s<d$. 

\end{proof}

\subsection{Proof of Theorem \ref{coro:symmcase}}
\label{sec:proofthmsym}

\begin{proof}
    % Figure \ref{fig:my_label} displays $j(j+d)\upsilon_{j,d}$ for a grid of values of $(j,d)$. We verify that in the range $j < d$ we have a power law $j(j+d)\upsilon_{j,d} \simeq j^{-\varepsilon_d}$, with $\varepsilon_d \to 10$, and $j(j+d)\upsilon_{j,d} \simeq \kappa^{-d}$ for $j \gg d$, with $\kappa \approx \log_{10} 1/8$.

% % Figure environment removed

% Moreover, we have the following quantitative bound, useful in the regime $j \ll d$:
% \begin{fact}[Behavior of $\upsilon_{j,d}$, {\cite[Lemma 2.3]{de2008local}}]

%     Let $z_{j,d}$ denote the largest root of $P_{j,d}$. We have  
% \begin{align}
%     \upsilon_{j,d} &\leq \frac{j(j+d-2)}{d-1} z_{j,d}^{j-1} (z_{j,d}-z_{j-1,d+2})  ~.
%   %  &\leq \frac{j(j+d-2)}{d-1}  \frac{(j-1)^{j/2} (j+d-4)^{j/2} (j-2)^{1/2} (j+d-3)^{1/2} }{(j+d/2-3)^{j/2} (j+d/2-2)^{j/2} (j+d/2-3)^{1/2} (j+d/2 -2)^{1/2}}
% \end{align} 
% % We have $\upsilon_{j,d} \simeq 2^{-\alpha d} \min(1, j/d)^{-\beta}$ for $\alpha \approx $, $\beta \approx $. 
% % When $j \ll d$, we have $\upsilon_{j,d} \simeq j \left( \frac{j}{d}\right)^{(j+1)/2}$. 
% % When $j \geq d$, we have 
% \end{fact}
To prove the theorem, we will establish the sufficient conditions of Proposition \ref{prop:sufficientcond} under our mild assumptions. 
The key technical results we need are explicit bounds for $\upsilon_{j,d}$ and for the sum $\sum_j j^2 \beta_{j,d}$, established in the following two lemmas. Since the parameter $\lambda = d/2-1$ is more convenient to express many relationships in Gegenbauer polynomials, we will adopt it in this proof instead of $d$, without loss of generality. 

\begin{lemma}[Control of $\upsilon_{j,\lambda}$]
\label{prop:upsicontrol}
% We have 
% \begin{equation}
%     \upsilon_{j, d} \leq \left(\frac{P(j,d)}{Q(j,d)} \right)^{j/2}
% \end{equation}
% where $P(j,d)$ and $Q(j,d)$ are explicit polynomials of degree $5$ in $(j,d)$. Moreover, when both $j$ and $d$ are large, we have 
% \begin{equation}
%     \upsilon_{j,d} \leq \left[1 - \left(\frac{\lambda}{j+\lambda} \right)^2 \right]^{j/2}~,
% \end{equation}
We have 
\begin{equation}
    \upsilon_{j,\lambda} \lesssim  \begin{cases}
    \left[1 - \left(\frac{\lambda}{j+\lambda} \right)^2 \right]^{j/2}
        %O\left( \left(\frac{j}{\lambda}\right)^{j/2} \right) 
        & \text{ if } j=\Omega(1) ~,\\
        \lambda^{\frac{(\alpha-1)\lambda^\alpha}{2}} & \text{ if } j = \Theta(\lambda^\alpha), \text{ with } 0< \alpha < 1~, \\
        e^{-\frac12 \lambda^{2-\alpha}} & \text{ if } j=\Theta(\lambda^\alpha) \text{ with } 1\leq \alpha < 3/2 ~, \\
        e^{-\lambda} & \text{ if } j = \Omega(\lambda^{3/2}) ~.
    \end{cases}
\end{equation}
%with $\lambda=d/2 -1$. 
\end{lemma}


\begin{lemma}[Decomposition of derivative]
\label{lemma:betas_derivative}
If $\phi \in L^2(\mathbb{R}, \mu)$ is such that $\phi' \in L^4(\mathbb{R}, \eta)$ and $\mathbb{E}_\rho [r^4] < \infty$, then 
$\beta_j = \langle \phi, \mathcal{K}_j \phi \rangle$ satisfies 
\begin{equation}
    \sum_j j^2 \beta_{j,d} \leq \frac{\Omega_{d-2}}{\Omega_{d-1}} \mathbb{E}_\rho [r^4]^{1/2} \|\phi'\|_{L^4(\eta)}^2 = O(1/d)~.
\end{equation}
\end{lemma}
% \begin{proof}
% The proof follows the argument outlined in (\ref{eq:enercons1}). 
% %Let us first show that $\sum_j j^2 \beta_{j,d} < \infty$ under our assumptions. 

% Let $\{q_i\}_i$ be the orthonormal basis of polynomials in $L^2(\mathbb{R},\eta)$, and let $\Pi_J$ be the orthogonal projector onto the first $J$ degrees: $\Pi_J f = \sum_{j \leq J} \langle f, q_j \rangle_{\eta} q_j$. 
% We also define ${\mathcal{K}}_{\leq J} = \sum_{j \leq J} \mathcal{K}_j$, and similarly $\mathcal{K}_{>J} = \sum_{j > J} \mathcal{K}_j$. 

% %Let us first show that $\sum_j j^2 \beta_j < \infty$. 
% We claim that, for any $J \in \mathbb{N}$, $\mathcal{K}_{>J} \Pi_J \equiv 0$. Indeed, any $\phi \in \Pi_J$ is a polynomial of degree at most $J$. As a result, $\phi^{(r)}$ is also a polynomial of degree at most $J$ for any $r$, and since $P_{j,d}$ is orthogonal to any polynomial of degree $j' < j$, we have $\alpha_{j,r,d} = 0$ for any $r$ and $j>J$, and therefore $\beta_{j,d}=0$ for any $j >J$. 

% Since $\phi', \phi'',\phi''' \in L^2(\mathbb{R}, \eta)$, we have that ({\color{red} verify this result}) $\sum_j j^3 \langle \phi, q_j \rangle^2 := M(\|\phi'\|, \|\phi''\|, \|\phi'''\|)< \infty$, and thus that 
% $$J^3 \| \Pi_{>J} \phi\|^2 = J^3 \sum_{j > J} \langle \phi, q_j \rangle^2 \leq \sum_{j > J} j^3 \langle \phi, q_j \rangle^2 \to ~0 ~~(J \to \infty)~.$$
% %$\| \Pi_{>J} \phi\|^2 = o(J^{-3})$ as $J \to \infty$. 
% As a result, we deduce that
% $$B_J:= \sum_{j > J} \beta_{j,d} = C_d \|  \Pi_{>J} \phi\|^2 = o(J^{-3})~,$$
% as well as 
% $$\tilde{B}_J:= \sum_{j \geq J} B_j = o(J^{-2})~.$$
% and therefore, by integration-by-parts, 
% $$\sum_j j^2 \beta_j \leq C \sum_j \tilde{B}_j \leq \tilde{C} M~.$$

% %$\| \Pi_I f\|^2 = \|f\|^2 - \| \Pi_{>I} f\|^2 $
% %$$(\mathcal{K}_{\leq J} + \mathcal{K}_{>J}) ( \Pi_{J} + \Pi_{>J}) = \mathcal{K}_{\leq J} \Pi_{J}  $$




% % $\phi = \sum_ine{\mathcal{K}}_{>J} \theta_i q_i$. Let 
% % $\bar{\theta}_J = \sum_{j \geq J} \theta_i^2$, and
% %  $\bar{\beta}_J = \sum_{j \geq J} \beta_j$. We claim that for any $J\geq 0$, 
% %  \begin{equation}
% %      \bar{\beta}_J = \frac{\Omega_{d-2}}{\Omega_{d-1}} \bar{\theta}_J~.
% %  \end{equation}

% % We have 
% % $\sum_j \mathcal{K}_j = C_d I$

% % We also have that if $f$ is such that $\bar{\mathcal{K}}_J f = 0$, then $\Pi_J f = 0$. %$\Pi_J \bar{\mathcal{K}}_J = 0$

% % $$ {\mathcal{K}}_{\leq J} + {\mathcal{K}}_{>J} = C_d ( \Pi_{\leq J} + \Pi_{>J})$$
% % $$ \Pi_{\leq J} {\mathcal{K}}_{\leq J} + \Pi_{\leq J} {\mathcal{K}}_{>J} = C_d   \Pi_{\leq J} $$
% % Now, if $\phi', \phi'' \in L^2(\mathbb{R}, \eta)$, then 
% % $\sum_j (j+j^2) \theta_j^2 < \infty$
% % so in particular $\bar{\beta}_J = \bar{\theta}_J = o(J^{-2})$

% %$$\int_R^\infty x^2 f(x) dx = [x^2 F(x)$$

%\begin{proof}[Proof of Theorem \ref{coro:symmcase}]
Let $s = \inf\{ j ; \beta_{j,d} \neq 0\}$.  
We need to verify that 
 there exists a constant $K>0$ such that  
 \begin{equation}
 \label{eq:flower}
 \sum_{j > s} \beta_{j,d} j (j+d-2)  \upsilon_{j-1,d+2} \leq K d^{(3-s)/2}~.    
 \end{equation}

We will control the LHS by splitting it into appropriate regions, determined by $J_i$, $i\in \{1,2,3\}$.  
Let $\alpha = \frac{4}{1+s}$ and $J_1 = \frac{\lambda^\alpha}{2}$. 
From Lemma \ref{prop:upsicontrol}, part (i) we have that 
$\upsilon_{j,\lambda} \leq C \left( \frac{j(j+2\lambda)}{(j+\lambda)^2}\right)^{j/2}$,  %for $j \geq \tilde{C}$, 
and in particular $\upsilon_{j,\lambda} \leq C \lambda^{(\alpha-1)j/2}$ for $j \leq J_1$.
As a result, using Lemma \ref{lemma:betas_derivative}, 
\begin{align}
  \sum_{j = s+1}^{J_1} \beta_j j (j+\lambda)  \upsilon_{j-1,\lambda+1} & \leq \lambda^{(\alpha-1)(s+1)/2} \sum_{j=s+1}^{J_1} \beta_j j (j+\lambda) \nonumber\\
  &\leq  \lambda^{(\alpha-1)(s+1)/2} (C_1 \lambda^{-1} + \lambda \sum_{j=s+1} ^{J_1} \beta_j j )\nonumber\\
  &\leq  \lambda^{(\alpha-1)(s+1)/2} (C_1 \lambda^{-1} + \lambda \sum_{j=s+1} ^{J_1} \beta_j j^2 )\nonumber\\
  & \leq \lambda^{(\alpha-1)(s+1)/2} C_2 \nonumber\\
  &\leq C_2 \lambda^{(3-s)/2}~.
\end{align}

Let $J_2 = \lambda$. 
We have 
\begin{align}
    \sum_{j=J_1+1}^{J_2} \beta_j j (j+\lambda) \upsilon_{j-1,\lambda+1} &\leq \lambda^{\frac{(\alpha-1)\lambda^\alpha}{2}} C_3  \nonumber \\
    & \leq C_3 \lambda^{(3-s)/2}~.
\end{align}

Let $J_3 = \lambda^{3/2}$. 
We have 
\begin{align}
    \sum_{j=J_2+1}^{J_3} \beta_j j (j+\lambda) \upsilon_{j-1,\lambda+1} &\leq e^{-\frac12 \sqrt{\lambda}} C_4  \nonumber \\
    & \leq C_4 \lambda^{(3-s)/2}~.
\end{align}
Finally, the remainder satisfies 
\begin{align}
    \sum_{j>J_3} \beta_j j (j+\lambda) \upsilon_{j-1,\lambda+1} &\leq C_5 (e/2)^{-{\lambda}} \nonumber \\
    & \leq C_5 \lambda^{(3-s)/2}~,
\end{align}
which proves (\ref{eq:flower}).


% {\small
% \begin{align}
%   \sum_{j > s} \beta_{j,d} j (j+d-2)  \upsilon_{j-1,d+2} &= \sum_{j=s+1}^{\kappa \lambda}  \beta_{j,d} j (j+d-2)  \upsilon_{j-1,\lambda+1} + \sum_{j = \kappa \lambda +1}^{\delta \lambda^{3/2} } \beta_{j,d} j (j+d-2)  \upsilon_{j-1,d+2} \nonumber \\
%   & ~ + \sum_{j >\delta \lambda^{3/2} }  \beta_{j,d} j (j+d-2)  \upsilon_{j-1,\lambda+1} \\
%   & \leq C \lambda^{-s/2} \sum_{j=s+1}^{\kappa \lambda}  \beta_{j,d} j (j+d-2) j^{j/2} \lambda^{(s-j)/2} 
% \end{align}
% }
    
\end{proof}

\begin{proof}[Proof of Lemma \ref{prop:upsicontrol}]
We prove this result by analysing different regimes for $j$ and $\lambda$. Concretely, we claim the following:
\begin{claim}
\label{claim:upsi_mainclaim}
    We have the following regimes:
    \begin{enumerate}
        \item For $j = \Omega(1)$, we have 
        \begin{equation}
        \label{eq:upsi_mainclaim1}
         \upsilon_{j,\lambda} \lesssim \left[1 - \left(\frac{\lambda}{j+\lambda} \right)^2 \right]^{j/2}~.
       %  \left(\frac{2j}{\lambda} \right)^{j/2}~.   
        \end{equation}
        \item For $j = \Theta(\lambda^\alpha)$, with $0< \alpha < 1$, we have 
        \begin{equation}
            \label{eq:upsi_mainclaim2}
             \upsilon_{j,\lambda} \lesssim \lambda^{\frac{(\alpha-1)\lambda^\alpha}{2}}~.
        \end{equation}
        \item For $j = \Theta(\lambda^\alpha)$, with $1 \leq \alpha < 2$, we have 
        \begin{equation}
            \label{eq:upsi_mainclaim2bis}
             \upsilon_{j,\lambda} \lesssim e^{-\frac12 \lambda^{2-\alpha}}~.
        \end{equation}
        \item For $j = \Omega(\lambda^\alpha)$, with $\alpha > 3/2$, we have 
        \begin{equation}
            \label{eq:upsi_mainclaim3}
            \upsilon_{j,\lambda} \lesssim e^{-\lambda}~.
        \end{equation}
    \end{enumerate}
\end{claim}
To prove the first three regimes of Claim \ref{claim:upsi_mainclaim}, we control $\upsilon_{j,\lambda}$ based on the distribution of the roots of $P_{j,\lambda}$. 
We recall that $(z_{k,j,\lambda})_{k \leq j}$ denotes the roots of $P_{j,\lambda}$ in increasing order, and $z_{j,\lambda} = z_{j,j,\lambda}$ its largest root. 
\begin{lemma}[Representation of $P_{j,\lambda}$ in terms of its roots, {\cite[Lemma 2.1]{de2008local}}]
\label{lem:basiccontrolgegen}
We have 
% \begin{equation}
%     P_{j,d}(t) = \prod_{k=j/2}^j \frac{t^2 - z_{k,j,d}^2}{1 - z_{k,j,d}^2}~\text{ for } j \text{ even }~,
% \end{equation}
\begin{equation}
    P_{j,\lambda}(t) = \begin{cases}
         \prod_{k=j/2}^j \frac{t^2 - z_{k,j,\lambda}^2}{1 - z_{k,j,\lambda}^2} & \text{ if } j \text{ even}, \\
         t \prod_{k=(j+1)/2}^j \frac{t^2 - z_{k,j,\lambda}^2}{1 - z_{k,j,\lambda}^2} & \text{ if } j \text{ odd }~.
    \end{cases}
\end{equation}
\end{lemma}
From this representation, we deduce that $\upsilon_{j,\lambda}$ can be calculated explicitly. Indeed, as the local maxima of $|P_{j,\lambda}(t)|$ are increasing \cite{szego1939orthogonal}, {\cite[\href{https://dlmf.nist.gov/18.14}{Eq (18.14.15)}]{NIST:DLMF}}, we have the following equation:
    \begin{equation}
    \label{eq:upsi}
        \upsilon_{j,\lambda} = - P_{j,\lambda}(z_{j-1,\lambda+1}) = - \begin{cases}
         \prod_{k=j/2}^j \frac{z_{j-1,\lambda+1}^2 - z_{k,j,\lambda}^2}{1 - z_{k,j,\lambda}^2} & \text{ if } j \text{ even}, \\
         z_{j-1,\lambda+1} \prod_{k=(j+1)/2}^j \frac{z_{j-1,\lambda+1}^2 - z_{k,j,\lambda}^2}{1 - z_{k,j,\lambda}^2} & \text{ if } j \text{ odd }~.
         \end{cases}
    \end{equation}
%
Let us focus first on the case $j$ even, for simplicity. 
We can rewrite (\ref{eq:upsi}) more conveniently as
$$\upsilon_{j,\lambda} = \frac{z_{j,\lambda}^2 - z_{j-1,\lambda+1}^2}{1-z_{j,\lambda}^2} \prod_{k=j/2}^{j-1} \frac{z_{j-1,\lambda+1}^2 - z_{k,j,\lambda}^2}{1 - z_{k,j,\lambda}^2}~.$$

% Fix a threshold  $\delta\in (0,1)$, and define
% $$A_\delta := \{(j, d) \in \mathbb{N} \times \mathbb{N} ; z_{j,d} \geq \delta\}~, $$
% ie the pairs $(j,d)$ such that the largest root $z_{j,d}$ is larger than $\delta$.

% %We first focus on the first one, roughly corresponding to $j \gg d$. 
% Suppose first $(j,d) \in A_\delta$, and 

For $\delta\in (0,z_{j-1,\lambda+1})$ let 
$$m(\delta, j, \lambda) := | \{ k \in \{j/2,j\} ; z_{k,j,\lambda} \geq \delta \} |$$ 
denote the number of zeros of $P_{j,\lambda}$ in the interval $(\delta, 1)$. 
%We know by assumption that $m(\delta, j, d) \geq 1$ since $(j, d) \in A_\delta$. 
Since the function $t \mapsto \frac{a^2 - t^2}{1-t^2}$ is decreasing in $t \in (0,a)$, 
we have
\begin{fact}
\label{fact:upsi_basicbound}
We have the upper bound:
    \begin{equation}
        \upsilon_{j,\lambda} \leq  \frac{z_{j,\lambda}^2 - z_{j-1,\lambda+1}^2}{1-z_{j,\lambda}^2} \inf_{\delta} \left(\frac{z_{j-1,\lambda+1}^2 - \delta^2}{1-\delta^2} \right)^{m(\delta, j, \lambda)}~.
    \end{equation}
\end{fact}
% By combining this with the bound on the largest root (Fact \ref{fact:largestroot}), we obtain 
% \begin{equation}
%     \upsilon_{j,d} \leq \frac{z_{j,d}^2 - z_{j-1,d+2}^2}{1-z_{j,d}^2} \inf_{\delta} \left(\frac{\frac{(j-2)(j+d-3)}{(j+d/2-3)(j+d/2-2)} - \delta^2}{1-\delta^2} \right)^{m(\delta, j, d)}~.
% \end{equation}
%Let us assume first that $j = O(d)$. 
Letting $\delta = z_{j/2,j,\lambda}$ the smallest positive root of $P_{j,\lambda}$ we have
\begin{equation}
\label{eq:bhi}
    \upsilon_{j,\lambda} \leq \frac{z_{j,\lambda}^2 - z_{j-1,\lambda+1}^2}{1-z_{j,\lambda}^2} \left(\frac{z_{j-1,\lambda+1}^2 - z_{j/2,j,\lambda}^2}{1-z_{j/2,j,\lambda}^2} \right)^{j/2}~.
\end{equation}
We can thus obtain an explicit control on $\upsilon_{j,\lambda}$ from bounds on the zeros of the Gegenbauer polynomials. We complement the upper bound on the largest root (Fact \ref{fact:largestroot}) with lower bounds for all positive roots, as well as a sharp lower bound for its largest root \cite{DIMITROV20101793}:
\begin{theorem}[Upper and Lower bounds for Gegenbauer roots, {\cite[Theorem 2]{DIMITROV20101793}}]
\label{thm:gegenroots_2}
    Let %$\lambda = d/2-1$, 
    $$b_{j,\lambda} = j^3 + 2(\lambda - 1)j^2 - (3\lambda -5)j + 4(\lambda - 1)~,$$ $$a_{j,\lambda} = 2(j + \lambda-1)(j^2 + j(\lambda-1) + 4(\lambda+1))~\text{and}$$ 
    $$c_{j,\lambda} = j^2(j+2\lambda)^2 + (2\lambda + 1)(j^2 + 2(\lambda+3)j + 8(\lambda - 1))~.$$ Then for every $k,j,\lambda$ we have 
    \begin{equation}
        \frac{b_{j,\lambda} - (j-2)\sqrt{c_{j,\lambda}}}{a_{j,\lambda}} \leq z_{k,j,\lambda}^2 \leq \frac{b_{j,\lambda} + (j-2)\sqrt{c_{j,\lambda}}}{a_{j,\lambda}}~.
    \end{equation}
\end{theorem}
% \begin{theorem}[Sharp lower bound for largest root, {\cite[Theorem 3]{DIMITROV20101793}}]
% \label{thm:gegenroots_3}
% Let %$\lambda = d/2-1$, 
% $$c_{j,\lambda} = 2 (j+\lambda -1)(2j + 2\lambda - 1)\left[4j^4-8(2-\lambda)j^3 + (47-8\lambda +4\lambda^2)j^2 - (14-48\lambda - 8\lambda^2)j + 24(\lambda+1)(2\lambda+1)\right]~,$$
% $$d_{j,\lambda} = (2\lambda+3)(2j + 2\lambda -1)\left[8(5+\lambda)j^3 - (95-30\lambda-8\lambda^2)j^2 + (130+124\lambda+16\lambda^2)j - 24(5+8\lambda - 4\lambda^2)\right]~.$$
% Then 
% \begin{equation}
%     1 - \frac{d_{j,\lambda}}{2c_{j,\lambda}} \leq z_{j,\lambda}^2~.
% \end{equation}
% \end{theorem}
\begin{theorem}[Lower bound for largest root, {\cite[Section 2.3]{DRIVER20121200}}]
\label{thm:gegenroots_3}
\begin{equation}
    z_{j,\lambda}^2 > 1 - \frac{(2\lambda+1)(2\lambda+3)}{(j-1)(j+2\lambda+1)+(2\lambda+1)(2\lambda+3)}:= 1 - \frac{g_{j,\lambda}}{h_{j,\lambda}}~.
\end{equation}    
\end{theorem}
Rewriting Fact \ref{fact:largestroot} as 
$z_{j,\lambda}^2 \leq \frac{e_{j,\lambda}}{f_{j,\lambda}}~,$
with 
$$e_{j,\lambda} = (j-1)(j+2\lambda-2)~,~f_{j,\lambda} = (j+\lambda-2)(j+\lambda-1)~,$$
and using again the monotonocity of $t \mapsto \frac{t-p}{1-t}$ 
we can bound the first term in the RHS of (\ref{eq:bhi}) as  
\begin{equation}
\label{eq:bhi2}
\frac{z_{j,\lambda}^2 - z_{j-1,\lambda+1}^2}{1-z_{j,\lambda}^2} \leq \frac{e_{j,\lambda}/f_{j,\lambda} + g_{j-1,\lambda+1}/h_{j-1,\lambda+1} -1}{1-e_{j,\lambda}/f_{j,\lambda}}~.    
\end{equation}
For $j, \lambda = \omega(1)$, 
we have 
\begin{align*}
a_{j,\lambda} &\simeq 2j (j+\lambda)^2,& ~b_{j,\lambda} &\simeq j^2(j+2\lambda)~,~\sqrt{c_{j,\lambda}}\simeq j(j+2\lambda)~, \\
e_{j,\lambda} &\simeq j(j+2\lambda),&~f_{j,\lambda}&\simeq (j+\lambda)^2~,\\
g_{j,\lambda} &\simeq 4\lambda^2 ,&~ h_{j,\lambda} &\simeq j(j+2\lambda) + 4\lambda^2~,    
\end{align*}
and thus
\begin{equation}
\label{eq:bhi2}
\frac{z_{j,\lambda}^2 - z_{j-1,\lambda+1}^2}{1-z_{j,\lambda}^2} \lesssim \frac{3 j (j+2\lambda)}{j (j+2\lambda) + 4\lambda^2} \leq 3~.     
\end{equation}
Therefore, 
\begin{align}
\label{eq:upsi_smalljregime}
    \upsilon_{j,\lambda} & \leq 3 \left(\frac{\frac{e_{j-1,\lambda+1}}{f_{j-1,\lambda+1}} - \frac{b_{j,\lambda} - (j-2)\sqrt{c_{j,\lambda}}}{a_{j,\lambda}}}{1-\frac{b_{j,\lambda} - (j-2)\sqrt{c_{j,\lambda}}}{a_{j,\lambda}}} \right)^{j/2}~ \nonumber \\
    %&= \left( 1 + \frac{d_{j-1,\lambda+1} f_{j,\lambda}}{2  c_{j-%1,\lambda+1}  (e_{j,\lambda}- f_{j,\lambda})}\right) 
    %\left(\frac{a_{j,\lambda} e_{j-1,\lambda+1} - f_{j-1,\lambda+1}%(b_{j,\lambda} - (j-2)\sqrt{c_{j,\lambda}})}{f_{j-1,\lambda+1}(a_{j,\lambda} - b_{j,\lambda} + (j-2)\sqrt{c_{j,\lambda}})}\right)^{j/2} \nonumber \\
    & \leq 3\left(\frac{a_{j,\lambda} e_{j-1,\lambda+1} - f_{j-1,\lambda+1}(b_{j,\lambda} - (j-2)\sqrt{c_{j,\lambda}})}{f_{j-1,\lambda+1}(a_{j,\lambda} - b_{j,\lambda} + (j-2)\sqrt{c_{j,\lambda}})}\right)^{j/2}~ \nonumber \\
    & = 3\left(\frac{2j(j+\lambda)^2 j(j+2\lambda) - (j+\lambda)^2 (j^2(j+2\lambda) - j^2(j+2\lambda)) }{(j+\lambda)^2(2j(j+\lambda)^2 - j^2(j+2\lambda) + j^2(j+2\lambda))}  \cdot (1 + o_{j,\lambda}(1)) \right)^{j/2} \nonumber \\
    & \lesssim \left(\frac{j(j+2\lambda)}{(j+\lambda)^2} \right)^{j/2} \nonumber \\
    &= \left[1 - \left(\frac{\lambda}{j+\lambda} \right)^2 \right]^{j/2}~.
    % & \leq \frac{z_{j,d}^2 - 1 + d_{j-1,\lambda+1}/(2 c_{j-1,\lambda+1}) }{1-z_{j,d}^2} \left(\frac{z_{j-1,d+2}^2 - (b_{j,\lambda} - (j-2)\sqrt{\delta_{j,\lambda}})/a_{j,\lambda}}{1-(b_{j,\lambda} - (j-2)\sqrt{\delta_{j,\lambda}})/a_{j,\lambda}} \right)^{j/2}
\end{align}
%\end{proof}
As a direct consequence of (\ref{eq:upsi_smalljregime}), we immediately obtain Eqs (\ref{eq:upsi_mainclaim1}), (\ref{eq:upsi_mainclaim2}) and (\ref{eq:upsi_mainclaim2bis}). The case where $j$ is odd is treated analogously. 

Let us now study the regime $j = \omega(\lambda^{3/2})$. 
%We will use the uniform asymptotic expansions of Gegenbauer polynomials in terms of Bessel functions.
Given $z \in \mathbb{C}$ with $|z|<1$, Gegenbauer polynomials admit the following generating function {\cite[Section 3.32]{watson1922treatise}}:
\begin{equation}
\frac{1}{(1 - 2z \cos \theta + z^2)^\lambda } = \sum_{j \geq 0} \bar{P}_{j, \lambda}(\cos \theta) z^j ~.
\end{equation}
From this generating function, the Cauchy integral formula leads to 
 the following integral representation: 
\begin{fact}[{\cite[Eq (1.2)]{ursell2007integrals}}]
For any $0 < \rho < 1$, we have
\begin{equation}
\bar{P}_{j, \lambda}(\cos \theta) = \frac{1}{2\pi i} \oint_{|z|=\rho}  \frac{dz}{(1-2z \cos \theta + z^2)^{\lambda} z^{j+1}}~.    
\end{equation}
\end{fact}
Assume $j = \Theta(\lambda^\alpha)$, with $\alpha > 3/2$. 
We are interested in the above representation for  $\bar{\theta} = \arccos(z_{j-1,\lambda+1})$. 
From Theorem \ref{thm:gegenroots_3}, we have 
$z_{j-1,\lambda+1}^2 \geq 1 - d_{j,\lambda}/(2c_{j,\lambda})$, and thus 
$$\bar{\theta}^2 \lesssim \frac{d_{j,\lambda}}{2c_{j,\lambda}} \simeq \frac{32\lambda^2 j^4 }{16 j^6} = \frac{2\lambda^2}{j^2}~,$$
so $\bar{\theta} = O(\lambda/j)$. 
Combining this upper bound with the lower bound obtained from Fact \ref{fact:largestroot} we have $\bar{\theta} = \Theta(\lambda/j)$. 

Using $1-\cos \theta \simeq  \theta^2/2 \simeq  \lambda^2/j^2$ 
and 
\begin{align}
|1 - 2 z \cos \theta + z^2| & = \left|(1-z)^2 + 2z(1-\cos \theta) \right| \nonumber \\
&\geq | 1- z|^2 - 2|z|(1-\cos \theta) \nonumber \\
& \geq 1 - \rho \left(2 + \Theta\left(\frac{\lambda^2}{j^2}\right)\right) + \rho^2~, 
\end{align}
we have 
\begin{align}
    | \bar{P}_{j, \lambda}(\cos \theta) | \leq \inf_{0<\rho < 1}|\rho|^{-(j+1)} \left(1 - \rho(2 + c\lambda^2/j^2) + \rho^2 \right)^{-\lambda}:= g(\rho)~.
\end{align}
Optimizing the RHS over $\rho$ we obtain 
$\rho^* = \frac{j - (\sqrt{2}-1)\lambda}{j + 2\lambda}$; substituting, we obtain 
\begin{align}
    g(\rho^*) \simeq e^{-(1+\sqrt{2}) \lambda} \left(\frac{j+2\lambda}{\lambda(1+\sqrt{2})} \right)^{2\lambda}~.
\end{align}
As a result, it follows that 
\begin{align}
    P_{j, \lambda}(\cos \theta) &= \bar{P}_{j, \lambda}(\cos \theta) \frac{j! (2\lambda-1)!}{(2\lambda+j-1)!} 
\end{align}
satisfies, for $\theta = \Theta(\lambda/j)$ and $j = \omega(\lambda^{3/2})$, 
\begin{align}
    \log |P_{j, \lambda}(\cos \theta) | \simeq & j \log j - j + 2\lambda \log(2\lambda) - 2\lambda - (j +2\lambda) \log(2\lambda + j) + 2\lambda+j \nonumber \\
    &~ -(1+\sqrt{2}) \lambda + 2\lambda \log (j + 2\lambda) - 2\lambda \log(\lambda (1+\sqrt{2})) \nonumber \\
    \simeq & -(1+\sqrt{2}) \lambda~,
\end{align}
where we have used Stirling's approximation. 
This proves Eq (\ref{eq:upsi_mainclaim3}) and completes the proof of  Lemma \ref{prop:upsicontrol}. %\ref{prop:upsicontrol}
% we obtain
%  \begin{align*}
%     \upsilon_{j,\lambda} &= |P_{j,2\lambda+2}( \cos( \theta_{j, \lambda}) )| \\
%     & \leq \left(\frac{\sin \theta_{j,d}}{\theta_{j,d}} \right)^{-\lambda-\frac12} 2^\lambda \lambda! J_\lambda\left( \theta_{j,d}(j+\lambda+1/2) \right) (\theta_{j,d}(j+\lambda+1/2))^{-\lambda} \\ 
%     & \lesssim \left[\frac{(j+\lambda-2)(j+\lambda-1)}{(j-1)(j+2\lambda-2)} \right]^{\lambda + 1/2} 2^\lambda \lambda! J_\lambda( \sqrt{\lambda (\lambda-1)})  \lambda^{-\lambda} \\
%     &\lesssim \left[\frac{(j+\lambda-2)(j+\lambda-1)}{(j-1)(j+2\lambda-2)} \right]^{\lambda + 1/2} \lambda^{-1/3-\lambda} 2^\lambda \lambda! \\
%     & \lesssim (e/2)^{-\lambda} \lambda^{1/6} \left[1 + \frac{\lambda(\lambda-1)}{(j-1)(j+2\lambda-2)} \right]^{\lambda + 1/2}  
% \end{align*}
\end{proof}
\begin{proof}[Proof of Lemma \ref{lemma:betas_derivative}]
We have, using Fact \ref{fact:deriv}, that
\begin{align}
\label{eq:bound0}
    \mathbb{E}_\rho [ \mathbb{E}_{u_d} {(\phi^{(r)}}')^2] 
    &= \frac{\Omega_{d-1}}{(d-1)^2\Omega_{d-2}} \sum_j \mathbb{E}_\rho \left[  \bar{\alpha}_{j,d,r}^2 \left(j (j+d-2)\right)^2  \right] \nonumber\\
    &\geq \frac{\Omega_{d-1}}{\Omega_{d-2}} \sum_j j^2 \mathbb{E}_\rho \left[  \bar{\alpha}_{j,d,r}^2 \right]~.
\end{align}
And we can upper bound via
\begin{align}
    \mathbb{E}_\rho [ \mathbb{E}_{u_d} {(\phi^{(r)}}')^2] & = \mathbb{E}_\rho [ r^2 \mathbb{E}_{u_d} ({(\phi')^{(r)}})^2] \nonumber \\
    &= \mathbb{E}_\rho \mathbb{E}_{x_1|\|x\|=r} [ r^2 (\phi(x_1)')^2 ] \nonumber \\ 
    & \leq \sqrt{\mathbb{E}_\rho [r^4] \mathbb{E}_\eta (\phi')^4} ~,
\end{align}
where this last line is finite by our assumptions on $\phi$ and $\rho$,

so from (\ref{eq:bound0}) we conclude that 
\begin{equation}
    \sum_j j^2 \beta_{j,d} \leq \frac{\Omega_{d-2}}{\Omega_{d-1}} \sqrt{\mathbb{E}_\rho [r^4] \mathbb{E}_\eta (\phi')^4}~.
\end{equation}
\end{proof}

\section{The \texorpdfstring{$\LPG$}{lol} property in the non-symmetric case: proofs of Section \ref{subsec:nonsym}}
\label{sec:nonsymapp}

\subsection{Proof of Proposition \ref{prop:gradwassers}}
\asslipreg*
\asssubgaussian*

\gradwassers*

\begin{proof}
    

Recall the notation $\phi_\theta(x) = \phi(\langle x, \theta\rangle)$. Let $v = \theta^* - m \theta$. 
From the definition, we have that 
\begin{align}
    \langle \nabla_\theta^{\mathbb{S}} L(\theta), \theta^* \rangle &= 2 \mathbb{E}_\nu\left[ \phi'_\theta(\phi_\theta - \phi_{\theta^*}) \left(x \cdot v\right)\right] \nonumber \\
    &:= \mathbb{E}_\nu [g_{\theta, \theta^*}]~.
\end{align}
Since $\mathbb{E}_\gamma [g_{\theta, \theta^*}]$ is precisely $\bar{\ell}'(m)(1-m^2)$, we need 
to establish that %for any $\theta \in \mathbb{S}^{d-1}$, we have 
\begin{equation}
    \sup_\theta \left|\mathbb{E}_\nu g_{\theta, \theta^*} - \mathbb{E}_\gamma g_{\theta, \theta*} \right| \leq C \sqrt{1-m^2} \widetilde{W}_{1,2}(\nu, \gamma) \left(\log  \widetilde{W}_{1,2}(\nu, \gamma) \right)^2~.
\end{equation}

Fix $\theta$ and let $P_{\theta, \theta^*}$ be the orthogonal projection onto the subspace spanned by $\theta, \theta^*$.  For $R>0$ we consider $A_R = \{ x \in \mathbb{R}^d; \| P_{\theta, \theta^*} x \| \leq R \}$.  
\begin{align}
    \left|\mathbb{E}_\nu g_{\theta, \theta^*} - \mathbb{E}_\gamma g_{\theta, \theta*} \right| &= \left| \int g_{\theta, \theta^*}(x) (\nu(dx) - \gamma(dx) ) \right| \nonumber \\
    &\leq \underbrace{\left| \int_{x \in A_R} g_{\theta, \theta^*}(x) (\nu(dx) - \gamma(dx) ) \right|}_{T_a} + \underbrace{\left| \int_{x \notin A_R} g_{\theta, \theta^*}(x) (\nu(dx) - \gamma(dx) ) \right|}_{T_b}~.
\end{align}

Let us first bound $T_a$. Denote by $v = \theta^* - m \theta$, with $\|v\|^2 = 1-m^2$ Since $\phi$ and $\phi'$ are Lipschitz and $|\phi''| \leq O((1+t)^{-1})$ by Assumption \ref{ass:lipreg}, we have that 
\begin{align}
    \nabla_x g_{\theta, \theta^*}(x) &= \phi''_{\theta} (\phi_\theta - \phi_{\theta^*}) x^\top v \theta + \phi'_\theta ( \phi'_\theta \theta - \phi'_{\theta^*} \theta^*) x^\top v + \phi'_\theta (\phi_\theta - \phi_{\theta^*}) v 
\end{align}
satisfies 
\begin{align}
    \| \nabla_x g_{\theta, \theta^*}(x) \| &\leq  2\|v\| C \mathrm{Lip}(\phi) R +  4 \|v\|\mathrm{Lip}(\phi)^2 R \nonumber \\
    &\leq C \|v\| R ~,
\end{align}
and as a result we have that $g_{\theta, \theta^*}$ is $C \|v\| R$-Lipschitz when restricted to $A_R$, and thus
\begin{equation}
    T_a \leq C R \|v\| \widetilde{W}_{1,2}(\nu, \mu)~.
\end{equation}
Let us now control the tail $T_b$. Since $x^\top v$ is $\sqrt{2} M \|v\|$-subgaussian and $\phi$ is Lipschitz, we have that $z = |g_{\theta, \theta^*}(x)|$ is $\tilde{M} \|v\|$-subexponential where $\tilde{M}$ only depends on $M$ and $L$. 
It follows that 
\begin{align}
    T_b &\leq R (\mathbb{P}_\nu(z \geq R) + \mathbb{P}_\gamma( z \geq R) ) \nonumber \\
    &\leq R \exp\left( - \frac{\beta}{\|v\|} R \right)~,
\end{align}
where $\beta$ is a constant that depends only on $\tilde{M}$. 
As a result, we have 
\begin{align}
    \left|\mathbb{E}_\nu g_{\theta, \theta^*} - \mathbb{E}_\gamma g_{\theta, \theta*} \right| \leq \inf_{R>0} \left(C R \|v\| \widetilde{W}_{1,2}(\nu, \mu) + R \exp\left( -\frac{\beta}{\|v\|} R \right) \right)~.
\end{align}
Setting 
$$R =  {-\|v\| \beta^{-1}} \log((C \|v\| \widetilde{W}_{1,2}(\nu, \gamma))) $$
we obtain
%$R = \frac{\|v\|}{\beta} \mathcal{W}_0\left(\frac{\beta}{\|v\|^2 \widetilde{W}_{1,2}(\nu, \gamma)} \right)$, where $\mathcal{W}_0$ is the Lambert function, we obtain 
%Setting $R = \frac{\|v\|}{\beta} \mathcal{W}_0\left(\frac{\beta}{\|v\|^2 \widetilde{W}_{1,2}(\nu, \gamma)} \right)$, where $\mathcal{W}_0$ is the Lambert function, we obtain 
\begin{align}
 \label{eq:blink}
 \left|\mathbb{E}_\nu g_{\theta, \theta^*} - \mathbb{E}_\gamma g_{\theta, \theta*} \right| &\leq  2 C (1-m^2)  \beta^{-1} \left|\log(C \|v\| \widetilde{W}_{1,2}(\nu, \gamma))\right|  \widetilde{W}_{1,2}(\nu, \gamma) \nonumber \\
& \leq (1-m^2) O\left( \widetilde{W}_{1,2}(\nu, \gamma) \log ( \widetilde{W}_{1,2}(\nu, \gamma)^{-1} ) \right)~,
     % \left|\mathbb{E}_\nu g_{\theta, \theta^*} - \mathbb{E}_\gamma g_{\theta, \theta*} \right| &\leq \beta^{-2} \|v\|^3 C \widetilde{W}_{1,2}(\nu, \gamma) \log\left(\frac{\beta}{C\|v\|^2 \widetilde{W}_{1,2}(\nu, \gamma)} \right)^2 \nonumber \\
     % &= \beta^{-2} (1-m^2)^{3/2} C \widetilde{W}_{1,2}(\nu, \gamma) \log\left(\frac{\beta}{C(1-m^2) \widetilde{W}_{1,2}(\nu, \gamma)} \right)^2~,
\end{align}
% Since this is valid for any $\theta$, we conclude that 
% \begin{equation}
% \label{eq:blink}
%     \sup_{\theta \in \S} | \langle \nabla^{\mathbb{S}}_\theta L(\theta), \theta^* \rangle - \bar{\ell}'(m) (1 - m^2) | \leq \tilde{C} \widetilde{W}_{1,2}(\nu, \gamma) \log(\widetilde{W}_{1,2}(\nu, \gamma)^{-1})^2~,
% \end{equation}
as claimed.

\end{proof}

% \begin{align}
%     \langle \nabla_\theta^{\mathbb{S}} L(\theta), \theta^* \rangle &= 2 \mathbb{E}_\nu\left[ \phi'_\theta(\phi_\theta - \phi_{\theta^*}) \left(x^\top \theta^* - m x^\top \theta \right)\right] \nonumber \\
%     &:= \mathbb{E}_\nu [g_{\theta, \theta^*}]~.
% \end{align}
% Since $\mathbb{E}_\gamma [g_{\theta, \theta^*}]$ is precisely $\bar{\ell}'(m)(1-m^2)$, we need 
% to establish that %for any $\theta \in \mathbb{S}^{d-1}$, we have 
% \begin{equation}
%     \sup_\theta \left|\mathbb{E}_\nu g_{\theta, \theta^*} - \mathbb{E}_\gamma g_{\theta, \theta*} \right| \leq C \sqrt{1-m^2} \widetilde{W}_{1,2}(\nu, \gamma) \left(\log  \widetilde{W}_{1,2}(\nu, \gamma) \right)^2~.
% \end{equation}

% Fix $\theta$ and let $P_{\theta, \theta^*}$ be the orthogonal projection onto the subspace spanned by $\theta, \theta^*$.  For $R>0$ we consider $A_R = \{ x \in \mathbb{R}^d; \| P_{\theta, \theta^*} x \| \leq R \}$.  
% \begin{align}
%     \left|\mathbb{E}_\nu g_{\theta, \theta^*} - \mathbb{E}_\gamma g_{\theta, \theta*} \right| &= \left| \int g_{\theta, \theta^*}(x) (\nu(dx) - \gamma(dx) ) \right| \nonumber \\
%     &\leq \underbrace{\left| \int_{x \in A_R} g_{\theta, \theta^*}(x) (\nu(dx) - \gamma(dx) ) \right|}_{T_a} + \underbrace{\left| \int_{x \notin A_R} g_{\theta, \theta^*}(x) (\nu(dx) - \gamma(dx) ) \right|}_{T_b}~.
% \end{align}

% Let us first bound $T_a$. Denote by $v = \theta^* - m \theta$, with $\|v\|^2 = 1-m^2$ Since $\phi$ and $\phi'$ are Lipschitz by Assumption \ref{ass:lipreg}, we have that 
% \begin{align}
%     \nabla_x g_{\theta, \theta^*}(x) &= \phi''_{\theta} (\phi_\theta - \phi_{\theta^*}) x^\top v \theta + \phi'_\theta ( \phi'_\theta \theta - \phi'_{\theta^*} \theta^*) x^\top v + \phi'_\theta (\phi_\theta - \phi_{\theta^*}) v 
% \end{align}
% satisfies 
% \begin{align}
%     \| \nabla_x g_{\theta, \theta^*}(x) \| &\leq  2\|v\| \mathrm{Lip}(\phi') \mathrm{Lip}(\phi) R^2 +  4 \|v\|\mathrm{Lip}(\phi)^2 R \nonumber \\
%     &\leq C \|v\| R^2 ~,
% \end{align}
% and as a result we have that $g_{\theta, \theta^*}$ is $C \|v\| R^2$-Lipschitz when restricted to $A_R$, and thus
% \begin{equation}
%     T_a \leq C R^2 \|v\| \widetilde{W}_{1,2}(\nu, \mu)~.
% \end{equation}
% Let us now control the tail $T_b$. Since $x^\top v$ is $\sqrt{2} M \|v\|$-subgaussian and $\phi$ is Lipschitz, we have that $z = |g_{\theta, \theta^*}(x)|$ is $\tilde{M} \|v\|$-subexponential where $\tilde{M}$ only depends on $M$ and $L$. 
% It follows that 
% \begin{align}
%     T_b &\leq R (\mathbb{P}_\nu(z \geq R) + \mathbb{P}_\gamma( z \geq R) ) \nonumber \\
%     &\leq R \exp\left( - \frac{\beta}{\|v\|} R \right)~,
% \end{align}
% where $\beta$ is a constant that depends only on $\tilde{M}$. 
% As a result, we have 
% \begin{align}
%     \left|\mathbb{E}_\nu g_{\theta, \theta^*} - \mathbb{E}_\gamma g_{\theta, \theta*} \right| \leq \inf_{R>0} \left(C R^2 \|v\| \widetilde{W}_{1,2}(\nu, \mu) + R \exp\left( -\frac{\beta}{\|v\|} R \right) \right)~.
% \end{align}
% Setting $R = \frac{\|v\|}{\beta} \mathcal{W}_0\left(\frac{\beta}{\|v\|^2 \widetilde{W}_{1,2}(\nu, \gamma)} \right)$, where $\mathcal{W}_0$ is the Lambert function, we obtain 
% \begin{align}
%  \label{eq:blink}
%      \left|\mathbb{E}_\nu g_{\theta, \theta^*} - \mathbb{E}_\gamma g_{\theta, \theta*} \right| &\leq \beta^{-2} \|v\|^3 C \widetilde{W}_{1,2}(\nu, \gamma) \log\left(\frac{\beta}{C\|v\|^2 \widetilde{W}_{1,2}(\nu, \gamma)} \right)^2 \nonumber \\
%      &= \beta^{-2} (1-m^2)^{3/2} C \widetilde{W}_{1,2}(\nu, \gamma) \log\left(\frac{\beta}{C(1-m^2) \widetilde{W}_{1,2}(\nu, \gamma)} \right)^2~,
% \end{align}
% % Since this is valid for any $\theta$, we conclude that 
% % \begin{equation}
% % \label{eq:blink}
% %     \sup_{\theta \in \S} | \langle \nabla^{\mathbb{S}}_\theta L(\theta), \theta^* \rangle - \bar{\ell}'(m) (1 - m^2) | \leq \tilde{C} \widetilde{W}_{1,2}(\nu, \gamma) \log(\widetilde{W}_{1,2}(\nu, \gamma)^{-1})^2~,
% % \end{equation}
% as claimed.

% For each $\theta, \theta^*$ we consider the function 
% $$h_{\theta, \theta^*}(x) = $$


\subsection{Proof of Proposition \ref{prop:grad_expo2}}
We leverage Proposition \ref{prop:gradwassers} and the fact that if 
$\phi$ has information exponent $s=2$, then $\bar{\ell}'(m) \simeq m$ for small $m$. 

We need to show that for $b = \Theta(\log d)$ we have 
\begin{equation}
\label{eq:lpgcond0}
\langle \nabla_\theta L(\theta), \theta^*\rangle \geq C \left( m - \frac{b}{\sqrt{d}}\right)~,~\text{for }  \frac{b}{\sqrt{d}} \leq m \leq \frac12~,   
\end{equation}
as well as
\begin{equation}
\label{eq:contractcond0}
    \langle \nabla_\theta L(\theta), \theta^*\rangle \geq C' (1-m^2) 
\end{equation}
for $m\geq \frac12$. 

From (\ref{eq:blink}) and $\widetilde{W}_{1,2}(\nu, \gamma) \leq C /\sqrt{d}$, 
we obtain %for $m \leq 1/2$
\begin{align}
    \langle \nabla_\theta L(\theta), \theta^*\rangle &= \bar{\ell}'(m)(1-m^2) + \langle \nabla_\theta L(\theta), \theta^*\rangle - \bar{\ell}'(m)(1-m^2)   \nonumber \\
    &\geq 2 \alpha_2^2 m (1-m^2) - (1-m^2)\tilde{C} \widetilde{W}_{1,2}(\nu, \gamma) \log(\widetilde{W}_{1,2}(\nu, \gamma)^{-1}) \nonumber \\
    & \geq  \left(\alpha_2^2 m  - \tilde{C} \frac{C}{\sqrt{d}} \log(\sqrt{d}/C)\right)(1-m^2) \nonumber \\
    & \geq  \alpha_2^2 \left( m  - \tilde{C} \frac{C}{\alpha_2^2 \sqrt{d}} \log(\sqrt{d}/C)\right)(1-m^2) \nonumber \\
    & \geq \alpha_2^2 \left( m - \frac{\log d^{C'}}{\sqrt{d}} \right)(1-m^2)~,
\end{align}
which proves (\ref{eq:lpgcond0}) and (\ref{eq:contractcond0}). 


\subsection{Proof of Proposition \ref{prop:stein}}

\assthird*
\propstein*

\begin{proof}
    

 Recall the notation $\phi_\theta(x) = \phi( \langle x, \theta\rangle)$, and,  using $v = \theta^* - m \theta$, 
 %Denote %$P^\theta = \text{span}( \theta, \theta^*)$ the subspace spanned by $\theta$ and $\theta^*$
 \begin{align}
 h_{\theta, \theta^*}(x) &:= \phi_\theta^2 - 2 \phi_\theta \phi_{\theta^*}~,\\
 g_{\theta, \theta^*}(x) &:= 2 \phi'_\theta ( \phi_\theta - \phi_{\theta^*}) ( x \cdot v )~, 
 \end{align}
so that
% and consider 
 \begin{align}
 \Delta_L(\theta) &= \mathbb{E}_\nu[ h_{\theta, \theta^*}(x)] - \mathbb{E}_\gamma[h_{\theta, \theta^*}(x)]~, \\
 \Delta_{\nabla L}(\theta) &= \mathbb{E}_\nu[ g_{\theta, \theta^*}(x)] - \mathbb{E}_\gamma[g_{\theta, \theta^*}(x)]~.    
 \end{align}

The result is obtained via the following Stein coupling method for product measures:
\begin{theorem}[Stein Coupling, {{\cite[Theorem 3.1]{rollin2013stein}}}]
\label{thm:rollin}
Let $X$ be a $d$-dimensional random vector of independent coordinates, such that $\mathbb{E} X = 0$, $\mathbb{E} [XX^\top] = I_d$ and $\mathbb{E}|X_i|^3 = \tau_i^3 < \infty$. If $Z$ is a standard Gaussian random vector, and $h: \mathbb{R}^d \to \mathbb{R}$ is three-times differentiable, then 
\begin{equation}
    | \mathbb{E} h(X) - \mathbb{E} h(Z) | \leq \frac{5}{6} \sum_{i=1}^d \tau_i^3 \| \partial_{x_i}^3 h\|_\infty~.
\end{equation}
\end{theorem}

%Let us first control the loss fluctuations $\Delta_{\nabla L}$. 
%Fix $\theta$, and define as before $P_{\theta, \theta^*}$ the subspace spanned by $\theta, \theta^*$. 
We verify that, thanks to the decay assumptions in Assumption \ref{ass:extralip}, we have
\begin{align}
    \partial_{x_i}^3 g_{\theta, \theta^*}(x) &= \lambda_1(x) \theta_i^3 + \lambda_2(x) \theta_i^2 \theta^*_i + \lambda_3(x) \theta_i (\theta^*_i)^2 + \lambda_4(x) (\theta^*_i)^3~, \\
    \partial_{x_i}^3 h_{\theta, \theta^*}(x) &= \lambda_5(x) \theta_i^3 + \lambda_6(x) \theta_i^2 \theta^*_i + \lambda_7(x) \theta_i (\theta^*_i)^2 + \lambda_8(x) (\theta^*_i)^3~,
 \end{align}
where 
\begin{equation}
    \sup_{k \in \{1,2,3,4\}} |\lambda_k(x)| \leq C \|v\|~,~ \sup_{k \in \{5,6,7,8\}} |\lambda_k(x)| \leq \tilde{C}~.
\end{equation}
Observing by Cauchy-Schwartz that 
\begin{align*}
\max\left\{\sum_i |\theta_i|^2 |\theta_i^*| , \sum_i |\theta_i|^3 \right\} &\leq \|\theta\|_4^2 ~,\\
\max\left\{\sum_i |\theta^*_i|^2 |\theta_i| , \sum_i |\theta^*_i|^3 \right\} &\leq \|\theta^*\|_4^2~, 
\end{align*}
we obtain from Theorem \ref{thm:rollin} that 
$$\Delta_L(\theta) \leq C \chi(\theta, \theta^*)~,~\Delta_{\nabla L}(\theta) \leq C' \|v\| \chi(\theta, \theta^*)~,$$
as claimed. 
\end{proof}


% As we did in Proposition \ref{prop:gradwassers}, we split the integral into the bulk ($\{ x; \| P_{\theta, \theta^*} x\| \leq R\}$) and the tail ($\{ x; \| P_{\theta, \theta^*} x\| > R\}$). 
% Let ${g}^R_{\theta, \theta^*}(x) = g_{\theta, \theta^*}(x) \mathbf{1}(\|P_{\theta, \theta^*}\| < R) $ be a localization of $h_{\theta, \theta^*}$. 

% We verify that
% \begin{align}
%     \partial_{x_i}^3 g^R_{\theta, \theta^*}(x) &= \lambda_1 \theta_i^3 + \lambda_2 \theta_i^2 \theta^*_i + \lambda_3 \theta_i (\theta^*)^2_i + \lambda_4 (\theta^*)^3_i~,
%  \end{align}
% where 
% \begin{equation}
%     \sup_{k \in \{1,2,3,4\}} |\lambda_k| \leq  
% \end{equation}

% \subsection{Separable Case under Incoherence Assumptions}
% \label{sec:incoherence}

% In this section, we outline a qualitative argument that explains how Proposition \ref{prop:stein} can be leveraged in cases where $\nu$ is not quasi-symmetric, but has a product structure (or an approximate product structure, as discussed below). 



% based on an energy barrier. The main idea is that as long as $\theta$ and $\theta^*$ are dense vectors, the loss and its gradients have a `Gaussian' behavior, meaning that $\Delta_{\nabla L}$ is small. 


% We now show that if $\theta$ is sparse, then $L(\theta)$ is above a certain energy threshold. 
% For $K \subset\{1,d\}$ and $\theta \in \S$, we define 
% $$\theta_K := \frac{\tilde{\theta}_K}{\| \tilde{\theta}_K\|}~,~\theta^K := \frac{\tilde{\theta}^K}{\| \tilde{\theta}^K\|}~,$$
% where $\tilde{\theta}_K = \theta \odot \mathbf{1}_K$, and $\tilde{\theta}^K = \theta \odot (1-\mathbf{1}_K)$.  
% We abuse notation and redefine $L(\theta, \theta') = \| \phi_\theta - \phi_{\theta'} \|^2_\nu$, so that $L(\theta) = L(\theta, \theta^*)$. 
% Finally, we define 
% \begin{equation}
%     \sigma^2 := \inf_{\theta} \mathrm{Var}(\phi(x \cdot \theta) )~,~E^2:= \sup_{\theta} \mathbb{E} [\phi( x \cdot \theta)^2]~.
% \end{equation}
% By anti-concentration, we have that $\sigma^2 > 0$, and we assume that $E^2 < \infty$. 

% We start by observing that $(\theta, \theta') \mapsto L(\theta, \theta')$ is Lipschitz with respect to both its arguments:
% \begin{fact}
%     The function $L(\theta, \theta')$ is $M$-Lipschitz in the Euclidean norm with respect to both of its arguments, with $M=4 L \sqrt{E^2}$. 
% \end{fact}
% \begin{proof}
%     Because of symmetry of its arguments, it is sufficient to show that 
%     $|L(\tilde{\theta}, \theta') - L(\theta, \theta') | \leq M \| \theta-\tilde{\theta}\|$. 
%     \begin{align*}
%         |L(\tilde{\theta}, \theta') - L(\theta, \theta')| &= \left|\| \phi_{\tilde{\theta}} \|^2 - \| \phi_{\theta} \|^2 + 2 \langle \phi_{\tilde{\theta}} - \phi_\theta, \phi_{\theta'} \rangle \right| \\
%         &\leq \| \phi_\theta - \phi_{\tilde{\theta}} \| \left( \| \phi_{\tilde{\theta}} \| + \|\phi_\theta\| + 2 \| \phi_{\theta'}\| \right)
%     \end{align*}
% Let $\theta_t = t \theta + (1-t) \tilde{\theta}$. 
% For each $x$, let $F_x(t) = \phi(  x \cdot \theta_t)$. 
% We have 
% \begin{align*}
% \phi(  x \cdot \theta) - \phi( x \cdot \tilde{\theta})  &= F_x(1) - F_x(0) \\
% &= \int_0^1 F_x'(t) dt \\
% &= \int_0^1 \phi'( x \cdot \theta_t) ( x \cdot (\theta - \tilde{\theta}) ) dt~,
% \end{align*}
% so, using the Lipschitz property of $t \mapsto \phi(t)$ and Cauchy-Schwartz, we obtain 
% \begin{align*}
%   \| \phi_\theta - \phi_{\tilde{\theta}} \|^2 &= \mathbb{E}_\nu [(\phi(x \cdot \theta) - \phi(x \cdot \tilde{\theta}) )^2 ] \\
%   &= \mathbb{E}_\nu  \left[ \left(( x \cdot (\theta - \tilde{\theta}) ) \int_0^1 \phi'( x \cdot \theta_t)  dt \right)^2\right] \\
%   &\leq L^2 (\theta - \tilde{\theta} )^\top \Sigma_\nu (\theta - \tilde{\theta} ) \\
%   %\|\theta - \tilde{\theta} \|^2 \mathbb{E}_{{(P_{\theta,\tilde{\theta}})_\#} \nu} \|x\|^2 \\
%   & = L^2 \| \theta - \tilde{\theta}\|^2~,
% \end{align*}
% and therefore 
% $$ |L(\tilde{\theta}, \theta') - L(\theta, \theta')| \leq 4 L \sqrt{E^2} \| \theta - \tilde{\theta} \|~. $$
% \end{proof}

% We now argue that if $\theta$ is sparse, then the loss $L(\theta)$ can be lower-bounded by an energy level at distance $O(1/\sqrt{d})$ from the typical initialization. 
% Let $K$ be the subset obtained by keeping the $k$ largest entries (in absolute value) of $\theta$. 
% \begin{fact}
% Assume $\theta^*$ is such that $\|\theta^* \|_4^2 \leq C_* /\sqrt{d}$ and $\|\theta\|_4^2 \geq B/\sqrt{d}$. Then for $K = A/\sqrt{d}$
%     \begin{equation}
%         L(\theta) \geq L(\theta_K, (\theta^*)^K) - C (\| \theta- \theta_K \| + \|\theta^* - (\theta^*)^K \| ) 
%     \end{equation}
% \end{fact}
% \begin{proof}
%     We have 
%     \begin{align}
%         L(\theta) &= \| \phi_\theta - \phi_{\theta^*} \|^2 \nonumber \\
%         &= \| \phi_\theta - \phi_{\theta_K} + \phi_{\theta_K} - \phi_{\theta^*} \|^2 \nonumber \\
%         &\geq \| \phi_{\theta_K} - \phi_{\theta^*} \|^2 - 2 \| \phi_\theta - \phi_{\theta_K}\| \cdot \| \phi_{\theta_K} - \phi_{\theta^*} \|
%     \end{align}
% \end{proof}

% \begin{fact}
%     The loss $L(\theta_K, (\theta^*)^K)$ satisfies 
%     \begin{align*}
%         L(\theta_K, (\theta^*)^K) &= \textrm{Var}(\phi( x \cdot \theta_K) ) + \textrm{Var}(\phi( x \cdot (\theta^*)^K) ) + \left( \mathbb{E}[(\phi( x \cdot \theta_K) ) - \phi( x \cdot (\theta^*)^K)] \right)^2  \\
%         &\geq 2\sigma^2
%     \end{align*}
% \end{fact}

