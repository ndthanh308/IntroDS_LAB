First, we provide a lower bound that $\umin(\honexec)$ achieves with overwhelming probability.

\begin{claim}\label{claim:H}
If (i) $\pf\reward\geq\frac{\cost_\msf{lc}+\cost_\msf{fs}+\cost_\msf{tx}}{(1-\frac{\log\secpar}{\sqrt{n}}) nq}$ and (ii) $\pb=\Omega(\frac{1}{nq})$, then it holds that
\begin{equation*} 
\begin{split}
&\Pr\big[\umin(\honexec)\geq\big(1-\tfrac{\log\secpar}{\sqrt{\rounds n}}\big)(\rounds-\log^2\secpar)(n-1)q\pf\reward-\\
&-\tfrac{n-1}{n}\big(1+\tfrac{\log\secpar}{\sqrt{\rounds}}\big)\rounds(1-(1-\pb)^{nq})(\cost_\msf{lc}+n\cost_\msf{ltx})-\\
&-\big(\tfrac{n-1}{n}\rounds+\tfrac{\log^2\secpar}{n}\big)(\cost_\msf{fs}+\cost_\msf{tx})-\rounds (n-1)q\cost_\msf{ro}\big]\geq\\
&\geq 1-\negl(\secpar).
\end{split}
\end{equation*}
\end{claim}
%
\textit{Proof of Claim~\ref{claim:H}. }
We say that a block $\block$ is \emph{profitable} if the rewards that derive from the fruits included in $\block$ are higher than the pool leader cost of asking $\cost_\msf{lc},\cost_\msf{fs},\cost_\msf{tx}$ during the mining of $\block$. By the description of $\single$, if $\block$ is profitable, then $\party{L}$ shares the total profit of $\block$ evenly among all $n$ parties of the single pool. Otherwise, $\party{L}$ uses the rewards to cover (part of) the cost of $\block$ while the other parties receive no profit for $\block$.

We show that the probability that a block $\block$ is profitable under the execution $\honexec$ is overwhelming. 
Let $\rho$ be the number of rounds elapsed for mining $\block$. Since the number of the queries the single pool makes per round is $nq$, the number of fruits mined during the mining of $\block$, $Z_0$, follows $\msf{Bin}(\rho nq,\pf)$. By the Chernoff bounds (cf. Appendix~\ref{app:chernoff}),
%
\begin{equation*}
\Pr\big[Z_0<(1-\tfrac{\log\secpar}{\sqrt{n}})\rho nq\pf\big]\leq e^{-\frac{\log^2\secpar}{2n}\rho nq\pf}=\negl(\secpar).    
\end{equation*}
%
Thus, with $1-\negl(\secpar)$ probability, the rewards w.r.t. $\block$ are at least $(1-\frac{\log\secpar}{\sqrt{n}})\rho nq\pf\reward$. Besides, the leader cost for $\block$ is $\cost_\msf{lc}+\rho\cost_\msf{fs}+\rho\cost_\msf{tx}$. 
Since $\pf\reward\geq\frac{\cost_\msf{lc}+\cost_\msf{fs}+\cost_\msf{tx}}{(1-\frac{\log\secpar}{\sqrt{n}}) nq}$ and $\rho\geq 1$, we have that with $1-\negl(\secpar)$ probability, it holds that
%
\[(1-\tfrac{\log\secpar}{\sqrt{n}})\rho nq\pf\reward\geq\rho(\cost_\msf{lc}+\cost_\msf{fs}+\cost_\msf{tx})\geq\cost_\msf{lc}+\rho\cost_\msf{fs}+\rho\cost_\msf{tx},\]
%
i.e., $\Pr[\block\mbox{ is profitable}]\geq1-\negl(\secpar)$.\\[2pt]
%
%-----------------------------------------------------------
%
Next, we define the following random variables. Let $Z$ be the number of mined fruits during $\honexec$ for the first $\rounds-\log^2\secpar$ rounds and $W$ be the number of rounds that at least one block was mined (i.e., the number of calls to $\mc{O}_\msf{lc}$, $\mc{O}_\msf{tlx}$). Since $nq$ mining queries are made per round, $Z\sim\msf{Bin}((\rounds-\log^2\secpar) nq,\pf)$. Besides, the probability that at least one block is produced in some round is $1-(1-\pb)^{nq}$, so $W\sim\msf{Bin}(\rounds,1-(1-\pb)^{nq})$.

Let $t\_reward$ be the total rewards of the single pool and $l\_cost$ be the leader costs in terms of queries to $\mc{O}_\msf{lc},\mc{O}_\msf{fs},\mc{O}_\msf{tx}$ that are shared among the members of the single pool. Let $c\_reward$ be the rewards of the coalition $\corrupt$ and $c\_cost$ be the additional cost that $\corrupt$ incurs besides its share of $l\_cost$.

As shown above, the probability that some block is not profitable is $\negl(\secpar)$. So, by the union bound, the probability that all the blocks are profitable in $\honexec$ is at least $1-\rounds\negl(\secpar)=1-\negl(\secpar)$. As the coalition consists of $n-1$ parties and when all blocks are profitable each party receives an equal profit share, we have that
%
\begin{equation}\label{eq:c_reward}
\Pr\big[c\_reward=\tfrac{n-1}{n}(t\_reward-l\_cost)\big]=1-\negl(\secpar).
\end{equation}
%
Moreover, the probability that no block is produced during the last $\log^2\secpar$ rounds is $(1-\pb)^{(\log^2\secpar)nq}=\negl(\secpar)$, for $\pb=\Omega(\frac{1}{nq})$. Thus, all fruits mined during the first $\rounds-\log^2\secpar$ rounds will be included in the chain with $1-\negl(\secpar)$ probability, so
\begin{equation}\label{eq:t_reward}
\Pr[t\_reward\geq Z\reward]=1-\negl(\secpar).    
\end{equation}
%
For the leader costs that are shared among the pool members, we have that $l\_cost\leq W\cost_\msf{lc}+r_0(\cost_\msf{fs}+\cost_\msf{tx})$, where $r_0$ is the round that the final block was mined in $\honexec$. By the Chernoff bounds, and since $W\sim\msf{Bin}(\rounds,1-(1-\pb)^{nq})$
%
\begin{equation*}
\begin{split}
&\Pr\big[W\geq\big(1+\tfrac{\log\secpar}{\sqrt{\rounds}}\big)\rounds(1-(1-\pb)^{nq})\big]%\leq\\
%&\leq e^{-\frac{\log^2\secpar}{3\rounds}\rounds(1-(1-\pb)^{nq})}
=\negl(\secpar).
\end{split}
\end{equation*}
%
Thus, we have that %with $1-\negl(\secpar)$ probability,
\begin{equation}\label{eq:l_cost}
\begin{split}
\Pr\big[l\_cost&\leq \big(1+\tfrac{\log\secpar}{\sqrt{\rounds}}\big)\rounds(1-(1-\pb)^{nq})\cost_\msf{lc}+r_0(\cost_\msf{fs}+\cost_\msf{tx})\big] =1-\negl(\secpar).
\end{split}
\end{equation}
%
Each party in the coalition makes also queries to $\cost_\msf{ltx}$ and $\cost_\msf{ro}$. In addition, in case the coalition includes $\party{L}$, we take into account the extra cost $(N-r_0)(\cost_\msf{fs}+\cost_\msf{tx})$ for $\party{L}$ in the last $(N-r_0)$ rounds where no block was produced. In any case, $c\_cost\leq W(n-1)\cost_\msf{ltx}+\rounds(n-1)q\cost_\msf{ro}+(N-r_0)(\cost_\msf{fs}+\cost_\msf{tx})$. By the Chernoff bounds,
\begin{equation}\label{eq:c_cost}
\begin{split}
&\Pr\big[c\_cost\leq \big(1+\tfrac{\log\secpar}{\sqrt{\rounds}}\big)\rounds(1-(1-\pb)^{nq})(n-1)\cost_\msf{ltx}+\\
&+\rounds (n-1)q\cost_\msf{ro}+(N-r_0)(\cost_\msf{fs}+\cost_\msf{tx}) \big]=1-\negl(\secpar).    
\end{split}
\end{equation}
%
By Eq.~\eqref{eq:c_reward},~\eqref{eq:t_reward},~\eqref{eq:l_cost},~\eqref{eq:c_cost} and for some lower bound $B$ (to be defined), we get that
%
\begin{equation}\label{eq:H_final}
\begin{split}
&\Pr[\umin(\honexec)\geq B]=\Pr[c\_reward-c\_cost\geq B]\geq \\
%
\geq&\Pr\big[\tfrac{n-1}{n}(t\_reward-l\_cost)-c\_cost\geq B\big]-\negl(\secpar)\geq\\
%
\geq&\Pr\big[\tfrac{n-1}{n}\Big(Z\reward-\big(1+\tfrac{\log\secpar}{\sqrt{\rounds}}\big)\rounds(1-(1-\pb)^{nq})\cost_\msf{lc}-r_0(\cost_\msf{fs}+\cost_\msf{tx})\Big)-\\
&-\big(1+\tfrac{\log\secpar}{\sqrt{\rounds}}\big)\rounds(1-(1-\pb)^{nq})(n-1)\cost_\msf{ltx}-\\
&-\rounds (n-1)q\cost_\msf{ro}-(N-r_0)(\cost_\msf{fs}+\cost_\msf{tx})\geq B\big]-\\
&-\negl(\secpar)\geq\\
%
\geq&\Pr\big[\tfrac{n-1}{n}\Big(Z\reward-\big(1+\tfrac{\log\secpar}{\sqrt{\rounds}}\big)\rounds(1-(1-\pb)^{nq})\cost_\msf{lc}\Big)-\big(\tfrac{n-1}{n}r_0+(\rounds-r_0)\big)(\cost_\msf{fs}+\cost_\msf{tx})-\\
&-\big(1+\tfrac{\log\secpar}{\sqrt{\rounds}}\big)\rounds(1-(1-\pb)^{nq})(n-1)\cost_\msf{ltx}-\rounds (n-1)q\cost_\msf{ro}\geq B\big]-\\
&-\negl(\secpar)=\\
%
\geq&\Pr\big[Z\reward\geq \tfrac{n}{n-1}B+\big(1+\tfrac{\log\secpar}{\sqrt{\rounds}}\big)\rounds(1-(1-\pb)^{nq})(\cost_\msf{lc}+n\cost_\msf{ltx})+\\
& +\tfrac{n}{n-1}\big(\tfrac{n-1}{n}r_0+(\rounds-r_0)\big)(\cost_\msf{fs}+\cost_\msf{tx})+\rounds nq\cost_\msf{ro}\big]-\negl(\secpar).
\end{split}   
\end{equation}
%
As already shown, with $1-\negl(\secpar)$ probability, it holds that $r_0\geq\rounds-\log^2\secpar$. Therefore,
\begin{equation}\label{eq:CfsCtx}
\tfrac{n-1}{n}r_0+(\rounds-r_0)=\rounds-\tfrac{1}{n}r_0\leq\tfrac{n-1}{n}\rounds+\tfrac{\log^2\secpar}{n}.
\end{equation}
%
So, by setting 
%
\begin{equation*}
\begin{split}
&\tfrac{n}{n-1}B+\big(1+\tfrac{\log\secpar}{\sqrt{\rounds}}\big)\rounds(1-(1-\pb)^{nq})(\cost_\msf{lc}+n\cost_\msf{ltx})+\\
&+\tfrac{n}{n-1}\big(\tfrac{n-1}{n}\rounds+\tfrac{\log^2\secpar}{n}\big)(\cost_\msf{fs}+\cost_\msf{tx})+\rounds nq\cost_\msf{ro}=\\
&=\big(1-\tfrac{\log\secpar}{\sqrt{\rounds n}}\big)(\rounds-\log^2\secpar)nq\pf\reward\Leftrightarrow\\
%
\Leftrightarrow& B:=\big(1-\tfrac{\log\secpar}{\sqrt{\rounds n}}\big)(\rounds-\log^2\secpar)(n-1)q\pf\reward-\\
&-\tfrac{n-1}{n}\big(1+\tfrac{\log\secpar}{\sqrt{\rounds}}\big)\rounds(1-(1-\pb)^{nq})(\cost_\msf{lc}+n\cost_\msf{ltx})-\\
&-\big(\tfrac{n-1}{n}\rounds+\tfrac{\log^2\secpar}{n}\big)(\cost_\msf{fs}+\cost_\msf{tx})-\rounds (n-1)q\cost_\msf{ro},
\end{split}    
\end{equation*}
%
and by Eq.~\eqref{eq:H_final},~\eqref{eq:CfsCtx} and the Chernoff bounds, we conclude that
%
\begin{equation*}
\begin{split}
&\Pr[\umin(\honexec)\geq B]\geq\\
%
\geq&\Pr\big[Z\geq\big(1-\tfrac{\log\secpar}{\sqrt{\rounds n}}\big)(\rounds-\log^2\secpar)nq\pf\big]-\negl(\secpar)\geq\\
%
\geq&\big(1-e^{\frac{\log^2\secpar}{\rounds n}(\rounds-\log^2\secpar)nq\pf})-\negl(\secpar)\geq1-\negl(\secpar).
\end{split}    
\end{equation*}
%
$\quad$\hfill$\dashv$
