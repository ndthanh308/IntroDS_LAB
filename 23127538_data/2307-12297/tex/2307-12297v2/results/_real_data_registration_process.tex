\noindent Registration transforms all frames to the same coordinate system, such that an object has equal coordinates across all frames.
Contrary to previous works, we do not make assumptions on the reference frame. To maximize the redundant information between frames, a plane $\mathcal{I}$\ that maximizes the overlap between frames must be found. Notice that finding the ideal $\mathcal{I}$ is infeasible, because it requires solving an expensive optimization problem. Instead, $\mathcal{I}$ is approximated as the frame with the maximal overlap to all other frames.

Kernels have a finite support and limited receptive field, so the frames are registered before entering the network.
We used the classic feature extraction algorithm SIFT by Lowe~\cite{sift}. 
SIFT identifies distinctive keypoints in a frame. A descriptor vector of 128 values is extracted for each keypoint, based on the directional gradients in the area surrounding the keypoint.

To match keypoints between frames, we used mutual nearest neighbor (MNN) distance with Euclidean distance to measure the similarity between vectors. MMN means finding pairs of vectors in a set that minimizes the Euclidean distance for each other. Two vectors are MNN if they have the minimal distance towards each other in their sets.

The overlap between frames was determined by counting the positive pixels in the overlapping masks. That is, after performing a pixel-wise AND operator on all the masks created by the homography of each frame.

The registration process differs between the training and validation (inference).
\subsubsection{Training}
% A number of homographies were randomly sampled for each frame, creating different views of the same frame. The inverse homographies were used to register all the views towards the original frame, which is de-facto $\mathcal{I}$. 
% Random deviations of up to $\pm2$ pixels were added to the inverse homographies to simulate imperfect registration.
% These registered views were fed into the network.

\subsubsection{Validation and any other inference}
Homographies were randomly sampled, but the inverses of the homographies were discarded. Instead, $\mathcal{I}$ was approximated for each burst by SIFT and MNN as described above. 
All frames in the burst were registered to the approximated $\mathcal{I}$.
All results presented in this work were obtained using this method.
The same homographies were used for validation throughout all experiments and ablations.

% The sampled homographies either create a random walk from one side of the temperature map to the other side, or a hover above a random point.

% The registration method was implemented with the package Kornia~v0.67.