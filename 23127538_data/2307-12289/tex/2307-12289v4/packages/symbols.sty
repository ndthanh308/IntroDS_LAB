%!TeX root = ../ai2019.tex
%
% Package of custom commands too specific to be included in the thesis class
%
\NeedsTeXFormat{LaTeX2e}
\ProvidesPackage{packages/symbols}[2017/11/24 Package for all symbols]

\ExecuteOptions*

\RequirePackage{packages/commands}

\RequirePackage{xspace}
\RequirePackage{calc}
\RequirePackage{mathtools}

\PassOptionsToPackage{final}{hyperref}
\RequirePackage{hyperref}

%
% number equations independently
%
\RequirePackage{chngcntr}
\counterwithout{equation}{section}

%
% Text commands and achronyms
%
\NewDocumentCommand\Wlog{}{\emph{w.l.o.g.}}

%
% Generic math notation
%
\DeclarePairedDelimiter\angular{\langle}{\rangle}
\DeclarePairedDelimiter\seq{\langle}{\rangle}
\let\set\relax
\DeclarePairedDelimiter\set{\{}{\}}
\DeclarePairedDelimiter\pair{(}{)}
\DeclarePairedDelimiter\tuple{(}{)}
% \DeclarePairedDelimiter\set{\{}{\}}
\DeclarePairedDelimiter\abs{|}{|}
\DeclarePairedDelimiter\ceil{\lceil}{\rceil}
\DeclarePairedDelimiter\floor{\lfloor}{\rfloor}

\NewDocumentCommand\eval{O{} m E{_}{{\lambda}}}{%
  #1\llbracket #2#1\rrbracket_{#3}%
}
\NewDocumentCommand\suchthat{}{\mathrel{\vert}}
\NewDocumentCommand\suchdot{}{\mathrel{.}}

\DeclareMathOperator\sign{sign}
\DeclareMathOperator\Img{Img}
\DeclareMathOperator\Dom{Dom}

% for different proof directions
\NewDocumentCommand\proofif{s}{%
  \IfBooleanTF{#1}{$\longleftarrow$}{$(\longleftarrow)$.}%
  \xspace
}
\NewDocumentCommand\proofonlyif{s}{%
  \IfBooleanTF{#1}{$\longrightarrow$}{$(\longrightarrow)$.}%
  \xspace
}
\NewDocumentCommand\noproof{}{\qed}

% Better empty-set symbol
\letswap\varnothing\emptyset

% Better epsilon symbol
\letswap\epsilon\varepsilon

% better \bar overline
\let\oldbar\bar
\let\bar\overline

% logic notation
\NewDocumentCommand\true{}{\top}
\NewDocumentCommand\false{}{\bot}
\RenewDocumentCommand\implies{}{\rightarrow}
\RenewDocumentCommand\impliedby{}{\leftarrow}
\RenewDocumentCommand\iff{}{\longleftrightarrow}
\DeclareMathOperator\closure{\mathcal{C}}

% to show grammars
\NewDocumentCommand\bydef{}{\vcentcolon=}
\NewDocumentCommand\production{m}{\langle\mathit{#1}\rangle}
\NewDocumentCommand\choice{}{\mathrel{\vert}}

% Various ordering symbols
\NewDocumentCommand\subgrapheq{}{\sqsubseteq}
\NewDocumentCommand\subgraph{}{\sqsubset}
\NewDocumentCommand\graphcup{}{\sqcup}
\NewDocumentCommand\biggraphcup{}{\bigsqcup}

% Complexity-related notation
\RenewDocumentCommand\O{}{\mathop{\mathcal{O}}}

% Numeric sets
\DeclareSymbol[\mathbb]{N}
\DeclareSymbol[\mathbb]{Z}
\DeclareSymbol[\mathbb]{R}
\DeclareSymbol[\mathbb]{C}

% Complexity classes
\DeclareClassSymbol{PTIME}
\DeclareClassSymbol{NP}
\DeclareClassSymbol{PSPACE}
\DeclareClassSymbol{NPSPACE}
\DeclareClassSymbol{EXPTIME}
\DeclareClassSymbol{NEXPTIME}
\DeclareClassSymbol{EXPSPACE}
\DeclareClassSymbol{NEXPSPACE}

% Symbols used in chap:expressiveness
\DeclareSymbol[\bar][\templan]{O}
\DeclareSymbol[\mathsf][\temproblem]{P}
\DeclareSymbol[\mathsf][\precformulae]{F}
\DeclareMathOperator\inc{inc}


%
% Timelines-related symbols
%

% Base
\DeclareSymbol[\mathsf]{SV} % set of state variables
\DeclareSymbol[\mathsf]{H}  % timelines horizon
\DeclareSymbol[\mathsf][\E]{E}  % existential statement
\DeclareSymbol[\mathsf][\timeline]{\bar{\tau}}  % timelines
\DeclareSymbol[\mathsf][\toknames]{N}
\DeclareSymbol[\mathsf][\clause]{C}
\DeclareSymbol[\mathbb][\timelines]{T}
\DeclareSymbol[\mathbb][\flextimelines]{F}
\DeclareSymbol[\mathsf][\actions]{A}
\DeclareSymbol[\mathsf][\Rule]{R}

% Automaton construction symbols
\DeclareSymbol[\mathsf]{M} % matching structure
\DeclareSymbol[\mathbb]{I} % I-match sets
\DeclareSymbol[\mathbb][\matchstructs]{M} % set of matching structures
\DeclareSymbol[\mathbb]{D} % Delta functions
\DeclareSymbol[\mathbb]{F} % Phi functions
\DeclareSymbol[\mathsf]{S} % Automaton for synchronisation rules
\DeclareSymbol[\mathsf][\TV]{T} % Automaton for transition function of variables
\DeclareSymbol[\mathsf]{A} % Final Automaton

% Symbols used in sec:complexity
\NewDocumentCommand\graphconcat{}{\rightrightarrows}
\NewDocumentCommand\concatchain{mm}{#1\graphconcat\ldots\graphconcat#2}

\DeclareSymbol[][\event]{\mu}
\DeclareSymbol[][\evseq]{\bar\mu}
\DeclareSymbol[][\match]{I}
% \DeclareSymbol[][\state]{q}
\DeclareSymbol[][\matchseq]{\bar\match}
\DeclareSymbol[][\stateseq]{\bar q}
\DeclareSymbol[][\buffer]{\bar\theta}
\DeclareSymbol[][\history]{\bar\omega}
\DeclareSymbol[][\historyevent]{\omega}
\DeclareSymbol[][\pasthistory]{\bar\rho}
\DeclareSymbol[][\path]{\bar{T}}

\DeclareSymbol[][\situations]{\Omega}
\DeclareSymbol[][\situation]{\omega}
\DeclareSymbol[\mathcal][\schedfunctions]{T}
\DeclareSymbol[][\schedfunction]{\theta}

% Blueprints-related symbols
\NewDocumentCommand\stay{}{\text{\textvisiblespace}}
\DeclareSymbol[\mathcal][\values]{V}
\DeclareSymbol[][\sym]{\sigma}
\DeclareSymbol[][\word]{\bar\sigma}
\DeclareSymbol[][\startingsym]{\Sigma_S}
\DeclareSymbol[\mathcal][\pumpingpoints]{P}
\DeclareSymbol[\mathbb][\blueprints]{B}
\DeclareSymbol[\mathbb][\viewpoints]{V}
\NewDocumentCommand\tran{}{\mathrel{\to}}

\NewDocumentCommand\viewpointset{}{\Upsilon}
\NewDocumentCommand\oviewpointset{t'}{%
  \overline{\viewpointset}\IfBooleanT{#1}{{}'}%
}

\DeclareMathOperator\valuesym{value}

%
% Timelines-specific notation
%
\NewDocumentCommand\dmin{E{^}{{x=v}}}{d^{#1}_{min}}
\NewDocumentCommand\dmax{E{^}{{x=v}}}{d^{#1}_{max\vphantom{i}}}

\DeclareMathOperator\starttime{start-time}
\DeclareMathOperator\@endtime{end-time} \let\endtime\@endtime
\DeclareMathOperator\val{val}
\DeclareMathOperator\duration{duration}
\DeclareMathOperator\tokens{tokens}
\DeclareMathOperator\lbound{lbound}
\DeclareMathOperator\ubound{ubound}
\DeclareMathOperator\plans{plans}
\DeclareMathOperator\evactions{actions}
\DeclareMathOperator\evtime{time}
\DeclareMathOperator\graphspan{span}
\DeclareMathOperator\window{window}
\DeclareMathOperator\AR{AR}

\DeclareMathOperator\tokstart{start}
\DeclareMathOperator\tokend{end}

% Automaton construction
\DeclareMathOperator\tokst{s}
\DeclareMathOperator\toked{e}
% \DeclareMathOperator\shift{shift}
% \DeclareMathOperator\match{match}
\DeclareMathOperator\step{step}
\DeclareMathOperator\trigger{trigger}
% step a matching structure -{\mu,I}->
\NewDocumentCommand\stepm{O{}}{\mathrel{\xlongrightarrow{\event_{#1},\match_{#1}}}}
\NewDocumentCommand\runm{s O{}}{%
  \xlongrightarrow{\evseq,\IfBooleanTF{#1}{\gamma_{#2}}{\matchseq}}}
\NewDocumentCommand\pto{}{\mathrel{\rightharpoonup}} % partial function
\DeclarePairedDelimiter\ar{[}{]}

% Flexible timelines notation
\NewDocumentCommand\ctag{}{\mathsf{c}}
\NewDocumentCommand\utag{}{\mathsf{u}}

\DeclareSymbol[\mathsf][\planrules]{R}


% syntax for synchronisation rules
\NewDocumentCommand\synchrel{O{\le} e{_}}{%
  \mathrel{\mathsf{#1}}%
  \IfValueT{#2}{_{[#2]}}%
}

\NewDocumentCommand\before{s}{%
  \IfBooleanTF{#1}{
    \synchrel[<]%
  }{
    \synchrel[\le]%
  }%
}

\NewDocumentCommand\after{s}{%
  \IfBooleanTF{#1}{
    \synchrel[>]%
  }{
    \synchrel[\ge]%
  }
}

\NewDocumentCommand\ibefore{}{\synchrel[before]}
\NewDocumentCommand\iafter{}{\synchrel[after]}
\NewDocumentCommand\meets{}{\synchrel[meets]}
\NewDocumentCommand\overlaps{}{\synchrel[overlaps]}
\NewDocumentCommand\containedeq{}{\synchrel[\subseteq]}
\NewDocumentCommand\containseq{}{\synchrel[\supseteq]}
\NewDocumentCommand\contained{}{\synchrel[\subset]}
\NewDocumentCommand\contains{}{\synchrel[\supset]}


%
% Notation used in chap:uncertainty
%
\NewDocumentCommand\charlie{}{\emph{Charlie}\xspace}
\NewDocumentCommand\eve{}{\emph{Eve}\xspace}
\DeclareSymbol[\mathsf]{D}
\DeclareSymbol[\mathsf]{S}
\DeclareSymbol[\mathsf]{now}
\DeclareSymbol[][\move]{\mu}
\DeclareSymbol[\mathcal][\moves]{M}

\DeclareMathOperator\play{play}
\DeclareMathOperator\wait{wait}

\DeclareSymbol[][\round]{\rho}
\DeclareSymbol[][\rounds]{\bar\rho}
\DeclareSymbol[][\strategy]{\sigma}
\DeclareSymbol[][\partialplans]{\Pi}
\DeclareSymbol[\mathsf][\players]{P}

\NewDocumentCommand\ATL{s}{%
  \ensuremath{\mathsf{ATL}\IfBooleanT{#1}{^*}}\xspace
}

\NewDocumentCommand\CTL{s}{%
  \ensuremath{\mathsf{CTL}\IfBooleanT{#1}{^*}}\xspace
}


%
% Temporal Logic commands, used in chap:tableaux and chap:tptl
%
\DeclareSymbol[\mathsf]{LTL}
\DeclareSymbol[\mathsf][\LTLP]{LTL{+}P}
\DeclareSymbol[\mathsf]{TPTL}
\DeclareSymbol[\mathsf][\TPTLP]{TPTL{+}P}
\DeclareSymbol[\mathsf][\TPTLbP]{TPTL_b{+}P}
\DeclareSymbol[\mathsf][\GTPTLP]{G(TPTL{+}P)}
\DeclareSymbol[\mathsf]{MTL}

\NewDocumentCommand\leviathan{}{\textsf{Leviathan}\xspace}

% Commands for LTL operators
\NewDocumentCommand\@calop{m e{_}}{%
  \nobreak\mathbin{%
    \resizebox{!}{\heightof{$\eventually$}}{$\mathcal #1$}%
  }\IfValueT{#2}{\kern-2.5pt{}_{#2}}\nobreak
}

% LTL operators
\NewDocumentCommand\until       {}{\@calop{U}}
\NewDocumentCommand\release     {}{\@calop{R}}
\NewDocumentCommand\since       {}{\@calop{S}}
\NewDocumentCommand\triggered   {}{\@calop{T}}
\NewDocumentCommand\tomorrow    {}{\mathsf{X}}
\NewDocumentCommand\yesterday   {}{\mathsf{Y}}
\NewDocumentCommand\eventually  {}{\mathsf{F}}
\NewDocumentCommand\always      {}{\mathsf{G}}
\NewDocumentCommand\past        {}{\mathsf{P}}
\NewDocumentCommand\historically{}{\mathsf{H}}

\NewDocumentCommand\weaktomorrow{}{%
  \smash{\widetilde{\tomorrow}}\vphantom{\tomorrow}%
}

\NewDocumentCommand\weakyesterday{}{%
  \smash{\widetilde{\yesterday}}\vphantom{\yesterday}%
}

% CTL
\NewDocumentCommand\allpaths    {}{\mathop{\text{\textsf{A}}}}
\NewDocumentCommand\existspath  {}{\mathop{\text{\textsf{E}}}}

% ATL
\NewDocumentCommand\llangle{}{\langle\mkern-4mu\langle}
\NewDocumentCommand\rrangle{}{\rangle\mkern-4mu\rangle}

\NewDocumentCommand\atldiamond{m}{\llangle#1\rrangle}
\NewDocumentCommand\atlbox{m}{\llbracket#1\rrbracket}

% Register them to be recognised by the \ltl command (see commands.sty)
\RegisterLTLOperators{
  U/\until,
  R/\release,
  S/\since,
  T/\triggered,
  wX/\weaktomorrow,
  X/\tomorrow,
  wY/\weakyesterday,
  Y/\yesterday,
  F/\eventually,
  G/\always,
  P/\past,
  H/\historically,
  A/\allpaths,
  E/\existspath,
  !/\neg,
  Â¬/\neg,
  &&/\land,
  &/\land,
  ||/\lor,
  |/\lor,
  =/\equiv,
  <->/\iff,
  ->/\implies,
  <-/\impliedby,
  <</\llangle,
  >>/\rrangle,
  [[/\llbracket,
  ]]/\rrbracket
}

\NewDocumentCommand\nnf{d()}{%
  \operatorname{nnf}\IfValueT{#1}{(\ltl{#1})}%
}

%
% Symbolism
%
\DeclareSymbol[][\model]{\bar\sigma}
\DeclareSymbol[][\state]{\sigma}
\DeclareSymbol[][\branch]{\bar{u}}
\DeclareSymbol[][\node]{u}
\DeclareSymbol[][\atom]{\Delta}
\DeclareSymbol[\mathsf][\delay]{d}
\DeclareSymbol[\mathbb][\delays]{D}
\DeclareSymbol[\mathcal][\Xevset]{U}

\NewDocumentCommand\premodel{s e{^}}{%
  \IfBooleanTF{#1}{\def\gt@smash##1{##1}}{\let\gt@smash\smash}%
  \gt@smash{\bar\Delta}\IfValueT{#2}{{}^{#2}}%
}

\NewDocumentCommand\Xeventuality{}{$\tomorrow$\nobreak-\nobreak eventuality\xspace}
\NewDocumentCommand\Xeventualities{}{$\tomorrow$-eventualities\xspace}

\NewDocumentCommand\tlabel{s}{%
  \Gamma\IfBooleanT{#1}{^*}%
}

% names of tableau rules
\NewDocumentCommand\trule{m}{\textsf{\MakeUppercase{#1}}}

% Ticked and crossed symbols for the tableau
\RequirePackage{pifont}

\NewDocumentCommand\ticked{}{\text{\ding{51}}}
\NewDocumentCommand\crossed{}{\text{\ding{55}}}

\NewDocumentCommand\ancestor{}{<}
\NewDocumentCommand\ancestoreq{}{\le}
\NewDocumentCommand\lex{O{\prec}}{#1_{\mathit{lex}}}
\NewDocumentCommand\lexeq{O{\preceq}}{#1_{\mathit{lex}}}

% List environment to show tableau rules
\@ifclassloaded{beamer}{}{
  \RequirePackage[inline]{enumitem}

  \setlist[description]{format={\normalfont\itshape}}

  \newlist{rules}{description}{2}
  \setlist[rules]{format={\normalfont\trule}}

  \newlist{enuminline}{enumerate*}{2}
  \setlist[enuminline]{itemjoin={{, }}, itemjoin*={{, and }}}
  \setlist[enuminline,1]{label={(\arabic*)}}
  \setlist[enuminline,2]{label={(\alph*)}}
}


%
% Symbols used in chap:tptl
%
\DeclareSymbol[\mathcal][\vars]{V}
\DeclareSymbol[][\tmodel]{\rho}
\DeclareSymbol[][\stamp]{\tau}
\DeclareSymbol[][\stamps]{\bar\tau}

\DeclareMathOperator\nodetime{time}

\DeclareSymbol[\mathsf]{Prev}
\DeclareSymbol[\mathsf]{Succ}
