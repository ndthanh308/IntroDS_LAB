
\documentclass[letterpaper, 10 pt, conference]{ieeeconf}  %


\IEEEoverridecommandlockouts                              %

\overrideIEEEmargins                                      %



\usepackage{balance} %

\usepackage{algorithm,algorithmic}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{color}
\usepackage{mathtools}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{Definition}{Definition}[section]
\newtheorem{corollary}{Corollary}[section]
\newtheorem{Theorem}{Theorem}[section]
\newtheorem{Lemma}{Lemma}[section]
\newtheorem{Claim}{Claim}[section]
\newtheorem{Notation}{Notation}[section]
\newtheorem{Algorithm}{Algorithm}[section]
\newtheorem{Observation}{Observation}[section]
\newtheorem{Proposition}{Proposition}[section]
\DeclareMathOperator*{\argmax}{argmax}
\DeclareMathOperator*{\argmin}{argmin}

\definecolor{darkgreen}{rgb}{0,0.5,0}
\newcommand{\sh}[1]{\textcolor{darkgreen}{[SH: #1]}}



\title{\LARGE \bf Robust Electric Vehicle Balancing of Autonomous Mobility-on-Demand System: A Multi-Agent Reinforcement Learning Approach}




\author{
{Sihong He$^{1}$}  \and {Shuo Han$^{2}$} \and {Fei Miao$^{1}$} 
\thanks{$^{1}$Sihong~He and Fei~Miao are with the Department of Computer Science and Engineering, University of Connecticut, Storrs, CT. {\tt\small \{sihong.he, fei.miao\}@uconn.edu}. }
\thanks{$^{2}$Shuo Han is with the Department of Electrical and Computer Engineering, University of Illinois, Chicago. {\tt\small hanshuo@uic.edu}. }
\thanks{This work is supported by National Science Foundation under Grants CNS-1952096, CMMI-1932250, and CNS-2047354.}
}









         
\newcommand{\BibTeX}{\rm B\kern-.05em{\sc i\kern-.025em b}\kern-.08em\TeX}


\begin{document}


\maketitle
\thispagestyle{plain}
\pagestyle{plain}


\begin{abstract}
Electric autonomous vehicles (EAVs) are getting attention in future autonomous mobility-on-demand (AMoD) systems due to their economic and societal benefits. However, EAVs' unique charging patterns (long charging time, high charging frequency, unpredictable charging behaviors, etc.) make it challenging to accurately predict the EAVs supply in E-AMoD systems. Furthermore, the mobility demand's prediction uncertainty makes it an urgent and challenging task to design an integrated vehicle balancing solution under supply and demand uncertainties. Despite the success of reinforcement learning-based E-AMoD balancing algorithms, state uncertainties under the EV supply or mobility demand remain unexplored. In this work, we design a multi-agent reinforcement learning (MARL)-based framework for EAVs balancing in E-AMoD systems, with adversarial agents to model both the EAVs supply and mobility demand uncertainties that may undermine the vehicle balancing solutions. We then propose a \textbf{r}obust \textbf{E}-AMoD \textbf{Ba}lancing \textbf{MA}RL (REBAMA) algorithm to train a robust EAVs balancing policy to balance both the supply-demand ratio and charging utilization rate across the whole city. Experiments show that our proposed robust method performs better compared with a non-robust MARL method that does not consider state uncertainties; it improves the reward, charging utilization fairness, and supply-demand fairness by 19.28\%, 28.18\%, and 3.97\%, respectively. Compared with a robust optimization-based method, the proposed MARL algorithm can improve the reward, charging utilization fairness, and supply-demand fairness by 8.21\%, 8.29\%, and 9.42\%, respectively.
\end{abstract}

\section{Introduction}
\input{sec_001_intro}

\section{Related Work}
\label{sec:related_work}
\input{sec_002_related_work}

\section{Robust Multi-Agent Reinforcement Learning Framework for E-AMoD Balancing}
\label{sec:formulation}
\input{sec_003_formulation}

\section{Algorithm}
\label{sec: algrithm}
\input{sec_004_algorithm}

\section{Experiment}
\label{sec: experiment}
\input{sec_005_exp}

\section{Conclusion}
\label{sec:conclusion}
Electric autonomous vehicles (EAVs) are playing important roles in future autonomous mobility-on-demand (AMoD) systems. However, it remains challenging to address E-AMoD system's state uncertainties caused by EAVs' unique charging patterns and AMoD systems' mobility demand in algorithm design. In this work, we design a robust MARL framework to balance mobility supply-demand ratio and charging utilization rate for E-AMoD systems under EAV supply and mobility demand uncertainties. The mobility demand and EAV supply uncertainties are captured by adversarial agents that can cause state uncertainties during the training process. We then design a REMABA algorithm with Dykstra's projection and policy regression. Experiments show that our proposed robust algorithm performs better in terms of reward, increases charging utilization fairness and supply-demand fairness by 19.28\%, 28.18\%, and 3.97\%, respectively, compared with non-robust MARL-based methods that ignore system uncertainties. Compared with a robust optimization-based method, the proposed MARL algorithm can increase reward, charging utilization fairness and supply-demand fairness by 8.21\%, 8.29\%, and 9.42\%, respectively.

\bibliographystyle{ieeetr} 
\bibliography{sample}

\end{document}
