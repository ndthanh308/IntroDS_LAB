\documentclass[dvipsnames,11pt]{article}
%\pdfoutput=1

\usepackage{amsmath,amssymb,amsthm,bm,color,mathrsfs,extarrows,mathtools,enumitem,fancybox,makecell}
\usepackage[square,sort,comma,numbers]{natbib}
\usepackage{subcaption}
\usepackage[margin=1.in]{geometry}
\usepackage{xcolor,bbm}
\usepackage[pagebackref]{hyperref}
\usepackage{bm}
\usepackage{bbm}
\usepackage{comment}
\allowdisplaybreaks
\newif\ifsubmit   

\usepackage[normalem]{ulem}

\setlist[itemize]{itemsep=0pt}
\setlist[enumerate]{itemsep=0pt}
\hypersetup{colorlinks=true,urlcolor=blue,linkcolor=blue,citecolor=[rgb]{.42,.56,.14},}
\def\UrlBreaks{\do\A\do\B\do\C\do\D\do\E\do\F\do\G\do\H\do\I\do\J\do\K\do\L\do\M\do\N\do\O\do\P\do\Q\do\R\do\S\do\T\do\U\do\V\do\W\do\X\do\Y\do\Z\do\[\do\\\do\]\do\^\do\_\do\`\do\a\do\b\do\c\do\d\do\e\do\f\do\g\do\h\do\i\do\j\do\k\do\l\do\m\do\n\do\o\do\p\do\q\do\r\do\s\do\t\do\u\do\v\do\w\do\x\do\y\do\z\do\0\do\1\do\2\do\3\do\4\do\5\do\6\do\7\do\8\do\9\do\.\do\@\do\\\do\/\do\!\do\_\do\|\do\;\do\>\do\]\do\)\do\,\do\?\do\'\do+\do\=\do\#}
\usepackage[mathcal]{eucal}

\usepackage[capitalise,nameinlink]{cleveref}
\Crefname{lemma}{Lemma}{Lemmas}
\Crefname{fact}{Fact}{Facts}
%\newtheorem{remark}[Remark]{Remark}
\Crefname{theorem}{Theorem}{Theorems}
\Crefname{corollary}{Corollary}{Corollaries}
\Crefname{claim}{Claim}{Claims}
\Crefname{example}{Example}{Examples}
\Crefname{problem}{Problem}{Problems}
\Crefname{definition}{Definition}{Definitions}
\Crefname{notation}{Notation}{Notations}
\Crefname{assumption}{Assumption}{Assumptions}
\Crefname{subsection}{Subsection}{Subsections}
\Crefname{section}{Section}{Sections}
\Crefformat{equation}{(#2#1#3)}

\newtheorem{theorem}{Theorem}[section]
\newtheorem*{theorem*}{Theorem}
\newtheorem{itheorem}{Theorem}

\newtheorem{subclaim}{Claim}[theorem]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem*{proposition*}{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem*{lemma*}{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem*{corollary*}{Corollary}
\newtheorem*{conjecture*}{Conjecture}
\newtheorem{fact}[theorem]{Fact}
\newtheorem*{fact*}{Fact}
\newtheorem{exercise}[theorem]{Exercise}
\newtheorem*{exercise*}{Exercise}
\newtheorem{hypothesis}[theorem]{Hypothesis}
\newtheorem*{hypothesis*}{Hypothesis}
\newtheorem{conjecture}[theorem]{Conjecture}

\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{notation}[theorem]{Notation}
\newtheorem{construction}[theorem]{Construction}
\newtheorem{example}[theorem]{Example}
\newtheorem{question}[theorem]{Question}
\newtheorem{openquestion}[theorem]{Open Question}
% \newtheorem{algorithm}[theorem]{Algorithm}
\newtheorem{problem}[theorem]{Problem}
\newtheorem{protocol}[theorem]{Protocol}
\newtheorem{assumption}[theorem]{Assumption}
\newtheorem{claim}[theorem]{Claim}
\newtheorem*{claim*}{Claim}

\newtheorem{remark}[theorem]{Remark}
\newtheorem*{remark*}{Remark}
\newtheorem{observation}[theorem]{Observation}
\newtheorem*{observation*}{Observation}
\numberwithin{equation}{section}

\newcommand{\sd}[1]{\mathrm{d}#1}
\DeclareMathOperator*{\E}{\mathbb E}
\DeclareMathOperator*{\Var}{\mathrm{Var}}
\DeclareMathOperator*{\Cov}{\mathrm{Cov}}
\DeclareMathOperator*{\argmax}{\arg\,\max}
\DeclareMathOperator*{\argmin}{\arg\,\min}
\renewcommand{\Pr}{\operatorname*{\mathbf{Pr}}}
\newcommand{\questioneq}{\stackrel{?}{=}}

\newcommand{\eps}{\varepsilon}
\newcommand{\abs}[1]{\left| #1 \right|}
\newcommand{\vabs}[1]{\left\| #1 \right\|}
\newcommand{\abra}[1]{\left\langle #1 \right\rangle}
\newcommand{\sabra}[1]{\langle #1 \rangle}
\newcommand{\pbra}[1]{\left( #1 \right)}
\newcommand{\sbra}[1]{\left[ #1 \right]}
\newcommand{\cbra}[1]{\left\{ #1 \right\}}
\newcommand{\ceilbra}[1]{\left\lceil #1 \right\rceil}
\newcommand{\floorbra}[1]{\left\lfloor #1 \right\rfloor}
\newcommand{\braket}[2]{\left\langle #1 \mid #2\right\rangle}
\renewcommand{\mid}{\,\middle\vert\,}
\newcommand{\bin}{\{0,1\}}
\newcommand{\binpm}{\{\pm1\}}
\newcommand{\binTF}{\{\mathrm{True},\mathrm{False}\}}
\newcommand{\binBT}{\{\bot,\top\}}
\newcommand{\True}{\mathsf{True}}
\newcommand{\False}{\mathsf{False}}
\newcommand{\TVdist}{d_{\mathrm{TV}}}
\newcommand{\dist}{\mathrm{dist}}
\newcommand{\poly}{\mathrm{poly}}
\newcommand{\polylog}{\mathrm{polylog}}
\newcommand{\sgn}{\mathrm{sgn}}
\newcommand{\indicator}{\mathbf{1}}
\newcommand{\KL}{\mathrm{KL}}
\newcommand{\id}{\mathrm{id}}
\newcommand{\unit}{\mathrm{unit}}
\newcommand{\frob}[1]{\vabs{#1}}
\newcommand{\SendReal}{\mathrm{trunc}}
\newcommand{\opnorm}[1]{\vabs{#1}_\mathrm{op}}
\newcommand{\Forr}{\mathrm{Forr}}
\newcommand{\com}{\mu}
\newcommand{\comtwo}{\sigma}

\makeatletter
\newcommand*\bigcdot{\mathpalette\bigcdot@{.5}}
\newcommand*\bigcdot@[2]{\mathbin{{\hbox{\scalebox{#2}{$\m@th#1\bullet$}}}}}
\makeatother

\newcommand{\tensor}{\overset{\bigcdot}{\otimes}}

\newcommand{\Cbb}{\mathbb{C}}
\newcommand{\Fbb}{\mathbb{F}}
\newcommand{\Nbb}{\mathbb{N}}
\newcommand{\Rbb}{\mathbb{R}}
\newcommand{\Sbb}{\mathbb{S}}
\newcommand{\Zbb}{\mathbb{Z}}

\newcommand{\Acal}{\mathcal{A}}
\newcommand{\Bcal}{\mathcal{B}}
\newcommand{\Ccal}{\mathcal{C}}
\newcommand{\Dcal}{\mathcal{D}}
\newcommand{\Ecal}{\mathcal{E}}
\newcommand{\Fcal}{\mathcal{F}}
\newcommand{\Gcal}{\mathcal{G}}
\newcommand{\Hcal}{\mathcal{H}}
\newcommand{\Ical}{\mathcal{I}}
\newcommand{\Lcal}{\mathcal{L}}
\newcommand{\Mcal}{\mathcal{M}}
\newcommand{\Ncal}{\mathcal{N}}
\newcommand{\Ocal}{\mathcal{O}}
\newcommand{\Pcal}{\mathcal{P}}
\newcommand{\Qcal}{\mathcal{Q}}
\newcommand{\Rcal}{\mathcal{R}}
\newcommand{\Scal}{\mathcal{S}}
\newcommand{\Tcal}{\mathcal{T}}
\newcommand{\Ucal}{\unif}
\newcommand{\Vcal}{\mathcal{V}}
\newcommand{\Xcal}{\mathcal{X}}
\newcommand{\Zcal}{\mathcal{Z}}

\newcommand{\Fsf}{\mathsf{F}}
\newcommand{\Psf}{\mathsf{P}}
\newcommand{\Tsf}{\mathsf{T}}
\newcommand{\Wsf}{\mathsf{W}}

\newcommand{\rbm}{\bm{r}}
\newcommand{\xbm}{\bm{x}}
\newcommand{\ybm}{\bm{y}}
\newcommand{\zbm}{\bm{z}}

\newcommand{\Sbm}{\bm{S}}
\newcommand{\Tbm}{\bm{T}}
\newcommand{\Vbm}{\bm{V}}
\newcommand{\Ubm}{\bm{U}}

\usepackage{braket}

%\newcommand{\kewen}[1]{\authnote{Kewen}{#1}{red}}
%\newcommand{\mnote}[1]{\authnote{Makrand}{#1}{teal}}
%\newcommand{\uma}[1]{\authnote{Uma}{#1}{purple}}
%\newcommand{\avishay}[1]{\authnote{Avishay}{#1}{orange}}

\renewcommand{\tilde}{\widetilde}
\renewcommand{\bar}{\overline}
\renewcommand{\hat}{\widehat}

\newcommand{\supp}{\mathrm{supp}}
\newcommand{\rel}{\mathrm{rel}}
\newcommand{\dkl}{d_{\mathrm{KL}}}

\newcommand{\N}{\mathbb{N}}
\newcommand{\X}{\bm{X}}
\newcommand{\Y}{\bm{Y}}
\newcommand{\Z}{\bm{Z}}
\newcommand{\A}{\bm{A}}
\newcommand{\B}{\bm{B}}
\newcommand{\U}{\bm{u}}
\newcommand{\V}{\bm{v}}
%\newcommand{\u}{\bm{u}}
%\newcommand{\v}{\bm{v}}
\newcommand{\bmR}{\bm{R}}
\newcommand{\D}{\bm{d}}
\newcommand{\balpha}{\bm{\beta}}
\newcommand{\bmL}{\bm{L}}
\newcommand{\Q}{\bm{Q}}
\newcommand{\bmP}{\bm{P}}
\newcommand{\lX}{\bm{x}}
\newcommand{\lY}{\bm{y}}
\newcommand{\lZ}{\bm{z}}
\newcommand{\lA}{\bm{a}}
\newcommand{\lB}{\bm{b}}
\newcommand{\bell}{\bm{\ell}}
\newcommand{\la}{\lA}
\newcommand{\lb}{\lB}
\newcommand{\lc}{\bm{c}}
\newcommand{\lx}{\lX}
\newcommand{\ly}{\lY}
\newcommand{\lz}{\lZ}
\newcommand{\lQ}{\bm{q}}
%\newcommand{\lq}{\bm{q}}
\newcommand{\lP}{\bm{p}}
\newcommand{\lp}{\bm{p}}
\newcommand{\btau}{\bm{\tau}}
%\newcommand{\d}{\D}

\newcommand{\midd}{~\vert~}

\newcommand{\pmones}{\{\pm1\}^n}
\newcommand{\pmone}{\{\pm1\}}
\newcommand{\unif}{\nu}
\newcommand{\BE}{\E}
\newcommand{\supA}[1]{\A^{(#1)}}
\newcommand{\supB}[1]{\B^{(#1)}}
\newcommand{\supu}[1]{\bm{u}^{(#1)}}
\newcommand{\supU}[1]{\bm{U}^{(#1)}}
\newcommand{\supv}[1]{\bm{v}^{(#1)}}
\newcommand{\supV}[1]{\bm{V}^{(#1)}}
\newcommand{\supa}[1]{\lA^{(#1)}}
\newcommand{\supb}[1]{\lB^{(#1)}}
\newcommand{\supcbar}[1]{\bar\lc^{(#1)}}
\newcommand{\supX}[1]{\X^{(#1)}}
\newcommand{\supY}[1]{\Y^{(#1)}}
\newcommand{\supZ}[1]{\lZ^{(#1)}}
\newcommand{\supR}[1]{\bmR^{(#1)}}
\newcommand{\supF}[1]{\Fcal^{(#1)}}
\newcommand{\F}{\mathcal{F}}
\newcommand{\ip}[2]{\abra{#1, #2}}
\newcommand{\R}{\mathbb{R}}
\renewcommand{\Lambda}{\eta}
\newcommand{\ind}{\mathbf{1}}

\newcommand{\BH}{\bm{H}}
\newcommand{\bPi}{\bm{\Pi}}
\newcommand{\bP}{\bm{p}}
\renewcommand{\Q}{\bm{q}}
\newcommand{\bQ}{\bm{q}}
\newcommand{\K}{\bm{k}}
\newcommand{\lw}{\bm{w}}
\newcommand{\bc}{\bm{c}}
\newcommand{\br}{\bm{r}}
\newcommand{\bs}{\bm{s}}
\newcommand{\Xell}{\X_{\bell}}
\newcommand{\Yell}{\Y_{\bell}}

\newcommand{\biased}[1]{\pi^{\otimes n}_{#1}}

\usepackage{xspace}
\newcommand{\complexityclass}[1]{{\bf{#1}}\xspace}
\renewcommand{\P}{\complexityclass{P}}
\newcommand{\NP}{\complexityclass{NP}}
\newcommand{\Ppoly}{\complexityclass{P/\mathsf{poly}}}
\newcommand{\CONP}{\complexityclass{coNP}}
\newcommand{\BPP}{\complexityclass{BPP}}
\newcommand{\BQP}{\complexityclass{BQP}}
\newcommand{\PSPACE}{\complexityclass{PSPACE}}
\newcommand{\flift}{f\circ{g}}

\newcommand{\Goos}{G\"{o}\"{o}s\xspace}

\title{Fourier Growth of Communication Protocols for XOR Functions}
%Old title: XOR-Lifting and Fourier Growth of Communication Protocols
\author{
Uma Girish\thanks{Princeton University. Email: \texttt{ugirish@cs.princeton.edu}}
\and
Makrand Sinha\thanks{Simons Institute and University of California at Berkeley. Email: \texttt{makrand@berkeley.edu}}
\and
Avishay Tal\thanks{University of California at Berkeley. Email: \texttt{atal@berkeley.edu}}
\and
Kewen Wu\thanks{University of California at Berkeley. Email: \texttt{shlw\_kevin@hotmail.com}}
}
\date{}

\begin{document}
\maketitle

\begin{abstract}
The level-$k$ $\ell_1$-Fourier weight of a Boolean function refers to the sum of absolute values of its level-$k$ Fourier coefficients. Fourier growth refers to the growth of these weights as $k$ grows.
It has been extensively studied for various computational models, and bounds on the Fourier growth, even for the first few levels, have proven useful in learning theory, circuit lower bounds, pseudorandomness, and quantum-classical separations.

In this work, we investigate the Fourier growth of certain functions that naturally arise from communication protocols for XOR functions (partial functions evaluated on the bitwise XOR of the inputs $x$ and $y$ to Alice and Bob). If a protocol $\mathcal{C}$ computes an XOR function, then $\mathcal{C}(x, y)$ is a function of the parity $x \oplus y$. This motivates us to analyze the \textit{XOR-fiber} of the communication protocol $\mathcal{C}$, defined as $h(z) := \mathbb{E}_{\bm{x},\bm{y}}[\mathcal{C}(\bm{x}, \bm{y}) | \bm{x}\oplus \bm{y} = z]$.

We present improved Fourier growth bounds for the XOR-fibers of randomized protocols that communicate $d$ bits. For the first level, we show a tight $O(\sqrt{d})$ bound and obtain a new coin theorem, as well as an alternative proof for the tight randomized communication lower bound for the Gap-Hamming problem. For the second level, we show an $d^{3/2} \cdot \polylog(n)$ bound, which improves the previous $O(d^2)$ bound by Girish, Raz, and Tal (ITCS 2021) and implies a polynomial improvement on the randomized communication lower bound for the XOR-lift of the Forrelation problem, which extends the quantum-classical gap for this problem.

Our analysis is based on a new way of adaptively partitioning a relatively large set in Gaussian space to control its moments in all directions. We achieve this via martingale arguments and allowing protocols to transmit real values. We also show a connection between Fourier growth and lifting theorems with constant-sized gadgets as a potential approach to prove optimal bounds for the second level and beyond.
\end{abstract}


% STOC submission Abstract:
%Motivated by new separations between quantum and randomized communication complexity, we study the Fourier growth of Boolean functions associated with communication protocols. Suppose Alice and Bob want to compute some (partial) function $f$ on the bit-wise XOR of their inputs by exchanging as few bits as possible. Let $\mathcal{C}(x,y)$ be the value that their communication protocol yields on inputs $x$ and $y$, respectively. If $\mathcal{C}$ computes $f$, then $\mathcal{C}(x, y) = f(x\oplus y)$ on every $x, y$ for which $f(x \oplus y)$ is defined. This gives a natural motivation to analyze the \textit{XOR-fiber} of the communication protocol $\mathcal{C}$, defined as $h(z) := \mathbb{E}_{\bm{x},\bm{y}}[\mathcal{C}(\bm{x}, \bm{y}) | \bm{x}\oplus \bm{y} = z]$.

%Recent work by Girish, Raz, and Tal (ITCS 2021) showed that when the function $f$ is the Forrelation problem:
%\begin{itemize}
%\item A simultaneous-message quantum protocol exists with communication cost $\mathrm{polylog}(n)$ where each player implements an efficient quantum circuit of size $\mathrm{polylog}(n)$.
%\item Any randomized protocol requires communication complexity $\tilde{\Omega}(n^{1/4})$.
%\end{itemize}
%The randomized communication complexity lower bound was achieved via Fourier analysis of the XOR-fibers of randomized protocols with communication cost at most $d$. However, the analysis was not known to be tight, with a potential quadratic improvement to the lower bound  (that would match a simple $\tilde{O}(\sqrt{n})$ upper bound).

%In this work, we obtain improved $\ell_1$-Fourier growth bounds for the XOR-fibers of randomized protocols of cost $d$:
%\begin{enumerate}
%\item For the first Fourier level, we show a tight $O(\sqrt{d})$ bound. This implies a new coin theorem, and an alternative proof for the celebrated $\Omega(n)$ randomized communication lower bound on the Gap-Hamming problem by Chakrabarti and Regev (SICOMP 2012).
%\item For the second Fourier level, we show a $d^{3/2} \cdot \mathrm{polylog}(n)$ bound, improving the previous $O(d^2)$ bound. This implies that the randomized communication complexity for the Forrelation problem is $\tilde{\Omega}(n^{1/3})$.
%\end{enumerate}
%We believe our second-level bound can be further improved (to $d \cdot \mathrm{polylog}(n)$) and highlight some directions towards such an improvement --- one of which is via a connection to lifting with constant-sized gadgets.

%%% Version one %%%%
% Fourier growth of a function captures how the sum of absolute values of its level-$k$ Fourier coefficients scales with $k$ and has been well-studied for various computational models. $\ell_1$-Fourier weight bounds even for low Fourier levels have seen a variety of applications in learning theory, circuit lower bounds, pseudorandomness and quantum-classical separations.\\
% %Let $\mathcal{C}(x,y)$ be the value that their communication protocol yields on inputs $x$ and $y$, respectively. 

% In this work, we study the Fourier growth of certain functions that naturally arise from communication protocols for XOR functions --- a (partial) function $f$ evaluated on the bit-wise XOR of the inputs to Alice and Bob. If a protocol $\mathcal{C}$ computes an XOR function $f$, then $\mathcal{C}(x, y) = f(x\oplus y)$ on every $x, y$ for which $f(x \oplus y)$ is defined. This gives a natural motivation to analyze the \textit{XOR-fiber} of the communication protocol $\mathcal{C}$, defined as
%  $h(z) := \mathbb{E}_{\bm{x},\bm{y}}[\mathcal{C}(\bm{x}, \bm{y}) | \bm{x}\oplus \bm{y} = z]$.\\

% We obtain improved $\ell_1$-Fourier growth bounds for the XOR-fibers of randomized
% protocols that communicate $d$ bits:
% \begin{itemize}
%     \item For the first Fourier level, we show a tight $O(\sqrt{d})$ bound. As level-one Fourier bounds related to correlation with the majority function, we obtain new coin theorem, and a new alternative proof for the tight randomized lower bound for the well-studied Gap-Hamming problem as a byproduct.
% \item For the second Fourier level, we show a $d^{3/2} \cdot \mathrm{polylog}(n)$ bound, improving the previous $O(d^2)$ bound (Girish,Raz,Tal ITCS 2021). As a byproduct, we obtain that the randomized communication complexity for the Forrelation problem is $\Omega(n^1/3)$, polynomially improving the previous bound.
% \end{itemize}



% Our analysis is based on a new adaptive process to partition a relatively-large set in Gaussian space so that its moments are well-behaved in all directions and we achieve this via martingale arguments and communication protocols that communicate real values. We believe our level-$2$ bound can be further improved and highlight some directions towards such an improvement --- one of which is via a connection to lifting with constant-sized gadgets.\\


%%%%% version one end 

%%%% version zero start

% The \textit{level-$k$ $\ell_1$-Fourier weight} of a (partial) boolean function is the sum of absolute values of its level-$k$ Fourier coefficients. 
% Small Fourier growth implies efficient learning algorithms, simple pseudorandom generators, and separations between classical and quantum computational models.
% \kewen{make a point that low levels are important already}

% \mnote{Make a point that XOR functions are well-studied and connect it to Avishay's motivation for XOR fiber.}
% In this work, we prove Fourier growth bounds for XOR functions in communication complexity.

% Let $\mathcal{C}$ be a classical two-party communication protocol.
% We say $\mathcal{C}$ is the \textit{XOR function} of $f$ if $\mathcal{C}(x,y)=f(x\oplus y)$ on every $x,y$ for which $f(x\oplus y)$ is defined.
% For $k\in\{1,2\}$, we bound the level-$k$ Fourier growth of $f$ when $\mathcal C$ has low cost.
% In fact, our results hold more generally for an arbitrary protocol $\mathcal{C}$ and its \textit{XOR-fiber} $f(z):=\mathbb{E}_{\bm{x},\bm{y}}[\mathcal{C}(\bm x,\bm y)|\bm x\oplus\bm y=z]$.

% As applications, our level-$1$ bound implies a new coin theorem and an alternative proof for the randomized communication lower bound on the Gap-Hamming problem.
% Our level-$2$ bound implies that the randomized communication complexity for the Forrelation problem is $\tilde{\Omega}(n^{1/3})$, improving the previous $\tilde{\Omega}(n^{1/4})$ bound (Girish-Raz-Tal ITCS'21).

% Our analysis relies on  martingale arguments on the communication protocol tree and geometric analysis in Gaussian spaces.

% We believe our level-$2$ bound can be further improved and highlight some directions towards such an improvement --- one of which is via a connection to lifting with constant-sized gadgets.

%%% Old version end


% \mnote{Some ideas for the introduction:
% \begin{itemize}
%     \item Start with Fourier growth and its applications such as pseudorandomness and separations.
%     \item Discuss how to bound Fourier growth and the importance of exploiting cancellations, using decision trees and parity decision trees as examples. Move PDT paragraph on pg 5 here.
%     \item Introduce XOR-fibers of communication protocols, highlighting their unique challenges compared to the PDT case.
%     \item Emphasize the main contribution of the Fourier growth results. Move applications to Gap Hamming, Lifted Forrelation, and k-fold Forrelation, and Lifting with constant-sized gadgets a separate section.
%     \item Change pairwise independence with isotropy and geometric arguments in the proof overview and ensure consistency later in the proofs.
% \end{itemize}
% }

\newpage 
\tableofcontents
\thispagestyle{empty}
\newpage
\setcounter{page}{1}

%\input{intro.tex}
\input{intro.tex}
\input{overview.tex}
\input{prelim.tex}
\input{setup.tex}
\input{level-one.tex}
\input{level-two.tex}
\input{gadget.tex}
\input{future.tex}

\bibliographystyle{alpha} 
\bibliography{ref}

\input{appendix.tex}

\end{document}