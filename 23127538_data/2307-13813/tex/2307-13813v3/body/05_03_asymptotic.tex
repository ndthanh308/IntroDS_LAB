\subsection{Limiting behavior of Polyak-Ruppert averaging}
\label{app:asymptoticAnalysis}
Here we sketch the asymptotic behavior of a target model $\rtheta$ and its \gls{ema} $\rzeta$.
Let us assume that $\rtheta$ converges to the stationary distribution $\lim_{t\to\infty}\rtheta_t=\rtheta^*$, $\rtheta^*\sim p_{\infty}(\rtheta)$.
We are interested in statistical properties of $\rzeta^*=\lim_{t\to\infty}\rzeta_t$,
as this will formalize the notion of how the \gls{ema} depends on the a time-horizon defined by its momentum $\rho$ as discussed in \Cref{tab:different-ema}.

As a warm-up, for $n$ independent random variables $\rx_1,\ldots,\rx_2$, we know that the sample mean $\bar x=\frac1n(x_1,x_2,\ldots,x_n)$
has the statistical properties
\begin{align}
    \E[\bar x]
    &=\mu,
    &
    \Var[\bar x]
    &=
    \frac{\sigma^2}{n},
    \label{eq:sum-rvs-1}
\end{align}
where $\mu$ and $\sigma$ are the population mean and variance.
This gives us an idea of what to expect.
As we will now show,
the expectation of $\rzeta^*$ should have no time-horizon dependence, whereas the variance of $\rzeta^*$ will depend on its time horizon (i.e. the number of samples it integrates over) which is defined by $\rho$.

In the case of a weighted sum
\begin{align}
    \bar x^{(w)}
    &=\sum_{i=1}^nw_i\,x_i,
\end{align}
then if the $x_i$ are \gls{iid}, then
\begin{align}
    \E[\bar x^{(w)}]
    &=\sum_{i=1}^nw_i\,\E[x_i]
    =n\,\bar w\,\mu,
    &
    \bar w
    &=
    \frac 1n\sum_{i=1}^nw_i,
    \label{eq:app-mean-iid}
\end{align}
and for the variance \citep{KishDesignEffect}
\begin{align}
    \Var[\bar x^{(w)}]
    &=
    n
    \cdot
    \widebar{w^2}
    \cdot
    \sigma^2
    &
    \widebar{w^2}
    &=
    \frac1n\sum_{i=1}^nw_i^2,
    &
    \sigma^2
    &=
    \Var[x_i].
\end{align}
We can verify that we reproduce the well-known result in \Cref{eq:sum-rvs-1} in the case where all weights are equal to $\frac{1}{n}$ as follows
\begin{equation}
    \forall i: w_i=\frac1n 
    \implies
    \widebar{w^2}=
    \frac{1}{n}
    \cdot
    \sum_{i = 1}^n
    \inParentheses{\frac{1}{n}}^2
    =
    \frac{1}{n^2}
    \implies
    \Var[\bar x^{(w)}]
    =
    n\cdot
    \frac{1}{n^2}
    \cdot
    \sigma^2
    =
    \frac{\sigma^2}{n}.
\end{equation}
In the case of an exponential moving average we have
    \begin{equation}
    \rzeta_{t+1}
    =
    \rho \,\rzeta_{t}
    +
    (1-\rho)\,\rtheta_{t}
    =
    \rho^t \,\rzeta_{1}
    +
    (1-\rho)
    \sum_{i=0}^{t-1}
    \rho^{i}
    \rtheta_{t-i}.
\end{equation}
Let's consider the specific case where we are at iteration $k$ which is sufficiently large that $\rzeta$ and $\rtheta$ have converged to their stationary distributions.
From $k$, the iterations unfold as
    \begin{equation}
    \rzeta_{t+1}
    =
    \rho^{t+1-k} \,\rzeta_{k}
    +
    (1-\rho)
    \sum_{i=0}^{t-k}
    \rho^{i}
    \rtheta_{t-i}.
\end{equation}
We rearrange for terms in $\rzeta$
\begin{align}
    \rzeta_{t+1}
    -\rho^{t+1-k}\,\rzeta_k
    =
    (1-\rho)
    \sum_{i=0}^{t-k}
    \rho^{i}\,
    \rtheta_{t-i},
    \label{eq:app-zeta-arranged}
\end{align}
and before proceeding to the final result, using $n=t+1-k$, we compute the convenient quantities
\begin{align}
    \bar\rho
    &=\frac1{n}\sum_{i=0}^{n-1}\rho^i
    =\frac1{n}\times\frac{1-\rho^n}{1-\rho}\\
    \widebar{\rho^2}
    &=\frac1{n}\sum_{i=0}^{n-1}\rho^{2i}
    =\frac1{n}\times\frac{1-\rho^{2n}}{1-\rho^2}.
\end{align}
Taking expectation of \Cref{eq:app-zeta-arranged} and setting statistics to their stationary values, we have
\begin{align}
    (1-\rho^{n})\,\E[\rzeta^*]
    =
    (1-\rho)\,n\,\bar\rho\,\E[\rtheta^*]=
    (1-\rho^n)\,\E[\rtheta^*],
\end{align}
where we have used the result in \Cref{eq:app-mean-iid}.
It follows that for $\rho\neq 1$ we have
\begin{align}
    \E[\rzeta^*]=\E[\rtheta^*],
\end{align}
independent of $\rho$.
Finally, we can take the variance of \Cref{eq:app-zeta-arranged}.
First the left hand side
\begin{align}
    \Var\left[
    \rzeta_{t+1}
    -\rho^{n}\,\rzeta_k\right]
    =
    \Var\left[
    \rzeta_{t+1}\right]
    +
    \rho^{2n}\,
    \Var\left[\rzeta_k\right]
    =
    \left(1+\rho^{2n}\right)\,\Var\left[\rzeta^*\right].
\end{align}
Next the right hand side
\begin{align}
    \Var\left[
    (1-\rho)
    \sum_{i=0}^{n-1}
    \rho^{i}\,
    \rtheta_{t-i}
    \right]
    =
    (1-\rho)^2
    \,
    \Var\left[
    \sum_{i=0}^{n-1}
    \rho^{i}\,
    \rtheta_{t-i}
    \right]
    =
    (1-\rho)^2
    \cdot
    \inParentheses{
        \frac{1 - \rho^{2n}}{1 - \rho^2}
    }
    \cdot
    {\Var[\rtheta^*]}
    .
\end{align}
Finally,
equating left and right hand sizes and rearranging for $\Var[\rzeta^*]$ gives
\begin{align}
    \Var\left[\rzeta^*\right]
    =
    \frac{1 - \rho^{2n}}{1 + \rho^{2n}}
    \cdot
    \frac{1 - \rho}{1 + \rho}
    \cdot
    \Var\left[\rtheta^*\right]
    \label{eq:app-var-zeta}
\end{align}
In the limit $t\to\infty$, the momentum-dependent prefactor becomes
\begin{align}
    \lim_{t\to\infty}
    \inParentheses{
        \frac{1 - \rho^{2n}}{1 + \rho^{2n}}
        \cdot
        \frac{1 - \rho}{1 + \rho}
    }
    &=
    \frac{1-\rho}{1+\rho}
    \implies
    \lim_{t\to\infty}
    \Var\left[\rzeta^*\right]
    =
    \frac{1-\rho}{1+\rho}
    \cdot
    \Var\left[\rtheta^*\right].
    \label{eq:app-var-zeta-prefactor}
\end{align}
\Cref{eq:app-var-zeta,eq:app-var-zeta-prefactor} validate our intuition.
When $\rho\rightarrow0$, then $\rzeta$ behaves like $\rtheta$ independent of $T$, with their variance and expectation matching.
When $\rho>0$, the momentum-dependent prefactor serves as an aggregator over the history when $t$ is sufficiently large compared to $k$, reducing the variance $\Var[\zeta^*]$ but preserving its expectation.
This formalizes the notion of time horizon discussed in \Cref{tab:different-ema}.


