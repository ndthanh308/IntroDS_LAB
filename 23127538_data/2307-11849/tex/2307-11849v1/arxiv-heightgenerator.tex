\documentclass{amsart}
%submitted to arxiv on Jul 21, 2023.
%\setlength{\textheight}{43pc} changes to produce (16) which is now the most recent "final version".
%\setlength{\textwidth}{28pc}
%\usepackage{hyperref}
\usepackage{amssymb, latexsym}
\usepackage{url}

\DeclareMathOperator{\Aut}{\mathrm Aut}
\DeclareMathOperator{\CM}{\mathrm CM}
\DeclareMathOperator{\End}{\mathrm End}
\DeclareMathOperator{\GL}{\mathrm GL}
\DeclareMathOperator{\Hom}{\mathrm Hom}
\DeclareMathOperator{\closure}{\mathrm closure}
\DeclareMathOperator{\Norm}{\mathrm Norm}
\DeclareMathOperator{\Null}{\mathrm Null}
\DeclareMathOperator{\Imm}{\mathrm Im}
\DeclareMathOperator{\rank}{\mathrm rank}
\DeclareMathOperator{\Reg}{\mathrm Reg}
\DeclareMathOperator{\sgn}{\mathrm sgn}
\DeclareMathOperator{\supp}{\mathrm supp}
\DeclareMathOperator{\Tor}{\mathrm Tor}
\DeclareMathOperator{\trace}{\mathrm trace}
\DeclareMathOperator{\Vol}{\mathrm Vol}
\DeclareMathOperator{\ord}{\mathrm ord}

\begin{document}
 \bibliographystyle{plain}

 \newtheorem{theorem}{Theorem}[section]
 \newtheorem{lemma}{Lemma}[section]
 \newtheorem{corollary}{Corollary}[section]
 \newtheorem{conjecture}{Conjecture}[section]
 \newtheorem{question}{Question}[section]
 \newcommand{\mc}{\mathcal}
 \newcommand{\mbb}{\mathbb}
 \newcommand{\fA}{\mathfrak A}
 \newcommand{\B}{\mc B}
 \newcommand{\fB}{\mathfrak B}
 \newcommand{\cC}{\mc C}
 \newcommand{\D}{\mc D}
 \newcommand{\E}{\mc E}
 \newcommand{\F}{\mc F}
 \newcommand{\G}{\mc G}
 \newcommand{\fG}{\mathfrak G}
 \newcommand{\fI}{\mathfrak I}
 \newcommand{\I}{\mc I}
 \newcommand{\J}{\mc J}
 \newcommand{\K}{\mc K}
 \newcommand{\lL}{\mc L}
 \newcommand{\M}{\mc M}
 \newcommand{\fM}{\mathfrak M}
 \newcommand{\pp}{\mc P}
 \newcommand{\fP}{\mathfrak P}
 \newcommand{\fR}{\mathfrak R}
 \newcommand{\rR}{\mc R}
 \newcommand{\fS}{\mathfrak S}
 \newcommand{\sS}{\mc S}
 \newcommand{\U}{\mc U}
 \newcommand{\uU}{\mathfrak U}
 \newcommand{\X}{\mc X}
 \newcommand{\Y}{\mc Y}
 \newcommand{\A}{\mathbb{A}}
 \newcommand{\C}{\mathbb{C}}
 \newcommand{\pP}{\mathbb{P}}
 \newcommand{\Q}{\mathbb Q}
 \newcommand{\R}{\mathbb R}
 \newcommand{\T}{\mathbb T}
 \newcommand{\Z}{\mathbb{Z}}
 \newcommand{\ahat}{\widehat\alpha}
 \newcommand{\bhat}{\widehat\beta}
 \newcommand{\fhat}{\widehat f}
 \newcommand{\ghat}{\widehat g}
 \newcommand{\hhat}{\widehat h}
 \newcommand{\wsigma}{\widetilde{\sigma}}
 \newcommand{\wtau}{\widetilde{\tau}}
 \newcommand{\p}{\boldsymbol{\varphi}}
 \newcommand{\h}{\tfrac{1}{2}}
 \newcommand{\hh}{\frac{1}{2}}
 \newcommand{\ba}{\boldsymbol a}
 \newcommand{\bb}{\boldsymbol b}
 \newcommand{\be}{\boldsymbol e}
 \newcommand{\bm}{\boldsymbol m}
 \newcommand{\bn}{\boldsymbol n}
 \newcommand{\bu}{\boldsymbol u}
 \newcommand{\bv}{\boldsymbol v}
 \newcommand{\bw}{\boldsymbol w}
 \newcommand{\bx}{\boldsymbol x}
 \newcommand{\bwy}{\boldsymbol y}
 \newcommand{\bL}{\boldsymbol L}
 \newcommand{\bta}{\boldsymbol \beta}
 \newcommand{\bet}{\boldsymbol \eta}
 \newcommand{\bxi}{\boldsymbol \xi}
 \newcommand{\bo}{\boldsymbol 0}
 \newcommand{\bid}{\boldsymbol 1}
 \newcommand{\ep}{\varepsilon}
 \newcommand{\vphi}{\varphi}
 \newcommand{\dlambda}{\text{\rm d}\lambda}
 \newcommand{\dbeta}{\text{\rm d}\beta}
 \newcommand{\dmu}{\text{\rm d}\mu}
 \newcommand{\dr}{\text{\rm d}r}
 \newcommand{\du}{\text{\rm d}u}
 \newcommand{\dv}{\text{\rm d}v}
 \newcommand{\dt}{\text{\rm d}t}
 \newcommand{\dw}{\text{\rm d}w}
 \newcommand{\dx}{\text{\rm d}x}
 \newcommand{\dy}{\text{\rm d}y}
 \newcommand{\dxi}{\text{\rm d}\xi}
 \newcommand{\oQ}{\overline{\Q}}
 \newcommand{\oq}{\oQ^{\times}}
 \newcommand{\oQt}{\oQ^{\times}/\Tor\bigl(\oQ^{\times}\bigr)}
 \newcommand{\ot}{\Tor\bigl(\oQ^{\times}\bigr)}


\title[heights of generators]%{Number fields with small generators }
{A note on small generators of number fields, II}
\author{Shabnam Akhtari, Jeffrey~D.~Vaaler and Martin Widmer}
\subjclass[2020]{11H06, 11R29, 11R56}
\keywords{height, integral generators, $\CM$-fields, roots of unity}
%\thanks{Research of         supported in part by        }
\address{Department of Mathematics, Pennsylvania State University, University Park, PA 16802 USA}
\email{akhtari@psu.edu}

\address{Department of Mathematics, University of Texas, Austin, TX 78712 USA}
\email{vaaler@math.utexas.edu}

\address{Department of Mathematics, Royal Holloway, University of London, Egham, TW20 0EX UK}
\email{martin.widmer@rhul.ac.uk}

\allowdisplaybreaks
\numberwithin{equation}{section}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\begin{abstract}  Let $K$ be an algebraic number field and $H$ the absolute Weil height.  Write $c_K$ for a certain positive constant which is 
an invariant of $K$.  We consider the question: does $K$ contain an algebraic integer $\alpha$ such that both $K = \Q(\alpha)$ and 
$H(\alpha) \le c_K$?  If $K$ has a real embedding then a positive answer was established in previous work.  Here we obtain a positive 
answer if $\Tor\bigl(K^{\times}\bigr) \not= \{\pm 1\}$, and so $K$ has only complex embeddings.  We also show that if the answer is negative, 
then $K$ is a $\CM$-field and $\Tor\bigl(K^{\times}\bigr) = \{\pm 1\}$.
\end{abstract}

\maketitle
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Introduction}%%section 1

Let $K$ be an algebraic number field of degree $d = [K : \Q]$, and let $\Delta_K$ be the discriminant of $K$.  We define the positive constant
\begin{equation}\label{gen-37}
c_K = \biggl(\frac{2}{\pi}\biggr)^{s/d} \bigl|\Delta_K\bigr|^{1/2d},
\end{equation}  
where $s$ is the number of complex places of $K$.  We write $K^{\times}$ for the multiplicative group of nonzero elements of $K$, and
\begin{equation}\label{gen-30}
H : K^{\times} \rightarrow [1, \infty)
\end{equation}  
for the absolute, multiplicative Weil height.  

In \cite{ruppert1998} W.~Ruppert asked the following question:

\begin{question} {\sc [Ruppert, 1998]}\label{con1}  Does there exist a positive constant $A = A(d)$ such that if $K$ is an algebraic 
number field of degree $d$ over $\Q$, then there exists an element $\alpha$ in $K$ such that 
\begin{equation}\label{-gen23}
K = \Q(\alpha),\quad\text{and}\quad H(\alpha) \le A \bigl|\Delta_K\bigr|^{1/2d}\thinspace ?
\end{equation} 
\end{question}

Ruppert stated his question using the naive height.  However, it follows from elementary inequalities for heights that the variant we 
have stated here is equivalent to the question originally asked by Ruppert.  In \cite[Proposition 2]{ruppert1998} Ruppert obtained a positive 
answer to his question when $[K : \Q] = 2$.  He also proved that if $K$ is a real quadratic extension of $\Q$, then the generator 
$\alpha$ can be selected from the ring $O_K$ of algebraic integers in $K$.  In \cite{vaaler2013} the second and third named author provided the 
following partial answer to Ruppert's question:

\begin{theorem}\label{thmearly1}  Assume that $K$ has an embedding into $\R$.  Then there exists an algebraic integer $\alpha$ in $O_K$
such that
\begin{equation}\label{-gen13}
K = \Q(\alpha),\quad\text{and}\quad H(\alpha) \le c_K.
\end{equation}
\end{theorem}

In Theorem \ref{thmearly1} the generator $\alpha$ is an algebraic integer, a requirement that was {\it not} stated in Ruppert's question, 
while the height of $\alpha$ is bounded in a manner that was anticipated in Ruppert's question. Hence Theorem \ref{thmearly1} generalizes 
Ruppert's earlier result to number fields $K$ that have at least one real embedding. 

Let $\Tor\bigl(K^{\times}\bigr)$ denote the torsion subgroup of the multiplicative group $K^{\times}$.  This group is known to be a finite,
cyclic group of even order $2 q_K$, where $q_K$ is a positive divisor of $\Delta_K$.  Number fields $K$ with only complex 
embeddings and no real embeddings split into two disjoint subcollections: those for which $\Tor\bigl(K^{\times}\bigr) \not= \{\pm 1\}$, and those 
for which $\Tor\bigl(K^{\times}\bigr) = \{\pm 1\}$.  Plainly a number field of the first kind contains a subfield which is a nontrivial, cyclotomic 
extension of $\Q$.  In this note we prove two new results related to Ruppert's question.  

\begin{theorem}\label{thmearly2}  Assume that $K$ is a number field such that $\Tor\bigl(K^{\times}\bigr) \not= \{\pm 1\}$.  Then $K$ has only 
complex embeddings, and there exists an algebraic integer $\alpha$ in $K$ such that 
\begin{equation}\label{early20}
K = \Q(\alpha),\quad\text{and}\quad H(\alpha) \le c_K.
\end{equation}
\end{theorem}

The constructive nature of the  proof of Theorem \ref{thmearly2}  enables us to prove a stronger statement, where we can point out which number fields might not have a small integral generator. 
We recall that $K$ is a $\CM$-field if $K$ has only complex embeddings and there exists a totally real subfield $k \subseteq K$ 
such that $K/k$ is a quadratic extension.  There are well known characterizations of $\CM$-fields due to Blanksby and 
Loxton \cite{blanksby1978}, and Shimura \cite{shimura1971}.  Here we prove that a number field $K$ for which the conclusion (\ref{early20}) 
does {\it not} hold must be a $\CM$-field of a special type.

\begin{theorem}\label{thmearly3}  Let $K$ be a number field such that
\begin{equation}\label{early55}
c_K < \min\big\{H(\alpha) : \text{$\alpha \in O_K$ and $K = \Q(\alpha)$}\big\}.
\end{equation}
Then $K$ is a $\CM$-field and $\Tor\bigl(K^{\times}\bigr) = \{\pm 1\}$.
\end{theorem}


Let $m$ be a squarefree, negative integer and let $L = \Q\bigl(\sqrt{m}\bigr)$ be the imaginary quadratic field generated by $\sqrt{m}$.  It is 
obvious that $L$ is a $\CM$-field, and an integral basis for the ring $O_L$ is well known (see \cite[Theorem 7.1.1]{alaca2004}).  We also recall
(see \cite[Theorem 7.1.2]{alaca2004}) that
\begin{equation}\label{early62}
\Delta_L = \begin{cases}   m&    \text{if $m \equiv 1 \pmod 4$},\\
				       4m&    \text{if $m \not\equiv 1 \pmod 4$}.\end{cases}	
\end{equation}
It is now a simple matter to minimize the height over elements of $O_L$ that generate the field $L$.  If $m \equiv 1 \pmod 4$ we find that
\begin{equation}\label{early69}
\min\big\{H(\alpha) : \text{$\alpha \in O_L$ and $L = \Q(\alpha)$}\big\} = \h \bigl(1 + |\Delta_L|\bigr)^{\hh},
\end{equation}
and if $m \not\equiv 1 \pmod 4$ then 
\begin{equation}\label{early76}
\min\big\{H(\alpha) : \text{$\alpha \in O_L$ and $L = \Q(\alpha)$}\big\} = \h |\Delta_L|^{\hh}.
\end{equation}

Among the imaginary quadratic fields $L$, only the fields 
\begin{equation*}\label{early83}
L = \Q\bigl(\sqrt{-3})\quad \text{and}\quad L = \Q\bigl(\sqrt{-1}\bigr)
\end{equation*}
satisfy the condition $\Tor\bigl(L^{\times}\bigr) \not= \{\pm 1\}$.  These fields are both generated by a root of unity and therefore the minimal height
of an algebraic integer that generates the field is $1$.  This conclusion also follows from (\ref{early62}), (\ref{early69}), and (\ref{early76}).  

If $L = \Q\bigl(\sqrt{m}\bigr)$ satisfies $\Tor\bigl(L^{\times}\bigr) = \{\pm 1\}$ then it follows from our previous remarks that the minimum height of
an integral generator is greater than $1$.  As the value of the minimal height is given by (\ref{early69}) or by (\ref{early76}), it is easy to verify that
\begin{equation}\label{early90}
c_L = \biggl(\frac{2}{\pi}\biggr)^{1/2} \bigl|\Delta_L\bigr|^{1/4}< \min\big\{H(\alpha) : \text{$\alpha \in O_L$ and $L = \Q(\alpha)$}\big\}
\end{equation}  
in both cases.  This shows that for imaginary quadratic fields $L$ the inequality (\ref{early55}) holds if and only if $L$ satisfies
$\Tor\bigl(L^{\times}\bigr) = \{\pm 1\}$.

Next we give an example of a family of quartic number fields  which satisfy (\ref{early55}).  Let $n$ be a positive integer with
$$
n\equiv 3 \pmod 4 \quad\text{and}\quad n \not\equiv 0 \pmod 5.
$$
We consider the biquadratic field  $K=\Q(\sqrt{5},\sqrt{-n})$. From \cite[Theorem 1]{williams1970}, we conclude that
\begin{equation}\label{discW}
\Delta_K=25n^2,
\end{equation}
and   every $\alpha\in O_K$ with $K=\Q(\alpha)$ can be written in the form 
$$
\alpha=\tfrac{1}{4} \bigl(a+b \sqrt{5}+c \sqrt{-n}+d \sqrt{-5 n}\bigr),
$$
where $a,b,c,d$ are in $\Z$, and $c$ and $d$ are not both zero. 
If $d=0$ then clearly  
\begin{equation}\label{ifd0}
H(\alpha)\geq \frac{n^{1/2}}{4}.
\end{equation}
The algebraic conjugates of $\alpha$ are
\begin{eqnarray*}
\alpha_1 = \tfrac{1}{4} \bigl(a+b \sqrt{5}+c \sqrt{-n}+d \sqrt{-5 n}\bigr), & & \alpha_2 = \tfrac{1}{4} \bigl(a-b \sqrt{5}+c \sqrt{-n}-d \sqrt{-5 n}\bigr),\\
\alpha_3 = \tfrac{1}{4} \bigl(a+b \sqrt{5}- c \sqrt{-n}-d \sqrt{-5 n}\bigr), & & \alpha_4 = \tfrac{1}{4} \bigl(a-b \sqrt{5}-c \sqrt{-n}+d \sqrt{-5 n}\bigr).
\end{eqnarray*}
If $d\neq 0$, then for two of the four conjugates $\alpha_1, \alpha_2, \alpha_3, \alpha_4$, we have 
$$
|\alpha_i|\geq |\Im(\alpha_i)| \geq\frac{ |d|}{4} \sqrt{5 n}.
$$ 
For the remaining two conjugates we use $|(c + d\sqrt{5})(c - d\sqrt{5})|\geq 1$ to conclude that
$$
\min\big\{ |c - d\sqrt{5}| , |c + d\sqrt{5}|\big\}\geq \frac{1}{6|d|},
$$
and therefore
$$
|\alpha_j| \geq |\Im(\alpha_j)| \geq  \frac{\sqrt{n}}{24|d|}.
$$ 
%where $\mathbf{m} = \sqrt{5} -2 \leq \min\{ |c - d\sqrt{5}| , |c + d\sqrt{5}| \}$ and $\Im(\cdot)$ denotes the imaginary part. 
Combining both lower bounds for the conjugates  we obtain
$$
H(\alpha)\geq  \left(\frac{5}{9}\right)^{1/4}\frac{n^{1/2}}{4}.
%\frac{5^{1/4}}{24^{1/2}}n^{1/2}.
$$
This, together with  \eqref{discW} and \eqref{ifd0}, implies that  for $n>933$ the inequality in (\ref{early55}) holds for the CM-field 
$K=\Q(\sqrt{5},\sqrt{-n})$.

However, we remark that  there exist quartic CM-fields $K$ with $\Tor\bigl(K^{\times}\bigr) = \{\pm 1\}$ for which (\ref{early55}) does not hold. For example, let $\alpha$ be an algebraic integer that satisfies
$$
\alpha^2= \sqrt{3}-2 < 0,
$$
and 
$K=\Q(\alpha)$. 
The quartic CM-field $K$ has discriminant (cf. \cite[Theorem 1]{huardspearmanwilliams1995})
$$
\Delta_K=2^8 3^2.
$$
On the other hand,
$$
H(\alpha)=H(\sqrt{3}-2)^{1/2}=(\sqrt{3}+2)^{1/4} < (2/\pi)^{1/2}(2^83^2)^{1/8} = c_K.
$$
Assume that $\Tor\bigl(K^{\times}\bigr) \neq \{\pm 1\}$. Since $2$ and $3$ are the only primes that ramify in $K$ we conclude that 
$$
\h \bigl(\sqrt{-3}-1\bigr) \in K\quad \text{or}\quad \sqrt{-1} \in K.
$$
But since $\sqrt{3}\in K$  we get  $\sqrt{-1} \in K$ in either case, and thus also
$\sqrt{2-\sqrt{3}}\in K$. However, the algebraic number $\sqrt{2-\sqrt{3}}$ is totally real of degree $4$, and therefore it cannot belong to the 
quartic CM-field $K$.  This contradiction confirms that $\Tor\bigl(K^{\times}\bigr) = \{\pm 1\}$.
 
In section 2 we provide an account of the geometry of numbers over the adele ring $K_{\A}$.  
The constant $c_K$ occurs in the formula (\ref{adele64}) for the normalized Haar measure of a product of local unit balls in $K_{\A}$.  
A more extensive discussion of geometry of numbers over $K_{\A}$ is contained in \cite[Appendix C]{bombieri2006}, \cite{bombieri1983},
and \cite{mcfeat1971}.  A detailed treatment of the ring of adeles attached to a number field $K$ is given in \cite[Chapter IV]{weil1974}. 
Sections 3 and 4 contain the proofs of Theorems \ref{thmearly2} and \ref{thmearly3}, respectively.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Geometry of Numbers}%%section 2

At each place $v$ of $K$ we write $K_v$ for the completion of $K$ with respect to an absolute value from $v$ and write $d_v = [K_v:\Q_v]$ for the 
local degree at $v$.  We write $\|\ \|_v$ for the unique absolute value in the place $v$ which extends either the usual Euclidean absolute value 
on $\Q$, or the usual $p$-adic absolute value on $\Q$.  Then we define a second absolute value $|\ |_v$ from the place $v$ by
\begin{equation*}\label{gen-1}
|\ |_v = \|\ \|_v^{d_v/d}.
\end{equation*}
With these normalizations the absolute, multiplicative Weil height of $\alpha$ in $K^{\times}$ is the map (\ref{gen-30}) defined by 
(see also \cite[section 1.5.7]{bombieri2006})
\begin{equation*}\label{gen1}
H(\alpha) = \prod_v \max\big\{1, |\alpha|_v\big\}. 
\end{equation*}

At each place $v$ we define $O_v\subseteq K_v$ by
\begin{equation*}\label{gen2}
O_v = \big\{\alpha\in K_v: |\alpha|_v < 1\big\}\quad \text{if $v|\infty$},
\end{equation*}
and
\begin{equation*}\label{gen3}
O_v = \big\{\alpha\in K_v: |\alpha|_v \le 1\big\}\quad \text{if $v\nmid\infty$}.
\end{equation*}
If $v$ is an archimedean place then $O_v$ is either the open interval of length $2$ centered at $0$ in $\R$, or $O_v$ is the open unit disk 
centered at $0$ in $\C$.  If $v$ is a nonarchimedean place of $K$ then $O_v$ is the ring of $v$-adic integers in the local field $K_v$.
In both cases $O_v$ is open in $K_v$, and if $v$ is nonarchimedean then $O_v$ is also compact. 

At each place $v$ the pair $(K_v, +)$ is a locally compact abelian group.  Hence there exists a Haar measure on the $\sigma$-algebra of Borel subsets 
of $K_v$.  At each place $v$ we select a {\it unique} Haar measure $\beta_v$ defined on the Borel subsets of $K_v$ and normalized as follows.  
If $v$ is a real place then $\beta_v$ is the ordinary Lebesgue measure on the Borel subsets of $\R$.  If $v$ is a complex place then $\beta_v$ is 
the Lebesgue measure on the Borel subsets of $\C$ multiplied by $2$.  Thus we have
\begin{equation}\label{adele69}
\beta_v(O_v) = 2,\quad\text{if $v$ is real, and}\quad\beta_v(O_v) = 2\pi,\quad\text{if $v$ is complex}.
\end{equation}
If $v$ is a nonarchimedean place we require that
\begin{equation}\label{adele74}
\beta_v(O_v) = |\D_v|_v^{d/2} = \|\D_v\|_v^{d_v/2},
\end{equation}
where $\D_v$ is the local different of $K$ at $v$.  Then we have the useful identity
\begin{equation}\label{adele79}
\prod_{v \nmid \infty} |\D_v|_v^{-d} = \prod_{v \nmid \infty} \|\D_v\|_v^{-d_v} = |\Delta_K|_{\infty},
\end{equation}
where $\Delta_K$ is the discriminant of $K$.  

For $\alpha_v \not= 0$ in $K_v$ the map 
\begin{equation*}\label{adele5}
x \mapsto \alpha_v x
\end{equation*}
defines an invertible, homeomorphism of the local field $K_v$ onto itself.  It follows that
\begin{equation*}\label{adele6}
E \mapsto \beta_v(\alpha_v E)
\end{equation*}
also defines a Haar measure on the $\sigma$-algebra of Borel subsets $E \subseteq K_v$.  Haar measure is unique up to a multiplicative constant.
We find that
\begin{equation}\label{adele8}
\beta_v(\alpha_v E) = \|\alpha_v\|_v^{d_v} \beta_v(E)
\end{equation}
for all Borel subsets $E \subseteq K_v$ and all points $\alpha_v \not= 0$ in $K_v$. 

We use $S$ to denote a finite set of places of $K$ that contains all the archimedean places.  For each finite set $S$ of this kind we define the 
locally compact ring
\begin{equation}\label{adele15}
K_{\A}(S) = \prod_{v \in S} K_v \times \prod_{v \notin S} O_v.
\end{equation}
Then a generic element of $K_{\A}(S)$ is written $\alpha = (\alpha_v)$, where $\alpha_v$ belongs to $K_v$ if $v \in S$ and $\alpha_v$ belongs to
$O_v$ if $v \notin S$.  Ring operations are performed coordinate wise.  As each local field $K_v$ is locally compact, the finite product
\begin{equation*}\label{adele21}
\prod_{v \in S} K_v
\end{equation*}
is locally compact.  And it follows from Tychonoff's theorem that the infinite product
\begin{equation*}\label{adele26}
\prod_{v \notin S} O_v
\end{equation*}
is compact.  Therefore each ring $K_{\A}(S)$ defined by (\ref{adele15}) is locally compact, and the additive group 
\begin{equation*}\label{adele29}
\bigl(K_{\A}(S), +\bigr)
\end{equation*}
is a locally compact abelian group.  We write
\begin{equation*}\label{adele32}  
\beta = \prod_v \beta_v
\end{equation*}
for the product Haar measure defined on the $\sigma$-algebra of Borel subsets of $K_{\A}(S)$. 

We recall that the ring of $S$-integers $O_S \subseteq K$ is
\begin{equation*}\label{adele35}
O_S = \big\{\gamma \in K : \text{$\gamma \in O_v$ at each place $v \notin S$}\big\}.
\end{equation*}
We identify $O_S$ with the subring of $K_{\A}(S)$ defined by
\begin{equation*}\label{adele38}
\big\{\alpha = (\alpha_v) : \text{there exists $\gamma \in O_S$ such that $\alpha_v = \gamma$ at each place $v$}\big\}.
\end{equation*}
In this way we find that
\begin{equation*}\label{adele41}
O_S \subseteq K_{\A}(S)
\end{equation*}
for each $S$.

The ring of adeles $K_{\A}$ is the union
\begin{equation*}\label{adele44}
K_{\A} = \bigcup_S K_{\A}(S)
\end{equation*}
taken over the collection of all finite subsets of places $S$ such that $S$ contains all the archimedean places.  As each subring $K_{\A}(S)$ is open,
it follows that each compact subset of $K_{\A}$ is contained in $K_{\A}(S)$ for a suitable choice of $S$.  
We recall that the $\sigma$-algebra of Borel subsets of $K_{\A}$ is the smallest $\sigma$-algebra that contains all the closed 
subsets (or all the open subsets) of $K_{\A}$.  As Haar measure is a {\it regular} measure it is uniquely determined by its values on compact subsets.  
(See \cite[Proposition 7.2.6]{cohn2013} or \cite[Theorem 2.17]{rudin1987}.)  Hence the product measure $\beta$ determines a unique Haar measure 
on the Borel subsets of $K_{\A}$.  More precisely, if $E \subset K_{\A}$ is an arbitrary Borel subset of $K_{\A}$ we have
\begin{equation*}\label{adele50}
\beta(E) = \sup\big\{\beta(C) : \text{$C \subseteq K_{\A}$ is compact and $C \subseteq E$}\big\}.
\end{equation*}
It follows that $\beta$ is a well defined Haar measure on the Borel subsets of $K_{\A}$.   

For example, the product of open balls
\begin{equation}\label{adele57}
B = \prod_v O_v \subseteq K_{\A} 
\end{equation}
is obviously an open subset of $K_{\A}$.  Using (\ref{adele69}), (\ref{adele74}), and (\ref{adele79}), we find that
\begin{equation}\label{adele64}
\begin{split}
\beta(B) &= \prod_v \beta_v\bigl(O_v\bigr) = 2^r (2\pi)^s \prod_{v \nmid \infty} |\D_v|_v^{d/2}\\
              &= 2^d \Bigl(\frac{\pi}{2}\Bigr)^s \bigl|\Delta_K\bigr|^{-1/2} = 2^d c_K^{-d},
\end{split}
\end{equation}
where $c_K$ is the constant defined in (\ref{gen-37}).

As 
\begin{equation*}\label{adele71}
K = \bigcup_S O_S \subseteq \bigcup_S K_{\A}(S) = K_{\A},
\end{equation*}
it follows that the field $K$ can be identified with a subring (which happens to be a field) of the ring $K_{\A}$ of adeles associated to $K$.  This
identification is the {\it diagonal embedding} of $K$ into $K_{\A}$.

The multiplicative subgroup of invertible elements in $K_{\A}$ is the group of {\it ideles} associated to $K$.  We write $K_{\A}^{\times}$ for this group.  
We find that the idele group is 
\begin{equation}\label{haar11}
\begin{split}
K_{\A}^{\times} &= \big\{\alpha = (\alpha_v) \in K_{\A} : \text{$\alpha_v \not= 0$ for all $v$}, \\
                        &\qquad\qquad \text{and $|\alpha_v|_v = 1$ for all but finitely many $v$}\big\}.
\end{split}
\end{equation}
Using the diagonal embedding of $K$ into $K_{\A}$ it is clear that the multiplicative group $K^{\times}$ of nonzero elements in $K$ is a multiplicative
subgroup of the idele group $K_{\A}^{\times}$.  There is an important multiplicative homomorphism
\begin{equation}\label{haar14}
|\ |_{\A} : K_{\A}^{\times} \rightarrow (0, \infty)
\end{equation}
defined by
\begin{equation}\label{haar19}
|\alpha|_{\A} = \bigl|(\alpha_v)\bigr|_{\A} = \prod_v |\alpha_v|_v.
\end{equation}
It is obvious from (\ref{haar11}) that only finitely many factors in the product on the right of (\ref{haar19}) are different from $1$.  Hence there is
no question of convergence in the formally infinite product on the right of (\ref{haar19}).  The kernel of the homomorphism (\ref{haar14}) is the 
closed, multiplicative subgroup
\begin{equation*}\label{haar23}
K_{\A}^1 = \Big\{\alpha = (\alpha_v) \in K_{\A}^{\times} : \prod_v |\alpha_v|_v = 1\Big\},
\end{equation*}
and $K_{\A}^1$ contains the subgroup $K^{\times}$ by the product formula. 

Each element $\eta = (\eta_v)$ in $K_{\A}^{\times}$ determines a continuous automorphism of $K_{\A}$ by multiplication.  In more detail, 
$\eta = (\eta_v)$ in $K_{\A}^{\times}$ determines the map
\begin{equation*}\label{auto1}
(\alpha_v) \mapsto \eta (\alpha_v) = (\eta_v) (\alpha_v) = (\eta_v \alpha_v).
\end{equation*} 
As each continuous automorphism from the group $K_{\A}^{\times}$ has a continuous inverse, it follows that $E \subseteq K_{\A}$ is a Borel 
set if and only if $\eta E$ is a Borel set.

\begin{lemma}\label{lemhaar1}  Let $E \subseteq K_{\A}$ be a Borel set and let $\eta = (\eta_v)$ belong to the idele group $K_{\A}^{\times}$.  
Then
\begin{equation*}\label{auto5}
\eta E = \big\{(\eta_v \alpha_v) : \text{$\alpha = (\alpha_v) \in E$}\big\}
\end{equation*}
is a Borel set and 
\begin{equation}\label{auto10}
\beta(\eta E) = |\eta |_{\A}^d \beta(E).
\end{equation}
\end{lemma}

\begin{proof}  The map
\begin{equation*}\label{auto15}
E \mapsto \beta(\eta E)
\end{equation*}
is easily seen to be a Haar measure defined on the $\sigma$-algebra of Borel subsets in $K_{\A}$.  As Haar measure is unique up to a positive 
constant multiple, there exists a positive constant $\nu(\eta)$ such that
\begin{equation}\label{auto20}
\beta(\eta E) = \nu(\eta) \beta(E)
\end{equation}
for each Borel subset $E \subseteq K_{\A}$.  In order to determine $\nu(\eta)$ we evaluate both sides of (\ref{auto20}) at $E = B$, where $B$ 
was defined in (\ref{adele57}).  Applying (\ref{adele8}) we get
\begin{equation}\label{auto30}
\begin{split}
\beta\bigl(\eta B\bigr) &= \prod_v \beta_v\bigl(\eta_v O_v\bigr) = \prod_v \Bigl(\|\eta_v\|_v^{d_v} \beta_v(O_v)\Bigr)\\
                                   &= \biggl(\prod_v |\eta_v|_v^{d}\biggr) \beta\bigl(B\bigr) = |\eta|_{\A}^d \beta\bigl(B\bigr).
\end{split}
\end{equation}
And it follows from (\ref{adele64}) that $\beta(B)$ is positive.  As the constant $\nu(\eta)$ in (\ref{auto20}) does not depend on the Borel set 
$E \subseteq K_{\A}$, we conclude from (\ref{auto30}) that
\begin{equation}\label{auto42}
\nu(\eta) = |\eta|_{\A}^d.
\end{equation}
Then (\ref{auto10}) follows from (\ref{auto20}) and (\ref{auto42}).
\end{proof}

It follows from the product formula that the image of $K$ in $K_{\A}$ is a discrete subgroup of $K_{\A}$, and it can be shown (this is a special 
case of \cite[Chapter IV, section 2, Theorem 2]{weil1974}) that the quotient group $K_{\A}/K$ is compact in its quotient topology.  The Haar measure 
$\beta$ defined on the Borel subsets of $K_{\A}$ induces a Haar measure $\widetilde{\beta}$ on the Borel subsets of the 
compact quotient group $K_{\A}/K$.  Because of our choice of normalizations (see \cite[Proposition C.1.10]{bombieri2006}) we find that
\begin{equation*}\label{haar16}
\widetilde{\beta}\bigl(K_{\A}/K\bigr) = 1.
\end{equation*}
Alternatively, if $F \subseteq K_{\A}$ is a Borel set and a fundamental domain for the quotient group $K_{\A}/K$, then we have
\begin{equation}\label{haar18}
\beta(F) = 1.
\end{equation}
The identity (\ref{haar18}) leads to an adelic version of Blichfeldt's theorem \cite{blichfeldt1914}.

\begin{theorem}\label{thmhaar1}  Let $E \subseteq K_{\A}$ be a Borel subset such that
\begin{equation}\label{haar21}
1 < \beta(E).
\end{equation}
Then there exist distinct points $\alpha_1$ and $\alpha_2$ in $E$ such that
\begin{equation*}\label{haar27}
\alpha_2 - \alpha_1 \in K.
\end{equation*}
\end{theorem} 

\begin{proof}  To begin with we assume that $E$ is compact.  Let 
\begin{equation*}\label{haar29}
\chi_E : K_{\A} \rightarrow \{0, 1\}
\end{equation*}
be the characteristic function of the set $E$.  Because $K$ is a discrete subgroup of $K_{\A}$ and $E \subseteq K_{\A}$ is compact, it follows that 
$E \cap K$ is finite.  More generally the subset
\begin{equation*}\label{haar31}
E \cap (x - K)
\end{equation*}
is finite at each point $x$ in $K_{\A}$.  Therefore the function
\begin{equation}\label{haar33}
x \mapsto \sum_{\xi \in K} \chi_E(x - \xi)
\end{equation}
is finite at each point $x$ in $K_{\A}$ and takes nonnegative integer values.

Let $F \subseteq K_{\A}$ be a Borel set and a fundamental domain for the quotient group $K_{\A}/K$.  Then we have the countable, disjoint union of 
measurable sets
\begin{equation*}\label{haar35}
K_{\A} = \bigcup_{\xi \in K} (F + \xi).
\end{equation*}
It follows that
\begin{equation}\label{haar37}
\begin{split}
1 < \beta(E) &= \int_{K_{\A}} \chi_E(x)\ \dbeta(x) = \sum_{\xi \in K} \int_{F + \xi} \chi_E(x)\ \dbeta(x)\\
   &= \sum_{\xi \in K} \int_F \chi_E(x - \xi)\ \dbeta(x) = \int_F \biggl(\sum_{\xi \in K} \chi_E(x - \xi)\biggr)\ \dbeta(x).
\end{split}
\end{equation}
Assume that
\begin{equation*}\label{haar39}
\sum_{\xi \in K} \chi_E(x - \xi) \le 1
\end{equation*}
at each point $x$ in $F$.  Then using (\ref{haar37}) we get
\begin{equation*}\label{haar41}
1 < \int_F \biggl(\sum_{\xi \in K} \chi_E(x - \xi)\biggr)\ \dbeta(x) \le \beta(F) = 1,
\end{equation*}
which is impossible.  As (\ref{haar33}) takes nonnegative integer values, it follows that there exists a point $y$ in $F$ such that
\begin{equation*}\label{haar43}
2 \le \sum_{\xi \in K} \chi_E(y - \xi).
\end{equation*}
Hence there exist distinct points $\xi_1$ and $\xi_2$ in $K$ such that 
\begin{equation*}\label{haar45}
\big\{y - \xi_1, y - \xi_2\big\} \subseteq E.
\end{equation*}
Let
\begin{equation*}\label{haar47}
\alpha_1 = y - \xi_1\quad\text{and}\quad \alpha_2 = y - \xi_2,
\end{equation*}
so that $\alpha_1$ and $\alpha_2$ are distinct points in $E$.  Then it is obvious that 
\begin{equation*}\label{haar49}
\alpha_2 - \alpha_1 = \xi_1 - \xi_2
\end{equation*}
belongs to $K$.  This proves the theorem when $E$ is compact.

Now assume that $E$ is not compact.  Because $\beta$ is a regular measure there exist compact subsets 
\begin{equation*}\label{haar51}
C_1 \subseteq C_2 \subseteq \cdots \subseteq C_{\ell} \subseteq \cdots \subseteq E
\end{equation*}
such that
\begin{equation}\label{haar53}
\lim_{\ell \rightarrow \infty} \beta(C_{\ell}) = \beta(E).
\end{equation}
It follows from (\ref{haar21}) and (\ref{haar53}) that there exists a positive integer $L$ such that 
\begin{equation*}\label{haar55}
1 < \beta(C_L) < \infty.
\end{equation*}
As $C_L \subseteq E$ the theorem follows by applying the case already considered to the compact subset $C_L$.
\end{proof}

At each archimedean place $v$ of $K$ let $J_v \subseteq K_v$ be a nonempty, open, convex, symmetric set.  Here we say that $J_v$ 
is {\it symmetric} if $J_v = - J_v$.  At each nonarchimedean place $v$ of $K$ let $J_v \subseteq K_v$ be a nonempty, compact, open 
$O_v$-module in $K_v$.  And assume that for all but finitely many nonarchimedean places $v$ we have $J_v = O_v$.  It follows that
\begin{equation}\label{haar57}
\J = \prod_v J_v \subseteq K_{\A}
\end{equation}
is an open subset of $K_{\A}$.  We say that an open subset of $K_{\A}$ is {\it admissible} if it can be written as a product of the form 
(\ref{haar57}).  If $\J$ is admissible and $\eta = (\eta_v)$ belongs to the multiplicative group $K_{\A}^{\times}$, then it follows easily that 
\begin{equation*}\label{haar59}
\eta \J = \prod_v \bigl(\eta_v J_v\bigr) \subseteq K_{\A}
\end{equation*}
is also an admissible subset.  The following result is an adelic version of Minkowski's convex body theorem.  

\begin{theorem}\label{thmhaar2}  Let 
\begin{equation*}\label{haar61}
\I = \prod_v I_v,\quad\text{and}\quad \J = \prod_v J_v,
\end{equation*}
be admissible subsets of $K_{\A}$ such that $2 I_v = J_v$ if $v | \infty$, and $I_v = J_v$ if $v \nmid \infty$.  If
\begin{equation}\label{haar65}
1 < \beta(\I),\quad\text{or equivalently if}\quad 2^d < \beta(\J),
\end{equation}
then there exist distinct points $\alpha_1$ and $\alpha_2$ in $\I$ such that 
\begin{equation*}\label{haar70}
\alpha_2 - \alpha_1 \in \J \cap K.
\end{equation*}
\end{theorem}

\begin{proof}  It follows from Theorem \ref{thmhaar1} and (\ref{haar65}) that there exist distinct points 
\begin{equation*}\label{haar74}
\alpha_1 = \bigl(\alpha_{1, v}\bigr),\quad\text{and}\quad \alpha_2 = \bigl(\alpha_{2, v}\bigr)
\end{equation*}
in $\I$ such that
\begin{equation*}\label{haar79}
\alpha_2 - \alpha_1 \in K.
\end{equation*}

If $v$ is an archimedean place of $K$ then both $\alpha_{2, v}$ and $-\alpha_{1, v}$ belong to 
$I_v$ by symmetry.  Hence both $2 \alpha_{2, v}$ and $-2\alpha_{1, v}$ belong to $J_v$.  As
\begin{equation*}\label{haar86}
\alpha_{2, v} - \alpha_{1, v} = \h(2 \alpha_{2, v}) + \h\bigl(-2\alpha_{1, v}\bigr)
\end{equation*}
is a convex combination of $-2 \alpha_{1, v}$ and $2 \alpha_{2, v}$, it follows that $\alpha_{2, v} - \alpha_{1, v}$ belongs to $J_v$.
If $v$ is a nonarchimedean place of $K$ then both $\alpha_{1, v}$ and $\alpha_{1, v}$ belong to $I_v$.  In this case $I_v$ is
an $O_v$-module and therefore $\alpha_{2, v} - \alpha_{1, v}$ belongs to $I_v = J_v$.

We have shown that
\begin{equation*}\label{haar93}
\alpha_2 - \alpha_1 = \bigl(\alpha_{2, v}\bigr) - \bigl(\alpha_{1, v}\bigr) = \bigl(\alpha_{2, v} - \alpha_{1, v}\bigr)
\end{equation*}
belongs to $\J \cap K$.  This proves the theorem.
\end{proof}

Next we apply Theorem \ref{thmhaar2} with $\J = \eta B$, where $\eta = (\eta_v)$ belongs to $K_{\A}^{\times}$ and $B$ is the product of
local unit balls defined in (\ref{adele57}).

\begin{theorem}\label{thmhaar3}  Let $K$ be an algebraic number field of degree $d$ that has at least two archimedean places.  Let $w$ be an 
archimedean place of $K$.  If $0 < \ep$ there exists an algebraic integer $\xi$ in $O_K$ that satisfies
\begin{equation}\label{new5}
0 < |\xi|_v < 1,\quad\text{if $v | \infty$ and $v \not= w$},
\end{equation}
and
\begin{equation}\label{new12}
1 < |\xi|_w = H(\xi) < (1 + \ep)c_K.
\end{equation}
\end{theorem}

\begin{proof}  Let $\eta = \bigl(\eta_v\bigr)$ belong to $K_{\A}^{\times}$ and satisfy
\begin{equation}\label{new19}
\bigl|\eta_v\bigr|_v = 1\quad\text{if $v \not= w$},
\end{equation}
and
\begin{equation}\label{new26}
c_K < \bigl|\eta_v\bigr|_v < (1 + \ep) c_K\quad\text{if $v = w$}.
\end{equation}
It follows that
\begin{equation}\label{new29}
c_K < \bigl|\eta_w\bigr|_w = \bigl|\eta\bigr|_{\A} < (1 + \ep) c_K.
\end{equation}  

Let $B \subseteq K_{\A}$ be the admissible subset defined in (\ref{adele57}).  By combining (\ref{adele64}) and (\ref{auto10}) we find that
\begin{equation}\label{new33}
\beta(\eta B) = 2^d c_K^{-d} \bigl|\eta\bigr|_{\A}^d.
\end{equation}
From the inequality on the left of (\ref{new26}) we conclude that
\begin{equation*}\label{new40}
2^d < \beta(\eta B).
\end{equation*}
As $\eta B$ is an admissible subset of $K_{\A}$, it follows from Theorem \ref{thmhaar2} that there exists a point
\begin{equation*}\label{new47}
\xi = \alpha_2 - \alpha_1 \not= 0
\end{equation*}
in $K$ such that
\begin{equation}\label{new54}
\xi \in \eta B.
\end{equation}
Then it follows from (\ref{new19}) and (\ref{new26}) that 
\begin{equation*}\label{new61}
0 < |\xi|_v < 1,\quad\text{if $v | \infty$ and $v \not= w$},
\end{equation*}
and this verifies (\ref{new5}).  It also follows from (\ref{new19}) and (\ref{new54}) that
\begin{equation}\label{new68}
1 < |\xi|_w = H(\xi) < (1 + \ep)c_K,
\end{equation}
and this proves (\ref{new12}).
\end{proof}

\begin{corollary}\label{corhaar1}  Let $K$ be an algebraic number field of degree $d$ that has at least two archimedean places.  Let $w$ be an 
archimedean place of $K$.  Then there exists an algebraic integer $\xi$ in $O_K$ that satisfies
\begin{equation}\label{new75}
0 < |\xi|_v < 1,\quad\text{if $v | \infty$ and $v \not= w$},
\end{equation}
and
\begin{equation}\label{new82}
1 < |\xi|_w = H(\xi) \le c_K.
\end{equation} 
\end{corollary}

\begin{proof}  For each positive integer $m$ let $A_m \subseteq O_K$ be the collection of algebraic integers $\alpha$ that satisfy  
\begin{equation}\label{haar245}
\text{$0 < |\alpha|_v < 1$ if $v | \infty$ and $v \not= w$},
\end{equation}
and
\begin{equation}\label{haar252}
\text{$1 < |\alpha|_w = H(\alpha) \le \bigl(1 + m^{-1}\bigr)c_K$}.
\end{equation}
It follows from Northcott's theorem (see \cite[Theorem 1.6.8]{bombieri2006}) that $A_1$ is finite, and it follows from Theorem \ref{thmhaar3} that 
$A_m$ is not empty for $m = 1, 2, \dots $.  As
\begin{equation*}\label{haar259}
A_1 \supseteq A_2 \supseteq A_3 \supseteq \cdots \supseteq A_m \supseteq \cdots ,
\end{equation*}
we conclude that there exists an algebraic integer $\xi$ contained in the collection
\begin{equation*}\label{haar266}
\bigcap_{m = 1}^{\infty} A_m .
\end{equation*}
Then it follows from (\ref{haar245}) and (\ref{haar252}) that $\xi$ satisfies the inequalities (\ref{new75}) and (\ref{new82})
\end{proof}
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Proof of Theorem \ref{thmearly2}}%%section 3

Let $K$ be an algebraic number field such that $\Tor\bigl(K^{\times}\bigr) \not= \{\pm 1\}$.  Then $\Tor\bigl(K^{\times}\bigr)$ contains a root of unity 
$\zeta \not= \pm 1$ that generates the cyclic group $\Tor\bigl(K^{\times}\bigr)$.  As the subfield $\Q(\zeta) \subseteq K$ has only complex embeddings,
it follows that $K$ has only complex embeddings.  If $K = \Q(\zeta)$ then the conclusion (\ref{early20}) follows because 
\begin{equation*}\label{haar158}
H(\zeta) = 1 < c_K.
\end{equation*}
It remains to establish (\ref{early20}) when the nontrivial, cyclotomic extension $\Q(\zeta)$ is a proper subfield of $K$.  We note that if $\Q(\zeta)$ is 
a proper subfield of $K$, then
\begin{equation*}\label{haar162}
[K : \Q] = [K : \Q(\zeta)] [\Q(\zeta) : \Q] \ge 4,
\end{equation*}
and it follows that $K$ must have at least two distinct archimedean places.  

We fix an embedding of $K$ into $\C$ and write $w$ for the archimedean place of $K$ that is determined by applying the ordinary Hermitian absolute 
value on $\C$ to elements of $K$.  Thus we may speak of elements of $K$ as being contained in the subfield $\R$, or not being contained in $\R$.       

If $0 < \ep \le 1$ then it follows from Corollary \ref{corhaar1} that there exists a nonzero point $\xi$ in $O_K$ such that
\begin{equation}\label{haar175}
0 < |\xi|_v < 1,\quad\text{if $v | \infty$ and $v \not= w$},
\end{equation}
and
\begin{equation}\label{haar182}
1 < |\xi|_w = H(\xi) \le c_K.
\end{equation}
We note that the inequalities (\ref{haar175}), and (\ref{haar182}) continue to hold if $\xi$ is replaced by an element in the 
multiplicative coset $\xi \Tor\bigl(K^{\times}\bigr)$.  Therefore, by replacing $\xi$ with $\xi \zeta$ if necessary, we may assume that $\xi$ is
contained in $\C$, but {\it not} in $\R$. 

Let $k = \Q(\xi)$ be the subfield of $K$ generated by $\xi$, and let $u$ be the unique archimedean place of $k$ such that $w | u$. We write
$W_u(K/k)$ for the collection of all places $v$ of $K$ that satisfy $v | u$.  Then $w$ is an example of a place in the collection $W_u(K/k)$.
As the global degree $[K : k]$ is the sum of local degrees that lie over a particular place of $k$, we get the basic identity
\begin{equation}\label{haar195}
[K : k] = \sum_{v | u} [K_v : k_u] = [K_w : k_u] + \sum_{\substack{v|u \\ v \not= w}} [K_v : k_u].
\end{equation}
Because the algebraic integer $\xi$ belongs to $k$ we find that
\begin{equation}\label{haar200}
\|\xi\|_v = \|\xi\|_u\quad \text{at each place $v$ in $W_u(K/k)$}. 
\end{equation}
However, if $v$ belongs to $W_u(K/k)$ and $v \not= w$ we have $\|\xi\|_v < 1$ from (\ref{haar175}), while if $v = w$ then $1 < \|\xi\|_w$ 
follows from (\ref{haar182}).  We conclude that $W_u(K/k)$ contains only the place $w$.  That is, we have
\begin{equation}\label{haar205}
W_u(K/k) = \{w\},
\end{equation}
and the identity (\ref{haar195}) asserts that
\begin{equation}\label{haar210}
[K : k] = \bigl[K_w : k_u\bigr].
\end{equation}
As $K$ is totally complex it follows that $K_w = \C$.  From (\ref{haar210}) we conclude that
\begin{equation}\label{haar217}
[K : k] = \bigl[\C : k_u\bigr] = \begin{cases}  1&    \text{if $k_u = \C$},\\
                                                                         2&    \text{if $k_u = \R$}.\end{cases}
\end{equation}
However, we selected $\xi$ so that $k = \Q(\xi)$ was {\it not} contained in $\R$.  Therefore we have $k_u = \C$ and from (\ref{haar217})
we find that $K = k = \Q(\xi)$.  The inequality on the right of (\ref{early20}) follows from (\ref{haar182}).

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section{Proof of Theorem \ref{thmearly3}}%%section 4

If $K$ has a real embedding then it follows from Theorem \ref{thmearly1} that the hypothesis (\ref{early55}) is false.  And it follows from 
Theorem \ref{thmearly2} that if $K$ has only complex embeddings and $\Tor\bigl(K^{\times}\bigr) \not= \{\pm 1\}$ then again the hypothesis 
(\ref{early55}) is false.  Therefore the hypothesis (\ref{early55}) implies that $K$ is totally complex and $\Tor\bigl(K^{\times}\bigr) = \{\pm 1\}$.  It 
remains to show that the hypothesis (\ref{early55}) also implies that $K$ is a $\CM$-field.

If $K$ is totally complex and has exactly one archimedean place then $K$ is an imaginary, quadratic extension of $\Q$, and therefore $K$ {\it is} 
a $\CM$-field.  Thus we may restrict our attention to fields $K$ which are totally complex, which satisfy $\Tor\bigl(K^{\times}\bigr) = \{\pm 1\}$,
which satisfy the height inequality (\ref{early55}), and which have at least two archimedean places.  We will assume that $K$ has $N \ge 2$
archimedean places and write $w_1, w_2, \dots , w_N$ for the collection of distinct archimedean places of $K$.  As $K$ is totally complex it
follows that $[K : \Q] = 2N$.

For each $n = 1, 2, \dots , N$ we apply Theorem \ref{thmhaar3} at the archimedean place $w_n$, and with $0 < \ep$ selected so that
\begin{equation}\label{haar400}
c_K < (1 + \ep)c_K = \min\big\{H(\alpha) : \text{$K = \Q(\alpha)$ and $\alpha \in O_K$}\big\}.
\end{equation}
That such a positive $\ep$ exists follows from the hypothesis (\ref{early55}).  We conclude from Theorem \ref{thmhaar3} that there exists an 
algebraic integer $\xi^{(n)}$ in $O_K$ that satisfies the system of inequalities
\begin{equation}\label{haar407}
0 < \bigl|\xi^{(n)}\bigr|_v < 1,\quad\text{if $v | \infty$ and $v \not= w_n$},
\end{equation}
and
\begin{equation}\label{haar414}
1 < \bigl|\xi^{(n)}\bigr|_{w_n} = H\bigl(\xi^{(n)}\bigr) < \min\big\{H(\alpha) : \text{$K = \Q(\alpha)$ and $\alpha \in O_K$}\big\}.
\end{equation}
As $\xi^{(n)}$ is a nonzero algebraic integer in $K$, it follows from (\ref{haar414}) that $\xi^{(n)}$ does {\it not} generate the field $K$.  That is, 
for each $n = 1, 2, \dots , N$ the field $\Q\bigl(\xi^{(n)}\bigr)$ is a proper subfield of $K$.

Let $u_n$ be the unique place of the proper subfield $\Q\bigl(\xi^{(n)}\bigr)$ such that $w_n | u_n$.  If $\widehat{w}_n \not= w_n$ is a second 
archimedean place of $K$ such that $\widehat{w}_n | u_n$ then we would have both (\ref{haar414}) and 
\begin{equation}\label{haar428}
1 < \bigl|\xi^{(n)}\bigr|_{\widehat{w}_n}.
\end{equation}
As (\ref{haar414}) and (\ref{haar428}) contradict the conditions (\ref{haar407}) and (\ref{haar414}), we conclude that $w_n$ is the {\it unique} place
of $K$ such that $w_n | u_n$.  Because $K$ is totally complex we find that
\begin{equation}\label{haar435}  
\begin{split}
\bigl[K : \Q\bigl(\xi^{(n)}\bigr)\bigr] &= \sum_{v | u_n} \bigl[K_v : \Q\bigl(\xi^{(n)}\bigr)_{u_n}\bigr]\\ 
	                                              &= \bigl[K_{w_n} : \Q\bigl(\xi^{(n)}\bigr)_{u_n}\bigr]\\ 
	                                              &= \bigl[\C : \Q\bigl(\xi^{(n)}\bigr)_{u_n}\bigr]
\end{split}
\end{equation}
for each integer $n = 1, 2, \dots , N$.  As $\Q\bigl(\xi^{(n)}\bigr)$ is a proper subfield of $K$, the identity (\ref{haar435}) implies that both
\begin{equation*}\label{haar442}
\bigl[K : \Q\bigl(\xi^{(n)}\bigr)\bigr] = 2,\quad\text{and}\quad \Q\bigl(\xi^{(n)}\bigr)_{u_n} = \R.
\end{equation*}
In particular, for each integer $n = 1, 2, \dots , N$ we have established the existence of an algebraic integer $\xi^{(n)}$ in $K$ such that 
\begin{equation}\label{haar449}
\bigl[K : \Q\bigl(\xi^{(n)}\bigr)\bigr] = 2,\quad\text{and}\quad \Q\bigl(\xi^{(n)}\bigr) \subseteq \R.
\end{equation}

Let $k$ be the compositum of the finite collection of subfields
\begin{equation}\label{haar456}
\Big\{\Q\bigl(\xi^{(n)}\bigr) : \text{$n = 1, 2, \dots , N$}\Big\}.
\end{equation}
As each field in the collection (\ref{haar456}) is contained in $\R$, it follows that for each $n = 1, 2, \dots , N$ we have
\begin{equation}\label{haar463}
\Q\bigl(\xi^{(n)}\bigr) \subseteq k \subseteq K,\quad\text{and}\quad k \subseteq \R.
\end{equation}
Because $K$ is totally complex, the composite field $k$ is a {\it proper} subfield of $K$.  Therefore using (\ref{haar449}) and (\ref{haar463}) we find that
\begin{equation*}\label{haar470}
2 \le [K : k] \le \bigl[K : \Q\bigl(\xi^{(n)}\bigr)\bigr] = 2,\quad\text{for each $n = 1, 2, \dots , N$}.
\end{equation*}
That is, we have
\begin{equation*}\label{haar477}
\Q\bigl(\xi^{(n)}\bigr) = k\quad \text{for each $n = 1, 2, \dots , N$},
\end{equation*}
and therefore
\begin{equation}\label{haar484}
\big\{\xi^{(n)} : \text{$n = 1, 2, \dots , N$}\big\} \subseteq k.
\end{equation}
We conclude from (\ref{haar407}), (\ref{haar414}) and (\ref{haar484}), that $k$ has $N$ {\it distinct} archimedean absolute values.  As 
$[k : \Q] = N$ it follows that $k$ is totally real.  We have proved that $K$ is a totally complex quadratic extension of the totally real algebraic 
number field $k$.  It follows that $K$ is a $\CM$-field.

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\section*{Acknowledgements}
 The authors acknowledge the support from Max Planck Institute  for Mathematics in Bonn, where this collaborative  project was initiated in 2019.
  Shabnam Akhtari's research is partially supported by  the National Science Foundation Awards DMS-2001281 and DMS-2327098.

\bibliography{Books.bib}

\end{document}


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

