\begin{algorithm}[ht]
  \caption{Range-based Fair Rounding}\label{alg2}
  \textbf{Input}: Embedded vectors $H \subseteq \mathbb{R}^{k}$ (resp.~$V$), group indicator $\phi$ on $H$ and $V$, fairness vectors $\bm{\alpha}, \bm{\beta} \in [0,1]^m$, an integer $k \geq 2$\\
  \textbf{Parameters}: $T_3$, $\varepsilon_3$\\
  \textbf{Output}: Partitioning $\mathcal{C}^* = \{C^*_1, \ldots, C^*_k\}$
  \begin{algorithmic}[1]
  \STATE Initialize $\mathcal{C}^* = \emptyset$ and $t = 0$.
  \STATE Run $k$-means++ on $H$ to obtain an initial set $Q$ of centers.
  \REPEAT
    \STATE Set $t \gets t + 1$.
    \STATE Compute $\bm{C}$ w.r.t.~$H$, $Q$ and solve $\mathrm{LP1}$ to obtain $\bm{S}^*$.
    \STATE Assign each vector $\bm{h}_i \in H$ to a center $\varphi(\bm{h}_i) = \bm{q}_{l^*} \in Q$, where $l^* = \argmax_{l \in [k]} \bm{S}^{*}_{i, l}$.
    \STATE Solve $\mathrm{IP2}$ to obtain $\bm{N}'$ and compute $\bm{\Delta} = \bm{N}' - \bm{N}$.
    \WHILE{there is any $c \in [m]$ and $l \in [k]$ with $\Delta_{cl} \neq 0$}
    \STATE Pick arbitrary $c$, $C_l$, $C_{l'}$ with $\Delta_{cl} < 0$ and $\Delta_{cl'} > 0$.
    \STATE Let $\mathsf{cand} = \{ i \in [n]: \phi(i) = c \wedge \varphi(\bm{h}_i) = \bm{q}_l\}$.
    \STATE Set $i^* \gets \argmin_{i \in \mathsf{cand}} \delta_{l,l'}(i)$ and $\varphi(\bm{h}_{i^*}) = \bm{q}_{l'}$.
    \STATE Update $\bm{N}$ and $\bm{\Delta}$ for the reassignment of $i^*$.
    \ENDWHILE
    \STATE Generate a partitioning $\mathcal{C} = \{C_1, \ldots, C_k\}$ from $\varphi$, where $C_l = \{i \in [n] : \varphi(\bm{h}_i) = \bm{q}_l\}$ for each $l \in [k]$.
    \IF{$\mathcal{C}^* = \emptyset$ or $\mathsf{Ncut}(\mathcal{C}^*) > \mathsf{Ncut}(\mathcal{C})$}
    \STATE $\mathcal{C}^* \gets \mathcal{C}$.
    \ENDIF
    \STATE Set $Q' \gets Q$ and $Q \gets \{\bm{q}_l = \frac{1}{|C_l|} \sum_{i \in C_l} \bm{h}_i : l \in [k]\}$.
  \UNTIL{$\sum_{l = 1}^{k} \lVert \bm{q}_l - \bm{q}'_l \rVert \leq \varepsilon_3 $ for $\bm{q}_l \in Q, \bm{q}'_l \in Q'$ or $t \geq T_3$}
  \RETURN $\mathcal{C}^*$
  \end{algorithmic}
\end{algorithm}
