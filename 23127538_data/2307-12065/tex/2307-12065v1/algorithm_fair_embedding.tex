\begin{algorithm}[ht]
  \caption{Range-based Fair Spectral Embedding}\label{alg1}
  \textbf{Input}: Graph $G$ with adjacency matrix $\bm{W} \in \mathbb{R}^{n \times n}$, group matrix $\bm{M} \in \mathbb{R}^{n \times m}$, fairness vectors $\bm{\alpha}, \bm{\beta} \in [0,1]^m$, an integer $k \geq 2$\\
  \textbf{Parameters}: $T_1$, $\bm{\Lambda}_0$, $\mu_0$, $\xi$, $\varepsilon_1$; $T_2$, $\tau$, $\varepsilon_2$\\
  \textbf{Output}: Embedding matrix $\bm{H} \in \mathbb{R}^{n \times k}$
  \begin{algorithmic}[1]
    \STATE Compute $\bm{D}, \bm{L}$ and $\bm{A}, \bm{B}$ based on $\bm{W}$ and $\bm{\alpha}, \bm{\beta}$, respectively.
    \STATE Initialize an arbitrary matrix $\bm{T}_0 \in \mathbb{R}^{n \times k}$ with $\bm{T}_0^{\top} \bm{T}_0 = \bm{I}_k$.
    \FOR{$t = 0, 1, \ldots, T_1$}
    \STATE Formulate the problem in Eq.~\ref{subproblem} with $\bm{T}_{t}$, $\bm{\Lambda}_{t}$, and $\mu_{t}$.
    \REPEAT
      \STATE Use Eq.~\ref{Cayley} or~\ref{SMW} to compute $\bm{T}'_{t}$ w.r.t.~$\bm{T}_{t}$ and $\tau$.
      \STATE Set $\bm{T}_{t} \gets \bm{T}'_{t}$ and update $\tau$ using the Barzilai-Borwein method~\cite{Barzilai88}.
    \UNTIL{$\lVert \bm{\nabla}_{\bm{T}_t} L_{\mu_{t}}(\bm{T}_{t}, \bm{\Lambda}_{t}) \rVert_{F} \leq \varepsilon_2$ or after $T_2$ iterations}
    \STATE Set $\bm{T}_{t+1} \gets \bm{T}_{t}$ and update $\bm{\Lambda}_{t+1}, \mu_{t+1}$ based on Eq.~\ref{params}.
    \IF{$ \lVert \min \{\bm{P}(\bm{T}_{t+1}), \bm{0}\} \rVert_F \leq \varepsilon_1$}
      \STATE $\bm{H} \gets \bm{D}^{-\frac{1}{2}}\bm{T}_{t+1}$ and \textbf{break}.
    \ENDIF
    \ENDFOR
    \RETURN $\bm{H}$
  \end{algorithmic}
\end{algorithm}
