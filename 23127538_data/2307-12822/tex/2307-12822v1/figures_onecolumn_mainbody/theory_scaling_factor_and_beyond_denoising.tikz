% This file was cr
\begin{tikzpicture}

\definecolor{darkgray176}{RGB}{176,176,176}
\definecolor{lightgray204}{RGB}{204,204,204}

\definecolor{green}{RGB}{0,128,0}
\definecolor{orange}{RGB}{255,165,0}
\definecolor{purple}{RGB}{128,0,128}

\begin{groupplot}[group style={group size=2 by 1,
    horizontal sep=140pt},
    %width=0.9\columnwidth,
    width=0.3\textwidth,
    height=0.27\textwidth,
    tick align=outside,
    tick pos=left,
    x grid style={darkgray176},
    xtick style={color=black},
    y grid style={darkgray176},
    ytick style={color=black},
    y grid style={darkgray176},
    xlabel={\(\displaystyle \advnoiselevel^2 / \stdlatent^2\)},
    legend image code/.code={
        \draw[#1,solid] (0cm,0.0cm) -- (0.4cm,0.0cm); 
    },
]

% scaling factor from appendix
\nextgroupplot[%xlabel={\(\displaystyle \advnoiselevel^2 / \mathbb{E}[\| \vx \|^2]\)}, 
    xmin=-0.1, xmax=2.1,
    ylabel={Scaling factor \(\displaystyle \alpha\)},
    title={Optimal robust denoising},
    ymin=-0.05, ymax=1.05,
    legend cell align={left},
    legend style={
        fill opacity=0.8,
        draw opacity=1,
        text opacity=1,
        font=\small,
        at={(1.47,1.0)},
        anchor=north,
        draw=lightgray204
    }]

\addplot [very thick, purple]
table {%
0 1
0.0202020202020202 1
0.0404040404040404 1
0.0606060606060606 1
0.0808080808080808 1
0.101010101010101 1
0.121212121212121 1
0.141414141414141 1
0.161616161616162 1
0.181818181818182 1
0.202020202020202 1
0.222222222222222 1
0.242424242424242 1
0.262626262626263 1
0.282828282828283 1
0.303030303030303 1
0.323232323232323 1
0.343434343434343 1
0.363636363636364 1
0.383838383838384 1
0.404040404040404 1
0.424242424242424 1
0.444444444444444 1
0.464646464646465 1
0.484848484848485 1
0.505050505050505 1
0.525252525252525 1
0.545454545454546 1
0.565656565656566 1
0.585858585858586 1
0.606060606060606 1
0.626262626262626 1
0.646464646464647 1
0.666666666666667 1
0.686868686868687 1
0.707070707070707 1
0.727272727272727 1
0.747474747474748 1
0.767676767676768 1
0.787878787878788 1
0.808080808080808 1
0.828282828282828 1
0.848484848484849 1
0.868686868686869 1
0.888888888888889 1
0.909090909090909 1
0.929292929292929 1
0.94949494949495 1
0.96969696969697 1
0.98989898989899 1
1.01010101010101 0
1.03030303030303 0
1.05050505050505 0
1.07070707070707 0
1.09090909090909 0
1.11111111111111 0
1.13131313131313 0
1.15151515151515 0
1.17171717171717 0
1.19191919191919 0
1.21212121212121 0
1.23232323232323 0
1.25252525252525 0
1.27272727272727 0
1.29292929292929 0
1.31313131313131 0
1.33333333333333 0
1.35353535353535 0
1.37373737373737 0
1.39393939393939 0
1.41414141414141 0
1.43434343434343 0
1.45454545454545 0
1.47474747474747 0
1.4949494949495 0
1.51515151515152 0
1.53535353535354 0
1.55555555555556 0
1.57575757575758 0
1.5959595959596 0
1.61616161616162 0
1.63636363636364 0
1.65656565656566 0
1.67676767676768 0
1.6969696969697 0
1.71717171717172 0
1.73737373737374 0
1.75757575757576 0
1.77777777777778 0
1.7979797979798 0
1.81818181818182 0
1.83838383838384 0
1.85858585858586 0
1.87878787878788 0
1.8989898989899 0
1.91919191919192 0
1.93939393939394 0
1.95959595959596 0
1.97979797979798 0
2 0
};
\addlegendentry{No noise}%Problem 1$\sigma_{tr}$=0.00}
\addplot [very thick, green]
table {%
0 0.8
0.0202020202020202 0.74873269311104
0.0404040404040404 0.726894134018407
0.0606060606060606 0.709706776322704
0.0808080808080808 0.694841475215876
0.101010101010101 0.681400109334224
0.121212121212121 0.668922892716954
0.141414141414141 0.657136348993023
0.161616161616162 0.645861423725092
0.181818181818182 0.634972600598593
0.202020202020202 0.624377184016495
0.222222222222222 0.614003778009889
0.242424242424242 0.603795411364811
0.262626262626263 0.593705199394087
0.282828282828283 0.583693477330555
0.303030303030303 0.573725830020305
0.323232323232323 0.56377168943182
0.343434343434343 0.553803303493988
0.363636363636364 0.543794953911861
0.383838383838384 0.533722343995101
0.404040404040404 0.523562103813965
0.424242424242424 0.513291376372483
0.444444444444444 0.502887458916717
0.464646464646465 0.492327480230649
0.484848484848485 0.481588099132803
0.505050505050505 0.470645212162953
0.525252525252525 0.459473660118178
0.545454545454546 0.448046923948752
0.565656565656566 0.436336800721842
0.585858585858586 0.424313049986233
0.606060606060606 0.411942999941867
0.626262626262626 0.399191101297199
0.646464646464647 0.386018414493983
0.666666666666667 0.372382012940121
0.686868686868687 0.358234280786019
0.707070707070707 0.343522078274035
0.727272727272727 0.328185740304329
0.747474747474748 0.312157863906013
0.767676767676768 0.29536182678688
0.787878787878788 0.277709960610101
0.808080808080808 0.259101276973749
0.828282828282828 0.239418608045194
0.848484848484849 0.218524972550695
0.868686868686869 0.196258903785507
0.888888888888889 0.172428367557811
0.909090909090909 0.146802735257819
0.929292929292929 0.119102028756074
0.94949494949495 0.0889822657012026
0.96969696969697 0.0560151120395565
0.98989898989899 0.0196590239933882
1.01010101010101 0
1.03030303030303 0
1.05050505050505 0
1.07070707070707 0
1.09090909090909 0
1.11111111111111 0
1.13131313131313 0
1.15151515151515 0
1.17171717171717 0
1.19191919191919 0
1.21212121212121 0
1.23232323232323 0
1.25252525252525 0
1.27272727272727 0
1.29292929292929 0
1.31313131313131 0
1.33333333333333 0
1.35353535353535 0
1.37373737373737 0
1.39393939393939 0
1.41414141414141 0
1.43434343434343 0
1.45454545454545 0
1.47474747474747 0
1.4949494949495 0
1.51515151515152 0
1.53535353535354 0
1.55555555555556 0
1.57575757575758 0
1.5959595959596 0
1.61616161616162 0
1.63636363636364 0
1.65656565656566 0
1.67676767676768 0
1.6969696969697 0
1.71717171717172 0
1.73737373737374 0
1.75757575757576 0
1.77777777777778 0
1.7979797979798 0
1.81818181818182 0
1.83838383838384 0
1.85858585858586 0
1.87878787878788 0
1.8989898989899 0
1.91919191919192 0
1.93939393939394 0
1.95959595959596 0
1.97979797979798 0
2 0
};
\addlegendentry{Medium noise} % xi=0.5
\addplot [very thick, orange]
table {%
0 0.307692307692308
0.0202020202020202 0.271190227125321
0.0404040404040404 0.255908364912011
0.0606060606060606 0.244069644603485
0.0808080808080808 0.233993404548695
0.101010101010101 0.225030544049486
0.121212121212121 0.216849015759054
0.141414141414141 0.209252017539867
0.161616161616162 0.20211157863989
0.181818181818182 0.195338962563043
0.202020202020202 0.188869651487949
0.222222222222222 0.182654991727028
0.242424242424242 0.176657210894583
0.262626262626263 0.170846280001027
0.282828282828283 0.1651978489253
0.303030303030303 0.159691838201185
0.323232323232323 0.15431144896101
0.343434343434343 0.149042448696155
0.363636363636364 0.143872644415487
0.383838383838384 0.138791486430902
0.404040404040404 0.133789765258254
0.424242424242424 0.128859376216394
0.444444444444444 0.123993134115079
0.464646464646465 0.119184625588049
0.484848484848485 0.114428090120536
0.505050505050505 0.109718323229075
0.525252525252525 0.10505059694211
0.545454545454546 0.100420593935813
0.565656565656566 0.0958243525523122
0.585858585858586 0.0912582205678914
0.606060606060606 0.0867188160542516
0.626262626262626 0.08220299403319
0.646464646464647 0.0777078178962586
0.666666666666667 0.0732305347688791
0.686868686868687 0.0687685541592362
0.707070707070707 0.0643194293577667
0.727272727272727 0.0598808411517449
0.747474747474748 0.0554505834976534
0.767676767676768 0.0510265508563973
0.787878787878788 0.0466067269465055
0.808080808080808 0.0421891747109256
0.828282828282828 0.0377720273258937
0.848484848484849 0.0333534801072234
0.868686868686869 0.028931783191408
0.888888888888889 0.0245052348871248
0.909090909090909 0.020072175607805
0.929292929292929 0.0156309823084758
0.94949494949495 0.0111800633605547
0.96969696969697 0.00671785380705632
0.98989898989899 0.00224281094805
1.01010101010101 0
1.03030303030303 0
1.05050505050505 0
1.07070707070707 0
1.09090909090909 0
1.11111111111111 0
1.13131313131313 0
1.15151515151515 0
1.17171717171717 0
1.19191919191919 0
1.21212121212121 0
1.23232323232323 0
1.25252525252525 0
1.27272727272727 0
1.29292929292929 0
1.31313131313131 0
1.33333333333333 0
1.35353535353535 0
1.37373737373737 0
1.39393939393939 0
1.41414141414141 0
1.43434343434343 0
1.45454545454545 0
1.47474747474747 0
1.4949494949495 0
1.51515151515152 0
1.53535353535354 0
1.55555555555556 0
1.57575757575758 0
1.5959595959596 0
1.61616161616162 0
1.63636363636364 0
1.65656565656566 0
1.67676767676768 0
1.6969696969697 0
1.71717171717172 0
1.73737373737374 0
1.75757575757576 0
1.77777777777778 0
1.7979797979798 0
1.81818181818182 0
1.83838383838384 0
1.85858585858586 0
1.87878787878788 0
1.8989898989899 0
1.91919191919192 0
1.93939393939394 0
1.95959595959596 0
1.97979797979798 0
2 0
};
\addlegendentry{High noise}

% wrapfigure beyond denoising
%\nextgroupplot[ylabel=Robust Risk $\hat R_{\advnoiselevel} / n$, ymin=-0.1, ymax=4.11, xmin=-0.01, xmax=0.31]

\nextgroupplot[
    ylabel={Robust Risk $R_{\advnoiselevel}/n$},
    legend cell align={left},
    ymin = 0.2, ymax = 2.0,
    xmin = -0.01, xmax = 0.155,
    legend style={
      font=\small,
      fill opacity=0.8,
      draw opacity=1,
      text opacity=1,
      %at={(1.3,0.9)},
      at={(1.405,1.0)},
      anchor=north,
      draw=lightgray204
    },
    %xtick={0.0, 0.05, 0.1},
    %xticklabels={0.0, 0.05, 0.1},
    xtick={0.0, 0.05, 0.1, 0.15},
    xticklabels={0.0, 0.05, 0.1, 0.15},
    title={Robustness beyond denoising},
]

\addplot [draw=blue, fill=blue, forget plot, mark=*, only marks, mark size=1.3]
table {%
x y
0.	0.269885
0.0161119	0.600112
0.0322238	0.786443
0.0483357	0.949994
0.0644476	1.102
0.0805595	1.24675
0.0966714	1.38643
0.112783	1.52232
0.128895	1.65523
0.145007	1.78574
%0.161119	1.91426
%0.177231	2.04111
%0.193343	2.1665
%0.209455	2.29064
%0.225567	2.41368
%0.241679	2.53573
%0.25779	2.6569
%0.273902	2.77728
%0.290014	2.89694
%0.306126	3.01595
%0.322238	3.13435
%0.33835	3.2522
};

\addplot [very thick, blue]
table {%
x y
0.	0.269885
0.0161119	0.600112
0.0322238	0.786443
0.0483357	0.949994
0.0644476	1.102
0.0805595	1.24675
0.0966714	1.38643
0.112783	1.52232
0.128895	1.65523
0.145007	1.78574
%0.161119	1.91426
%0.177231	2.04111
%0.193343	2.1665
%0.209455	2.29064
%0.225567	2.41368
%0.241679	2.53573
%0.25779	2.6569
%0.273902	2.77728
%0.290014	2.89694
%0.306126	3.01595
%0.322238	3.13435
%0.33835	3.2522
};
\addlegendentry{Standard}

\addplot [draw=orange, fill=orange, forget plot, mark=*, only marks, mark size=1.3]
table {%
x y
0.	0.269872
0.0161119	0.485841
0.0322238	0.562599
0.0483357	0.61819
0.0644476	0.663152
0.0805595	0.701461
0.0966714	0.735113
0.112783	0.765271
0.128895	0.792676
0.145007	0.81783
%0.161119	0.841089
%0.177231	0.86271
%0.193343	0.882879
%0.209455	0.901729
%0.225567	0.919347
%0.241679	0.935776
%0.25779	0.951011
%0.273902	0.964981
%0.290014	0.977512
%0.306126	0.988241
%0.322238	0.996383
%0.33835	1.
};

\addplot [very thick, orange]
table {%
x y
0.	0.269872
0.0161119	0.485841
0.0322238	0.562599
0.0483357	0.61819
0.0644476	0.663152
0.0805595	0.701461
0.0966714	0.735113
0.112783	0.765271
0.128895	0.792676
0.145007	0.81783
%0.161119	0.841089
%0.177231	0.86271
%0.193343	0.882879
%0.209455	0.901729
%0.225567	0.919347
%0.241679	0.935776
%0.25779	0.951011
%0.273902	0.964981
%0.290014	0.977512
%0.306126	0.988241
%0.322238	0.996383
%0.33835	1.
};
\addlegendentry{Adversarial}

\addplot [draw=purple, fill=purple, forget plot, mark=*, only marks, mark size=1.3]
table {
x y
0.	0.270027
0.0161119	0.496685
0.0322238	0.579228
0.0483357	0.63869
0.0644476	0.686323
0.0805595	0.726424
0.0966714	0.76117
0.112783	0.791836
0.128895	0.819237
0.145007	0.843931
%0.161119	0.86631
%0.177231	0.886661
%0.193343	0.905195
%0.209455	0.922066
%0.225567	0.937384
%0.241679	0.951218
%0.25779	0.9636
%0.273902	0.974522
%0.290014	0.983919
%0.306126	0.991636
%0.322238	0.997335
%0.33835	1.
};

\addplot [very thick, purple]
table {
x y
0.	0.270027
0.0161119	0.496685
0.0322238	0.579228
0.0483357	0.63869
0.0644476	0.686323
0.0805595	0.726424
0.0966714	0.76117
0.112783	0.791836
0.128895	0.819237
0.145007	0.843931
%0.161119	0.86631
%0.177231	0.886661
%0.193343	0.905195
%0.209455	0.922066
%0.225567	0.937384
%0.241679	0.951218
%0.25779	0.9636
%0.273902	0.974522
%0.290014	0.983919
%0.306126	0.991636
%0.322238	0.997335
%0.33835	1.
};
\addlegendentry{Jittering}

\end{groupplot}

\end{tikzpicture}