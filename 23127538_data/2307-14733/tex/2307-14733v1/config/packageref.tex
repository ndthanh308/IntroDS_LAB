\usepackage{xcolor,colortbl}
\usepackage{graphicx}
\usepackage{color}
\usepackage{pifont}
\usepackage{ifthen}
\usepackage{multirow}
\usepackage{booktabs}
\usepackage[inline]{enumitem}
\usepackage[ruled,linesnumbered]{algorithm2e}
\usepackage{tcolorbox}
\usepackage{booktabs}
\usepackage{tabularx}
\newcolumntype{L}{>{\raggedright\arraybackslash}X}%
\newcolumntype{R}{>{\raggedleft\arraybackslash}X}%
\newcolumntype{C}{>{\centering\arraybackslash}X}%
\usepackage{listings}
\lstset{
    breaklines=true,
    frame=lines,
    basicstyle=\ttfamily\scriptsize,
    keywordstyle=\color{purple}\bfseries,
    stringstyle=\color{brown},
    commentstyle=\color{teal},
    captionpos=b,
    xleftmargin=6pt,
    numbersep=3pt,
    numbers=left,
    tabsize=2,
}

\usepackage{relsize}
\usepackage{threeparttable}
\usepackage{amsmath}
\usepackage{mathtools}
\usepackage{tikz}
% \usepackage{stackengine}
\usepackage{fontawesome}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{titlesec}
\usepackage{xspace}

\usepackage{gnuplottex}

% Workaround for bugs in lstlinebgrd
% From https://tex.stackexchange.com/questions/451532/recent-issues-with-lstlinebgrd-package-with-listings-after-the-latters-updates
% It works although I don't know why.
\usetikzlibrary{shapes,positioning}
\makeatletter
\let\old@lstKV@SwitchCases\lstKV@SwitchCases
\def\lstKV@SwitchCases#1#2#3{}
\makeatother
\usepackage{lstlinebgrd}
\makeatletter
\let\lstKV@SwitchCases\old@lstKV@SwitchCases

\lst@Key{numbers}{none}{%
    \def\lst@PlaceNumber{\lst@linebgrd}%
    \lstKV@SwitchCases{#1}%
    {none:\\%
        left:\def\lst@PlaceNumber{\llap{\normalfont
                \lst@numberstyle{\thelstnumber}\kern\lst@numbersep}\lst@linebgrd}\\%
        right:\def\lst@PlaceNumber{\rlap{\normalfont
                \kern\linewidth \kern\lst@numbersep
                \lst@numberstyle{\thelstnumber}}\lst@linebgrd}%
    }{\PackageError{Listings}{Numbers #1 unknown}\@ehc}}
\makeatother
