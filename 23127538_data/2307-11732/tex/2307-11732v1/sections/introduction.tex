\raggedbottom
\section{Introduction}
\label{sec:intro}

Online ad auctions are an integral part of contemporary e-commerce. As end users interact with services or online stores such as Google, Facebook, or Amazon, advertisers compete to secure slots, aiming to display their ads to those prospective customers who are most likely to engage with them, and eventually lead to conversions.

The prevalence of such auctions has led to the development of a large literature in both Economics and Computer Science. The vast majority of these contributions focus on relatively simple auction formats, in which one or more ad slots are sold using so-called generalized first- or second-price auctions \citep{edelman2007internet,varian2009online}. These mechanism adapt the first- and second-price mechanisms from ``textbook'' auction theory \citep{myerson1981optimal,krishna2009auction} to account for the fact that online advertising services often charge prices \emph{per click} rather than \emph{per impression}.\footnote{That is, the winner is charged if / when the user clicks on the winning ad, rather than when the winning ad is displayed. The key issue is that the ``click-through rates'' (probabilities that the user clicks on displayed ads) typically vary across advertisers; auction mechanisms must then be adjusted to provide incentives for advertisers to bid according to their true value for showing an ad.}

However, real-world online ad auction are highly complex.\footnote{For standard auctions, equilibrium behavior can be characterized, and conditions leading to revenue equivalence or revenue ranking can be established \citep{myerson1981optimal,milgrom1982theory}.} This makes it virtually impossible to analyze equilibrium bidding behavior and compare the performance (e.g., revenues) of different auction formats. As a result, businesses selling online ad space lack principled guidance as to which auction format to adopt. \normalcolor

We propose that simulating advertisers' behavior using well-understood online-learning algorithms can provide such guidance. To demonstrate this, we develop an approach that allows for the following key departure from standard auction formats and their generalized variants: 
\begin{enumerate}
    \item The value of an impression or click for a given ad (and slot), as well as its click through rate, may vary depending on the shopper's query, identity, and history. Advertisers can choose ``targeting clauses'' to only bid on certain sets of queries, but cannot condition their bid on individual queries.
    \item The number and identity of advertisers changes from one auction to the next. However, advertisers do not observe who they are facing in each individual auction.\footnote{That is, we model auctions as games of \emph{incomplete information} with a \emph{random} number of participants.}
    \item Advertisers receive only incomplete feedback about the outcome of each individual auction. In particular, they do not observe other advertisers' bids, and they only learn the market-clearing price if they win the auction.
    \item Pricing mechanisms are often incompletely specified. For instance, ad services may indicate that reserve prices are used, but not what they are, or how they are computed.\footnote{See for instance the \href{https://support.google.com/google-ads/answer/7634668?hl=en&ref_topic=24937}{documentation for Ad Thresholds} in Google Ads.}
\end{enumerate} 
% 
To reflect the scant information bidders possess when they participate in real-world ad auctions, we choose learning algorithms that only require  feedback about \emph{individual} rewards, and are \emph{not tailored} to any specific auction format. In addition, we want our model to be able to handle auctions in which the number of participants and bid space is realistic. 
We focus on two algorithms: \texttt{Hedge} \citep{auer1995gambling} and  \texttt{EXP3-IX} \citep[Chap. 12]{lattimore2020bandit}. These algorithms, with known regret bounds, are applied in auction learning literature and exemplify full- and partial-information algorithms respectively.

We provide two sets of results. In the first set presented in \S \ref{sec:results:textbook} and \S \ref{sec:results:SFRP}, we assign artificial valuations to bidders and simulate their bidding behavior. We consider both small and large number of bidders. We also allow a dense bid grid, especially compared with earlier studies, and complex auction environments with multi-query targeting and soft-floor reserve prices. These results demonstrate how our approach enables performance comparisons across different auction formats. In symmetric, single-query environments, our approach reassuringly approximates theoretical predictions, including revenue equivalence \citep{myerson1981optimal}, indicating that despite differing bidding behaviors across auction formats, the seller's revenues remain roughly constant. On the other hand, we find that, with multi-query targeting, soft floors can lift revenues, even if bidders are ex-ante symmetric. The second set of results presented in \S \ref{sec:results:bid-shading-prod}, instead demonstrates how to use our approach to solve the inverse problem, inferring bidders' valuations through an iterative parameter search matching bid data\footnote{This is similar to structural estimation in empirical industrial organization. The key difference is that the structural equations are not derived from Bayesian Nash equilibrium behavior, but from the predictions of our learning model.}. To do so, we employ aggregate bid data from an actual production environment (a major e-commerce website). 

\subsection{Related Literature}
\label{sec:related}

There is a vast literature in Economics that studies games from the perspective of learning agents; \citet{fudenberg1998theory} provides an authoritative account.

In computer science, the literature on online learning in auctions can be roughly divided into two branches. The first takes the perspective of the seller and studies the design of revenue-maximizing auctions; recent studies include \citet{roughgarden2019minimizing},  \citet{guo2021robust}, and \citet{Jeunen2023}. This branch of the literature studies sellers who employ learning algorithms, but bidders are not explicitly modelled. 

The second branch instead takes the perspective of a single bidder who uses learning algorithms to guide her bidding process. \citet{weed2016online} focus on second-price auctions for a single good, and assume that the valuation can vary either stochastically or adversarially in each auction. In a similar environment, \citet{balseiro2018contextual} and \citet{han2020optimal} study contextual learning in first-price auctions, where the context is provided by the bidder's value. For auctions in which the bidder must learn her own value (as is often the case in the settings we consider), \citet{feng2018learning} proposes an improved version of the \texttt{EXP3} algorithm that attains a tighter regret bound. There is also a considerable literature that studies optimal bidding with a budget constraint using reinforcement-learning: e.g., \citet{wu2018budget}, \citet{ghosh2020optimal}, and references therein. 

Our paper differs from the above references since it models the \emph{interaction} among bidders who adopt online learning algorithms. In this sense, it is closer in spirit to the Economics literature on learning in games. In addition, unlike the present paper, the cited references assume that the winning bidder observes her valuations and payment in each period; some of these papers leverage insights that depend on specific auction format; and all are concerned with auctions for a single object or ad slot. 

To the best of our knowledge, the closest papers to our own are \citet{kanmaz2020using}, \citet{elzayn2022equilibria}, and \citet{jeunen2022learning}. The first reports on experiments using a multi-agent reinforcement-learning model in simple sequential (English) auctions for a single object, with a restricted bid space. Our analysis focuses on simultaneous bidding in scenarios that are representative of actual online ad auctions. The second focuses on position (multi-slot) auctions and, among other results, reports on experiments using no-regret learning (specifically, the \texttt{Hedge} algorithm we also use) under standard generalized second-price and Vickerey-Groves-Clarke pricing rules. Our analysis is complementary in that we allow for different targeting clauses and more complex pricing rules such as ``soft floors''. The third describes a simulation environment similar to ours that is mainly intended to help train sophisticated bidding algorithms for advertisers. We differ in that we allow for bids broadly targeting multiple queries, and focus on learning algorithms that allow us to model auctions with a large number of bidders; in addition, we demonstrate how to infer values from observed bids.

\citet{feng2021convergence} establish the convergence to equilibrium of learning algorithms in first- and second-price auctions, as well as multi-slot VCG mechanisms. Our results in \S \ref{sec:results:textbook} provide an empirical counterpart to their theoretical results, but also add nuance as to the speed of convergence of different algorithms in realistic-sized auctions. \citet{hartline2015coarseBCE} establish the convergence of no-regret learning to coarse Bayes correlated equilibrium in general games with incomplete information; we leverage their results in \S \ref{sec:coarseBCE}.

\citet{nekipelov2015econometrics} proposes techniques for estimating agents' valuations in generalized second-price auctions, which stands in contrast to our method that directly utilizes agents' learning algorithms and is independent of the specific auction format. In a different direction,
\citet{rahme2021auction} study revenue maximization in auctions as a mechanism design problem, assuming a static ``no regret'' constraint for bidders, which in general differs from the no regret condition in online learning. \citet{peysakhovich2019robust} presents a method to predict player behavior in an unseen game. Unlike our approach, they base their predictions on an $\epsilon$-Bayesian Nash equilibrium instead of no-regret learning. \citet{bichler2021learning} suggests a method to calculate $\epsilon$-Bayesian Nash equilibria in sealed-bid auctions, focusing more on approximating equilibria, as opposed to directly modeling bidder learning behavior.

Finally, we mention equilibrium analyses of bidding and ad exchanges that provide results related to our simulation findings. \citet{choi2019learning} analyze auctions in which a new entrant's click-through rate is not known to the publisher. \citet{despotakis2021first} demonstrates that, with competing ad exchanges, a multi-layered auction involving symmetric bidders can result in a scenario where first-price auctions, and soft floors in general, yield higher revenue than second-price auctions. When multiple slots are offered, \citet{rafieian2021targeting} shows that, when advertisers can target their bids to  specific placements in second-price auctions, total surplus increases, but the effect on publisher revenues is ambiguous, the key difference being that we consider a single slot with randomly arriving queries, rather than multiple slots that are always offered for sale.

