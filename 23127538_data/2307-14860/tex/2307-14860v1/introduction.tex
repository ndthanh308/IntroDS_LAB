\section{Introduction}
Accelerators and GPUs impacted critically both HPC applications and machine learning workloads. Outstanding advancement examples are the acceleration of molecular dynamics software~\cite{andersson2022breaking}, molecular docking~\cite{schieffer2023tcu}, computational fluid dynamics~\cite{karp2022large}, plasma codes~\cite{chien2020sputnipic}, and weather forecast~\cite{fuhrer2018near}. GPUs revived deep-learning applications after the long AI winter~\cite{krizhevsky2017imagenet}. In the current days, there is no efficient and large-scale deep neural network training without accelerators and specialized hardware. This study focuses on understanding whether GPU acceleration is a key technology for an emerging HPC application that is the usage of classical computing for simulating current and upcoming quantum computers. The question we want to answer in this work is: \emph{are GPUs suitable and a key enabling technology for the acceleration of quantum computer simulations?} %

Quantum computer simulators are a key tool for the development of quantum computing. In fact, the design and implementation of large-scale, reliable quantum computing infrastructure (hardware, software and algorithmic) require the deployment of quantum computer simulators. These tools can drive quantum computer design choices, prototyping quantum algorithms in ideal and noisy controlled environments, and verifying the correctness of the real quantum computer. In fact, most of the current quantum algorithmic development depends on prototyping the algorithms and running on quantum computer simulators to assess the correctness of the results in controlled environments and the impact of noise and error on the algorithms.

From the general stand-point, there exist two main categories for quantum computer simulators. The first category models quantum computer closer to the hardware and describes how to control pulses (typically microwave pulses in superconducting and trapped ion systems) to implement quantum circuit operations. These simulators go under the name of pulse-level simulators. Examples of these are the IBM OpenPulse~\cite{gokhale2020optimized} and PASQAL Pulser~\cite{silverio2022pulser}. The second approach is at higher-level and much more common in use. It uses abstractions, such as quantum gates and circuits. This class includes several simulation techniques, among which state vector (also called \textit{Schr√∂dinger}), tensor network contraction~\cite{markov2008simulating}, and Feynman path~\cite{markov2018quantum} techniques are the most important ones. By far, currently the most established quantum simulator is the state vector quantum computer simulator because of its simplicity and easiness of implementation. Differently from other algorithms, state vector is not suitable for noisy simulations (density matrix is a convenient approach instead) and it is limited to a simulation with a relatively small number of qubits (the basic unit of information in quantum computing), e.g. $\le$ 48 qubits on the current largest HPC systems~\cite{wu2019full}. On the other hand, tensor networks can simulate hundreds to thousands qubits for low entangled networks but they do not provide the full state vector. The main limitation of state vector simulators is that memory usage scales exponentially with the number of qubits. For instance, a full state vector simulation requires the full memory of the Summit supercomputer, 2.8PB~\cite{wu2019full}. Because of these limitations, it is not clear whether the state vector quantum computer simulator might benefit from the usage of GPUs.

%
\input{include/statevecsim.tex}
%

This work has the goal of evaluating the suitability of GPUs for state vector computer simulators and identifying opportunities for their deployment on accelerated systems. To answer our research question, we use the IBM Qiskit Aer state vector simulator \cite{QiskitCommunity2017}, a state-of-the art quantum computer simulator, providing two backends for Nvidia GPUs: one with Nvidia Thrust and one with  Nvidia cuQuantum.

The contributions of this paper are the following:
\begin{itemize}
\item We develop a benchmark suite of six representative quantum applications that support scaling the number of qubits in a state vector quantum computer simulator.
\item We characterize and compare the performance of the state-of-the-art Qiskit Aer quantum computer simulator with three backends including CPU, GPU with Nvidia Thrust, and Nvidia cuQuantum on Nvidia A100 GPUs.
\item We analyze the impact of two critical optimizations in transpilation -- gate fusion and cache blocking, on different quantum applications.
\item Our evaluation on a single GPU identifies the most important functions in Nvidia Thrust and cuQuantum for different quantum applications and we built the roofline to identify compute and memory bottlenecks. 
\item Our evaluation on a multi-GPU setup identifies data movement between host and GPU as the top one factor limiting the performance of large-number qubit quantum applications. 
\end{itemize}
