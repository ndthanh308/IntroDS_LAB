


\section{Expressiveness of Labelled Vector Addition Systems with States}

``Sort of, non-determinism allows for greater factorisation, but generally are incomparable''.
There are languages that are recognised by deterministic two-counter automata that are also recognised by non-deterministic one-counter automata but are not recognised by deterministic one-counter automata (Claim~\ref{clm:2dvass-1vass}).
There are languages that are recognised by deterministic two-counter automata that are not recognised by non-deterministic one-counter automata (Claim~\ref{clm:2dvass-only}).

\begin{proposition}
    The language $L_1 \coloneqq \set{ a^n \, \# \, b^m \, \eur \, c^\ell : n \geq \ell } \cup \set{ a^n \, \# \, b^m \, \gbp \, c^\ell : m \geq \ell }$ is recognised by a 2-DVASS and is recognised by a 1-VASS but is not recognised by any 1-DVASS.
    \label{pro:2dvass-1vass-language}
\end{proposition}

\hstodo{I think with some effort, I can generalise this to a language that is recognised by a $k$-DVASS and is recognised by a 1-VASS but is not recognised by any $(k-1)$-DVASS. {\bf is this of interest to have written out?}}

 % Figure environment removed

\hstodo{proof text probably best in appendix}
\begin{proof}
    See Figure~\ref{fig:vass-for-l1} for the 2-DVASS and 1-VASS each recognising $L_1$.
    
    Intuitively, a 2-DVASS can recognise $L_1$ by storing the number of `$a$'s on one counter and the number of `$b$'s on the other counter. 
    Then by either reading `$\eur$' or `$\gbp$', determinsitically branch to a negative cycle reading `$c$'s, thus limiting the number of `$c$'s read to be bounded by either the number of `$b$'s or the number of `$a$'s.
    On the other hand, A 1-VASS can recognise $L_1$ by storing either the number of `$a$'s read or by storing the number of `$b$'s read on the counter, deciding which is evaluated non-determinsitically.
    Then read `$\eur$' or `$\gbp$' when transitioning to a negative cycle reading `$c$'s, thus limiting the number of `$c$'s read to be bounded by either the number of `$b$'s or the number of `$a$'s.

  We will now argue that there does not exist a 1-DVASS recognising $L_1$.
    Suppose, for sake of contradiction, that there exists a 1-DVASS $\Vv$ such that $\lang(\Vv) = L_1$.
    Suppose also that $\Vv$ comprises of $n$ states.
    We will analyse the behaviour of $\Vv$ when witnessing words with the prefix $a^m\,\#\,b^m$ for $m > n$. 
    Consider the run $\rho$ in $\Vv$ that reads $a^m\,\#\,b^m$ and that ends at some state $q$ from which there must exist a path from $q$ to some accepting state that reads $\eur\,c^m$ and there must exist exist a path from $q$ to some accepting state that reads $\gbp\,c^m$.
    Since $m > n$, in $\rho$ there must exist a cycle reading `$a$'s (in order to read $a^m$) and a cycle reading `$b$'s (in order to read $b^m$). 
    Furthermore, after the run $\rho$, a cycle reading `$c$'s (in order to read $c^m$) must be used.
    If $\rho$ contains a positive cycle reading `$a$'s, then $\Vv$ accepts $a^{m + x} \, \# \, b^m \, \eur \, c^{m + y}$. 
    That is because there is a cycle $\gamma$ reading $c^y$ for some $y > 0$, and regardless of whether $\gamma$ has negative effect, there must exist a large enough $x$ that utilises the positive effect of the cycle reading `$a$'s to gain sufficient counter value to additionally iterate $\gamma$.
    However, $a^{m + x} \, \# \, b^m \, \eur \, c^{m + y} \notin L_1$ because the number of `$c$'s read is greater than the number of `$b$'s read in this word containing `$\eur$'.
    Likewise, if $\rho$ contains a positive cycle reading `$b$'s, then $\Vv$ accepts $a^m \, \# \, b^{m + x} \, \gbp \, c^{m + y}$, but $a^m \, \# \, b^{m + x} \, \gbp \, c^{m + y} \notin L_1$.

    
\gatodo{ Some suggestions:
    We will now argue that there does not exist a 1-DVASS recognising $L_1$.
    Suppose, for sake of contradiction, that there exists a 1-DVASS $\Vv$ such that $\lang(\Vv) = L_1$.
    Suppose also that $\Vv$ comprises of $n$ states. We will analyse the behaviour of $\Vv$ when witnessing words with the prefix $a^m\,\#\,b^m$ for $m > n$. Let $q$ denote the state that the run $\rho$ of $\Vv$ on $a^m\,\#\,b^m$ ends in. Note that there must exist a path from $q$ to some accepting state that reads $\eur\,c^m$ and there must exist a path from $q$ to some accepting state that reads $\gbp\,c^m$. Further note that since $m > n$, both of these paths must contain a cycle reading `$c$'s. Moreover, in $\rho$, there must exist cycles $\gamma_a$ and $\gamma_b$ reading `$a$'s and `$b$'s in the respective locations of $\rho$. If $\gamma_a$ is positive, then $\Vv$ accepts $a^{m + x} \, \# \, b^m \, \eur \, c^{m + y}$.} 


    Now suppose that $\rho$ does not traverse a positive cycle when reading $a^m$ and $\rho$ does not traverse a positive cycle when reading $b^m$. 
    Consider whether or not the cycle reading `$c$'s is negative.
    If there is a non-negative cycle, after $\rho$, reading `$c$'s, then $a^m \, \# \, b^m  \, \gbp \, c^{m + y}$ is accepted by $\Vv$, but $a^m \, \# \, b^m  \, \gbp \, c^{m + y} \notin L_1$.
    Otherwise, there is a negative cycle, after $\rho$, reading $c^m$.
    Since $a^m$ was read by a non-positive cycle in $\rho$, then $a^{m+x} \, \# \, b^m  \, \gbp \, c^{m + x}$ is not accepted by $\Vv$ for some large enough $x$. 
    However, this contradicts the fact that $a^{m+x} \, \# \, b^m  \, \gbp \, c^{m + x} \in L_1$.
    Finally, we are able to conclude that no such 1-DVASS $\Vv$ recognising $L_1$ exists.

    
\end{proof}

\hstodo{I reckon this generalises, for example to the third dimension, you could have $$L_3 = \set{ a_1^{n_1} \, a_2^{n_2} \, a_3^{n_3} \, c_1 \, e^\ell : n_1 > \ell} \cup \set{ a_1^{n_1} \, a_2^{n_2} \, a_3^{n_3} \, c_2 \, e^\ell : n_2 > \ell } \cup \set{ a_1^{n_1} \, a_2^{n_2} \, a_3^{n_3} \, c_3 \, e^\ell : n_3 > \ell }$$ that is recognised by a 3-DVASS and a 1-VASS (in the same style as above) question is: can this language be recognised by a 2-DVASS? (clearly it is not recognised by a 1-DVASS, for the same idea as above). Then, better that that, can one generalise to $$L_k = \bigcup_{i=1}^k \set{ a_1^{n_1} \cdots a_i^{n_i} \cdots a_k^{n_k} \, c_i \, e^\ell : n_i > \ell }$$ that may be a language recognised by a $k$-DVASS and a 1-VASS, but \emph{not} by a $(k-1)$-DVASS?} 
\aytodo{I agree with you that it generalises well, although it may be complex to prove it formally}

\begin{proposition}
    The language $L_2 \coloneqq \set{ a^k \,\#\, b^\ell \,\#\, c^m \,\#\, d^n : k \geq m \wedge \ell \geq n }$ is recognised by a 2-DVASS but is not recognised by any 1-VASS.
    \label{pro:2dvass-language}
\end{proposition}

% Figure environment removed

\begin{proof}
    See Figure~\ref{fig:2dvass-for-l2} for the 2-DVASS recognising $L_2$.

    Intuitively, a 2-DVASS can recognise $L_2$ by storing the number of `$a$'s on one counter and the number of `$c$'s on the other counter.
    Then the number of `$b$'s that follow can be limited by subtracting the number of `$b$'s read from the same counter that stored how many `$a$'s were read.
    Similarly, the number of `$d$'s that follow can be limited by subtracting the number of `$d$' read from the same counter that stored how many `$c$'s were read.

    We will now argue that there does not exist a 1-VASS recognising $L_2$.
    Suppose, for sake of contradiction, that there exists a 1-VASS $\Vv$ recognising $L_2$.
    Suppose also that $\Vv$ comprises of $n$ states and $M$ is the absolute value of the largest transition effect.
    We will analyse the behaviour of $\Vv$ when witnessing the word $w = a^m\,\#\,b^m\,\#\,c^m\,\#\,d^m$ for $m > n\cdot M$.
    Since $m > n$, any run witnessing $w$ must take some cycle reading `$a$'s, some cycle reading `$b$'s, some cycle reading `$c$'s, and some cycle reading `$d$'s.

    First, it is never the case that a cycle reading `$c$'s or `$d$'s has non-negative effect, otherwise $\Vv$ accepts a word $a^m\,\#\,b^m\,\#\,c^{m+x}\,\#\,d^m \notin L_2$ or $a^m\,\#\,b^m\,\#\,c^m\,\#\,d^{m+x} \notin L_2$, for some $x > 0$.
    Now, among all runs witnessing $w$, it must be the case that either a positive cycle reading `$a$'s or a positive cycle reading `$b$'s was taken.
    Else, if all cycles reading `$a$'s and `$b$'s had non-positive effect, then the maximum counter value observed in any run witnessing $w$ is bounded above by $n\cdot M$.
    Since the cycles reading `$c$'s and `$d$'s always have negative effect, it would not be possible to read the suffix $c^m\,\#\,d^m$ of $w$ without violating the counter.

    Let us now suppose, without loss of generality, that there exists a positive cycle $\pi$ reading `$a$'s.
    Recall that also exists a negative cycle $\nu$ reading `$d$'s.
    We can arbitrarily increase the counter value using $\pi$ to then take an additional iteration of $\nu$ later in the run.
    Hence, $a^{m+x}\,\#\,b^m\,\#\,c^m\,\#\,d^{m+y}$ is accepted by $\Vv$ for some $y>0$ and some $x$ large enough, however $a^{m+x}\,\#\,b^m\,\#\,c^m\,\#\,d^{m+y} \notin L_2$.
    Symmetrically, the same argument holds if instead there does not exist a positive cycle reading `$a$'s but there does exist a positive cycle reading `$b$'s.
    Therefore, we are able to conclude that no such 1-VASS $\Vv$ recognising $L_2$ exists.
\end{proof}
\hstodo{another question of generalisation, are there languages that are recognised by a $k$-DVASS that are not recognised by $(k-1)$-VASS? ... this is less clear to me, but my guess would be to consider $$L'_k = \set{ a_1^{n_1} \cdots a_k^{n_k} c_1^{x_1} \cdots c_k^{x_k} : x_1 \leq n_1, \ldots, x_k \leq n_k }.$$ This is a language recognised by a $k$-DVASS (just use one counter per pair of letters to ensure the $k$ `$\leq$' are held), then question is is this \emph{not} recognised by a $k-1$-VASS? ... I think this is true, and perhaps the only proof direction could be via Asaf's technique of \emph{mega-cycle-analysis-by-many-comparisons-for-bad-pumping}$^{\textup{[TM]}}$.}
\aytodo{Again I agree with you that it works, but I'm not sure even my trade marks works here :)}
\hstodo{given this a bit more thought, and it seems really tough to generalise this one!}

% \begin{proposition}
%     Let $\Vv$ be a $k$-DVASS, then $\lang(\Vv) = \lang(\proj{\Vv}{1}) \cap \cdots \cap \lang(\proj{\Vv}{k})$.
%     \label{pro:dvass-projection}
% \end{proposition}
% \begin{proof}
%     We will directly show that both sides of the language inclusion hold.

%     If $w \in \lang(\Vv)$, then by following the same path of the run witnessing $w$, it follows that $w \in \lang(\proj{\Vv}{1}), \,\ldots,\, w \in \lang(\proj{\Vv}{k})$, so $w \in \lang(\proj{\Vv}{1}) \cap \cdots \cap \lang(\proj{\Vv}{k})$ holds.
    
%     If $w \in \lang(\proj{\Vv}{1}) \cap \cdots \cap \lang(\proj{\Vv}{k})$, then $w \in \lang(\proj{\Vv}{1}), \,\ldots,\, w \in \lang(\proj{\Vv}{k})$ each holds. 
%     Each 1-DVASS $\proj{\Vv}{1}, \ldots, \proj{\Vv}{k}$ has the same underlying state and labelled transition structure, so the paths underlying the runs witnessing $w$ $\proj{\Vv}{1}, \ldots, \proj{\Vv}{k}$ must be the same.
%     Therefore, by considering the $k$-DVASS $\Vv$ and following the same path for $w$, it must be true that $w \in \lang(\Vv)$ as none of the $k$ counters take negative values. 
% \end{proof}

% \begin{corollary}
%     There does not exist a dimension prime $k$-DVASS for any $k \geq 2$.
%     \label{cor:no-prime-2dvass}
% \end{corollary}

\begin{proposition}
    Given a labelled 2-VASS $\Aa$, verifying whether $\lang(\Aa) \supseteq \lang(\Aa[1])$ is undecidable. 
    \label{pro:extra-dimension-2-undecidable}
\end{proposition}

\hstodo{do we still care for this ``add a dimension'' problem?}

\begin{proof}
    We will present a reduction to the language inclusion problem between two non-deterministic 1-VASS $\Uu = (P, \Sigma, S, p_s, E)$ and $\Vv = (q, \Sigma, T, q_s, F)$ that is undecidable [find citation].

    % Figure environment removed
    
    Let us construct $\Aa$; include a starting state $q$ branching to a modified copy $\Uu'$ of $\Uu$ via transition $s$ and a modified copy $\Vv'$ of $\Vv$ via transition $t$.
    Importantly, the modifications apply the counter updates of the two 1-VASS only to the first counter of the 2-VASS $\Aa$.
    More precisely, we define $\Uu' = (P, \Sigma, S', p_s, E)$ where $S' = \set{ (p, \sigma, (u, 0), p') : (p, \sigma, u, p') \in S}$ and $\Vv' = (Q, \Sigma, T', q_s, F)$ where $T' = \set{ (q, \sigma, (v, 0), q') : (q, \sigma, v, q') \in T}$.
    Note that $\lang(\Uu') = \lang(\Uu)$ and $\lang(\Vv') = \lang(\Vv)$.
    Consider the transitions $s = (q, \varepsilon, (0, -1), p_s)$ to $\Uu'$ and $t = (q, \varepsilon, (0, 0), q_s)$ to $\Vv'$.
    See Figure~\ref{fig:extra-dimension-2-undecidable} for a schematic overview of $\Aa$.
    Given the negative effect, the transition $s$ cannot be traversed from $q(0, 0)$ in $\Aa$, hence $\lang(\Aa) = \lang(\Vv') = \lang(\Vv)$.
    However in the projected labelled 1-VASS $\Aa[1]$, the projection $(q, \varepsilon, 0, p_s)$ of the transition $s$ can be traversed from $q(0)$, therefore $\lang(\Aa[1]) = \lang(\Uu') \cup \lang(\Vv') = \lang(\Uu) \cup \lang(\Vv)$.
    Thus $\lang(\Aa) \supseteq \lang(\Aa[1]) \iff \lang(\Vv) \supseteq \lang(\Uu) \cup \lang(\Vv) \iff \lang(\Uu) \subseteq \lang(\Vv)$.
\end{proof}

% Figure environment removed

\subparagraph*{The remainder of this section is for intersting examples that have been asked for, probably to be moved to a different, more relevant section when the text is `fuller' so to say.}

% Figure environment removed

% Figure environment removed

% Figure environment removed