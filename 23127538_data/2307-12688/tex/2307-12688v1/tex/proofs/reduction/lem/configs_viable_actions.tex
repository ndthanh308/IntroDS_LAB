%
% ! (lemma 23) : only send or recv viable (changed from fe)
\begin{lemma}\label{lem:typing_configs_viable_actions}
    %
    Given a \VIso*\ that is both \emph{well-formed} and \isFE*, both of the following hold:
    \begin{enumerate}
        \item\label{itm:typing_configs_viable_actions_lem_i} If $\exists\Msg$ such that \Trans*{\VIso}:{\SendMsg}\ then $\nexists\Msg'$ such that \Trans*{\VIso}:{\RecvMsg}.
        %
        \item\label{itm:typing_configs_viable_actions_lem_ii} Similarly, if $\exists\Msg$ such that \Trans*{\VIso}:{\RecvMsg}\ then $\nexists\Msg'$ such that \Trans*{\VIso}:{\SendMsg}.
    \end{enumerate}
    %
\end{lemma}
\begin{proof}
    %
    By the hypothesis, the judgement \ITJudgement*;{\Const}[\TypeS]\ holds against the formation rules given in~\cref{fig:types_rule}.
    %
    The proof proceeds considering~\cref{itm:typing_configs_viable_actions_lem_i} of the hypothesis, as~\cref{itm:typing_configs_viable_actions_lem_ii} is similar.
    % $\Trans{\VIso}:{\CommAction}\Implies\Trans{\VIso}:{\CommAction'}$ where $\CommAction\neq\CommAction'$, which are 
    The transition \Trans*{\VIso}:{\SendMsg}\ only possible via either
    \begin{inline}|.
        \item \LblCfgIsoInteract*
        \item \LblCfgIsoUnfold*
    \end{inline} of~\cref{fig:typesemantics}.
    %
    By induction on the depth of the derivation tree, analysing the last rule applied:
    \begin{inductivecase}
        %
        % ~ interact
        \item\NewCase[\LblCfgIsoInteract*]\label{case:typing_configs_viable_actions_interact} Then $\TypeS=\TypInteract$ and $\exists\AsSet[j][i]$ such that \Sat*:[\Const_j]\ and $\TypComm_j=\TypSend$.
        %
        By the hypothesis \TypeS*\ must adhere to the formation rules in~\cref{fig:types_rule}; in particular with \LblTypChoice*.

        Suppose $\exists\AsSet[k][i]$ such that \Sat*:[\Const_k]\ %
        and $\TypComm_k=\TypRecv$,
        and both \Trans*{\CIso}:{\SendMsg_j}\
        and \Trans*{\CIso}:{\RecvMsg_k}\ hold;
        by the premise of \LblTypChoice*, as $\TypComm_j\neq\TypComm_k$ then $\Const_j\cap\Const_k=\emptyset$ must hold.
        and both \Sat*:[\Const_j]\
        and \Sat*:[\Const_k] cannot hold.
        %
        Therefore the hypothesis holds for~\cref{itm:typing_configs_viable_actions_lem_i}, and similarly for~\cref{itm:typing_configs_viable_actions_lem_ii}.
        %
        % ~ recursion
        \item\NewCase[\LblCfgIsoUnfold*]\label{case:typing_configs_viable_actions_recursion} \TODO[recusive case].
        %
    \end{inductivecase}
    %
\end{proof}
% 