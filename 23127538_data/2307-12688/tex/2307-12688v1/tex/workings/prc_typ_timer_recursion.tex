
% \endinput

\subsection{Example Types \& Processes}

\begin{equation}
    \begin{array}[c]{r c l}
        %
        \TypeS & = & %
        \IChoice[%
            \IType?{a}[x\leq 1][x].{%
                \IType!{c}.{%
                    \IRecDef[a].{%
                        \IChoice[%
                            \IType?{d}[x\leq 1],%
                            \IType!{e}[1<x].{\IRecCall[a]}%
                        ]%
                    }%
                }%
            },%
            \IType!{b}[2<x<3]%
        ]%
        %
        \\[2ex]%
        \\[2ex]%
        \Prc & = & %
        \PSet{x}.{%
            \PRecv[a]:{% * recv
                \PSet{x}.{%
                    \PSend[c].{%
                        \PDefRec:{%
                            \PRecv[d]<{1}>{% * after
                                \PRec%
                            }%
                        }%
                    }%
                }%
            }<{1}>{% * after 1
                \PDelay[t=1].{%
                    \PIf[2<x<3]% * use defaults (then end, else fail)
                }%
            }%
        }%
        %
    \end{array}
\end{equation}

\begin{equation}
    \begin{array}[c]{r c l}
        %
        \Dual[\TypeS] & = & %
        \IChoice[%
            \IType!{a}[y\leq 1][y].{%
                \IType?{c}.{%
                    \IRecDef[b].{%
                        \IChoice[%
                            \IType!{d}[y\leq 1],%
                            \IType?{e}[1<y].{\IRecCall[b]}%
                        ]%
                    }%
                }%
            },%
            \IType?{b}[2<y<3]%
        ]%
        %
        \\[2ex]%
        \\[2ex]%
        \Qrc & = & %
        \PSet{y}.{%
            \PIf[y\leq 1]:{\PThen[%
                \PSend_{q}[a].{%
                    \PSet{y}.{%
                        \PRecv_{q}[c]:{%
                            \PDefRec:{%
                                \PIf[y\leq 1]:{\PThen[%
                                    \PSend_{q}[d]%
                                ]}:{\PElse[%
                                    \PRecv_{q}[e]:{%
                                        \PRec%
                                    }%
                                ]}%
                            }%
                        }%
                    }%
                }%
            ]}:{\PElse[%
                \PDelay[t=1].{%
                    \PRecv[b]<{1}% * after: failed
                }%
            ]}%
        }%
        %
    \end{array}
\end{equation}

\subsection{Experiments}

\begin{equation}
    %
    \Tup(1,2,3 ,5, 3)%
    %
\end{equation}

\begin{equation}
    %
    \Tup(\ValClocks, \IType)%
    %
\end{equation}


\begin{equation}
    %
    \ITypeAct%
    \ITypeAct!%
    \ITypeAct?%
    %
\end{equation}

\subsubsection{Configs}


\subsection{judgements}


\begin{itemize}
    \item \IPJudgement*
    \item \IPJudgement*[\VarEnv_1]:{\PrcMsg:\DataType_\MsgType}<[\Qrc]>[\SesEnv_2]:{\PrcP\PrcQ:\emptyset}
    \item \IPJudgement*>[\SesEnv_2]:{\PrcP\PrcQ:\emptyset}
    \item \IPJudgement*<[\Qrc]>
    \item \IPJudgement*[\VarEnv_1]:{\PrcMsg:\DataType_\MsgType}
\end{itemize}

\begin{equation}
    %
    \IPJudgement<[\PCalcSend]
    %
\end{equation}

\begin{itemize}
    \item \ITJudgement*%
    \item \ITJudgement*:{\alpha:(x<3)}%
    \item \ITJudgement*[R]:{\alpha,\beta};{x\leq3}_{j}<{\SetJ}%
    \item \ITJudgement*;{y\leq3\land3\geq x}%
    \item \ITJudgement*-{\IType!{a}[x<3][x],\IType?{b}[x>3][x]}%
\end{itemize}

\begin{equation}
    %
    \ITJudgement[R]:{%
            \alpha:(x=3)%
        };{x=4}-{%
            \IType!{a}[x<3],%
            \IType?{b}[x<5],%
            \IType!{c}[x=6],%
            \dots%
        }%
    %
\end{equation}

\subsection{Process Typing}

% % ~ 
% \NewDocumentCommand\ListToInlineArgs{>{\SplitList{,}}m}
% {%
%     \ProcessList{#1}{\HeadItemToInlineArgs}%
% }

% % ~ 
% \newcommand\HeadItemToInlineArgs[1]{%
%     {#1}%
%     \let\HeadItemToInlineArgs\TailItemToInlineArgs%
% }

% % ~ inserts | before each subsequent par item
% \newcommand\TailItemToInlineArgs[1]{%
%     \ \\\ {#1}%
%     \let\HeadItemToInlineArgs\TailItemToInlineArgs% * rebinding due to outer processor being unscoped
% }

\begin{equation}
    \IEval[test]:{
        \FmtJudgement|{a}{b}
    }:{\Premise[%
        1,%
        2,%
        \IEval[test2]:{%
            \FmtJudgement|{c}{d}[e]%
        }:{\Premise[%
            \IEval<[test3]:{%
                \FmtJudgement|{f}{g}[h]%
            }:{\Premise[%
                3,4,5%
            ]},%
            6,%
            \IEval[test4]:{%
                \FmtJudgement|{i}{j}%
            }:{\Premise[%
                7,8,9%
            ]},%
            10%
        ]},%
        11%
    ]}%
\end{equation}

\subsection{actual examples}

\subsubsection{types}

\def\typeslz{\TypeS_{0}}
\def\typesli{\TypeS_{1}}
\def\typeslii{\TypeS_{2}}
\def\typesliii{\TypeS_{3}}
\def\typesliv{\TypeS_{4}}
\def\typeslv{\TypeS_{5}}
\def\typeslvi{\TypeS_{6}}
\def\typeslvii{\TypeS_{7}}

\def\typetlz{\Dual[\TypeS]_{0}}
\def\typetli{\Dual[\TypeS]_{1}}
\def\typetlii{\Dual[\TypeS]_{2}}
\def\typetliii{\Dual[\TypeS]_{3}}
\def\typetliv{\Dual[\TypeS]_{4}}
\def\typetlv{\Dual[\TypeS]_{5}}
\def\typetlvi{\Dual[\TypeS]_{6}}
\def\typetlvii{\Dual[\TypeS]_{7}}

\def\typesz{\IChoice|[\typesli,\typeslvii]}
\def\typesi{\IType?{a}[x\leq 1][x].{\typeslii}}
\def\typesii{\IType!{c}.{\typesliii}}
\def\typesiii{\IRecDef[a].{\typesliv}}
\def\typesiv{\IChoice|[\typeslv,\typeslvi]}
\def\typesv{\IType?{d}[x\leq 1]}
\def\typesvi{\IType!{e}[1<x].{\IRecCall[a]}}
\def\typesvii{\IType!{b}[2<x<3]}

\def\typetz{\IChoice|[\typetli,\typetlvii]}
\def\typeti{\IType!{a}[y\leq 1][y].{\typetlii}}
\def\typetii{\IType?{c}.{\typetliii}}
\def\typetiii{\IRecDef[b].{\typetliv}}
\def\typetiv{\IChoice|[\typetlv,\typetlvi]}
\def\typetv{\IType!{d}[y\leq 1]}
\def\typetvi{\IType?{e}[1<y].{\IRecCall[b]}}
\def\typetvii{\IType?{b}[2<y<3]}

\begin{equation}
    %
    \begin{array}[t]{l c l}%
        %
        \TypeS & = & %
        \IChoice[%
            \IType?{a}[x\leq 1][x].{%
                \IType!{c}.{%
                    \IRecDef[a].{%
                        \IChoice[%
                            \IType?{d}[x\leq 1],%
                            \IType!{e}[1<x].{\IRecCall[a]}%
                        ]%
                    }%
                }%
            },%
            \IType!{b}[2<x<3]%
        ]%
        %
        \\[2ex]%
        \\[2ex]%
        \Dual[\TypeS] & = & %
        \IChoice[%
            \IType!{a}[y\leq 1][y].{%
                \IType?{c}.{%
                    \IRecDef[b].{%
                        \IChoice[%
                            \IType!{d}[y\leq 1],%
                            \IType?{e}[1<y].{\IRecCall[b]}%
                        ]%
                    }%
                }%
            },%
            \IType?{b}[2<y<3]%
        ]%
        %
    \end{array}%
    %
\end{equation}

\begin{equation}
    %
    \begin{array}[t]{l c l c l p{2ex} l c l c l }%
        %
        \TypeS & ::= & \typeslz & = & \typesz & &%
        \Dual[\TypeS] & ::= & \typetlz & = & \typetz \\%
        %
        & \mid & \typesli & = & \typesi & &%
        & \mid & \typetli & = & \typeti \\%
        %
        & \mid & \typeslii & = & \typesii & &%
        & \mid & \typetlii & = & \typetii \\%
        %
        & \mid & \typesliii & = & \typesiii & &%
        & \mid & \typetliii & = & \typetiii \\%
        %
        & \mid & \typesliv & = & \typesiv & &%
        & \mid & \typetliv & = & \typetiv \\%
        %
        & \mid & \typeslv & = & \typesv & &%
        & \mid & \typetlv & = & \typetv \\%
        %
        & \mid & \typeslvi & = & \typesvi & &%
        & \mid & \typetlvi & = & \typetvi \\%
        %
        & \mid & \typeslvii & = & \typesvii & &%
        & \mid & \typetlvii & = & \typetvii%
        %
    \end{array}%
    %
\end{equation}

\subsubsection{processes}

\def\prclz{\Prc_{0}}
\def\prcli{\Prc_{1}}
\def\prclii{\Prc_{2}}
\def\prcliii{\Prc_{3}}
\def\prcliv{\Prc_{4}}
\def\prclv{\Prc_{5}}
\def\prclvi{\Prc_{6}}
\def\prclvii{\Prc_{7}}

\def\qrclz{\Qrc_{0}}
\def\qrcli{\Qrc_{1}}
\def\qrclii{\Qrc_{2}}
\def\qrcliii{\Qrc_{3}}
\def\qrcliv{\Qrc_{4}}
\def\qrclv{\Qrc_{5}}
\def\qrclvi{\Qrc_{6}}
\def\qrclvii{\Qrc_{7}}
\def\qrclviii{\Qrc_{8}}
\def\qrclix{\Qrc_{9}}
\def\qrclx{\Qrc_{10}}
\def\qrclxi{\Qrc_{11}}

\def\prcz{\PSet{x}.{\prcli}}
\def\prci{\PRecv[a]:{\prclii}<{1}>{\prclvi}}
\def\prcii{\PSet{x}.{\prcliii}}
\def\prciii{\PSend[c].{\prcliv}}
\def\prciv{\PDefRec_{a}={\prcliv}:{\prclv}}
\def\prcv{\PRecv[d]<{1}>{\PRec_{a}}}
\def\prcvi{\PDelay[t=1].{\prclvii}}
\def\prcvii{\PIf[2<x<3]}

\def\qrcz{\PSet{y}.{\qrcli}}
\def\qrci{\PDelay[y\leq 1].{\qrclii}}% ~ delay inserted
\def\qrcia{\PDelay{y}.{\qrclii}}% ~ delay resolved
\def\qrcib{\PDelay{y}.{\qrclii}}% ~ delay resolved
\def\qrcic{\PDelay{y}.{\qrclii}}% ~ delay resolved
\def\qrcii{\PIf[y\leq 1]:{\PThen[\qrcliii]}:{\PElse[\qrclx]}}
\def\qrciii{\PSend_{q}[a].{\qrcliv}}
\def\qrciv{\PSet{y}.{\qrclv}}
\def\qrcv{\PRecv_{q}[c]:{\qrclvi}}
\def\qrcvi{\PDefRec_{b}={\qrcliv}:{\qrclvii}}
\def\qrcvii{\PIf[y\leq 1]:{\PThen[\qrclviii]}:{\PElse[\qrclix]}}
\def\qrcviii{\PSend_{q}[d]}
\def\qrcix{\PRecv_{q}[e]:{\PRec_{b}}}
\def\qrcx{\PDelay[t=1].{\qrclxi}}
\def\qrcxi{\PRecv[b]<{1}}

\begin{equation}
    %
    \begin{array}[t]{l c l}%
        %
        \Prc & = & %
        \PSet{x}.{%
            \PRecv[a]:{% * recv
                \PSet{x}.{%
                    \PSend[c].{%
                        \PDefRec:{%
                            \PRecv[d]<{1}>{% * after
                                \PRec%
                            }%
                        }%
                    }%
                }%
            }<{1}>{% * after 1
                \PDelay[t=1].{%
                    \PIf[2<x<3]% * use defaults (then end, else fail)
                }%
            }%
        }%
        %
        \\[2ex]%
        \\[2ex]%
        \Qrc & = & %
        \PSet{y}.{%
            \PIf[y\leq 1]:{\PThen[%
                \PSend_{q}[a].{%
                    \PSet{y}.{%
                        \PRecv_{q}[c]:{%
                            \PDefRec:{%
                                \PIf[y\leq 1]:{\PThen[%
                                    \PSend_{q}[d]%
                                ]}:{\PElse[%
                                    \PRecv_{q}[e]:{%
                                        \PRec%
                                    }%
                                ]}%
                            }%
                        }%
                    }%
                }%
            ]}:{\PElse[%
                \PDelay[t=1].{%
                    \PRecv[b]<{1}% * after: failed
                }%
            ]}%
        }%
        %
    \end{array}%
    %
\end{equation}

\begin{equation}
    %
    \begin{array}[t]{c p{2ex} c}%
        \begin{array}[t]{l c l c l}%
            %
            \Prc & ::= & \prclz & = & \prcz \\% 
            & \mid & \prcli & = & \prci \\%
            & \mid & \prclii & = & \prcii \\%
            & \mid & \prcliii & = & \prciii \\%
            & \mid & \prcliv & = & \prciv \\%
            & \mid & \prclv & = & \prcv \\%
            & \mid & \prclvi & = & \prcvi \\%
            & \mid & \prclvii & = & \prcvii %
            %
        \end{array}%
        & & %
        \begin{array}[t]{l c l c l}%
            %
            \Qrc & ::= & \qrclz & = & \qrcz \\% 
            & \mid & \qrcli & = & \qrci \\%
            & \mid & \qrclii & = & \qrcii \\%  
            & \mid & \qrcliii & = & \qrciii \\%
            & \mid & \qrcliv & = & \qrciv \\%
            & \mid & \qrclv & = & \qrcv \\%
            & \mid & \qrclvi & = & \qrcvi \\%
            & \mid & \qrclvii & = & \qrcvii \\%
            & \mid & \qrclviii & = & \qrcviii \\%
            & \mid & \qrclix & = & \qrcix \\%
            & \mid & \qrclx & = & \qrcx %
            %
        \end{array}%
    \end{array}%
    %
\end{equation}

\pagebreak
\subsubsection{using compacted versions}

\begin{equation}
    %
    \begin{array}[t]{l c l c l p{2ex} l c l c l }%
        %
        \TypeS & ::= & \typeslz & = & \typesz & &%
        \Dual[\TypeS] & ::= & \typetlz & = & \typetz \\%
        %
        & \mid & \typesli & = & \typesi & &%
        & \mid & \typetli & = & \typeti \\%
        %
        & \mid & \typeslii & = & \typesii & &%
        & \mid & \typetlii & = & \typetii \\%
        %
        & \mid & \typesliii & = & \typesiii & &%
        & \mid & \typetliii & = & \typetiii \\%
        %
        & \mid & \typesliv & = & \typesiv & &%
        & \mid & \typetliv & = & \typetiv \\%
        %
        & \mid & \typeslv & = & \typesv & &%
        & \mid & \typetlv & = & \typetv \\%
        %
        & \mid & \typeslvi & = & \typesvi & &%
        & \mid & \typetlvi & = & \typetvi \\%
        %
        & \mid & \typeslvii & = & \typesvii & &%
        & \mid & \typetlvii & = & \typetvii%
        %
    \end{array}%
    %
\end{equation}

\begin{equation}
    %
    \begin{array}[t]{c p{2ex} c}%
        \begin{array}[t]{l c l c l}%
            %
            \Prc & ::= & \prclz & = & \prcz \\% 
            & \mid & \prcli & = & \prci \\%
            & \mid & \prclii & = & \prcii \\%
            & \mid & \prcliii & = & \prciii \\%
            & \mid & \prcliv & = & \prciv \\%
            & \mid & \prclv & = & \prcv \\%
            & \mid & \prclvi & = & \prcvi \\%
            & \mid & \prclvii & = & \prcvii %
            %
        \end{array}%
        & & %
        \begin{array}[t]{l c l c l}%
            %
            \Qrc & ::= & \qrclz & = & \qrcz \\% 
            & \mid & \qrcli & = & \qrci \\%
            & \mid & \qrclii & = & \qrcii \\%  
            & \mid & \qrcliii & = & \qrciii \\%
            & \mid & \qrcliv & = & \qrciv \\%
            & \mid & \qrclv & = & \qrcv \\%
            & \mid & \qrclvi & = & \qrcvi \\%
            & \mid & \qrclvii & = & \qrcvii \\%
            & \mid & \qrclviii & = & \qrcviii \\%
            & \mid & \qrclix & = & \qrcix \\%
            & \mid & \qrclx & = & \qrcx \\%
            & \mid & \qrclxi & = & \qrcxi %
            %
        \end{array}%
    \end{array}%
    %
\end{equation}

\def\sespq{\ISes[\PrcP][\PrcQ]}
\def\sesqp{\ISes[\PrcQ][\PrcP]}

\begin{equation}
    %
    \resizebox{\textwidth}{!}{$%
        \IEval[Scope]:{\IPJudgement<[% * process
            \IScope.{\Parl{%
                \prclz,\qrclz,%
                \IBuff[\sespq],%
                \IBuff[\sesqp]%
        }}]>:{% * session
            \PrcP:\CIso[\ValClocks_0];[\typeslz],%
            \PrcQ:\CIso[\ValClocks_0];[\typetlz]~,%
            \IQue[\sespq],%
            \IQue[\sesqp]%
        }}:{\Premise[%
            \IEval[Timer]:{\IPJudgement<[% * process
                \prcz,\qrcz,%
                \IBuff[\sespq],%
                \IBuff[\sesqp]%
            ]>:{% * session
                \PrcP:\CIso[\ValClocks_0];[\typesz],%
                \PrcQ:\CIso[\ValClocks_0];[\typetz]~,%
                \IQue[\sespq],%
                \IQue[\sesqp]%
            }}:{\Premise[%
                \IEval[Timer]:{\IPJudgement:{% * vars
                    x:0
                }<[% * process
                    \prci,\qrcz,%
                    \IBuff[\sespq],%
                    \IBuff[\sesqp]%
                ]>:{% * session
                    \PrcP:\CIso[\ValClocks_0];[\typesz],%
                    \PrcQ:\CIso[\ValClocks_0];[\typetz]~,%
                    \IQue[\sespq],%
                    \IQue[\sesqp]%
                }}:{\Premise[%
                    \IEval[Del\Const*]:{\IPJudgement:{% * vars
                        x:0,y:0
                    }<[% * process
                        \prci,\qrci,%
                        \IBuff[\sespq],%
                        \IBuff[\sesqp]%
                    ]>:{% * session
                        \PrcP:\CIso[\ValClocks_0];[\typesz],%
                        \PrcQ:\CIso[\ValClocks_0];[\typetz]~,%
                        \IQue[\sespq],%
                        \IQue[\sesqp]%
                    }}:{\Premise[%
                        \IEval[Del\Const*]:{\IPJudgement:{% * vars
                            x:0,y:0
                        }<[% * process
                            \prci,\qrci,%
                            \IBuff[\sespq],%
                            \IBuff[\sesqp]%
                        ]>:{% * session
                            \PrcP:\CIso[\ValClocks_0];[\typesz],%
                            \PrcQ:\CIso[\ValClocks_0];[\typetz]~,%
                            \IQue[\sespq],%
                            \IQue[\sesqp]%
                        }}:{\Premise[%
                        ]}
                    ]}
                ]}
            ]}
        ]}
    $}
    %
\end{equation}

\endinput

\begin{equation}
    %
    \resizebox{\textwidth}{!}{$%
        \IEval[Del\Const*]:{\IPJudgement<[% * process
            \PDelay[x=1].{\Prc^{*}},%
            \PDelay[y=1].{\Qrc^{*}},%
            \IBuff[\ISes[\PrcP][\PrcQ]],%
            \IBuff[\ISes[\PrcQ][\PrcP]]%
        ]>:{% * session
            \PrcP:\CIso,%
            \PrcQ:\CIso,%
            \IQue[\ISes[\PrcP][\PrcQ]],%
            \IQue[\ISes[\PrcQ][\PrcP]]%
        }}:{\Premise[%
            \IEval[Del\Const*]:{\IPJudgement<[% * process
                \PDelay[1].{\Prc^{*}},%
                \PDelay[y=1].{\Qrc^{*}},%
                \IBuff[\ISes[\PrcP][\PrcQ]],%
                \IBuff[\ISes[\PrcQ][\PrcP]]%
            ]>:{% * session
                \PrcP:\CIso,%
                \PrcQ:\CIso,%
                \IQue[\ISes[\PrcP][\PrcQ]],%
                \IQue[\ISes[\PrcQ][\PrcP]]%
            }}:{\Premise[%
                \IEval[Delt]:{\IPJudgement<[% * process
                    \PDelay[1].{\Prc^{*}},%
                    \PDelay[1].{\Qrc^{*}},%
                    \IBuff[\ISes[\PrcP][\PrcQ]],%
                    \IBuff[\ISes[\PrcQ][\PrcP]]%
                ]>:{% * session
                    \PrcP:\CIso,%
                    \PrcQ:\CIso,%
                    \IQue[\ISes[\PrcP][\PrcQ]],%
                    \IQue[\ISes[\PrcQ][\PrcP]]%
                }}:{\Premise[%
                    \IEval[Delt]:{\IPJudgement<[% * process
                        \PSend_{\PrcP}[a].{\Prc^{*}},%
                        \PDelay[0].{\Qrc^{*}},%
                        \IBuff[\ISes[\PrcP][\PrcQ]],%
                        \IBuff[\ISes[\PrcQ][\PrcP]]%
                    ]>:{% * session
                        \PrcP:\CIso,%
                        \PrcQ:\CIso,%
                        \IQue[\ISes[\PrcP][\PrcQ]],%
                        \IQue[\ISes[\PrcQ][\PrcP]]%
                    }}:{\Premise[%
                        \IEval[VSend]:{\IPJudgement<[% * process
                            \PSend_{\PrcP}[a].{\Prc^{*}},%
                            \PRecv_{q}[a]:{\Qrc^{*}}<{0}>{{\Qrc'}^{*}},%
                            \IBuff[\ISes[\PrcP][\PrcQ]],%
                            \IBuff[\ISes[\PrcQ][\PrcP]]%
                        ]>:{% * session
                            \PrcP:\CIso,%
                            \PrcQ:\CIso,%
                            \IQue[\ISes[\PrcP][\PrcQ]],%
                            \IQue[\ISes[\PrcQ][\PrcP]]%
                        }}:{\Premise[%
                            \IMJudgement{% * msg typing
                                \IMsg{b}:{\DataType_{a_{i}}}%
                            },%
                            \IEval[VRecv]:{\IPJudgement<[% * process
                                \PRecv_{p}[b]:{\Prc^{*}}<{1}>{{\Prc'}^{*}},%
                                \PRecv_{q}[a]:{\Qrc^{*}}<{0}>{{\Qrc'}^{*}},%
                                \IBuff[\ISes[\PrcP][\PrcQ]]:{a},%
                                \IBuff[\ISes[\PrcQ][\PrcP]]%
                            ]>:{% * session
                                \PrcP:\CIso,%
                                \PrcQ:\CIso,%
                                \IQue[\ISes[\PrcP][\PrcQ]]:{a},%
                                \IQue[\ISes[\PrcQ][\PrcP]]%
                            }}:{\Premise[%
                                \IEval[VRecv]:{\IPJudgement<[% * process
                                    \PRecv_{p}[b]:{\Prc^{*}}<{1}>{{\Prc'}^{*}},%
                                    \PRecv_{q}[a]:{\Qrc^{*}}<{0}>{{\Qrc'}^{*}},%
                                    \IBuff[\ISes[\PrcP][\PrcQ]]:{a},%
                                    \IBuff[\ISes[\PrcQ][\PrcP]]%
                                ]>:{% * session
                                    \PrcP:\CIso,%
                                    \PrcQ:\CIso,%
                                    \IQue[\ISes[\PrcP][\PrcQ]]:{a},%
                                    \IQue[\ISes[\PrcQ][\PrcP]]%
                                }}:{\Premise[%
                                ]}%
                            ]}%
                        ]}%
                    ]}%
                ]}%
            ]}%
        ]}%
    $}%
    %
\end{equation}
\endinput


\begin{equation}\label{eq:example_prctyp_ia_yleqi_then}%
    \resizebox{\textwidth}{!}{$%
        \infer[%
            {\begin{array}[t]{l l}%
                \RName[Timer] & x,y%
                \\[2ex]\ValClocks_1 = \ValClocks_2%
            \end{array}}%
        ]{%
            \begin{array}{c c c c c c c c c c c c c c c c c c c c c}%
                % * var env (Gamma)
                \VarEnv,\emptyset & %
                \Entails & %
                % * processes
                \PSet{x}.{\dots} & %
                \mid &%
                \PSet{y}.{\dots} & %
                \mid &%
                pq:\emptyset & %
                \mid &%
                qp:\emptyset & %
                %
                \PrcTyped & %
                %
                % * session (Delta)
                \SesEnv & %
                , & %
                % * configs
                \CfgIso_p & %
                , & % 
                \CfgIso_q2{\Dual[\TypeS]} & %
                , & % 
                pq:\emptyset & %
                , & %
                qp:\emptyset%
                %
                \\[1ex]% * for annotations
                & % var env (Gamma)
                & % imp
                \Prc & % p1
                & % |
                \Qrc & % q1
                & % |
                & % pq
                & % |
                & % qp
                & % typed by
                & % session (Delta)
                & % ,
                & % cfg p
                & % ,
                & % cfg q
                & % ,
                & % pq
                & % ,
                & % qp
            \end{array}%
        }{%
            \infer[%
                {\begin{array}[t]{l l}%
                    \RName[IfStmt] & \text{then}%
                    \\ \text{for ELSE see:}%\cref{eq:example_prctyp_ib_yleqi_else}}%
                \end{array}}%
            ]{%
                \begin{array}{c c c c c c c c c c c c c c c c c c c c c}%
                    % * var env (Gamma)
                    \VarEnv,\emptyset & %
                    \Entails & %
                    % * processes
                    \PRecv_{p}[a]:{\dots}<{1}>{\dots} %
                    & \mid &%
                    %
                    \PIf[y\leq 1]:{\PThen[%
                        \dots%
                    ]}:{\PElse[%
                        \dots%
                    ]}%
                    & \mid &%
                    %
                    pq:\emptyset & \mid &%
                    qp:\emptyset & %
                    %
                    \PrcTyped & %
                    %
                    % * session (Delta)
                    \SesEnv & , & %
                    % * configs
                    \CfgIso_p & , & % 
                    \CfgIso_q2{\Dual[\TypeS]} & , & % 
                    pq:\emptyset & , & %
                    qp:\emptyset%
                    %
                \end{array}%
            }{%
                \infer[%
                    {\begin{array}[t]{l l}%
                        \RName[VSend] & \circled{$\mathtt{a}$}%
                    \end{array}}%
                ]{%
                    \begin{array}{c c c c c c c c c c c c c c c c c c c c c}%
                        % * var env (Gamma)
                        \VarEnv,\emptyset & %
                        \Entails & %
                        % * processes
                        \PRecv_{p}[a]:{\dots}<{1}>{\dots} %
                        & \mid &%
                        %
                        \PSend_{q}[a].{\dots}%
                        & \mid &%
                        %
                        pq:\emptyset%
                         & \mid &%
                        qp:\emptyset & %
                        %
                        \PrcTyped & %
                        %
                        % * session (Delta)
                        \SesEnv & , & %
                        % * configs
                        \CfgIso_p & , & % 
                        \CfgIso_q2{\Dual[\TypeS]} & , & % 
                        pq:\emptyset & , & %
                        qp:\emptyset%
                        %
                    \end{array}%
                }{%
                    \infer[%
                        {\begin{array}[t]{l l}%
                            \RName[VRecv] & \circled{$\mathtt{a}$}%
                        \end{array}}%
                    ]{%
                        \begin{array}{c c c c c c c c c c c c c c c c c c c c c}%
                            % * var env (Gamma)
                            \VarEnv,\emptyset & %
                            \Entails & %
                            % * processes
                            \PRecv_{p}[a]:{\dots}<{1}>{\dots} %
                            & \mid &%
                            %
                            \PSet{y}.{\dots}%
                            & \mid &%
                            %
                            pq:\emptyset%
                            & \mid &%
                            qp:\circled{$\mathtt{a}$} & %
                            %
                            \PrcTyped & %
                            %
                            % * session (Delta)
                            \SesEnv & , & %
                            % * configs
                            \CfgIso_p & , & % 
                            \CfgIso_q2{\Dual[\TypeS]} & , & % 
                            pq:\emptyset & , & %
                            qp:\squared{$\mathtt{a}$}%
                            %
                        \end{array}%
                    }{%
                        \infer[%
                            {\begin{array}[t]{l l}%
                                \RName[Timer] & x,y%
                            \end{array}}%
                        ]{%
                            \begin{array}{c c c c c c c c c c c c c c c c c c c c c}%
                                % * var env (Gamma)
                                \VarEnv,\emptyset & %
                                \Entails & %
                                % * processes
                                \PSet{x}.{\dots} %
                                & \mid &%
                                %
                                \PSet{y}.{\dots}%
                                & \mid &%
                                %
                                pq:\emptyset%
                                & \mid &%
                                qp:\emptyset & %
                                %
                                \PrcTyped & %
                                %
                                % * session (Delta)
                                \SesEnv & , & %
                                % * configs
                                \CfgIso_p & , & % 
                                \CfgIso_q2{\Dual[\TypeS]} & , & % 
                                pq:\emptyset & , & %
                                qp:\emptyset%
                                %
                            \end{array}%
                        }{%
                        \dots%
                        }%
                    }%
                }%
            }%
        }%
    $}%
\end{equation}

\begin{equation}\label{eq:example_prctyp_ib_yleqi_else}%
    \resizebox{\textwidth}{!}{$%
        \infer[%
            {\begin{array}[t]{l l}%
                \RName[IfStmt] & \text{else}%
                \\ \text{for THEN see:}%~\cref{eq:example_prctyp_ia_yleqi_then}]%
            \end{array}}%
        ]{%
            \begin{array}{c c c c c c c c c c c c c c c c c c c}%
                % * var env (Gamma)
                \VarEnv,\emptyset & %
                \Entails & %
                % * processes
                \PRecv_{p}[a]:{\dots}<{1}>{\dots} %
                & \mid &%
                %
                \PIf[y\leq 1]:{\PThen[%
                    \dots%
                ]}:{\PElse[%
                    \dots%
                ]}%
                & \mid &%
                %
                pq:\emptyset & \mid &%
                qp:\emptyset & %
                %
                \PrcTyped & %
                %
                % * session (Delta)
                \SesEnv & , & %
                % * configs
                \CfgIso_p & , & % 
                \CfgIso_q2{\Dual[\TypeS]} & , & % 
                pq:\emptyset & , & %
                qp:\emptyset%
                %
            \end{array}%
        }{%
            \infer[%
                {\begin{array}[t]{l l}%
                    \RName[Timer] & x,y%
                \end{array}}%
            ]{%
                \begin{array}{c c c c c c c c c c c c c c c c c c c}%
                    % * var env (Gamma)
                    \VarEnv,\emptyset & %
                    \Entails & %
                    % * processes
                    \PRecv_{p}[a]:{\dots}<{1}>{\dots} %
                    & \mid &%
                    %
                    \PSend_{q}[a].{\dots}%
                    & \mid &%
                    %
                    pq:\emptyset & \mid &%
                    qp:\emptyset & %
                    %
                    \PrcTyped & %
                    %
                    % * session (Delta)
                    \SesEnv & , & %
                    % * configs
                    \CfgIso_p & , & % 
                    \CfgIso_q2{\Dual[\TypeS]} & , & % 
                    pq:\emptyset & , & %
                    qp:\emptyset%
                    %
                \end{array}%
            }{%
            }
        }
    $}%    
\end{equation}

\endinput


\begin{equation}
    \begin{array}[c]{r c l}
        \Prc & = & %
        \PBranch[%
            \PRecv|[b],%
            \PRecv|[d]:{%
                \PRecv[f]:{%
                    \PSend[g]%
                }<{3}>{%
                    \PSend_{q}[c]%
                }%
            },%
            \PRecv|[e]:{%
                \PSend%
            }%
        ]<{1}>{%
            \PSend.{%
                \PBranch[%
                    \PRecv|[h]:{%
                        \PSend[i]%
                    },%
                    \PRecv|[j]%
                ]%
            }%
        }%
        %
    \end{array}
\end{equation}



% ~ 
\NewDocumentCommand{\IPrcSend}{s E|{\PrcP}}{%
    \IfBooleanT{#1}{$}%
    \mathtt{to}\,{#2}%
    \mathtt{->}\,{}
    \IfBooleanT{#1}{$}%
}

\endinput

\begin{equation}
    \IChoice
\end{equation}

\begin{equation}
    \IChoice[\IType,\IType]
\end{equation}

\begin{equation}
    \IType!{a}
\end{equation}



\endinput

\begin{equation}
    \IChoice[%
        \IType?{a}[x\leq 1][x].{%
            \IType!{c}.{%
                \IRecDef[a].{%
                    \IChoice[%
                        \IType?{d}[x\leq 1],%
                        \IType!{e}[1<x].{%
                            \IChoice[%
                                \IType?{d}[x\leq 1],%
                                \IType!{e}[1<x].{%
                                    \IChoice[%
                                        \IType?{d}[x\leq 1],%
                                        \IType!{e}[1<x].{\IRecCall[a]}%
                                    ]%
                                }%
                            ]%
                        }%
                    ]%
                }%
            }%
        },%
        \IType!{b}[2<x<3]%
    ]%
\end{equation}

\endinput
