%
\begin{equation}
    %
    \begin{array}[t]{l c l}%
        %
        \Prc & = & %
        %
        \PDefRec[A].{%
            \PDelay[t\geq 3]/.{%
                \PSend[msg1]/.{%
                    \PDefRec[B].{%
                        \PRecv[ack1].{%
                            \PRec[A]%
                        }<{3}>{%
                            \PSend[msg2]/.{%
                                \PRecv[ack2].{%
                                    \PRec[B]%
                                }<{3}>{%
                                    \PSend[tout]%
                                }%
                            }%
                        }%
                    }%
                }%
            }%
        }%
        %
        \\ \\%
        \Qrc & = & %
        %
        \PDefRec[C].{%
            \PRecv_q[msg1].{%
                \PSet{y}/.{%
                    \PDelay[t< 5]/.{%
                        \PIf[y<3]:{\PThen[%
                            \PSend_q[ack1].{%
                                \PRec[C]%
                            }%
                        ]}:{\PElse[%
                            \PDefRec[D].{%
                                \PRecv_q[msg2].{%
                                    \PSet{y}/.{%
                                        \PDelay[t< 5]/.{%
                                            \PIf[y<3]:{\PThen[%
                                                \PSend_q[ack2].{%
                                                    \PRec[D]%
                                                }%
                                            ]}:{\PElse[%
                                                \PRecv_q[tout]%
                                            ]}%
                                        }%
                                    }%
                                }<{3}%
                            }%
                        ]}%
                    }%
                }%
            }<{3}%
        }%
        %
    \end{array}
    %
\end{equation}
%