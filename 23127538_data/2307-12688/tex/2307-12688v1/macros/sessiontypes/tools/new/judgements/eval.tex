% ~ 
% #1 : s* : math mode wrap
% #2 : t< : put label on left side?
% #3 : o  : optional label
% #4 : e: : (bot) judgement
% #5 : E: : (top) premise (\Premise list)
\NewDocumentCommand{\IEval}{s t< o e: E:{\Premise}}{%
\IfBooleanT{#1}{$}%
\IfValueTF{#3}{% * has label
    \IfBooleanTF{#2}{% * use left side label
        {\inferrule*[Left={[#3]}]{%
                    \rule{0pt}{2ex}{#5}%
                }{%
                    {#4}%
                }}%
    }{% * use right aligned label (default)
        {\inferrule*[Right={[#3]}]{%
                    \rule{0pt}{2ex}{#5}%
                }{%
                    {#4}%
                }}%
    }%
}{% * no label
    {\inferrule*{%
                \rule{0pt}{2ex}{#5}%
            }{%
                {#4}%
            }}%
}%
\IfBooleanT{#1}{$}%
}

% ! replaced by IT/IP Judgement macros
\NewDocumentCommand{\GenericJudgement}{s O{\emptyset\Entails\Prc\PrcTyped\SesEnv}}{%
    {\ListToInlineArgs{#2}}%
}

\NewDocumentCommand{\Premise}{s t| O{\dots}}{%
    \IfBooleanT{#1}{$}%
    \IfBooleanTF{#2}{% * single premise
        {#3}%
    }{% * list of premises
        {\ListToInlineArgs{#3}}%
    }%
    \IfBooleanT{#1}{$}%
}


% ~ 
\NewDocumentCommand\ListToInlineArgs{>{\SplitList{,}}m}
{%
    \ProcessList{#1}{\HeadItemToInlineArgs}%
}

% ~ 
\newcommand\HeadItemToInlineArgs[1]{%
    {#1}%
    \let\HeadItemToInlineArgs\TailItemToInlineArgs%
}

\newcommand\TailItemToInlineArgs[1]{%
    % ~\\~{#1}%
    \quad{#1}%
    \let\HeadItemToInlineArgs\TailItemToInlineArgs% * rebinding due to outer processor being unscoped
}
