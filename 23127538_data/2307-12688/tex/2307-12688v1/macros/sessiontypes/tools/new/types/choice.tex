
% ~ creates choices of types
% #1 : s* : serialised for text mode
% #2 : t^ : top or center align for choices (^ -> top)
% #3 : t| : only one option
% #4 : O  : list of types (default single type)
\NewDocumentCommand{\IChoice}{s t^ t| O{\IType}}{%
   \IfBooleanT{#1}{$}% mm wrap
   \IfBooleanTF{#3}{% * single action
      \begin{array}[\IfBooleanTF{#2}{t}{c}]\{{l}\}{#4}\end{array}%
   }{% * choice
      \begin{array}[\IfBooleanTF{#2}{t}{c}]\{{l}\}%
         \ListToArray{#4}%
      \end{array}%
   }%
   \IfBooleanT{#1}{$}% mm wrap
}

% ~ returns array
\NewDocumentCommand{\ListToArray}{>{\SplitList{,}}m}{%
   \ProcessList{#1}{\HeadItemToArrayElement}%
}

% ~ returns items as line in array
\NewDocumentCommand{\HeadItemToArrayElement}{m}{%
   \rule{0pt}{1.5ex}{#1}%
   \let\HeadItemToArrayElement\TailItemToArrayElement%
}
% ~ inserts new line before entry
\NewDocumentCommand{\TailItemToArrayElement}{m}{%
   \TypChoiceSep\rule{0pt}{1.5ex}{#1}%
   \let\HeadItemToArrayElement\TailItemToArrayElement%
}
