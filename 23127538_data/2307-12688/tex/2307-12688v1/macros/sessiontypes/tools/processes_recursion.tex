
\NewDocumentCommand{\RedPrc}{s O{\RedTimers} t' e+ m}{%
   \IfBooleanT{#1}{$}% mm wrap
   \Tup({{#2\IfBooleanT{#3}{'}}\IfValueT{#4}{\ListToEnvItems{#4}}},{#5})%
   \IfBooleanT{#1}{$}% mm wrap
}

\NewDocumentCommand{\PrcRecDef}{s O{\RecVar} t' E={\Prc} E>{\Qrc}}{%
\IfBooleanT{#1}{$}% mm wrap
\TTPrcDef~%
{#2}\IfBooleanTF{#3}{\RecPrcVar'}{\RecPrcVar}={#4}%
~\TTPrcDefIn~{#5}%
\IfBooleanT{#1}{$}% mm wrap
}

\NewDocumentCommand{\RecPrcVar}{s E1{\RecSetMsg} E2{\RecSetTimers} E3{\RecSetRoles} t'}{
   \IfBooleanT{#1}{$}% mm wrap
   ({#2\IfBooleanT{#5}{'}};{#3\IfBooleanT{#5}{'}};{#4\IfBooleanT{#5}{'}})%
   \IfBooleanT{#1}{$}% mm wrap
}

\NewDocumentCommand{\RecPrcCall}{s E1{\RecSetMsg} E2{\RecSetTimers} E3{\RecSetRoles} t'}{
\IfBooleanT{#1}{$}% mm wrap
\RecVar\langle{#2\IfBooleanT{#5}{'}};{#3\IfBooleanT{#5}{'}};{#4\IfBooleanT{#5}{'}}\rangle%
\IfBooleanT{#1}{$}% mm wrap
}


\NewDocumentCommand{\RecPrcSubst}{s o o t' t/ t'}{%
   \IfBooleanT{#1}{$}% mm wrap
   \IfValueTF{#3}{% * both values
      \Subst[#2][#3]%
   }{% * check #2
      \IfValueTF{#2}{% * default #3
         \IfBooleanTF{#4}{% * #2 '
            \Subst[#2'][\RecSetMsg,\RecSetTimers,\RecSetRoles]%
         }{% * 
            \IfBooleanTF{#6}{% * default '
               \Subst[#2][\RecSetMsg',\RecSetTimers',\RecSetRoles']%
            }{% * plain default
               \Subst[#2][\RecSetMsg,\RecSetTimers,\RecSetRoles]%
            }%
         }%
      }{% * no values: defaults
         \IfBooleanTF{#4}{% * #2 '
            \Subst[\RecSetMsg',\RecSetTimers',\RecSetRoles'][\RecSetMsg,\RecSetTimers,\RecSetRoles]%
         }{% * 
            \IfBooleanTF{#6}{% * default '
               \Subst[\RecSetMsg,\RecSetTimers,\RecSetRoles][\RecSetMsg',\RecSetTimers',\RecSetRoles']%
            }{% ! mistake: plain default 
               \Subst[\RecSetMsg,\RecSetTimers,\RecSetRoles][\RecSetMsg,\RecSetTimers,\RecSetRoles]%
            }%
         }%
      }%
   }%
   \IfBooleanT{#1}{$}% mm wrap
}
% ~ typing 

\NewDocumentCommand{\EnvPrcVar}{s E1{\RecPrcMsg} E2{\RecPrcTimers} E3{\SesSet} t'}{%
   \IfBooleanT{#1}{$}% mm wrap
   ({#2\IfBooleanT{#5}{'}};{#3\IfBooleanT{#5}{'}};{#4\IfBooleanT{#5}{'}})%
   \IfBooleanT{#1}{$}% mm wrap
}

% \NewDocumentCommand{\VarRecDef}{s O{\RecVar} E={\Prc} E>{\Qrc}}{%
% \IfBooleanT{#1}{$}% mm wrap
% \TTPrcDef~%
% {#2}\RecPrcVar={#3}%
% ~\TTPrcDefIn~{#4}%
% \IfBooleanT{#1}{$}% mm wrap
% }

