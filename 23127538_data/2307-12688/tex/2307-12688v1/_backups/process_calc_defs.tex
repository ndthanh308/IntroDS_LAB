
% processes
\newcommand{\mprc}[0]{P}
\newcommand{\prc}[0]{$\mprc$}
\newcommand{\mqrc}[0]{Q}
\newcommand{\qrc}[0]{$\mqrc$}

% recall process
\newcommand{\mprecall}[0]{R}
\newcommand{\precall}[0]{$\mprecall$}

% recall queue
\newcommand{\mprequeue}[0]{\mathbf{r}}
\newcommand{\prequeue}[0]{$\mprequeue$}

% recall queue cache
\newcommand{\mprecallcache}[0]{\mathbf{k}}
\newcommand{\precallcache}[0]{$\mprecallcache$}

% option in choice
\newcommand{\mopt}[0]{O}
\newcommand{\opt}[0]{$\mopt$}

\newcommand{\mpdef}[0]{D}
\newcommand{\pdef}[0]{$\mpdef$}

\newcommand{\mpvar}[0]{\set{x}}
\newcommand{\pvar}[0]{$\mpvar$}

\newcommand{\msetLabel}[0]{\bset{\textbf{\small a\normalsize}}}
\newcommand{\setLabel}[0]{$\msetLabel$}

\newcommand{\msetChan}[0]{\bset{\textbf{\small c\normalsize}}}
\newcommand{\setChan}[0]{$\msetChan$}

\newcommand{\mnum}[0]{n}
\newcommand{\num}[0]{$\mnum$}

\newcommand{\mbool}[0]{v}
\newcommand{\bool}[0]{$\mbool$}

\newcommand{\mpchan}[0]{c}
\newcommand{\pchan}[0]{$\mpchan$}

\newcommand{\mepointp}[0]{\elem{p}}
\newcommand{\epointp}[0]{$\mepointp$}

\newcommand{\mepointq}[0]{\elem{q}}
\newcommand{\epointq}[0]{$\mepointq$}

% arrows
\DeclareMathOperator{\mtreduce}{~~\rightsquigarrow~~}
\DeclareMathOperator{\mareduce}{~~\rightharpoonup~~}
\DeclareMathOperator{\mreduce}{~~\longrightarrow~~}

% chan direction
\DeclareMathOperator{\mprecv}{\vartriangleright}
\DeclareMathOperator{\mpsend}{\vartriangleleft}
\DeclareMathOperator{\mptyped}{\vartriangleright}

\newcommand{\precv}[0]{$\mprecv$}
\newcommand{\psend}[0]{$\mpsend$}
\newcommand{\ptyped}[0]{$\mptyped$}

% \DeclareMathOperator{\dia}{\mbox{\raisebox{\depth}{\rotatebox[origin=c]{45}{$\sq$}}}\!\,}

% \newcommand{\mpcomm}[0]{\dia}
% \newcommand{\pcomm}[0]{\mpcomm}

% channel buffer
\newcommand{\mpbuffer}[0]{h}
\newcommand{\pbuffer}[0]{$\mpbuffer$}

% func
\newcommand{\mdelayfunc}[1][\mconstr]{\mathtt{delay}\left(#1\right)}
\newcommand{\delayfunc}[1][\mconstr]{$\mdelayfunc[#1]$}

\newcommand{\mwaitfunc}[1][\mprc]{\mathtt{Wait}\left(#1\right)}
\newcommand{\waitfunc}[1][\mprc]{$\mwaitfunc[#1]$}

\newcommand{\mnequeuefunc}[1][\mprc]{\mathtt{NEQueue}\left(#1\right)}
\newcommand{\nequeuefunc}[1][\mprc]{$\mwaitfunc[#1]$}

\newcommand{\mprcfail}[0]{\mathtt{failed}}
\newcommand{\prcfail}[0]{$\mprcfail$}

\newcommand{\mprcvar}[1][\msetLabel;\msetChan]{\mpvar\left(#1\right)}
\newcommand{\prcvar}[1][\msetLabel;\msetChan]{$\mprcvar[#1]$}

% def rec
\newcommand{\mpsetrec}[1][\msetLabel;\msetChan]{\mathtt{def}\;\mprcvar[#1]=\mprc\;\mathtt{in}\;}
\newcommand{\psetrec}[1][\msetLabel;\msetChan]{$\mpsetrec[#1]$}

% call rec
\newcommand{\mpcallrec}[1][\msetLabel;\msetChan]{\mpvar\left\langle#1\right\rangle}
\newcommand{\pcallrec}[0]{$\mpcallrec$}

% send and listen
\newcommand{\mpsendlisten}[1][\mqrc]{\mpchan\,\mpsend\,a\;\mathtt{listen}\;\of{\left\{{\left(\of{b}{i}:\of{\mprc}{i}\right)}^{n}\right\}}{\elemofset{i}{i}}\,.\,#1}

\newcommand{\mpsendalways}[1][\mprc]{\mpchan\,\mpsend\,a\,.\,#1}

% recv until p
\newcommand{\mprecvuntil}[1][n]{{{\mpchan}^{#1}}\,\mprecv\,\of{\left\{\of{a}{i}:\of{\mprc}{i}\right\}}{\elemofset{i}{i}}\,\mathtt{after}\;\mqrc}

\newcommand{\mprecvalways}[0]{{{\mpchan}^{\infty}}\,\mprecv\,\of{\left\{\of{a}{i}:\of{\mprc}{i}\right\}}{\elemofset{i}{i}}}

% if then else
\newcommand{\mifthenelse}[0]{\mathtt{if}\;\mbool\;\mathtt{then}\;\mprc\;\mathtt{else}\;\mqrc}

% recall process
\newcommand{\mprcrecall}[0]{\mpchan\,\mprecv\,\mkset{\mprequeue}}

% scope
\newcommand{\mpscope}[1][\mepointp\mepointq]{\left(\nu#1\right)}

\newcommand{\mprcpar}[1][\mprc]{\of{#1}{1}\mid\of{#1}{2}}

% timers
\newcommand{\mprctimerset}[1][x]{\mathtt{set}\left(#1\right)}
\newcommand{\prctimerset}[1][x]{$\mprctimerset[#1]$}

\newcommand{\mprctimer}[1][x]{\left(\nu#1\right)}
\newcommand{\prctimer}[1][x]{$\mprctimer[#1]$}

\newcommand{\mprctimereval}[1][x]{#1\models\mconstr}

% calculus
\newcommand{\mproccescalc}[0]{%
   \begin{array}{r c l r c l}%
      \mprc,\mqrc & ::=\;                              %
                  & \mpsendalways                      %
                  & \mbox{ }                           %
                  & \quad \mid \quad\,                 %
                  & \mprecvuntil                       %    
      %
      \\\rule{0pt}{2.25ex} %
      \mbox{ }    & \mid \quad                         %
                  & \mpsendlisten                      %
                  & \mbox{ }                           %
                  & \mid \quad                         %
                  & 0                                  %
      %
      \\\rule{0pt}{2.25ex} %
      \mbox{ }    & \mid \quad                         %
                  & \mpscope\,\mprc                    %
                  & \mbox{ }                           %   
                  & \mid \quad                         %
                  & \mepointp\mepointq:\mpbuffer       % 
      %
      \\\rule{0pt}{2.25ex} %
      \mbox{ }    & \mid \quad                         %
                  & \mifthenelse                       %
                  & \mbox{ }                           %
                  & \mid \quad                         %
                  & \mdelayfunc.\mprc                  %
      %
      \\\rule{0pt}{2.25ex} %
      \mbox{ }    & \mid \quad                         %
                  & \mprcpar                           %
                  & \mbox{ }                           %
                  & \mid \quad                         %
                  & \mprctimerset\,.\,\mprc            %
      %
      \\\rule{0pt}{2.25ex} %
      \mbox{ }    & \mid \quad                         %
                  & \mpsetrec\mprc                     %
                  & \mbox{ }                           %
                  & \mid \quad                         %
                  & \mpcallrec                         %
      %
      \\\rule{0pt}{2.25ex} %
      \mbox{ }    & \mid \quad                         %
                  & \mprcrecall                        %
                  & \mbox{ }                           %
                  & \mid \quad                         %
                  & \mkset{\mprecallcache}             %
      %
      %
      %
      %
      \\\rule{0pt}{3.5ex} %
      \mbool      & ::=                                %
                  & \mtrue                             %
                  & \mpbuffer                          %
                  & ::=                                %
                  & \emptyset                          %
      %
      \\\rule{0pt}{2ex} %
      \mbox{ }    & \mid \quad                         %
                  & \mfalse                            %
                  & \mbox{ }                           %
                  & \mid \quad                         %
                  & \mpbuffer\cdot\mlabel
      %
      \\\rule{0pt}{2ex} %
      \mbox{ }    & \mid \quad                         %
                  & \mprctimereval                     %
                  & \mbox{ }                           %
      % & \mid                               %
      % & \mpbuffer\cdot\mlabel              %
      %
      %
      %
      %
      \\\rule{0pt}{3.5ex} %
      \mprequeue  & ::=                                %
                  & \mathtt{tidy}:\mpbuffer,\mprequeue %
                  & \mprecallcache                     %
                  & ::=                                %
                  & \emptyset                          %
      %
      \\\rule{0pt}{2ex} %
      \mbox{ }    & \mid \quad                         %
                  & \mprequeue,\,a:\mprc               %
                  & \mbox{ }                           %
                  & \mid \quad                         %
                  & a:\mpbuffer                        %
      %
      %
      %
   \end{array}}

\newcommand{\proccescalc}[0]{$\mproccescalc$}

% pass time function
\DeclareMathOperator{\mptime}{\of{\mathit{\Phi}}{\mathit{t}}}

\newcommand{\mptimefunc}[1][0]{\mptime\left(#1\right)}
\newcommand{\ptimefunc}[1][0]{$\mptimefunc$}

% process judgements
\DeclareMathOperator{\mpenv}{\mathit{\Gamma}}
\DeclareMathOperator{\msenv}{\mathit{\Delta}}
\DeclareMathOperator{\msset}{\mathit{\Theta}}

\newcommand{\penv}[0]{$\mpenv$}
\newcommand{\senv}[0]{$\msenv$}
\newcommand{\sset}[0]{$\msset$}

% vector of sorts T
\newcommand{\msetT}[0]{\boldsymbol{\mtype}}
\newcommand{\setT}[0]{$\msetT$}

% v = l mbox v = l
\newcommand{\mprocessjudge}[0]{\begin{array}{r c l r c l}
      \msenv   & ::=                                        %
               & \emptyset                                  %
               & \mbox{}\quad\mbox{}                        %
      %
      \mpenv   & ::=                                        %
               & \emptyset                                  %
      %
      %
      %
      \\\rule{0pt}{2.25ex} %
      \mbox{ } & \mid \quad                                 %
               & \msenv,\mpchan:\left(\mval,\,\mst\right)   %
               & \mbox{ }                                   %
               & \mid \quad                                 %
               & \mpenv,\mlabel:\mtype                      %
      %
      %
      %
      \\\rule{0pt}{2.25ex} %
      \mbox{ } & \mid \quad                                 %
               & \msenv,\mepointp\mepointq:\queue           %
               & \mbox{ }                                   %
               & \mid \quad                                 %
               & \mpenv,\mpvar:\left(\msetT;\,\msset\right)
      %
      %
      %
      \\\rule{0pt}{3.5ex} %
      \msset   & ::=                                        %
               & \mathrlap{                                 %
         \emptyset%
         \quad\mid\quad%
         \msset\cup\left\{\msenv\right\}%
      } %
      %
      %
   \end{array}}

\newcommand{\processjudge}[0]{$\mprocessjudge$}