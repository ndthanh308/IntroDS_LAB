% demos in teaser figure and paper: 
% - pyramid chart, gantt chart, waffle chart, mosaic chart, waterfall, heatmap, matrix, tower chart, bullet chart, cartogram, grouped+stacked, diverging stacked, d3-3, rect packing
% - small multiples: bar charts on a map, treemap bar chart, 

% - motivation: \\
% why reuse, not authoring from scratch: 
% authoring requires programming skills/know the authoring framework;
% styles matter, want to reuse style\\
\section{Introduction}
% \chen{avoid using "example" explicitly}
Data visualization creators often look for and incorporate existing visualizations in their work \cite{bako2022understanding,bigelow_reflections_2014}, as these visualizations serve as concrete examples that embody design ideas in terms of encodings, visual styles, and layouts~\cite{bako2022understanding}. Even though a multitude of visualizations are available on the online galleries of visualization languages (\eg~D3 \cite{bostock_d3_2011}, Vega-lite \cite{satyanarayan_vega-lite_2016}) and authoring tools (\eg~Tableau Public \cite{tableau}, Data Illustrator \cite{liu_data_2018}, Charticulator \cite{ren_charticulator_2018}), it remains a major challenge to re-purpose these visualizations with users' own datasets in the implementation workflow \cite{bako2022understanding, Battle2021D3}.  Users either have difficulties specifying the mappings between their data and different components in a visualization using programming constructs provided in a language \cite{bako2022understanding, Battle2021D3}, or they have to understand the underlying framework or grammar of an authoring tool and create a visualization from an empty canvas \cite{satyanarayan_critical_2019}. 

Researchers thus have explored how to enable users to reuse existing visualizations without requiring them to learn a new language or start from scratch. For example, D3 Deconstructor \cite{harper_converting_2017,harper_deconstructing_2014} turns basic D3 charts
% created using D3.js \cite{bostock_d3_2011}
into reusable style templates; Chartreuse \cite{cui_mixed-initiative_2022} supports the reuse of infographics bar charts in Microsoft PowerPoint. A central challenge in these works is to obtain a semantic understanding of a chart by deconstructing its visual representation into components such as encodings, which can be reused on a new dataset. 
% and Chen \etal~\cite{chen_towards_2020} extracted templates from timeline infographics for reuse. 
% These approaches try to deconstruct a static visualization into components such as encodings, which can be reused on a new dataset. 
% However, the scope of examples that can be reused is limited in existing approaches. 
Existing approaches to deconstructing charts for reuse, however, are limited because of their primary focus on chart styles instead of layouts. D3 Deconstructor \cite{harper_converting_2017} extracts style templates only from basic charts (\eg bar charts, scatter plots), where the spatial arrangements of marks can be described using simple data bindings. Chartreuse \cite{cui_mixed-initiative_2022} focuses on glyphs with complex visual styles in bar charts with simple layouts. 
\revise{The positions of marks in a chart, however, can be determined by different approaches including but not limited to:}

\noindent{a)} \revise{\textit{encoding x/y properties using data}: in basic charts such as bar charts, scatter plots, and line graphs, the x/y positions of the marks directly encode data values.}  

\noindent{b)} \revise{\textit{computing position using a layout algorithm}: in visualizations with special layouts such as spiral layouts and force-directed layouts, the mark positions are the results of algorithmic computation.}

\noindent{c)} \revise{\textit{multi-factor positioning}: in many charts, it is impossible to identify a single layout mechanism, and the spatial arrangements are determined by multiple factors. For example, the positions of the bars in Figure 1d are determined by the stacking of the bars, the vertical arrangement of bar groups, and the alignment of bar groups. In Figure 1g, the positions of the bars are determined by order within each group as well as the group position encoding data.}

% such as:}

% \revise{- \textit{grouping} (e.g., multi-mark glyphs in \cref{fig:teaser}c and nested groups in \cref{fig:teaser}e),}

% \revise{- \textit{inter-object relationship} (e.g., stacking of rectangles, alignment of rectangles in \cref{fig:teaser}h and groups in \cref{fig:teaser}d), and} 

% \revise{- data encodings for segments (e.g., \cref{fig:teaser}b) and groups (e.g., \cref{fig:teaser}g). }
    
% influenced by a variety of factors such as \vspace{-5mm}
% \begin{enumerate}
%     \item Grouping, e.g., multi-mark glyphs in \cref{fig:teaser}(c) and nested groups in \cref{fig:teaser}(e);
%     \item Data encodings, e.g., mark position is encoding temperature data in \cref{fig:teaser}(b);
%     \item Alignments, e.g., rectangles aligned to different baselines in \cref{fig:teaser}(h) and the inter-group alignment in \cref{fig:teaser}(d).
% \end{enumerate}
% The positions of marks in a chart, however, can be influenced by a variety of factors such as grouping (e.g., multi-mark glyphs in \cref{fig:teaser}(c) and nested groups in \cref{fig:teaser}(e)), data bindings (e.g., mark position is encoding data values in \cref{fig:teaser}(b)), and alignments (e.g., rectangles aligned to different baselines in \cref{fig:teaser}(h) and the inter-group alignment in \cref{fig:teaser}(d)). 
% Multiple such factors may jointly determine the spatial arrangements in a chart, \eg small multiples of bar charts in \cref{fig:teaser}(g)) \revise{where positions of bar groups encode geographic data}. 

\revise{For approach (a), most existing tools support direct encoding of x/y channels with data and include these basic chart types as templates; for approach (b), dedicated libraries and tools exist to allow users to easily generate these specialized layouts by setting different parameters. The benefits of deconstructing and reusing charts are marginal in these cases. For approach (c), few chart authoring tools offer the related charts as standard templates, and it is often not obvious how to identify and specify the different factors determining the layout. Even though deconstructing such charts for layout reuse can be beneficial, to the best of our knowledge, no work has examined how to tease apart the factors.}

% \revise{and understand their joint contribution to the overall chart layout}.

Furthermore, existing approaches for chart deconstruction often require that charts are created using specific tools like D3.js \cite{bostock_d3_2011} or Microsoft PowerPoint \cite{cui_mixed-initiative_2022}, thereby further limiting the scope of reusable visualizations.  
% First, the supported examples are usually basic charts with simple layouts. 
% \leo{emphasize style vs. layout/spatial arrangements} 
% Style templates extracted by D3 Deconstructor represent the visual structure of a chart as mappings between data and mark attributes, which only works on basic charts whose layouts can be described using data bindings~(\eg bar charts, scatter plots);
% Chartreuse targets at infographics bar charts, and supports grid, stack, and tornado layouts.
% Tools like Tableau and Microsoft Excel already effectively support the creation of these charts. The benefits of reusing such examples are thus arguably marginal. 
% There is, however, little support for complex examples with \textit{nested layouts}, which are more difficult to create. Consider the bullet chart in \cref{fig:teaser}(c) and the diverging bar chart in \cref{fig:teaser}(d), which both include multiple levels of organization: 
% in the bullet chart, multiple overlapping rectangles form a low-level glyph, and these glyphs form a higher-level group; similarly, the diverging bar chart consists of nested groups in the form of multiple instances of stacked bars. Deconstructing such examples requires an accurate understanding of the hierarchical organization of the marks. 

% To address these limitations, we focus \leo{extend, not focus} on \textbf{deconstructing SVG charts with nested layouts} for example reuse. 
To address these limitations, we extend existing work and \revise{investigate how to deconstruct SVG (Scalable Vector Graphics) charts with multi-factor layout for reuse.}
% \revise{investigate how to determine factors influencing the spatial arrangements of charts as well as their relationships for deconstructing and reusing SVG (Scalable Vector Graphics) charts}. 
% extend the scope to further cover \textbf{SVG charts with nested layouts} for example reuse, which 
% includes but is not limited to small multiples~(\cref{fig:teaser}(g)), charts with multi-level concatenated layouts~(\cref{fig:teaser}(a,d,e,f,h)), and glyph-based charts~(\cref{fig:teaser}(c)).
We selected SVG as the input format for two reasons: (1) it is a tool-agnostic standard image format for 2-dimensional graphics and is supported in most charting libraries and systems and (2) every visual mark in a chart is specified as an SVG element: this is not true in raster images, where shapes have to be segmented and recognized. The semantic information in SVG visualizations in the wild, however, is often unreliable. In particular, the grouping of SVG elements can be arbitrary. For example, stacked bar charts created using different tools exhibit vastly different grouping structures~(\cref{fig:svg-g}); axis labels can be either within one group or in their own individual groups.
This lack of reliable grouping structure further complicates the problem of deconstructing charts for layout reuse. 
% In addition, the complex grouping structure together with other chart components such as encodings can pose challenges for users to specify the desired visual mappings. 
Given these challenges, we seek to answer two research questions: 
\begin{itemize}
    \item RQ1: How can we deconstruct existing SVG charts to identify factors \revise{that jointly determine} the spatial arrangements, given the unreliable grouping structures in the SVG format?
    %\item RQ2: How do we help users specify the mappings between a deconstructed chart design and a new dataset for reuse?
    \item RQ2: How do we apply the \revise{deconstruction result} from an SVG chart to a new dataset for reuse?
\end{itemize}

% emerge as we examine more plunging into it. The most crucial one is that the semantic information embedded in SVG files is sometimes unreliable: the $<$g$>$ element is used to group elements in many different---sometimes arbitrary---ways, and the grouping does not necessarily reflect the semantics needed for reuse.
% For example, stacked bar charts created using different tools exhibit vastly different grouping structures~(\cref{fig:svg-g}). Similarly, groupings for elements that represent axes or legends are random as well, e.g., axis labels can be either within one group or in their own individual groups. This issue is amplified in complex examples such as small multiples~(\cref{fig:teaser}(g)) and visualizations with bespoke or nested layouts~(\cref{fig:teaser}(f)), which pose additional challenges in designing interactions to help users specify data bindings and are not well supported in previous works~\cite{harper_converting_2017,cui_mixed-initiative_2022}. 
% Thus, we cannot rely on a given SVG example's grouping to infer the chart semantics~(layout, encodings, etc.) and build reuse applications. 
% These challenges then lead to the research question: \textit{How can we deconstruct existing SVG charts with complex semantic structures and help users specify mappings between a chart design and a new dataset for reconstruction?}
% the same mark type may be represented using different types of SVG elements; there sometimes exist noisy SVG elements that are not part of the main visualization; and the absolute positions of elements are usually not directly accessible. More importantly, 

% Figure environment removed

% We curate SVGs and identify challenges of reusing real-world SVG:
% We find that the semantic information in real-world SVG charts is unreliable: \\
% - grouping can be arbitrary: for charts with nested layouts, and also axis and legend\\
% focus on the interplay between 
% layout: position encoding + inter-object spatial relationship: we collected visualizations with these characteristics.

% layout implies two challenges:
% - deconstruction 
% - also, helping people specify the encodings with complex layouts is hard. 


% Second, complex examples such as small multiples and visualizations with nested layouts are usually not supported \cite{harper_deconstructing_2014,cui_mixed-initiative_2022}. Finally, many works focus on the deconstruction process but do not study how users may inspect, correct, and bind new data to  the extracted components through an interactive interface \cite{harper_converting_2017,chen_towards_2020}. 

% These three limitations lead to the following research questions: 
% \begin{itemize}
%     \item RQ1: What are the challenges when we try to support the reuse of example charts in a universal format, regardless of the tools used to create these charts?
%     \item RQ2: How can an existing chart with complex structures such as small multiples and nested layouts be deconstructed for reuse?
%     \item RQ3: How do we help users correct potential mistakes in the deconstruction results and specify the mappings between a chart design and a new dataset?
% \end{itemize}

% \leo{more on the target user}
% To address these questions, we focus on \textit{SVG visualizations} composed of \textit{rectangle marks} in this paper. We choose SVG
% (Scalable Vector Graphics) as the input format for two reasons: (1) it is a universal, tool-independent format and is supported
% in most charting libraries and systems, (2) every visual object in the
% chart is unambiguously specified as an SVG element: this is not true in
% raster images, where shapes have to be segmented and recognized. We decide to focus on charts composed of rectangle marks considering the vast design space of visual representations. Previous work has shown that it is unlikely that one single approach can solve the problem of reusing \textit{any} real-world SVG example. For example, Harper et al. focus on basic chart types created using D3 where the source data is available \cite{harper_converting_2017}, Chartreuse \cite{cui_mixed-initiative_2022} handles infographics bar charts, and Chen et al. focus on timeline infographics \cite{chen_towards_2020}. We thus carefully define the scope as rectangle-based charts, which cover a wide range of expressive designs. 
% how to enable reusing visualization examples from the web~(created with various tools) of complex semantics~(nested layouts or bespoke designs) in a human-computer collaboration~(mixed-initiative) manner?
% To approach this question, we present Mystique, an interactive authoring tool that aims at addressing the above limitations for better visualization resue.
% In this paper, we present our solution to the research question in the following contributions:\\
% \bpstart{C1: Curate a Chart Corpus} 
% Instead of requiring examples to be created using specific tools, we assume example visualizations are in the SVG (Scalable Vector Graphics) format, which accommodates online SVG charts from most charting libraries and systems. As there are no consistent regulations over forming SVGs, 
% We identify two challenges in reusing SVG charts: (1) the lack of reliable semantic information in raw SVG representations and (2) the vast space of visual representations~(details in \cref{sec:SVGchallenges}). Given both challenges, 
% We find that the semantic information in real-world SVG charts is unreliable and noisy: element types are inconsistent, absolute position information is often unavailable, and the scene graph can contain irrelevant objects. We also find that existing SVG corpora can be unbalanced and lack diversity.
% we focus on charts composed of rectangle marks and contribute an SVG-format chart corpus in which 


% % In this paper, 
% \revise{To address these limitations,} we investigate how to support \revise{interactive, tool-agnostic} reuse of existing SVG examples for chart creation without requiring access to the source code or data. \revise{Our target users are people who cannot program or do not want to learn a new language or framework, but can read and interpret charts.} \revise{Instead of requiring examples to be created using specific tools, we assume that the visualizations are in the SVG (Scalable Vector Graphics) format, which is supported in most charting libraries and systems. 
% % Compared to raster images where marks have to segmented and recognized, every visual object in an SVG visualization is unambiguously specified as a vector element.
% } We first identify two challenges in reusing SVG charts: (1) the lack of semantic information in raw SVG representations and (2) the vast space of visual representations. Given these challenges, we focus on charts composed of rectangle marks, and deeply explore the 
% \revise{how to deconstruct examples with complex structures such as nested layouts and small multiples. %To investigate the role of users in the reuse process, we adopt}
% % implications of example variations (in terms of chart structure, encodings, visual styles, and SVG representation) on reuse, and propose to use 

% Adopting a mixed-initiative approach, where users and machines collaborate throughout the reuse process, we designed and developed} \textit{Mystique}, an interactive authoring tool for building expressive data visualizations using SVG examples composed of rectangles. Figure~\ref{fig:teaser} presents eight demos of reusing bespoke chart designs accomplished by Mystique. 

% Unlike existing interactive authoring builders, with which a chart is created from scratch, 
% Mystique enables authors to start with an existing SVG chart composed of rectangle marks to reuse its semantic structure, and visual styles \revise{through the following features}: 

To answer RQ1, we support 
\textbf{mixed-initiative chart deconstruction} by combining automated algorithms with user input. Starting with the automatic extraction of axes and legend, we provide an interface for users to correct any mistakes in the extraction results through simple interactions. A hierarchical clustering algorithm then decomposes the main chart content into four semantic components that determine the chart layout: \textit{grouping}, \textit{parametric layouts}, \textit{encodings}, and \textit{graphical constraints}. Compared to previous work \cite{harper_converting_2017,cui_mixed-initiative_2022,chen_towards_2020}, our approach works on SVG examples with nested or bespoke structures that are created by a wide range of visualization tools, and can handle errors and uncertainties in the deconstruction pipeline.
% Starting with preprocessing the input SVG example and extracting axes and legend, Mystique then lets users correct any mistakes in the extraction results through simple interactions. The main chart content is then deconstructed into four semantic components: \textit{grouping}, \textit{parametric layouts}, \textit{encodings}, and \textit{graphical constraints}. Behind Mystique, a hierarchical clustering algorithm was developed to extract grouping and layouts, accompanied by algorithmic heuristics for analyzing encodings and graphical constraints. Compared to previous work \cite{harper_converting_2017,cui_mixed-initiative_2022,chen_towards_2020}, Mystique works on SVG examples with nested structures that are created by a wide range of visualization tools, and can handle errors and uncertainties in the deconstruction pipeline.

% \noindent\revise{\textbf{Sample Data Generation and Compatibility Check.} 
% One of the main challenges in preparing a compatible dataset for an authoring tool is conceptualizing the expected data layout \cite{wang_falx_2021}. To alleviate this problem, Mystique generates and presents a sample dataset with the desired format and column type information based on the deconstruction result, and verifies if the user's dataset is compatible with the example}. 

To answer RQ2, we propose \textbf{guided chart reuse through a wizard interface}. The reuse process starts with the user importing a dataset, where the dataset's compatibility with the example chart is checked. A wizard interface then guides the user through a series of steps to specify mappings between data attributes and visual objects or channels, which leads to a new visualization for the user's dataset.
Through this process, \revise{layout factors extracted by the deconstruction step are preserved}. 
Furthermore, the generated chart is in a format compatible with existing authoring tools (i.e., Data Illustrator~\cite{liu_data_2018}), enabling further interactive customization without the need to program.

% After a dataset is imported, Mystique verifies if the user's dataset is compatible with the example visualization and provides a wizard interface that guides the users through a series of steps to specify mappings between data attributes and visual objects or channels, which leads to a new visualization encoding their dataset. Through this process, visual styles from the input SVG are also preserved. Furthermore, the generated charts are in a format compatible with existing authoring tools like Data Illustrator \cite{liu_data_2018}, allowing further interactive customization without the need to program.
% After importing a dataset, Mystique}  provides a wizard interface to guide the authors through a series of steps to specify mappings between data attributes and visual objects or channels, which leads to a new visualization encoding their dataset. Through this process, visual styles from the input SVG are also preserved. \revise{Furthermore, Mystique can export the generated charts in a format compatible with existing authoring tools like Data Illustrator \cite{liu_data_2018}, allowing further interactive customization without the need to program.} 


% To reflect the diversity and complexity of real-world SVG visualizations, we curated an SVG chart corpus by sampling 150 visualizations produced by 25 different tools and encompassing more than 20 chart types. 
% were sampled 
% We further developed a SVG parser to pre-process these charts to remove the noises and inconsistencies in the SVG representations. This corpus is used to train and validate our chart reuse approach.
% deeply explore how to deconstruct examples with complex structures such as nested layouts and small multiples.

We develop these solutions in an interactive prototype, Mystique, and evaluate the viability of our approach in two ways. We demonstrate that our deconstruction method works on 150 real-world SVG charts produced by 25 different tools, covering more than 20 chart types. We also conduct a chart re-production study with $12$ participants to evaluate the usability of the wizard interface. The participants were able to create new charts in a few minutes with Mystique by reusing the charts given to them as examples. 

% The major research contributions of our work are as follows:
% \begin{itemize}
%     % \setlength{\parskip}{0pt}
%     \item An approach to support tool-agnostic, interactive reuse of existing SVG examples composed of rectangle marks. 
%     \item The design and implementation of Mystique, a mixed-initiative system that includes SVG pre-processing, axis and legend detection, user correction, chart content decomposition, and a wizard interface for chart reusing.
%     \item Results from a chart re-production study with $12$ participants that demonstrates the feasibility of our approach and evaluates the usability of Mystique. The participants were able to create new charts in a few minutes with Mystique by reusing the examples given to them. 
% \end{itemize}


% - scope: bespoke charts composed of rect marks in SVG format\\
% bespoke: if creating basic standard charts, can just use tools like Excel; any definition for “bespoke”? rect marks: have a clear focus, reduce the complexity

