In 1971, Fischer Black explored the concept of computer-driven ``automated exchanges'' that could streamline intermediation in financial markets \citep{Black1971}. One important argument was that broadening the group of traders who provide liquidity would alleviate the limitations imposed by a specialist's inventory size. Over the following half-century, markets progressively moved in this direction, with the majority of exchanges now operating as limit order books, theoretically enabling any trader to supply liquidity. However, in practice, the rise of algorithmic and high-frequency trading made liquidity provision in limit order markets a technology-intensive affair, necessitating low-latency connectivity and active management of quotes. Some trader categories, such as retail investors, struggle to competitively supply liquidity in this environment.

Decentralized exchanges (DEXs), which function as fully automated trading platforms implemented as smart contracts on public blockchains, offer a novel passive liquidity supply mechanism which requires significantly fewer quote updates. Market makers can deposit and withdraw funds into a ``liquidity pool,'' and trade prices are determined by an Automated Market Maker algorithm \citep[see, e.g.,][]{park2022} as a function of the available funds in the pool. They receive compensation through liquidity fees, computed as a fixed percentage of trading volume charged to traders seeking immediate execution, as opposed to bid-ask spreads. Uniswap, the leading decentralized exchange, allows for the fragmentation of trading for each token pair across multiple pools with varying liquidity fees.  In Appendix \ref{sec:app-dex}, we discuss in depth the trading mechanics on Uniswap.

The passive nature of liquidity supply in DEXs was initially designed to minimize interactions with blockchain smart contracts, as these interactions incur gas costs to compensate the decentralized network for spent computational power. Nevertheless, passive liquidity supply is particularly well-suited for small retail liquidity providers, who face their own time and effort fixed costs. Can the mechanisms used by decentralized exchanges have a comparable impact on liquidity supply as ETFs had on transforming portfolio management in recent decades?

Our paper shows that fixed costs translate to significant economies of scale on decentralized exchanges, which lead to market fragmentation and the emergence of liquidity provider clienteles. Specifically, our findings reveal that a small number of highly active large liquidity providers, potentially institutional investors and hedge funds, primarily trade against numerous small incoming trades on pools with low fees. In contrast, high-fee pools involve less frequent trading between a substantial number of capital-constrained passive liquidity providers (e.g., retail market makers) on one side and a few sizeable incoming orders on the other. The underlying economic mechanism is that smaller liquidity providers strategically trades off a lower execution probability against higher liquidity fee and less frequent fixed costs, such as gas fees.



% Market makers on decentralized exchanges are primarily compensated by liquidity fees: a fixed percentage of trading volume levied on traders who demand immediacy. If the current price (i.e., the pool ``mid-point'') drifts outside of the liquidity providers' price range, the position stops earning fees.\footnote{In a limit order market, the situation corresponds to a limit order being filled and then immediately re-posted at the old price which is deeper in the book.} To be able to earn fees again, liquidity providers need to cancel (``burn'') the old position and deposit (``mint'') tokens specifying a new price range that straddles the current benchmark price. While such re-balancing is trivial on centralized exchanges, liquidity providers on DEXs have to pay a significant fixed cost each time they interact with the liquidity pool's smart contract. For the Ethereum blockchain, the fixed cost corresponds to the price of ``gas'' needed to compensate the decentralized network for spent computational power.

% We find that low-fee pools are very active and match a handful of large liquidity providers (such as institutional investors and hedge funds) with many small incoming trades. In contrast, trading on high-fee pools involves infrequent trades between a large number of capital-constrained passive liquidity providers (e.g., retail market makers) on the one side and a few sizeable incoming orders, on the other. 


% Thirty years ago, \citet{Glosten1994} conjectured that the limit order book is an ``inevitable'' equilibrium market design for trading financial securities. The recent evolution of decentralized exchanges (DEXs), fully automated trading platforms built as smart contracts on top of public blockchains, lends further weight to this argument. 

% Early iterations of decentralized exchange protocols (such the 2018 version of Uniswap) allowed market makers to deposit and withdraw funds to a ``liquidity pool,'' but not to set price limits beyond which they do not want to provide liquidity -- i.e., akin to bid and ask prices in traditional markets. Instead, trade prices are exogenously determined by an Automated Market Maker algorithm \citep[see, e.g.,][]{park2022}. Modern implementations alleviate the rigidity of automated market makers and bring the DEX design closer to that of limit order books. Uniswap v3, the world's leading DEX with a 40\% volume share as of November 2022, distinguishes itself from its predecessors and competitors by effectively allowing traders to submit limit orders. Liquidity providers can specify a maximum (minimum) price at which they are willing to buy (sell) the asset. With a fine enough tick size, depth on Uniswap v3 can therefore replicate any arbitrary price schedule on a limit order book.\footnote{Uniswap Labs refers to these orders as ``concentrated liquidity'' or ``range orders'' -- see, for example, \url{https://docs.uniswap.org/protocol/concepts/V3-overview/range-orders}. Liquidity providers can set prices on a relatively fine price grid -- the tick size for liquid pairs ranges from 1 to 10 basis points. Prices inside the grid are set exogenously by the same AMM constant product logic as described, for example, in \citet{LeharParlour2021}. We provide an in-depth discussion of trading mechanics on Uniswap v3 in Appendix \ref{sec:app-dex}.}

% Our paper shows, both theoretically and empirically, that the ability to deploy limit orders on decentralized exchanges may lead to fragmented markets. The rationale is that liquidity providers submitting limit orders need to frequently manage their position as the market price drifts outside the pre-set range. While such re-balancing is trivial on centralized exchanges, liquidity providers on DEXs have to pay a significant fixed cost each time they interact with the liquidity pool's smart contract. For the Ethereum blockchain, the fixed cost corresponds to the price of ``gas'' needed to compensate the decentralized network for spent computational power.

% Market makers on decentralized exchanges are primarily compensated by liquidity fees: a fixed percentage of trading volume levied on traders who demand immediacy. If the current price (i.e., the pool ``mid-point'') drifts outside of the liquidity providers' price range, the position stops earning fees.\footnote{In a limit order market, the situation corresponds to a limit order being filled and then immediately re-posted at the old price which is deeper in the book.} To be able to earn fees again, liquidity providers need to cancel (``burn'') the old position and deposit (``mint'') tokens specifying a new price range that straddles the current benchmark price. We show that high enough gas prices drive the emergence of heterogeneous market maker clienteles across pools with different fees. Low-fee pools are very active and match a handful of large liquidity providers (such as institutional investors and hedge funds) with many small incoming trades. In contrast, trading on high-fee pools involves infrequent trades between a large number of capital-constrained passive liquidity providers (e.g., retail market makers) on the one side and a few sizeable incoming orders, on the other. 


Our first contribution is a theoretical model of liquidity provision on decentralized exchanges. A continuum of liquidity providers ($\LP$s) choose to deposit their token endowments in either a high- or a low-fee pool; that is, they \emph{mint} liquidity. The liquidity providers have heterogeneous token endowments, which map to different capital constraints --- low-endowment $\LP$s are akin to retail traders, whereas high-endowment $\LP$s may stand in for large institutional investors or quantitative funds. Further, liquidity providers incur a fixed cost (i.e., gas price) each time they update their position.

Traders demanding liquidity route their orders first to the low-fee pool to minimize transaction costs. The high-fee pool executes the residual order flow from large traders who exhaust all liquidity at the cheaper venue. As a result, low-fee markets are actively traded and require frequent liquidity updates whereas high-fee pools have a longer liquidity update cycle since they absorb fewer trades. 

Both pools can attract a positive market share if the gas price is large enough due to economies of scale. Liquidity providers trade off a higher revenue per unit of time in the low-fee pool (driven by the larger trading volume) against the additional gas cost required for active liquidity management. As a result, market maker clienteles emerge in equilibrium. Liquidity providers with large endowments gravitate towards low-fee markets, as they are best positioned to frequently update their position. In contrast, smaller market makers choose to passively provide liquidity on high-fee markets where they only trade against large orders being routed there. They optimally trade off a lower execution probability against higher fees per unit of volume and a lower liquidity management cost per unit of time. 

Using the model for guidance, we analyze a data set comprising of more than 13 million interactions with Uniswap v3 liquidity pools -- that is, all liquidity updates and trades from May 2021 until September 2022. Uniswap v3 launched in May 2021 and quickly established itself as the leading decentralized exchange. Daily trading volume on Uniswap v3 typically exceeds US \$1 billion, whereas the total liquidity supply varies between US \$3-5 billion in our sample, across hundreds of cryptocurrencies. For major pairs such as Ether against USD stablecoins, Uniswap boasts twice or three times better liquidity than centralized exchanges such as Binance.\footnote{See \href{https://uniswap.org/blog/uniswap-v3-dominance}{The Dominance of Uniswap v3 Liquidity}; May 5, 2022.} 

The market design explicitly allows for fragmentation. Each asset pair to be traded on up to four liquidity pools that only differ in the compensation for liquidity providers: in particular, liquidity fees can be equal to 1, 5, 30, or 100 basis points and the corresponding tick sizes are 1, 10, 60, or 200 basis points. The liquidity pools are otherwise identical and, importantly, they share the common infrastructure of the Ethereum blockchain -- i.e., they are similarly impacted by variation in gas prices due to, say, network congestion. At launch, Uniswap Labs conjectured that trading and liquidity should consolidate in equilibrium on a single ``canonical'' pool for which the liquidity fee is just enough to compensate the marginal market maker for adverse selection and inventory costs. That is, activity in low-volatility pairs such as stablecoin-to-stablecoin trades should naturally gravitate to low fee liquidity pools, whereas speculative trading in more volatile pairs will consolidate on high fee markets.\footnote{See \emph{Flexible fees} paragraph at \url{https://uniswap.org/blog/uniswap-v3}; accessed September 14, 2022.}

We document significant liquidity fragmentation in 37 out of 217 asset pairs in our sample, which account for 84\% of liquidity committed to Uniswap v3 smart contracts and 94\% of trading volume. For each of the fragmented pairs, trading consolidates on two pools with adjacent fee levels: either 1 and 5 basis points (e.g., USDC-USDT), 5 and 30 basis points (ETH-USDC), or 30 and 100 basis points (USDC-CRV).

High-fee pools are on average larger -- with aggregate end-of-day liquidity of \$43.42 million relative to \$31.35 million, the average size of low-fee pools. Nevertheless, two thirds of trading volume executes on low-fee pools. In line with the model predictions, low-fee pools are more active as they capture many small trades. There are five times as many trades on low- than on high-fee pools (577 versus 111). However, the average trade on the high fee pool is twice as large: \$22,460 relative to \$9,890. Unsurprisingly, liquidity cycles -- measured as the time between the submission and update of an order -- are 19.85\% shorter on the highly active low-fee pool. 

We find evidence of market maker clienteles across pools. The average liquidity deposit is 91.5\% larger on the low-fee pool, after controlling for daily volume and return volatility. At the same time, there are 18\% fewer liquidity providers on low-fee pools. The results point to an asymmetric match between liquidity supply and demand: large $\LP$s are matched with small trader on low-fee pools, whereas a sizeable mass of small $\LP$s trade with a few large orders on the high-fee pool. 

The degree of market fragmentation depends on the magnitude of gas costs on the Ethereum blockchain. In the model, a higher gas price leads to a shift in liquidity supply from the low- to the high-fee pool as active position management becomes relatively more costly for the marginal $\LP$. We find that a one standard deviation increase in gas prices corresponds to a 2.30 percentage points decrease in the low-fee pool market share, and a 36\% drop in liquidity inflows on days when gas costs are elevated. As $\LP$s leave the low-fee pool, the time between position updates becomes 10\% shorter since incoming order flow depletes liquidity at a faster pace. The effect reinforces the expected gas cost difference between the two pools, leading to more $\LP$s switching to the high-fee venue.

Our paper relates to a nascent and fast-growing literature on the economics of decentralized exchanges. Many studies \citep[e.g.,][]{aoyagi2020,aoyagiito2021,park2022} focus on the economics of constant-function automated market makers, which do not allow liquidity providers to set price limits. In this restrictive environment, \citet{CapponiJia2021} argue that market makers have little incentives to update their position upon the arrival of news to avoid adverse selection, since pro-rata clearing gives an advantage to arbitrageurs. \citet{LeharParlour2021} solve for the equilibrium pool size in a setting where liquidity providers fully internalize information costs without rushing to withdraw positions at risk of being sniped. We argue that on exchanges that allow for limit or range orders, the cost of actively managing positions becomes a first-order concern, as $\LP$s need to re-set the price limits once posted liquidity no longer earns fees. Our empirical result on economies of scale echoes the argument in \citet{BarbonRanaldo2021}, who compare transaction costs on centralized and decentralized exchanges and find that high gas prices imply that the latter only become competitive for transactions over US\$100,000. \citet{HasbrouckRiveraSaleh2022} argue that higher liquidity fees on decentralized exchanges stimulate liquidity supply and lead to an increase in the equilibrium trading volume. We complement the argument by stating that high fees might be \emph{necessary} for some liquidity providers to cover the fixed costs of managing their position. In line with our theoretical predictions, \citet{caparros2023blockchain} find that liquidity providers reposition their quotes more often on Uniswap V3 pools built on Polygon, which features substantially lower gas fees. Finally, \citet{Heimbach2023} document that after accounting for price impact, concentrated liquidity on Uniswap v3 pools results in increased returns for sophisticated participants but losses for retail traders. 


Despite higher gas costs, decentralized exchanges may hold advantages over centralized venues. \citet{han2022trust} demonstrate Uniswap frequently leads price discovery compared to centralized exchanges such as Binance, despite the latter having higher trading volume. \citet{capponi2023price} find that the fee paid traders to establish execution priority unveils their private information, and therefore contributes to price discovery. \citet{ASPRIS2021101845} argue that decentralized exchanges offer better security than their centralized counterparts since assets are never transferred to the custody of a third party such as an exchange wallet. In turn, \citet{BrolleyZoican2022b} make the point that decentralized exchanges may be able to reduce overall computational costs associated with latency arbitrage races, as they eliminate long-term co-location subscriptions.

We also relate to a rich literature on market fragmentation and differential fees. Closest to our paper, \citet{Battalio2016} and \citet{Cimon2021} study the trade-off between order execution risk and compensation for liquidity provision in the context of make-take fee exchanges. However, \citet{Battalio2016} specifically addresses the issue of the broker-customer agency problem, whereas our study focuses on liquidity providers who trade on their own behalf. In traditional securities markets, make-take fees are contingent on trade execution and proportional to the size of the order.  On the other hand, gas costs on decentralized exchanges are independent of order execution, highlighting the significance of economies of scale (lower proportional costs for larger liquidity provision orders) and dynamic liquidity cycles (managing the frequency of fixed cost payments). Strategic brokers in \citet{Cimon2021} examines strategic brokers who provide liquidity alongside exogenous market-makers in a static setting. We complement this approach by modelling network externalities inherent in the coordination problem of heterogeneous liquidity suppliers. In our dynamic setup, this allows us to pin down the equilibrium duration of liquidity cycles and the relative importance of gas fixed costs.

Fixed costs for order submission are uncommon in traditional markets. However, in 2012, the Canadian regulator IIROC implemented an ``integrated fee model'' that charged traders for all messages sent to Canadian marketplaces. \citet{KorajczykMurphy2018} document that this measure disproportionately affected high-frequency traders, resulting in wider bid-ask spreads but lower implementation shortfall for large traders, possibly due to a reduction in back-running activity. Our study contributes additional insights by highlighting that the introduction of a fixed cost, even when applied across exchanges, can lead to market fragmentation.

The classical study of \citet{pagano1989trading} shows that if an asset is traded on two identical exchanges with equal transaction costs, in equilibrium market participants gravitate to a single exchange due to network effects. In practice, exchanges are rarely identical: fragmentation can emerge between fast and slow exchanges \citep{pagnotta2018competing, brocim:20} or between lit and dark markets \citep{Zhu2014}. In our model, fragmentation on decentralized exchanges is driven by variation in liquidity fees as well as different economies of scale due to heterogeneity in liquidity provider capital. We find that liquidity fragmentation driven by high gas fees implies larger transaction costs on incoming orders. We note that there is no time priority on decentralized exchanges, which clear in a pro rata fashion. On markets with time priority, \citet{FoucaultMenkveld2008} and \citet{Ohara2011market} find that market segmentation in equity markets improves liquidity (by allowing queue jumping) and price discovery.
