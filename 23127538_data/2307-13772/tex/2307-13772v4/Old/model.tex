% A model of AMM liquidity provision \citep[potentially as in][]{LeharParlour2021}, with a clientele effect due to investor heterogeneity \citep[maybe along the lines of][]{KhomynPutninsZoican2022}. Among key parameters are heterogeneous investor capital (or aversion to transaction fees) and network transaction fees.

\subsection{Model primitives}

\paragraph{Assets.} Consider a three-period economy, where time is indexed by $t\in\left\{0,1,2\right\}$. There are two assets: a risky token $\T$ and a riskless num\'{e}raire $\C$. At $t=2$, the risky token $\T$ pays a stochastic dividend $\tilde{v}$ (denominated in units of $\C$). At the start of the game, the expected token value is $\mathbb{E}_0 \tilde{v}=v>1$. 

The asset $\C$ stands in for cryptocurrencies typically used as num\'{e}raire on decentralized exchanges -- for example Ether (the native currency of the Ethereum blockchain) or stablecoins such as Tether or USD~Coin. The num\'{e}raire pays a risk-free rate of return $r$, which we normalize to zero without loss of generality.

\paragraph{Trading environment.} The risky token is traded on two liquidity pools: $L$ (a low-fee pool) and $H$ (a high-fee pool). The asset quantities in each pool $k\in\left\{L,K\right\}$ must satisfy at all times the following linear bonding curve:
\begin{equation}\label{eq:bond_curve}
    v \T_k + \C_k = \text{constant}.
\end{equation}
The bonding curve \eqref{eq:bond_curve} implies that the token price is constant and equal to $v$ units of the num\'{e}raire, since $-\frac{\diff T}{\diff C}=v$. To fix intuition behind the mechanics of the market, suppose a trader wishes to buy $t$ units of the token. This reduces the token amount in the pool to $\T_k-t$. In return, the trader needs to add $\Delta$ units of the num\'{e}raire, where $\Delta$ is such that the new asset quantities remain on the bonding curve, that is:
\begin{equation}
    v \left(\T_k-t\right) + \left(\C_k+\Delta\right) = v \T_k + \C_k,
\end{equation}
which is equivalent to having $\Delta = v t$. The slope of the bonding curve is equal to the expected value of the asset to ensure there are no arbitrage opportunities at the start of the game. 

The two liquidity pools charge different fees on liquidity-removing trades. Fees are expressed in units of num\'{e}raire and are distributed to all liquidity providers in a given pool, proportional to the amount of liquidity provided.  The low-fee pool $L$ charges a fee of $f~\C$ where $f<1$, and the high-fee pool $H$ charges a fee of $1~\C$ per token traded. That is, to purchase $t$ units of the token, the total cost of an investor is $t\left(v+f\right)$.

\paragraph{Events.} At $t=1$, two types of exogenous events can occur. With probability $\eta<1$, the common value of the token changes to $v+1$ (good news) or to $v-1$ (bad news); good and bad news are equally likely. With probability $\left(1-\eta\right)$ -- that is if news does not occur -- a liquidity trader ($\LT$) receives a private value shock and needs to trade $\tilde{\theta}$ units of the token, where $\tilde{\theta}\sim\text{Uniform}\left[0,1\right]$. The liquidity trader is equally likely to buy or sell the token. We assume the $\LT$s private value is large enough to cover transaction costs on either liquidity pool.

\paragraph{Liquidity providers and arbitrageurs.} In addition to liquidity traders, the token is traded by two types of agents: risk-neutral liquidity providers ($\LP$) and arbitrageurs ($\A$). There is a continuum of liquidity providers indexed by $i$, endowed with heterogeneous amounts of the token $T$. Liquidity provider $i$ is endowed with $t_i= \log\left(2\right) q_i$ units of the token. Following \citet{KhomynPutninsZoican2022}, we assume that $q_i$ is distributed with density
\begin{equation}\label{eq:density}
    \phi\left(q\right)=\log^{-1}\left(2\right)\frac{1}{q},\text{ for }q\in\left[1,2\right].
\end{equation}
The choice of density ensures that the aggregate token endowment of liquidity providers $\T_\text{agg}$ is normalized to one, since
\begin{equation}\label{eq:aggliq}
    \T_\text{agg}=\int_1^2 \underbrace{\log\left(2\right) q_i}_{\equiv t_i} \phi\left(q_i\right)\diff q_i = 1.
\end{equation}
Further, the density is chosen to match key features of the empirical distribution of $\LP$s: there are many low-endowment liquidity providers (e.g., retail traders) and a long tail of high-capital investors who provide liquidity to decentralized exchange -- for example, quantitative institutional investors. Figure \ref{fig:distribution} illustrates the distribution of $\LP$s endowments.

% Figure environment removed

The arbitrageurs $\A$ are risk-neutral speculative traders as in \citet{Budish2015TheResponse} or \citet{Menkveld2017NeedLiquidity}, and have zero private value for the token. Upon observing a common value innovation, arbitrageurs can submit a trade against liquidity providers if (i) liquidity is being offered at a stale price and (ii) it is profitable to take liquidity after taking into account gas costs and pool fees.

\paragraph{Gas fee (order execution cost).} Orders submitted at $t=1$ to trade against pool liquidity or to withdraw existing liquidity incur a fixed execution cost $\Gamma \times \log\left(2\right) \diff i$, where $\Gamma>0$. The execution cost can be interpreted as a gas fee on the Ethereum blockchain as in \citet{CapponiJia2021}. In contrast to \citet{CapponiJia2021}, we assume traders on the decentralized exchanges are price takers on the gas market and their orders do not impact the gas cost. A natural interpretation is that message volume at any time in a particular asset pair traded on decentralized exchanges is small relative to the aggregate transaction flow on the entire blockchain.


\paragraph{Timing.} Figure \ref{fig:timing} summarizes the sequence of events at each time $t$. At $t=0$, liquidity providers arrive at the market and choose to deposit their tokens (and corresponding num\'{e}raire) on either the high- or low-fee liquidity pool. At $t=1$, an exogenous trigger event happens: either news, that is a common value innovation, or a private value shock to liquidity traders. With probability $1-\eta$, a liquidity trader arrives and trades a random quantity $\tilde{\theta}$. Conversely, with probability $\eta$, news arrives which moves the asset value to either $v+1$ or $v-1$. In this case, liquidity providers have a first-mover advantage: they can pay the fixed gas fee $\Gamma$ and withdraw liquidity from the pool to avoid being adversely selected. Following the $\LP$s' choice, arbitrageurs may trade in the direction of the news if profitable to do so. Finally, at $t=2$ all payoffs are realized. 

% Figure environment removed

\subsection{Equilibrium \label{sec:eq}}

We solve the game by backward induction. First, we discuss the optimal strategy of arbitrageurs and liquidity traders at $t=1$, taking equilibrium liquidity provision as given. Next, we solve for the optimal liquidity pool choices of $\LP$s at $t=0$. 

\subsubsection{Optimal strategies at \texorpdfstring{$t=1$}{t=1}}

The linear pricing curve ensures that the liquidity trader $\LT$ always trades at the fundamental token value $v$, regardless of the trade size. In contrast to markets with convex bonding curves as described in \citet{LeharParlour2021} or \citet{CapponiJia2021}, there is no price impact on the constant price market, which implies there is no impermanent loss for liquidity providers from uninformed trading, and further that no arbitrage trade is needed to restore the fundamental value. However, the liquidity trader faces a difference in the constant per-unit liquidity fee across the two pools. 

Let $T^\star_L$ and $T^\star_H$ be the equilibrium supply of tokens on liquidity pools $L$ and $H$, respectively. To minimize trading cost, the liquidity trader first submits an order on the low-fee pool. If liquidity on pool $L$ is sufficient to accommodate the demand, that is if $\theta\leq T^\star_L$, then the $\LT$ executes its entire order on $L$. Conversely, if $\theta>T^\star_L$, the liquidity trader exhaust the liquidity supply on $L$ and trades the residual quantity $\theta-T^\star_L$ against liquidity on pool $H$. From equation \eqref{eq:aggliq}, the aggregate liquidity supply is $T^\star_L+T^\star_H=1$, which implies that $T^\star_k \leq 1$, for $k\in\left\{L,H\right\}$. Since $\theta<1$, the liquidity trader executes her entire order with probability one and incurs a net cost of $f \times T_L^\star + 1 \times T_H^\star$.

If news occurs and $\LP$s do not withdraw liquidity from the pool, arbitrageurs can trade in the direction on the news to obtain a gross profit of $1~\C$ per token traded (i.e., the size of the news). Concretely, upon good news an arbitrageur deposits $q_{\text{arb},k} v$ units of num\'{e}raire into liquidity pool $k$ and removes $q_{\text{arb},k}$ tokens with a value of $q_{\text{arb},k} \left(v+1\right)$. Further, the arbitrageurs pays the pool fee $f_k$ and the gas fee equal to $\Gamma\log\left(2\right) \diff i$. The net profit from trading $q_{\text{arb},k}$ on liquidity pool $k$ is therefore:
\begin{equation}\label{eq:pi_arb}
    \Pi_\A = q_{\text{arb},k}\left(1-f_k\right)-\Gamma\log\left(2\right) \diff i
\end{equation}

\begin{ass}\label{ass:gamma}
\begin{leftbar} \setlength{\parskip}{0ex}
The gas fee is low enough such that it does not prevent arbitrageurs from trading on any opportunities, that is $\Gamma < 1-f$.
\end{leftbar}
\end{ass}

Assumption \ref{ass:gamma} guarantees that the arbitrageur profit as defined in \eqref{eq:pi_arb} is always positive on liquidity pool $L$, as long as the pool is non-empty. That is, arbitrageurs are willing to trade upon news even if only the lowest-endowment $\LP$ with $\tau_i=\log\left(2\right) \times 1 \diff i$ submits liquidity on pool $L$. Further, since the arbitrageur profit increases in the quantity traded, $\A$ optimally removes the entire liquidity from pool $L$. Finally, since the fee on pool $H$ is equal to the size of the news, the arbitrageur never consumes liquidity from pool $H$ for any positive gas fee. The mechanism is similar to the one in \citet{FoucaultMoinasTheissen2007}, where the size of news and the tick size are such that arbitrageurs consume only the liquidity at the best bid or ask. 

When do liquidity providers withdraw their liquidity? On pool $H$, withdrawing is never optimal since the fee is high enough to deter arbitrageurs and push adverse selection risk to zero. On pool $L$, liquidity providers with endowment $q_i$ compare the adverse selection cost and the gas fee and withdraw liquidity if and only if
\begin{equation}
    q_i \log\left(2\right)\left(1-f\right)>\Gamma \log\left(2\right),
\end{equation}
which is always true under Assumption \ref{ass:gamma}. Lemma \ref{lem:t1} summarizes the optimal strategies for all agents at $t=1$.

\begin{lem}\label{lem:t1}
\begin{leftbar} \setlength{\parskip}{0ex}
At $t=1$, the optimal strategies are as follows:
\begin{enumerate}
    \item[(i)] arbitrageurs buy (sell) $T^\dagger_L$ tokens on pool $L$ upon a positive (negative) common value innovation, where $T^\dagger_L$ is the size of pool $L$ at $t=1$, after the liquidity providers' decision to withdraw or not. The arbitrageur does not trade otherwise.
    \item[(ii)] a liquidity trader with a private value shock of size $\theta$ trades $\min\left\{T_L^\star,\theta\right\}$ on pool $L$ and $\max\left\{0,T_L^\star-\theta\right\}$ on pool $H$. 
    \item[(iii)] Liquidity providers on pool $L$ pay the gas fee and withdraw their liquidity. In contrast, liquidity providers on pool $H$ do not attempt to withdraw liquidity.
\end{enumerate}

\end{leftbar}
\end{lem}

\subsubsection{Liquidity provision at \texorpdfstring{$t=0$}{t=0} \label{sec:liqprov}}

We turn next to the liquidity providers' choice of pool at $t=0$. Let $T_L$ and $T_H$ denote the size of liquidity pools $L$ and $H$, expressed in token units. The expected profit of an $\LP$ with endowment $\tau_i=q_i \log 2$ posting liquidity on pool $L$ is
\begin{align}\label{eq:lp_L}
    \pi^\LP_L &= q_i \log 2 \left(1-\eta\right)\mathbb{E}\left[\min\left\{\frac{\theta}{T_L},1\right\}\right] f  - \eta \Gamma \log 2 \nonumber \\
    &=q_i \log 2 \left[\left(1-\eta\right)\left(1-\frac{T_L}{2}\right) f\right] - \eta \Gamma \log 2,
\end{align}
since
\begin{align}
    \mathbb{E}\left[\min\left\{\frac{\theta}{T_L},1\right\}\right] &= \mathbb{P}\left(\theta\leq T_L\right) \times \mathbb{E}\left[\frac{\theta}{T_L} \mid \theta\leq T_L\right] + \mathbb{P}\left(\theta > T_L\right) \times 1 \nonumber \\
    & = T_L \times \frac{1}{2} + \left(1-T_L\right) = 1 - \frac{T_L}{2},
\end{align}
where the last equality follows from the fact that $\theta$ is uniformly distributed over $\left[0,1\right]$. With probability $1-\eta$, a liquidity trader arrives at $t=1$ and trades $\theta$. If $\theta>T_L$, then the liquidity trader consumes the entire pool and the $\LP$ receives the fee $f$ for each unit of liquidity posted. Conversely, if $\theta\leq T_L$, then the liquidity provider receives a share $\frac{q_i}{T_L}$ of the aggregate fees $\theta f$. With probability $\eta$, news occurs: from Lemma \ref{lem:t1}, the liquidity provider pays the gas fee $\Gamma \log 2$ and withdraws $q_i$ from the pool. 

Alternatively, the $\LP$ can deposit liquidity on pool $H$ and earn expected profit
\begin{align}\label{eq:lp_H}
    \pi^\LP_H &= q_i \log 2 \left(1-\eta\right) \mathbb{E}\left[\max\left\{0,\frac{\theta-T_L}{T_H}\right\}\right] \nonumber \\
    & = q_i \log 2 \left(1-\eta\right) \left(1-T_L\right) \frac{1-T_L}{2 T_H},
\end{align}
where the second line follows from explicitly computing the expectation
\begin{align}
    \mathbb{E}\left[\max\left\{0,\frac{\theta-T_L}{T_H}\right\}\right] &= \mathbb{P}\left(\theta\leq T_L\right) \times 0 + \mathbb{P}\left(\theta > T_L\right) \times \frac{\frac{1+T_L}{2}-T_L}{T_H} \nonumber \\
    & = \left(1-T_L\right) \frac{1-T_L}{2 T_H}.
\end{align}
If the liquidity trader demand is low enough, that is if $\theta\leq T_L$, then the entire trade is filled on pool $L$ and liquidity providers on $H$ earn nothing. However, if $\theta>T_L$, the residual liquidity demand $\theta-T_L$ is routed to pool $H$ and liquidity providers earn a share proportional to their deposit, i.e., $\frac{q_i}{T_H}$. If news occurs, $\LP$s on $H$ do not incur an adverse selection cost since from Lemma \ref{lem:t1} arbitrageurs do not submit orders to the high-fee pool.

Liquidity providers in the low-fee pool absorb a larger share of the uninformed order flow, since the $\LT$ order is first routed to pool $L$. On the other hand, they need to pay gas fees $\Gamma$ to update their liquidity if token value changes to avoid being adversely selected. At the same, $\LP$s in the high-fee pool face no adverse selection, receive a larger fee per unit traded, but volume is limited as they only fill the residual demand from uninformed $\LT$s after liquidity on the low-fee pool is exhausted. From equations \eqref{eq:lp_L} and \eqref{eq:lp_H}, liquidity provider $i$ chooses the low-fee pool $L$ if and only if
\begin{equation}\label{eq:cost_comparison}
    \pi^\LP_L>\pi^\LP_H \Longleftrightarrow q_i \frac{\left(1-\eta\right)\left(\left(1-T_L\right)^2-f T_H \left(2-T_L\right)\right)}{2T_H} - \eta\Gamma > 0.
\end{equation}
A salient implication of equation \eqref{eq:cost_comparison} is that $\LP$s with larger endowments are more likely to choose the low-fee pool, keeping liquidity shares constant. The rationale is that gas fees are a fixed cost, and larger $\LP$s are more likely to achieve economies of scale. The expected fee revenue scales linearly with a liquidity provider's share in the liquidity pool (proportional to $q_i$), better compensating $\LP$s for the gas fee paid upon news arrival at $t=1$. 

We follow \citet{KatzShapiro1985} and conjecture that there exists a marginal liquidity provider $\qmg$ such that all $\LP$s with $q_i>\qmg$ post liquidity on the low-fee pool and all $\LP$s with $q_i\leq \qmg$ choose the high-fee pool.\footnote{We note that there cannot be a ``reversed-sign'' equilibrium, where $\LP$s with $q_i\leq\qmg$ post liquidity on the low-fee pool and all $\LP$s with $q_i>\qmg$ choose the high-fee pool. To understand the rationale, we point out that for an $\LP$ with endowment $\tilde{q}<\qmg$, submitting liquidity to pool $L$ yields a lower expected revenue since
\begin{equation*}
    \pi^\LP_L-\pi^\LP_H=\tilde{q} \frac{\left(1-\eta\right)\left(\left(1-T_L\right)^2-f T_H \left(2-T_L\right)\right)}{2T_H} - \eta\Gamma < 0.
\end{equation*}
Therefore, it is optimal for the $\LP$ with endowment $\tilde{q}$ to post liquidity on the high-fee pool, which contradicts the conjectured equilibrium.  Importantly, since each $\LP$ is ``small'' relative to the aggregate mass of liquidity providers, individual deviations do not impact aggregate pool sizes $T_L$ and $T_H$.} The conjectured equilibrium pins down the pool sizes $T_L$ and $T_H$ as a function of the endowment for the marginal $\LP$:
\begin{align}\label{eq:liquidity_levels}
    T_L&=\int_{\qmg}^2 \log\left(2\right) q_i \phi\left(q_i\right) \diff i = 2 - \qmg \text{ and }\nonumber \\
    T_H&=\int_1^{\qmg} \log\left(2\right) q_i \phi\left(q_i\right) \diff i = \qmg -1. 
\end{align}
From equations \eqref{eq:cost_comparison} and \eqref{eq:liquidity_levels} it follows that the expected profit difference between the low- and high-fee pools can be written as a linear decreasing function of the marginal $\LP$'s endowment, that is
\begin{equation}\label{eq:pi_diff}
    \pi^\LP_L-\pi^\LP_H = \frac{1}{2}q_i \left(1-\eta\right) \left(1-\left(1-f\right)\qmg\right) - \eta \Gamma.
\end{equation}
We search for fulfilled expectation equilibria \citep[following the definition of][]{KatzShapiro1985}, where the beliefs of $\LP$s at $t=0$ about the size of liquidity pools are consistent with the outcome of their choices. We solve \eqref{eq:pi_diff} on the support for $q_i$ -- the interval $\left[1,2\right]$ to obtain the $\LP$ reaction function
\begin{equation}\label{eq:reaction}
    \tilde{q}\left(\qmg\right)=\begin{cases}
    1, & \text{ for } \qmg \leq \frac{1-\eta - 2\Gamma \eta}{\left(1-f\right)\left(1-\eta\right)}\\
    \frac{2\eta\Gamma}{ \left(1-\eta\right) \left(1-\left(1-f\right)\qmg\right)}, & \text{ for } \qmg \in \left(\frac{1-\eta - 2\Gamma \eta}{\left(1-f\right)\left(1-\eta\right)}, \frac{1-\eta\left(1+\Gamma\right)}{\left(1-f\right)\left(1-\eta\right)}\right] \\
    2, & \text{ for } \qmg > \frac{1-\eta\left(1+\Gamma\right)}{\left(1-f\right)\left(1-\eta\right)}.
    \end{cases}
\end{equation}
In any fulfilled expectation equilibrium, the equilibrium endowment of the marginal $\LP$ is a fixed point of equation \eqref{eq:reaction}. Figure \ref{fig:reaction} plots the $\LP$ reaction function $\tilde{q}\left(\cdot\right)$ to graphically illustrate the different possible equilibria. Let $q^\star_1$ and $q^\star_2$ be the interior roots of the reaction function \eqref{eq:reaction}, that is the solutions of the quadratic form
\begin{equation}
    q-\frac{2\eta\Gamma}{ \left(1-\eta\right) \left(1-\left(1-f\right)q\right)}=0.
\end{equation}
that is, 
\begin{equation}\label{eq:roots}
    q^\star_{\left\{1,2\right\}} = \frac{1}{2\left(1-f\right)} \pm \frac{1}{2\left(1-f\right)}\sqrt{1-\eta\frac{1+8\left(1-f\right)\Gamma}{1-\eta}}.
\end{equation}
In the top left panel, we illustrate a parameter combination for which are three equilibria, at $\qmg\in\left\{q^\star_1, q^\star_2, 2\right\}$. However, $q^\star_2$ is an unstable equilibrium -- a tipping point \citep{Jullien2011} at which small perturbation in beliefs cause the $\LP$s to spiral away from the postulated equilibrium (we refer the reader to the proof of Proposition \ref{prop:equilibria} for a more formal discussion). The top right panel illustrates a parameter combination for which there is a unique and stable interior equilibrium at $\qmg=q^\star_1$. Finally, the bottom panels illustrate scenarios for which $\LP$s only deposit liquidity on a single pool -- we distinguish between a multiple equilibria case (bottom left) where either pool having a 100\% market share is an equilibrium and a unique equilibrium case (bottom right) for which the pool attracting the entire liquidity is unambiguous. 

% Figure environment removed



\begin{prop}\label{prop:equilibria}
\begin{leftbar} \setlength{\parskip}{0ex}
For ease of notation, we define and tabulate below three gas fee thresholds $\bar{\Gamma}_k$, $k\in\left\{1,2,3\right\}$.

\begin{center}
    \begin{tabular}{ccc}
    \toprule
    $\bar{\Gamma}_1$ & $\bar{\Gamma}_2$ & $\bar{\Gamma}_3$ \\
    \cmidrule{1-3}
    $f\frac{1-\eta}{2\eta}$     &  $\frac{\left(2f-1\right)\left(1-\eta\right)}{\eta}$ & $\frac{1-\eta}{8\left(1-f\right)\eta}$\\
    \bottomrule
    \end{tabular}
\end{center}

It follows there are has either one, two, or three stable fulfilled expectation equilibria at $t=0$, corresponding to the following $\LP$ liquidity pool choices:
\begin{enumerate}
    \item[(i)] An interior equilibrium with marginal $\LP$ characterized by endowment $\qmg^\star=q^\star_1$, such that all $\LP$s with endowment $q>q^\star_1$ add liquidity to the low-fee pool and the rest choose the high-fee pool. The equilibrium emerges for $f\in\left[\frac{1}{2},\frac{3}{4}\right)$ and $\Gamma\in\left(\bar{\Gamma}_1, \bar{\Gamma}_3\right]$ and $f>\frac{3}{4}$ and $\Gamma\in\left(\bar{\Gamma}_1, \bar{\Gamma}_2\right]$. Moreover, the interior equilibrium is unique for $f>\frac{2}{3}$ and $\Gamma\in\left(\bar{\Gamma}_1, \bar{\Gamma}_2\right]$.
    \item[(ii)] A corner equilibrium where $\qmg^\star=1$, such that all $\LP$s post liquidity on the low-fee pool. The equilibrium emerges for $\Gamma\leq\bar{\Gamma}_1$ and is further unique if $f>\frac{1}{2}$ and $\Gamma\leq\min\left\{\bar{\Gamma}_1,\bar{\Gamma}_2\right\}$.
    \item[(iii)] A corner equilibrium where $\qmg^\star=2$, such that all $\LP$s post liquidity on the high-fee pool. The equilibrium emerges for $\Gamma>\bar{\Gamma}_2$ and is further unique if $f>\frac{3}{4}$ and $\Gamma>\bar{\Gamma}_2$, $f>\frac{1}{2}$ and $\Gamma>\bar{\Gamma}_3$, or $f\leq\frac{1}{2}$ and $\Gamma>\bar{\Gamma}_1$.
\end{enumerate}

\end{leftbar}
\end{prop}

Proposition \ref{prop:equilibria} establishes existence conditions for each possible equilibrium. In particular, an interior equilibrium for which both the $L$ and $H$ pool attract a positive market share emerges for moderate gas fee $\Gamma$ and a small enough difference between liquidity fees on the two pools (i.e., a large $f$). The interior equilibrium is unique if the liquidity fees are close enough across the two pools. Figure \ref{fig:regions} highlights the parameter region where multiple liquidity pools coexist with positive market share. 

The remaining results in Proposition \ref{prop:equilibria} are intuitive: a small gas fee $\Gamma$ reduces the $\LP$s' costs to manage stale liquidity upon news and stimulates competition on the low-fee pool. In other words, the cost of updating liquidity is lower than the opportunity cost of not capturing uninformed trades. In contrast, a large enough $\Gamma$ incentivizes liquidity providers to deposit tokens on the high-fee pool, since managing liquidity on pool $L$ is too costly. 

% Figure environment removed

\subsection{Implications and empirical predictions}

In this section, we zoom in on the properties of the interior equilibrium, that is, the most interesting case featuring segmented liquidity across multiple pools. From Proposition \ref{prop:equilibria}, the only possible interior equilibrium in the liquidity provision game is for a marginal $\LP$ with endowment $\qmg=q_1^\star$, the smallest root of \eqref{eq:reaction}.

\begin{pred}\label{pred:clienteles}
\emph{If an interior equilibrium exists where liquidity is segmented across multiple pools, the average liquidity deposit in the low-fee pool is larger than for the high-fee pool.}
\end{pred}

Prediction \ref{pred:clienteles} follows from the discussion in Section \ref{sec:liqprov}. Liquidity providers with large token endowments ($q_i>\qmg$) deposit them in the low-fee pool since they have stronger incentives to pay the gas fee and actively manage the liquidity. Conversely, $\LP$s with lower endowments ($q_i\leq\qmg$) gravitate towards the high-fee pool, accepting a lower trade probability in exchange for reducing adverse selection costs without active liquidity management and paying gas fees.

\begin{pred}\label{pred:updates}
\emph{Liquidity providers on the low-fee pool are more likely to actively manage liquidity.}
\end{pred}
In equilibrium, the $\LP$s on the low-fee pool update their liquidity upon news arrival to avoid adverse selection, unlike their counterparts on the high-fee pool.


\begin{pred}\label{pred:comp_stat_Gamma}
\emph{The liquidity share of the low-fee pool $L$ decreases in the gas fee $\Gamma$.}
\end{pred}
\begin{pred}\label{pred:comp_stat_eta}
\emph{The liquidity share of the low-fee pool $L$ decreases in the probability of informed trading $\eta$.}
\end{pred}

Predictions \ref{pred:comp_stat_Gamma} and \ref{pred:comp_stat_eta} state that the low-fee pool becomes less attractive for liquidity providers if the gas fee increases (higher $\Gamma$) -- making active liquidity management less profitable -- or if the probability of informed trading is higher ($\eta$ increases) which leads to \emph{more frequent} liquidity management. Formally, we can show that $q_1^\star$ increases in both $\Gamma$ and $\eta$ -- leading to a lower value of $T_L^\star$:
\begin{align}
    \frac{\partial q_1^\star}{\partial \Gamma}&=\frac{2 \eta }{\sqrt{(1-\eta ) (\eta  (8 \Gamma  (f-1)-1)+1)}}>0 \text{ and } \nonumber \\
    \frac{\partial q_1^\star}{\partial \eta}&=\frac{2 \Gamma }{(1-\eta) \sqrt{(1-\eta ) (\eta  (8 \Gamma  (f-1)-1)+1)}}.
\end{align}

\begin{pred}\label{pred:trade_volume}
\emph{If an interior equilibrium exists, the trading volume share of the low-fee pool is higher than its liquidity share.}
\end{pred}

The intuition is that $\LP$s on the low-fee pool deposit large token quantities and they absorb a disproportionate amount of incoming trades -- it is possible that $\LP$s on the high-fee pool do not trade at all against incoming orders, despite providing positive liquidity in equilibrium. To formally see the result, we first note that there is no informed trade in equilibrium on either pool. The average $\LT$ trade size on the low-fee pool is
\begin{align}
    \mathbb{E}\left[\min\left\{\theta,T_L^\star\right\}\right]&=\mathbb{P}\left(\theta\leq T_L\right) \mathbb{E}\left[\theta\mid \theta<T_L^\star\right] + \left(1-\mathbb{P}\left(\theta\leq T_L\right)\right) T_L^\star \nonumber \\
    &= T_L^\star\frac{T_L^\star}{2} + \left(1-T_L^\star\right) T_L^\star= T_L^\star-\frac{\left(T_L^\star\right)^2}{2}.
\end{align}
The average $\LT$ trade size on the high-fee pool is
\begin{align}
    \mathbb{E}\left[\max\left\{0,\theta-T_L^\star\right\}\right]& + \left(1-\mathbb{P}\left(\theta\leq T_L\right)\right) \left(\mathbb{E}\left[\theta\mid \theta>T_L^\star\right]-T_L^\star\right] \nonumber \\
    &= \left(1-T_L^\star\right) \frac{\left(1-T_L^\star\right)}{2}=\frac{1}{2}-T_L^\star+\frac{\left(T_L^\star\right)^2}{2}.
\end{align}
We note that the trade share of pool $L$ is equal to $2T_L^\star-\left(T_L^\star\right)^2$ which is larger than its liquidity share $T_L^\star$ since $T_L^\star<1$. Figure \ref{fig:liqshares} illustrates this result.




% Figure environment removed


\begin{pred}\label{pred:liq_shares}
\emph{The low-fee pool is larger than the high-fee pool (in terms of aggregate deposits) only if the gas fee is low enough, that is if}
\begin{equation}
    \Gamma < \Gamma^\star \equiv \frac{3 (3 f-1) (1-\eta)}{8 \eta }
\end{equation}
\end{pred}

From equation \eqref{eq:liquidity_levels}, if the marginal $\LP$ has endowment $q_1^\star$, then the equilibrium sizes of the two liquidity pools are, respectively,
\begin{align}
    T_L^\star&=2- \frac{1}{2\left(1-f\right)} \left(1- \sqrt{1-\eta\frac{1+8\left(1-f\right)\Gamma}{1-\eta}}\right) \text{ and } \nonumber \\
    T_H^\star&=\frac{1}{2\left(1-f\right)} \left(1- \sqrt{1-\eta\frac{1+8\left(1-f\right)\Gamma}{1-\eta}}\right)-1.
\end{align}


Prediction \ref{pred:liq_shares} translates to stating that $T_L^\star>T_H^\star$, or equivalently to $q_1^\star\leq \frac{3}{2}$, where the latter inequality is true for any $\Gamma\leq\Gamma^\star$. Therefore, even though the low-fee pool attracts the $\LP$s with large token endowments, it is not necessarily the largest pool if the gas fee exceeds a certain threshold. 




