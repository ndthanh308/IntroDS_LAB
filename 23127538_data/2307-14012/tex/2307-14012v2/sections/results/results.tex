\section{Results}

We investigate the impact of our MH-like correction step on different forms of model composition, aiming to draw samples from a composed distribution using diffusion models trained solely on the individual components' distributions. That is, the model components are fixed, and we sample from the composed distribution, incorporating MCMC steps at each diffusion step. Our code is available at our GitHub repo\footnote{https://github.com/FraunhoferChalmersCentre/mcmc\_corr\_score\_diffusion}.

In the first two experiments, we train the diffusion models ourselves with both energy and score parameterization. The experimental setups for these cases are similar: the score parameterization is defined by a noise prediction model $\epsP(\x_t, t)$. For the energy parameterization, we follow the setup in \cite{du2023reduce} and estimate the energy function as
\begin{equation}
\label{eq:ebm:param}
\energy(\x_t, t) = \twoNorm{x_t - \score(\x_t, t)}^2,
\end{equation}
where $\score$ is a vector-valued output of a neural network with the same dimension as $\x_t$. The score-based $\epsilon_\theta$ has an identical network architecture to $s_\theta$. Both score and energy-parameterized models are trained with the standard diffusion loss \cite{ho2020denoising}, with the score function of the energy-based model obtained through explicit differentiation.

In the third and fourth experiments, we utilize larger pre-trained score-based diffusion models to test our proposed method. However, we do not have energy-based models for comparison in these cases.

We evaluate both unadjusted and MH-corrected versions of LA and HMC. We compare the sampling performance of the score and energy-parameterized models, when available, to the standard reverse process, which serves as the baseline.

For the MH-like correction, we evaluate two types of curves along which the score is integrated: \textit{line} and \textit{curve}. \textit{Line} corresponds to a straight line from $\x^\tau$ to $\xCand$ (see \cref{eq:fake_energy}), while \textit{curve} corresponds to integration along a curve that incorporates the internal points of an MCMC method (in this case, the leapfrog steps of HMC). Furthermore, the number of points used for the trapezoidal ruleâ€™s mesh for the line integral per MCMC step is treated as a hyperparameter. However, since several points are evaluated regardless in the MCMC method, e.g., $\x^\tau$ and $\xCand$ , we let the hyperparameter describe the number of points in addition to those we get for free. These additional points are evenly distributed along the curve.

\input{sections/results/two_d_comp.tex}
\input{sections/results/cifar.tex}
\input{sections/results/imagenet.tex}
\input{sections/results/tapestries.tex}