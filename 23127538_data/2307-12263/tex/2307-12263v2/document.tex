\documentclass[journal]{IEEEtran}

% \documentclass[12pt, draftclsnofoot, onecolumn]{IEEEtran}
\usepackage{indentfirst}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{mathrsfs}
\usepackage{leftidx}
\usepackage{color}
\usepackage{amsmath}
\usepackage{arydshln}
\usepackage{amsthm}
\usepackage{ragged2e}
\usepackage{cite}
\usepackage{enumerate}
\usepackage{longtable}
\usepackage{float}
\usepackage{stfloats}
\usepackage{hyperref }
\usepackage{algpseudocode}
\usepackage{algorithm}
\usepackage[caption=false,font=normalsize,labelfont=sf,textfont=sf]{subfig}
\usepackage{tabularx}

\theoremstyle{plain}
\newtheorem{thm}{Theorem}
\newtheorem{lem}{Lemma}
\newtheorem{prop}{Proposition}
\newtheorem {cor}{Corollary}

\theoremstyle{definition}
\newtheorem{defn}{Definition}
\newtheorem{conj}{Conjecture}
\newtheorem{exmp}{Example}
\newtheorem{rem}{Remark}
\newtheorem{note}{Note}



\usepackage[table,usenames,dvipsnames]{xcolor}
\hyphenation{op-tical net-works semi-conduc-tor IEEE-Xplore}
% updated with editorial comments 8/9/2021
\definecolor{aa}{RGB}{175,238,238}
\definecolor{bb}{RGB}{255,255,255}
% 表格换行使用
\newcommand{\tabincell}[2]{
\begin{tabular}{@{}#1@{}}#2\end{tabular}
}

\usepackage{bm}
\usepackage{makecell}

\usepackage{siunitx}





\begin{document}



\title{Efficient Gaussian Process Classification-based Physical-Layer Authentication with Configurable Fingerprints for 6G-Enabled IoT}
\author{Rui Meng, Fangzhou Zhu, Xiaodong Xu,~\IEEEmembership{Senior Member,~IEEE,} 

Bizhu Wang, Bingxuan Xu, and Ping Zhang,~\IEEEmembership{Fellow,~IEEE}
        % <-this % stops a space
\thanks{
% This work was supported in part by the National Key R\&D Program of China under Grant 2020YFB1806900 and in part by the Fundamental Research Foundation for the Central Universities under Grant 2022RC15. 
Corresponding author: Xiaodong Xu.}

\thanks{Rui Meng, Fangzhou Zhu, Bizhu Wang, and Bingxuan Xu are with the State Key Laboratory of Networking and Switching Technology, Beijing University of Posts and Telecommunications, Beijing 100876, China (e-mail: buptmengrui@bupt.edu.cn; zfz9941@bupt.edu.cn; wangbizhu\_7@bupt.edu.cn; xubingxuan@bupt.edu.cn).}

\thanks{Xiaodong Xu and Ping Zhang are with the State Key Laboratory of Networking and Switching Technology, Beijing University of Posts and Telecommunications, Beijing 100876, China, and also with the Department of Broadband Communication, Peng Cheng Laboratory, Shenzhen 518066, Guangdong, China (e-mail: xuxiaodong@bupt.edu.cn; pzhang@bupt.edu.cn).}

% \thanks{Han Meng is with the Key Laboratory of Universal Wireless Communication, Beijing University of Posts and Telecommunications, Beijing 100876, China (email: menghan@bupt.edu.cn).}
}

\maketitle

\begin{abstract}
The future 6G-enabled IoT will facilitate seamless global connectivity among ubiquitous wireless devices, but this advancement also introduces heightened security risks such as spoofing attacks. Physical-Layer Authentication (PLA) has emerged as a promising, inherently secure, and energy-efficient technique for authenticating IoT terminals. However, applying state-of-the-art PLA schemes directly to 6G-enabled IoT faces two primary challenges: inaccurate channel fingerprints and inefficient utilization of prior fingerprint information. To tackle these challenges, we leverage Intelligent Reflecting Surfaces (IRSs) to enhance fingerprint accuracy. Additionally, we integrate active learning and Gaussian Processes (GPs) to propose an Efficient Gaussian Process Classification (EGPC)-based PLA scheme, aiming for reliable and lightweight authentication. Following Bayes' theorem, we model configurable fingerprints using GPs and employ the Expectation Propagation (EP) method to identify unknown fingerprints. Given the difficulty of obtaining sufficient labeled fingerprint samples to train PLA models, we propose three fingerprint selection algorithms. These algorithms select unlabeled fingerprints whose identities are then queried to upper-layer authentication mechanisms. Among these methods, the optimal algorithm reduces the required number of training fingerprints through importance sampling and eliminates the need for PLA model retraining via joint distribution calculation.
The simulations conducted on synthetic datasets demonstrate that the IRS-assisted PLA framework reduces the authentication error rate by 98.69\% compared to the non-IRS-based approach. Furthermore, our proposed fingerprint selection algorithms achieve the reduction in the authentication error rate of up to 86.93\% compared to baseline active learning algorithms.
\end{abstract}









\begin{IEEEkeywords}
Physical-Layer Authentication (PLA), 6G, IoT, identity security, Intelligent Reflecting Surface (IRS).
\end{IEEEkeywords}

\section{Introduction}
\IEEEPARstart{A}{s an} extended and expanded system network based on the Internet, Internet of Things (IoT) can realize intelligent perception, recognition, and management of things and machine leveraging various devices and technologies, such as sensor equipment, global positioning system, infrared sensor, and laser scanner \cite{wang2021evolution}. 
% Through network slicing, millimeter-wave transmission, and massive multi-input and multi-output (MIMO) architecture, the 5th generation mobile network (5G) has empowered IoT to connect more things, thus presenting more imagination and application space for various industries. However, due to the remarkable surge in smart device adoption and the rapid growth of IoT networks, the capabilities of 5G alone may not be sufficient to meet the increasingly demanding technical requirements. For instance, the need for autonomous, highly dynamic, strongly secure, and fully intelligent services cannot be completely fulfilled by 5G \cite{9509294,zhang20196g}. 
To advance IoT’s ultimate goal of enabling real-time interaction among things, machines, and people, the 6th generation mobile network (6G) promises enhanced services surpassing those of 5G. These improvements include seamless coverage, higher data rates, and intrinsic security enhancements. Achieving this will involve implementing multi-band ultrafast-speed transmission, a highly adaptable integrated network, multi-node multi-domain joint transmission, and intelligent transmission mechanisms. \cite{zeng2024tutorial}.

Nevertheless, the worldwide seamless integration of IoT enabled by 6G necessitates an increased involvement of radio equipment in communication processes. This expansion of the application field, however, also introduces heightened security risks of a more pressing nature \cite{trevlakis2023localization}. Besides, owing to the wireless transmission media’s open broadcast nature, more aggressors may fabricate identification information to pretend to be legitimate users and further modify their privacy information \cite{xia2021multiple}. Hence, the lightweight and efficient identity authentication plays a crucial role in achieving seamless and trustworthy communication \cite{garzon2022decentralized}. Currently, the identity identification of terminals in 5G systems is mainly achieved by the core network, which adopts the authentication mechanisms based on cryptography, such as 5G Authentication and Key Agreement (5G AKA) \cite{3gpp2020security}. Although the above cryptographic techniques at the upper layers have been incorporated into the 5G standard, they may fail to meet the expected performance levels in various emerging applications integrating 6G and IoT due to the constrained security level \cite{xie2022security}, low compatibility between heterogeneous systems \cite{abdulqadder2022sliceblock}, and unbearable computational overhead for IoT terminals with limited resources \cite{fang2023collaborative}.

% \begin{itemize}
%     \item First of all, the security level of the aforementioned identification architectures is constrained due to their reliance on the assumption that adversaries possess finite computational resources \cite{xie2022security}. For example, quantum computing poses a significant threat to security authentication algorithms based on cryptography. With the potential to perform complex calculations at an unprecedented speed, quantum computers have the capability to break traditional cryptographic algorithms that rely on the difficulty of factoring large numbers or solving discrete logarithm problems. This means that widely used encryption methods, such as Rivest, Shamir, and Adleman (RSA) and elliptic curve cryptosystems (ECCs), could be rendered ineffective against attacks by quantum computers \cite{cheng2017securing}.
%     \item Secondly, in the context of 6G, achieving global seamless coverage is a crucial goal. However, due to the differences between devices and systems, existing 5G identity authentication protocols may not run seamlessly on all devices. Therefore, it is urgent to explore and develop new identity authentication protocols and mechanisms that are suitable for heterogeneous networks, can cross different devices and systems, provide consistent identity authentication experiences, and ensure that all devices in the network can perform secure authentication \cite{abdulqadder2022sliceblock}.
%     \item Thirdly, traditional cryptography techniques require the generation, distribution, and refresh of keys, thus greatly increasing the transmission latency, which makes it challenging to perform well in latency-sensitive applications, such as smart hospitals \cite{fang2018learning}. Besides, it is difficult for most IoT terminals with limited resources to bear the computational overhead of storing the upper-layers identification protocols \cite{fang2019machine}.
% \end{itemize}

Consequently, to ensure high-reliable communications in 6G-enabled IoT, more efficient and reliable terminal access authentication approaches are required. Recently, Physical-Layer Authentication (PLA) has emerged as a complement of the above traditional security mechanisms, offering the following strengths.
\begin{itemize}
    \item First of all, unlike the “patch” and “plugin” cryptography techniques at the upper-layers \cite{jin2021introduction}, PLA is designed based on physical-layer features that are exploited from the communication links, devices, and location-related attributes, such as Channel State Information (CSI) \cite{jing2023multi,meng2023multiuser}, Received Signal Strength (RSS) \cite{xia2021multiple,fang2023collaborative}, peak power (PP) \cite{meng2024multiobservation}, and RF fingerprints \cite{oligeri2022past}. 
    These physical quantities are regarded as inherent fingerprints, possessing unique characteristics such as temporal variability, randomness, and spatial independence within radio channels\cite{jin2021introduction,meng2023multiuser}. 
    % More specifically, the endogenous fingerprints of two transmitters situated at a half-wavelength distance can be considered completely independent in terms of time, frequency, and spatial factors \cite{xie2020survey}. 
    That is to say, endogenous fingerprints at the physical-layer can provide particular identifying signatures and natural dynamic protection for legitimate IoT terminals, and extracting these channel characteristics and forging them presents an immensely formidable challenge for adversaries \cite{xie2020survey}.
    \item Besides, PLA is a lightweight method circumventing many upper-layer signaling processes, leading to improved efficiency. During the channel estimation phase, the access point obtains all authorized users' CSI information, which further reduces computational overhead. Consequently, IoT devices with limited computing and storage resources can perform optimally \cite{xie2022security}.
    \item In addition, PLA exhibits high compatibility in heterogeneous coexistence environments. While incompatible devices may struggle to decode each other's upper-layer signaling, they should still be capable of decoding the bit-streams at the physical layer. PLA utilizes the physical-layer characteristics of devices for identification and verification, independent of software and protocols. It ensures a consistent experience through unified authentication standards, customizable to specific needs \cite{nguyen2021security}.
\end{itemize}


In earlier literature, PLA is formulated as statistical hypothesis testing, where estimated fingerprints are identified as legitimate when the differences between them and the reference vector do not exceed the detection threshold \cite{xiao2008using}. However, due to the challenges in accurately modeling the fingerprint distribution of IoT terminals caused by unknown and uncertain dynamic variation in 6G systems, obtaining the theoretically optimal threshold becomes difficult \cite{liu2022online}. Machine Learning (ML)-based PLA approaches have recently garnered more interest, as intelligent algorithms possess powerful feature learning abilities that enhance authentication reliability and robustness \cite{chorti2022context}. Various ML techniques are employed to capture the differences between legal and illegal fingerprints, such as thee Gaussian kernel method \cite{liu2022online}, support vector machine \cite{wang2021channel}, weighted voting \cite{xie2021weighted}, neural networks \cite{chen2021physical,meng2023multiuser}, and reinforcement learning \cite{xiao2016phy}.
Intelligent PLA technologies can be employed in one of six usage scenarios of 6G recommended by International Telecommunication Union (ITU): artificial intelligence and communication \cite{recommendation2023framework}.


Nevertheless, there are two challenges of applying existing ML-based PLA schemes directly to 6G-empowered IoT:
\begin{itemize}
\item 

The first challenge is the inaccurate channel fingerprints within complex wireless environments. These fingerprints serve as crucial identifiers for IoT terminals, requiring high precision to exhibit distinct features essential for authentication. However, in low Signal-to-Noise Ratio (SNR) scenarios influenced by electromagnetic interference, lengthy transmission paths, and multipath effects, inaccurate fingerprint estimation significantly impairs identification performance \cite{nguyen2021security}.
While multi-attribute \cite{fang2018learning,xia2021multiple,zhang2020physical} and multi-observation \cite{senigagliesi2022authentication,xie2021weighted,xiao2017phy,meng2024multiobservation} approaches enhance the distinguishability of legitimate IoT terminals, the fundamental challenge of fingerprint estimation remains unresolved. In fact, these approaches may introduce new issues, such as increased deployment costs and security considerations associated with multi-receiver setups.



% The restricted range of the single fingerprint distribution contributes to the diminished reliability of identification. In contrast, multi-attribute or multi-observation can provide additional recognizability for legal IoT terminals to mitigate the bias of each. Thus, the spoofing attackers will have more challenges in predicting and forging legal fingerprints \cite{xia2021multiple,fang2018learning}. However, when the direct paths between the transmitter and receiver are blocked, the multi-attribute-based approaches can not effectively enhance the authentication performance. Although the multi-observation-based methods can address this issue by alternative direct paths of additional receivers, the deployment cost and security of multi-receivers need to be further considered.
\item 
The second challenge involves the inefficient utilization of prior information of fingerprints. Supervised learning-based PLA schemes depend expert databases of fingerprints to train models effectively. However, obtaining identity labels through upper-layer authentication mechanisms escalates computational costs as the number of training samples increases. Moreover, not all training samples contribute equally to feature learning, extraction, and analysis; some may be redundant or trivial. Although semi-supervised learning approaches like variational autoencoders \cite{meng2023physical}, clustering \cite{xia2021multiple}, and one-class classifiers \cite{senigagliesi2022authentication,wang2021channel} circumvent the need for attacker-specific prior information, they face limitations in detecting attacks due to the absence of labeled attacker fingerprints for guiding model training.

\end{itemize}



In response to these challenges, we utilize Intelligent Reflecting Surfaces (IRSs) to establish an alternative transmission path that offers improved channel quality, thereby enhancing the reliability of channel fingerprints. IRSs represent a pioneering technology in 6G, employing a planar array of cost-effective reflective elements to dynamically manipulate the phase, amplitude, or frequency of incoming signals, thus significantly boosting overall communication performance \cite{chen2022accurate}. IRSs are primarily controlled by base stations (BSs) to extend coverage, especially in high-frequency bands such as millimeter waves. Importantly, these deployments also hold promise for authentication purposes. For example, Gao et al. \cite{gao2024physical} combine IRSs and key-based authentication approaches to improve the key generation rate. Furthermore, we leverage Gaussian processes (GPs) \cite{williams2006gaussian} to model configurable fingerprints introduced by IRSs for the following reasons: GPs possess the flexibility to model complex and nonlinear relationships and offer a probabilistic depiction of model uncertainty. Given that various optimization approaches \cite{zhu2022intelligent} can dynamically adjust the parameters of IRSs for resource allocation and energy efficient maximization, the statistical characteristics of channels vary over time and space. GPs are adept at capturing these variations and handling uncertainties, thereby effectively fitting the fingerprint distribution. For instance, Wang et al. \cite{wang2021channel} utilize GP regression to predict mobile transmitters' CSI fingerprints. Moreover, to efficiently utilize prior fingerprint information for guiding the training of PLA models, we employ active learning \cite{settles2009active} to facilitate interaction between PLA and upper-layer authentication mechanisms. The fingerprint selection algorithm chooses representative unlabeled fingerprints, which are then tagged with identity labels through upper-layer authentication mechanism, thereby guiding the training of the PLA model. This iterative process enables the achievement of robust PLA models with a minimal set of labeled training fingerprints. To provide a concise summary, the primary contributions are outlined as follows:


% To tackle the second challenge, we propose an active learning-based PLA scheme, which requires fewer labeled fingerprint samples. Active learning is a specialized subfield within human-in-the-loop machine learning methods, where humans take on an "omniscient" role and hand-label specific data points \cite{settles2009active}. Both empirical studies and theoretical analyses have demonstrated that active learning, by carefully selecting data for labeling, can attain similar accuracy with fewer labeled instances compared to classic ML algorithms \cite{yang2018active}. For the ML-based PLA approaches, obtaining unlabeled fingerprint samples is less costly than acquiring labeled fingerprint samples. However, not all fingerprint samples are equally valuable for learning the distribution of fingerprints. 
% For example, some samples may be noisy, redundant, or trivial. To address this issue, the active learning-aided PLA scheme is suggested to achieve high accuracy with minimal labeled fingerprint samples, thus reducing the cost of obtaining labeled fingerprints.

% Hence, the active learning-aided PLA scheme can reduce the cost of obtaining labeled fingerprints.


\begin{itemize}
\item We introduce an Efficient Gaussian Process Classification (EGPC)-based PLA scheme for 6G-enabled IoT to realize lightweight and reliable cross-layer identity recognition. IRSs are utilized to obtain configurable fingerprints with enhanced accuracy. Active learning is employed to selectively label these fingerprints, thereby maximizing the utilization efficiency of existing fingerprint data.
\item Configurable fingerprints are modeled using GPs in our proposed Gaussian Process Classification (GPC)-based PLA approach. Additionally, we leverage the Expectation Propagation (EP) method to approximate the posterior prediction of unknown fingerprint identities.
\item We present three fingerprint selection algorithms, including Random Optimization (RO), Average Loss of Uncertainty (ALU), and Soft-ALU (SALU). These algorithms select the most uncertain fingerprint sample from an unlabeled pool for prioritized labeling. The design enhances interaction efficiency between PLA and upper-layer authentication mechanisms.
\item Simulations conducted on synthetic dataset demonstrate the effectiveness of our proposed scheme. Moreover, our algorithms are shown to outperform three baseline active learning algorithms in terms of authentication error rate.
\end{itemize}








% \subsection{Organizations}
% To make the article self-contained, the rest is organized as follows. 
% The proposed authentication architecture assisted by IRS is illustrated in Section \ref{model}. In Section \ref{method} and \ref{method2}, we propose the GPC-based and EGPC-based PLA schemes, respectively. Simulation results and conclusions are respectively shown in Section \ref{simulation} and Section \ref{conclusion}.



% \section{Related Works}
% \label{related}
% \subsection{Traditional Threshold Judgement-based PLA}
% The research method of the statistical hypothesis testing-based PLA under a given threshold is quite mature \cite{chen2021physical}. Xiao \textit{et al.} described and studied a CFR-based PLA technique to discriminate between a legal user and a would-be intruder leveraging the temporal-variation and also verified the authentication performance in a typical in-building environment, where the ray-tracing tool WiSE is used to generate realistic CFR \cite{xiao2008using}. Xiao \textit{et al.} further designed a generalized likelihood ratio test (GLRT)-based spoofing detection method for frequency-selective Rayleigh channels, which considers the channel time variations \cite{5351714}. Li \textit{et al.} \cite{li2022blind} presented a blind PLA architecture based on minimum error (ME) and Neyman-Pearson (NP) hypothesis tests. However, it is difficulty for the threshold judgement-based PLA schemes to obtain the theoretical optimal threshold in 6G systems \cite{liu2022online}.
% \subsection{Machine Learning-based PLA}
% The family of the ML-based PLA can be categorized into the SL-based, UL-based, and Reinforcement Learning (RL)-based PLA as follows.
% \subsubsection{SL-based PLA}
% The SL-based PLA requires prior knowledge of output identification results for the corresponding input fingerprint samples. In our previous work, we proposed a Latent Perturbed Neural Network (LPNN)-based multiuser authentication architecture for IIoT, which can address the over-fitting issues when the training fingerprint samples of Deep Learning (DL) models are insufficient \cite{meng2022multiuser}. Senigagliesi \textit{et al.} \cite{senigagliesi2022authentication} provided an OCNN-based scheme for resource-constrained devices. To meet the fast and low complexity secure-access requirement of edge computing system, Xie \textit{et al.} \cite{xie2021weighted} investigated a PLA method including sample segmentation, grouping, and weighted voting. Liu \textit{et al.} \cite{liu2022online} utilized Gaussian kernel method and representer theorem to formulate the authentication problem as a binary classification problem, thereby achieving online authentication for millimeter wave (mmWave) MIMO systems. Pan \textit{et al.} \cite{pan2019threshold} applied four ML-based PLA algorithms, including Decision Tree (DT), SVM, K-Nearest Neighbor (KNN), and ensemble learning, to industrial wireless cyber-physical systems (CPSs) to realize threshold-free authentication.
% \subsubsection{UL-based PLA}
% Compared with the SL-based PLA approaches, the training of the UL-based PLA models does not require the prior knowledge of input fingerprint samples, thus attracting much attention. In our previous work, we formulated the attack detection problem in IIoT as the channel difference function, which can be fitted through the proposed Hierarchical Variational Autoencoder (HVAE) algorithm \cite{meng2022physical}. Xia \textit{et al.} \cite{xia2021multiple} studied the reconstruction and heuristic algorithm to find a non-parametric clustering-based authentication solution with low complexity. Fang \textit{et al.} \cite{fang2018learning} modeled the PLA as a linear system and suggested an adaptive and intelligent scheme utilizing kernel machine. Wang \textit{et al.} \cite{wang2021channel} established a GPR-based mapping exploiting historical CSI samples and the transmitter’s geographical information to predict the next legitimate CSI for identification.
% \subsubsection{RL-based PLA}
% The RL-based PLA schemes do not require accurate input fingerprint samples and output results as well as precise updating of parameters \cite{fang2019machine}. Xiao \textit{et al.} studied RL techniques to optimize the authentication parameters, such as using Q-learning algorithm to choose the optimal test threshold \cite{xiao2016phy} and utilizing mixed-Q-learning model to choose the authentication policy based on the identification accuracy of the precious prediction identity, the approximated attack rate, and the packet priority \cite{liu2017active}, and employing deep RL methods to select authentication models and parameters \cite{lu2020reinforcement}. In addition, Gao \textit{et al.} \cite{gao2020physical} analyzed the feasibility of intelligent spoofing attacks that can emulate legal fingerprints maximizing long-term cumulative reward by Q-learning.
% \subsection{Multi-Attribute or Multi-Observation-based PLA}
% More recently, multi-attribute and multi-observation are believed to enhance the robustness and reliability of PLA due to the additional identifying signatures.
% \subsubsection{Multi-Attribute-based PLA}
% Xia \textit{et al.} \cite{xia2021multiple} discussed the performance of the PLA solutions based on multiple correlated attributes, including channel gain (CG), carrier frequency offset (CFO), angle of arrival, and RSS for single-input multi-output (SIMO) orthogonal frequency division multiplexing (OFDM) systems and channel phase, peak power, CG, and root mean square delay spread for IIoT. Fang \textit{et al.} \cite{fang2018learning} compared the fingerprint estimation performance of four situations, including RSS \& CFO, CIR \& CFO, RSS \& CIR, and RSS \& CIR \& CFO. Considering that radio frequency fingerprints (RFFs) can better reflect the identity characteristics of mobile transmitters, Zhang \textit{et al.} \cite{zhang2020physical} combined channel fingerprints and RFFs to enhance the recognition accuracy.
% \subsubsection{Multi-Observation-based PLA}
% Senigagliesi \textit{et al.} \cite{senigagliesi2022authentication} applied multiple relay nodes to passively or actively cooperate to determine whether or not to transmit fingerprints to the final recipient. Xie \textit{et al.} \cite{xie2021weighted} focused on the cooperative authentication of multi-receivers to realize the unified decision. Xiao \textit{et al.} \cite{xiao2017phy} proposed the Frank-Wolfe (FW)-based scheme to achieve distributed authentication with multi-landmarks and further suggested a distributed FW-based approach to reduce the computation overhead. Wang \textit{et al.} \cite{wang2021collaborative} proposed a horizontal federated learning (HFL)-based solution to reduce the miss detection rate and false alarm rate.
% \subsubsection{Multi-Observation and Multi-Attribute-based PLA}
% In our previous work, we developed a multi-observation-multi-attribute-based PLA architecture, where both the observations of multi-receivers and multi-physical-layer attributes of each receiver are considered to enhance security \cite{meng2023multi}.

% \subsection{IRS for PLA}
% Chen \textit{et al.} \cite{chen2022accurate} point out that IRS technology is realized by a sub-surface composed of sub-wavelength units. The sub-surface has the adjustable electromagnetic response, such as amplitude-phase, polarization, and frequency, which external signals can control in a real-time and reconfigurable manner during the interaction between light and matter. Besides, the white paper towards 6G \cite{ylianttila20206g} point out that IRS is an important physical layer technology for 6G communication systems, which can reflect beamformed signals towards the legal devices. Rajendran \textit{et al.} \cite{rajendran2020injecting} proposed an RFF injection authentication system leveraging IRS to addresses the issues of reduced user capacity and low reliability of traditional RFFs. 

\section{System Model and Problem Formulation}
\label{model}
\subsection{Network Model}









% Figure environment removed
%  We consider that there is no direct links between transmitters (Alice and Eve) and Bob. Hence, the IRS can enable the wireless connection between them, thus enhancing the channel quality.  

As shown in Fig. \ref{fig1}, a typical security model is considered, which is described as follows.
\begin{itemize}
    \item \textit{Alice (legal IoT terminal):} This paper concentrates on the authentication of uplink channel signals. Alice transmits signals to Bob for identity authentication requests.
    \item \textit{Eve (spoofing attacker):} Eve attempts to impersonate Alice and transmit signals to Bob during different communication time slots. The position of Eve is assumed to be more than half a wavelength away from Alice for strong spatial decorrelation between their fingerprints.
    \item \textit{Bob (BS):} Bob is tasked with identifying the identities of received signals. The ML-based PLA model is trained and deployed at Bob. The training process can benefit from edge computing assistance.
    \item \textit{IRS:} The accuracy and reliability of fingerprints in low SNR environments are inherently limited, thus impacting the performance of PLA methods. In such scenarios, IRSs can facilitate wireless connectivity between Alice and Bob. Through configurable adjustments of IRS settings, Bob can effectively manipulate the channel between Alice, thereby bolstering the spatial discernibility of fingerprints. The integration of IRSs within authentication protocols presents significant potential, particularly within controlled settings such as smart factories \cite{tomasin2022challenge}. Incorporating IRSs within authentication procedures enhances security measures, ensuring robust identity verification and access control \cite{wang2022wireless}. The absence of direct links between transmitters and Bob is assumed for simplicity.
\end{itemize}




\begin{table}[htb] 
\begin{center}   
\caption{The List of Main Parameters} 
\setlength{\tabcolsep}{4pt}


\label{table1} 
\renewcommand{\arraystretch}{1.2} 
\begin{tabular}{|c|c|}  
\hline   \textbf{Notations} & \textbf{Meaning} \\   
\hline $\mathbb{E}$ & Expectation  \\
\hline $\mathbb{V}$ & Variance  \\
\hline   $\propto$ & Proportional to  \\      
\hline   $\sim$ & Distributed according to \\
\hline   $\bm{x}^T$ & The transpose of vector $\bm{x}$  \\
\hline $y$ & The identity label \\
\hline $\sigma(z)$ & The sigmoid function \\
\hline   $\triangleq$ & An equality which acts as a definition  \\  
\hline   $\bm{f}_\ast$ & Gaussian process posterior prediction \\
\hline   $\bm{X}_S$ & The transmitted signal vector \\
\hline   $\bm{Y}_S$ & The received signal vector \\
\hline   $\bm{Q}^{\left(A,I,B\right)}$ & \makecell{The hierarchical channel matrix\\ from Alice to Bob through IRS} \\
\hline   $\bm{\Psi}$ & The matrix of IRS element responses \\
\hline $\hat{\bm{X}}$ & The estimated configurable fingerprints \\
\hline $f(\bm{x})$ or $\bm{f}$ & Gaussian process latent function values \\
\hline ${\bar{\pi}}_\ast$ & The probabilistic prediction of the identity \\
\hline $Z$ & The marginal likelihood \\
\hline $\Phi\left(z\right)$ & The CDF of a standard normal distribution \\
\hline $t_i\left(f_i\middle|{\widetilde{Z}}_i,{\widetilde{\mu}}_i,{\widetilde{\sigma}}_i^2\right)$ & The local likelihood approximation \\
\hline $q\left(\bm{f}\middle| X,\bm{y}\right)$ & \makecell{The distribution posterior used \\ to approximate $p\left(\bm{f}\middle| X,\bm{y}\right)$ }  \\
\hline $K$ & The covariance (or Gram) matrix \\
\hline $\bm{k}_\ast$ & Short for $ K\left(\bm{X},\bm{x}_\ast\right)$ \\
\hline $q_{-i}\left(f_i\right)$ & The cavity distribution \\
\hline
\end{tabular}   
\end{center}   
\end{table}









\subsection{Channel Model}
Let $N_T$ and $N_R$ denote the number of antennas of Alice and Bob, respectively. The received signal vector with $N_R$-size column $\bm{Y}_S$ at Bob can be represented as
\begin{equation}
\label{signal}
\bm{Y}_S=\bm{Q}^{\left(A,I,B\right)}\bm{X}_S+\bm{W},
\end{equation}
where $\bm{X}_S$ is the signal vector with $N_T$-size column transmitted from Alice and $\bm{W} \sim \mathcal{CN}(0,\bm{\sigma}^2)$ is the Gaussian noise vector with $N_R$-size column. Denoting the number of elements of IRS by $N$, $\bm{Q}^{\left(A,I,B\right)}=\bm{H}\bm{\Psi}\bm{G}$ is the hierarchical channel matrix from Alice to Bob through IRS, where $\bm{H}$ and $\bm{G}$ represent the channel matrix with $N_R\times N$ from IRS to Bob and the channel matrix with $N\times N_T$ from Alice to IRS, respectively. $\bm{\Psi}=diag\left(\psi_0,\ldots,\psi_{N-1}\right)$ is the matrix of IRS element responses. $\varphi_n$ is represented as $\psi_n=A_n\left(\theta_n\right)e^{j\theta_n}$, where $A_n\left(\theta_n\right)$ and $e^{j\theta_n}$ denote the controllable magnitude and phase response of the $n$th IRS element, respectively. 
% According to \cite{rech2021maximum}, we can obtain
% \begin{equation}
% A_n\left(\theta_n\right)=\left(1-A_{min}\right)\left(\frac{\sin{\left(\theta_n-\Omega\right)+1}}{2}\right)^v+A_{min}
% \end{equation}
% where $A_{min}$ is the minimum amplitude, $\Omega$ is the horizontal distance, and $v$ affects the steepness of the function curve.
The configurable fingerprints $\hat{\bm{X}}$ are obtained through
\begin{equation}
\hat{\bm{X}}=f_{ce}(\bm{Y}_S),
\end{equation}
where $f_{ce}$ denotes the channel estimation function. The channel estimation is not the focus of this paper and can be achieved by various methods, including classical channel estimation, compressed sensing, matrix factorization, and deep learning approaches \cite{zheng2022survey}.
% In this paper, artificial noises are considered to model real-world wireless environments.


% The configurable fingerprints are obtained through cascade channel estimation that is based on a pre-known pilot signal transmitted from Alice, and this process can be mathematically represented as
% \begin{equation}
% \hat{\bm{X}}=\bm{Y}_S\bm{X}_p^{-1}
% \end{equation}
% where $\bm{X}_p$ is the $N_T\times N_T$ matrix of the $N_T$ pilot vectors and $\bm{Y}_S$ is the $N_R\times N_T$ matrix. As the vital identifying signatures of IoT devices, the configurable fingerprints $\hat{\bm{X}}$ can provide significantly distinguishable features for Alice and Eve.

\subsection{Problem Formulation}
\label{problem}
We pre-process $\hat{\bm{X}}$ and then obtain the $2N_RN_T$-dimensional real vector $\bm{x}$.  
Denote the configurable fingerprint space and the identity label set by $\mathcal{X}$ and $\mathcal{Y}$, respectively. Our objective is to train an authentication system $\psi:\ \mathcal{X}\rightarrow\mathcal{Y}$ to predict the identities of unknown fingerprints $\psi(\bm{x}_\ast)$ ($\bm{x}_\ast\in\mathcal{X}$), which will be discussed in Sec. \ref{method}.

Given that IRSs introduce a more intricate signal processing framework, and that the identity labeling of fingerprints requires involvement in the upper authentication protocol, it becomes crucial to devise an efficient fingerprint labeling strategy. This strategy is formulated as
\begin{equation}
f_{fl}=(\mathcal{U},\mathcal{L}),
\end{equation}
where $\mathcal{U}$ and $\mathcal{L}$ represent unlabeled and labeled fingerprints, respectively, and $f_{fl}$ is the fingerprint labeling function. $f_{fl}$ outputs the selected unlabeled fingerprints $x^\ast\in\mathcal{U}$ for identity labeling. Through iterative selection and labeling, the reliability of the PLA model is progressively enhanced. The fingerprint labeling strategy will be discussed in Sec. \ref{method2}. The main parameters are illustrated in Tab. \ref{table1}.

% \begin{prop}
% \label{prop1}
% For simplicity, we pre-process $\hat{\bm{X}}$ and then obtain the $2N_RN_T$-dimensional real vector $\bm{x}$. Thus, the identity recognition problem can is formulated as a classification function $c(\bm{x})$ that assigns the configurable fingerprints $\bm{x}$ to one of two classes, $y=0$ and $y=1$, corresponding to Alice and Eve, respectively. Specifically, the optimization of the expected loss can be approximated as

% \begin{equation}
% R_{\mathcal{L}}(c)=\int \mathcal{L}(y, c(\bm{x})) p(y, \bm{x}) d y d \bm{x}.
% \end{equation}
% Considering that the joint probability $p\left(y,\bm{x}\right)$ is unknown, $p(y,\bm{x})$ is decomposed as $p(\bm{x})p(y | \bm{x})$ according to Bayes’ theorem, which will be discussed in Section \ref{method}.
% \end{prop}







\section{Posterior Prediction of Unknown Configurable Fingerprints}
\label{method}

GP is a robust non-parametric method capable of dynamically adapting to complex and varying channel conditions, effectively capturing and modeling their intricacies. Moreover, GP can adeptly handle the uncertainty inherent in channel characteristics across time, space, and frequency domains through its Bayesian framework, making it ideal for fitting configurable fingerprints' distributions. Hence, this section introduces a GPC-based PLA model to derive posterior predictions of fingerprints.


% In this section, upon the proposed authentication structure in Section \ref{model}, we model the configurable fingerprints as a Gaussian process and propose a GPC-based PLA scheme.


% \subsection{Configurable Fingerprints as GPs}
% Given training fingerprint set $X$, we wish to make predictions for unknown fingerprints $\bm{x}_*$ that are not seen in the training fingerprint set $X$. Thus, we aim to move from the finite training fingerprint set $X$ to a function $\psi$ that can make predictions for all possible fingerprint samples. 

% % However, to achieve this, we need to make certain assumptions about the characteristics of the underlying function. Without these assumptions, any function consistent with the training fingerprint set $X$ would be equally valid. 

% % There are two common approaches to address the SL-based problem. The first approach involves restricting the class of functions considered, such as limiting it to linear functions of the input fingerprints. The second approach, loosely speaking, assigns a prior probability to every conceivable function. Higher probabilities are assigned to functions that we deem more likely, for example, because they exhibit smoother behavior compared to other functions \cite{mitchell1997machine}.

% % However, the first approach encounters an inherent challenge. We must determine the richness or complexity of the function class under consideration. If we choose a model based on a specific class of functions, like linear functions, and the target function is poorly captured within this class, the resulting predictions will likely be subpar. One might be tempted to increase the flexibility of the function class to improve modeling, but this raises the risk of overfitting. Overfitting occurs when a model fits the training fingerprints well but performs poorly when making predictions on new fingerprints \cite{williams2006gaussian}.

% The second approach indeed presents a significant challenge: how can we possibly compute with an uncountable infinite set of possible functions in finite time? This is where GPs come to our aid. 


\subsection{GPs for Configurable Fingerprints}
% The Gaussian Process (GP) serves as a generalization of the Gaussian probability distribution. While a probability distribution characterizes random variables that are vectors, a stochastic process governs the properties of functions \cite{williams2006gaussian}. 

As discussed in Sec. \ref{problem}, the identity recognition problem is formulated as a classification function $\psi$ that assigns the configurable fingerprints $\bm{x}$ to one of two classes, $y=0$ and $y=1$, corresponding to Alice and Eve, respectively.
We use a GPC framework to connect the configurable fingerprints and the identity labels via a latent function $f$ following a GP prior $f \sim GP(\mu\left(\cdot\right),k(\cdot,\cdot))$, where $\mu\left(\cdot\right)$ and $k(\cdot,\cdot)$ are the mean function and covariance kernel function, respectively.

By “squashing” the GP prior function $f(\bm{x})$, we can obtain a prior on $\pi(\bm{x}) p (y=+1 \mid \bm{x})=\sigma(f(\bm{x}))$ through the logistic function. 
% We are not interested in the values of $f(\bm{x})$, but rather in $\pi\left(\bm{x}\right)$. 
% $f(\bm{x})$ can help formulate the model conveniently.
To remove (integrate out) $f(\bm{x})$, the distribution of the latent variable of an unknown configurable fingerprint is computed as
\begin{equation}
\label{6}
p\left(f_\ast\middle| X,\bm{y},\bm{x}_\ast\right)=\int{p\left(f_\ast\middle| X,\bm{x}_\ast,\bm{f}\right)p\left(\bm{f}\middle| X,\bm{y}\right)d\bm{f}},
\end{equation}
where  $p\left(\bm{f}\middle| X,\bm{y}\right)=p\left(\bm{y}\middle|\bm{f}\right)p\left(\bm{f}\middle| X\right)/p(\bm{y}|X)$ denotes the posterior over the hidden variables. Then, we can use $p\left(f_\ast\middle| X,\bm{y},\bm{x}_\ast\right)$ to obtain the probabilistic prediction of the identity as
\begin{equation}
\label{7}
{\bar{\pi}}_\ast \triangleq p\left(y_\ast=+1\middle| X,\bm{y},\bm{x}_\ast\right)=\int{\sigma\left(f_\ast\right)p\left(f_\ast\middle| X,\bm{y},\bm{x}_\ast\right)df_\ast}.
\end{equation}
The integral in (\ref{6}) and (\ref{7}) are analytically intractable because of the non-Gaussian likelihood. EP method \cite{williams2006gaussian} is further employed to approximate the non-Gaussian joint posterior.

\subsection{Expectation Propagation-based Posterior Prediction}
According to Bayes’ rule, the posterior $p\left(\bm{f}\middle| X,\bm{y}\right)$ is denoted as
\begin{equation}
\label{8}
p\left(\bm{f}\middle| X,\bm{y}\right)=\frac{1}{Z}p\left(\bm{f}\middle| X\right)\prod_{i=1}^{n}{p\left(y_i\middle| f_i\right)},
\end{equation}
where $p\left(\bm{f}\middle| X\right)$ denotes the Gaussian prior, $\prod_{i=1}^{n}{p\left(y_i\middle| f_i\right)}$ represents the likelihood, and $n$ is the number of the training fingerprint samples. We can obtain marginal likelihood as
\begin{equation}
\label{9}
Z=p\left(\bm{y}\middle| X\right)=\int{p\left(\bm{f}\middle| X\right)\prod_{i=1}^{n}{p\left(y_i\middle| f_i\right)}d\bm{f}}.
\end{equation}
To make $p\left(\bm{f}\middle| X,\bm{y}\right)$ analytically intractable, we utilize the probit likelihood as
\begin{equation}
p\left(y_i\middle| f_i\right)=\Phi\left(f_iy_i\right),
\end{equation}
where $\Phi\left(z\right)=\int_{-\infty}^{z}{\mathcal{N}(x|0,1)dx}$ is the cumulative density function (CDF) of the standard Gaussian distribution. The likelihood $\Phi\left(f_iy_i\right)$ is approximated through the local likelihood approximation as
\begin{equation}
\label{11}
p\left(y_i\middle| f_i\right) \simeq t_i\left(f_i\middle|{\widetilde{Z}}_i,{\widetilde{\mu}}_i,{\widetilde{\sigma}}_i^2\right)={\widetilde{Z}}_i\mathcal{N}\left(f_i\middle|{\widetilde{\mu}}_i,{\widetilde{\sigma}}_i^2\right),
\end{equation}
where ${\widetilde{Z}}_i$, $ {\widetilde{\mu}}_i$, and $ {\widetilde{\sigma}}_i^2$ are site parameters, and the local likelihoods $t_i$ satisfy
\begin{equation}
\prod_{i=1}^{n}{t_i\left(f_i\middle|{\widetilde{Z}}_i,{\widetilde{\mu}}_i,{\widetilde{\sigma}}_i^2\right)}=\mathcal{N}\left(\widetilde{\bm{\mu}},\widetilde{\Sigma}\right)\prod_{i}{\widetilde{Z}}_i,
\end{equation}
where $\widetilde{\bm{\mu}}$ denotes the vector of ${\widetilde{\mu}}_i$ and $\widetilde{\Sigma}$ is diagonal with ${\widetilde{\Sigma}}_{ii}={\widetilde{\sigma}}_i^2$. 

We can approximate the posterior of  $p\left(\bm{f}\middle| X,\bm{y}\right)$ as
\begin{equation}
\label{13}
q\left(\bm{f}\middle| X,\bm{y}\right)\triangleq \frac{1}{Z_{EP}}p\left(\bm{f}\middle| X\right)\prod_{i=1}^{n}{t_i\left(f_i\middle|{\widetilde{Z}}_i,{\widetilde{\mu}}_i,{\widetilde{\sigma}}_i^2\right)}=\mathcal{N}\left(\bm{\mu},\Sigma\right),
\end{equation}
where $\bm{\mu}=\Sigma{\widetilde{\Sigma}}^{-1}\widetilde{\bm{\mu}}$ and $\Sigma={(K^{-1}+{\widetilde{\Sigma}}^{-1})}^{-1}$. $K$ is a $n\times n$ covariance matrix. $Z_{EP}=q(\bm{y}|X)$ denotes the approximation to $Z$ from (\ref{8}) and (\ref{9}). 



\begin{rem}
To choose the parameters of $t_i$, one feasible approach is to minimize the reversed Kullback-Leibler (KL) divergence $KL(q\left(\bm{f}\middle| X,\bm{y}\right)||p\left(\bm{f}\middle| X,\bm{y}\right))$ with respect to $q\left(\bm{f}\middle| X,\bm{y}\right)$, which is also known as the variational inference. In this paper, the EP method is used to update the approximation of $t_i$ sequentially, which are discussed as follows.
\end{rem}

\subsubsection{Marginal Cavity Distribution}
By combining $p\left(\bm{f}\middle| X\right)$ and $\prod_{i=1}^{n}{t_i\left(f_i\middle|{\widetilde{Z}}_i,{\widetilde{\mu}}_i,{\widetilde{\sigma}}_i^2\right)}$, we can obtain the cavity distribution as
\begin{equation}
\label{14}
q_{-i}\left(f_i\right)\propto\int{p\left(\bm{f}\middle| X\right)\prod_{j\neq i}{t_j\left(f_j\middle|{\widetilde{Z}}_j,{\widetilde{\mu}}_j,{\widetilde{\sigma}}_j^2\right)}df_j}.
\end{equation}
We combine $p\left(\bm{f}\middle| X\right)$ and the $(n-1)$ approximate likelihoods in (\ref{14}) through equivalently removing $t_i\left(f_i\middle|{\widetilde{Z}}_i,{\widetilde{\mu}}_i,{\widetilde{\sigma}}_i^2\right)$ from the approximated posterior $\prod_{i=1}^{n}{t_i\left(f_i\middle|{\widetilde{Z}}_i,{\widetilde{\mu}}_i,{\widetilde{\sigma}}_i^2\right)}$ in (\ref{13}).

\begin{prop}
\label{prop2}
We can obtain the marginal distribution for $f_i$ from $q\left(\bm{f}\middle| X,\bm{y}\right)$ as
\begin{equation}
\label{15}
q\left(f_i\middle| X,\bm{y}\right)=\mathcal{N}\left(f_i\middle|\mu_i,\sigma_i^2\right),
\end{equation}
where $\sigma_i^2=\Sigma_{ii}$.
\end{prop} 


\begin{IEEEproof}
    See Appendix \ref{appa}.  
\end{IEEEproof}

\begin{prop}
\label{prop3}
Through dividing (\ref{15}) by $t_i$, we can obtain the cavity distribution as
\begin{equation}
q_{-i}\left(f_i\right)=\mathcal{N}\left(f_i\middle|\mu_{-i},\sigma_{-i}^2\right),
\end{equation}
where $\mu_{-i}=\sigma_{-i}^2(\sigma_i^{-2}\mu_i-{\widetilde{\sigma}}_i^{-2}{\widetilde{\mu}}_i)$ and $\sigma_{-i}^2={(\sigma_i^{-2}-{\widetilde{\sigma}}_i^{-2})}^{-1}$.
\end{prop}
\begin{IEEEproof}
    See Appendix \ref{appb}.  
\end{IEEEproof}


\subsubsection{The Gaussian Approximation to the Non-Gaussian Marginal Distribution}
The product of $q_{-i}\left(f_i\right)$ and $p\left(y_i\middle| f_i\right)$ can be approximated by a non-normalized Gaussian marginal distribution, which is defined as
\begin{equation}
\hat{q}\left(f_i\right)\triangleq{\hat{Z}}_i\mathcal{N}\left({\hat{\mu}}_i,{\hat{\sigma}}_i^2\right)\simeq q_{-i}\left(f_i\right)p\left(y_i\middle| f_i\right).
\end{equation}

\begin{prop}
\label{prop4}
Considering that $\hat{q}\left(f_i\right)$ is un-normalized, to match $q_{-i}\left(f_i\right)p\left(y_i\middle| f_i\right)$, the desired posterior marginal moments should satisfy
\begin{equation}
{\hat{Z}}_i=\Phi\left(z_i\right),
\end{equation}
\begin{equation}
{\hat{\mu}}_i=\mu_{-i}+\frac{y_i\sigma_{-i}^2\mathcal{N}\left(z_i\right)}{\Phi\left(z_i\right)\sqrt{1+\sigma_{-i}^2}},
\end{equation}
and
\begin{equation}
{\hat{\sigma}}_i^2=\sigma_{-i}^2-\frac{\sigma_{-i}^4\mathcal{N}\left(z_i\right)}{\left(1+\sigma_{-i}^2\right)\Phi\left(z_i\right)}\left(z_i+\frac{\mathcal{N}\left(z_i\right)}{\Phi\left(z_i\right)}\right),
\end{equation}
where $z_i=\frac{y_i\mu_{-i}}{\sqrt{1+\sigma_{-i}^2}}$.
\end{prop}
\begin{IEEEproof}
    See Appendix \ref{appc}.  
\end{IEEEproof}
\subsubsection{The Computation of $ t_i$}
\begin{prop}
\label{prop5}
multiplying $\hat{q}\left(f_i\right)={\hat{Z}}_i\mathcal{N}\left({\hat{\mu}}_i,{\hat{\sigma}}_i^2\right)$ by $q_{-i}\left(f_i\right)=\mathcal{N}\left(f_i\middle|\mu_{-i},\sigma_{-i}^2\right)$, the site parameters of $p\left(y_i\middle| f_i\right)\simeq{\widetilde{Z}}_i\mathcal{N}\left(f_i\middle|{\widetilde{\mu}}_i,{\widetilde{\sigma}}_i^2\right)$ in (\ref{11}) are obtained as
\begin{equation}
\label{19-1}
{\widetilde{\mu}}_i={\widetilde{\sigma}}_i^2\left({\widetilde{\sigma}}_i^{-2}{\hat{\mu}}_i-\sigma_{-i}^{-2}\mu_{-i}\right),
\end{equation}
\begin{equation}
\label{19-2}
{\widetilde{\sigma}}_i^2=\left({\hat{\sigma}}_i^{-2}-\sigma_{-i}^{-2}\right)^{-1},
\end{equation}
and
\begin{equation}
\label{19-3}
{\widetilde{Z}}_i={\hat{Z}}_i\sqrt{2\pi}\sqrt{\sigma_{-i}^2+{\widetilde{\sigma}}_i^2}exp\left(\frac{\left(\mu_{-i}-{\widetilde{\mu}}_i\right)^2}{2(\sigma_{-i}^2+{\widetilde{\sigma}}_i^2)}\right).
\end{equation}
\end{prop}

\begin{IEEEproof}
    See Appendix \ref{appd}.  
\end{IEEEproof}

Thus, through iteratively moment matching marginal posteriors, we can approximate $p\left(\bm{f}\middle| X,\bm{y}\right)$ with the Gaussian approximation $q\left(\bm{f}\middle| X,\bm{y}\right)$.


\begin{prop}
\label{prop6}
There exists a closed-form expression for $p\left(y_\ast\middle| X,\bm{y},\bm{x}_\ast\right)$ as
\begin{equation}
\label{20}
\begin{aligned}
& p\left(y_\ast\middle| X,\bm{y},\bm{x}_\ast\right) \\
& = \Phi\left(\frac{\bm{k}_\ast^T\left(K+\widetilde{\Sigma}\right)^{-1}\widetilde{\bm{\mu}}}{\sqrt{1+k\left(\bm{x}_\ast,\bm{x}_\ast\right)-\bm{k}_\ast^T\left(K+\widetilde{\Sigma}\right)^{-1}\bm{k}_\ast}}\right),
\end{aligned}
\end{equation}
where $\bm{k}_\ast=K(X,\bm{x}_\ast)$, $\bm{k}_\ast^T$ denotes the transpose of $\bm{k}_\ast$, and $k\left(\bm{x}_\ast,\bm{x}_\ast\right)$ is covariance functions evaluated at $\bm{x}_\ast$ and $\bm{x}_\ast$.
\end{prop}

\begin{IEEEproof}
    See Appendix \ref{appe}.  
\end{IEEEproof}
Given $p\left(y_\ast\middle| X,\bm{y},\bm{x}_\ast\right)$, the identity of unknown fingerprints $\bm{x}_\ast$ is obtained according to ${\arg \max}_{y_\ast}{p\left(y_\ast\middle| X,\bm{y},\bm{x}_\ast\right)}$ \cite{dalton2013optimal}.


% \section{Proposed Efficient Gaussian Process Classification-based Physical-Layer Authentication}
\section{Proposed EGPC-based PLA Scheme}
\label{method2}

In this section, building upon the proposed GPC-based PLA scheme in Sec. \ref{method}, we present an active learning-based lightweight and efficient PLA approach. Additionally, we introduce three fingerprint selection algorithms designed to facilitate interaction between the PLA and upper-layer authentication mechanisms.

\subsection{Active Learning-based Efficient Fingerprint Labeling}

The state-of-the-art ML-based PLA schemes can be divided into two main categories: supervised learning-based and semi-supervised learning-based schemes. 
In supervised learning-based schemes, all fingerprint samples are labeled. However, acquiring sufficient labeled fingerprints in real-world wireless systems is often impractical due to attackers' concealment. This challenge is exacerbated in IRS systems with dynamic programmable characteristics, where obtaining prior information about attackers becomes even more difficult. 
Conversely, semi-supervised learning schemes involve labeling only a subset of fingerprint samples. Yet, the scarcity of prior information poses difficulties in building a dependable and resilient authentication system. Specifically, similarities and redundancies in feature patterns among labeled fingerprints not only escalate computational labeling costs but also curtail the PLA model's generalization capability. The integration of IRSs further alters the fingerprint distribution, necessitating representative samples to effectively train an accurate authentication model.




To efficiently train a robust PLA model using a limited number of labeled configurable fingerprint samples, the selection of labeled configurable fingerprints is crucial. We employ active learning as a strategy to achieve this aim. As depicted in Fig. \ref{fig2}, active learning\footnote{The paper primarily focuses on pool-based active learning, which is one of the three major scenarios in active learning. The other scenarios include membership query synthesis and stream-based selective sampling.} usually assumes the availability of a small set of labeled data $\mathcal{L}$ and a large pool of unlabeled data $\mathcal{U}$. The learner can pose “queries”, usually in the form of unlabeled samples to be labeled by an “oracle”, such as a human annotator. Queries are selected in a greedy manner based on a utility measure that evaluates all unlabeled samples in the pool. Active learning approaches have been extensively studied across various problems, such as image classification, video classification, information extraction, and text classification, to name only a few.





\begin{rem}
In practice, PLA does not replace upper-layer security mechanisms but rather complements them, thereby enhancing overall security \cite{xie2022security,xie2020survey}.
As detailed in \textbf{Algorithm 1}, inspired by active learning, the proposed EGPC-based PLA scheme involves continuous interaction with the upper-layer authentication protocol to iteratively update labeled fingerprints. Specifically, the fingerprint selection algorithm selects unlabeled fingerprint samples $\bm{x}_\ast$, whose identity labels are provided by upper-layer authentication mechanisms. The authentication model adjusts its parameters dynamically upon receiving new labeled fingerprint samples, continuing the learning process until achieving desired authentication performance. Hence, the lightweight cross-layer identification scheme enhances identity recognition efficiency and improves security. Obviously, the selection of $\bm{x}_\ast$ influences the PLA model's training efficiency. In Sec. \ref{selection} and \ref{selection2}, we will introduce three fingerprint selection algorithms to choose the most uncertain fingerprint sample $\bm{x}_\ast$ from a set of unlabeled fingerprint samples $\mathcal{U}$. 
\end{rem}








% Figure environment removed






\begin{algorithm}[!h]
\caption{Steps of the Proposed EGPC-based PLA Scheme}
\textbf{Input:} $\mathcal{U}$: unlabeled fingerprint samples ${\{\bm{x}^{(u)}\}}_{u=1}^U$; $\mathcal{L}$: initially labeled fingerprint samples ${\{{<\bm{x},y>}^{(l)}\}}_{l=1}^L$

\textbf{Process:}
\begin{algorithmic}[1]
\label{algorithm1}
\For{$t=1,2,\ldots$}
\State Train the authentication system $\theta$ through the GPC-based scheme in Sec. \ref{method};
\State Select $\bm{x}^\ast\in\mathcal{U}$ based on \textbf{Algorithm 2 or 3};
\State Query the upper-layer security mechanisms to obtain the identity of fingerprints $\bm{x}^\ast$, that is, label $y^\ast$;
\State Add $<\bm{x}^\ast,y^\ast>$ to $\mathcal{L}$;
\State Remove $\bm{x}^\ast$ from $\mathcal{U}$
\EndFor

\textbf{Output:} The trained authentication system
\end{algorithmic}
\end{algorithm}



\subsection{Proposed RO-based Fingerprint Selection Algorithm}
\label{selection}
In each iteration, the optimal $\bm{x}_\ast$ is selected through optimizing an acquisition function that is usually related to $\pi\left(\bm{f}|X,\bm{y}\right)$. 
% For simplicity, $X$ and $\bm{y}$ are omitted from the notations as $\pi\left(\bm{f}\right)$ and $p(y|\bm{x})$. 
% The distribution of fingerprint samples over $\mathcal{X}$ is assumed as $\bm{x}_s \sim p(\bm{x}_s)$.
The Optimal Bayesian Classifier (OBC) \cite{dalton2013optimal} is represented by $\psi_{\pi\left(\bm{f}\right)}(\cdot)$. The expected authentication error of the OBC can be denoted as
\begin{equation}
\begin{split}
\mathbb{E}_{\bm{x}_s}\left\{1-p\left(y_s=\psi_{\pi\left(\bm{f}\right)}\left(\bm{x}_s\right)\middle|\bm{x}_s\right)\right\} \\
=\mathbb{E}_{\bm{x}_s}\left\{1-\max_{y_s}{p\left(y_s\middle|\bm{x}_s\right)}\right\}.
\end{split}
\end{equation}

We first randomly sample fingerprint set $\mathcal{X}_\ast\subset\mathcal{X}$ with the size of $M_1$, calculate the acquisition function, and then choose the fingerprint sample as the optimal $\bm{x}_\ast$. 
% To calculate (\ref{24}), we use Monte Carlo sampling with $M_2$ fingerprint samples of $\bm{x}_s \sim p(\bm{x})$. 
Define $U^A\left(\bm{x}_\ast\right)=\mathbb{E}_{\bm{x}_s}{ \{ g^A\left(\bm{x}_s;\bm{x}_\ast\right) \} }$ and $U^S\left(\bm{x}_\ast\right)=\mathbb{E}_{\bm{x}_s}{ \{ g^S\left(\bm{x}_s;\bm{x}_\ast\right) \} }$. We denote either $g^A\left(\bm{x}_s;\bm{x}_\ast\right)$ or $g^S\left(\bm{x}_s;\bm{x}_\ast\right)$ by $g\left(\bm{x}_s;\bm{x}_\ast\right)$ that can be calculated if we know $p\left(y_s\middle|\bm{x}_s\right)$ and $p\left(y_s\middle|\bm{x}_s,\bm{x}_\ast,y_\ast\right)$. Through iteratively retraining the GPC-based authentication model by the EP method, the acquisition function is optimized. The steps of the RO-based fingerprint selection algorithm is shown in \textbf{Algorithm 2}.


\begin{algorithm}[!h]
\caption{Steps of the Proposed RO-based Fingerprint Selection Algorithm}
\textbf{Input:} $p(\bm{x})$; $q(\bm{f}|X,\bm{y})$

\textbf{Process:}
\begin{algorithmic}[1]
\label{algorithm2}
\State Sample $M_1$ fingerprint samples of $\bm{x}_\ast \sim p(\bm{x})$, and sample $M_2$ fingerprint samples of $\bm{x}_s \sim p(\bm{x})$
\For{each $\bm{x}_\ast$}
\State Calculate $p\left(y_\ast\middle|\bm{x}_\ast\right)$ by (\ref{20})
\For{$y_\ast$ in $\{0,1\}$ }
\State Approximate $q\left(\bm{f}\middle|\bm{x}_\ast,y_\ast\right)$ by (\ref{19-1}), (\ref{19-2}), and (\ref{19-3})
\For{each $\bm{x}_s$}
\State Calculate $p\left(y_s\middle|\bm{x}_s\right)$ and $p\left(y_s\middle|\bm{x}_s,\bm{x}_\ast,y_\ast\right)$
\State Calculate $g(\bm{x}_s;\bm{x}_\ast)$
\EndFor
\EndFor
\State $U\left(\bm{x}_\ast\right)=\frac{1}{M_2}\sum_{\bm{x}_s}{g(\bm{x}_s;\bm{x}_\ast)}$ 
\EndFor

\textbf{Output:} $\widetilde{\bm{x}}=\arg \max_{\bm{x}_\ast}{U(\bm{x}_\ast)}$
\end{algorithmic}
\end{algorithm}


\subsection{Proposed ALU-based and SALU-based Fingerprint Selection Algorithms}
\label{selection2}
\begin{rem}
\label{remark3}
There are two issues for \textbf{Algorithm 2} in actual communications as follows. 1) The number of fingerprints  $M_2$ is large to guarantee the highly-reliable approximation of the integral in (\ref{22}). 2) The calculation of $p\left(y_s\middle|\bm{x}_s,\bm{x}_\ast,y_\ast\right)$ relies on retraining the GPC-based PLA model, which has high computational complexity $O(M_1n^3)$. To address these two problems, we propose ALU-based and SALU-based fingerprint selection algorithms, which 1) reduce the required number of fingerprint samples through importance sampling, and 2) avoid the retraining of the GPC-based PLA model through the joint distribution calculation.
\end{rem}

\begin{defn}
Motivated by Mean objective Cost of Uncertainty (MOCU) \cite{yoon2013quantifying}, we define ALU as the expected loss difference between the OBC and the optimal classifier as
\begin{equation}
\label{22}
\begin{aligned}
& \mathcal{A}\left(\pi\left(\bm{f}\right)\right)\triangleq\mathbb{E}_{\bm{x}_s}\{1-\max_{y_s}{p\left(y_s\middle|\bm{x}_s\right)}\} \\
& -\mathbb{E}_{\pi\left(\bm{f}\right)}\left\{\mathbb{E}_{\bm{x}_s}\left[1-\max_{y_s}{p\left(y_s\middle|\bm{x}_s,\bm{f}\right)}\right]\right\}.
\end{aligned}
\end{equation}
\end{defn}
The ALU reduction is taken as the acquisition function as
\begin{equation}
U^A\left(\bm{x}_\ast;\pi\left(\bm{f}\right)\right)=\mathcal{A}\left(\pi\left(\bm{f}\right)\right)-\mathbb{E}_{y_\ast|\bm{x}_s}\left[\mathcal{A}\left(\pi\left(\bm{f}|\bm{x}_\ast,y_\ast\right)\right)\right].
\end{equation}

According to \cite{zhao2021efficient}, we can obtain
\begin{equation}
\label{24}
\begin{aligned}
& U\left(\bm{x}_\ast\right)=\mathbb{E}_{\bm{x}_s}\left\{1-\max_{y_s}{p\left(y_s\middle|\bm{x}_s\right)}\right\} \\
& -\mathbb{E}_{y_\ast|\bm{x}_\ast} \{\mathbb{E}_{\bm{x}_s}[1-\max_{y_s}{p\left(y_s\middle|\bm{x}_s,\bm{x}_\ast,y_\ast\right)}]\} \\
& =\mathbb{E}_{\bm{x}_s}\left\{\mathbb{E}_{y_\ast|\bm{x}_\ast}\left[\max_{y_s}{p\left(y_s\middle|\bm{x}_s,\bm{x},y\right)}\right]-\max_{y_s}{p\left(y_s\middle|\bm{x}_s\right)}\right\},
\end{aligned}
\end{equation}
which is also the expected error reduction of OBC \cite{roy2001toward}.

\begin{defn}
Inspired by Soft-MOCU \cite{zhao2021bayesian}, we further define SALU in (\ref{25}), a smooth concave approximation of ALU.
\begin{equation}
\label{25}
\begin{aligned}
& \mathcal{A}^S\left(\pi\left(\bm{f}\right)\right)\triangleq\mathbb{E}_{\bm{x}_s} { \{1-\frac{1}{k} \mathtt{LogSumExp} (k\cdot p\left(y_s\middle|\bm{x}_s\right)) \} } \\
& -\mathbb{E}_{\pi\left(\bm{f}\right)} \{ \mathbb{E}_{\bm{x}_s}[1-\max_{y_s}{p\left(y_s\middle|\bm{x}_s,\bm{f}\right)}] \}.
\end{aligned}
\end{equation}
\end{defn}

The corresponding acquisition function is denoted as (\ref{softacquisitionfunction}), which has no maximization operators. After defining acquisition functions as (\ref{24}) or (\ref{softacquisitionfunction}), importance sampling and joint distribution calculation are employed as follows.

% Figure environment removed


\subsubsection{Importance Sampling}
$U\left(\bm{x}_\ast\right)=\mathbb{E}_{\bm{x}_s\sim p(\bm{x}_s)}[g(\bm{x}_s;\bm{x}_*)]$ can be reformulated over the distribution $\widetilde{p}(\bm{x}_s;\bm{x}_\ast)$ as
\begin{equation}
\label{27}
U\left(\bm{x}_\ast\right)=\mathbb{E}_{\bm{x}_s \sim \widetilde{p}\left(\bm{x}_s;\bm{x}_\ast\right)}\left[\frac{p\left(\bm{x}_s\right)g\left(\bm{x}_s;\bm{x}_\ast\right)}{\widetilde{p}\left(\bm{x}_s;\bm{x}_\ast\right)}\right]
\end{equation}
Assuming $\widetilde{p}\left(\bm{x}_s;\bm{x}_\ast\right)\propto k(\bm{x}_s;\bm{x}_\ast)p(\bm{x}_s)$, we can obtain $p\left(y_s\middle|\bm{x}_s,\bm{x}_\ast,y_\ast\right)\approx0$ and $g\left(\bm{x}_s;\bm{x}_\ast\right)\approx0$.

Considering that $k(\bm{x}_s;\bm{x}_\ast)\approx0$, that is, $(\bm{x}_s;y_s)$ and $(\bm{x}_\ast;y_\ast)$ are independent, we can obtain $p\left(y_s\middle|\bm{x}_s,\bm{x}_\ast,y_\ast\right)\approx0$ and $g\left(\bm{x}_s;\bm{x}_\ast\right)\approx0$.


\subsubsection{Joint Distribution Calculation}
To address the second issue in \textbf{Remark \ref{remark3}}, $p\left(y_s\middle|\bm{x}_s,\bm{x}_\ast,y_\ast\right)$ is obtained as
\begin{equation}
\label{jointdistributioncalculation}
p\left(y_s\middle|\bm{x}_s,\bm{x}_\ast,y_\ast\right)=\frac{p\left(y_s,y_\ast\middle|\bm{x}_s,\bm{x}_\ast\right)}{p\left(y_\ast\middle|\bm{x}_\ast\right)}.
\end{equation}
The calculation requires $p\left(y_s,y_\ast\middle|\bm{x}_s,\bm{x}_\ast\right)$.


\begin{prop}
\label{prop7}
The joint distribution $p\left(y_s,y_\ast\middle|\bm{x}_s,\bm{x}_\ast\right)$ is expressed as
\begin{equation}
\label{29}
\begin{aligned}
& p\left(y_s=1,y_\ast=1\middle|\bm{x}_s,\bm{x}_\ast\right) \\
& =\int\Phi\left(\frac{{\widetilde{\mu}}_\ast\left(f_s\right)}{\sqrt{{\widetilde{\sigma}}_{\ast\ast}+1}}\right)\Phi\left(f_s\right)\phi\left(f_s\middle|\mu_s,\sigma_{ss}\right)df_s,
\end{aligned}
\end{equation}
where $f_s=f(\bm{x}_s)$, $f_\ast=f(\bm{x}_\ast)$, $\mu_{s^\ast}$ and $\Sigma_{s^\ast}$ represent the marginal mean and covariance matrics of $f_s$ and $f_\ast$, respectively. Denoting $\mu_{s^\ast}=(\begin{matrix}\mu_s\\\mu_\ast\\\end{matrix})$ and $\Sigma_{s^\ast}=(\begin{matrix}\sigma_{ss}&\sigma_{s^\ast}\\\sigma_{s^\ast}&\sigma_{\ast\ast}\\\end{matrix})$, $\phi\left(f_s,f_\ast\middle|\mu_{s^\ast},\Sigma_{s^\ast}\right)=\left(f_s\middle|\mu_s,\sigma_{ss}\right)\left(f_\ast\middle|{\widetilde{\mu}}_\ast(f_s),{\widetilde{\sigma}}_{\ast\ast}\right)$, where ${\widetilde{\mu}}_\ast\left(f_s\right)=\mu_\ast+\frac{(f_s-\mu_s)\sigma_{s^\ast}}{\sigma_{ss}}$ and ${\widetilde{\sigma}}_{\ast\ast}=\sigma_{\ast\ast}-\frac{\sigma_{s^\ast}^2}{\sigma_{ss}}$.
\end{prop}

\begin{IEEEproof}
    See Appendix \ref{appf}.
\end{IEEEproof}

The processes of the proposed (S)ALU-based fingerprint selection algorithms are shown in \textbf{Algorithm 3} in detail. 



\begin{algorithm}[!t]
\caption{Steps of the Proposed ALU-based and SALU-based Fingerprint Selection Algorithms}
\textbf{Input:}  $p(\bm{x})$; $q(\bm{f}|X,\bm{y})$

\textbf{Process:}
\begin{algorithmic}[1]
\label{algorithm3}
\State Sample $M_1$ fingerprint samples of $\bm{x}_\ast \sim p(\bm{x})$
\For{each $\bm{x}_\ast$}
\State Calculate $p\left(y_\ast\middle|\bm{x}_\ast\right)$ by (\ref{20})
\State Sample $M_2$ fingerprint samples of $\bm{x}_s \sim \widetilde{p}(\bm{x}_s;\bm{x}_\ast)$
\For{$y_\ast$ in $\{0,1\}$}
\For{each $\bm{x}_s$}
\State Calculate $p\left(y_s\middle|\bm{x}_s,\bm{x}_\ast,y_\ast\right)$ by (\ref{29})
\State Calculate $p\left(y_s\middle|\bm{x}_s\right)$ by (\ref{20})
\State Calculate $p\left(y_s\middle|\bm{x}_s,\bm{x}_\ast,y_\ast\right)=\frac{p\left(y_s,y_\ast\middle|\bm{x}_s,\bm{x}_\ast\right)}{p\left(y_s\middle|\bm{x}_s\right)}$
\State Calculate $g(\bm{x}_s;\bm{x}_\ast)$
\EndFor
\EndFor
\State $U\left(\bm{x}_\ast\right)=\frac{1}{M_2}\sum_{\bm{x}_s}\frac{p(\bm{x}_s)g(\bm{x}_s;\bm{x}_\ast)}{\widetilde{p}(\bm{x}_s;\bm{x}_\ast)}$
\EndFor

\textbf{Output:} $\widetilde{\bm{x}}=\arg \max_{\bm{x}_\ast}U\left(\bm{x}_\ast\right)$
\end{algorithmic}
\end{algorithm}





\section{Performance Evaluation and Simulation Results}
\label{simulation}
\subsection{Performance Metric}
The authentication performance is measured by the authentication error rate $R_e$, which is represented as
\begin{equation}
    R_e=\frac{1}{N_a}\sum_{n=1}^{N_a}\mathbb{I}\left(\bm{L}_n \neq \bm{Y}_n\right),
\end{equation}
where $N_a$ is the number of testing fingerprints, and $\bm{L}_n$ and $\bm{Y}_n$ respectively represent the true and estimated identities of the $n$th fingerprint. $\mathbb{I}(\cdot)$ takes 1 or 0 if $\cdot$ is true or not, respectively.

\begin{lem}
\label{lem}
$R_e$ is a fine-grained metric that incorporates both miss detection rate $P_{md}$ and false alarm rate $P_{fa}$. $R_e$ can be further denoted as
\begin{equation}
R_e=
\displaystyle\frac
{1}
{1+
{\displaystyle\frac{{TL}/{TA}+1}{{\displaystyle\frac{1}{\displaystyle\frac{1}{P_{md}}-1}+\frac{1}{\displaystyle\frac{1}{P_{fa}}-1}}}}},
\end{equation}
where $TL$ and $TA$ are illustrated in Tab. \ref{table2} \cite{meng2023physical,xia2021multiple}.
\end{lem}
\begin{IEEEproof}
    See Appendix \ref{appg}.
\end{IEEEproof}





\begin{table}[htb] 
\begin{center}   
\caption{Confusion Matrix of Alice and Eve}
\label{table2}
\setlength{\tabcolsep}{4pt}
\begin{tabular}{|c|c|c|}
\hline
\textbf{Actual\textbackslash{}Predicted} & \textbf{Alice} & \textbf{Eve} \\ \hline
\textbf{Alice} & \makecell{ True Legitimate (TL) } & \makecell{False Attack (FA)} \\ \hline
\textbf{Eve} & \makecell{False Legitimate (FL)} & \makecell{True Attack (TA)} \\ \hline
\end{tabular}
\end{center}
\end{table}












\subsection{Simulation Parameters}



% Figure environment removed
Configurable fingerprint samples are generated through MATLAB platform. The positions of Alice, Eve, Bob, and IRS are illustrated in Fig. \ref{fig3}. Alice, Eve, and Bob are equipped with Uniform linear arrays, and the number of arrays of Alice/Eve and Bob are $N_T=2$ and $N_R=4$, respectively. IRS is a uniform rectangular array composed of $N=N_y N_z=8*32$ reflective elements, and the distance between each reflective element is half wavelength. $\bm{H}$ and $\bm{G}$ are modeled as Rician Channels as
\begin{equation}
\bm{H}=\sqrt{\frac{P L_{H}^{LoS} \kappa_{H}}{1+\kappa_{H}}} \overline{\bm{H}}+\sqrt{\frac{P L_{H}^{NLoS}}{1+\kappa_{H}}} \widetilde{\bm{H}}
\end{equation}
\begin{equation}
    \bm{G}=\sqrt{\frac{PL_{G}^{LoS}\kappa_G}{1+\kappa_G}} \overline{\bm{G}}+\sqrt{\frac{PL_{G}^{NLoS}}{1+\kappa_G}} \widetilde{\bm{G}}
\end{equation}
where $\overline{\bm{H}}$ and $\overline{\bm{G}}$ are Line of Sight (LoS) paths, and $\widetilde{\bm{H}}$ and $\widetilde{\bm{G}}$ are Non-LoS (NLoS) paths. According to the 3GPP TR 38.901 \cite{3gpp2022study}, $PL$ denotes the corresponding path loss as
\begin{equation}
    PL_{LoS}=32.4+21\log_{10}(d)+20\log_{10}(f_c)
\end{equation}
and
\begin{equation}
     PL_{NLoS}=32.4+31.9\log_{10}(d)+20\log_{10}(f_c),
\end{equation}
where $d$ is the path's distance (in $\SI{}{m}$), $f_c=\SI{3.5}{GHz}$ is the carrier frequency, and $\kappa_{H}=3$ and $\kappa_{G}=4$ are Rician factors. The bandwidth is $\SI{1}{MHz}$. The LoS paths are modeled according to \cite{hu2021reconfigurable}. The NLoS paths are modeled as Rayleigh fading models, that is, each element of the channel matrix obeys the independent identically distributed variable $\mathcal{CN}(0,\bm{I})$.
Artificial noises $\bm{W} \sim \mathcal{CN}(0,{\sigma}_w^2\bm{I})$ are employed to model noisy wireless environments, where ${\sigma}_w^2=10^{-20}$.

The performance of PLA models is verified through the PyCharm platform. The synthetic fingerprint datasets are split into training and testing datasets. Initially two fingerprint samples are chosen from Alice and Eve for labeling and further used to estimate the GPC hyper-parameters. The learning procedures are repeated for 100 runs. The simulation and hyper parameters are shown in Tab. \ref{simulationparameter} in detail. The computer configurations are Intel Core i5-13600KF, 3.50 GHz basic frequency, and 32 GB of RAM.  



\begin{table}[t]
\caption {Simulation and Hyper Parameters}
\label{simulationparameter}
\begin{center}
\begin{tabular}{|c| c|} 
\hline
\textbf{Parameters}                    & \textbf{Values} \\ \hline
Bandwidth                       & 1 MHz              \\ \hline
Carrier Frequency $f_c$                & 3.5 GHz             \\ \hline
Rice factors $\kappa_{h}$ and $\kappa_{g}$                            & 3 and 4               \\ \hline
Number of IRS elements                 & 8*32            \\ \hline
Number of antennas of Bob $N_R$              & 4               \\ \hline

Number of antennas of each transmitter $N_T$ & 2               \\ \hline



Number of each transmitter's training fingerprints & 800 \\ \hline
Number of each transmitter's testing fingerprints & 200 \\ \hline
Learning rate & 0.001 \\ \hline
Iteration number & 30 \\ \hline
The variance of the RBF kernel & 1 \\ \hline
The length scale of the RBF kernel & 0.4 \\ \hline
\end{tabular}
 \end{center}
\end{table}















\subsection{Baseline Algorithms}
The baseline fingerprint selection algorithms for performance comparison are as follows.
\begin{itemize}
    \item Random Selection (RS): RS algorithm selects fingerprint samples randomly for labeling, with each sample having an equal sampling probability of being selected.
    \item Maximum Entropy Sampling (MES)\cite{sebastiani2000maximum}: MES algorithm chooses fingerprint samples based on Shannon entropy to maximize information gain.
    \item Bayesian Active Learning by Disagreement (BALD) \cite{houlsby2011bayesian}: BALD algorithm selects fingerprint samples that maximize the disagreement among posterior parameters regarding their outcome.
\end{itemize}


\subsection{Simulation Results}



% Figure environment removed


\textbf{Comparisons with baseline algorithms.} Fig. \ref{fig4} compares the proposed fingerprint selection algorithms with three baseline active learning algorithms. As the iteration number increases, the proposed GPC-based PLA model observes more labeled fingerprint samples, gains a deeper understanding of configurable fingerprint distributions, and achieves more accurate predictions, thereby reducing authentication error rates. The analysis of the fingerprint selection algorithms is as follows. The RS algorithm selects fingerprints randomly, potentially choosing samples with similar characteristics repeatedly, limiting the PLA model's ability to learn the fingerprint distribution effectively. The BALD algorithm excels in learning the characteristics of low-dimensional data rather than high-dimensional fingerprints. The MES algorithm tends to prioritize querying points near decision boundaries, but multi-dimensional cascaded fingerprints have multiple boundaries. The proposed ALU algorithm uses expected error reduction as the acquisition function, outperforming the proposed RO algorithm in authentication performance. Compared to the ALU algorithm, the suggested SALU algorithm achieves a lower error rate due to its smoother concave approximation. Additionally, compared with the three baseline algorithms, the SALU algorithm reduces authentication error rates by 65.96\% to 86.93\%. Fig. \ref{fig4} demonstrates the superior sampling efficiency of the proposed fingerprint selection algorithms over baseline active learning methods.





\textbf{Effectiveness of IRSs.} Fig. \ref{fig5} presents the authentication performance in non-IRS and IRS-assisted wireless environments. In non-IRS environments with low SNRs, the channels between Alice/Eve and Bob are modeled as Rayleigh channels, characterized by severe fading. Across all iterations, the authentication error rate of the proposed fingerprint selection algorithms remains consistently around 0.5 in non-IRS scenarios. Due to the severe fading of the Rayleigh channel, there is significant overlap in the channel fingerprint space of Alice and Eve. Despite the gradual increase in labeled fingerprint samples, effectively learning the inherent characteristics of fingerprints remains challenging for the PLA model. In contrast, the channel quality improves with the transmission paths created by IRSs. With increasing iterations, an adequate number of labeled fingerprint samples significantly enhance authentication performance. Therefore, leveraging IRS assistance, the PLA model achieves superior authentication performance. For instance, compared to scenarios without IRS, the authentication error rate of the SALU algorithm with IRS assistance decreases by 98.69\%. Fig. \ref{fig5} shows the effectiveness of IRSs in enhancing authentication performance compared with the conventional non-IRS-based PLA framework under low SNR environments.














% Figure environment removed




\textbf{Performance versus IRS phase parameters.} Fig. \ref{fig6} provides the authentication performance versus different phase parameters of the IRS element $\theta=\theta_1=\theta_2=...=\theta_n$, where $\theta_n$ is the phase parameter of the $n$th IRS element. As the phase increases, the authentication error rate exhibits varying amplitudes. However, drawing definitive conclusions regarding IRS phase parameters and authentication error rates from Fig. \ref{fig6} proves challenging. The optimization of IRS parameters is another important research area. Fig. \ref{fig6} confirms that the selection of IRS phase parameters significantly impacts authentication performance.






% Figure environment removed



\textbf{Performance versus IRS columns numbers.}
Fig. \ref{fig7} compares the authentication performance versus different numbers of columns of IRSs, denoted as $N_z$. As $N_z$ increases, the total number of IRS element, $N=N_yN_z$, also increases. Consequently, the dimensions of $\bm{H}$, $\bm{\Psi}$, and $\bm{G}$ in the cascade channel matrix $\bm{Q}^{(A,I,B)}=\bm{H \Psi G}$ expand. When the dimensions of $\bm{H}$, $\bm{\Psi}$, and $\bm{G}$ are small, the limited variability in fingerprint distribution may not be enough to distinguish transmitters consistently. Conversely, with larger dimensions of $\bm{H}$, $\bm{\Psi}$, and $\bm{G}$, it is more challenging for attackers to predict or imitate each component of fingerprints. Fig. \ref{fig7} verifies a greater number of IRS columns contributes to enhanced authentication performance.

% Figure environment removed





% Imperfect CSI models are denoted as $\bm{H}=\bm{H}_i\odot\bm{H}_e$ and $\bm{G}=\bm{G}_i \odot \bm{G}_e$,
% % \begin{equation}
% % \bm{H}=\bm{H}_i  \odot \bm{H}_e
% % \end{equation}
% % \begin{equation}
% % \bm{G}=\bm{G}_i \odot \bm{G}_e
% % \end{equation}
% where $\bm{H}_i$ and $\bm{G}_i$ are ideal CSI matrices, $\odot$ denotes the hadamard product, and $\bm{H}_e$ and $\bm{G}_e$ are error matrices, which are represented respectively as $ \bm{H}_e \sim \mathcal{CN} (\bm{I},\sigma_H^2\bm{I})$ and $ \bm{G}_e \sim \mathcal{CN} (\bm{I},\sigma_G^2\bm{I})$.
% % \begin{equation}
% %     \bm{H}_e \sim \mathcal{CN} (\bm{I},\sigma_H^2\bm{I})
% % \end{equation}
% % \begin{equation}
% %     \bm{G}_e \sim \mathcal{CN} (\bm{I},\sigma_G^2\bm{I})
% % \end{equation}



\textbf{Performance under different SNRs.}
Although Fig. \ref{fig5} demonstrates the efficacy of IRSs in improving authentication performance, channel fingerprint estimation is susceptible to biases from noises in channels between Alice/Eve and IRSs, or between IRSs and Bob. To analyze authentication performance under varying channel estimation errors, artificial noises of different powers are considered, as depicted in Fig. \ref{fig8}.
For $\text{SNR}\ge12$, the distinction between Alice’s and Eve’s fingerprints is pronounced, enabling accurate transmitter differentiation with all algorithms.
At $\text{SNR}=11$, only the RS algorithm can not accurately identify all fingerprints due to its limited fingerprint selection capability.
As $\text{SNR}\le10$, decreasing SNR causes Alice’s and Eve’s fingerprint spaces to increasingly overlap, posing challenges for the PLA model in transmitter identification. Nevertheless, compared to baseline algorithms, the proposed SALU algorithm reduces authentication error rate by 45.45\% to 70.00\% at $\text{SNR}=5$. Fig. \ref{fig8} verifies the robustness of the proposed algorithms against channel estimation errors.

% Figure environment removed


\textbf{Training complexity.}
Fig. \ref{fig9} uses the computational time as a metric to demonstrate the complexity of fingerprint selection algorithms. Due to the need for retraining the GPC-based authentication model for every $(\bm{x}_*,y_*)$, the proposed RO algorithm exhibits the highest complexity. In contrast, leveraging importance sampling in (\ref{27}) and joint distribution calculation in (\ref{jointdistributioncalculation}), the proposed (S)ALU algorithms can accelerate the training process. Compared to the ALU algorithm, the SALU algorithm requires additional training time to achieve a lower authentication error rate.

% Figure environment removed



\section{Conclusion}
\label{conclusion}
To enhance wireless identity security in 6G-enabled IoT, we propose an EGPC-based PLA scheme that innovates over state-of-the-art approaches in several key aspects. Firstly, we employ IRSs to enhance fingerprint accuracy in low SNR environments. Secondly, GPs are utilized to model configurable fingerprints, and their posterior distributions are derived for further analysis. Thirdly, we integrate active learning to achieve lightweight cross-layer authentication. We also introduce three fingerprint selection algorithms aimed at improving efficiency.
Simulations validate the effectiveness of IRSs and demonstrate the superiority of our proposed algorithms. It is noteworthy that optimizing phase parameters of IRSs remains a topic requiring further exploration, which we intend to investigate using RL methods in future research.



























\input{appendix/Appendix}


\bibliography{ref}
\bibliographystyle{IEEEtran}




\vfill

% \begin{IEEEbiography}[{% Figure removed}]
% {Rui Meng}(S'23-M'24) received his B.S. degree in information engineering and his PH.D. degree in information and communication engineering both from Beijing University of Posts and Telecommunications (BUPT) in 2018 and 2024 separately. He is currently a post-doctoral in the State Key Laboratory of Networking and Switching Technology, BUPT.

% His research interests cover next-generation networks, physical layer authentication, identity security, deep learning, and Internet of Things.
% \end{IEEEbiography}

% \begin{IEEEbiography}[{% Figure removed}]
% {Fangzhou Zhu} received the B.S. degree in information engineering from BUPT, Beijing, China, in 2021, where he is currently pursuing the M.S. degree in information and communication engineering. 

% His research interests cover wireless localization, physical layer authentication, and deep learning.
% \end{IEEEbiography}

% \begin{IEEEbiography}[{\includegraphics [width=1in,height=1.25in,clip,keepaspectratio]{Xiaodong Xu.jpg}}]{Xiaodong Xu}
% (S'06-M'07-SM'18) received his B.S degree in Information and Communication Engineering and Master’s Degree in Communication and Information System both from Shandong University in 2001 and 2004 separately. He received his Ph.D. degrees of Circuit and System in BUPT in 2007. 

% He is currently a professor of BUPT, a research fellow of the Department of Broadband Communication of Peng Cheng Laboratory and a member of IMT-2030 (6G) Experts Panel. He has coauthored nine books/chapters and more than 120 journal and conference papers. He is also the inventor or co-inventor of 51 granted patents. His research interests cover semantic communications, intellicise communication system, moving networks, mobile edge computing and caching.
% \end{IEEEbiography}


% \begin{IEEEbiography}[{% Figure removed}]
% {Liang Jin} received his Bachelor's degree in Communication Engineering from Xiangtan University, Xiangtan, China, in 2020. He is currently pursuing the Ph.D. degree with the School of Information and Communication Engineering, BUPT, Beijing, China.

% His research interests cover reconfigurable intelligent surface, phyiscal layer security, mobile edge computing.
% \end{IEEEbiography}

% \begin{IEEEbiography}[{% Figure removed}]
% {Bizhu Wang} received a B.Eng. Degree in Telecommunications Engineering from BUPT in 2016, and the Ph.D. degrees in Electronic Engineering from Queen Mary University of London in 2020, respectively. In 2021, Bizhu joined BUPT as a lecturer. 

% Her current research interests include next-generation networks, semantic communication, intent-based networking, machine learning, and in-built security and privacy protection.

% \end{IEEEbiography}


% \begin{IEEEbiography}[{% Figure removed}]
% {Bingxuan Xu}(S'23) received the B.S. degree in communication engineering from BUPT, Beijing, China, in 2022, where she is currently pursuing the Ph.D. degree in information and communication engineering. 

% Her research interests cover next-generation networks, semantic communications, and deep learning.
% \end{IEEEbiography}

% \begin{IEEEbiography}[{% Figure removed}]
% {Han Meng} (S'22) received the B.S. degree in BUPT, Beijing, China, in 2018, where she is currently working toward the Ph.D. degree in Information and Communication Engineering in the Key Laboratory of Universal Wireless Communications, Ministry of Education, BUPT. 

% Her major research interests include wireless communications, deep learning, graph neural network, and automatic aircraft recognition.
% \end{IEEEbiography}





% \begin{IEEEbiography}[{\includegraphics [width=1in,height=1.25in,clip,keepaspectratio]{Ping Zhang.jpg}}]
% {Ping Zhang}(M'07-SM'15-F'18) received the Ph.D. degree in circuits and systems from the BUPT, Beijing, China, in 1990. 

% He is currently a Professor with BUPT, the Director of the State Key Laboratory of Networking and Switching Technology, the Director of the Department of Broadband Communication of Peng Cheng Laboratory, a member of IMT-2020 (5G) Experts Panel, and a member of Experts Panel for China’s 6G development. He served as a Chief Scientist of National Basic Research Program (973 Program), an expert in Information Technology Division of National High-Tech R\&D Program (863 Program), and a member of Consultant Committee on International Cooperation of National Natural Science Foundation of China. His research interests mainly focus on wireless communication. Prof. Zhang is an Academician of the Chinese Academy of Engineering.
% \end{IEEEbiography} 



\end{document}

