\documentclass[journal]{IEEEtran}

% \documentclass[12pt, draftclsnofoot, onecolumn]{IEEEtran}
\usepackage{indentfirst}
\usepackage{graphicx}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{amsfonts}
\usepackage{mathrsfs}
\usepackage{leftidx}
\usepackage{color}
\usepackage{amsmath}
\usepackage{arydshln}
\usepackage{amsthm}
\usepackage{ragged2e}
\usepackage{cite}
\usepackage{enumerate}
\usepackage{longtable}
\usepackage{float}
\usepackage{stfloats}
\usepackage{hyperref }
\usepackage{algpseudocode}
\usepackage{algorithm}
\usepackage[caption=false,font=normalsize,labelfont=sf,textfont=sf]{subfig}
\usepackage{tabularx}

\theoremstyle{plain}
\newtheorem{thm}{Theorem}
\newtheorem{lem}{Lemma}
\newtheorem{prop}{Proposition}
\newtheorem {cor}{Corollary}

\theoremstyle{definition}
\newtheorem{defn}{Definition}
\newtheorem{conj}{Conjecture}
\newtheorem{exmp}{Example}

\theoremstyle{remark}
\newtheorem*{rem}{Remark}
\newtheorem*{note}{Note}



\usepackage[table,usenames,dvipsnames]{xcolor}
\hyphenation{op-tical net-works semi-conduc-tor IEEE-Xplore}
% updated with editorial comments 8/9/2021
\definecolor{aa}{RGB}{175,238,238}
\definecolor{bb}{RGB}{255,255,255}
% 表格换行使用
\newcommand{\tabincell}[2]{
\begin{tabular}{@{}#1@{}}#2\end{tabular}
}

\usepackage{bm}
\usepackage{makecell}

\usepackage{siunitx}





\begin{document}



\title{Efficient Gaussian Process Classification-based Physical-Layer Authentication with Configurable Fingerprints for 6G-Enabled IoT}
\author{Rui Meng,~\IEEEmembership{Graduate Student Member,~IEEE,} Fangzhou Zhu, Xiaodong Xu,~\IEEEmembership{Senior Member,~IEEE,} 

Liang Jin, Bizhu Wang, Bingxuan Xu, Han Meng, and Ping Zhang,~\IEEEmembership{Fellow,~IEEE}
        % <-this % stops a space
\thanks{This work was supported in part by the National Key R\&D Program of China under Grant 2020YFB1806900 and in part by the Fundamental Research Foundation for the Central Universities under Grant 2022RC15. \emph{(Corresponding author: Xiaodong Xu)}}

\thanks{Rui Meng, Fangzhou Zhu, Liang Jin, Bizhu Wang, and Bingxuan Xu are with the State Key Laboratory of Networking and Switching Technology, Beijing University of Posts and Telecommunications, Beijing 100876, China (e-mail: buptmengrui@bupt.edu.cn; zfz9941@bupt.edu.cn; jinliang@bupt.edu.cn; wangbizhu\_7@bupt.edu.cn; xubingxuan@bupt.edu.cn).}

\thanks{Xiaodong Xu and Ping Zhang are with the State Key Laboratory of Networking and Switching Technology, Beijing University of Posts and Telecommunications, Beijing 100876, China, and also with the Department of Broadband Communication, Peng Cheng Laboratory, Shenzhen 518066, Guangdong, China (e-mail: xuxiaodong@bupt.edu.cn; pzhang@bupt.edu.cn).}

\thanks{Han Meng is with the Key Laboratory of Universal Wireless Communication, Beijing University of Posts and Telecommunications, Beijing 100876, China (email: menghan@bupt.edu.cn).}}

\maketitle

\begin{abstract}
% The future 6G-enabled Internet of Things (IoT) will support the global seamless connection of ubiquitous wireless devices, which will bring more serious security threats from spoofing attacks.
Physical-Layer Authentication (PLA) has been recently believed as an endogenous-secure and energy-efficient technique to recognize IoT terminals. However, the major challenge of applying the state-of-the-art PLA schemes directly to 6G-enabled IoT is the inaccurate channel fingerprint estimation in low Signal-Noise Ratio (SNR) environments, which will greatly influence the reliability and robustness of PLA. To tackle this issue, we propose a configurable-fingerprint-based PLA architecture through Intelligent Reflecting Surface (IRS) that helps create an alternative wireless transmission path to provide more accurate fingerprints. 
% Upon the suggested architecture, we formulate the authentication problem as a classification function minimizing the expected loss. 
According to Baye’s theorem, we propose a Gaussian Process Classification (GPC)-based PLA scheme, which utilizes the Expectation Propagation (EP) method to obtain the identities of unknown fingerprints. Considering that obtaining sufficient labeled fingerprint samples to train the GPC-based authentication model is challenging for future 6G systems, we further extend the GPC-based PLA to the Efficient-GPC (EGPC)-based PLA through active learning, which requires fewer labeled fingerprints and is more feasible. We also propose three fingerprint selecting algorithms to choose fingerprints, whose identities are queried to the upper-layers authentication mechanisms. For this reason, the proposed EGPC-based scheme is also a lightweight cross-layer authentication method to offer a superior security level. The simulations conducted on synthetic datasets demonstrate that the IRS-assisted scheme reduces the authentication error rate by 98.69\% compared to the non-IRS-based scheme. Additionally, the proposed fingerprint selection algorithms reduce the authentication error rate by 65.96\% to 86.93\% and 45.45\% to 70.00\% under perfect and imperfect channel estimation conditions, respectively, when compared with baseline algorithms.
% The simulations on synthetic datasets verify the superiority of the proposed schemes in authentication performance.
\end{abstract}

\begin{IEEEkeywords}
Physical-Layer Authentication (PLA), 6G, IoT, identity security, Intelligent Reflecting Surface (IRS).
\end{IEEEkeywords}

\section{Introduction}
\subsection{Background}
\IEEEPARstart{A}{s an} extended and expanded system network based on the Internet, Internet of Things (IoT) can realize intelligent perception, recognition, and management of things and machine leveraging various devices and technologies, such as sensor equipment, global positioning system, infrared sensor, and laser scanner \cite{wang2021evolution}. Through network slicing, millimeter-wave transmission, and massive multi-input and multi-output (MIMO) architecture, the 5th generation mobile network (5G) has empowered IoT to connect more things, thus presenting more imagination and application space for various industries. However, due to the remarkable surge in smart device adoption and the rapid growth of IoT networks, the capabilities of 5G alone may not be sufficient to meet the increasingly demanding technical requirements. For instance, the need for autonomous, highly dynamic, strongly secure, and fully intelligent services cannot be completely fulfilled by 5G \cite{9509294,zhang20196g}. To support the ultimate goal of IoT, that is, real-time interaction between things, machines, and people, the 6th generation mobile network (6G) will provide improved services in terms of seamless coverage, data rate, and endogenous security. This will be accomplished through the implementation of multi-band ultrafast-speed transmission, a highly adaptable integrated network, multi-node multi-domain joint transmission, and intelligent transmission mechanisms \cite{dang2020should,yang20196g}.

Nevertheless, the worldwide seamless integration of IoT enabled by 6G necessitates an increased involvement of radio equipment in communication processes. This expansion of the application field, however, also introduces heightened security risks of a more pressing nature \cite{dang2020should}.
% However, the global seamless connection of 6G-enabled IoT implies that more radio equipment will take part in communications, which will extend the application field and bring more serious security risks.
Besides, owing to the wireless transmission media’s open broadcast nature, more aggressors may fabricate identification information to pretend to be legitimate users and further modify their privacy information \cite{xia2021multiple}. Hence, the lightweight and efficient identity authentication plays a crucial role in achieving seamless and trustworthy communication \cite{garzon2022decentralized}.
% aggressors can easily fabricate the media access control (MAC) addresses or other identification information to pretend to be legitimate users and further modify their privacy information, which will cause huge economic losses and even casualties \cite{xia2021multiple} \cite{xie2020survey}.
Currently, the identity identification of terminals in 5G systems is mainly achieved by the core network, which adopts the authentication mechanisms based on cryptography, such as 5G Authentication and Key Agreement (5G AKA) \cite{3gpp2020security}. Although the above cryptographic techniques at the upper layers have been incorporated into the 5G standard and have been commercially available, they will fail to meet the expected performance levels in various emerging applications integrating 6G and IoT due to the following limitations.

\begin{itemize}
    \item First of all, 
    % the security level of the above identification architectures is limited, because they are realized by assuming that opponents have finite computational resources. Unfortunately, with the rapid development of computational resources and cryptanalysis algorithms, this assumption is gradually broken, which makes it more and more viable to cracking keys based on computation theories, such as elliptic curve cryptography \cite{xie2022security}.
    the security level of the aforementioned identification architectures is constrained due to their reliance on the assumption that adversaries possess finite computational resources \cite{xie2022security}. For example, quantum computing poses a significant threat to security authentication algorithms based on cryptography. With the potential to perform complex calculations at an unprecedented speed, quantum computers have the capability to break traditional cryptographic algorithms that rely on the difficulty of factoring large numbers or solving discrete logarithm problems. This means that widely used encryption methods, such as Rivest, Shamir, and Adleman (RSA) and elliptic curve cryptosystems (ECCs), could be rendered ineffective against attacks by quantum computers \cite{cheng2017securing}.
    % \item Secondly, most of conventional cryptography-based algorithms are vulnerable to replay attacks that do not modify upper-layers signaling. Therefore, adversaries can launch various replay attacks to effectively jam some key network nodes in 6G-enabled IoT \cite{xie2022security}.
    \item Secondly, 
    % as 6G is expected to enable space-air-ground-sea integrated networks encompassing diverse terminals, inconsistent encryption methods across various network protocols make it difficult for heterogeneous IoT devices in achieving seamless handovers without any service disruption \cite{abdulqadder2022sliceblock}.
    in the context of 6G, achieving global seamless coverage is a crucial goal. However, due to the differences between devices and systems, existing 5G identity authentication protocols may not run seamlessly on all devices. Therefore, it is urgent to explore and develop new identity authentication protocols and mechanisms that are suitable for heterogeneous networks, can cross different devices and systems, provide consistent identity authentication experiences, and ensure that all devices in the network can perform secure authentication \cite{abdulqadder2022sliceblock}.
    \item Thirdly, traditional cryptography techniques require the generation, distribution, and refresh of keys, thus greatly increasing the transmission latency, which makes it challenging to perform well in latency-sensitive applications, such as smart hospitals \cite{fang2018learning}. Besides, it is difficult for most IoT terminals with limited resources to bear the computational overhead of storing the upper-layers identification protocols \cite{fang2019machine}.
\end{itemize}

Consequently, to ensure high-reliable communication in 6G-enabled IoT, more efficient and reliable terminal access recognition approaches are required.

\subsection{Physical-Layer Authentication (PLA)}
To effectively address the aforementioned limitations of upper-layers security mechanisms, Physical-Layer Authentication (PLA) has recently emerged as a complement of traditional security mechanisms and a promising identity authentication approach for 6G systems, offering the following strengths.
\begin{itemize}
    \item First of all, unlike the “patch” and “plugin” cryptography techniques at the upper-layers \cite{jin2021introduction}, PLA is designed based on physical-layer features that are exploited from the communication links, devices, and location-related attributes \cite{xie2022security,fang2019machine,xie2020survey}, such as Channel State Information (CSI) \cite{meng2022physical,meng2022multiuser}, Received Signal Strength (RSS) \cite{xia2021multiple,fang2018learning}, peak power (PP) \cite{xia2021multiple,meng2023multi}, Channel Impulse Response (CIR) \cite{fang2018learning,fang2019machine}, and Channel Frequency Response (CFR) \cite{senigagliesi2022authentication,liao2019multiuser}. 
    % Such physical-layer quantities are believed as endogenous fingerprints with uniqueness, time-varying, randomness, and spatial irrelevance of radio channels 
    These physical quantities are regarded as inherent fingerprints, possessing unique characteristics such as temporal variability, randomness, and spatial independence within radio channels\cite{jin2021introduction,meng2022multiuser}. More specifically, the endogenous fingerprints of two transmitters situated at a half-wavelength distance can be considered completely independent in terms of time, frequency, and spatial factors \cite{xie2020survey}. That is to say, endogenous fingerprints at the physical-layer can provide particular identifying signatures and natural dynamic protection for legitimate IoT terminals, and extracting these channel characteristics and forging them presents an immensely formidable challenge for adversaries \cite{fang2019machine}. 
    \item Besides, PLA is a lightweight method circumventing many upper-layer signaling processes, leading to improved efficiency. Furthermore, during the channel estimation phase, the access point obtains the CSI of all authorized users, which further reduces computational overhead. Consequently, IoT devices with limited computing and storage resources can perform optimally \cite{xie2022security}.
    \item In addition, 
    % PLA exhibits high compatibility in heterogeneous coexistence environments. While incompatible devices may struggle to decode each other's upper-layer signaling, they should still be capable of decoding the bit-streams at the physical layer \cite{nguyen2021security}.
    PLA utilizes the physical-layer characteristics of devices for identification and verification, independent of software and protocols. It ensures a consistent experience through unified authentication standards, customizable to specific needs. It is suitable for heterogeneous network environments and provides identity authentication for different devices \cite{nguyen2021security}.
\end{itemize}

In earlier literature, PLA is formulated as the statistical hypothesis testing \cite{xiao2008using,li2022blind,xiao2009channel}. To be specific, the estimated fingerprints are identified as legitimate when the differences between them and the reference vector do not exceed the detection threshold. However, owing to the challenges in accurately modeling the fingerprints of IoT terminals caused by unknown and uncertain dynamic variation in 6G systems, it is difficult for the threshold judgement-based PLA schemes to obtain the theoretical optimal threshold \cite{liu2022online}.

More recently, Machine Learning (ML)-based PLA approaches have attracted more interest to improve the reliability and robustness of access authentication \cite{chorti2022context}. Through exploring ML techniques, such as Gaussian kernel method \cite{liu2022online}, Support Vector Machine (SVM) \cite{wang2021channel}, weighted voting \cite{xie2021weighted}, neural networks \cite{chen2021physical,meng2022multiuser,liao2019multiuser}, and Reinforcement Learning (RL) \cite{xiao2016phy}, the data-driven PLA is formulated as a classification problem, thereby realizing threshold-free and improving identification efficiency \cite{pan2019threshold}. 
\subsection{Challenges}
% Nevertheless, there are two challenges of applying the above ML-based PLA schemes directly to 6G-empowered IoT as follows.

The first challenge is the inaccurate channel fingerprint estimation. As important identifying signatures of IoT terminals, endogenous fingerprints should be high-accurate to present significantly distinguishable features for different transmitters. However, some low Signal-Noise Ratio (SNR) environments in 6G systems, such as noises and user movements, will interfere with the precise estimation of channel fingerprints, which will obviously limit the identification performance \cite{nguyen2021security}.
To tackle this challenge, one feasible approach is the multi-attribute \cite{fang2018learning,xia2021multiple,zhang2020physical} and multi-observation \cite{senigagliesi2022authentication}  \cite{xie2021weighted,xiao2017phy} to provide multi-dimensional identity characteristics of transmitters. The restricted range of the single fingerprint distribution contributes to the diminished reliability of identification. In contrast, multi-attribute or multi-observation can provide additional recognizability for legal IoT terminals to mitigate the bias of each. Thus, the spoofing attackers will have more challenges in predicting and forging legal fingerprints \cite{xia2021multiple,fang2018learning}. However, when the direct paths between the transmitter and receiver are blocked, the multi-attribute-based approaches can not effectively enhance the authentication performance. Although the multi-observation-based methods can address this issue by alternative direct paths of additional receivers, the deployment cost and security of multi-receivers need to be further considered.

The second challenge is the dependence on expert databases. Training Supervised Learning (SL)-based PLA models requires the prior information of legitimate terminals and spoofing attackers as guiding. 
% Unfortunately, due to the time-varying nature of radio channels and frequent short signaling interactions of 6G systems, the distribution or training set of attackers is difficult to obtain in uninterrupted authentication \cite{xia2021multiple}.
Unfortunately, given the dynamic nature of wireless environments and the frequent occurrence of short signaling interactions in 6G systems, acquiring attackers' training fingerprints and describing its probability distribution prove to be challenging \cite{xia2021multiple}.
To address this challenge, many researchers have proposed several PLA schemes based on Unsupervised Learning (UL), such as kernel machine \cite{fang2018learning}, variational autoencoder \cite{meng2022physical}, clustering \cite{xia2021multiple}, and one-class classifier (OCC) \cite{senigagliesi2022authentication,wang2021channel}. Such PLA schemes are achieved without requiring the prior information of attackers. In fact, the performance of ML-based PLA models is influenced by the prior information of fingerprint samples, that is, the more prior information of fingerprints, the higher accuracy of ML-based authentication models. Hence, designing an appropriate ML-aided authentication process that more effectively utilizes the limited prior information available to attackers, to achieve highly reliable identity authentication, is an urgent problem that needs to be solved.


\subsection{Our Solutions}
Against this background, to tackle the first challenge, we propose a configurable-fingerprint-based PLA architecture leveraging Intelligent Reflecting Surface (IRS), which can help create an alternative transmission path with better channel quality. Particularly, IRS is a groundbreaking physical-layer technology for 6G that employs a planar array of cost-effective reflective elements to dynamically manipulate the phase, amplitude, or frequency of incoming signals, thereby enhancing the overall communication performance \cite{chen2022accurate}. Currently, extensive exploration is being conducted on integrating IRSs into forthcoming 6G networks. IRSs would be primarily controlled by base stations (BSs) for the purpose of augmenting coverage, particularly in high-frequency ranges like millimeter waves. It is worth noting that these deployments have the potential to be utilized for authentication purposes as well.

To tackle the second challenge, we propose an active learning-based PLA scheme, which requires fewer labeled fingerprint samples. Active learning is a specialized subfield within human-in-the-loop machine learning methods, where humans take on an "omniscient" role and hand-label specific data points \cite{settles2009active}. Both empirical studies and theoretical analyses have demonstrated that active learning, by carefully selecting data for labeling, can attain similar accuracy with fewer labeled instances compared to classic ML algorithms \cite{yang2018active}. For the ML-based PLA approaches, obtaining unlabeled fingerprint samples is less costly than acquiring labeled fingerprint samples. However, not all fingerprint samples are equally valuable for learning the distribution of fingerprints. 
% For example, some samples may be noisy, redundant, or trivial. To address this issue, the active learning-aided PLA scheme is suggested to achieve high accuracy with minimal labeled fingerprint samples, thus reducing the cost of obtaining labeled fingerprints.
Hence, the active learning-aided PLA scheme can reduce the cost of obtaining labeled fingerprints.

\subsection{Contributions}
To provide a concise summary, the primary contributions can be outlined as follows:
\begin{itemize}
    \item We propose a lightweight cross-layer PLA architecture aided by IRS to achieve highly reliable and efficient identity authentication for 6G-enabled IoT. The configurable fingerprints are obtained with the help of IRS, which can create an alternative transmission path, to enhance the reliability of fingerprints when the channel quality between Alice and Bob is poor or even the direct link is blocked.
\item We propose a Gaussian Process Classification (GPC)-based PLA scheme upon the designed IRS-aided PLA architecture. We further use the Expectation Propagation (EP) method to obtain the approximated posterior prediction of the identity of unknown configurable fingerprints.
\item We combine active learning and PLA to propose the Efficient-GPC (EGPC)-based PLA scheme, including a fingerprint select query, interaction with the upper-layer authentication mechanisms, and the GPC-based PLA model, to improve the efficiency of fingerprint labeling. We further propose three fingerprint selecting algorithms, including Random Optimization (RO) algorithm, Average Loss of Uncertainty (ALU) algorithm, and Soft-ALU (SALU) algorithm, to select the most uncertain fingerprint sample from the pool of unlabeled fingerprint samples for labeling.
\item The simulations on synthetic dataset demonstrates the effectiveness of IRS in reducing authentication error rate. Furthermore, the proposed schemes are shown to outperform baseline active learning algorithms in terms of authentication performance, both in cases of perfect and imperfect channel estimation conditions.
\end{itemize}

% \subsection{Organizations}
% To make the article self-contained, the rest is organized as follows. 
% The proposed authentication architecture assisted by IRS is illustrated in Section \ref{model}. In Section \ref{method} and \ref{method2}, we propose the GPC-based and EGPC-based PLA schemes, respectively. Simulation results and conclusions are respectively shown in Section \ref{simulation} and Section \ref{conclusion}.



% \section{Related Works}
% \label{related}
% \subsection{Traditional Threshold Judgement-based PLA}
% The research method of the statistical hypothesis testing-based PLA under a given threshold is quite mature \cite{chen2021physical}. Xiao \textit{et al.} described and studied a CFR-based PLA technique to discriminate between a legal user and a would-be intruder leveraging the temporal-variation and also verified the authentication performance in a typical in-building environment, where the ray-tracing tool WiSE is used to generate realistic CFR \cite{xiao2008using}. Xiao \textit{et al.} further designed a generalized likelihood ratio test (GLRT)-based spoofing detection method for frequency-selective Rayleigh channels, which considers the channel time variations \cite{5351714}. Li \textit{et al.} \cite{li2022blind} presented a blind PLA architecture based on minimum error (ME) and Neyman-Pearson (NP) hypothesis tests. However, it is difficulty for the threshold judgement-based PLA schemes to obtain the theoretical optimal threshold in 6G systems \cite{liu2022online}.
% \subsection{Machine Learning-based PLA}
% The family of the ML-based PLA can be categorized into the SL-based, UL-based, and Reinforcement Learning (RL)-based PLA as follows.
% \subsubsection{SL-based PLA}
% The SL-based PLA requires prior knowledge of output identification results for the corresponding input fingerprint samples. In our previous work, we proposed a Latent Perturbed Neural Network (LPNN)-based multiuser authentication architecture for IIoT, which can address the over-fitting issues when the training fingerprint samples of Deep Learning (DL) models are insufficient \cite{meng2022multiuser}. Senigagliesi \textit{et al.} \cite{senigagliesi2022authentication} provided an OCNN-based scheme for resource-constrained devices. To meet the fast and low complexity secure-access requirement of edge computing system, Xie \textit{et al.} \cite{xie2021weighted} investigated a PLA method including sample segmentation, grouping, and weighted voting. Liu \textit{et al.} \cite{liu2022online} utilized Gaussian kernel method and representer theorem to formulate the authentication problem as a binary classification problem, thereby achieving online authentication for millimeter wave (mmWave) MIMO systems. Pan \textit{et al.} \cite{pan2019threshold} applied four ML-based PLA algorithms, including Decision Tree (DT), SVM, K-Nearest Neighbor (KNN), and ensemble learning, to industrial wireless cyber-physical systems (CPSs) to realize threshold-free authentication.
% \subsubsection{UL-based PLA}
% Compared with the SL-based PLA approaches, the training of the UL-based PLA models does not require the prior knowledge of input fingerprint samples, thus attracting much attention. In our previous work, we formulated the attack detection problem in IIoT as the channel difference function, which can be fitted through the proposed Hierarchical Variational Autoencoder (HVAE) algorithm \cite{meng2022physical}. Xia \textit{et al.} \cite{xia2021multiple} studied the reconstruction and heuristic algorithm to find a non-parametric clustering-based authentication solution with low complexity. Fang \textit{et al.} \cite{fang2018learning} modeled the PLA as a linear system and suggested an adaptive and intelligent scheme utilizing kernel machine. Wang \textit{et al.} \cite{wang2021channel} established a GPR-based mapping exploiting historical CSI samples and the transmitter’s geographical information to predict the next legitimate CSI for identification.
% \subsubsection{RL-based PLA}
% The RL-based PLA schemes do not require accurate input fingerprint samples and output results as well as precise updating of parameters \cite{fang2019machine}. Xiao \textit{et al.} studied RL techniques to optimize the authentication parameters, such as using Q-learning algorithm to choose the optimal test threshold \cite{xiao2016phy} and utilizing mixed-Q-learning model to choose the authentication policy based on the identification accuracy of the precious prediction identity, the approximated attack rate, and the packet priority \cite{liu2017active}, and employing deep RL methods to select authentication models and parameters \cite{lu2020reinforcement}. In addition, Gao \textit{et al.} \cite{gao2020physical} analyzed the feasibility of intelligent spoofing attacks that can emulate legal fingerprints maximizing long-term cumulative reward by Q-learning.
% \subsection{Multi-Attribute or Multi-Observation-based PLA}
% More recently, multi-attribute and multi-observation are believed to enhance the robustness and reliability of PLA due to the additional identifying signatures.
% \subsubsection{Multi-Attribute-based PLA}
% Xia \textit{et al.} \cite{xia2021multiple} discussed the performance of the PLA solutions based on multiple correlated attributes, including channel gain (CG), carrier frequency offset (CFO), angle of arrival, and RSS for single-input multi-output (SIMO) orthogonal frequency division multiplexing (OFDM) systems and channel phase, peak power, CG, and root mean square delay spread for IIoT. Fang \textit{et al.} \cite{fang2018learning} compared the fingerprint estimation performance of four situations, including RSS \& CFO, CIR \& CFO, RSS \& CIR, and RSS \& CIR \& CFO. Considering that radio frequency fingerprints (RFFs) can better reflect the identity characteristics of mobile transmitters, Zhang \textit{et al.} \cite{zhang2020physical} combined channel fingerprints and RFFs to enhance the recognition accuracy.
% \subsubsection{Multi-Observation-based PLA}
% Senigagliesi \textit{et al.} \cite{senigagliesi2022authentication} applied multiple relay nodes to passively or actively cooperate to determine whether or not to transmit fingerprints to the final recipient. Xie \textit{et al.} \cite{xie2021weighted} focused on the cooperative authentication of multi-receivers to realize the unified decision. Xiao \textit{et al.} \cite{xiao2017phy} proposed the Frank-Wolfe (FW)-based scheme to achieve distributed authentication with multi-landmarks and further suggested a distributed FW-based approach to reduce the computation overhead. Wang \textit{et al.} \cite{wang2021collaborative} proposed a horizontal federated learning (HFL)-based solution to reduce the miss detection rate and false alarm rate.
% \subsubsection{Multi-Observation and Multi-Attribute-based PLA}
% In our previous work, we developed a multi-observation-multi-attribute-based PLA architecture, where both the observations of multi-receivers and multi-physical-layer attributes of each receiver are considered to enhance security \cite{meng2023multi}.

% \subsection{IRS for PLA}
% Chen \textit{et al.} \cite{chen2022accurate} point out that IRS technology is realized by a sub-surface composed of sub-wavelength units. The sub-surface has the adjustable electromagnetic response, such as amplitude-phase, polarization, and frequency, which external signals can control in a real-time and reconfigurable manner during the interaction between light and matter. Besides, the white paper towards 6G \cite{ylianttila20206g} point out that IRS is an important physical layer technology for 6G communication systems, which can reflect beamformed signals towards the legal devices. Rajendran \textit{et al.} \cite{rajendran2020injecting} proposed an RFF injection authentication system leveraging IRS to addresses the issues of reduced user capacity and low reliability of traditional RFFs. 

\section{System Model and Problem Formulation}
\label{model}
\subsection{Network Model}









% % Figure environment removed
% the spoofing attacker (Eve) attempts to impersonate the legal IoT terminal (Alice) via transmitting signals to the legitimate receiver (Bob) during different communication time slots. We consider that there is no direct links between transmitters (Alice and Eve) and Bob. Hence, the IRS can enable the wireless connection between them, thus enhancing the channel quality. Bob is responsible to recognize the identity of the received signal. The position of Eve is assumed to be more than half a wavelength away from Alice for strong spatial decorrelation between their fingerprints used for authentication. 

A typical security model is shown in Fig. \ref{fig1}, where Bob denotes the BS that exclusively controls IRS, thereby having control over the channel to the legal IoT terminal (Alice). 
Eve represents an spoofing attacker device within the cell and attempts to impersonate Alice via transmitting signals to Bob. We consider that there is no direct links between transmitters and Bob. Hence, IRS can enable the wireless connection between them, thus enhancing the channel quality. By adjusting the configuration of IRS, Bob can manipulate the channel to Alice as desired. The integration of IRSs into authentication protocols holds immense potential, particularly in controlled environments like smart factories \cite{tomasin2022challenge}. By incorporating IRSs into authentication processes, enhanced security measures can be achieved, ensuring reliable identity verification and access control \cite{wang2022wireless}.
% It is worth noting that IRSs have been explored for achieving confidentiality through Physical-Layer Security (PLS) techniques \cite{wang2022wireless}. 
This innovative use of IRSs in authentication protocols offers promising possibilities for safeguarding critical systems and assets in various industries. 
% In addition, the position of Eve is assumed to be more than half a wavelength away from Alice for strong spatial decorrelation between their fingerprints used for authentication.









% The main parameters are illustrated in \textbf{Table \ref{table1}}.



% \begin{table}[htb] 
% \begin{center}   
% \caption{The List of Main Parameters}  
% \setlength{\tabcolsep}{4pt}


% \label{table1} 
% \begin{tabular}{|c|c|}   
% \hline   \textbf{Notations} & \textbf{Meaning} \\   
% \hline   $\triangleq$ & An equality which acts as a definition  \\ 
% \hline   $\bm{y}^T$ & The transpose of vector $\bm{y}$  \\  
% \hline   $\propto$ & Proportional to  \\      
% \hline   $\sim$ & Distributed according to \\
% \hline   $\bm{f}_\ast$ & Gaussian process posterior prediction \\
% \hline   $\bm{X}_S$ & The transmitted signal vector \\
% \hline   $\bm{Y}_S$ & The received signal vector \\
% \hline   $\bm{Q}^{\left(A,I,B\right)}$ & \makecell{The hierarchical channel matrix\\ from Alice to Bob through IRS} \\
% \hline   $\bm{\Psi}$ & The matrix of IRS element responses \\
% \hline $\hat{\bm{X}}$ & The estimated configurable fingerprints \\
% \hline $\bm{y}$ & The identity label \\
% \hline $\mathbb{E}$ & Expectation  \\
% \hline $\mathbb{V}$ & Variance  \\
% \hline $\sigma(z)$ & The sigmoid function \\
% \hline $f(\bm{x})$ or $\bm{f}$ & Gaussian process latent function values \\
% \hline ${\bar{\pi}}_\ast$ & The probabilistic prediction of the identity \\
% \hline $Z$ & The marginal likelihood \\
% \hline $\Phi\left(z\right)$ & The CDF of a standard normal distribution \\
% \hline $t_i\left(f_i\middle|{\widetilde{Z}}_i,{\widetilde{\mu}}_i,{\widetilde{\sigma}}_i^2\right)$ & The local likelihood approximation \\
% \hline $q\left(\bm{f}\middle| X,\bm{y}\right)$ & \makecell{The distribution posterior used \\ to approximate $p\left(\bm{f}\middle| X,\bm{y}\right)$ }  \\
% \hline $K$ & The covariance (or Gram) matrix \\
% \hline $q_{-i}\left(f_i\right)$ & The cavity distribution \\
% \hline $\bm{k}_\ast$ & Short for$ K\left(\bm{X},\bm{x}_\ast\right)$ \\
% \hline
% \end{tabular}   
% \end{center}   
% \end{table}









\subsection{The Estimation of Configurable Fingerprints}
Let $N_T$ and $N_R$ denote the number of antennas of Alice and Bob, respectively. The received signal vector with $N_R$-size column $\bm{Y}_S$ at Bob can be represented as
\begin{equation}
\label{signal}
\bm{Y}_S=\bm{Q}^{\left(A,I,B\right)}\bm{X}_S+\bm{W}
\end{equation}
where $\bm{X}_S$ is the signal vector with $N_T$-size column transmitted from Alice and $\bm{W} \sim \mathcal{CN}(0,\bm{\sigma}^2)$ is the Gaussian noise vector with $N_R$-size column. Denoting the number of elements of IRS by $N$, $\bm{Q}^{\left(A,I,B\right)}=\bm{H}\bm{\Psi}\bm{G}$ is the hierarchical channel matrix from Alice to Bob through IRS, where $\bm{H}$ and $\bm{G}$ represent the channel matrix with $N_R\times N$ from IRS to Bob and the channel matrix with $N\times N_T$ from Alice to IRS, respectively. $\bm{\Psi}=diag\left(\psi_0,\ldots,\psi_{N-1}\right)$ is the matrix of IRS element responses. Each $\varphi_n$ can be represented as
\begin{equation}
\psi_n=A_n\left(\theta_n\right)e^{j\theta_n}
\end{equation}
where $A_n\left(\theta_n\right)$ and $e^{j\theta_n}$ denote the controllable magnitude and phase response of the $n$th IRS element, respectively. According to \cite{rech2021maximum}, we can obtain
\begin{equation}
A_n\left(\theta_n\right)=\left(1-A_{min}\right)\left(\frac{\sin{\left(\theta_n-\Omega\right)+1}}{2}\right)^v+A_{min}
\end{equation}
where $A_{min}$ is the minimum amplitude, $\Omega$ is the horizontal distance, and $v$ affects the steepness of the function curve.
% For the same IRS, the three parameters of all elements are constant.

\begin{defn}
The configurable fingerprints are obtained through channel estimation that is based on a pre-known pilot signal transmitted from Alice, and this process can be mathematically represented as
\begin{equation}
\hat{\bm{X}}=\bm{Y}_S\bm{X}_p^{-1}
\end{equation}
where $\bm{X}_p$ is the $N_T\times N_T$ matrix of the $N_T$ pilot vectors and $\bm{Y}_S$ is the $N_R\times N_T$ matrix. As the vital identifying signatures of IoT devices, the configurable fingerprints $\hat{\bm{X}}$ can provide significantly distinguishable features for Alice and Eve.
\end{defn}

\subsection{Problem Formulation}
\begin{prop}
\label{prop1}
For simplicity, we pre-process $\hat{\bm{X}}$ and then obtain the $2N_RN_T$-dimensional real vector $\bm{x}$. Thus, the identity recognition problem can is formulated as a classification function $c(\bm{x})$ that assigns the configurable fingerprints $\bm{x}$ to one of two classes, $y=0$ and $y=1$, corresponding to Alice and Eve, respectively. Specifically, the optimization of the expected loss can be approximated as follows:

\begin{equation}
R_{\mathcal{L}}(c)=\int \mathcal{L}(y, c(\boldsymbol{x})) p(y, \boldsymbol{x}) d y d \boldsymbol{x}
\end{equation}
Considering that the joint probability $p\left(y,\bm{x}\right)$ is unknown, one natural approach is to decompose $p(y,\bm{x})$ as $p(\bm{x})p(y | \bm{x})$ according to Bayes’ theorem, which will be discussed in Section \ref{method}.
\end{prop}

% \section{Proposed Gaussian Process Classification-based Physical-Layer Authentication}
\section{Proposed GPC-based PLA Scheme}
\label{method}
% In this section, upon the proposed authentication structure in Section \ref{model}, we model the configurable fingerprints as a Gaussian process and propose a GPC-based PLA scheme.


% \subsection{Configurable Fingerprints as GPs}
% Given training fingerprint set $X$, we wish to make predictions for unknown fingerprints $\bm{x}_*$ that are not seen in the training fingerprint set $X$. Thus, we aim to move from the finite training fingerprint set $X$ to a function $\psi$ that can make predictions for all possible fingerprint samples. 

% % However, to achieve this, we need to make certain assumptions about the characteristics of the underlying function. Without these assumptions, any function consistent with the training fingerprint set $X$ would be equally valid. 

% % There are two common approaches to address the SL-based problem. The first approach involves restricting the class of functions considered, such as limiting it to linear functions of the input fingerprints. The second approach, loosely speaking, assigns a prior probability to every conceivable function. Higher probabilities are assigned to functions that we deem more likely, for example, because they exhibit smoother behavior compared to other functions \cite{mitchell1997machine}.

% % However, the first approach encounters an inherent challenge. We must determine the richness or complexity of the function class under consideration. If we choose a model based on a specific class of functions, like linear functions, and the target function is poorly captured within this class, the resulting predictions will likely be subpar. One might be tempted to increase the flexibility of the function class to improve modeling, but this raises the risk of overfitting. Overfitting occurs when a model fits the training fingerprints well but performs poorly when making predictions on new fingerprints \cite{williams2006gaussian}.

% The second approach indeed presents a significant challenge: how can we possibly compute with an uncountable infinite set of possible functions in finite time? This is where GPs come to our aid. 


\subsection{Gaussian Process (GP) for PLA}
% The Gaussian Process (GP) serves as a generalization of the Gaussian probability distribution. While a probability distribution characterizes random variables that are vectors, a stochastic process governs the properties of functions \cite{williams2006gaussian}. 
Denote the configurable fingerprint space and the identity label set by $\mathcal{X}$ and $\mathcal{Y}={0,1}$, respectively. Our purpose is to train an authentication system $\psi:\ \mathcal{X}\rightarrow\mathcal{Y}$ to estimate the identities of unknown fingerprints $\psi(\bm{x}_\ast)$, $\bm{x}_\ast\in\mathcal{X}$. We use a GPC framework to connect the configurable fingerprints and the identity labels via a latent function $f$ following a GP prior $f \sim GP(\mu\left(\cdot\right),k(\cdot,\cdot))$, where $\mu\left(\cdot\right)$ and $k(\cdot,\cdot)$ are the mean function and covariance kernel function, respectively.

By “squashing” the GP prior function $f(\bm{x})$, we can obtain a prior on $\pi(\boldsymbol{x}) p (y=+1 \mid \boldsymbol{x})=\sigma(f(\boldsymbol{x}))$ through the logistic function. 
% We are not interested in the values of $f(\bm{x})$, but rather in $\pi\left(\bm{x}\right)$. 
$f(\bm{x})$ can help formulate the model conveniently.

To remove (integrate out) $f(\bm{x})$, the distribution of the latent variable of an unknown configurable fingerprint is computed as
\begin{equation}
\label{6}
p\left(f_\ast\middle| X,\bm{y},\bm{x}_\ast\right)=\int{p\left(f_\ast\middle| X,\bm{x}_\ast,\bm{f}\right)p\left(\bm{f}\middle| X,\bm{y}\right)d\bm{f}}
\end{equation}
where  $p\left(\bm{f}\middle| X,\bm{y}\right)=p\left(\bm{y}\middle|\bm{f}\right)p\left(\bm{f}\middle| X\right)/p(\bm{y}|X)$ denotes the posterior over the hidden variables. Then, we can use $p\left(f_\ast\middle| X,\bm{y},\bm{x}_\ast\right)$ to obtain the probabilistic prediction of the identity as
\begin{equation}
\label{7}
{\bar{\pi}}_\ast \triangleq p\left(y_\ast=+1\middle| X,\bm{y},\bm{x}_\ast\right)=\int{\sigma\left(f_\ast\right)p\left(f_\ast\middle| X,\bm{y},\bm{x}_\ast\right)df_\ast}
\end{equation}
The integral in (\ref{6}) and (\ref{7}) are analytically intractable because of the non-Gaussian likelihood. EP method \cite{williams2006gaussian} is utilized to get the approximated non-Gaussian joint posterior.

\subsection{Posterior Prediction of Unknown Fingerprintsn}
According to Bayes’ rule, the posterior $p\left(\bm{f}\middle| X,\bm{y}\right)$ is denoted as
\begin{equation}
\label{8}
p\left(\bm{f}\middle| X,\bm{y}\right)=\frac{1}{Z}p\left(\bm{f}\middle| X\right)\prod_{i=1}^{n}{p\left(y_i\middle| f_i\right)}
\end{equation}
where $p\left(\bm{f}\middle| X\right)$ denotes the Gaussian prior, $\prod_{i=1}^{n}{p\left(y_i\middle| f_i\right)}$ represents the likelihood, and $n$ is the number of the training fingerprint samples. We can obtain marginal likelihood as
\begin{equation}
\label{9}
Z=p\left(\bm{y}\middle| X\right)=\int{p\left(\bm{f}\middle| X\right)\prod_{i=1}^{n}{p\left(y_i\middle| f_i\right)}d\bm{f}}
\end{equation}
To make $p\left(\bm{f}\middle| X,\bm{y}\right)$ analytically intractable, we utilize the probit likelihood as
\begin{equation}
p\left(y_i\middle| f_i\right)=\Phi\left(f_iy_i\right)
\end{equation}
where $\Phi\left(z\right)=\int_{-\infty}^{z}{\mathcal{N}(x|0,1)dx}$ is the cumulative density function (CDF) of the standard Gaussian distribution. The likelihood $\Phi\left(f_iy_i\right)$ is approximated through the local likelihood approximation as
\begin{equation}
\label{11}
p\left(y_i\middle| f_i\right) \simeq t_i\left(f_i\middle|{\widetilde{Z}}_i,{\widetilde{\mu}}_i,{\widetilde{\sigma}}_i^2\right)={\widetilde{Z}}_i\mathcal{N}\left(f_i\middle|{\widetilde{\mu}}_i,{\widetilde{\sigma}}_i^2\right)
\end{equation}
where ${\widetilde{Z}}_i$, $ {\widetilde{\mu}}_i$, and $ {\widetilde{\sigma}}_i^2$ are site parameters, and the local likelihoods $t_i$ satisfy
\begin{equation}
\prod_{i=1}^{n}{t_i\left(f_i\middle|{\widetilde{Z}}_i,{\widetilde{\mu}}_i,{\widetilde{\sigma}}_i^2\right)}=\mathcal{N}\left(\widetilde{\bm{\mu}},\widetilde{\Sigma}\right)\prod_{i}{\widetilde{Z}}_i
\end{equation}
where $\widetilde{\bm{\mu}}$ denotes the vector of ${\widetilde{\mu}}_i$ and $\widetilde{\Sigma}$ is diagonal with ${\widetilde{\Sigma}}_{ii}={\widetilde{\sigma}}_i^2$. 

We can approximate the posterior of  $p\left(\bm{f}\middle| X,\bm{y}\right)$ as
\begin{equation}
\label{13}
q\left(\bm{f}\middle| X,\bm{y}\right)\triangleq \frac{1}{Z_{EP}}p\left(\bm{f}\middle| X\right)\prod_{i=1}^{n}{t_i\left(f_i\middle|{\widetilde{Z}}_i,{\widetilde{\mu}}_i,{\widetilde{\sigma}}_i^2\right)}=\mathcal{N}\left(\bm{\mu},\Sigma\right)
\end{equation}
where $\bm{\mu}=\Sigma{\widetilde{\Sigma}}^{-1}\widetilde{\bm{\mu}}$ and $\Sigma={(K^{-1}+{\widetilde{\Sigma}}^{-1})}^{-1}$. $K$ is a $n\times n$ covariance matrix. $Z_{EP}=q(\bm{y}|X)$ denotes the approximation to $Z$ from (\ref{8}) and (\ref{9}). 

To choose the parameters of $t_i$, one feasible approach is to minimize the reversed Kullback-Leibler (KL) divergence $KL(q\left(\bm{f}\middle| X,\bm{y}\right)||p\left(\bm{f}\middle| X,\bm{y}\right))$ with respect to $q\left(\bm{f}\middle| X,\bm{y}\right)$, which is also known as the variational inference for GPC. The EP method is used to update the approximation of $t_i$ sequentially, which are discussed as follows.

\subsubsection{Marginal Cavity Distribution}
By combining $p\left(\bm{f}\middle| X\right)$ and $\prod_{i=1}^{n}{t_i\left(f_i\middle|{\widetilde{Z}}_i,{\widetilde{\mu}}_i,{\widetilde{\sigma}}_i^2\right)}$, we can obtain the cavity distribution as
\begin{equation}
\label{14}
q_{-i}\left(f_i\right)\propto\int{p\left(\bm{f}\middle| X\right)\prod_{j\neq i}{t_j\left(f_j\middle|{\widetilde{Z}}_j,{\widetilde{\mu}}_j,{\widetilde{\sigma}}_j^2\right)}df_j}
\end{equation}
We combine $p\left(\bm{f}\middle| X\right)$ and the $(n-1)$ approximate likelihoods in (\ref{14}) through equivalently removing $t_i\left(f_i\middle|{\widetilde{Z}}_i,{\widetilde{\mu}}_i,{\widetilde{\sigma}}_i^2\right)$ from the approximated posterior $\prod_{i=1}^{n}{t_i\left(f_i\middle|{\widetilde{Z}}_i,{\widetilde{\mu}}_i,{\widetilde{\sigma}}_i^2\right)}$ in (\ref{13}).

\begin{prop}
\label{prop2}
We can obtain the marginal distribution for $f_i$ from $q\left(\bm{f}\middle| X,\bm{y}\right)$ as
\begin{equation}
\label{15}
q\left(f_i\middle| X,\bm{y}\right)=\mathcal{N}\left(f_i\middle|\mu_i,\sigma_i^2\right)
\end{equation}
where $\sigma_i^2=\Sigma_{ii}$.
\end{prop} 


\begin{IEEEproof}
    See Appendix \ref{appa}.  
\end{IEEEproof}

\begin{prop}
\label{prop3}
Through dividing (\ref{15}) by $t_i$, we can obtain the cavity distribution as
\begin{equation}
q_{-i}\left(f_i\right)=\mathcal{N}\left(f_i\middle|\mu_{-i},\sigma_{-i}^2\right)
\end{equation}
where $\mu_{-i}=\sigma_{-i}^2(\sigma_i^{-2}\mu_i-{\widetilde{\sigma}}_i^{-2}{\widetilde{\mu}}_i)$ and $\sigma_{-i}^2={(\sigma_i^{-2}-{\widetilde{\sigma}}_i^{-2})}^{-1}$.
\end{prop}
\begin{IEEEproof}
    See Appendix \ref{appb}.  
\end{IEEEproof}


\subsubsection{The Gaussian Approximation to the Non-Gaussian Marginal Distribution}
The product of $q_{-i}\left(f_i\right)$ and $p\left(y_i\middle| f_i\right)$ can be approximated by a non-normalized Gaussian marginal distribution, which is defined as
\begin{equation}
\hat{q}\left(f_i\right)\triangleq{\hat{Z}}_i\mathcal{N}\left({\hat{\mu}}_i,{\hat{\sigma}}_i^2\right)\simeq q_{-i}\left(f_i\right)p\left(y_i\middle| f_i\right)
\end{equation}

\begin{prop}
\label{prop4}
Considering that $\hat{q}\left(f_i\right)$ is un-normalized, to match $q_{-i}\left(f_i\right)p\left(y_i\middle| f_i\right)$, the desired posterior marginal moments should satisfy
\begin{equation}
{\hat{Z}}_i=\Phi\left(z_i\right)
\end{equation}
\begin{equation}
{\hat{\mu}}_i=\mu_{-i}+\frac{y_i\sigma_{-i}^2\mathcal{N}\left(z_i\right)}{\Phi\left(z_i\right)\sqrt{1+\sigma_{-i}^2}}
\end{equation}
\begin{equation}
{\hat{\sigma}}_i^2=\sigma_{-i}^2-\frac{\sigma_{-i}^4\mathcal{N}\left(z_i\right)}{\left(1+\sigma_{-i}^2\right)\Phi\left(z_i\right)}\left(z_i+\frac{\mathcal{N}\left(z_i\right)}{\Phi\left(z_i\right)}\right)
\end{equation}
where $z_i=\frac{y_i\mu_{-i}}{\sqrt{1+\sigma_{-i}^2}}$.
\end{prop}
\begin{IEEEproof}
    See Appendix \ref{appc}.  
\end{IEEEproof}
\subsubsection{The Computation of $ t_i$}
\begin{prop}
\label{prop5}
multiplying $\hat{q}\left(f_i\right)={\hat{Z}}_i\mathcal{N}\left({\hat{\mu}}_i,{\hat{\sigma}}_i^2\right)$ by $q_{-i}\left(f_i\right)=\mathcal{N}\left(f_i\middle|\mu_{-i},\sigma_{-i}^2\right)$, the site parameters of $p\left(y_i\middle| f_i\right)\simeq{\widetilde{Z}}_i\mathcal{N}\left(f_i\middle|{\widetilde{\mu}}_i,{\widetilde{\sigma}}_i^2\right)$ in (\ref{11}) are obtained as
\begin{equation}
\label{19-1}
{\widetilde{\mu}}_i={\widetilde{\sigma}}_i^2\left({\widetilde{\sigma}}_i^{-2}{\hat{\mu}}_i-\sigma_{-i}^{-2}\mu_{-i}\right)
\end{equation}
\begin{equation}
\label{19-2}
{\widetilde{\sigma}}_i^2=\left({\hat{\sigma}}_i^{-2}-\sigma_{-i}^{-2}\right)^{-1}
\end{equation}
\begin{equation}
\label{19-3}
{\widetilde{Z}}_i={\hat{Z}}_i\sqrt{2\pi}\sqrt{\sigma_{-i}^2+{\widetilde{\sigma}}_i^2}exp\left(\frac{\left(\mu_{-i}-{\widetilde{\mu}}_i\right)^2}{2(\sigma_{-i}^2+{\widetilde{\sigma}}_i^2)}\right)
\end{equation}
\end{prop}

\begin{IEEEproof}
    See Appendix \ref{appd}.  
\end{IEEEproof}

Thus, through iteratively moment matching marginal posteriors, we can approximate $p\left(\bm{f}\middle| X,\bm{y}\right)$ with the Gaussian approximation $q\left(\bm{f}\middle| X,\bm{y}\right)$.


\begin{prop}
\label{prop6}
There exists a closed-form expression for $p\left(y_\ast\middle| X,\bm{y},\bm{x}_\ast\right)$ as
\begin{equation}
\label{20}
\begin{aligned}
& p\left(y_\ast\middle| X,\bm{y},\bm{x}_\ast\right) \\
& = \Phi\left(\frac{\bm{k}_\ast^T\left(K+\widetilde{\Sigma}\right)^{-1}\widetilde{\bm{\mu}}}{\sqrt{1+k\left(\bm{x}_\ast,\bm{x}_\ast\right)-\bm{k}_\ast^T\left(K+\widetilde{\Sigma}\right)^{-1}\bm{k}_\ast}}\right)
\end{aligned}
\end{equation}
where $\bm{k}_\ast=K(X,\bm{x}_\ast)$, $\bm{k}_\ast^T$ denotes the transpose of $\bm{k}_\ast$, and $k\left(\bm{x}_\ast,\bm{x}_\ast\right)$ represents covariance functions evaluated at $\bm{x}_\ast$ and $\bm{x}_\ast$.
\end{prop}

\begin{IEEEproof}
    See Appendix \ref{appe}.  
\end{IEEEproof}
Given $p\left(y_\ast\middle| X,\bm{y},\bm{x}_\ast\right)$, we can obtain the identity of unknown fingerprints $\bm{x}_\ast$ according to ${\arg \max}_{y_\ast}{p\left(y_\ast\middle| X,\bm{y},\bm{x}_\ast\right)}$ \cite{dalton2013optimal}.


% \section{Proposed Efficient Gaussian Process Classification-based Physical-Layer Authentication}
\section{Proposed EGPC-based PLA Scheme}
\label{method2}
% In this section, we provide an EGPC-based PLA scheme, which can achieve better performance with fewer training fingerprint samples by active learning than the GPC-based scheme in Section \ref{method}.
\subsection{Active Learning}
The ML techniques can be categorized into SL and UL according to whether the training datasets are labeled. The SL models can obtain better performance than UL models due to the abundant prior information provided by the labels, but the labels are usually difficult to get in practical applications. To tackle the problem, active learning can perform better than UL algorithms with fewer labeled training fingerprint samples than SL algorithms, if it is allowed to choose the data from which it learns. Here, we mainly introduce the pool-based active learning as follows.


% Figure environment removed



As illustrated in Fig. \ref{fig2}, the pool-based active learning usually assumes the availability of a small set of labeled data $\mathcal{L}$ and a large pool of unlabeled data $\mathcal{U}$. The learner can pose “queries”, usually in the form of unlabeled samples to be labeled by an “oracle”, such as a human annotator. Queries are selected in a greedy manner based on a utility measure that evaluates all unlabeled samples in the pool. The pool-based active learning approach has been extensively studied across various problems, such as image classification, video classification, information extraction, and text classification, to name only a few. 


\begin{algorithm}[!h]
\caption{Steps of the Proposed EGPC-based PLA Scheme}
\textbf{Input:} $\mathcal{U}$: unlabeled fingerprint samples ${\{x^{(u)}\}}_{u=1}^U$; $\mathcal{L}$: initially labeled fingerprint samples ${\{{<x,y>}^{(l)}\}}_{l=1}^L$
\textbf{Process:}
\begin{algorithmic}[1]
\label{algorithm1}
\For{$t=1,2,\ldots$}
\State Training the authentication system $\theta$ through the GPC-based scheme in Section \ref{method};
\State Selecting $x^\ast\in\mathcal{U}$ based on \textbf{Algorithm 2/3};
\State Query the upper-layer security methods to obtain the identity of $x^\ast$, that is, label $y^\ast$;
\State Add $<x^\ast,y^\ast>$ to $\mathcal{L}$;
\State Remove $x^\ast$ from $\mathcal{U}$
\EndFor

\textbf{Output:} The trained authentication system
\end{algorithmic}
\end{algorithm}



\emph{Remark 1.} For the training of SL-based PLA models, it is challenging to obtain enough labeled fingerprint samples in actual communications. This motivates us to use active learning to train a more efficient PLA model with fewer labeled training fingerprint samples. The steps of the proposed EGPC-based PLA scheme are illustrated in \textbf{Algorithm 1}. In practice, the purpose of PLA is not  taking the place of the upper-layers identity mechanisms. Instead, it is designed to complement the existing identification methods used in the upper layers, thereby enhancing the overall security level \cite{xie2022security,xie2020survey}. In the proposed active learning-based PLA scheme, the designed fingerprint select query employs specific strategies to choose unlabeled fingerprints for annotation, and the upper-layer authentication mechanisms label the selected fingerprints $\bm{x}_\ast$. The authentication model dynamically adjusts its parameters upon receiving new labeled fingerprint samples and the learning process continues until the desired authentication accuracy is reached. Hence, the designed lightweight cross-layer identification scheme can enhance the efficiency of identity recognition and provide a higher security level. Most importantly, the choice of $\bm{x}_\ast$ influences the training efficiency of the PLA model. In the following content, we will introduce how to choose the most uncertain fingerprint sample $\bm{x}_\ast$ from the $\mathcal{U}$ of unlabeled fingerprint samples. 

\subsection{The EGPC-based PLA with RO}
In each iteration, the optimal $\bm{x}_\ast$ is selected through optimizing an acquisition function that is usually related to $\pi\left(\bm{f}|X,\bm{y}\right)$. 

% For simplicity, $X$ and $\bm{y}$ are omitted from the notations as $\pi\left(\bm{f}\right)$ and $p(y|\bm{x})$. 


% The distribution of fingerprint samples over $\mathcal{X}$ is assumed as $\bm{x}_s \sim p(\bm{x}_s)$.
The Optimal Bayesian Classifier (OBC) \cite{dalton2013optimal} is represented by $\psi_{\pi\left(\bm{f}\right)}(\cdot)$. The expected authentication error of the OBC can be denoted as
\begin{equation}
\begin{split}
\mathbb{E}_{\bm{x}_s}\left\{1-p\left(y_s=\psi_{\pi\left(\bm{f}\right)}\left(\bm{x}_s\right)\middle|\bm{x}_s\right)\right\} \\
=\mathbb{E}_{\bm{x}_s}\left\{1-\max_{y_s}{p\left(y_s\middle|\bm{x}_s\right)}\right\}
\end{split}
\end{equation}

For the EGPC-based PLA with RO, we first randomly sample fingerprint set $\mathcal{X}_\ast\subset\mathcal{X}$ with the size of $M_1$, calculate the acquisition function, and then choose the fingerprint sample as the optimal $\bm{x}_\ast$. 
% To calculate (\ref{24}), we use Monte Carlo sampling with $M_2$ fingerprint samples of $\bm{x}_s \sim p(\bm{x})$. 
Define $U^A\left(\bm{x}_\ast\right)=\mathbb{E}_{\bm{x}_s}{ \{ g^A\left(\bm{x}_s;\bm{x}_\ast\right) \} }$ and $U^S\left(\bm{x}_\ast\right)=\mathbb{E}_{\bm{x}_s}{ \{ g^S\left(\bm{x}_s;\bm{x}_\ast\right) \} }$. We denote either $g^A\left(\bm{x}_s;\bm{x}_\ast\right)$ or $g^S\left(\bm{x}_s;\bm{x}_\ast\right)$ by $g\left(\bm{x}_s;\bm{x}_\ast\right)$ that can be calculated if we know $p\left(y_s\middle|\bm{x}_s\right)$ and $p\left(y_s\middle|\bm{x}_s,\bm{x}_\ast,y_\ast\right)$. Through iteratively retraining the GPC-based authentication model by the EP method, the acquisition function is optimized. The training process of the designed EGPC-based PLA with RO is shown in \textbf{Algorithm 2}.


\begin{algorithm}[!h]
\caption{Steps of the Proposed RO-based Fingerprint Selecting Algorithm}
\textbf{Input:} $p(\bm{x})$; $q(\bm{f}|X,\bm{y})$

\textbf{Process:}
\begin{algorithmic}[1]
\label{algorithm2}
\State Sampling $M_1$ fingerprint samples of $\bm{x}_\ast \sim p(\bm{x})$, and sampling $M_2$ fingerprint samples of $\bm{x}_s \sim p(\bm{x})$
\For{each $\bm{x}_\ast$}
\State Calculating $p\left(y_\ast\middle|\bm{x}_\ast\right)$ by (\ref{20})
\For{$y_\ast$ in $\{0,1\}$ }
\State Approximating the posterior $q\left(\bm{f}\middle|\bm{x}_\ast,y_\ast\right)$ by (\ref{19-1}), (\ref{19-2}), and (\ref{19-3})
\For{each $\bm{x}_s$}
\State Calculating $p\left(y_s\middle|\bm{x}_s\right)$ and $p\left(y_s\middle|\bm{x}_s,\bm{x}_\ast,y_\ast\right)$ by (\ref{20})
\State Calculating $g(\bm{x}_s;\bm{x}_\ast)$
\EndFor
\EndFor
\State $U\left(\bm{x}_\ast\right)=\frac{1}{M_2}\sum_{\bm{x}_s}{g(\bm{x}_s;\bm{x}_\ast)}$ 
\EndFor

\textbf{Output:} $\widetilde{\bm{x}}=\arg \max_{\bm{x}_\ast}{U(\bm{x}_\ast)}$
\end{algorithmic}
\end{algorithm}



\subsection{The EGPC-based PLA with (S)ALU}
\emph{Remark 2.} There are two issues for \textbf{Algorithm 2} in actual communications as follows. 1) The number of fingerprints  $M_2$ is large to guarantee the highly-reliable approximation of the integral in (\ref{22}). 2) The calculation of $p\left(y_s\middle|\bm{x}_s,\bm{x}_\ast,y_\ast\right)$ relies on retraining the GPC-based PLA model, which has high computational complexity $O(M_1n^3)$. To address these two problems, we propose the EGPC-based PLA with (S)ALU, which 1) reduces the required number of fingerprint samples through importance sampling, and 2) avoids the retraining of the GPC-based models through the joint distribution calculation.


\begin{defn}
Motivated by Mean objective Cost of Uncertainty (MOCU) \cite{yoon2013quantifying}, we define ALU as the expected loss difference between the OBC and the optimal classifier as
\begin{equation}
\label{22}
\begin{aligned}
& \mathcal{A}\left(\pi\left(\bm{f}\right)\right)\triangleq\mathbb{E}_{\bm{x}_s}\{1-\max_{y_s}{p\left(y_s\middle|\bm{x}_s\right)}\} \\
& -\mathbb{E}_{\pi\left(\bm{f}\right)}\left\{\mathbb{E}_{\bm{x}_s}\left[1-\max_{y_s}{p\left(y_s\middle|\bm{x}_s,\bm{f}\right)}\right]\right\}
\end{aligned}
\end{equation}
\end{defn}

The ALU reduction can be taken as the acquisition function as
\begin{equation}
U^A\left(\bm{x}_\ast;\pi\left(\bm{f}\right)\right)=\mathcal{A}\left(\pi\left(\bm{f}\right)\right)-\mathbb{E}_{y_\ast|\bm{x}_s}\left[\mathcal{A}\left(\pi\left(\bm{f}|\bm{x}_\ast,y_\ast\right)\right)\right]
\end{equation}

According to \cite{zhao2021efficient}, we can obtain
\begin{equation}
\label{24}
\begin{aligned}
& U\left(\bm{x}_\ast\right)=\mathbb{E}_{\bm{x}_s}\left\{1-\max_{y_s}{p\left(y_s\middle|\bm{x}_s\right)}\right\} \\
& -\mathbb{E}_{y_\ast|\bm{x}_\ast} \{\mathbb{E}_{\bm{x}_s}[1-\max_{y_s}{p\left(y_s\middle|\bm{x}_s,\bm{x}_\ast,y_\ast\right)}]\} \\
& =\mathbb{E}_{\bm{x}_s}\left\{\mathbb{E}_{y_\ast|\bm{x}_\ast}\left[\max_{y_s}{p\left(y_s\middle|\bm{x}_s,\bm{x},y\right)}\right]-\max_{y_s}{p\left(y_s\middle|\bm{x}_s\right)}\right\}
\end{aligned}
\end{equation}
which is also the Expected Error Reduction (EER) of OBC \cite{roy2001toward}.

\begin{defn}
Inspired by Soft-MOCU \cite{zhao2021bayesian}, we define SALU in (\ref{25}), which has a smooth concave approximation of ALU.
\begin{equation}
\label{25}
\begin{aligned}
& \mathcal{A}^S\left(\pi\left(\bm{f}\right)\right)\triangleq\mathbb{E}_{\bm{x}_s} { \{1-\frac{1}{k} \mathtt{LogSumExp} (k\cdot p\left(y_s\middle|\bm{x}_s\right)) \} } \\
& -\mathbb{E}_{\pi\left(\bm{f}\right)} \{ \mathbb{E}_{\bm{x}_s}[1-\max_{y_s}{p\left(y_s\middle|\bm{x}_s,\bm{f}\right)}] \}
\end{aligned}
\end{equation}
\end{defn}


The corresponding acquisition function is denoted as
\begin{equation}
\begin{aligned}
& U^S\left(\boldsymbol{x}_*\right)=\mathbb{E}_{\boldsymbol{x}_s}\left\{\mathbb{E}_{y_* \mid \boldsymbol{x}_*}\left[\frac{1}{k} \log \operatorname{SumExp}\left(k \cdot p\left(y_s \mid \boldsymbol{x}_s, \boldsymbol{x}_*, y_*\right)\right)\right]\right. \\
& -\frac{1}{k} \log \operatorname{SumExp}\left(k \cdot p\left(y_s \mid \boldsymbol{x}_s\right)\right\}
\end{aligned}
\end{equation}
which has no maximization operators.

\subsubsection{Importance Sampling}
$U\left(\bm{x}_\ast\right)$ in (\ref{24}) can be reformulated over the distribution $\widetilde{p}(\bm{x}_s;\bm{x}_\ast)$ as
\begin{equation}
\label{27}
U\left(\bm{x}_\ast\right)=\mathbb{E}_{\bm{x}_s \sim \widetilde{p}\left(\bm{x}_s;\bm{x}_\ast\right)}\left[\frac{p\left(\bm{x}_s\right)g\left(\bm{x}_s;\bm{x}_\ast\right)}{\widetilde{p}\left(\bm{x}_s;\bm{x}_\ast\right)}\right]
\end{equation}
Assuming $\widetilde{p}\left(\bm{x}_s;\bm{x}_\ast\right)\propto k(\bm{x}_s;\bm{x}_\ast)p(\bm{x}_s)$, we can obtain $p\left(y_s\middle|\bm{x}_s,\bm{x}_\ast,y_\ast\right)\approx0$ and $g\left(\bm{x}_s;\bm{x}_\ast\right)\approx0$.
% Considering that $k(\bm{x}_s;\bm{x}_\ast)\approx0$, that is, $(\bm{x}_s;y_s)$ and $(\bm{x}_\ast;y_\ast)$ are independent, we can obtain $p\left(y_s\middle|\bm{x}_s,\bm{x}_\ast,y_\ast\right)\approx0$ and $g\left(\bm{x}_s;\bm{x}_\ast\right)\approx0$.
\subsubsection{Joint Distribution Calculation}
To address the second issue in \emph{Remark 2}, $p\left(y_s\middle|\bm{x}_s,\bm{x}_\ast,y_\ast\right)$ is obtained as
\begin{equation}
\label{jointdistributioncalculation}
p\left(y_s\middle|\bm{x}_s,\bm{x}_\ast,y_\ast\right)=\frac{p\left(y_s,y_\ast\middle|\bm{x}_s,\bm{x}_\ast\right)}{p\left(y_\ast\middle|\bm{x}_\ast\right)}
\end{equation}
The calculation requires $p\left(y_s,y_\ast\middle|\bm{x}_s,\bm{x}_\ast\right)$.


\begin{prop}
\label{prop7}
The joint distribution $p\left(y_s,y_\ast\middle|\bm{x}_s,\bm{x}_\ast\right)$ is expressed as
\begin{equation}
\label{29}
\begin{aligned}
& p\left(y_s=1,y_\ast=1\middle|\bm{x}_s,\bm{x}_\ast\right) \\
& =\int\Phi\left(\frac{{\widetilde{\mu}}_\ast\left(f_s\right)}{\sqrt{{\widetilde{\sigma}}_{\ast\ast}+1}}\right)\Phi\left(f_s\right)\phi\left(f_s\middle|\mu_s,\sigma_{ss}\right)df_s
\end{aligned}
\end{equation}
where $f_s=f(\bm{x}_s)$, $f_\ast=f(\bm{x}_\ast)$, $\mu_{s^\ast}$ and $\Sigma_{s^\ast}$ represent the marginal mean and covariance matrics of $f_s$ and $f_\ast$, respectively. Denoting $\mu_{s^\ast}=(\begin{matrix}\mu_s\\\mu_\ast\\\end{matrix})$ and $\Sigma_{s^\ast}=(\begin{matrix}\sigma_{ss}&\sigma_{s^\ast}\\\sigma_{s^\ast}&\sigma_{\ast\ast}\\\end{matrix})$, $\phi\left(f_s,f_\ast\middle|\mu_{s^\ast},\Sigma_{s^\ast}\right)=\left(f_s\middle|\mu_s,\sigma_{ss}\right)\left(f_\ast\middle|{\widetilde{\mu}}_\ast(f_s),{\widetilde{\sigma}}_{\ast\ast}\right)$, where ${\widetilde{\mu}}_\ast\left(f_s\right)=\mu_\ast+\frac{(f_s-\mu_s)\sigma_{s^\ast}}{\sigma_{ss}}$ and ${\widetilde{\sigma}}_{\ast\ast}=\sigma_{\ast\ast}-\frac{\sigma_{s^\ast}^2}{\sigma_{ss}}$.
\end{prop}

\begin{IEEEproof}
    See Appendix \ref{appf}.
\end{IEEEproof}

% Based on (\ref{27}) and (\ref{29}), we propose the EGPC-based PLA with (S)ALU. 
The process of the proposed (S)ALU-based fingerprint selecting algorithms is shown in \textbf{Algorithm 3} in detail. 



\begin{algorithm}[!t]
\caption{Steps of the Proposed (S)ALU-based Fingerprint Selecting Algorithms}
\textbf{Input:}  $p(\bm{x})$; $q(\bm{f}|X,\bm{y})$

\textbf{Process:}
\begin{algorithmic}[1]
\label{algorithm3}
\State Sample $M_1$ fingerprint samples of $\bm{x}_\ast \sim p(\bm{x})$
\For{each $\bm{x}_\ast$}
\State Calculate $p\left(y_\ast\middle|\bm{x}_\ast\right)$ by (\ref{20})
\State Sample $M_2$ fingerprint samples of $\bm{x}_s \sim \widetilde{p}(\bm{x}_s;\bm{x}_\ast)$
\For{$y_\ast$ in $\{0,1\}$}
\For{each $\bm{x}_s$}
\State Calculate $p\left(y_s\middle|\bm{x}_s,\bm{x}_\ast,y_\ast\right)$ by (\ref{29})
\State Calculate $p\left(y_s\middle|\bm{x}_s\right)$ by (\ref{20})
\State Calculate $p\left(y_s\middle|\bm{x}_s,\bm{x}_\ast,y_\ast\right)=\frac{p\left(y_s,y_\ast\middle|\bm{x}_s,\bm{x}_\ast\right)}{p\left(y_s\middle|\bm{x}_s\right)}$
\State Calculate $g(\bm{x}_s;\bm{x}_\ast)$
\EndFor
\EndFor
\State $U\left(\bm{x}_\ast\right)=\frac{1}{M_2}\sum_{\bm{x}_s}\frac{p(\bm{x}_s)g(\bm{x}_s;\bm{x}_\ast)}{\widetilde{p}(\bm{x}_s;\bm{x}_\ast)}$
\EndFor

\textbf{Output:} $\widetilde{\bm{x}}=\arg \max_{\bm{x}_\ast}U\left(\bm{x}_\ast\right)$
\end{algorithmic}
\end{algorithm}




\section{Performance Evaluation and Simulation Results}
\label{simulation}
\subsection{Performance Metric}
\subsubsection{Authentication Error Rate}
Authentication error rate $R_e$ is used to measure the authentication performance, which is represented as
\begin{equation}
    R_e=\frac{1}{N_a}\sum_{n=1}^{N_a}\mathbb{I}\left(\bm{L}_n \neq \bm{Y}_n\right)
\end{equation}
where $N_a$ is the number of testing fingerprints, and $\bm{L}_n$ and $\bm{Y}_n$ respectively represent the true and estimated identities of the $n$th fingerprint. $\mathbb{I}(\cdot)$ takes 1 or 0 if $\cdot$ is true or not, respectively.

% \begin{lem}
% \label{lem}
% \begin{equation}
%     R_e=\displaystyle\frac{1}{1+\displaystyle\frac{\displaystyle\frac{TL}{TA}+1}{\displaystyle\frac{1}{P_{md}-1}+\displaystyle\frac{1}{P_{fa}-1}}}
% \end{equation}
% where $P_{md}$ and $P_{fa}$ respectively denote the miss detection rate and false alarm rate, and $TL$ and $TA$ are illustrated in \textbf{Table \ref{table2}} \cite{meng2022physical}.
% \end{lem}
% \begin{IEEEproof}
%     See Appendix \ref{appg}.
% \end{IEEEproof}




% \begin{table}[htb] 
% \begin{center}   
% \caption{Confusion Matrix of Alice and Eve}  
% \label{table2}
% \setlength{\tabcolsep}{4pt}
% \begin{tabular}{|c|c|c|}
% \hline
% \textbf{Actual\textbackslash{}Predicted} & \textbf{Alice} & \textbf{Eve} \\ \hline
% \textbf{Alice} & \makecell{ True Legitimate \\ (TL) } & \makecell{False Attack \\ (FA)} \\ \hline
% \textbf{Eve} & \makecell{False Legitimate \\ (FL)} & \makecell{True Attack \\ (TA)} \\ \hline
% \end{tabular}
% \end{center}
% \end{table}







% \begin{table}[htb]   
% \begin{center}   
% \caption{The List of Main Parameters}  
% \setlength{\tabcolsep}{4pt}


% \label{table1} 
% \begin{tabular}{|C|C|}   
% \hline   \textbf{Notations} & \textbf{Meaning} \\   
% \hline   $\triangleq$ & An equality which acts as a definition  \\ 
% \hline   $\bm{y}^T$ & The transpose of vector $\bm{y}$  \\  
% \hline   $\propto$ & Proportional to  \\      
% \hline   $\sim$ & Distributed according to \\
% \hline   $\bm{f}_\ast$ & Gaussian process posterior prediction \\
% \hline   $\bm{X}_S$ & The transmitted signal vector \\
% \hline   $\bm{Y}_S$ & The received signal vector \\
% \hline   $\bm{Q}^{\left(A,I,B\right)}$ & \makecell{The hierarchical channel matrix\\ from Alice to Bob through IRS} \\
% \hline   $\bm{\Psi}$ & The matrix of IRS element responses \\
% \hline $\hat{\bm{X}}$ & The estimated configurable fingerprints \\
% \hline $\bm{y}$ & The identity label \\
% \hline $\mathbb{E}$ & Expectation  \\
% \hline $\mathbb{V}$ & Variance  \\
% \hline $\sigma(z)$ & The sigmoid function \\
% \hline $f(\bm{x})$ or $\bm{f}$ & Gaussian process latent function values \\
% \hline ${\bar{\pi}}_\ast$ & The probabilistic prediction of the identity \\
% \hline $Z$ & The marginal likelihood \\
% \hline $\Phi\left(z\right)$ & The CDF of a standard normal distribution \\
% \hline $t_i\left(f_i\middle|{\widetilde{Z}}_i,{\widetilde{\mu}}_i,{\widetilde{\sigma}}_i^2\right)$ & The local likelihood approximation \\
% \hline $q\left(\bm{f}\middle| X,\bm{y}\right)$ & \makecell{The distribution posterior used \\ to approximate $p\left(\bm{f}\middle| X,\bm{y}\right)$ }  \\
% \hline $K$ & The covariance (or Gram) matrix \\
% \hline $q_{-i}\left(f_i\right)$ & The cavity distribution \\
% \hline $\bm{k}_\ast$ & Short for$ K\left(\bm{X},\bm{x}_\ast\right)$ \\
% \hline
% \end{tabular}   
% \end{center}   
% \end{table}















\subsubsection{Error Rate Difference}
Error rate difference $D_e$ indicates the difference between the authentication error rate $R_e$ in perfect and imperfect channel estimation conditions, which can be denoted as
\begin{equation}
D_e=R_e^{i}-R_e^p
\end{equation}
where $R_e^{i}$ and $R_e^p$ respectively represent the authentication error rate in perfect and imperfect channel estimation conditions.
\subsection{Simulation Parameters}
% The computer configurations are Intel Core i5-13600KF, 3.50 GHz basic frequency, and 32 GB of RAM.  
Fingerprint samples are generated through MATLAB platform, and the performance of PLA models is verified through PyCharm. The baseline algorithms include MES \cite{sebastiani2000maximum} and BALD \cite{houlsby2011bayesian}.

% Figure environment removed
The positions of Alice, Eve, Bob, and IRS are illustrated in Fig. \ref{fig3}. Alice, Eve, and Bob are equipped with Uniform linear arrays, and the number of arrays of Alice/Eve and Bob are $N_T=2$ and $N_R=4$, respectively. IRS is a uniform rectangular array composed of $N=N_y N_z=8*32$ reflective elements, and the distance between each reflective element is half wavelength. $\bm{H}$ and $\bm{G}$ are modeled as Rician Channel as
\begin{equation}
\bm{H}=\sqrt{\frac{P L_{H}^{LoS} \kappa_{H}}{1+\kappa_{H}}} \overline{\bm{H}}+\sqrt{\frac{P L_{H}^{NLoS}}{1+\kappa_{H}}} \widetilde{\bm{H}}
\end{equation}
\begin{equation}
    \bm{G}=\sqrt{\frac{PL_{G}^{LoS}\kappa_G}{1+\kappa_G}} \overline{\bm{G}}+\sqrt{\frac{PL_{G}^{NLoS}}{1+\kappa_G}} \widetilde{\bm{G}}
\end{equation}
where $\overline{\bm{H}}$ and $\overline{\bm{G}}$ are Line of Sight (LoS) paths, and $\widetilde{\bm{H}}$ and $\widetilde{\bm{G}}$ are Non-LoS (NLoS) paths. $PL$ denotes the corresponding path loss, which are denoted as follows according to the 3GPP TR 38.901 \cite{3gpp2022study}.
\begin{equation}
    PL_{LoS}=32.4+21\log_{10}(d)+20\log_{10}(f_c)
\end{equation}
\begin{equation}
     PL_{NLoS}=32.4+31.9\log_{10}(d)+20\log_{10}(f_c)
\end{equation}
where $d$ is the distance (in $\SI{}{m}$) of the path, $f_c=\SI{3.5}{GHz}$ is the carrier frequency, and $\kappa_{H}=3$ and $\kappa_{G}=4$ are the Rician factor. The bandwidth is $\SI{1}{MHz}$. The LoS paths are modeled according to \cite{hu2021reconfigurable}. The NLoS paths are modeled as Rayleigh fading models, that is, each element of the channel matrix obeys the independent identically distributed variable $\mathcal{CN}(0,\bm{I})$. The directed channels $\bm{D}$ between Alice/Eve and Bob are modeled as Rayleigh channels due to the severe decline.

The synthetic datasets are split into training and testing datasets, and the numbers of training and testing fingerprint samples per transmitter are 800 and 200, respectively. Initially two fingerprint samples are chosen from Alice and Eve for labeling and further used to estimate the GPC hyper-parameters. The learning procedures are repeated for 100 runs.

\subsection{Simulation Results and Analysis}
\subsubsection{Perfect Channel Estimation}
Based on (\ref{signal}), the estimated configurable fingerprint can be denoted as $\bm{Q}^{\left(A,I,B\right)}=\bm{H \Psi G}$. Artificial noises $\bm{W} \sim \mathcal{CN}(0,{\sigma}_w^2\bm{I})$ are added to model noisy wireless environments, where ${\sigma}_w^2=10^{-20}$.



% Figure environment removed


Fig. \ref{fig4} compared the proposed RO-based, ALU-based, and SALU-based PLA schemes with the PLA schemes based on random algorithm, BALD, and MES. As the iteration number increases, all of the algorithms achieve lower authentication error rate. It is because that the proposed GPC-based authentication model can observe more labeled fingerprint samples, better understand the distribution of fingerprints, and make more accurate predictions. In addition, more fingerprint samples can reduce the risk of over-fitting and make the model better generalized to unknown fingerprint. BALD does not perform well, which is because it is better at learning the characteristics of low-dimensional data. MES tends to prioritize querying points that are in close proximity to the decision boundary. However, the cascade fingerprint has multiple boundaries for multi-dimensions. The proposed ALU-based PLA scheme can take the EER as the acquisition function, thus achieving better authentication performance than the proposed RO-based PLA scheme. Compared with the ALU-based authentication method, the suggested SALU-based approach can obtain lower error rate due to smoother concave approximation. Fig. \ref{fig4} demonstrates the superiority of the suggested ALU-based and SALU-based PLA schemes than baseline algorithms in sampling efficiency of fingerprint samples.






Fig. \ref{fig5} presents the authentication performance under non-IRS and IRS-assisted wireless environments. Regardless of the iteration numbers, the authentication error rate of all the proposed schemes under non-IRS scenarios is always around 0.5. Due to the severe decline of Rayleigh channels, it is challenging to effectively learn the inherent characteristics of fingerprints. In contrast, the created transmission path by IRS has better channel quality, which is modeled as cascade Rician channels. Therefore, the proposed schemes can obtain much better authentication performance with the help of IRS. Fig. \ref{fig5} shows the effectiveness of IRS in enhancing authentication performance compared with the conventional non-IRS-based PLA framework under low SNR environments.

% Figure environment removed





Fig. \ref{fig6} further provides the authentication performance versus different phase parameters of the IRS element $\theta=\theta_1=\theta_2=...=\theta_n$, where $\theta_n$ is the phase parameter of the $n$th IRS element. With the increase of the phase, the authentication error rate fluctuates with different amplitude. Fig. \ref{fig6} verifies that the choice of phase parameters of IRS has influences on the authentication performance. However, the optimization of IRS parameters is another important research area, and it is difficult to draw obvious conclusions about phase parameters of IRS and authentication error rate according to Fig. \ref{fig6}.

% Figure environment removed




Fig. \ref{fig7} compares the authentication performance versus different numbers of columns of IRS $N_z$. As the number of columns of IRS increases, the number of IRS element $N=N_yN_z$ increases. Therefore, the dimension of $\bm{H}$, $\bm{\Psi}$, and $\bm{G}$ in the cascade channel matrix $\bm{Q}^{(A,I,B)}=\bm{H \Psi G}$ increases. When the dimension of $\bm{H}$, $\bm{\Psi}$, and $\bm{G}$ is small, the limited range of the particular fingerprint distribution may not be enough to always distinguish transmitters. In contrast, when the dimension of $\bm{H}$, $\bm{\Psi}$, and $\bm{G}$ is large, it is more difficult for attackers to successfully predict or imitate each dimension component of fingerprints.

% Figure environment removed






\subsubsection{Imperfect Channel Estimation}
Imperfect CSI models are denoted as $\bm{H}=\bm{H}_i\odot\bm{H}_e$ and $\bm{G}=\bm{G}_i \odot \bm{G}_e$,
% \begin{equation}
% \bm{H}=\bm{H}_i  \odot \bm{H}_e
% \end{equation}
% \begin{equation}
% \bm{G}=\bm{G}_i \odot \bm{G}_e
% \end{equation}
where $\bm{H}_i$ and $\bm{G}_i$ are ideal CSI matrices, $\odot$ denotes the hadamard product, and $\bm{H}_e$ and $\bm{G}_e$ are error matrices, which are represented respectively as $ \bm{H}_e \sim \mathcal{CN} (\bm{I},\sigma_H^2\bm{I})$ and $ \bm{G}_e \sim \mathcal{CN} (\bm{I},\sigma_G^2\bm{I})$.
% \begin{equation}
%     \bm{H}_e \sim \mathcal{CN} (\bm{I},\sigma_H^2\bm{I})
% \end{equation}
% \begin{equation}
%     \bm{G}_e \sim \mathcal{CN} (\bm{I},\sigma_G^2\bm{I})
% \end{equation}

Fig. \ref{fig8} illustrates the authentication performance versus different Channel estimation errors. When $\sigma^2\le 8$, all of the schemes are robust of channel estimation errors. It can be explained that, due to the assistance of IRS, the configurable fingerprints of different transmitters are easy to distinguish. When $\sigma^2=9$, only the random sampling-based scheme has higher authentication error rate than that in perfect channel estimation condition. When $\sigma^2\ge10$, as $\sigma^2$ increases, the authentication performance is gradually declining. Nevertheless, the proposed ALU-based and SALU-based schemes can achieve lower authentication error rate than baseline schemes. In addition, the proposed SALU-based scheme always has the best authentication performance than the other schemes. Fig. \ref{fig8} verifies the robustness of the proposed (S)ALU-based PLA schemes to channel estimation errors.

% Figure environment removed



Fig. \ref{fig9} uses the computational time as a metric to demonstrate the complexity of PLA schemes. Because of the retraining of the GPC-based authentication model for every $(\bm{x}_*,y_*)$, the proposed RO-based scheme has the highest complexity. In contrast, through the importance sampling in (\ref{27}) and joint distribution calculation in (\ref{jointdistributioncalculation}), the proposed (S)ALU-based schemes can accelerate the authentication process. In comparison to the proposed ALU-based scheme, the designed SALU-based PLA scheme demands additional training time to achieve a lower authentication error rate.

% Figure environment removed



\section{Conclusion}
\label{conclusion}
To enhance wireless identity security in the context of 6G-enabled Internet of Things (IoT), we introduce a configurable-fingerprint-based PLA framework utilizing IRS. Compared with the non-IRS-based PLA approaches, the designed IRS-assisted method can improve the discrimination of fingerprints through creating an alternative transmission path. We further suggest a GPC-based PLA scheme and provide the closed mathematical expression of posterior prediction of identity of unknown fingerprints. Considering that the labels of fingerprints are difficult to obtain in actual scenarios, we further combine active learning and the GPC-based PLA to propose three EGPC-based PLA schemes, which requires much fewer labeled fingerprints and has more universality.

Through simulations performed on synthetic datasets, we validate the superiority of our IRS-assisted PLA approach over non-IRS-based framework in low SNR environments. Additionally, we demonstrate that our proposed EGPC-based approaches outperform baseline algorithms. Furthermore, the simulation results indicate that adjusting the parameters of IRS, such as the number and phase parameters of IRS elements, can further reduce the authentication error rate. It is important to highlight that the optimization of phase parameters in IRSs is a topic that necessitates further exploration, which will be studied using RL methods in future research.

% Overall, our proposed framework offers an innovative solution for wireless identity security in 6G-enabled IoT, leveraging configurable fingerprints assisted by IRS. Through simulation-based evaluations, we highlight the effectiveness of our approach in challenging wireless environments and showcase the potential of combining active learning with GPC for more efficient and accurate authentication processes.





























\input{Appendix.tex}


\bibliography{rif.bib}
\bibliographystyle{IEEEtran}




\vfill

% \begin{IEEEbiography}[{% Figure removed}]
% {Rui Meng}(S'23) received the B.S. degree in information engineering from Beijing University of Posts and Telecommunications (BUPT), Beijing, China, in 2018, where he is currently pursuing the Ph.D. degree in information and communication engineering. 

% His research interests cover next-generation networks, physical layer authentication, identity security, deep learning, and Internet of Things.
% \end{IEEEbiography}

% \begin{IEEEbiography}[{% Figure removed}]
% {Fangzhou Zhu} received the B.S. degree in information engineering from Beijing University of Posts and Telecommunications (BUPT), Beijing, China, in 2021, where he is currently pursuing the M.S. degree in information and communication engineering. 

% His research interests cover wireless localization, physical layer authentication, and deep learning.
% \end{IEEEbiography}

% \begin{IEEEbiography}[{\includegraphics [width=1in,height=1.25in,clip,keepaspectratio]{Xiaodong Xu.jpg}}]{Xiaodong Xu}
% (S'06-M'07-SM'18) received his B.S degree in Information and Communication Engineering and Master’s Degree in Communication and Information System both from Shandong University in 2001 and 2004 separately. He received his Ph.D. degrees of Circuit and System in Beijing University of Posts and Telecommunications (BUPT) in 2007. 

% He is currently a professor of BUPT, a research fellow of the Department of Broadband Communication of Peng Cheng Laboratory and a member of IMT-2030 (6G) Experts Panel. He has coauthored nine books/chapters and more than 120 journal and conference papers. He is also the inventor or co-inventor of 51 granted patents. His research interests cover semantic communications, intellicise communication system, moving networks, mobile edge computing and caching.
% \end{IEEEbiography}


% \begin{IEEEbiography}[{% Figure removed}]
% {Liang Jin} received his Bachelor's degree in Communication Engineering from Xiangtan University, Xiangtan, China, in 2020. He is currently pursuing the Ph.D. degree with the School of Information and Communication Engineering, Beijing University of Posts and Telecommunications, Beijing, China.

% His research interests cover reconfigurable intelligent surface, phyiscal layer security, mobile edge computing.
% \end{IEEEbiography}

% \begin{IEEEbiography}[{% Figure removed}]
% {Bizhu Wang} received a B.Eng. Degree in Telecommunications Engineering from Beijing University of Posts and Telecommunications (BUPT) in 2016, and the Ph.D. degrees in Electronic Engineering from Queen Mary University of London in 2020, respectively. In 2021, Bizhu joined BUPT as a lecturer. 

% Her current research interests include next-generation networks, semantic communication, intent-based networking, machine learning, and in-built security and privacy protection.

% \end{IEEEbiography}


% \begin{IEEEbiography}[{% Figure removed}]
% {Bingxuan Xu}(S'23) received the B.S. degree in communication engineering from Beijing University of Posts and Telecommunications (BUPT), Beijing, China, in 2022, where she is currently pursuing the Ph.D. degree in information and communication engineering. 

% Her research interests cover next-generation networks, semantic communications, and deep learning.
% \end{IEEEbiography}

% \begin{IEEEbiography}[{% Figure removed}]
% {Han Meng} (S'22) received the B.S. degree in Beijing University of Posts and Telecommunications (BUPT), Beijing, China, in 2018, where she is currently working toward the Ph.D. degree in Information and Communication Engineering in the Key Laboratory of Universal Wireless Communications, Ministry of Education, BUPT. 

% Her major research interests include wireless communications, deep learning, graph neural network, and automatic aircraft recognition.
% \end{IEEEbiography}





% \begin{IEEEbiography}[{\includegraphics [width=1in,height=1.25in,clip,keepaspectratio]{Ping Zhang.jpg}}]
% {Ping Zhang}(M'07-SM'15-F'18) received the Ph.D. degree in circuits and systems from the Beijing University of Posts and Telecommunications, Beijing, China, in 1990. 

% He is currently a Professor with Beijing University of Posts and Telecommunications, the Director of the State Key Laboratory of Networking and Switching Technology, the Director of the Department of Broadband Communication of Peng Cheng Laboratory, a member of IMT-2020 (5G) Experts Panel, and a member of Experts Panel for China’s 6G development. He served as a Chief Scientist of National Basic Research Program (973 Program), an expert in Information Technology Division of National High-Tech R\&D Program (863 Program), and a member of Consultant Committee on International Cooperation of National Natural Science Foundation of China. His research interests mainly focus on wireless communication. Prof. Zhang is an Academician of the Chinese Academy of Engineering.
% \end{IEEEbiography} 



\end{document}

