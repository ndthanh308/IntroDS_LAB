\section{Optical Flow}
\label{asec:opt-flow}

\subsection{Dataset}
\label{appendix:optflow-data}
\update{The BubbleML velocity data is in non-dimensional units (refer to appendix \ref{asec:non-dim}).
The non-dimensional velocities are first converted to real world units by multiplying it with the characteristic velocity of the simulation. The velocities are then multiplied by a scaling factor (number of pixels per unit length in the image) and then divided by the frames per second value. This converts the velocities to pixels per frame units compatible with state-of-the-art optical flow models.}

\subsection{Benchmark Models} \label{appendix:optflow-benchmark-models}
\update{
We consider two state-of-the-art optical flow models, RAFT \cite{teed2020raft} and GMFlow \cite{xu2022gmflow}.
\begin{enumerate}
    \item \textbf{RAFT}, Recurrent All-Pairs Field Transforms (RAFT), processes per-pixel features and forms multi-scale 4D correlation volumes between all pixel pairs. The flow field is iteratively updated  through a recurrent unit that performs lookups on the correlation volumes. RAFT begins with a feature encoder that extracts a feature vector for each pixel. This is followed by a correlation layer that produces a 4D correlation volume for all pairs of pixels. Subsequently, this data is pooled to create lower resolution volumes. Finally, a GRU-based update operator utilizes the data from the correlation volumes to iteratively refine the flow field, starting its calculations from zero.
    \item \textbf{GMFlow} reformulates optical flow as a global matching problem, which identifies the correspondences by directly comparing feature similarities. It extracts dense features from a convolutional backbone network and uses a transformer for feature enhancement, a correlation and softmax layer for global feature matching, and a self-attention layer for flow propagation. It also has a refinement step to exploit higher resolution features reusing the GMFlow framework for residual flow estimation.
\end{enumerate}
}
\subsection{Learning Bubble Dynamics Results} \label{appendix:optflow-results}
  \update{\textbf{Analysis.} For pool boiling test images, the models trained on FlyingChairs and fine-tuned on Boiling images (C+B) achieve the best performance, as seen from Tables  \ref{table:results_optical_flow}, \ref{table:results_optical_flow_pbsc}, and \ref{table:results_optical_flow_pbgv}. However, for flow boiling test images, a different trend emerges. As observed in Tables \ref{table:results_optical_flow_fbiv} and \ref{table:results_optical_flow_fbgv}, the lowest errors are achieved by fine-tuning the Sintel benchmark models (C+T+S+B).}
  
  \update{Figures \ref{fig:results-raft} and \ref{fig:results-gmflow} show a visual comparison between the outputs of the best fine-tuned and pre-trained models and the corresponding ground truth optical flows, for RAFT and GMFlow respectively. In many instances (highlighted in red), the pre-trained models fail to capture the direction of movement of bubbles which are visibly corrected by fine-tuning. However, as seen in the ground truth optical flows, the bubble boundaries generally have different values than the interior regions. This gradient is responsible for the dynamic changes in bubble shapes between consecutive frames. The end point errors at these bubble-liquid interfaces remain significantly large even after fine-tuning. The bubble-liquid interface is the most important region where a highly accurate optical flow prediction is necessary to enable downstream tasks such as scientific machine learning on experimental boiling data. This suggests that there is a need to incorporate physics-informed learning rules and architectures into optical flow models to improve the interface end point errors in optical flow.}

\begin{table}[h]
    \small
    \centering
    \caption{Results on optical flow data (B) generated from \textbf{Pool Boiling- Subcooled} simulations. It consists of around 1100 training image pairs and around 300 test image pairs. It is to be noted that heater temperatures lower than $90^\circ C$ are not used due to the lack of trackable bubbles in many frames. }
    \begin{tabular}{ccccccccc}
    \toprule
    \multirow{2}{*}{\centering Model} & \multirow{2}{*}{\centering Method} & \multirow{2}{*}{\centering Chairs(Val)} & Things(Val) & \multicolumn{2}{c}{Sintel(Train)} & \multicolumn{2}{c}{KITTI(Train)} & \multirow{2}{*}{\centering Boiling(Test)} \\
     \cmidrule(r){4-4}  \cmidrule(r){5-6}  \cmidrule(r) {7-8} 
      & & & Clean & Clean & Final & F1-EPE & F1-all & \\
    \midrule
     \multirow{2}{*}{\centering C} 
     & RAFT & 0.82 & 9.03 & 2.19 & 4.49 & 9.83 & 37.57 & 2.41\\
     & GMFlow & 0.92 & 10.23 & 3.22 & 4.43 & 17.82 & 56.14 & 1.92\\
     \hline
     \multirow{2}{*}{\centering C+B} 
     & RAFT & 0.89 & 11.64 & 2.58 & 5.17 & 14.01 & 47.53 & \textbf{0.63}\\
     & GMFlow & 1.34 & 12.23 & 3.93 & 5.27 & 22.83 & 64.41 & \textbf{0.63}\\
     \hline
     \multirow{2}{*}{\centering C+T} 
     & RAFT & 1.15 & 4.39 & 1.40 & 2.71 & 5.02 & 17.46 & 1.91\\
     & GMFlow & 1.26 & 3.48 & 1.50 & 2.96 & 11.60 & 35.62 & 4.76\\
     \hline
     \multirow{2}{*}{\centering C+T+B} 
     & RAFT & 1.24 & 6.45 & 1.54 & 2.82 & 7.35 & 20.27 & 0.70\\
     & GMFlow & 1.46 & 4.04 & 1.66 & 3.11 & 14.50 & 44.35 & 0.67\\
     \hline
     \multirow{2}{*}{\centering C+T+S} 
     & RAFT & 1.21 & 4.69 & 0.77 & 1.22 & 1.54 & 5.64 & 6.07\\
     & GMFlow & 1.53 & 4.09 & 0.95 & 1.28 & 3.04 & 13.61 & 9.21\\
     \hline
     \multirow{2}{*}{\centering C+T+S+B} 
     & RAFT & 1.35 & 6.49 & 0.87 & 1.48 & 1.79 & 6.31 & 0.64\\
     & GMFlow & 1.66 & 4.43 & 1.04 & 1.42 & 3.99 & 18.83 & 0.65\\
     \bottomrule
    \end{tabular}
    
    \label{table:results_optical_flow_pbsc}
\end{table}

\begin{table}[h]
    \small
    \centering
    \caption{Results on optical flow data (B) generated from \textbf{Pool Boiling- Gravity} simulations. It consists of around 1400 training image pairs and around 360 test image pairs. }
    \begin{tabular}{ccccccccc}
    \toprule
    \multirow{2}{*}{\centering Model} & \multirow{2}{*}{\centering Method} & \multirow{2}{*}{\centering Chairs(Val)} & Things(Val) & \multicolumn{2}{c}{Sintel(Train)} & \multicolumn{2}{c}{KITTI(Train)} & \multirow{2}{*}{\centering Boiling(Test)} \\
     \cmidrule(r){4-4}  \cmidrule(r){5-6}  \cmidrule(r) {7-8} 
      & & & Clean & Clean & Final & F1-EPE & F1-all & \\
    \midrule
     \multirow{2}{*}{\centering C} 
     & RAFT & 0.82 & 9.03 & 2.19 & 4.49 & 9.83 & 37.57 & 3.30\\
     & GMFlow & 0.92 & 10.23 & 3.22 & 4.43 & 17.82 & 56.14 & 2.40\\
     \hline
     \multirow{2}{*}{\centering C+B} 
     & RAFT & 0.95 & 10.98 & 2.78 & 5.76 & 15.52 & 49.88 & \textbf{0.90}\\
     & GMFlow & 1.42 & 12.57 & 4.06 & 5.41 & 23.61 & 66.38 & \textbf{0.90}\\
     \hline
     \multirow{2}{*}{\centering C+T} 
     & RAFT & 1.15 & 4.39 & 1.40 & 2.71 & 5.02 & 17.46 & 2.75\\
     & GMFlow & 1.26 & 3.48 & 1.50 & 2.96 & 11.60 & 35.62 & 3.60\\
     \hline
     \multirow{2}{*}{\centering C+T+B} 
     & RAFT & 1.31 & 6.65 & 1.64 & 2.93 & 8.39 & 21.36 & 0.96\\
     & GMFlow & 1.41 & 3.95 & 1.64 & 2.97 & 44.07 & 14.41 & 0.97\\
     \hline
     \multirow{2}{*}{\centering C+T+S} 
     & RAFT & 1.21 & 4.69 & 0.77 & 1.22 & 1.54 & 5.64 & 4.74\\
     & GMFlow & 1.53 & 4.09 & 0.95 & 1.28 & 3.04 & 13.61 & 5.49\\
     \hline
     \multirow{2}{*}{\centering C+T+S+B} 
     & RAFT & 1.35 & 6.44 & 0.90 & 1.49 & 1.81 & 6.27 & 0.92\\
     & GMFlow & 1.63 & 4.43 & 1.03 & 1.40 & 4.29 & 20.93 & 0.92\\
     \bottomrule
    \end{tabular}
    
    \label{table:results_optical_flow_pbgv}
\end{table}


\begin{table}[h]
    \small
    \centering
    \caption{Results on optical flow data (B) generated from \textbf{Flow Boiling- Inlet Velocity} simulations. It consists of around 1200 training image pairs and around 300 test image pairs.}
    \begin{tabular}{ccccccccc}
    \toprule
    \multirow{2}{*}{\centering Model} & \multirow{2}{*}{\centering Method} & \multirow{2}{*}{\centering Chairs(Val)} & Things(Val) & \multicolumn{2}{c}{Sintel(Train)} & \multicolumn{2}{c}{KITTI(Train)} & \multirow{2}{*}{\centering Boiling(Test)} \\
     \cmidrule(r){4-4}  \cmidrule(r){5-6}  \cmidrule(r) {7-8} 
      & & & Clean & Clean & Final & F1-EPE & F1-all & \\
    \midrule
     \multirow{2}{*}{\centering C} 
     & RAFT & 0.82 & 9.03 & 2.19 & 4.49 & 9.83 & 37.57 & 16.01\\
     & GMFlow & 0.92 & 10.23 & 3.22 & 4.43 & 17.82 & 56.14 & 21.44\\
     \hline
     \multirow{2}{*}{\centering C+B} 
     & RAFT & 1.21 & 14.99 & 3.62 & 6.78 & 22.07 & 60.64 & 10.13\\
     & GMFlow & 1.50 & 13.96 & 4.52 & 5.89 & 23.45 & 65.96 & 7.01\\
     \hline
     \multirow{2}{*}{\centering C+T} 
     & RAFT & 1.15 & 4.39 & 1.40 & 2.71 & 5.02 & 17.46 & 25.14\\
     & GMFlow & 1.26 & 3.48 & 1.50 & 2.96 & 11.60 & 35.62 & 19.39\\
     \hline
     \multirow{2}{*}{\centering C+T+B} 
     & RAFT & 1.62 & 9.09 & 2.19 & 3.77 & 13.81 & 32.13 & \textbf{9.19}\\
     & GMFlow & 1.45 & 4.15 & 1.78 & 3.05 & 15.74 & 48.34 & 7.24\\
     \hline
     \multirow{2}{*}{\centering C+T+S} 
     & RAFT & 1.21 & 4.69 & 0.77 & 1.22 & 1.54 & 5.64 & 21.23\\
     & GMFlow & 1.53 & 4.09 & 0.95 & 1.28 & 3.04 & 13.61 & 47.88\\
     \hline
     \multirow{2}{*}{\centering C+T+S+B} 
     & RAFT & 2.18 & 9.32 & 1.54 & 2.90 & 2.57 & 10.93 & 9.68\\
     & GMFlow & 1.72 & 4.80 & 1.18 & 1.65 & 4.69 & 24.56 & \textbf{6.88}\\
     \bottomrule
    \end{tabular}
    
    \label{table:results_optical_flow_fbiv}
\end{table}

\begin{table}[h]
    \small
    \centering
    \caption{Results on optical flow data (B) generated from \textbf{Flow Boiling- Gravity} simulations. It consists of around 1000 training image pairs and around 250 test image pairs.}
    \begin{tabular}{ccccccccc}
    \toprule
    \multirow{2}{*}{\centering Model} & \multirow{2}{*}{\centering Method} & \multirow{2}{*}{\centering Chairs(Val)} & Things(Val) & \multicolumn{2}{c}{Sintel(Train)} & \multicolumn{2}{c}{KITTI(Train)} & \multirow{2}{*}{\centering Boiling(Test)} \\
     \cmidrule(r){4-4}  \cmidrule(r){5-6}  \cmidrule(r) {7-8} 
      & & & Clean & Clean & Final & F1-EPE & F1-all & \\
    \midrule
     \multirow{2}{*}{\centering C} 
     & RAFT & 0.82 & 9.03 & 2.19 & 4.49 & 9.83 & 37.57 & 20.42\\
     & GMFlow & 0.92 & 10.23 & 3.22 & 4.43 & 17.82 & 56.14 & 14.05\\
     \hline
     \multirow{2}{*}{\centering C+B} 
     & RAFT & 1.14 & 12.65 & 3.30 & 6.13 & 17.94 & 53.76 & 4.45\\
     & GMFlow & 1.30 & 13.02 & 4.05 & 5.41 & 23.17 & 65.33 & 4.24\\
     \hline
     \multirow{2}{*}{\centering C+T} 
     & RAFT & 1.15 & 4.39 & 1.40 & 2.71 & 5.02 & 17.46 & 21.04\\
     & GMFlow & 1.26 & 3.48 & 1.50 & 2.96 & 11.60 & 35.62 & 13.37\\
     \hline
     \multirow{2}{*}{\centering C+T+B} 
     & RAFT & 1.41 & 6.85 & 1.97 & 3.89 & 10.96 & 27.82 & 4.24\\
     & GMFlow & 1.37 & 3.89 & 1.71 & 3.05 & 14.29 & 45.03 & 3.94\\
     \hline
     \multirow{2}{*}{\centering C+T+S} 
     & RAFT & 1.21 & 4.69 & 0.77 & 1.22 & 1.54 & 5.64 & 21.04\\
     & GMFlow & 1.53 & 4.09 & 0.95 & 1.28 & 3.04 & 13.61 & 22.84\\
     \hline
     \multirow{2}{*}{\centering C+T+S+B} 
     & RAFT & 1.59 & 7.29 & 1.13 & 2.14 & 2.22 & 9.34 & \textbf{4.12}\\
     & GMFlow & 1.62 & 4.42 & 1.04 & 1.43 & 3.86 & 17.76 & \textbf{3.93}\\
     \bottomrule
    \end{tabular}
    
    \label{table:results_optical_flow_fbgv}
\end{table}

% Figure environment removed

% Figure environment removed

% Figure environment removed

\textbf{Compute Resources}. All models are fine-tuned using a single NVIDIA V100 GPU. The implementations use the recommended versions of PyTorch and other libraries used in the official repositories of GMFlow and RAFT.

\clearpage