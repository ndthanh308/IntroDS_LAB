\documentclass[reprint, superscriptaddress, amsmath, amssymb, aps, showkeys, pra, floatfix, longbibliography]{revtex4-2}

\usepackage{graphicx}
\usepackage{dcolumn}
\usepackage{bm}
\usepackage{float}
\usepackage{siunitx}
\usepackage{multirow}
% \usepackage{microtype}
\usepackage[colorlinks=true, linkcolor=red, citecolor=blue]{hyperref}
\bibliographystyle{apsrev4-2}


\begin{document}
%--[TITLE and AUTHORS]--
\title{Theory of modulation instability in Kerr Fabry-Perot resonators beyond the mean field limit}
\author{Zoheir Ziani}\email{ziani.zoheir@gmail.com}
\author{Thomas Bunel}
\affiliation{University of Lille, CNRS, UMR 8523-PhLAM Physique des Lasers, Atomes et Molécules, F-59000, Lille, France}
\author{Auro M.~Perego}
\affiliation{Aston Institute of Photonic Technologies, Aston University, Birmingham, B4 7ET, UK}
\author{Arnaud Mussot}
\author{Matteo Conforti}\email{matteo.conforti@univ-lille.fr}
\affiliation{University of Lille, CNRS, UMR 8523-PhLAM Physique des Lasers, Atomes et Molécules, F-59000, Lille, France}
\date{\today}


%--[ABSTRACT and KEYWORDS]--
\begin{abstract}
    We analyse the nonlinear dynamics of Fabry-Perot cavities of arbitrary finesse filled by a dispersive Kerr medium, pumped by a continuous wave laser or a synchronous train of flat-top pulses.
    The combined action of feedback, group velocity dispersion and Kerr nonlinearity leads to temporal instability with respect to perturbations at specified frequencies.
    We characterize the generation of new spectral bands by deriving the exact dispersion relation, and we find approximate analytical expressions for the instabilities threshold and gain spectrum of modulation instability (MI).
    We show that, in contrast to ring-resonators, both the stationary solutions and the gain spectrum are dramatically affected by the duration of the pump pulse.
    We derive the extended Lugiato-Lefever equation for the Fabry-Perot resonator (FP-LLE) starting from coupled nonlinear Schr\"odinger equations (rather than Maxwell-Bloch equations), and we compare the outcome of the stability analysis of the two models.
    While FP-LLE gives overall good results, we show regimes that are not captured by the mean-field limit, namely the period-two modulation instability, which may appear in highly detuned or nonlinear regimes.
    We report numerical simulations of the generation of MI-induced Kerr combs by solving FP-LLE and the coupled Schr\"odinger equations.
\end{abstract}
\keywords{Nonlinear optics, Resonator, Modulation instability, Linear stability analysis, Frequency combs}
\maketitle

%--[INTRODUCTION]--
\section{Introduction}
Optical cavities have been a valuable tool for studying various nonlinear effects since the invention of lasers in the 1960s.
Bistability, self-pulsing, and modulation instabilities are some examples of these effects that have been observed experimentally and analyzed theoretically \cite{lugiato2015nonlinear}.
Most of the early theoretical studies were focused on ring cavities, where the light propagates only in one direction, simplifying considerably the analysis \cite{ikeda1979multiple}.

Nonetheless, Fabry-Perot (FP) cavities, where two distinct fields propagate simultaneously in the forward and backward directions, are exploited in many applications.
Nonlinear interaction of counterpropagating fields can lead to very complex dynamics, even in the absence of a cavity.
For instance, it has been demonstrated that counterpropagation and nonlinearity can cause transverse spatial~\cite{firth1988transverse1,firth1990transverse2,firth1990transverse3,firth1992diffractive,geddes1994hexagons} and temporal instabilities~\cite{law1989dispersion,law1991instabilities}.
In resonators, temporal instabilities may appear even in the absence of group velocity dispersion (GVD), and they were first studied in a ring cavity (the well known Ikeda instability)~\cite{ikeda1979multiple} and later in FP systems~\cite{firth1981stability,abraham1982self,silberberg1984optical}.
Despite several attempts, dispersive instabilities (or temporal MI) in FP cavities are not completely characterized yet~\cite{yu1998temporal1,yu1998temporal2,firth2021analytic}.
A complete theoretical analysis has been developed only in the good-cavity (also called mean-field) approximation.
A version of the Lugiato-Lefever equation generalised to FP resonators (FP-LLE) has been derived, which permits to identify  the peculiarity of the FP case in an additional detuning term depending on the average field power \cite{cole2018theory}.
Beyond the mean field limit, analytical expressions of the MI threshold have been obtained for a specific resonator where one of the mirror has reflectivity equal to one \cite{firth2021analytic}.

The pioneering work on optical frequency combs (OFC) by Braje \textit{et al}.~\cite{braje2009brillouin} and subsequent research by Obrzud \textit{et al}.~\cite{obrzud2017temporal} in fiber-based FP cavities have opened up a new field of research focused on the generation and manipulation of OFC~\cite{bunel2023observation,jia2020photonic,xiao2023near,nie2022synthesized,xiao2020deterministic,wildi2023dissipative}.
They offer a high degree of flexibility in terms of comb bandwidth and mode spacing.
However, despite the advantages of using FP cavities to produce OFC, the experimental results are often poorly understood due to the lack of available analytical treatments.
The ongoing efforts in this field aim at improving the understanding of the physics of OFC and pave the way for their broader use in a variety of applications.

The goal of this paper is to describe MI in a nonlinear FP cavity with an instantaneous Kerr nonlinearity, second order GVD, arbitrary mirror reflectivity and arbitrary detuning.
We derive the full complex dispersion relation for the perturbations, which permits to calculate the \emph{exact} MI gain spectrum. We provide simpler but extremely accurate formulas of the MI gain, which extend the recent results reported in \cite{firth2021analytic}.
We compare the outcomes of our analysis with the prediction of the mean-field approximation, and report numerical simulations of MI comb generation in fiber FP resonators.
The paper is organised as follows.
In Sec.~\ref{sec:model}, we review the basic equations that describe FP cavities and derive the expression for the stationary solutions.
Then, in Sec.~\ref{sec:LSA}, we perform a linear stability analysis and obtain the exact dispersion relation.
Using appropriate approximations, we determine the gain spectrum that characterizes the modulation instability of homogeneous solutions.
In Sec.~\ref{sec:pulses}, we study the effect of pulsed pump on the system response.
Finally, in Sec.~\ref{sec:results}, we show some typical examples where mean-field approximation breaks down.
Conclusions are drawn in Sec.~\ref{sec:conclusion}.

%--[BASIC EQUATION SECTION]--
\section{Fabry-Perot cavity description}\label{sec:model}

% Figure environment removed

We consider a FP cavity of length $L$, filled with a nonlinear Kerr medium (see Fig.~\ref{fig:FP_cavity}).
A pump field $E_{in}$ enters at $z = 0$ through a mirror of reflectivity $\rho_1$ and drives forward $F(z, t)$ and backward $B(z, t)$ fields in the cavity.
A transmitted field $E_{out}$ exits the cavity through the second mirror of reflectivity $\rho_2$ at $z = L$.
The evolution of the two counterpropagating waves is described by a set of two coupled nonlinear Schrodinger equations~\cite{firth1981stability,firth2021analytic}~:
\begin{subequations}\label{eq:FP_2NLS}
    \begin{eqnarray}
        \frac{\partial F}{\partial z} + \beta_1 \frac{\partial F}{\partial t} + i\frac{\beta_2}{2}\frac{\partial^2 F}{\partial t^2} &=& i\gamma ( |F|^2 + G |B|^2)F\;,\label{eq:FP_2NLS_a}\\
        -\frac{\partial B}{\partial z} + \beta_1 \frac{\partial B}{\partial t} + i\frac{\beta_2}{2}\frac{\partial^2 B}{\partial t^2} &=& i\gamma ( |B|^2 + G |F|^2)B. \label{eq:FP_2NLS_b}
    \end{eqnarray}
\end{subequations}
where $\beta_1^{-1} = v_g$, is the group velocity, $\beta_2$ is the group-velocity dispersion coefficient, $\gamma$ is the nonlinear parameter and $G=2$ is the grating-parameter which describe cross-phase modulation (XPM).
The governing equations are supplemented with appropriate boundary conditions at the left and right mirrors~:
\begin{subequations}\label{eq:FP_BC}
    \begin{eqnarray}
        F(0,t) &=& \theta_1 E_{in}(t) + \rho_1 B(0,t)\;,\label{eq:FP_BC_a}\\
        B(L,t) &=& \rho_2 e^{i\phi_0} F(L,t).\label{eq:FP_BC_b}
    \end{eqnarray}
\end{subequations}
where the linear cavity phase $\phi_0$ account for the phase acquired during the propagation $2\beta_0L$ ($\beta_0$ is the propagation constant) and any possible contribution from the mirrors, modulo $2\pi$.
Thus $-\pi\leq\phi_0\leq\pi$, and we can introduce the cavity detuning as $\delta=-\phi_0$.
The transmitted field $E_{out}$ may be expressed as~:
\begin{equation}
    E_{out}(t) =  \theta_2 F(L,t).
\end{equation}
Thereafter, we assume that the reflectivity and the transmissivity of the mirrors are real and verify $\theta_{1,2}^2 + \rho_{1,2}^2 = 1$.
By taking $G=0$ and $\rho_2=1$, Eqs.~(\ref{eq:FP_2NLS}) and (\ref{eq:FP_BC}) model a ring-cavity of length $2L$.

Equations (\ref{eq:FP_2NLS_a}-\ref{eq:FP_BC_b}) have continuous wave (time-independent) solutions which are obtained by setting the time derivatives in (\ref{eq:FP_2NLS}) equal to zero and $E_{in}(t)$ constant ~\cite{firth1981stability,ogusu1998analysis,yu1998temporal2,firth2021analytic}.
They are of the form~:
\begin{subequations}
    \begin{eqnarray}
        F(z) &=& F_0 e^{+i\gamma (|F_0|^2 + G|B_0|^2)z} \equiv F_0 e^{i\phi_F z}\;, \\
        B(z) &=& B_0 e^{-i\gamma (|B_0|^2 + G|F_0|^2)z} \equiv B_0 e^{i\phi_B z}.
    \end{eqnarray}
\end{subequations}
Using (\ref{eq:FP_BC}) we find~:
\begin{subequations}\label{eq:FP_SS}
    \begin{eqnarray}
        F_0 &=& \frac{\theta_1 E_{in}}{1-\rho_1\rho_2 \exp{[i(\phi_0+\phi_{NL})}]}\;,\\
        B_0 &=& \rho_2 \exp{[i(\phi_0+\phi_{NL})]}F_0.
    \end{eqnarray}
\end{subequations}
where the nonlinear phase is given by~:
\begin{equation}
    \phi_{NL} = \gamma (1+\rho_2^2)(1+G)L |F_0|^2.
\end{equation}
From Eqs.~(\ref{eq:FP_SS}) we obtain the input power $P_{in}=|E_{in}|^2$ as a function of the intracavity forward power $P_F = |F_0|^2$~:
\begin{equation}\label{eq:SS_power}
    P_{in} = \frac{P_F}{\theta_1^2} \left( 1 + (\rho_1\rho_2)^2 -2\rho_1\rho_2 \cos(\phi_0 + \phi_{NL})\right).
\end{equation}
From Eq.~(\ref{eq:SS_power}) we find that the cavity finesse, i.e. the ratio between the line-width and the free spectral range (FSR) is given by  $\mathcal{F}=\dfrac{\pi\sqrt{\rho_1\rho_2}}{1-\rho_1\rho_2}$.

%--[LINEAR STABILITY ANALYSIS]--
\section{Linear stability analysis}\label{sec:LSA}

\subsection{General dispersion relation}
Stability of the steady state is examined assuming a time-dependent solution of the form~:
\begin{subequations}
    \begin{eqnarray}
        F(z,t) &=& F_0 (1 + f(z,t)) e^{i\phi_F z}\;,\\
        B(z,t) &=& B_0 (1 + b(z,t)) e^{i\phi_B z}\;,
    \end{eqnarray}
\end{subequations}
where $f$ and $b$ are small perturbations.
The linearized propagation equations for the perturbations read as~:
\begin{subequations}\label{eq:linearized_eqs}
\begin{eqnarray}
    \frac{\partial f}{\partial z} + \beta_1 \frac{\partial f}{\partial t} + i\frac{\beta_2}{2}\frac{\partial^2 f}{\partial t^2} &=&2i\gamma P_F \Re\left( f + \rho_2^2 G b\right),\\
    -\frac{\partial b}{\partial z} + \beta_1 \frac{\partial b}{\partial t} + i\frac{\beta_2}{2}\frac{\partial^2 b}{\partial t^2} &=&2i\gamma P_F \Re\left( G f + \rho_2^2 b \right).
\end{eqnarray}
\end{subequations}
$\Re$ stands for the real part.
From Eqs.~(\ref{eq:FP_BC}), we find the following boundary conditions for $f$ and $b$~:
\begin{subequations}
    \begin{eqnarray}
        f(0,t) &=& \rho_1\rho_2 e^{i\phi} b(0,t)\;,\\
        f(L,t) &=& b(L,t),
    \end{eqnarray}
\end{subequations}
where $\phi = \phi_0+\phi_{NL}$.
We write the perturbation in the following form~:
\begin{subequations}\label{eq:perturbation_forms}
    \begin{eqnarray}
        f(z,t) &=& f_+(z) e^{\lambda t} + f_-^*(z) e^{\lambda^* t}\;, \\
        b(z,t) &=& b_+(z) e^{\lambda t} + b_-^*(z) e^{\lambda^* t}.
    \end{eqnarray}
\end{subequations}
The real and imaginary parts of $\lambda=\sigma+i\omega$ defines the temporal growth rate and the frequency of the perturbations.
By inserting Eqs.~(\ref{eq:perturbation_forms}) in Eqs.~(\ref{eq:linearized_eqs}), we find that the four complex amplitudes $f_\pm$, $b_\pm$ of the perturbations obey the following system of ordinary differential equations~:
\begin{equation}\label{eq:MED}
    \frac{d}{d z}
    \begin{pmatrix}
        f_+(z) \\ f_-(z) \\b_+(z) \\b_-(z)
    \end{pmatrix}
    =
    \mathcal{M}
    \begin{pmatrix}
        f_+(z) \\ f_-(z) \\b_+(z) \\b_-(z)
    \end{pmatrix}
\end{equation}
where
\begin{align*}
&\mathcal{M} = \\
&i\gamma P_F
\begin{pmatrix}
    1+i\frac{\psi_+}{\gamma P_F} & 1 & G\rho_2^2 & G\rho_2^2 \\
    -1 & -1+i\frac{\psi_-}{\gamma P_F} & -G \rho_2^2 & -G\rho_2^2 \\
    -G & -G & -\rho_2^2-i\frac{\psi_+}{\gamma P_F} & -\rho_2^2 \\
    G & G & \rho_2^2 & \rho_2^2-i\frac{\psi_-}{\gamma P_F}
\end{pmatrix} ,
\end{align*}
with $\psi_\pm = \beta_1\lambda \pm i\dfrac{\beta_2}{2}\lambda^2$.
The growth rate $\sigma$ and the frequency $\omega$ of the perturbations are found by imposing the following boundary conditions~:
\begin{subequations}\label{eq:perturbation_forms2}
    \begin{eqnarray}
        f_\pm(L) &=& b_\pm(L)\;,\\
        f_\pm(0) &=& \rho_1\rho_2 e^{\pm i\phi} b_\pm(0).
    \end{eqnarray}
\end{subequations}
The matrix differential equation~(\ref{eq:MED}) is linear and homogeneous, so it can be solved by standard methods (e.g. matrix exponential).
However, the analytic expressions are very cumbersome since they depends on the roots of a general 4th order polynomial. 
The eigenvalues $\eta_j$ ($j=1-4$) of $\mathcal{M}$ are given by the roots of the characteristic polynomial~:
\begin{equation}
    \eta_j^4 + a_2 \eta_j^2 + a_1 \eta_j + a_0 = 0
\end{equation}
where
% \newpage\vspace*{-1cm}
\begin{eqnarray*}
    a_2 &=& \frac{\beta_2^2}{2}\lambda^4-2\beta_1^2\lambda^2-\gamma P_F (1+\rho_2^2)\beta_2\lambda^2\;,\\
    a_1 &=& 2\gamma P_F \beta_1\beta_2 (1-\rho_2^2)\lambda^3\;\\
    a_0 &=& \frac{\beta_2^4}{16}\lambda^8 + \frac{\beta_2^2}{4} (2\beta_1^2-\gamma P_F (1+\rho_2^2)\beta_2 )\lambda^6 \\
    & & + (\beta_1^4 -\gamma P_F \beta_1^2\beta_2 (1+\rho_2^2) -\gamma^2 P_F^2 \rho_2^2 (G^2-1)\beta_2^2)\lambda^4.
\end{eqnarray*}
The solution of Eqs.~(\ref{eq:MED}) can be expressed in terms of eigenvalues and eigenvectors of $\mathcal{M}$~:
\begin{equation}\label{eq:LSA_solution}
        (f_+, f_-, b_+, b_-)^T  = \sum_{j=1}^4 c_j e^{\eta_j z} \textbf{u}_j,
\end{equation}
where $\textbf{u}_j =(u_{j,1},u_{j,2},u_{j,3},u_{j,4})^T$ are the eigenvectors of $\mathcal{M}$.
The four arbitrary constants $c_j$ are determined by the boundary conditions.
\begin{widetext}
    \noindent Indeed, by inserting Eq.~(\ref{eq:LSA_solution}) in Eq.~(\ref{eq:perturbation_forms2}), we obtain a system of algebraic equations $\mathcal{N} (c_1,c_2,c_3,c_4)^T = 0$, where
    \begin{equation}
        \mathcal{N} = 
        \begin{pmatrix}
            (u_{1,1}-u_{1,3})e^{\eta_1 L} &  (u_{2,1}-u_{2,3})e^{\eta_2 L} & (u_{3,1}-u_{3,3})e^{\eta_3 L} & (u_{4,1}-u_{4,3})e^{\eta_4 L} \\
            (u_{1,2}-u_{1,4})e^{\eta_1 L} &  (u_{2,2}-u_{2,4})e^{\eta_2 L} & (u_{3,2}-u_{3,4})e^{\eta_3 L} & (u_{4,2}-u_{4,4})e^{\eta_4 L} \\
            u_{1,1}-\rho_1\rho_2 e^{+i\phi} u_{1,3} & u_{2,1}-\rho_1\rho_2 e^{+i\phi} u_{2,3} & u_{3,1}-\rho_1\rho_2 e^{+i\phi} u_{3,3} & u_{4,1}-\rho_1\rho_2 e^{+i\phi} u_{4,3} \\
            u_{1,2}-\rho_1\rho_2 e^{+i\phi} u_{1,4} & u_{2,2}-\rho_1\rho_2 e^{+i\phi} u_{2,4} & u_{3,2}-\rho_1\rho_2 e^{+i\phi} u_{3,4} & u_{4,2}-\rho_1\rho_2 e^{+i\phi} u_{4,4} 
        \end{pmatrix}.
    \end{equation}
    In order to have a nontrivial solution, we must impose determinant of $\mathcal{N}$ to be zero, which yields~:
    \begin{equation}\label{eq:FP_DR_general}
        \det \mathcal{N}= C_{1,2} e^{(\eta_1+\eta_2)L} + C_{1,3} e^{(\eta_1+\eta_3)L} + C_{1,4} e^{(\eta_1+\eta_4)L} + C_{2,3} e^{(\eta_2+\eta_3)L} + C_{2,4} e^{(\eta_2+\eta_4)L} + C_{3,4} e^{(\eta_3+\eta_4)L} = 0,
    \end{equation}
    where
    \begin{eqnarray*}
        C_{1,2} &=& +[ u_{3,1}u_{4,2} -u_{3,2}u_{4,1} +\rho_1^2\rho_2^2 (u_{3,3}u_{4,4}-u_{3,4}u_{4,3}) -\rho_1\rho_2 \left( (u_{3,1}u_{4,4}-u_{3,4}u_{4,1})e^{-i\phi} -(u_{3,2}u_{4,3}-u_{3,3}u_{4,2})e^{+i\phi}\right)] \sigma_{1,2}\;\\
        C_{1,3} &=& -[ u_{2,1}u_{4,2} -u_{2,2}u_{4,1} +\rho_1^2\rho_2^2 (u_{2,3}u_{4,4}-u_{2,4}u_{4,3}) -\rho_1\rho_2 \left( (u_{2,1}u_{4,4}-u_{2,4}u_{4,1})e^{-i\phi} -(u_{2,2}u_{4,3}-u_{2,3}u_{4,2})e^{+i\phi}\right)] \sigma_{1,3}\;\\
        C_{1,4} &=& +[ u_{2,1}u_{3,2} -u_{2,2}u_{3,1} +\rho_1^2\rho_2^2 (u_{2,3}u_{3,4}-u_{2,4}u_{3,3}) -\rho_1\rho_2 \left( (u_{2,1}u_{3,4}-u_{2,4}u_{3,1})e^{-i\phi} -(u_{2,2}u_{3,3}-u_{2,3}u_{3,2})e^{+i\phi}\right)] \sigma_{1,4}\;\\
        C_{2,3} &=& +[ u_{1,1}u_{4,2} -u_{1,2}u_{4,1} +\rho_1^2\rho_2^2 (u_{1,3}u_{4,4}-u_{1,4}u_{4,3}) -\rho_1\rho_2 \left( (u_{1,1}u_{4,4}-u_{1,4}u_{4,1})e^{-i\phi} -(u_{1,2}u_{4,3}-u_{1,3}u_{4,2})e^{+i\phi}\right)] \sigma_{2,3}\;\\
        C_{2,4} &=& -[ u_{1,1}u_{3,2} -u_{1,2}u_{3,1} +\rho_1^2\rho_2^2 (u_{1,3}u_{3,4}-u_{1,4}u_{3,3}) -\rho_1\rho_2 \left( (u_{1,1}u_{3,4}-u_{1,4}u_{3,1})e^{-i\phi} -(u_{1,2}u_{3,3}-u_{1,3}u_{3,2})e^{+i\phi}\right)] \sigma_{2,4}\;\\
        C_{3,4} &=& +[ u_{1,1}u_{2,2} -u_{1,2}u_{2,1} +\rho_1^2\rho_2^2 (u_{1,3}u_{2,4}-u_{1,4}u_{2,3}) -\rho_1\rho_2 \left( (u_{1,1}u_{2,4}-u_{1,4}u_{2,1})e^{-i\phi} -(u_{1,2}u_{2,3}-u_{1,3}u_{2,2})e^{+i\phi}\right)] \sigma_{3,4}\;\\
    \end{eqnarray*}
\end{widetext}
and
\begin{equation*}
    \sigma_{i,j} = (u_{i,1}-u_{i,3})(u_{j,2}-u_{j,4})-(u_{j,1}-u_{j,3})(u_{i,2}-u_{i,4}).
\end{equation*}
The dispersion relation given Eq.~(\ref{eq:FP_DR_general}) is a complicated nonlinear equation in the complex variable $\lambda =\sigma+i\omega$.
Even if we are not able to solve it analytically, it can be solved numerically \footnote{We found more convenient to calculate the eigenvectors of matrix $\mathcal{M}$ numerically. In order to avoid numerical instabilities, we have used the Matlab built-in function \texttt{eig} by explicitly choosing the algorithm used, i.e. \texttt{[V,D] = eig(M,eye(4),'chol')}}.
Its solutions in the complex $\lambda$-plane give the growth rate and the frequency of the possibly unstable perturbations.

\subsection{Approximate solutions}\label{sec:approx_sols}
The solution of Eqs.~(\ref{eq:MED}) is greatly simplified if $\beta_2 = 0$ or if $G = 0$.
For the dispersion-less case, we obtain the same results of Firth~\cite{firth1981stability} (calculation not reported here).
For the dispersive case, in order to achieve reasonably simple analytical expressions, we assume $G=0$ in Eqs.~(\ref{eq:MED}) only.
It amounts to suppressing the linear coupling between the perturbations components in the propagation equations.
Nonetheless, the coupling is maintained in the boundary conditions via the total phase $\phi$.
This approximation is physically sound~: the main coupling between forward and backward perturbations takes place at the mirrors.
We also maintain $G\neq 0$ in the steady state, meaning that the perturbations propagate on top of the correct steady state.
Following similar arguments, the same approximation has been used in \cite{yu1998temporal1,yu1998temporal2,firth2021analytic}.

Solving Eqs.~(\ref{eq:MED}) with $G=0$ and using the same approach as before, we find the following characteristic equation~:
\begin{equation}\label{eq:FP_approx}
    e^{2\lambda t_R} -\Delta(\lambda)e^{\lambda t_R} + (\rho_1\rho_2)^2 = 0\;,
\end{equation}
where $t_R =2\beta_1L$ is the roundtrip time and
\begin{eqnarray*}
    \Delta(\lambda) &=& \rho_1\rho_2 [a(\lambda)\cos\phi + b(\lambda)\sin\phi]
\end{eqnarray*}
with 
\begin{eqnarray*}
    a(\lambda) &=& 2\cos(kL)\cos(k_\rho L) - \frac{k^2+k_\rho^2}{k k_\rho} \sin(kL)\sin(k_\rho L)\;,\\
    b(\lambda) &=& \frac{4k^2+\beta_2^2\lambda^4}{2\beta_2\lambda^2k}\cos(k_\rho L)\sin(kL) \\ 
    & &\hskip0.1\textwidth+\frac{4k_\rho^2+\beta_2^2\lambda^4}{2\beta_2\lambda^2k_\rho}\cos(k L)\sin(k_\rho L),
\end{eqnarray*}
and
\begin{align}\label{eq:k_omega}
    \nonumber k^2 &= \frac{\beta_2\lambda^2}{2} \left(\frac{\beta_2\lambda^2}{2}-2\gamma P_F \right)\;, \\ 
    k_\rho^2 &= \frac{\beta_2\lambda^2}{2} \left(\frac{\beta_2\lambda^2}{2}-2\gamma P_F\rho_2^2 \right).
\end{align}
Even if the structure of Eq.~(\ref{eq:FP_approx}) appears to be quite simple, it may admit an infinite number of solutions, since the discriminant depends on $\lambda$.
We may also remark that Eq.~(\ref{eq:FP_approx}) is equivalent to the following two equations~:
\begin{equation}
    e^{\lambda t_R} = \frac{\Delta(\lambda)}{2} \pm \sqrt{\frac{\Delta^2(\lambda)}{4}-(\rho_1\rho_2)^2}.
\end{equation}
From the analysis of the dispersion-less case~\cite{firth1981stability}, we have learned that $\omega t_R = m \pi$ at threshold ($\sigma=0$).
It is worth note that the frequencies of the perturbations at threshold correspond either to cavity resonances ($m$ even) or they are in between ($m$ odd, anti-resonance).
For $\sigma=0$, Eq.~(\ref{eq:FP_approx}) reads as
\begin{equation}
    1 - (-1)^m \Delta + (\rho_1\rho_2)^2 =0,
\end{equation}
which gives the analytic threshold expression 
\begin{equation}\label{eq:MI_thresholds}
    \tilde{a}(\omega) \cos\phi + \tilde{b}(\omega)\sin\phi = (-1)^m \frac{1 + (\rho_1\rho_2)^2}{\rho_1\rho_2},
\end{equation}
where $\tilde{a}(\omega) = a(\lambda=i\omega)$ and $\tilde{b}(\omega) = b(\lambda=i\omega)$.
By taking $\rho_2 = 1$, we recover the main result of \cite{firth2021analytic} in which the authors used the gain-circle method to find the threshold formula for zero-transmission case.

% Figure environment removed

Numerical solution of Eq.~(\ref{eq:FP_approx}), shows that $\omega t_R \approx m \pi$ approximately holds even when $\sigma\neq0$ with great precision.
Moreover, we may assume that the frequency of the perturbation is much greater than its growth rate, i.e. $\omega \gg \sigma$. We thus write Eq.~(\ref{eq:FP_approx}) in the form
\begin{equation}
    e^{2\sigma t_R} -(-1)^m \tilde\Delta(\omega)e^{\sigma t_R} + (\rho_1\rho_2)^2 = 0,
\end{equation}
with $\tilde\Delta(\omega)=\Delta(\lambda=0+i\omega)$.

It is now straightforward to calculate the growth rate of the perturbations as a function of the frequency,~i.e.~$\sigma(\omega)$
\begin{equation}
    e^{\sigma t_R} = (-1)^m \frac{\tilde\Delta(\omega)}{2} \pm \sqrt{\frac{\tilde\Delta^2(\omega)}{4}-(\rho_1\rho_2)^2}.
\end{equation}
In order to observe MI, we must have $\sigma>0$, so we have the following conditions
\begin{eqnarray}
(-1)^m \tilde\Delta(\omega) >1 +(\rho_1\rho_2)^2,
\end{eqnarray}
and
\begin{equation}\label{eq:str}
    \sigma t_R = \ln\left((-1)^m\frac{\tilde\Delta}{2}+ \sqrt{\frac{\tilde\Delta^2}{4}-(\rho_1\rho_2)^2} \right)
\end{equation}
We can define the MI gain $g(\omega)$ as the spatial growth rate~:
\begin{equation}\label{eq:FP_gain}
    g(\omega) = \frac{\sigma t_R}{2L} = \frac{1}{2L} \ln \max \left|\frac{\tilde\Delta}{2}\pm \sqrt{\frac{\tilde\Delta^2}{4}-(\rho_1\rho_2)^2}\right|
\end{equation}
We recognize in Eq.~(\ref{eq:FP_gain}) the MI gain of a ring cavity of length $2L$ composed of two identical pieces of fiber of length $L$~\cite{conforti2016parametric} connected by an input coupler ($\theta_1$,$\rho_1$), and a tap coupler ($\theta_2$,$\rho_2$) as illustrated in Fig.~\ref{fig:ring_resonator} (See Appendix~\ref{sec:ringMI} for details).

% Figure environment removed

We verified that the approximation Eq.~(\ref{eq:FP_gain}) is extremely precise.
As an example, we report in Fig.~\ref{fig:exactMIgain} the comparison between the exact and the approximated MI gain for a fiber FP resonator with an anomalous dispersion fiber and operating in the monostable regime (parameters are reported in the figure's caption).
Figure~\ref{fig:exactMIgain}(a) shows the steady-state curve Eq.~(\ref{eq:SS_power}), the working point being denoted with a red star.
Figure~\ref{fig:exactMIgain}(b) shows the approximated MI gain from Eq.~(\ref{eq:FP_gain}) (blue curve) and the exact gain from numerical solution of Eq.~(\ref{eq:FP_DR_general}) (black circles).
The circles are perfectly superposed to the continuous line: there is no visible difference between the two models.
Indeed, we have found that for all our test the exact and the approximated model give essentially identical results.
Of course, the approximated model does not predict the frequencies of the perturbations, because here $\omega$ is a continuous, independent variable.

Two examples of the graphical solution of Eq.~(\ref{eq:FP_DR_general}) are shown in Fig.~\ref{fig:exactMIgain}(c,d).
Blue and red curves represent $\Re(\det \mathcal{N})=0$ and $\Im(\det \mathcal{N})=0$ in the complex $\lambda$-plane.
As a general feature, the curve $\Im(\det \mathcal{N})=0$ is essentially composed of an horizontal line with $\sigma<0$ and a set of vertical lines at $\omega t_R\approx m\pi$.
The solutions are marked by solid black dots.
Figure~\ref{fig:exactMIgain}(c) shows two solutions with $\sigma<0$, meaning that the perturbations at the corresponding frequency $\omega$ are stable.
Whereas, Fig.~\ref{fig:exactMIgain}(d) shows two solutions which share almost the same frequency, (they are slightly different and very close to a cavity resonance $\omega t_R=2m\pi$) but opposite $\sigma$.
The fact that one solution has $\sigma>0$ implies that the perturbation at this frequency is unstable.

\subsection{The good-cavity limit: FP-LLE} \label{sec:FPLLE}
When the mirror reflectivities are high and the cavity detuning is small, it is possible to obtain a mean-field description of the dynamics, which generalises the celebrated Lugiato-Lefever equation (LLE) originally derived for the ring resonators \cite{lugiato1987spatial,haelterman1992additive} to FP cavities.
Cole \textit{et~al}.~\cite{cole2018theory} derived this FP-LLE starting form Maxwell-Bloch equations, while Xiao \textit{et al}.~\cite{xiao2020deterministic} also arrived at the same equation from coupled mode theory.
In appendix~\ref{sec:LLE}, we report an alternative derivation of the FP-LLE, which uses the coupled NLS equations~(\ref{eq:FP_2NLS}) as the starting point.
Besides being more suited to fiber-based FP resonators, our derivation is more general as it considers unequal mirror reflectivities and pulsed pumping. 
The FP-LLE reads as~:
\begin{align}
  \nonumber  & t_R \frac{\partial \psi}{\partial \tau} = (-\alpha +i\phi_0)\psi + \theta_1 E_{in} \\
  &+ 2L \left[ -i\frac{\beta_2}{2}\frac{\partial^2}{\partial t^2} +i\gamma |\psi|^2 +i\gamma\frac{G}{t_R} \int_{-t_R/2}^{t_R/2}|\psi|^2dt\right] \psi, \label{eq:FP_LLE}
\end{align}
where $\psi(\tau,t)$ is the field envelope inside the cavity, $\alpha~=~1-\rho_1\rho_2$ is the cavity loss, $t \in [-t_R/2, t_R/2]$ denotes the fast time in one cavity roundtrip and $\tau$ is a slow time.

The homogeneous solutions $\psi_s$ are found by setting the derivatives in Eq.~(\ref{eq:FP_LLE}) equal to zero. 
We obtain that the power of the stationary solutions is given by the solutions of the cubic following equation~:
\begin{equation}\label{eq:LLE_SS}
    \theta_1^2 P_{in} = P_s \left( \alpha^2 + (\phi_0 + 2\gamma L (1+G)P_s )^2 \right),
\end{equation}
where $P_s=|\psi_s|^2$ and $P_{in}=|E_{in}|^2$.
We can assume $\psi_s$ real without loss of generality, which implies that the input field must be complex and can be written as~:
\begin{equation}
    \theta_1 E_{in} = \psi_s ( \alpha -i(\phi_0+2\gamma L (1+G)P_s ) ).
\end{equation}

To study the stability of these solutions, we perform a linear stability by considering a perturbed solution of the form $\psi(t,\tau) = \psi_s + \xi(\tau,t)$.
Assuming $\xi\ll\psi_s$ small, we obtain
\begin{align}
 \nonumber   & t_R \frac{\partial \xi}{\partial \tau} = (-\alpha+i\phi_0)\xi -iL\beta_2 \frac{\partial^2 \xi}{\partial t^2} + \\
 & 2i\gamma L P_s\left( (2+G)\xi + \xi^* + \frac{G}{t_R} \int_{-t_R/2}^{t_R/2}(\xi+\xi^*)dt\right).
\end{align}
We now expand the perturbation over the cavity modes with time-varying amplitudes~:
\begin{equation}
    \xi(\tau,t) = \varepsilon_n(\tau)e^{i\omega_n t} + \varepsilon_{-n}(\tau)e^{-i\omega_n t},
\end{equation}
with $\omega_n=n2\pi/t_R$.
The amplitudes of the modal perturbations obey
\begin{subequations}\label{eq:LLE_LS_LE}
    \begin{align}
       \nonumber & t_R\frac{d \varepsilon_n}{d\tau} = (-\alpha+i\phi_0)\varepsilon_n +iL\beta_2\omega_n^2 \varepsilon_n \\
        & +2i\gamma L P_s ( (2+G)\varepsilon_n + \varepsilon_{-n}^*) + 2i\gamma L P_s G (\varepsilon_n + \varepsilon_{-n}^*)\delta_{n0}\\
       \nonumber  & t_R\frac{d \varepsilon_{-n}^*}{d\tau} = (-\alpha-i\phi_0)\varepsilon_{-n}^* +iL\beta_2\omega_n^2 \varepsilon_{-n}^* \\
        &-2i\gamma L P_s ( (2+G)\varepsilon_{-n}^* + \varepsilon_n) - 2i\gamma L P_s G (\varepsilon_n + \varepsilon_{-n}^*)\delta_{n0}
    \end{align}
\end{subequations}
where $\delta_{n0}$ is the Kröneker delta.
The last terms in Eqs.~(\ref{eq:LLE_LS_LE}), which appears only for the zero mode, stem from the integral term which do not average zero as in the case $n\neq 0$.
This contribution is not present for the ring cavity, for which $G=0$.
The system~(\ref{eq:LLE_LS_LE}) can be written as $d/d\tau(\varepsilon_n, \varepsilon_{-n}^*)^T = M_n (\varepsilon_n, \varepsilon_{-n}^*)^T$, and the eigenvalues of the matrix $M_n$ determine the stability of the solution.
The temporal growth rate of the perturbations for $n\neq 0$ reads~:
\begin{equation}\label{eq:FP_LLE_gain}
    \sigma(\omega_n) = \frac{1}{t_R} (-\alpha + \sqrt{(2\gamma L P_s)^2 -\mu_n^2}),
\end{equation}
where $\mu_n = \phi_0 +L\beta_2\omega_n^2 + 2(2+G)\gamma L P_s$.
The temporal growth can be written as a spatial gain as $g(\omega_n) = \beta_1 \sigma(\omega_n)$.
The most unstable mode, obtained for $\mu_n =0$, and its growth rate are
\begin{equation}\label{eq:FP_LLE_gmax}
    \omega_{\Bar{n}}^2 =-\frac{\phi_0+2(2+G)\gamma L P_s}{\beta_2 L}\, \quad\text{and} \quad g_{max} =  \frac{-\alpha +2\gamma L P_s}{2L},
\end{equation}
where we considered $\omega_n$ as a continuous variable.
We can thus interpret the condition $\mu_n=0$ as a phase-matching relation that maximises the energy transfer from the pump to the perturbations.

For the zero mode we have
\begin{equation}\label{eq:LLE_mode0}
    \sigma(0) = \frac{-\alpha + \sqrt{(2\gamma L P_s (1+G))^2 -(\phi_0+4(1+G)\gamma L P_s)^2}}{t_R}.
\end{equation}
The condition for reality of Eq.~(\ref{eq:LLE_mode0}) coincides with the negative slope branch of Eq.~(\ref{eq:LLE_SS}), i.e. the homogeneous solution is unstable if $P^-<P_s<P^+$, where 
\begin{equation}\label{eq:LLE_BS}
    P^\pm = \frac{-2\phi_0 \pm \sqrt{\phi_0^2-3\alpha^2}}{6(1+G)\gamma L}.
\end{equation}
The unstable region obtained by letting $\omega_n \rightarrow 0$ in Eq.~(\ref{eq:FP_LLE_gain}) is different and the limits are given by 
\begin{equation}\label{eq:LLE_MI_NZ}
    \Tilde{P}^\pm = \frac{-(2+G)\phi_0 \pm \sqrt{\phi_0^2 -((2+G)^2-1)\alpha^2}}{2((2+G)^2-1)\gamma L}.
\end{equation}
Eqs.~(\ref{eq:LLE_MI_NZ}) and (\ref{eq:LLE_BS}) coincides for $G=0$, i.e. the ring cavity, where the instability of the homogeneous state coincides with the low-frequency limit of the modulationally unstable branch.
This peculiarity of FP resonator has been first pointed out in \cite{cole2018theory}.

% Figure environment removed

In order to illustrate the results of linear stability analysis of models Eqs.~(\ref{eq:FP_2NLS}) and (\ref{eq:FP_LLE}), we consider for definiteness a fiber FP resonator, whose parameters are reported in Fig.~\ref{fig:SS_gS} caption.
Fig.~\ref{fig:SS_gS}(a,b) demonstrate examples of the intracavity steady state power obtained from Eq.~(\ref{eq:SS_power}) as a function of pump power and linear phase cavity, respectively.
The corresponding FP-LLE curves obtained from Eq.~(\ref{eq:LLE_SS}) are almost superimposed and they are not shown in order to make the figures more readable.
As usual, the nonlinear phase shift acquired by the intracavity field does not impact the resonance width, but it does tilt the resonance (see Fig.~\ref{fig:SS_gS}(b)).
If input power and cavity finesse are high enough, the resonances become increasingly tilted, resulting in a multivalued cavity response.
At certain values of $\phi_0$, the cavity can operate in a bistable regime, as shown in Fig.~\ref{fig:SS_gS}(a).
Fig.~\ref{fig:SS_gS}(c) displays the gain of MI calculated from Eq.~(\ref{eq:FP_gain}) for anomalous GVD regime, as a function of the mode frequencies and the intracavity forward field power $P_F$.
Also in this case the results obtained from FP-LLE Eq.~(\ref{eq:LLE_SS}) are practically identical (figure not shown).
Modulationally unstable steady states are represented by a dashed curve in Fig.~\ref{fig:SS_gS}(a) and Fig.~\ref{fig:SS_gS}(b).
Steady states which are unstable with respect to perturbations at zero frequency, corresponding to the negative-slope branch of the bistable response, are displayed in dotted curve.
One noteworthy characteristic of FP is that MI does not fully cover the CW unstable region, as it is the case for the ring cavity.
Fig.~\ref{fig:SS_gS}(d) exhibits an example of gain spectrum obtained from equations (\ref{eq:FP_DR_general}), (\ref{eq:FP_gain}) and (\ref{eq:FP_LLE_gain}).
The agreement between the different methods is perfect, even if the cavity's finesse is not very high.
This example shows that FP-LLE is a valuable tool for the description of MI in FP resonators.
However, the mean field model fails to describe some particular regimes, as it will be shown later.

%--[PULSED PUMP]--
\section{Pulsed pump}\label{sec:pulses}

\subsection{Stationary periodic solutions}
In this section we consider a pulsed pump with a repetition rate that matches the roundtrip time, meaning that $E_{in}(t+t_R)=E_{in}(t)$ is a periodic function. 
Equations~(\ref{eq:FP_2NLS}, \ref{eq:FP_BC}) can be analytically solved if dispersion is neglected ($\beta_2=0$)~\cite{firth1981stability}.
The solution can be written in implicit form as
\begin{align}\label{eq:solFBzt}
    \nonumber F(z,t)&=F(0,t-\beta_1 z)\exp\bigg[i\gamma|F(0,t-\beta_1 z)|^2z\\
    \nonumber &+i\gamma G\int_0^z|B(s,t-\beta_1 z+\beta_1s)|^2ds\bigg],\\
    \nonumber B(z,t)&=B(0,t+\beta_1 z)\exp\bigg[-i\gamma|B(0,t+\beta_1 z)|^2z\\
    &-i\gamma G\int_0^z|F(s,t+\beta_1 z-\beta_1s)|^2ds\bigg].
\end{align}
In the following we restrict our attention to a piecewise-constant (or quasi-CW) pump.
We thus consider a train of rectangular-shaped pump pulses of duration $\Delta t =f_r t_R<t_R$ and constant amplitude $E_{in0}$:
\begin{equation}\label{eq:squarepump}
    E_{in}(t)=\left
    \{\begin{array}{cc}
        E_{in0} & {\rm if }\;n\, t_R<t<n\, t_R+f_rt_R. \\
       0  & \rm{elsewhere }.
    \end{array}\right.
\end{equation}
Here, $f_r = \Delta t/t_R$ is the ratio between the pump pulse duration and the cavity roundtrip time (i.e. the duty cycle), and we search for time-periodic (steady-state) solutions.
In this case, Eqs.~(\ref{eq:solFBzt}) can be calculated explicitly~:
\begin{align}
    \nonumber F(z,t)=& F_0 \exp[i\gamma (|F_0|^2 z + G \cdot X_{F}(z,t))], \\
    \nonumber  &{\rm if }\; \beta_1 z+ n\,t_R<t<\beta_1 z+ n\, t_R+\Delta t; \\
    \nonumber  B(z,t) =& B_0 \exp[-i\gamma (|B_0|^2 z + G\cdot X_{B}(z,t))], \\
     & {\rm if }\; -\beta_1 z+ n\,t_R<t<-\beta_1 z+ n\, t_R+\Delta t, \label{eq:periodic_sol}
\end{align}
where $F_0$ and $B_0$ are complex constants to be determined, and 
\begin{align}
    \nonumber X_{F}(z,t) &= \int_0^z|B(s,t-\beta_1 z+\beta_1s)|^2ds,\\
    X_{B}(z,t) &= \int_0^z|F(s,t+\beta_1 z-\beta_1s)|^2ds.\label{eq:x_int}
\end{align}
The XPM terms $X_{F,B}$ are piece-wise linear functions in $(z,t)$.
Their expressions are rather cumbersome, and reported in Appendix~\ref{sec:pulses_exact} (Tables \ref{tab:table1} or \ref{tab:table2} depending whether  $f_r<0.5$ or $f_r>0.5$).
The complex constants of $F_0$ and $B_0$ are found by imposing boundary conditions Eqs.~(\ref{eq:FP_BC}).
We find that $F_0$ and $B_0$ are still given by Eqs.~(\ref{eq:FP_SS}), but with a different nonlinear phase shift~:
\begin{equation}\label{eq:phi_per}
    \phi_{NL} = \gamma (1 + f_r G)(1+\rho_2^2)|F_0|^2 L.
\end{equation}
We see that the effect of periodic pumping is to reduce the XPM by a factor $f_r$.
This is a peculiarity of the FP~: pumping the cavity with quasi-cw pulses does change the stationary states.
For a ring resonator this effect is absent because $G=0$.
If the pulse duration is much shorter than the roundtrip time ($f_r\ll 1$), the stationary states tends to the ones of ring cavity.

\subsection{Stability of quasi-CW solutions}
We now consider the stability of the periodic solutions Eqs.~(\ref{eq:periodic_sol}) with respect to dispersive perturbations ($\beta_2\neq0$).
We assume that the forward and the backward fields have the following form:
\begin{subequations}
    \begin{eqnarray}
        F(z,t) &=& F_p(z,t) (1 + f(z,t)) \;,\\
        B(z,t) &=& B_p(z,t) (1 + b(z,t)) \;,
    \end{eqnarray}
\end{subequations}
being $F_p, B_p$ the periodic solutions Eqs.~(\ref{eq:periodic_sol}), $f,b$ small perturbations and we insert this Ansatz in Eqs.~(\ref{eq:FP_2NLS}).
The inclusion of dispersion is not compatible with the discontinuous solutions Eqs.~(\ref{eq:periodic_sol}), so we approximate the square pulse with a smooth flat-top pulse with a rise-time which is much shorter than the pulse duration $\Delta t$, but long enough to neglect dispersive effect on the stationary periodic solution.
In practice, we neglect the terms $\beta_2\frac{\partial F_p}{\partial t}$ and $\beta_2\frac{\partial B_p}{\partial t}$ in the equations for the perturbations. Moreover, in the spirit of the approximation made in Sec.~\ref{sec:approx_sols}, we assume $G=0$ in the equations for the perturbations.
By expanding the perturbations as in Eqs.~(\ref{eq:perturbation_forms}), we obtain again Eqs.~(\ref{eq:MED}), with the steady state given by Eqs. (\ref{eq:FP_SS}, \ref{eq:phi_per}).
Eventually, the MI gain can be still calculated with Eq.~(\ref{eq:FP_gain}), which depends on the pulse duration through Eqs.~(\ref{eq:FP_SS}, \ref{eq:phi_per}).

\subsubsection{Mean field}
A similar analysis can be done also for the mean field model.
The steady periodic solution $\psi_p(t)$ of Eq.~(\ref{eq:FP_LLE}) with $\beta_2=0$ with square pulse pumping Eq.~(\ref{eq:squarepump}) has the same temporal shape of the pump, with peak power $P_p$ and constant phase.
The power $P_p$ is given by the following cubic equation~:
\begin{equation}
    \theta_1^2 P_{in} = P_p\left( \alpha^2 + (\phi_0 + 2\gamma L P_p(1 +f_rG))^2\right).
\end{equation}
Again, we see that the effect of the pulsed pumping is to reduce the XPM coefficient $G$ by a factor $f_r$.
For a CW pump $f_r=1$ and we recover Eq.~(\ref{eq:LLE_SS}).

We perform a linear stability by considering a perturbed solution of the form $\psi(t,\tau) = \psi_p(t) + \varepsilon_n(\tau)e^{i\omega_n t} + \varepsilon_{-n}(\tau)e^{-i\omega_n t}$ and include dispersion.
As done in the previous subsection, we approximate the square pulse with a smooth flat-top pulse with a rise-time much shorter than the pulse duration $\Delta t$, but long enough to minimise the dispersive effects on the stationary periodic solution.
This way, we can neglect the term $\beta_2\frac{\partial^2 \psi_p}{\partial t^2}$ in the equations for the perturbations.
By following the procedure described in Sec.~\ref{sec:FPLLE}, and assuming $\int_0^{\Delta t}e^{i\omega_n t}dt\approx 0$ ($n\neq0$), we find that the perturbations are ruled again by Eqs.~(\ref{eq:LLE_LS_LE}) with the substitution $G \rightarrow f_r G$. At the end, the results of the stability analysis given by Eqs.~(\ref{eq:FP_LLE_gain}, \ref{eq:LLE_MI_NZ}) are still valid with $G$ replaced by $f_r G$.

% Figure environment removed

To illustrate the effect of the duration of the pump pulses, we consider the FP cavity used in Fig.~\ref{fig:SS_gS} with pulsed pumping. Fig.~\ref{fig:DutyCycle_Effect}(a) presents the cavity response plotted as function of linear phase for various pulse durations.
It can be observed that as the pulse duration increases, the resonance shape becomes more tilted.
This phenomenon is not observed in ring cavities since the XPM effect is absent, which results in an unchanged resonance shape.
This observation indicates that the pulse duration is a significant control parameter in FP cavities. To further emphasize this relationship, Fig.~\ref{fig:DutyCycle_Effect}(b) shows the MI gain spectrum for different pulse durations while maintaining the intracavity power constant. Interestingly, it is noticed that the maximum gain remains constant regardless of pulse duration, but the corresponding frequency is dependent on it.

% Figure environment removed

The results of linear stability analysis permit to predict the position of the unstable spectral bands even in the fully nonlinear regime, where an almost periodic train of pulses, i.e. a frequency comb, is generated.
Figure~\ref{fig:prop_DutyCycle_Effect} show the results of numerical solution of FP-LLE with a standard Fourier split-step method.
The initial condition is a CW (a,b) or a periodic steady-state (c,d) perturbed by a small random noise and it is propagated over $1000$ roundtrips in order to reach a stable state.
For a CW pump, we see in Fig.~\ref{fig:prop_DutyCycle_Effect}(a) that the field fills all the cavity (the time window extends from $-t_R/2$ to $t_R/2$) and is composed of a quasi periodic sequence of short pulses (see inset).
The spectrum is composed of several lines generated by cascaded FWM, and the position of the first sideband is perfectly predicted by the LSA (black dashed line).
For a pulsed pump, we see in Fig.~\ref{fig:prop_DutyCycle_Effect}(c) that the cavity is partially empty.
The field is composed of bursts of short pulses, as highlighted in the inset.
The spectrum is still composed of several lines, but the spacing is different as predicted by the LSA (black dashed line).
In Fig.~\ref{fig:prop_DutyCycle_Effect}(a-d) orange curves are the temporal and spectral traces obtained from the numerical solution of FP-LLE, while blue curves are obtained from coupled NLSE.
For the numerical solution of coupled NLSE Eqs.~(\ref{eq:FP_2NLS}, \ref{eq:FP_BC}) we used a \textit{split-step, predictor-corrector} method evolved in time~\cite{sun2019stable}.
We can see a very good agreement of the spectra in panels (b,d).
The slight discrepancies are mainly due to the fact that the initial seed is random noise, which is not identical in the two simulations.
The overall agreement of temporal traces in panels (a,c) is also good.
The insets shows a zoom on a limited temporal span, showing a remarkable quantitative agreement.
The numerical simulation of FP-LLE took only $0.5$ minutes on a standard workstation, while the full model took $9$ hours ($1000$ times slower) for the same number of roundtrips and the same frequency span.
The long computation time for the coupled NLSE is mainly caused by the counter-propagation, which imposes to solve two equation with two different group velocities.
The experimental demonstration of these phenomena will be published elsewhere~\cite{bunel2023impact}.

%--[LIMITATIONS OF THE MEAN FIELD MODEL]--
\section{Limitations of the mean field model}\label{sec:results}

The examples presented in the previous sections showed that FP-LLE permits to accurately reproduce the results of the full model.
However, the derivation of FP-LLE involves approximations that result in inherent limitations.
In order to identify the regions in the parameters space where the mean-field model breaks down, we draw a chart of instabitity from the results of LSA.

We start by considering FP-LLE.
Modulation instability occurs when $g_{max}>0$, and using Eq.~(\ref{eq:FP_LLE_gmax}), we can derive the intracavity power threshold $P_{th} = \alpha/(2\gamma L)$, which is independent of $\phi_0$ and the sign of the GVD parameter.
Figure~\ref{fig:TuringDomain} illustrates the bistability and MI regions as a function of the cavity linear phase $\phi_0$, with hatched areas corresponding to the negative slope branch of the bistable curve between $P^-$ and $P^+$ from Eq.~(\ref{eq:LLE_BS}), blue area to the MI region, and white areas to the stable region.
For $\beta_2<0$, MI arises in both bistable and monostable regimes when $P_F >P_{th}$, whereas for $\beta_2>0$, MI arises only in the bistable regime and is confined to a relatively small domain.
The dash-dotted curve delimits the low-frequency limit of the MI unstable domains from Eqs.~(\ref{eq:LLE_MI_NZ}).
It is worth noting that for certain values of ($\phi_0, P_F)$ in the bistable region, only the mode $\omega=0$ is unstable, which is a distinguishing feature of FP cavities.

% Figure environment removed

For the full model, the boundary between the stable and unstable regions are given by Eq.~(\ref{eq:MI_thresholds}), which is the solution of the equation $g(\omega)=0$ from Eq.~(\ref{eq:FP_gain}).
Figures~\ref{fig:TuringDomain}(c,d) show the MI gain calculated from (\ref{eq:FP_gain}), over the full range of cavity linear phase $(-\pi,\pi)$.
Differently than FP-LLE, the MI power threshold does depend on $\phi_0$.
In particular, both in the normal and the anomalous regimes, we can see two unstable tongues, one centered around zero detuning and the other around $\phi_0=\pi$.
The unstable region centered at $\phi=0$ corresponds to even values of $m$ in Eq.~(\ref{eq:str}), meaning that the unstable frequencies corresponds to cavity resonance $\omega t_R=2n\pi$.
Whereas, the unstable region centered at $\phi=\pi$ corresponds to odd values of $m$ in Eq.~(\ref{eq:str}), meaning that the unstable frequencies $\omega t_R=(2n+1)\pi$ are in between two resonances (anti-resonance).
We may identify in this second case the period-doubling (P2) MI, which has been described before for ring cavities \cite{conforti2016parametric,haelterman1992period,coen1997modulational,bessin2019real}.
The difference between standard (i.e. period one, P1) MI and P2-MI is that the modulations developing from the instability are in phase (P1) or shifted by half a temporal period (P2) at each roundtrip.
It is worth noting that previous theoretical studies on P2-MI were based on the Ikeda map, which does not permit to resolve the cavity modes.
As happens in ring resonators, the FP-LLE fails to predict P2 instabilities.
To highlight this feature, we report in Fig.~\ref{fig:pcolor_comparison}a, the gain in ($\omega$, $\phi_0$) obtained from (\ref{eq:FP_gain}). The two instability branches, are labelled P1 and P2 on the figure.
The P1 instability is captured by FP-LLE, as shown in Fig.~\ref{fig:pcolor_comparison}b.
On the other hand, the P2 instability is not visible in the gain calculated from FP-LLE. 

% Figure environment removed

In the following we complement the results of the linear stability analysis with numerical solution of the governing equations in the fully developed nonlinear regime.
Figure~\ref{fig:P1} reports the generation of a P1-MI comb from numerical simulations of Eqs.~(\ref{eq:FP_2NLS},\ref{eq:FP_BC}) (blue curves) and FP-LLE Eq.~(\ref{eq:FP_LLE}) (red curves).
Figure \ref{fig:P1}(a) shows the output spectrum after $10000$ roundtrips, where a steady state is reached.
The position of the unstable bands is well predicted by LSA ($f_{max}=\SI{1050}{GHz}$).
Figure~\ref{fig:P1}(b) shows a zoom of the the temporal behaviour of intracavity field at the output mirror at roundtrip $10000$.
The field is composed of an almost periodic train of short pulses, which reproduces itself at each roundtrip.
Figures~\ref{fig:P1}(a,b) show a good agreement between the full and the mean-field model (blue and red curves).
For this simulation, the computation time for the mean field model was divided by around $1500$ times with respect to the full model.
Figure~\ref{fig:P1}(c) shows a zoom of the spectrum around the maximum of the first band: only frequencies corresponding to the the cavity resonances are excited, as predicted by LSA showed in Figure~\ref{fig:P1}(d).

Figure~\ref{fig:P2} reports the generation of a P2-MI comb from numerical simulations of Eqs.~(\ref{eq:FP_2NLS}, \ref{eq:FP_BC}).
Figure~\ref{fig:P2}(a) shows the output spectrum after $10000$ roundtrips, where a steady state is reached.
The position of the unstable bands is well predicted by LSA ($f_{max}=\SI{555}{GHz}$).
Quite surprisingly, the first FWM band around $2f_{max}$ is not generated, whereas is clearly visible the second FWM band around $3f_{max}$.
Figure~\ref{fig:P2}(c) shows a zoom of the spectrum around the maximum of the first band~: the modes have frequencies which fall in between two adjacent cavity resonances, as predicted by LSA showed in Figure~\ref{fig:P2}(d).

% Figure environment removed

% Figure environment removed

This observation may explain why first order FWM is not present.
Indeed, the spectrum of the field is composed of lines at anti-resonance.
Frequency doubling of the first sideband will lead to lines at cavity resonances, which are inhibited in this configuration.
The analysis of the features of the fully developed P2-MI pattern is still under investigation.
Figure~\ref{fig:P2}(b) shows the the temporal behaviour of intracavity field at the output mirror at two consecutive roundtrips.
We clearly see that the two traces are out-of-phase, a the typical signature of P2-MI.

%--[CONCLUSION]--
\section{Conclusion}\label{sec:conclusion}

We have studied modulation instability in Kerr Fabry-Perot cavities.
Starting from a coupled NLSE description of the cavity dynamics, we have derived the exact dispersion relation for the perturbations and we found approximate analytical expressions for the instabilities threshold and gain spectrum of modulation instability.
We showed that, in contrast to ring-resonators, both the stationary solutions and the gain spectrum depends on the pump-pulse duration.
We derived the extended Lugiato-Lefever equation for the Fabry-Perot resonator (FP-LLE) starting from coupled nonlinear Schr\"odinger equations (rather than Maxwell-Bloch equations as done in~\cite{cole2018theory}) and we compared the results of the stability analysis of the two models.
While FP-LLE gives overall good results, we showed regimes that are not captured by the mean-field limit, namely the period-two modulation instability, which may appear in highly detuned or nonlinear regimes.
We reported numerical simulations of the generation of MI-induced Kerr combs by solving FP-LLE and the coupled NLSE.
Overall, our study aims at gaining a deeper understanding of the nonlinear dynamics of Fabry-Pérot cavities, which could have important implications for the development of new technologies and applications in fields such as telecommunications, optical sensing, and metrology.
The findings of our study could potentially assist the design of more efficient and robust cavity-based systems.

%--[ACKNOWLEDGMENT]--
\begin{acknowledgments}
    The present research was supported by the Agence Nationale de la Recherche (Programme Investissements d’Avenir, I-SITE VERIFICO) and IRCICA.
\end{acknowledgments}

%--[APPENDIX]--
\appendix
\input{appendix}

%--[REFERENCES and NOTES]--
%\bibliography{references}
%apsrev4-2.bst 2019-01-14 (MD) hand-edited version of apsrev4-1.bst
%Control: key (0)
%Control: author (72) initials jnrlst
%Control: editor formatted (1) identically to author
%Control: production of article title (-1) disabled
%Control: page (0) single
%Control: year (1) truncated
%Control: production of eprint (0) enabled
\providecommand{\noopsort}[1]{}\providecommand{\singleletter}[1]{#1}%
\begin{thebibliography}{39}%
\makeatletter
\providecommand \@ifxundefined [1]{%
 \@ifx{#1\undefined}
}%
\providecommand \@ifnum [1]{%
 \ifnum #1\expandafter \@firstoftwo
 \else \expandafter \@secondoftwo
 \fi
}%
\providecommand \@ifx [1]{%
 \ifx #1\expandafter \@firstoftwo
 \else \expandafter \@secondoftwo
 \fi
}%
\providecommand \natexlab [1]{#1}%
\providecommand \enquote  [1]{``#1''}%
\providecommand \bibnamefont  [1]{#1}%
\providecommand \bibfnamefont [1]{#1}%
\providecommand \citenamefont [1]{#1}%
\providecommand \href@noop [0]{\@secondoftwo}%
\providecommand \href [0]{\begingroup \@sanitize@url \@href}%
\providecommand \@href[1]{\@@startlink{#1}\@@href}%
\providecommand \@@href[1]{\endgroup#1\@@endlink}%
\providecommand \@sanitize@url [0]{\catcode `\\12\catcode `\$12\catcode
  `\&12\catcode `\#12\catcode `\^12\catcode `\_12\catcode `\%12\relax}%
\providecommand \@@startlink[1]{}%
\providecommand \@@endlink[0]{}%
\providecommand \url  [0]{\begingroup\@sanitize@url \@url }%
\providecommand \@url [1]{\endgroup\@href {#1}{\urlprefix }}%
\providecommand \urlprefix  [0]{URL }%
\providecommand \Eprint [0]{\href }%
\providecommand \doibase [0]{https://doi.org/}%
\providecommand \selectlanguage [0]{\@gobble}%
\providecommand \bibinfo  [0]{\@secondoftwo}%
\providecommand \bibfield  [0]{\@secondoftwo}%
\providecommand \translation [1]{[#1]}%
\providecommand \BibitemOpen [0]{}%
\providecommand \bibitemStop [0]{}%
\providecommand \bibitemNoStop [0]{.\EOS\space}%
\providecommand \EOS [0]{\spacefactor3000\relax}%
\providecommand \BibitemShut  [1]{\csname bibitem#1\endcsname}%
\let\auto@bib@innerbib\@empty
%</preamble>
\bibitem [{\citenamefont {Lugiato}\ \emph {et~al.}(2015)\citenamefont
  {Lugiato}, \citenamefont {Prati},\ and\ \citenamefont
  {Brambilla}}]{lugiato2015nonlinear}%
  \BibitemOpen
  \bibfield  {author} {\bibinfo {author} {\bibfnamefont {L.}~\bibnamefont
  {Lugiato}}, \bibinfo {author} {\bibfnamefont {F.}~\bibnamefont {Prati}},\
  and\ \bibinfo {author} {\bibfnamefont {M.}~\bibnamefont {Brambilla}},\
  }\href@noop {} {\emph {\bibinfo {title} {Nonlinear optical systems}}}\
  (\bibinfo  {publisher} {Cambridge University Press},\ \bibinfo {year}
  {2015})\BibitemShut {NoStop}%
\bibitem [{\citenamefont {Ikeda}(1979)}]{ikeda1979multiple}%
  \BibitemOpen
  \bibfield  {author} {\bibinfo {author} {\bibfnamefont {K.}~\bibnamefont
  {Ikeda}},\ }\href@noop {} {\bibfield  {journal} {\bibinfo  {journal} {Optics
  communications}\ }\textbf {\bibinfo {volume} {30}},\ \bibinfo {pages} {257}
  (\bibinfo {year} {1979})}\BibitemShut {NoStop}%
\bibitem [{\citenamefont {Firth}\ and\ \citenamefont
  {Par{\'e}}(1988)}]{firth1988transverse1}%
  \BibitemOpen
  \bibfield  {author} {\bibinfo {author} {\bibfnamefont {W.}~\bibnamefont
  {Firth}}\ and\ \bibinfo {author} {\bibfnamefont {C.}~\bibnamefont
  {Par{\'e}}},\ }\href@noop {} {\bibfield  {journal} {\bibinfo  {journal}
  {Optics letters}\ }\textbf {\bibinfo {volume} {13}},\ \bibinfo {pages} {1096}
  (\bibinfo {year} {1988})}\BibitemShut {NoStop}%
\bibitem [{\citenamefont {Firth}\ \emph
  {et~al.}(1990{\natexlab{a}})\citenamefont {Firth}, \citenamefont {Penman},\
  and\ \citenamefont {Par{\'e}}}]{firth1990transverse2}%
  \BibitemOpen
  \bibfield  {author} {\bibinfo {author} {\bibfnamefont {W.}~\bibnamefont
  {Firth}}, \bibinfo {author} {\bibfnamefont {C.}~\bibnamefont {Penman}},\ and\
  \bibinfo {author} {\bibfnamefont {C.}~\bibnamefont {Par{\'e}}},\ }\href@noop
  {} {\bibfield  {journal} {\bibinfo  {journal} {Optics communications}\
  }\textbf {\bibinfo {volume} {75}},\ \bibinfo {pages} {136} (\bibinfo {year}
  {1990}{\natexlab{a}})}\BibitemShut {NoStop}%
\bibitem [{\citenamefont {Firth}\ \emph
  {et~al.}(1990{\natexlab{b}})\citenamefont {Firth}, \citenamefont
  {Fitzgerald},\ and\ \citenamefont {Par{\'e}}}]{firth1990transverse3}%
  \BibitemOpen
  \bibfield  {author} {\bibinfo {author} {\bibfnamefont {W.}~\bibnamefont
  {Firth}}, \bibinfo {author} {\bibfnamefont {A.}~\bibnamefont {Fitzgerald}},\
  and\ \bibinfo {author} {\bibfnamefont {C.}~\bibnamefont {Par{\'e}}},\
  }\href@noop {} {\bibfield  {journal} {\bibinfo  {journal} {JOSA B}\ }\textbf
  {\bibinfo {volume} {7}},\ \bibinfo {pages} {1087} (\bibinfo {year}
  {1990}{\natexlab{b}})}\BibitemShut {NoStop}%
\bibitem [{\citenamefont {Firth}\ and\ \citenamefont
  {Penman}(1992)}]{firth1992diffractive}%
  \BibitemOpen
  \bibfield  {author} {\bibinfo {author} {\bibfnamefont {W.}~\bibnamefont
  {Firth}}\ and\ \bibinfo {author} {\bibfnamefont {C.}~\bibnamefont {Penman}},\
  }\href@noop {} {\bibfield  {journal} {\bibinfo  {journal} {Optics
  communications}\ }\textbf {\bibinfo {volume} {94}},\ \bibinfo {pages} {183}
  (\bibinfo {year} {1992})}\BibitemShut {NoStop}%
\bibitem [{\citenamefont {Geddes}\ \emph {et~al.}(1994)\citenamefont {Geddes},
  \citenamefont {Indik}, \citenamefont {Moloney},\ and\ \citenamefont
  {Firth}}]{geddes1994hexagons}%
  \BibitemOpen
  \bibfield  {author} {\bibinfo {author} {\bibfnamefont {J.~B.}\ \bibnamefont
  {Geddes}}, \bibinfo {author} {\bibfnamefont {R.}~\bibnamefont {Indik}},
  \bibinfo {author} {\bibfnamefont {J.}~\bibnamefont {Moloney}},\ and\ \bibinfo
  {author} {\bibfnamefont {W.~J.}\ \bibnamefont {Firth}},\ }\href@noop {}
  {\bibfield  {journal} {\bibinfo  {journal} {Physical Review A}\ }\textbf
  {\bibinfo {volume} {50}},\ \bibinfo {pages} {3471} (\bibinfo {year}
  {1994})}\BibitemShut {NoStop}%
\bibitem [{\citenamefont {Law}\ and\ \citenamefont
  {Kaplan}(1989)}]{law1989dispersion}%
  \BibitemOpen
  \bibfield  {author} {\bibinfo {author} {\bibfnamefont {C.}~\bibnamefont
  {Law}}\ and\ \bibinfo {author} {\bibfnamefont {A.}~\bibnamefont {Kaplan}},\
  }\href@noop {} {\bibfield  {journal} {\bibinfo  {journal} {Optics letters}\
  }\textbf {\bibinfo {volume} {14}},\ \bibinfo {pages} {734} (\bibinfo {year}
  {1989})}\BibitemShut {NoStop}%
\bibitem [{\citenamefont {Law}\ and\ \citenamefont
  {Kaplan}(1991)}]{law1991instabilities}%
  \BibitemOpen
  \bibfield  {author} {\bibinfo {author} {\bibfnamefont {C.}~\bibnamefont
  {Law}}\ and\ \bibinfo {author} {\bibfnamefont {A.~E.}\ \bibnamefont
  {Kaplan}},\ }\href@noop {} {\bibfield  {journal} {\bibinfo  {journal} {JOSA
  B}\ }\textbf {\bibinfo {volume} {8}},\ \bibinfo {pages} {58} (\bibinfo {year}
  {1991})}\BibitemShut {NoStop}%
\bibitem [{\citenamefont {Firth}(1981)}]{firth1981stability}%
  \BibitemOpen
  \bibfield  {author} {\bibinfo {author} {\bibfnamefont {W.}~\bibnamefont
  {Firth}},\ }\href@noop {} {\bibfield  {journal} {\bibinfo  {journal} {Optics
  Communications}\ }\textbf {\bibinfo {volume} {39}},\ \bibinfo {pages} {343}
  (\bibinfo {year} {1981})}\BibitemShut {NoStop}%
\bibitem [{\citenamefont {Abraham}\ \emph {et~al.}(1982)\citenamefont
  {Abraham}, \citenamefont {Firth},\ and\ \citenamefont
  {Carr}}]{abraham1982self}%
  \BibitemOpen
  \bibfield  {author} {\bibinfo {author} {\bibfnamefont {E.}~\bibnamefont
  {Abraham}}, \bibinfo {author} {\bibfnamefont {W.}~\bibnamefont {Firth}},\
  and\ \bibinfo {author} {\bibfnamefont {J.}~\bibnamefont {Carr}},\ }\href@noop
  {} {\bibfield  {journal} {\bibinfo  {journal} {Physics Letters A}\ }\textbf
  {\bibinfo {volume} {91}},\ \bibinfo {pages} {47} (\bibinfo {year}
  {1982})}\BibitemShut {NoStop}%
\bibitem [{\citenamefont {Silberberg}\ and\ \citenamefont
  {Bar-Joseph}(1984)}]{silberberg1984optical}%
  \BibitemOpen
  \bibfield  {author} {\bibinfo {author} {\bibfnamefont {Y.}~\bibnamefont
  {Silberberg}}\ and\ \bibinfo {author} {\bibfnamefont {I.}~\bibnamefont
  {Bar-Joseph}},\ }\href@noop {} {\bibfield  {journal} {\bibinfo  {journal}
  {JOSA B}\ }\textbf {\bibinfo {volume} {1}},\ \bibinfo {pages} {662} (\bibinfo
  {year} {1984})}\BibitemShut {NoStop}%
\bibitem [{\citenamefont {Yu}\ \emph {et~al.}(1998{\natexlab{a}})\citenamefont
  {Yu}, \citenamefont {McKinstrie},\ and\ \citenamefont
  {Agrawal}}]{yu1998temporal1}%
  \BibitemOpen
  \bibfield  {author} {\bibinfo {author} {\bibfnamefont {M.}~\bibnamefont
  {Yu}}, \bibinfo {author} {\bibfnamefont {C.}~\bibnamefont {McKinstrie}},\
  and\ \bibinfo {author} {\bibfnamefont {G.~P.}\ \bibnamefont {Agrawal}},\
  }\href@noop {} {\bibfield  {journal} {\bibinfo  {journal} {JOSA B}\ }\textbf
  {\bibinfo {volume} {15}},\ \bibinfo {pages} {607} (\bibinfo {year}
  {1998}{\natexlab{a}})}\BibitemShut {NoStop}%
\bibitem [{\citenamefont {Yu}\ \emph {et~al.}(1998{\natexlab{b}})\citenamefont
  {Yu}, \citenamefont {McKinstrie},\ and\ \citenamefont
  {Agrawal}}]{yu1998temporal2}%
  \BibitemOpen
  \bibfield  {author} {\bibinfo {author} {\bibfnamefont {M.}~\bibnamefont
  {Yu}}, \bibinfo {author} {\bibfnamefont {C.}~\bibnamefont {McKinstrie}},\
  and\ \bibinfo {author} {\bibfnamefont {G.~P.}\ \bibnamefont {Agrawal}},\
  }\href@noop {} {\bibfield  {journal} {\bibinfo  {journal} {JOSA B}\ }\textbf
  {\bibinfo {volume} {15}},\ \bibinfo {pages} {617} (\bibinfo {year}
  {1998}{\natexlab{b}})}\BibitemShut {NoStop}%
\bibitem [{\citenamefont {Firth}\ \emph {et~al.}(2021)\citenamefont {Firth},
  \citenamefont {Geddes}, \citenamefont {Karst},\ and\ \citenamefont
  {Oppo}}]{firth2021analytic}%
  \BibitemOpen
  \bibfield  {author} {\bibinfo {author} {\bibfnamefont {W.~J.}\ \bibnamefont
  {Firth}}, \bibinfo {author} {\bibfnamefont {J.~B.}\ \bibnamefont {Geddes}},
  \bibinfo {author} {\bibfnamefont {N.~J.}\ \bibnamefont {Karst}},\ and\
  \bibinfo {author} {\bibfnamefont {G.-L.}\ \bibnamefont {Oppo}},\ }\href@noop
  {} {\bibfield  {journal} {\bibinfo  {journal} {Physical Review A}\ }\textbf
  {\bibinfo {volume} {103}},\ \bibinfo {pages} {023510} (\bibinfo {year}
  {2021})}\BibitemShut {NoStop}%
\bibitem [{\citenamefont {Cole}\ \emph {et~al.}(2018)\citenamefont {Cole},
  \citenamefont {Gatti}, \citenamefont {Papp}, \citenamefont {Prati},\ and\
  \citenamefont {Lugiato}}]{cole2018theory}%
  \BibitemOpen
  \bibfield  {author} {\bibinfo {author} {\bibfnamefont {D.~C.}\ \bibnamefont
  {Cole}}, \bibinfo {author} {\bibfnamefont {A.}~\bibnamefont {Gatti}},
  \bibinfo {author} {\bibfnamefont {S.~B.}\ \bibnamefont {Papp}}, \bibinfo
  {author} {\bibfnamefont {F.}~\bibnamefont {Prati}},\ and\ \bibinfo {author}
  {\bibfnamefont {L.}~\bibnamefont {Lugiato}},\ }\href@noop {} {\bibfield
  {journal} {\bibinfo  {journal} {Physical Review A}\ }\textbf {\bibinfo
  {volume} {98}},\ \bibinfo {pages} {013831} (\bibinfo {year}
  {2018})}\BibitemShut {NoStop}%
\bibitem [{\citenamefont {Braje}\ \emph {et~al.}(2009)\citenamefont {Braje},
  \citenamefont {Hollberg},\ and\ \citenamefont
  {Diddams}}]{braje2009brillouin}%
  \BibitemOpen
  \bibfield  {author} {\bibinfo {author} {\bibfnamefont {D.}~\bibnamefont
  {Braje}}, \bibinfo {author} {\bibfnamefont {L.}~\bibnamefont {Hollberg}},\
  and\ \bibinfo {author} {\bibfnamefont {S.}~\bibnamefont {Diddams}},\
  }\href@noop {} {\bibfield  {journal} {\bibinfo  {journal} {Physical Review
  Letters}\ }\textbf {\bibinfo {volume} {102}},\ \bibinfo {pages} {193902}
  (\bibinfo {year} {2009})}\BibitemShut {NoStop}%
\bibitem [{\citenamefont {Obrzud}\ \emph {et~al.}(2017)\citenamefont {Obrzud},
  \citenamefont {Lecomte},\ and\ \citenamefont {Herr}}]{obrzud2017temporal}%
  \BibitemOpen
  \bibfield  {author} {\bibinfo {author} {\bibfnamefont {E.}~\bibnamefont
  {Obrzud}}, \bibinfo {author} {\bibfnamefont {S.}~\bibnamefont {Lecomte}},\
  and\ \bibinfo {author} {\bibfnamefont {T.}~\bibnamefont {Herr}},\ }\href@noop
  {} {\bibfield  {journal} {\bibinfo  {journal} {Nature Photonics}\ }\textbf
  {\bibinfo {volume} {11}},\ \bibinfo {pages} {600} (\bibinfo {year}
  {2017})}\BibitemShut {NoStop}%
\bibitem [{\citenamefont {Bunel}\ \emph {et~al.}(2023)\citenamefont {Bunel},
  \citenamefont {Conforti}, \citenamefont {Ziani}, \citenamefont {Lumeau},
  \citenamefont {Moreau}, \citenamefont {Fernandez}, \citenamefont {Llopis},
  \citenamefont {Roul}, \citenamefont {Perego}, \citenamefont {Wong} \emph
  {et~al.}}]{bunel2023observation}%
  \BibitemOpen
  \bibfield  {author} {\bibinfo {author} {\bibfnamefont {T.}~\bibnamefont
  {Bunel}}, \bibinfo {author} {\bibfnamefont {M.}~\bibnamefont {Conforti}},
  \bibinfo {author} {\bibfnamefont {Z.}~\bibnamefont {Ziani}}, \bibinfo
  {author} {\bibfnamefont {J.}~\bibnamefont {Lumeau}}, \bibinfo {author}
  {\bibfnamefont {A.}~\bibnamefont {Moreau}}, \bibinfo {author} {\bibfnamefont
  {A.}~\bibnamefont {Fernandez}}, \bibinfo {author} {\bibfnamefont
  {O.}~\bibnamefont {Llopis}}, \bibinfo {author} {\bibfnamefont
  {J.}~\bibnamefont {Roul}}, \bibinfo {author} {\bibfnamefont {A.~M.}\
  \bibnamefont {Perego}}, \bibinfo {author} {\bibfnamefont {K.~K.}\
  \bibnamefont {Wong}}, \emph {et~al.},\ }\href@noop {} {\bibfield  {journal}
  {\bibinfo  {journal} {Optics Letters}\ }\textbf {\bibinfo {volume} {48}},\
  \bibinfo {pages} {275} (\bibinfo {year} {2023})}\BibitemShut {NoStop}%
\bibitem [{\citenamefont {Jia}\ \emph {et~al.}(2020)\citenamefont {Jia},
  \citenamefont {Wang}, \citenamefont {Kwon}, \citenamefont {Wang},
  \citenamefont {Tsao}, \citenamefont {Liu}, \citenamefont {Ni}, \citenamefont
  {Guo}, \citenamefont {Yang}, \citenamefont {Jiang} \emph
  {et~al.}}]{jia2020photonic}%
  \BibitemOpen
  \bibfield  {author} {\bibinfo {author} {\bibfnamefont {K.}~\bibnamefont
  {Jia}}, \bibinfo {author} {\bibfnamefont {X.}~\bibnamefont {Wang}}, \bibinfo
  {author} {\bibfnamefont {D.}~\bibnamefont {Kwon}}, \bibinfo {author}
  {\bibfnamefont {J.}~\bibnamefont {Wang}}, \bibinfo {author} {\bibfnamefont
  {E.}~\bibnamefont {Tsao}}, \bibinfo {author} {\bibfnamefont {H.}~\bibnamefont
  {Liu}}, \bibinfo {author} {\bibfnamefont {X.}~\bibnamefont {Ni}}, \bibinfo
  {author} {\bibfnamefont {J.}~\bibnamefont {Guo}}, \bibinfo {author}
  {\bibfnamefont {M.}~\bibnamefont {Yang}}, \bibinfo {author} {\bibfnamefont
  {X.}~\bibnamefont {Jiang}}, \emph {et~al.},\ }\href@noop {} {\bibfield
  {journal} {\bibinfo  {journal} {Physical Review Letters}\ }\textbf {\bibinfo
  {volume} {125}},\ \bibinfo {pages} {143902} (\bibinfo {year}
  {2020})}\BibitemShut {NoStop}%
\bibitem [{\citenamefont {Xiao}\ \emph {et~al.}(2023)\citenamefont {Xiao},
  \citenamefont {Li}, \citenamefont {Cai}, \citenamefont {Zhang}, \citenamefont
  {Huang}, \citenamefont {Li}, \citenamefont {Yao}, \citenamefont {Wu},\ and\
  \citenamefont {Chen}}]{xiao2023near}%
  \BibitemOpen
  \bibfield  {author} {\bibinfo {author} {\bibfnamefont {Z.}~\bibnamefont
  {Xiao}}, \bibinfo {author} {\bibfnamefont {T.}~\bibnamefont {Li}}, \bibinfo
  {author} {\bibfnamefont {M.}~\bibnamefont {Cai}}, \bibinfo {author}
  {\bibfnamefont {H.}~\bibnamefont {Zhang}}, \bibinfo {author} {\bibfnamefont
  {Y.}~\bibnamefont {Huang}}, \bibinfo {author} {\bibfnamefont
  {C.}~\bibnamefont {Li}}, \bibinfo {author} {\bibfnamefont {B.}~\bibnamefont
  {Yao}}, \bibinfo {author} {\bibfnamefont {K.}~\bibnamefont {Wu}},\ and\
  \bibinfo {author} {\bibfnamefont {J.}~\bibnamefont {Chen}},\ }\href@noop {}
  {\bibfield  {journal} {\bibinfo  {journal} {Light: Science \& Applications}\
  }\textbf {\bibinfo {volume} {12}},\ \bibinfo {pages} {33} (\bibinfo {year}
  {2023})}\BibitemShut {NoStop}%
\bibitem [{\citenamefont {Nie}\ \emph {et~al.}(2022)\citenamefont {Nie},
  \citenamefont {Jia}, \citenamefont {Xie}, \citenamefont {Zhu}, \citenamefont
  {Xie},\ and\ \citenamefont {Huang}}]{nie2022synthesized}%
  \BibitemOpen
  \bibfield  {author} {\bibinfo {author} {\bibfnamefont {M.}~\bibnamefont
  {Nie}}, \bibinfo {author} {\bibfnamefont {K.}~\bibnamefont {Jia}}, \bibinfo
  {author} {\bibfnamefont {Y.}~\bibnamefont {Xie}}, \bibinfo {author}
  {\bibfnamefont {S.}~\bibnamefont {Zhu}}, \bibinfo {author} {\bibfnamefont
  {Z.}~\bibnamefont {Xie}},\ and\ \bibinfo {author} {\bibfnamefont {S.-W.}\
  \bibnamefont {Huang}},\ }\href@noop {} {\bibfield  {journal} {\bibinfo
  {journal} {Nature Communications}\ }\textbf {\bibinfo {volume} {13}},\
  \bibinfo {pages} {6395} (\bibinfo {year} {2022})}\BibitemShut {NoStop}%
\bibitem [{\citenamefont {Xiao}\ \emph {et~al.}(2020)\citenamefont {Xiao},
  \citenamefont {Wu}, \citenamefont {Li},\ and\ \citenamefont
  {Chen}}]{xiao2020deterministic}%
  \BibitemOpen
  \bibfield  {author} {\bibinfo {author} {\bibfnamefont {Z.}~\bibnamefont
  {Xiao}}, \bibinfo {author} {\bibfnamefont {K.}~\bibnamefont {Wu}}, \bibinfo
  {author} {\bibfnamefont {T.}~\bibnamefont {Li}},\ and\ \bibinfo {author}
  {\bibfnamefont {J.}~\bibnamefont {Chen}},\ }\href@noop {} {\bibfield
  {journal} {\bibinfo  {journal} {Optics Express}\ }\textbf {\bibinfo {volume}
  {28}},\ \bibinfo {pages} {14933} (\bibinfo {year} {2020})}\BibitemShut
  {NoStop}%
\bibitem [{\citenamefont {Wildi}\ \emph {et~al.}(2023)\citenamefont {Wildi},
  \citenamefont {Gaafar}, \citenamefont {Voumard}, \citenamefont {Ludwig},\
  and\ \citenamefont {Herr}}]{wildi2023dissipative}%
  \BibitemOpen
  \bibfield  {author} {\bibinfo {author} {\bibfnamefont {T.}~\bibnamefont
  {Wildi}}, \bibinfo {author} {\bibfnamefont {M.~A.}\ \bibnamefont {Gaafar}},
  \bibinfo {author} {\bibfnamefont {T.}~\bibnamefont {Voumard}}, \bibinfo
  {author} {\bibfnamefont {M.}~\bibnamefont {Ludwig}},\ and\ \bibinfo {author}
  {\bibfnamefont {T.}~\bibnamefont {Herr}},\ }\href@noop {} {\bibfield
  {journal} {\bibinfo  {journal} {Optica}\ }\textbf {\bibinfo {volume} {10}},\
  \bibinfo {pages} {650} (\bibinfo {year} {2023})}\BibitemShut {NoStop}%
\bibitem [{\citenamefont {Ogusu}\ \emph {et~al.}(1998)\citenamefont {Ogusu},
  \citenamefont {Li},\ and\ \citenamefont {Kamizono}}]{ogusu1998analysis}%
  \BibitemOpen
  \bibfield  {author} {\bibinfo {author} {\bibfnamefont {K.}~\bibnamefont
  {Ogusu}}, \bibinfo {author} {\bibfnamefont {H.}~\bibnamefont {Li}},\ and\
  \bibinfo {author} {\bibfnamefont {T.}~\bibnamefont {Kamizono}},\ }\href@noop
  {} {\bibfield  {journal} {\bibinfo  {journal} {Optical review}\ }\textbf
  {\bibinfo {volume} {5}},\ \bibinfo {pages} {185} (\bibinfo {year}
  {1998})}\BibitemShut {NoStop}%
\bibitem [{Note1()}]{Note1}%
  \BibitemOpen
  \bibinfo {note} {We found more convenient to calculate the eigenvectors of
  matrix $\protect \mathcal {M}$ numerically. In order to avoid numerical
  instabilities, we have used the Matlab built-in function \protect \texttt
  {eig} by explicitly choosing the algorithm used, i.e. \protect \texttt {[V,D]
  = eig(M,eye(4),'chol')}}\BibitemShut {NoStop}%
\bibitem [{\citenamefont {Conforti}\ \emph {et~al.}(2016)\citenamefont
  {Conforti}, \citenamefont {Copie}, \citenamefont {Mussot}, \citenamefont
  {Kudlinski},\ and\ \citenamefont {Trillo}}]{conforti2016parametric}%
  \BibitemOpen
  \bibfield  {author} {\bibinfo {author} {\bibfnamefont {M.}~\bibnamefont
  {Conforti}}, \bibinfo {author} {\bibfnamefont {F.}~\bibnamefont {Copie}},
  \bibinfo {author} {\bibfnamefont {A.}~\bibnamefont {Mussot}}, \bibinfo
  {author} {\bibfnamefont {A.}~\bibnamefont {Kudlinski}},\ and\ \bibinfo
  {author} {\bibfnamefont {S.}~\bibnamefont {Trillo}},\ }\href@noop {}
  {\bibfield  {journal} {\bibinfo  {journal} {Optics Letters}\ }\textbf
  {\bibinfo {volume} {41}},\ \bibinfo {pages} {5027} (\bibinfo {year}
  {2016})}\BibitemShut {NoStop}%
\bibitem [{\citenamefont {Lugiato}\ and\ \citenamefont
  {Lefever}(1987)}]{lugiato1987spatial}%
  \BibitemOpen
  \bibfield  {author} {\bibinfo {author} {\bibfnamefont {L.~A.}\ \bibnamefont
  {Lugiato}}\ and\ \bibinfo {author} {\bibfnamefont {R.}~\bibnamefont
  {Lefever}},\ }\href@noop {} {\bibfield  {journal} {\bibinfo  {journal}
  {Physical review letters}\ }\textbf {\bibinfo {volume} {58}},\ \bibinfo
  {pages} {2209} (\bibinfo {year} {1987})}\BibitemShut {NoStop}%
\bibitem [{\citenamefont {Haelterman}\ \emph {et~al.}(1992)\citenamefont
  {Haelterman}, \citenamefont {Trillo},\ and\ \citenamefont
  {Wabnitz}}]{haelterman1992additive}%
  \BibitemOpen
  \bibfield  {author} {\bibinfo {author} {\bibfnamefont {M.}~\bibnamefont
  {Haelterman}}, \bibinfo {author} {\bibfnamefont {S.}~\bibnamefont {Trillo}},\
  and\ \bibinfo {author} {\bibfnamefont {S.}~\bibnamefont {Wabnitz}},\
  }\href@noop {} {\bibfield  {journal} {\bibinfo  {journal} {Optics letters}\
  }\textbf {\bibinfo {volume} {17}},\ \bibinfo {pages} {745} (\bibinfo {year}
  {1992})}\BibitemShut {NoStop}%
\bibitem [{\citenamefont {Sun}\ \emph {et~al.}(2019)\citenamefont {Sun},
  \citenamefont {Mangan}, \citenamefont {Dong}, \citenamefont {Winful},
  \citenamefont {Cundiff},\ and\ \citenamefont {Kutz}}]{sun2019stable}%
  \BibitemOpen
  \bibfield  {author} {\bibinfo {author} {\bibfnamefont {C.}~\bibnamefont
  {Sun}}, \bibinfo {author} {\bibfnamefont {N.}~\bibnamefont {Mangan}},
  \bibinfo {author} {\bibfnamefont {M.}~\bibnamefont {Dong}}, \bibinfo {author}
  {\bibfnamefont {H.~G.}\ \bibnamefont {Winful}}, \bibinfo {author}
  {\bibfnamefont {S.~T.}\ \bibnamefont {Cundiff}},\ and\ \bibinfo {author}
  {\bibfnamefont {J.~N.}\ \bibnamefont {Kutz}},\ }\href@noop {} {\bibfield
  {journal} {\bibinfo  {journal} {JOSA B}\ }\textbf {\bibinfo {volume} {36}},\
  \bibinfo {pages} {3263} (\bibinfo {year} {2019})}\BibitemShut {NoStop}%
\bibitem [{\citenamefont {Bunel}(2023)}]{bunel2023impact}%
  \BibitemOpen
  \bibfield  {author} {\bibinfo {author} {\bibfnamefont {T.}~\bibnamefont
  {Bunel}},\ }\href@noop {} {\bibfield  {journal} {\bibinfo  {journal} {Optics
  Letters}\ }\textbf {\bibinfo {volume} {xx}},\ \bibinfo {pages} {xxx}
  (\bibinfo {year} {2023})}\BibitemShut {NoStop}%
\bibitem [{\citenamefont {Haelterman}(1992)}]{haelterman1992period}%
  \BibitemOpen
  \bibfield  {author} {\bibinfo {author} {\bibfnamefont {M.}~\bibnamefont
  {Haelterman}},\ }\href@noop {} {\bibfield  {journal} {\bibinfo  {journal}
  {Optics letters}\ }\textbf {\bibinfo {volume} {17}},\ \bibinfo {pages} {792}
  (\bibinfo {year} {1992})}\BibitemShut {NoStop}%
\bibitem [{\citenamefont {Coen}\ and\ \citenamefont
  {Haelterman}(1997)}]{coen1997modulational}%
  \BibitemOpen
  \bibfield  {author} {\bibinfo {author} {\bibfnamefont {S.}~\bibnamefont
  {Coen}}\ and\ \bibinfo {author} {\bibfnamefont {M.}~\bibnamefont
  {Haelterman}},\ }\href@noop {} {\bibfield  {journal} {\bibinfo  {journal}
  {Physical review letters}\ }\textbf {\bibinfo {volume} {79}},\ \bibinfo
  {pages} {4139} (\bibinfo {year} {1997})}\BibitemShut {NoStop}%
\bibitem [{\citenamefont {Bessin}\ \emph {et~al.}(2019)\citenamefont {Bessin},
  \citenamefont {Copie}, \citenamefont {Conforti}, \citenamefont {Kudlinski},
  \citenamefont {Mussot},\ and\ \citenamefont {Trillo}}]{bessin2019real}%
  \BibitemOpen
  \bibfield  {author} {\bibinfo {author} {\bibfnamefont {F.}~\bibnamefont
  {Bessin}}, \bibinfo {author} {\bibfnamefont {F.}~\bibnamefont {Copie}},
  \bibinfo {author} {\bibfnamefont {M.}~\bibnamefont {Conforti}}, \bibinfo
  {author} {\bibfnamefont {A.}~\bibnamefont {Kudlinski}}, \bibinfo {author}
  {\bibfnamefont {A.}~\bibnamefont {Mussot}},\ and\ \bibinfo {author}
  {\bibfnamefont {S.}~\bibnamefont {Trillo}},\ }\href@noop {} {\bibfield
  {journal} {\bibinfo  {journal} {Physical Review X}\ }\textbf {\bibinfo
  {volume} {9}},\ \bibinfo {pages} {041030} (\bibinfo {year}
  {2019})}\BibitemShut {NoStop}%
\bibitem [{\citenamefont {Zezyulin}\ \emph {et~al.}(2011)\citenamefont
  {Zezyulin}, \citenamefont {Konotop},\ and\ \citenamefont
  {Taki}}]{zezyulin2011modulational}%
  \BibitemOpen
  \bibfield  {author} {\bibinfo {author} {\bibfnamefont {D.}~\bibnamefont
  {Zezyulin}}, \bibinfo {author} {\bibfnamefont {V.}~\bibnamefont {Konotop}},\
  and\ \bibinfo {author} {\bibfnamefont {M.}~\bibnamefont {Taki}},\ }\href@noop
  {} {\bibfield  {journal} {\bibinfo  {journal} {Optics letters}\ }\textbf
  {\bibinfo {volume} {36}},\ \bibinfo {pages} {4623} (\bibinfo {year}
  {2011})}\BibitemShut {NoStop}%
\bibitem [{\citenamefont {Lugiato}\ and\ \citenamefont
  {Narducci}(1988)}]{lugiato1988nonlinear}%
  \BibitemOpen
  \bibfield  {author} {\bibinfo {author} {\bibfnamefont {L.}~\bibnamefont
  {Lugiato}}\ and\ \bibinfo {author} {\bibfnamefont {L.}~\bibnamefont
  {Narducci}},\ }\href@noop {} {\bibfield  {journal} {\bibinfo  {journal}
  {Zeitschrift f{\"u}r Physik B Condensed Matter}\ }\textbf {\bibinfo {volume}
  {71}},\ \bibinfo {pages} {129} (\bibinfo {year} {1988})}\BibitemShut
  {NoStop}%
\bibitem [{\citenamefont {Chembo}\ and\ \citenamefont
  {Menyuk}(2013)}]{chembo2013spatiotemporal}%
  \BibitemOpen
  \bibfield  {author} {\bibinfo {author} {\bibfnamefont {Y.~K.}\ \bibnamefont
  {Chembo}}\ and\ \bibinfo {author} {\bibfnamefont {C.~R.}\ \bibnamefont
  {Menyuk}},\ }\href@noop {} {\bibfield  {journal} {\bibinfo  {journal}
  {Physical Review A}\ }\textbf {\bibinfo {volume} {87}},\ \bibinfo {pages}
  {053852} (\bibinfo {year} {2013})}\BibitemShut {NoStop}%
\bibitem [{\citenamefont {Coen}\ \emph {et~al.}(2013)\citenamefont {Coen},
  \citenamefont {Randle}, \citenamefont {Sylvestre},\ and\ \citenamefont
  {Erkintalo}}]{coen2013modeling}%
  \BibitemOpen
  \bibfield  {author} {\bibinfo {author} {\bibfnamefont {S.}~\bibnamefont
  {Coen}}, \bibinfo {author} {\bibfnamefont {H.~G.}\ \bibnamefont {Randle}},
  \bibinfo {author} {\bibfnamefont {T.}~\bibnamefont {Sylvestre}},\ and\
  \bibinfo {author} {\bibfnamefont {M.}~\bibnamefont {Erkintalo}},\ }\href@noop
  {} {\bibfield  {journal} {\bibinfo  {journal} {Optics letters}\ }\textbf
  {\bibinfo {volume} {38}},\ \bibinfo {pages} {37} (\bibinfo {year}
  {2013})}\BibitemShut {NoStop}%
\bibitem [{\citenamefont {Chabchoub}\ and\ \citenamefont
  {Grimshaw}(2016)}]{chabchoub2016hydrodynamic}%
  \BibitemOpen
  \bibfield  {author} {\bibinfo {author} {\bibfnamefont {A.}~\bibnamefont
  {Chabchoub}}\ and\ \bibinfo {author} {\bibfnamefont {R.~H.}\ \bibnamefont
  {Grimshaw}},\ }\href@noop {} {\bibfield  {journal} {\bibinfo  {journal}
  {Fluids}\ }\textbf {\bibinfo {volume} {1}},\ \bibinfo {pages} {23} (\bibinfo
  {year} {2016})}\BibitemShut {NoStop}%
\end{thebibliography}%

\end{document}
