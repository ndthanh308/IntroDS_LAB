\usepackage{amssymb}
\usepackage{amsmath}
\usepackage{amsfonts}
\usepackage{manfnt}
\usepackage{bbm}
\usepackage{bm}
\usepackage{amsthm}
\usepackage{thmtools}
\usepackage{multirow}
\usepackage{enumerate}
\usepackage{times}
\usepackage{caption}
\usepackage{subcaption}
\usepackage{tikz}
\usetikzlibrary{positioning,angles,quotes, automata}
\usepackage[lastpage,user]{zref}
\usepackage{subcaption}
\usepackage{adjustbox}
\usepackage{multicol}
\usetikzlibrary{shapes,arrows}
\usepackage{tikz}
\usepackage{booktabs}
\usepackage{enumitem}
\usepackage{xspace}        % Handle spacing issues
\usepackage{placeins}      % For FLoat barriers
\usepackage{environ}


% Tikz
\usetikzlibrary{decorations.markings}
\usetikzlibrary{shapes,snakes}
\tikzset{->-/.style={decoration={
  markings,
  mark=at position .5 with {\arrow{>}}},postaction={decorate}}}

% citation/references
% \usepackage[hidelinks]{hyperref}       % hyperlinks
\usepackage[capitalize,nameinlink]{cleveref}


% Math symbols
\usepackage{bm}
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}

% Algo
\usepackage{algorithm}
%\usepackage{algorithmic}
\usepackage{algpseudocode}
\algrenewcommand{\algorithmiccomment}[1]{\hfill// #1}

% Theorems
\usepackage{amsthm}
\usepackage{thmtools}
\usepackage{thm-restate}

\theoremstyle{plain}
\newtheorem{theorem}{Theorem}
\newtheorem{lemma}{Lemma}
\newtheorem{proposition}{Proposition}
\newtheorem{corollary}{Corollary}

\theoremstyle{definition}
\newtheorem{assumption}{Assumption}
\newtheorem{definition}{Definition}
\newtheorem{conjecture}{Conjecture}
\newtheorem{example}{Example}
\newtheorem{remark}{Remark}

\theoremstyle{remark}
\newtheorem*{note}{Note}
\newtheorem{case}{Case}

% Cleveref nicer defaults
\newcommand{\crefrangeconjunction}{--} % dash instead of 'to'
%\crefname{equation}{}{} % Default to eqref for equations
\crefname{enumi}{}{}
\crefname{assumption}{Assumption}{Assumptions}

% iid with proper space handling after dot
\newcommand{\iid}{\textit{i.i.d.}\xspace}

% acknowledgments
% unnumbered third level heading as specified in iclr requirements
\newcommand{\acksection}{\subsubsection*{Acknowledgments and Disclosure of Funding}}
\NewEnviron{ack}{%
  \acksection
  \BODY
}

% CONVENIENCE
\newcommand{\R}{\mathbb{R}}
%\newcommand{\Z}{\mathbb{Z}}
\newcommand{\sigmoid}{\sigma}
\newcommand{\indicate}[1]{\operatorname{\mathbb{I}}(#1)}
\newcommand{\grad}{\nabla}

% DISTRIBUTIONS
\DeclareMathOperator{\Gumbel}{Gumbel}
\DeclareMathOperator{\Logistic}{Logistic}
\DeclareMathOperator{\Normal}{\mathcal{N}}
\DeclareMathOperator{\exponential}{Exp}
\DeclareMathOperator{\cat}{Cat}
\DeclareMathOperator{\embed}{rep}

% OPERATORS
\DeclareMathOperator{\softmax}{softmax}
\DeclareMathOperator{\KL}{KL}
\DeclareMathOperator*{\argmax}{arg\,max}
\DeclareMathOperator*{\argmin}{arg\,min}
\DeclareMathOperator*{\onehot}{onehot}

\DeclareMathOperator{\parent}{\pi}
\DeclareMathOperator{\exequal}{\overset{!}{=}}
\DeclareMathOperator{\dequal}{\overset{d}{=}}
\DeclareMathOperator{\expect}{\mathbb{E}}
\DeclareMathOperator{\hull}{conv}
\DeclareMathOperator{\proba}{\mathbb{P}}
\DeclareMathOperator{\domain}{dom}
\DeclareMathOperator{\relint}{relint}
\DeclareMathOperator{\transpose}{\top}


% SPECIAL VARIABLES
\newcommand{\temp}{t}
\newcommand{\discreteset}{\mathcal{X}}
\newcommand{\abstractset}{\mathcal{Y}}
\newcommand{\spset}{\mathcal{X}_{SP}}
\newcommand{\aborset}{\mathcal{X}_{AB}^r}
\newcommand{\hsset}{\mathcal{X}_{HS}^k}
\newcommand{\loss}{\mathcal{L}}
\newcommand*\cube{\mbox{\mancube}}

% COMMENTS
\newcommand{\andi}[1]{{\color{violet} [Andisheh: #1]}}
\newcommand{\lenart}[1]{{\color{red} [lenart: #1]}}
\newcommand{\scott}[1]{{\color{blue} [scott: #1]}}

% Vectors --> mathbf
\newcommand{\bz}{\bm{z}}
\newcommand{\bM}{\bm{M}}
%\newcommand{\bm}{\mathbf{m}}
\newcommand{\bx}{\bm{x}}
\newcommand{\by}{\bm{y}}


% curly math symbols
\newcommand{\calA}{\mathcal{A}}
\newcommand{\calB}{\mathcal{B}}
\newcommand{\calC}{\mathcal{C}}
\newcommand{\calD}{\mathcal{D}}
\newcommand{\calE}{\mathcal{E}}
\newcommand{\calF}{\mathcal{F}}
\newcommand{\calG}{\mathcal{G}}
\newcommand{\calH}{\mathcal{H}}
\newcommand{\calJ}{\mathcal{J}}
\newcommand{\calK}{\mathcal{K}}
\newcommand{\calL}{\mathcal{L}}
\newcommand{\calM}{\mathcal{M}}
\newcommand{\calN}{\mathcal{N}}
\newcommand{\calO}{\mathcal{O}}
\newcommand{\calP}{\mathcal{P}}
\newcommand{\calQ}{\mathcal{Q}}
\newcommand{\calR}{\mathcal{R}}
\newcommand{\calS}{\mathcal{S}}
\newcommand{\calT}{\mathcal{T}}
\newcommand{\calU}{\mathcal{U}}

\newcommand{\calX}{\mathcal{X}}
\newcommand{\calY}{\mathcal{Y}}
\newcommand{\calZ}{\mathcal{Z}}

\newcommand{\nN}{\mathbb{N}}

% Bold symbols and shortcuts
\newcommand{\mb}[1]{\mathbf{#1}}        % Bold font for variables
\newcommand{\bs}[1]{\bm{#1}}% Bold font for symbols (greek)
% \def\*#1{\bm{#1}}

% Bold math symbol shortcut
% % \newcommand{\eqdef}{\mathrel{:}=}
\newcommand{\eqdef}{\vcentcolon=}
\newcommand{\defeq}{\eqdef}
\renewcommand{\mid}{\,|\,}

% states / inputs
\newcommand{\s}{\bm{x}}
\newcommand{\z}{\bm{z}}
\renewcommand{\a}{\bm{a}}
\newcommand{\da}{\bar{a}}
\renewcommand{\c}{\bm{s}}
\newcommand{\y}{y}
\newcommand{\degree}{\Delta}

\newcommand{\st}{\bm{x}_{:,t}}
\newcommand{\ct}{\bm{s}_{:,t}}

\newcommand{\zt}{\bm{z}_{:,t}}
\newcommand{\at}{\bm{a}_{:,t}}
\newcommand{\stt}{\bm{x}_{:, 1:t}}
\newcommand{\ztt}{\bm{z}_{:, 1:t}}
\newcommand{\att}{\bm{a}_{:, 1:t}}
\newcommand{\sitt}{\bm{x}_{i,1:t}}
\newcommand{\zitt}{\bm{z}_{i,1:t}}
\newcommand{\citt}{\bm{s}_{i,1:t}}
\newcommand{\aitt}{\bm{a}_{i,1:t}}
\newcommand{\sittl}{\bm{x}_{i,1:t,l}}
\newcommand{\zittl}{\bm{z}_{i,1:t,l}}
\newcommand{\aittl}{\bm{a}_{i,1:t,l}}
\newcommand{\si}{ x_i}
\newcommand{\zi}{ \bm{z}_i}
\newcommand{\ai}{ a_i}
\newcommand{\sit}{ x_{i, t}}
\newcommand{\zit}{ \bm{z}_{i, t}}
\newcommand{\ait}{ a_{i, t}}
\newcommand{\soit}{ \tilde{x}_{i, t}}
\newcommand{\zoit}{ \tilde{\bm{z}}_{i, t}}
\newcommand{\aoit}{ \tilde{a}_{i, t}}
\newcommand{\noisescalei}{b_i}
\newcommand{\noisescale}{b}

\newcommand{\zmt}{ \bm{z}_{m, t}}
\newcommand{\amt}{ a_{m, t}}
\renewcommand{\S}{\mathcal{S}}
\newcommand{\Si}{\mathcal{X}_i}
\newcommand{\X}{\mathcal{X}}
\newcommand{\Zi}{\mathcal{Z}_i}
\newcommand{\Ai}{\mathcal{A}_i}
\newcommand{\Z}{\mathcal{Z}}
\newcommand{\A}{\mathcal{A}}

\newcommand{\matern}{Mat\'ern}

% Noise variables
\newcommand{\noise}{\omega}
\newcommand{\noisei}{\omega_i}
\newcommand{\snoise}{\bm \omega}
\newcommand{\noiseo}{\tilde{\omega}}
\newcommand{\snoiseo}{\tilde{\bm \omega}}
\newcommand{\snoiserv} {\bm \Omega}
\newcommand{\noiserv} {\Omega}

\newcommand{\indep}{\perp \!\!\! \perp}

\usepackage{xifthen}
\DeclareMathOperator{\trace}{Tr}
\newcommand{\norm}[1]{\left\lVert#1\right\rVert}
\newcommand{\abs}[1]{\left\lvert#1\right\rvert}
\newcommand{\normal}[3][]{%
    \ifthenelse{\isempty{#1}}
        {\mathcal{N}\left(#2, #3\right)}
        {\mathcal{N}\left(#1|#2, #3\right)}%
}

% Proper commands for expectations
\newcommand{\E}[2][]{\mathbb{E}_{#1}\mathopen{}\left[#2\right]\mathclose{}}
\newcommand{\Pro}[2][]{\mathbb{P}_{#1}\mathopen{}\left[#2\right]\mathclose{}}
\newcommand{\Var}[2][]{\operatorname{Var}_{#1}\left[#2\right]}

% SCM notation
\newcommand{\bX}{\bm X}
\newcommand{\bXi}{\bm X_i}
\newcommand{\pa}{\ensuremath{\mathit{pa}}}
\newcommand{\bZ}{\bm Z}
\newcommand{\bZi}{\bm Z_i}

% Gaussian process
\newcommand{\bsigma}{\bm{\sigma}}
\newcommand{\bSigma}{\bm{\Sigma}}
\newcommand{\bsigmai}{\bm{\sigma_i}}
\newcommand{\bSigmai}{\bm{\Sigma_i}}
\newcommand{\bmu}{\bm{\mu}}
\newcommand{\bmui}{\bm{\mu_i}}
\newcommand{\mui}{\mu_{i}}
\newcommand{\sigmai}{\sigma_{i}}
\newcommand{\muit}{\mu_{i,t}}
\newcommand{\sigmait}{\sigma_{i,t}}
\newcommand{\sigmaxi}
{\sigma_i^{\text{max}}}

%MW
\newcommand{\bw}{\bm{w}}
\newcommand{\ucb}{\textnormal{UCB}^{\calG}}

% eg and ie
\newcommand{\eg}{e.g.\ }
\newcommand{\ie}{i.e.}

% Subscripts
\newcommand{\ti}{n}                  % Timestep counter
\newcommand{\Ti}{N}
\renewcommand{\ni}{t}                % Iteration counter  
\newcommand{\Ni}{T}

% Shortcuts model class and posterior
\newcommand{\modelclass}{\ensuremath{\mathcal{M}}}
\newcommand{\dataset}{\ensuremath{\mathcal{D}}}
\newcommand{\modelposterior}{\ensuremath{p(\tilde{f} \mid \dataset_{1:\ni})}}


\newcommand{\acbo}{ACBO\xspace}
\newcommand{\alg}{\textsc{CBO-MW}\xspace}
\newcommand{\subalg}{\textsc{D-CBO-MW}\xspace}
\newcommand{\mwu}{\textsc{MWU}\xspace}
\newcommand{\gpmw}{\textsc{GP-MW}\xspace}
\newcommand{\dgpmw}{\textsc{D-GP-MW}\xspace}
\newcommand{\mcbo}{\textsc{MCBO}\xspace}
\newcommand{\eicbo}{\textsc{EICBO}\xspace}
\newcommand{\daggp}{\textsc{DAG-GP}\xspace}
\newcommand{\eifn}{\textsc{EIFN}\xspace}
\newcommand{\ucbalg}{\textsc{GP-UCB}\xspace}
\newcommand{\rand}{\textsc{Random}\xspace}

% Network prooperties
\renewcommand{\d}{N} %depth of graph
\newcommand{\G}{\mathcal{G}}

% Big-O notation
\newcommand{\Or}[1]{\mathcal{O}\mathopen{}\left(#1\right)\mathclose{}}
\newcommand{\OrTilde}[1]{\tilde{\mathcal{O}}\mathopen{}\left(#1\right)\mathclose{}}
\newcommand{\Th}[1]{\Theta\mathopen{}\left(#1\right)\mathclose{}}
\newcommand{\Om}[1]{\Omega\mathopen{}\left(#1\right)\mathclose{}}

% Dimensionalities
\newcommand{\ndata}{\ensuremath{\ni}}
\newcommand{\nstate}{\ensuremath{p}}
\newcommand{\ninp}{\ensuremath{q}}

% Optimistic states/inputs
\newcommand{\so}{\tilde{\bm{x}}}
\newcommand{\ao}{\tilde{\bm{\a}}}
\newcommand{\zo}{\tilde{\bm{\z}}}
\newcommand{\soi}{\tilde{x}_i}
\newcommand{\aoi}{\tilde{a}_i}
\newcommand{\zoi}{\tilde{\bm{z}}_i}

% % Parameterized policy
\newcommand{\pitheta}{\pi_{\bm{\theta}}}
\newcommand{\Ytheta}{Y_{\bm{\theta}}}
\newcommand{\btheta}{{\bm{\theta}}}

%% Setup 
\newcommand{\modcom}{\Gamma}
\newcommand{\fs}{\bm{F}}
\newcommand{\f}{\bm{f}}
\newcommand{\tfs}{\tilde{\bm{F}}}
\newcommand{\tf}{\tilde{\bm{f}}}
\newcommand{\fofi}{f_i}
\newcommand{\tfi}{\tilde{f}_i}
\newcommand{\tfit}{\tilde{f}_{i, t}}
\newcommand{\fofil}{f_{i}}
\newcommand{\etas}{\bm{\eta}}
\newcommand{\etai}{\eta_i}

%% Literature
\newcommand{\ICML}{Proceedings of International Conference on Machine Learning (ICML)}
\newcommand{\RSS}{Proceedings of Robotics: Science and Systems (RSS)}
\newcommand{\NeurIPS}{Advances in Neural Information Processing Systems (NeurIPS)}
\newcommand{\ICLR}{International Conference on Learning Representations (ICLR)}
\newcommand{\CoRL}{Conference on Robot Learning (CoRL)}
\newcommand{\UAI}{Uncertainty in Artificial Intelligence (UAI)}
\newcommand{\ICRA}{IEEE International Conference on Robotics and Automation (ICRA)}
\newcommand{\IROS}{IEEE International Conference on Intelligent Robots and Systems (IROS)}
\newcommand{\AISTATS}{International Conference on Artificial Intelligence and Statistics (AISTATS)}
\newcommand{\IJCAI}{International Joint Conference on Artificial Intelligence (IJCAI)}
\newcommand{\AAAI}{AAAI Conference on Artificial Intelligence}

% editing commands
\newcommand{\todo}[1]{\textcolor{red}{#1}}
\newcommand{\blue}[1]{\textcolor{blue}{#1}}
\newcommand{\green}[1]{\textcolor{green}{#1}}
% author notes
\newcommand{\am}[1]{\textcolor{teal}{\textsuperscript{AM}[#1]}}


% 
\newcommand*\circled[1]{\tikz[baseline=(char.base)]{
            \node[shape=circle,draw,inner sep=2pt] (char) {#1};}}


\newcommand{\pgs}[1]{{\color{purple}PGS: #1}}