  digraph {
    rankdir=RL
    shape=circle
    overlap=scale
    nodesep=0.1
    ranksep=0.1
    rank=max

    subgraph cluster_column_0 {
      graph [ label="column_0" ]
      "fc_{0,1}" [ label=dense ]
      "fc_{0,0}" [ label=dense ]
      "ReLU_{0,1}" [ label="ReLU" ]
      "ReLU_{0,0}" [ label="ReLU" ]

      "ReLU_{0,1}" -> "fc_{0,1}" -> "ReLU_{0,0}" -> "fc_{0,0}"
    }
    subgraph cluster_column_1 {
      graph [ label="column_1" ]
      "fc_{1,1}" [ label=dense ]
      "fc_{1,0}" [ label=dense ]
      "ReLU_{1,1}" [ label="ReLU" ]
      "ReLU_{1,0}" [ label="ReLU" ]
      "ReLU_{1,1}" -> "fc_{1,1}" -> "ReLU_{1,0}" -> "fc_{1,0}"
    }

    subgraph cluster_dots {
      node [
       shape=none
       label="{\vdots}"
      ]
      graph [
       label=""
        style=invis
      ]
      dots0 -> dots1 -> dots2 -> dots3 [ style=invis ]
    }

    subgraph cluster_column_last {
      graph [ label="column_{n-1}" ]
      "fc_{n,1}" [ label=dense ]
      "fc_{n,0}" [ label=dense ]
      "ReLU_{n,1}" [ label="ReLU" ]
      "ReLU_{n,0}" [ label="ReLU" ]
      "ReLU_{n,1}" -> "fc_{n,1}" -> "ReLU_{n,0}" -> "fc_{n,0}"
    }

    subgraph cluster_coarse {
      graph [ label="coarse-grained-classifier" ]
      fc_2 [ label=dense ]
      softmax -> fc_2
    }

    fc_2 -> "+"

"fc_{0,0}" -> input
    "+" -> "ReLU_{0,1}"

    "fc_{1,0}" -> input
    "+" -> "ReLU_{1,1}"

    dots3 -> input [ style=invis ]
    "+" -> dots0 [ style=invis ]

    "fc_{n,0}" -> input
    "+" -> "ReLU_{n,1}"

    subgraph cluster_fine_0 {
      graph [ label="fine-grained-classifier_0" ]
      softmax_0 [ label=softmax ]
      "fc_{0,5}" [ label=dense ]
      "fc_{0,4}" [ label=dense ]
      "fc_{0,3}" [ label=dense ]
      "ReLU_{0,4}" [ label=ReLU ]
      "ReLU_{0,3}" [ label=ReLU ]

      softmax_0 -> "fc_{0,5}" -> "ReLU_{0,4}" -> "fc_{0,4}" -> "ReLU_{0,3}" -> "fc_{0,3}"
    }

    subgraph cluster_fine_1 {
      graph [ label="fine-grained-classifier_1" ]
      softmax_1 [ label=softmax ]
      "fc_{1,5}" [ label=dense ]
      "fc_{1,4}" [ label=dense ]
      "fc_{1,3}" [ label=dense ]
      "ReLU_{1,4}" [ label=ReLU ]
      "ReLU_{1,3}" [ label=ReLU ]
     "softmax_1" -> "fc_{1,5}" -> "ReLU_{1,4}" -> "fc_{1,4}" -> "ReLU_{1,3}" -> "fc_{1,3}"
    }

    subgraph cluster_fine_dots {
      node [
       shape=none
       label="{\vdots}"
      ]
      graph [
       label=""
        style=invis
      ]
      "dots4" -> "dots5" -> "dots5" -> "dots6" -> "dots7" -> "dots8" -> "dots9" [ style=invis ]
    }

    subgraph cluster_fine_19 {
      graph [ label="fine-grained-classifier_{19}" ]
      softmax_19 [ label=softmax ]
      "fc_{19,5}" [ label=dense ]
      "fc_{19,4}" [ label=dense ]
      "fc_{19,3}" [ label=dense ]
      "ReLU_{19,4}" [ label=ReLU ]
      "ReLU_{19,3}" [ label=ReLU ]
      softmax_19 -> "fc_{19,5}" -> "ReLU_{19,4}" -> "fc_{19,4}" -> "ReLU_{19,3}" -> "fc_{19,3}"
    }

  "fc_{0,3}" -> "+"
  "fc_{1,3}" -> "+"
  "dots9" -> "+" [ style=invis ]
  "fc_{19,3}" -> "+"
  }
  
