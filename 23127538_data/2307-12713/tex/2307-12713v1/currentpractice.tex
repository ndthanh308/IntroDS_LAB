\begin{tikzpicture}[thick,scale=0.5]
\tikzstyle{block} = [draw,minimum height=0.1em, minimum width=.1cm, inner sep=3pt];
\tikzstyle{txt} = [text centered, inner sep=0pt];
\tikzstyle{compliance} = [dashed, draw,  inner sep=3pt ];


\draw (0,0) node[block] (TF) {Training framework};
\path (TF)+(0,-3) node [block, dashed] (ONNX) {\begin{tabular}{l}ML model description\\in intermediate format\end{tabular}};
\path (ONNX)+(0,-3) node [block] (TVM) {\begin{tabular}{l}Runtime ML model\\interpretor\end{tabular}};
\path (TVM)+(-2,-3) node [block] (cpu1) {CPU};
\path (cpu1)+(2.5,0) node [block] (cpu2) {CPU};
\path (cpu2)+(2.5,0) node [block] (ddr) {DDR};
\path (cpu1)+(2.4,-1) node [block, minimum width=3.5cm] (bus) {};
\path (cpu1)+(0,-2) node [block] (gpu) {GPU};
\path (gpu)+(2.5,0) node [block] (fpga) {FPGA};
\path (fpga)+(2.5,0) node [block] (dla) {DLA};

\node[
      draw,  
      inner sep=.2cm,
      fit={(cpu1) (cpu2) (ddr) (gpu) (fpga) (dla)},
      align=left,
       thick
    ] (Const) {};

\draw  [->]   (TF.south)  -- (ONNX.north)  ;
\draw  [->]   (ONNX.south)  -- (TVM.north) ;
\draw  [->,dashed]   (TVM.south) --($ (TVM.south) + (0,-.7)$)  -| (cpu1.north);
\draw  [->,dashed]    ($ (TVM.south) + (-0.5,0)$) --($ (TVM.south) + (-0.5,-.5)$)  -| ($ (gpu.west) + (-0.8,0)$) -- (gpu.west);
\draw  [->,dashed]    ($ (TVM.south) + (0.5,0)$) --($ (TVM.south) + (0.5,-.5)$)  -| ($ (dla.east) + (0.8,0)$)  -- (dla.east);



\draw (12,0) node[block] (TF) {Training framework};
\path (TF)+(0,-3) node [block, dashed] (nnef) {\begin{tabular}{l}ML model description\\in \emph{formal} format\end{tabular}};
\path (nnef)+(-3.5,-3) node [block, dashed] (nnef1) {i1 desc.};
\path (nnef)+(0,-3) node [block, dashed] (nnef2) {i2 desc.};
\path (nnef)+(3.5,-3) node [block, dashed] (nnef3) {i3 desc.};
\path (nnef1)+(0,-1.5) node [block, dashed] (exec1) {code};
\path (nnef2)+(0,-1.5) node [block, dashed] (exec2) {code};
\path (nnef3)+(0,-1.5) node [block, dashed] (exec3) {code};


\draw  [->]   (TF.south)  -- (nnef.north) ;
\draw  [->]   (nnef.south)  -- (nnef1.north) ;
\draw  [->]   (nnef.south)  -- (nnef2.north) ;
\draw  [->]   (nnef.south)  -- (nnef3.north) ;
\draw  [->]   (nnef1.south)  -- (exec1.north);
\draw  [->]   (nnef2.south)  -- (exec2.north);
\draw  [->]   (nnef3.south)  -- (exec3.north);

\path (exec2)+(-2.5,-2) node [block] (cpu1) {CPU};
\path (cpu1)+(2.5,0) node [block] (cpu2) {CPU};
\path (cpu2)+(2.5,0) node [block] (ddr) {DDR};
\path (cpu1)+(2.4,-1) node [block, minimum width=3.5cm] (bus) {};
\path (cpu1)+(0,-2) node [block] (gpu) {GPU};
\path (gpu)+(2.5,0) node [block] (fpga) {FPGA};
\path (fpga)+(2.5,0) node [block] (dla) {DLA};

\node[
      draw,  
      inner sep=.2cm,
      fit={(cpu1) (cpu2) (ddr) (gpu) (fpga) (dla)},
      align=left,
       thick
] (Const) {};

\draw  [->,dashed]   (exec1.south) -- (cpu1.north);
\draw  [->,dashed]    (exec1.west) --($ (exec1.west) + (-0.5,0)$)  -| ($ (gpu.west) + (-1.2,-0.1)$) -- ($ (gpu.west) + (0,-0.1)$);

\draw  [->,dashed]   (exec2.south) -- (cpu1.north);
\draw  [->,dashed]    ($ (exec2.south) + (-0.5,0)$) --($ (exec2.south) + (-0.5,-.3)$)  -| ($ (gpu.west) + (-.8,0.1)$) --  ($ (gpu.west) + (0,0.1)$);

\draw  [->,dashed]    (exec3.south) --($ (exec3.south) + (0,-.3)$)  -| ($ (dla.east) + (0.8,0)$) |-
($ (fpga.south) + (0,-0.8)$) --  (fpga.south);
\end{tikzpicture}

