% Other proposal with compression of the variables.
% I prefer this version that well show the variable that
% is accessible by an item or by another...
\begin{tikzpicture}[    % Change style
    thick,
    node distance=1.1cm,
    on grid,
    post/.style={-{Latex[length=1.5mm]}},
    tokitem1/.style={colored tokens={gray!40}},
    tokitem2/.style={colored tokens={black}},
    tokitem3/.style={colored tokens={gray!100}},
    tokitem12/.style={colored tokens={gray!100, black}},
    linkitem1/.style={gray!40, line width=0.4mm},
    linkitem2/.style={black, line width=0.4mm},
    linkitem3/.style={gray!100, line width=0.4mm},
    every transition/.style={fill,minimum width=1mm, minimum height=10mm}]


\node[place,tokitem1, label=below left:$e_1$] (place1) {};

\node[transition, right=1cm of place1,label=below:$Conv$] (trans0) {};
\node[place,tokens=0,right=.75cm of trans0, label=above:$o_1$] (place0) {};
\node[place,tokitem1,above=1cm of place1, label=above:$v_1$] (placevar10) {};
\node[place,tokitem1,below=1cm of place1, label=below:$v_2$] (placevar30) {};
\draw[linkitem1]  (placevar10) edge[post, bend right=15] (trans0);
\draw[linkitem1]  (placevar30) edge[post, bend left=15] (trans0);
\draw[linkitem1]  (place1) edge[post] (trans0);
\draw[linkitem1]  (trans0) edge[post] (place0);

\node[transition,below=2cm of trans0,rotate=90,label=left:$sync_1$] (TSYNC) {};
\draw[linkitem3] (TSYNC) edge[post, bend left=25] (place0);
\draw[linkitem2] (TSYNC) edge[post, bend right=25] (place0);
\draw[linkitem1] (place0) edge[post] (TSYNC);

% Transition
\node[transition,above right=1.5cm and .7cm of place0,label=below:$Conv$] (trans1) {};
\node[place,tokens=0,right=1cm of trans1, label=below:$o_2$] (place2) {};

\node[place,tokitem2, left=1cm of trans1,label=left:$v_3$] (placevar1) {};
\node[place,tokitem2, above=1cm of placevar1, label=left:$v_4$] (placevar3) {};


\node[transition,right=.75cm of place2,label=below:$Conv$] (trans2) {};
\node[place,tokens=0,right=.75cm of trans2, label=below:$o_3$] (place3) {};
\node[place,tokitem12,below left=1.5cm and .7cm of place2, label=below:$v_5$] (placevar4) {};
\node[place,tokitem12,right=1cm of placevar4, label=below:$v_6$] (placevar5) {};

\draw[linkitem2] (place0) edge[post] (trans1);
\draw[linkitem2] (trans1) edge[post] (place2);
\draw[linkitem2] (place2) edge[post] (trans2);
\draw[linkitem2] (trans2) edge[post] (place3);
\draw[linkitem2] (placevar1) edge[post, bend right=15] (trans1);
\draw[linkitem2] (placevar3) edge[post, bend right=5] (trans1);
\draw[linkitem2] (placevar4) edge[post, bend right=5] (trans2);
\draw[linkitem2] (placevar5) edge[post, bend right=5] (trans2);

%% sync2

\node[transition,right=1cm of place3,label=below:$sync_2$] (TSYNC2) {};

\draw[linkitem1] (TSYNC2) edge[post, bend left=15] (place3);
\draw[linkitem2] (place3) edge[post, bend left=15] (TSYNC2);




\node[transition,below right=1.5cm and .6cm of place3,label=below:$concat$] (trans3) {};
\node[place,tokens=0,right=.75cm of trans3, label=below:$o_6$] (place4) {};

\draw[linkitem1] (place3) edge[post] (trans3);
\draw[linkitem1] (trans3) edge[post] (place4);



%item2
\node[transition,below right=1.5cm and 2cm of place0,label=below:$Conv$] (trans11) {};
\node[place,tokens=0,right=.75cm of trans11, label=below:$o_4$] (place21) {};
\node[place,tokitem3,left=1cm  of trans11, label=below left:$v_7$] (placevar11) {};
\node[place,tokitem3,below=1cm of placevar11, label=below left:$v_8$] (placevar31) {};

\node[transition,right=.75cm of place21,label=below:$Conv$] (trans21) {};
\node[place,tokens=0,right=.75cm of trans21, label=below:$o_5$] (place31) {};

\draw[linkitem3] (place0) edge[post] (trans11);
\draw[linkitem3] (trans11) edge[post] (place21);
\draw[linkitem3] (place21) edge[post] (trans21);
\draw[linkitem3] (trans21) edge[post] (place31);
\draw[linkitem3] (placevar11) edge[post, bend right=15] (trans11);
\draw[linkitem3] (placevar31) edge[post, bend right=5] (trans11);
\draw[linkitem3] (placevar4) edge[post, bend right=5] (trans21);
\draw[linkitem3] (placevar5) edge[post, bend right=5] (trans21);

\node[transition,right=1cm of place31,label=below:$sync_3$] (TSYNC) {};

\draw[linkitem1] (TSYNC) edge[post, bend left=15] (place31);
\draw[linkitem3] (place31) edge[post, bend left=15] (TSYNC);

\draw[linkitem1] (place31) --($(place31)+(-.9,.7)$);
\draw[linkitem1] ($(place31)+(-.9,.75)$) edge[post] (trans3.west);



% Transition
\node[transition, right=.75cm of place4,label=below:$flat$] (trans4) {};
\node[place,tokens=0,right=.75cm of trans4, label=below:$o_7$] (place7) {};
\draw[linkitem1]  (place4) edge[post] (trans4);
\draw[linkitem1]  (trans4) edge[post] (place7);

% Transition
\node[transition, right=.75cm of place7,label=below:$gemm$] (trans5) {};
\node[place,tokitem1, above=1.5cm  of trans4, label=left:$v_9$] (placevar5) {};
\node[place,tokitem1,above=1cm of placevar5, label=left:$v_{10}$] (placevar51) {};
\draw[linkitem1] (placevar5) edge[post, bend right=5] (trans5);
\draw[linkitem1] (placevar51) edge[post, bend right=5] (trans5);


\node[place,tokens=0,right=.75cm of trans5, label=below:$out$] (place8) {};
\draw[linkitem1]  (place7) edge[post] (trans5);
\draw[linkitem1]  (trans5) edge[post] (place8);


\end{tikzpicture}    
