\begin{tikzpicture}
    \node[draw, align=center] at (0,0) (T1) {\textbf{NN Items}\\\textbf{Specification}};

    \def\corner{0.15in};
    \def\cornerradius{0.02in};
    \def\lwidth{0.02in};
    \def\h{.9in};
    \def\w{0.8in};
    \def\nline{8};
    \def\iconmargin{0.1in};
    \def\topmargin{0.30in};

    \coordinate[above right=1.75cm and 2.5cm of T1] (ref);

    \foreach[count=\i] \num in {1,2,3,4}
    {
        \coordinate (nw) at ($(ref)+(-0.05in*\i,-0.15in*\i)$);
        \coordinate (ne0) at ($(nw) + (\w, 0)$);
        \coordinate (ne1) at ($(ne0) - (\corner, 0)$);
        \coordinate (ne2) at ($(ne0) - (0, \corner)$);
        \coordinate (se) at ($(ne0) + (0, -\h)$);
        \coordinate (nbl) at ($(nw) + (0, -\h)$);
        \filldraw [-, line width = \lwidth, fill=white] (nw) -- (ne1) -- (ne2)
        [rounded corners=\cornerradius]--(se) -- (nw|-se) -- cycle;
        \draw [-, line width = \lwidth] (ne1) [rounded corners=\cornerradius]-- (ne1|-ne2) -- (ne2);
        
        
  %      \ifthenelse{4 = \i}{\node [anchor=north west] at (nw) {\textbf{Code files}};}{} % (*)

        \foreach \k in {1,...,\nline}
        {
        \draw [-, line width = \lwidth, line cap=round] 
            ($(nw|-se) + (\iconmargin,\iconmargin) + (0,{(\k-1)/(\nline-1)*(\h - \iconmargin - \topmargin)})$)
            -- ++ ($(\w,0) - 2*(\iconmargin,0)$);
        }
    }

    \node [anchor=north west] at (nw) {\textbf{Code files}};
    
    \node[draw, above=2cm of T1, align=center] (T33) {\textbf{PyTorch}\\NN representation};

    \node[draw, right=6cm of T1, align=center] (T3) {\textbf{Binary}\\on target};
    \node[draw, below right=.3cm and .1cm of T3] (T5) {Numeric trace};
    \node[draw, above=3.5cm of T5, align=center] (T60) {Numeric trace};
    \node[draw, below=.3cm of T5, align=center] (T55) {Computation time};
    \node[draw, below=.3cm of T55, align=center, align=center] (T4) {Program flow trace};
    
   \node[draw, below right=1cm and -1.75cm of T1, align=center] (T6) {\textbf{\emph{sync} specification}\\POSIX barriers\\Global variables};

    \draw[out=45, in=135, post, thick] (T1.north) to node[above]{Manual Code} (nw);
    \draw[out=45, in=135, post, thick] (ne0) to node[above]{Compilation} (T3.north);
    \draw[post, thick] ($(T1.south)+(-1,0)$) to node[near start,right]{Refine} ($(T6.west)+(-.3,0)$) --(T6.west);
    \draw[out=0, in=-135, post, thick] (T6.east) to node[below right]{Manual Code} (nbl);

    \draw[post, thick] (T3.south) |- (T4.west);
    \draw[post, thick] (T3.south) |- (T5.west) ;
     \draw[post, thick] (T3.south) |- (T55.west)node[near start, above, rotate=90]{Execution};
    
    \draw[post, thick] (T33.east) |- (T60.west) node[near end, below]{Execution with PyTorch runtime};

    \draw[out=-105, in=+105, post, thick] (T33.south) to node[left]{Generate} (T1.north);

    \draw[dashed,thick] (T4.south) --  ($(T4.south) + (0,-1)$) --  ($(T1.west) + (-.5,-3.76)$)node[above, pos = 0.5]{Verification};
     \draw[dashed,post,thick] ($(T1.west) + (-.5,-3.76)$) --  ($(T1.west) + (-.5,0)$) |- (T1.west) ;
    \draw[dashed,thick, post] (T5.north) to node[left, near end]{Verification} (T60.south);


\end{tikzpicture}
    
