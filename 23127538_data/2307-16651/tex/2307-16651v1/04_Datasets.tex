\section{Evaluation} 
First, we describe the cohort selection of the VO$_{2}$max prediction task (\S\ref{4.1}). Then, we discuss the \imt{data extraction and different measurement VO$_{2}$max} (\S\ref{4.2}) and feature extraction (\S\ref{4.3}) stage that occurs before the construction of the deep neural network. 

\subsection{Cohort Selection} \label{4.1}
Two datasets, Fenland and BVS, are utilized for experiments and evaluations in our work. Table~\ref{tab:cohortcharacteristics} indicates the descriptive characteristics of the two analysis samples. In addition, the mean and standard deviations for each characteristic are presented in this table.

\input{table_characteristic}

\subsubsection{Fenland Study} The Fenland dataset with large-scale weakly-labeled VO$_{2}$max is used as the source domain (\(D_s\)) in this work. In particular, Fenland study~\citep{feland} is a prospective population-based cohort study of individuals aged 35-65 investigating the interaction between environmental and genetic factors in determining obesity, type 2 diabetes, and related metabolic disorders. The study has collected from 12,435 participants around Cambridgeshire in the East of England between 2005 and 2015. After a baseline clinic visit, participants were instructed to wear the chest sensor Actiheart for six consecutive days to collect the heart rate and movement data. Data from 11,059 participants were included in this study following the exclusion of those with insufficient or corrupt data or missing variables based on \S\ref{4.3}. 



%https://www.mrc-epid.cam.ac.uk/research/research-areas/physical-activity/
% https://www.mrc-epid.cam.ac.uk/research/studies/fenland/fenland-study-phase-1/


\subsubsection{Biobank Validation Study (BBVS)} BBVS dataset is the target domain (\(D_t\)) with clean gold-standard VO$_{2}$max labels~\citep{bvs}. The BBVS dataset is a subset of 191 participants from the Fenland study and aims to validate CRF measurement methods for the UKB-CRF test. During the study, similar electrocardiography~(Cardiosoft) and an Actiwave CARDIO device~(CamNtech, Papworth, UK) were utilized to collect signals. In particular, participants need to wear face masks with a computerized metabolic system to measure the VO$_{2}$max during the study. Similarly, data from 181 participants were included after excluding participants with insufficient data. All participants from two datasets provided written informed consent, and the University of Cambridge Ethics Committee approved the study.

\subsection{Data extraction and Cardiorespiratory fitness assessment} \label{4.2}
%free-living sensing 6 days, 
\imt{For both Fenland and BBVS study, participants wore the two standard Electrocardiography (ECG) electrodes Actiheart devices attached to the chest, which measured heart rate and movement recording at 60-second intervals~\citep{actiheart} for the wearable free-living sensing. }
The monitoring phase lasted for a total of six days.

In the Fenland study, VO$_{2}$max was measured using a previously
validated submaximal treadmill test\citep{gonzales2020submaximal} and considered as weak (silver-standard) labeling~\footnote{ https://www.mrc-epid.cam.ac.uk/research/studies/fenland/fenland-study-phase-1/}. 
\imt{During a lab visit, all participants conducted a treadmill test to determine their heart rate response to a submaximal test, informing their VO$_{2}$max by using a linear regression method.} 
HR was recorded for 15 minutes during the exercise, and RHR was calculated as the mean heart rate measured during the last 3 minutes. The RHR is a mix of the RHR mentioned above and the Sleeping HR as recorded by the ECG during the free-living period. \imt{Although using the submaximal test and linear regression capture the fitness level, measurement bias from -3.0 to -1.6 ml O2/\textit{min}/\textit{kg} and a Pearsonâ€™s r ranging from 0.57 to 0.79.  }

In comparison, VO$_{2}$max of participants in the BBVS dataset were directly measured during a maximal exercise test~\footnote{https://www.mrc-epid.cam.ac.uk/research/research-areas/physical-activity/}which was completed to exhaustion~\citep{bvs}, . Following standardized techniques used for the UKB-CRF test~\citep{CRF-manual}, participants did 5 maximal exercise tests to elicit VO$_{2}$max, including a UKB flat test, two UKB ramped tests with varying ramp rates and a steady-state test (exclusive to the validation study), and another ramped test (for validation only). After that, the gold-standard VO$_{2}$max data was collected. For BBVS participants, similar sensor and anthropometric data were collected in the same manner as in Fenland. 


\subsection{Feature Extraction} \label{4.3}
All heart rate data collected during lab-visit underwent pre-processing for noise filtering~\citep{noise-filter}. If participants had fewer than 72 hours of concurrent wear data (three full days of recording) or inadequate individual calibration data, they were eliminated from the study (treadmill test-based data). Non-wear periods were excluded from the analyses through non-wear detection procedures. This pre-processing algorithm discovered lengthy durations of non-physiological heart rate and extended periods of no movement reported by the device's accelerometer (\textgreater 90 minutes). We used the calculation 1 MET = 71 J/min/kg (3.5 ml O2 min1 kg1) to convert movement intensities into standard metabolic equivalent units (METs). These conversions were then used to classify intensity levels, with behaviors less than 1.5METs classed as sedentary, those between 3 and 6 METs as moderate to vigorous physical activity (MVPA), and those greater than 6METs as vigorous physical activity (VPA). Since time can greatly impact physical activities, we encoded the sensor timestamps using cyclical temporal features \citep{Spathis_self_supervision}. 
Additionally, given the sensors' high sampling rate (1 sample/minute) after matching the HR and Acceleration modalities, learning patterns from such a lengthy sequence (a week's worth of sensor data contains more than 10,000 time steps) is unfeasible, even with the most powerful sequence models. Therefore, instead of segmenting the data into time windows for temporal data processing, we downsampled the wearable signals (Accelerometer and ECG) by a ratio of 15 to decrease the sequence length to 600 time steps. \imt{After that, we normalized the data by performing min-max scaling on all input features (sequence-wise for sensor data and column-wise for metadata).} Then, each feature vector with 19 features combining 
% \ds{typo?} \yw{fixed}
time series and metadata were put into various deep neural networks. 
A detailed view of these features is provided Table~\ref{tab:variables} in Appendix~\ref{apd:first}.




