% ***********************************************************
% ******************* GRAPHS / FIGS (tikzpicture) ************************
% ***********************************************************


\tikzset{
    partial ellipse/.style args={#1:#2:#3}{
        insert path={+ (#1:#3) arc (#1:#2:#3)}
    }
}

\tikzset{middlearrow/.style={
        decoration={markings,
            mark= at position 0.55 with {\arrow[thick]{#1}} ,
        },
        postaction={decorate}
    }
}

\def\straight{\tikz[baseline=-0.5ex]{
\fill (0,0) circle (2pt) coordinate (A);
\fill (4ex,0) circle (2pt) coordinate (B);}
}

\def\empt{\tikz[baseline=-0.5ex,every node/.style={scale=0.9, inner sep=0pt}]{
\node[state,minimum size=5pt] (0) {~};
}}

\def\full{\tikz[baseline=-0.5ex,every node/.style={scale=0.9, inner sep=0pt}]{
\node[state,fill=black,minimum size=5pt] (0) {~};
}}

\def\emptempt{\tikz[baseline=-0.5ex,every node/.style={scale=1, inner sep=0pt}]{
\node[state,minimum size=5pt] (0) {~};
\node[state,right=6pt of 0,minimum size=5pt]                    (1) {~};}
}

\def\emptfull{\tikz[baseline=-0.5ex,every node/.style={scale=1, inner sep=0pt}]{
\node[state,minimum size=5pt] (0) {~};
\node[state,fill=black,right=6pt of 0,minimum size=5pt]                    (1) {~};}
}

\def\fullempt{\tikz[baseline=-0.5ex,every node/.style={scale=1, inner sep=0pt}]{
\node[state,fill=black,minimum size=5pt] (0) {~};
\node[state,right=6pt of 0,minimum size=5pt]                    (1) {~};}
}

\def\fullfull{\tikz[baseline=-0.5ex,every node/.style={scale=1, inner sep=0pt}]{
\node[state,fill=black,minimum size=5pt] (0) {~};
\node[state,fill=black,right=6pt of 0,minimum size=5pt]                    (1) {~};}
}



\newcommand{\lattice}{
\begin{tikzpicture}[scale=1, every node/.style={scale=1, inner sep=0pt}]

\node[state,fill=black,minimum size=5pt]                                   (0) {~};
\node[state,right=10pt of 0,minimum size=5pt]                    (1) {~};
\node[state,fill=black,right=10pt of 1,minimum size=5pt]                    (2) {~};
\node[state,fill=black, right=10pt of 2,minimum size=5pt]                    (3) {~};
\node[state,right=10pt of 3,minimum size=5pt]                    (5) {~};
\node[state,fill=black,right=10pt of 5,minimum size=5pt]                    (6) {~};
\node[state, right=10pt of 6,minimum size=5pt]                    (7) {~};
\node[state, right=10pt of 7,minimum size=5pt]                    (8) {~};
\node[state, fill=black, right=10pt of 8,minimum size=5pt]                    (9) {~};


\node[left=20pt of 0]                                   (left-2) {\dots};
\node[right=20pt of 9]                                   (right-1) {\ldots};

\node[above= 30pt of left-2] (deli-1){~};
\node[above= 30pt  of right-1] (deli-2){~};

\draw[dotted,-latex] (deli-1) --  (deli-2) ;

\pgfmathsetmacro{\slope}{0.5pt}

\pgfmathsetmacro{\basisHeight}{50}

  \foreach \x in {0,1,2,3,5,6,7,8,9}
    {        
           \draw ($ (\x)+(0,28pt)$) -- ($ (\x)+(0,34pt)$);
    }

 \draw[semithick] ($ (0)+(-15pt,\basisHeight pt)$) -- ($ (0)+(0,\basisHeight pt)+(0,\slope)$);
  \draw[semithick]  ($ (0)+(0,\basisHeight pt)+(0,\slope)$) -- ($ (1)+(0,\basisHeight pt)-(0,0*\slope)$) ;
    \draw[semithick]   ($ (1)+(0,\basisHeight pt)+(0,0*\slope)$) --  ($ (2)+(0,\basisHeight pt)+(0,\slope)$) ;
    \draw[semithick]   ($ (3)+(0,\basisHeight pt)+(0,2*\slope)$) --  ($ (2)+(0,\basisHeight pt)+(0,\slope)$) ;
        \draw[semithick]   ($ (3)+(0,\basisHeight pt)+(0,2*\slope)$) --  ($ (5)+(0,\basisHeight pt)+(0,1*\slope)$) ;
                \draw[semithick]   ($ (6)+(0,\basisHeight pt)+(0,2*\slope)$) --  ($ (5)+(0,\basisHeight pt)+(0,1*\slope)$) ;
   \draw[semithick]   ($ (6)+(0,\basisHeight pt)+(0,2*\slope)$) --  ($ (7)+(0,\basisHeight pt)+(0,1*\slope)$) ;
     \draw[semithick]   ($ (8)+(0,\basisHeight pt)+(0,0*\slope)$) --  ($ (7)+(0,\basisHeight pt)+(0,1*\slope)$) ;
          \draw[semithick]   ($ (8)+(0,\basisHeight pt)+(0,0*\slope)$) --  ($ (9)+(0,\basisHeight pt)+(0,1*\slope)$) ;
          
          
 \draw[dashed,semithick]   ($ (6)+(0,\basisHeight pt)+(0,0*\slope)$) --  ($ (5)+(0,\basisHeight pt)+(0,1*\slope)$) ;
   \draw[dashed,semithick]   ($ (6)+(0,\basisHeight pt)+(0,0*\slope)$) --  ($ (7)+(0,\basisHeight pt)+(0,1*\slope)$) ;
   
   \draw[latex -,shorten >=6pt,shorten <=6pt] ($ (6)+(0,\basisHeight pt)+(0,0*\slope)$) --($ (6)+(0,\basisHeight pt)+(0,2*\slope)$) ;
   \node[above=1.6*\basisHeight  pt of 6]      (60) {$\rmd W^j_t$};
            \node[below=5  pt of 6]      (600) {$j'$};   
   
   \draw[dashed,semithick]  ($ (0)+(0,\basisHeight pt)+(0,\slope)$) -- ($ (1)+(0,\basisHeight pt)+(0,2*\slope)$) ;
    \draw[dashed,semithick]   ($ (1)+(0,\basisHeight pt)+(0,2*\slope)$) --  ($ (2)+(0,\basisHeight pt)+(0,\slope)$) ;  

   \draw[ -latex,shorten >=6pt,shorten <=6pt] ($ (1)+(0,\basisHeight pt)+(0,0*\slope)$) --($ (1)+(0,\basisHeight pt)+(0,2*\slope)$) ;
      \node[above=1.6*\basisHeight  pt of 1]      (10) {$\rmd \overline{W}^{j'}_t$};
            \node[below=5  pt of 1]      (100) {$j'$};

\path (1.90) edge[thick,bend right=-50,latex'-] (2.90);
\path (6.90) edge[thick,bend right=-50,-latex'] (7.90);

\end{tikzpicture}
}


\newcommand{\latticeQuantum}{
\begin{tikzpicture}[scale=1, every node/.style={scale=1}]
\node[state,fill=black,minimum size=4pt]                    (0) {~};
\node[above=3pt] at (0.north) {$ x-1 $};
\node[state,fill=black,right=50pt of 0,minimum size=4pt]                    (1) {~};
\node[above=3pt] at (1.north) {$ x $};
\node[state,fill=black, right=50pt of 1,minimum size=4pt]                    (2) {~};
\node[above=3pt] at (2.north) {$ x+1 $};


\path (1.300) edge[bend right=40,-latex] (2.240);
\node[below=11pt] at ($0.5*(1.south)+0.5*(2.south)$.north) {$ w_{x,t} $};

\path (1.60) edge[dotted,bend right=-40,latex-] (2.120);
\node[above=11pt] at ($0.5*(0.north)+0.5*(1.north)$.north) {$ 1-w_{x,t} $};

\path (0.300) edge[dotted,bend right=40,-latex] (1.240);
\path (0.60) edge[bend right=-40,latex-] (1.120);


\end{tikzpicture}
}

%%%%%%%% Former work of Tony %%%%%%%%%




\newcommand{\singleloop}[3] {
\begin{tikzpicture}[scale=#3,baseline={([yshift=-3pt]current bounding box.center)}]
\draw[middlearrow={to}] (-1.3,0) arc (180:90:1.3cm and 0.8cm);
\draw[middlearrow={to}] (0,0.8) arc (90:0:1.3cm and 0.8cm);
\draw[middlearrow={to}] (1.3,0) arc (0:-90:1.3cm and 0.8cm);
\draw[middlearrow={to}] (0,-0.8) arc (-90:-180:1.3cm and 0.8cm);
\draw [fill=gray!30] (-1.3,0) circle (0.3);
\node[scale=#3] at (-1.3,0) {A};
\draw [fill=gray!30] (1.3,0) circle (0.3);
\node[scale=#3] at (1.3,0) {B};
\draw [fill] (0,0.8) circle (0.1);
\node[below,scale=1.3*#3] at (0,0.75) {$#1$};
\draw [fill] (0,-0.8) circle (0.1);
\node[above,scale=1.3*#3] at (0,-0.75) {$#2$};
\end{tikzpicture}}

\newcommand{\contact}[2]{
\begin{tikzpicture}[scale=#2,baseline={([yshift=-3pt]current bounding box.center)}]
    \draw[middlearrow={to}] (-1,0) arc (180:0:1cm and 0.8cm);
    \draw[middlearrow={to}] (1,0) arc (0:-180:1cm and 0.8cm);
    \draw [fill=gray!30] (-1,0) circle (0.3);
    \node[scale=#2] at (-1,0) {A};
    \draw[middlearrow={to}] (1,0) arc (180:0:1cm and 0.8cm);
    \draw[middlearrow={to}] (3,0) arc (0:-180:1cm and 0.8cm);    
    \draw [fill=gray!30] (3,0) circle (0.3);
    \node[scale=#2] at (3,0) {B};
    \draw [fill] (1,0) circle (0.1); 
    \node[right,scale=1.5*#2] at(1.1,0) {$#1$};
\end{tikzpicture}}

\newcommand{\superp}[2]{
\begin{tikzpicture}[scale=#2,baseline={([yshift=-3pt]current bounding box.center)}]
    \draw[middlearrow={to}] (-1,0) arc (180:0:1cm and 0.8cm);
    \draw[middlearrow={to}] (1,0) arc (0:-180:1cm and 0.8cm);
    \draw [fill=gray!30] (-1,0) circle (0.3);
    \node[scale=#2] at (-1,0) {A};
    \draw[middlearrow={to}] (1,0.2) arc (180:0:1cm and 0.8cm);
    \draw[middlearrow={to}] (3,0.2) arc (0:-180:1cm and 0.8cm);   
    \draw [fill=gray!30] (3,0.2) circle (0.3);
    \node[scale=#2] at (3,0.2) {B};
    \draw [fill] (1,0) circle (0.1); 
    \node[right,scale=1.5*#2] at(1.1,0) {$#1$};
    \draw [fill] (1,0.2) circle (0.1);
\end{tikzpicture}}

\newcommand{\croises}[3]{
\begin{tikzpicture}[scale=#3,baseline={([yshift=-3pt]current bounding box.center)}]
    \draw[middlearrow={to}] (-1,0) arc (180:0:1cm and 0.8cm);
    \draw[middlearrow={to}] (1,0) arc (0:-180:1cm and 0.8cm);
    \draw [fill=gray!30] (-1,0) circle (0.3);
    \node[scale=#3] at (-1,0) {A};
    \draw[middlearrow={to}] (0.7,0) arc (180:0:1cm and 0.8cm);
    \draw[middlearrow={to}] (2.7,0) arc (0:-180:1cm and 0.8cm);    
    \draw [fill=gray!30] (2.7,0) circle (0.3);
    \node[scale=#3] at (2.7,0) {B};
    \draw [fill] (1,0) circle (0.1) node[right,scale=1.5*#3] {$#2$};
    \draw [fill] (0.7,0) circle (0.1) node[left,scale=1.5*#3] {$#1$};
\end{tikzpicture}}

\newcommand{\separes}[3]{
\begin{tikzpicture}[scale=#3,baseline={([yshift=-3pt]current bounding box.center)}]
    \draw[middlearrow={to}] (-1,0) arc (180:0:1cm and 0.8cm);
    \draw[middlearrow={to}] (1,0) arc (0:-180:1cm and 0.8cm);    
    \draw [fill=gray!30] (-1,0) circle (0.3);
    \node[scale=#3] at (-1,0) {A};
    \draw[middlearrow={to}] (1.3,0) arc (180:0:1cm and 0.8cm);
    \draw[middlearrow={to}] (3.3,0) arc (0:-180:1cm and 0.8cm);    
    \draw [fill=gray!30] (3.3,0) circle (0.3);
    \node[scale=#3] at (3.3,0) {B};
    \draw [fill] (1.3,0) circle (0.1) node[right,scale=1.5*#3] {$#2$};
    \draw [fill] (1,0) circle (0.1) node[left,scale=1.5*#3] {$#1$};
\end{tikzpicture}} 

\newcommand{\oneloopg}[2]{
\begin{tikzpicture}[scale=#2,baseline={([yshift=-3pt]current bounding box.center)}]
    \draw[middlearrow={to}] (-1,0) arc (180:0:1cm and 0.8cm);
    \draw[middlearrow={to}] (1,0) arc (0:-180:1cm and 0.8cm);    
    \draw [fill=gray!30] (-1,0) circle (0.3);
    \node[scale=#2] at (-1,0) {A};
    \draw [fill] (1,0) circle (0.1) node[right,scale=1.5*#2] {$#1$};
\end{tikzpicture}} 

\newcommand{\oneloopd}[2]{
\begin{tikzpicture}[scale=#2,baseline={([yshift=-3pt]current bounding box.center)}]
    \draw[middlearrow={to}] (0,0) arc (180:0:1cm and 0.8cm);
    \draw[middlearrow={to}] (2,0) arc (0:-180:1cm and 0.8cm);    
    \draw [fill=gray!30] (2,0) circle (0.3);
    \node[scale=#2] at (2,0) {B};
    \draw [fill] (0,0) circle (0.1) node[left,scale=1.5*#2] {$#1$};
\end{tikzpicture}} 

\newcommand{\graphN}[2]
{
\FPeval{\a}{round(#2 *(-.23),2)}
\FPeval{\b}{round(#2 *(-.1),2)}
\FPeval{\c}{round(#2 * (.22),2)}
\FPeval{\d}{round(#2 *(0.67),2)}
\FPeval{\e}{round(#2 *(2)-#2*#2/2 ,2)}
\begin{tikzpicture}[baseline={([yshift=-3pt]current bounding box.center)}]
\SetVertexSimple
\useasboundingbox (\a,\b) rectangle (\c,\d);
\tikzset{VertexStyle/.append style={minimum size=2pt, inner sep=1pt}}
\Vertex{a} 
\node[left,scale=1.7*#2] at (0,0) {$#1$};
\begin{scope}[decoration={markings,mark = at position 0.55 with {\arrow[scale=\e]{to}}}]
\Loop[dist=#2 cm,dir=NO,style={thin,postaction={decorate}}](a)
\end{scope}
\end{tikzpicture}
}

\newcommand{\graphNcroixdeux}[3]
{
\graphN{#1}{#3} \hspace{3.5pt} \graphN{#2}{#3}
}

\newcommand{\graphNcroixtrois}[4]
{
\graphN{#1}{#4} \hspace{3.5pt} \graphN{#2}{#4} \hspace{3.5pt} \graphN{#3}{#4}
}

\newcommand{\graphNdeux}[2]
{
\FPeval{\a}{round(#2 *(-.65),2)}
\FPeval{\b}{round(#2 *(-.265),3)}
\FPeval{\c}{round(#2 * (.66),2)}
\FPeval{\d}{round(#2 *(.24),2)}
\FPeval{\e}{round(#2 *(2)-#2*#2/2 ,2)}
\begin{tikzpicture}[baseline={([yshift=-3pt]current bounding box.center)}]
\GraphInit[vstyle=Classic]
\SetVertexSimple
\useasboundingbox (\a,\b) rectangle (\c,\d); 
\tikzset{VertexStyle/.append style={minimum size=2pt, inner sep=1pt}}
\Vertex{a}
\node[below,scale=1.7*#2] at (0,0) {$#1$};
\begin{scope}[decoration={markings,mark = at position 0.55 with {\arrow[thin, scale=\e]{to}}}]
\Loop[dist=#2 cm,dir=WE,style={thin,postaction={decorate}}](a)
\Loop[dist=#2 cm,dir=EA,style={thin,postaction={decorate}}](a)
\end{scope}
\end{tikzpicture}
}


\newcommand{\graphFdeux}[3]
{
\begin{tikzpicture}[baseline={([yshift=0pt]current bounding box.center)},scale=#3]
\GraphInit[vstyle=Classic]
\SetVertexSimple
\tikzset{VertexStyle/.append style={minimum size=2pt, inner sep=1pt}}
\Vertex{a} \node[below,scale=1.7*#3] at (0,0) {$#1$};
\EA(a){b} \node[below,scale=1.7*#3] at(1,0) {$#2$};
\begin{scope}[decoration={markings,mark = at position 0.55 with {\arrow[thin, scale=#3*2]{to}}}]
\tikzset{EdgeStyle/.style = {thin,postaction={decorate},bend left=75}}
\Edge(b)(a)
\Edge(a)(b)
\end{scope}
\end{tikzpicture}
}
\newcommand{\graphFdeuxpointN}[3]
{
\begin{tikzpicture}[baseline={([yshift=0pt]current bounding box.center)},scale=#3]
\GraphInit[vstyle=Classic]
\SetGraphUnit{#3}
\SetVertexSimple
\tikzset{VertexStyle/.append style={minimum size=2pt, inner sep=1pt}}
\Vertex{a}
\node[below,scale=#3*1.2]{$#1$};
\EA(a){b}
\node[below,scale=#3*1.2] at (#3*1.1,0){$#2$};
\begin{scope}[decoration={markings,mark = at position 0.55 with {\arrow[thin, scale=#3*2]{to}}}]
\tikzset{EdgeStyle/.style = {thin,postaction={decorate},bend left=75}}
\Edge(b)(a)
\Edge(a)(b)
\tikzset{EdgeStyle/.style = {thin,postaction={decorate}}}
\Loop[dist=#3 cm,dir=EA,style={thin,postaction={decorate}}](b)
\end{scope}
\end{tikzpicture}
}

\newcommand{\graphNpointFdeux}[3]
{
\begin{tikzpicture}[baseline={([yshift=0pt]current bounding box.center)},scale=#3]
\GraphInit[vstyle=Classic]
\SetGraphUnit{#3}
\SetVertexSimple
\tikzset{VertexStyle/.append style={minimum size=2pt, inner sep=1pt}}
\Vertex{a}
\node[below,scale=#3*1.2]{$#1$};
\EA(a){b}
\node[below,scale=#3*1.2] at (#3*1.1,0){$#2$};
\begin{scope}[decoration={markings,mark = at position 0.55 with {\arrow[thin, scale=#3*2]{to}}}]
\tikzset{EdgeStyle/.style = {thin,postaction={decorate},bend left=75}}
\Edge(b)(a)
\Edge(a)(b)
\tikzset{EdgeStyle/.style = {thin,postaction={decorate}}}
\Loop[dist=#3 cm,dir=WE,style={thin,postaction={decorate}}](a)
\end{scope}
\end{tikzpicture}
}
\newcommand{\graphNdeuxcroixN}[3]
{
\graphNdeux{#1}{#3} \hspace{3.5pt} \graphN{#2}{#3}
}

\newcommand{\graphNcroixNdeux}[3]
{
\graphN{#1}{#3} \hspace{3.5pt} \graphNdeux{#2}{#3}
}

\newcommand{\graphNcroixFdeux}[4]
{
\graphN{#1}{#4} \hspace{3.5pt} \graphFdeux{#2}{#3}{#4}
}

\newcommand{\graphNcroixmFdeux}[4]
{
\begin{tikzpicture}[baseline={([yshift=-3pt]current bounding box.center)},scale=#4]
\GraphInit[vstyle=Classic] 
\SetVertexSimple
\tikzset{VertexStyle/.append style={minimum size=2pt, inner sep=1pt}}
\Vertex{a}
\node[below,scale=#4*1.5]{$#1$};
\EA(a){b}
\node[below,scale=#4*1.5] at (1.1,0){$#3$};
\Vertex[x=0.5,y=0]{c}
\node[below,scale=#4*1.5] at (0.7,-0.2){$#2$};
\begin{scope}[decoration={markings,mark = at position 0.55 with {\arrow[thin, scale=#4*1.7]{to}}}]
\tikzset{EdgeStyle/.style = {thin,postaction={decorate},bend left=75}}
\Edge(b)(a)
\Edge(a)(b)
\tikzset{EdgeStyle/.style = {thin,postaction={decorate}}}
\Loop[dist=1cm,dir=NO,style={thin,postaction={decorate}}](c)
\end{scope}
\end{tikzpicture}
}

\newcommand{\graphFdeuxcroixN}[4]
{
 \graphFdeux{#1}{#2}{#4} \hspace{7pt} \graphN{#3}{#4}
}
\newcommand{\graphNtrois}[2]
{
\begin{tikzpicture}[baseline={([yshift=0pt]current bounding box.center)},scale=#2]
\GraphInit[vstyle=Classic]
\SetVertexSimple
\tikzset{VertexStyle/.append style={minimum size=2pt, inner sep=1pt}}
\Vertex{a}
\node[below,scale=#2*1.7]{$#1$};
\begin{scope}[decoration={markings,mark = at position 0.57 with {\arrow[thin, scale=#2*2.3]{to}}}]
\Loop[dist=1 cm,dir=NO,style={thin,postaction={decorate}}](a)
\Loop[dist=1 cm,dir=EA,style={thin,postaction={decorate}}](a)
\Loop[dist=1 cm,dir=WE,style={thin,postaction={decorate}}](a)\end{scope}
\end{tikzpicture}
}
\newcommand{\graphFtrois}[4]
{
\begin{tikzpicture}[baseline={([yshift=-3pt]current bounding box.center)},scale=#4]
\GraphInit[vstyle=Classic]
\SetVertexSimple
\tikzset{VertexStyle/.append style={minimum size=2pt, inner sep=1pt}}
\begin{scope}[decoration={markings,mark = at position 0.55 with {\arrow[thin, scale=#4*4]{to}}}]
\tikzset{EdgeStyle/.style = {thin,postaction={decorate},bend right}}
\Vertices{circle}{$#3$,$#2$,$#1$}
\node[right,scale=#4*3] at(1,0){$#2$};
\node[left,scale=#4*3] at(-0.9,1){$#3$};
\node[left,scale=#4*3] at(-0.9,-1){$#1$};
\Edges($#3$,$#2$,$#1$,$#3$)
\end{scope}
\end{tikzpicture}
}

\newcommand{\graphFquatre}[5]
{ 
\begin{tikzpicture}[baseline={([yshift=0pt]current bounding box.center)},scale=#5]
\SetVertexSimple
\tikzset{VertexStyle/.append style={minimum size=2pt, inner sep=1pt}}
\begin{scope}[decoration={markings,mark = at position 0.55 with {\arrow[thin, scale=#5*2.5]{to}}}]
\tikzset{EdgeStyle/.style = {thin,postaction={decorate},bend right}}
\Vertex[x=-0.7,y=-0.7]{a}
\node[left,scale=#5*1.5] at (-0.7,-0.7){$#1$};
\Vertex[x=0.7,y=-0.7]{b}
\node[right,scale=#5*1.5] at (0.7,-0.7){$#2$};
\Vertex[x=0.7,y=0.7]{c}
\node[right,scale=#5*1.5] at (0.7,0.7){$#3$};
\Vertex[x=-0.7,y=0.7]{d}
\node[left,scale=#5*1.5] at (-0.7,0.7){$#4$};
\Edges(a,b,c,d,a)
\end{scope}
\end{tikzpicture}
}



% ***********************************************************
% ********************** END HEADER *************************
% ***********************************************************