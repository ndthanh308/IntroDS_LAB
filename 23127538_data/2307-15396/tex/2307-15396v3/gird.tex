\section{Regression setting for the Grid case}

Let $f^*:[0,1]\rightarrow \IR$ be $G$-Lipschitz.
%, i.e. $\lip{f^*}=G$. 
Consider the 
%following joint 
distribution $(x,y) \sim \dist$ on 
%space $(\mathcal{X} \times \mathcal{Y})=[0,1] \times \IR$. 
$[0,1] \times \IR$, such that
%The marginal 
$x \sim \unif([0,1])$ and $y=f^*(x)+\eps$, where $\eps\sim \normal(0,\sigma^2)$ for a fixed constant $\sigma > 0$.

%As a warm-up, we first
First, we
analyze the expected risk of the predictor we may get by training on the dataset $S=\{(x_i,y_i): i\in \{0,\dots,n\} \}$, where the $x_i$'s come from the grid on $[0,1]$ with uniform spacing between the points. 
%In particular, consider the following way of generating 
Namely, consider
the training set $S=\{(x_i,y_i): i=0,1,\dots n \}$, where
\begin{equation} \label{eq:grid-data}
    x_i=\frac{i}{n} \hspace{2mm} \text{and} \hspace{2mm} y_i=f^*(x_i)+\eps_i, \hspace{5mm} \text{where } \eps_i \sim \normal(0,\sigma^2)~.
\end{equation}
Note that the randomness here is only in the labels. 
 
For a function $f$, we denote
$L_p(f)=\Exp_{(x,y)\sim \dist} [|f(x)-y|^p]$. %Then, the worst-case risk w.r.t. $L_p$ of a predictor in $\ridgeless(S)$ is given by
%\[
%    L_p(\hat{f}_0)= \Exp_S \sup_{f \in \ridgeless(S)} [L_p(f)]~.
%\]
 \begin{theorem} 
 For the training set from \eqref{eq:grid-data} and any $p \in \IN_{+}$, we have
 \[
 \lim_{n \rightarrow \infty} \Exp_S \sup_{\hat{f} \in \ridgeless(S)} [L_p(\hat{f})] \leq 18^p \, L_p^*~,
 \]
 where $L_p^*=L_p(f^*)$ is the Bayes error.
\end{theorem}
\begin{proof}
First, we observe that the distance between two consecutive $x_i$'s is $1/n$. The domain $[0,1]$ is divided into $n$ intervals of length $1/n$. Let $g_i: \IR \rightarrow \IR$ be the affine function 
%which is just 
given by the straight line joining the endpoints of the $i$-th interval $(x_{i-1},y_{i-1})$ and $(x_i,y_i)$ for every $i\in[n]$. 

\nirmit{The following could actually be a lemma because it is helpful in almost all proofs. It requires some casework also to prove.}
Fix any $i\in \{2,\dots,n-1\}$, and consider $x\in [x_{i-1},x_i]$:
%$ \min\{ g_i(x), \min\{g_{i+1}(x) , g_{i-1}(x)\}\} \leq \hat{f}(x) \leq \max\{ g_i(x), \min\{g_{i+1}(x) , g_{i-1}(x)\}\}$ \\
 \[
 |\hat{f}(x)-f^*(x)| \leq \max\left\{ |g_i(x)-f^*(x)|, \min\{|g_{i+1}(x)-f^*(x)|, |g_{i-1}(x)-f^*(x)|\}\right\}~,
 \]
 and for $i\in\{1,n\}:$
 \[ 
 |\hat{f}(x)-f^*(x)| = |g_i(x)-f^*(x)|~.
 \]
 We can simplify each one by one.
\begin{align*}
 |g_i(x)-f^*(x)|=&\left| y_{i-1}+ \frac{(y_{i}-y_{i-1})}{x_{i}-x_{i-1}} (x-x_{i-1})-f^*(x)\right|\\
 =& \left| f^*(x_{i-1})+\eps_{i-1} + \frac{f^*(x_i)+\eps_i-f^*(x_{i-1})-\eps_{i-1}}{x_{i}-x_{i-1}}(x-x_{i-1}) -f^*(x)\right| \\
 \leq & \left| f^*(x_{i-1}) -f^*(x)\right|+ |\eps_{i-1}|+ \left( \frac{G/n+|\eps_i|+|\eps_{i-1}|}{1/n} \right)\cdot  \left| (x-x_{i-1}) \right| \\
 \leq & \frac{G}{n}+ |\eps_{i-1}|+ \left( \frac{G/n+|\eps_i|+|\eps_{i-1}|}{1/n} \right) \cdot \frac{1}{n} \\
 = &\frac{2G}{n}+ |\eps_i|+2 |\eps_{i-1}|.
\end{align*}
Similarly,
\begin{align*}
 |g_{i-1}(x)-f^*(x)|=&\left| y_{i-1}+ \frac{(y_{i-1}-y_{i-2})}{x_{i-1}-x_{i-2}} (x-x_{i-1})-f^*(x)\right|\\
 =& \left| f^*(x_{i-1})+\eps_{i-1} + \frac{f^*(x_{i-1})+\eps_{i-1}-f^*(x_{i-2})-\eps_{i-2}}{x_{i-1}-x_{i-2}}(x-x_{i-1}) -f^*(x)\right| \\
 \leq & \left| f^*(x_{i-1}) -f^*(x)\right|+ |\eps_{i-1}|+ \left( \frac{G/n+|\eps_{i-1}|+|\eps_{i-2}|}{1/n} \right) \left| (x-x_{i-1}) \right| \\
 \leq & \frac{G}{n}+ |\eps_{i-1}|+ \left( \frac{G/n+ |\eps_{i-1}|+|\eps_{i-2}|}{1/n} \right)\cdot \frac{1}{n} \\
 = &\frac{2G}{n}+ 2|\eps_{i-1}|+|\eps_{i-2}|.
\end{align*}

Using a similar strategy, we also bound:
\begin{align*}
 |g_{i+1}(x)-f^*(x)|=&\left| y_{i}+ \frac{(y_{i+1}-y_{i})}{x_{i+1}-x_{i}} (x-x_{i})-f^*(x)\right|\\
 =& \left| f^*(x_{i})+\eps_{i} + \frac{f^*(x_{i+1})+\eps_{i+1}-f^*(x_{i})-\eps_{i}}{x_{i+1}-x_{i}}(x-x_{i}) -f^*(x)\right| \\
 \leq & \left| f^*(x_{i}) -f^*(x)\right|+ |\eps_{i}|+ \left( \frac{G/n+|\eps_{i+1}|+|\eps_{i}|}{1/n} \right) \left| (x-x_{i-1}) \right| \\
 \leq & \frac{G}{n}+ |\eps_{i}|+ \left( \frac{G/n+|\eps_{i+1}|+|\eps_{i}|}{1/n} \right) \cdot \frac{1}{n}\\
 = &\frac{2G}{n}+ 2|\eps_{i}|+|\eps_{i+1}|.
\end{align*}
Therefore, combining the above three, for $x$ in the intermediate intervals:
\begin{align*}
    |\hat{f}(x)-f^*(x)| &\leq \max\left\{\frac{2G}{n}+2|\eps_{i-1}|+|\eps_i|, \frac{2G}{n}+2|\eps_{i-1}|+|\eps_{i-2}|,\frac{2G}{n}+2|\eps_i|+|\eps_{i+1}|\right\} \\
    & \leq \frac{2G}{n}+2|\eps_i|+2|\eps_{i-1}|+|\eps_{i-2}|+|\eps_{i+1}|~.
\end{align*}

Therefore,
\begin{align}
  \Exp_{x\sim \unif([0,1])} \left[ |\hat{f}(x)-f^*(x)|^p \right] &= \sum_{i=1}^{n} \prob{x\in [x_{i-1},x_i)} \Exp \left[|\hat{f}(x)-f^*(x)|^p \mid x\in [x_{i-1},x_i) \right]  \nonumber\\
  & \leq \frac{1}{n} \Big[ \underbrace{\left(\frac{2G}{n}+2|\eps_0|+|\eps_1|\right)^p}_{:=T_1}+ \underbrace{\sum_{i=2}^{n-1} \left( \frac{2G}{n}+2|\eps_i|+2|\eps_{i-1}|+|\eps_{i-2}|+|\eps_{i+1}| \right)^p}_{:=T_2} \nonumber\\
  & + \underbrace{\left(\frac{2G}{n}+2|\eps_{n-1}|+|\eps_{n}| \right)^p}_{:=T_3}  \Big] \label{eq:grid-three-terms}
 % &\leq \frac{2^p}{n} \sum_{i=1}^{n} \left( (|\eps_i|+|\eps_{i-1}|+|\eps_{i-2}|+|\eps_{i+1}|)^p + \sum_{j=1}^{p} \binom{p}{j} \left(\frac{G}{n}\right)^j (|\eps_i|+2|\eps_{i-1}|+|\eps_{i-2}|+|\eps_{i+1}|)^{p-j} \right) \\
\end{align}

Thus, we get
\begin{align*}
\Exp_S \Exp_{x \sim \unif([0,1])}[|\hat{f}(x)-f^*(x)|^p ]& \leq  \Exp_S \left[ \frac{T_1 + T_2 +T_3}{n} \right] \\
\end{align*}
Since for any fixed $p$, the $p$-th moment of folded Gaussian is finite,
 \begin{align}
     \lim_{n\rightarrow \infty}  \frac{\Exp_S \left[T_1\right]}{n}= \lim_{n\rightarrow \infty}  \frac{\Exp_S \left[\left(2G/n+2|\eps_0|+|\eps_1|\right)^p\right]}{n} = 0. \label{eq:gird-term1-limit}
 \end{align}
 For the same reason,
 \begin{align}
     \lim_{n\rightarrow \infty}  \frac{\Exp_S \left[T_3\right]}{n}= \lim_{n\rightarrow \infty}  \frac{\Exp_S \left[\left(2G/n+|\eps_{n-1}|+|\eps_{n}|\right)^p\right]}{n} = 0 ~.\label{eq:gird-term3-limit}
 \end{align}
 Now,
 \begin{align*}
 \frac{\Exp_S \left[ T_2\right]}{n} &= \frac{1}{n} \cdot  \Exp_S \sum_{i=2}^{n-1} \left( \frac{2G}{n}+2|\eps_i|+2|\eps_{i-1}|+|\eps_{i-2}|+|\eps_{i+1}| \right)^p \\
 &= \frac{2^p}{n} \cdot  \Exp_S \sum_{i=2}^{n-1} \left( \frac{G}{n}+|\eps_i|+|\eps_{i-1}|+|\eps_{i-2}|+|\eps_{i+1}| \right)^p \\
     &\leq \frac{2^p}{n} \sum_{i=2}^{n-1} \Exp_{S} \left( (|\eps_i|+|\eps_{i-1}|+|\eps_{i-2}|+|\eps_{i+1}|)^p + \sum_{j=1}^{p} \binom{p}{j} \left(\frac{G}{n}\right)^j (|\eps_i|+|\eps_{i-1}|+|\eps_{i-2}|+|\eps_{i+1}|)^{p-j} \right) 
\end{align*}
Let $Y=|Y_1|+|Y_2|+|Y_3|+|Y_4|$, where $Y_i \iid \normal(0,\sigma^2)$, i.e. $Y$ is the sum of the absolute values of four independent Gaussians. Clearly, for any finite $p'$, we have that for some finite constant $B:=B(p')$
\[
\Exp[Y^{p'}]=B(p') \leq 4^{p'} \Exp |Y_1|^{p'} = 4^{p'} \cdot \sigma^{p'} \sqrt{\frac{2^{p'}}{\pi}}\Gamma \left( \frac{p'+1}{2}\right)~.
\]
Hence,
 \begin{align*}
     \frac{\Exp_S \left[ T_2\right]}{n} 
     &\leq \frac{2^p}{n} \sum_{i=2}^{n-1} \Exp_{S} \left( (|\eps_i|+|\eps_{i-1}|+|\eps_{i-2}|+|\eps_{i+1}|)^p + \sum_{j=1}^{p} \binom{p}{j} \left(\frac{G}{n}\right)^j (|\eps_i|+|\eps_{i-1}|+|\eps_{i-2}|+|\eps_{i+1}|)^{p-j} \right) \\
&\leq \frac{2^p}{n} \left( \sum_{i=2}^{n-1} \left( B(p)+ \sum_{j=1}^{p} \binom{p}{j} \left(\frac{G}{n}\right)^j B(p-j) \right)\right)\\
&= \frac{2^p(n-2)}{n}  \left( B(p)+ \sum_{j=1}^{p} \binom{p}{j} \left(\frac{G}{n}\right)^j B(p-j) \right)\\
\lim_{n\rightarrow \infty} \frac{\Exp_S \left[ T_2\right]}{n} 
& \leq \lim_{n \rightarrow \infty} \frac{2^p(n-2)}{n}  \left( B(p)+ \sum_{j=1}^{p} \binom{p}{j} \left(\frac{G}{n}\right)^j B(p-j) \right)\\
&= 2^p \cdot B(p) \leq 8^p \cdot \sigma^p \cdot \sqrt{\frac{2^p}{\pi}} \Gamma \left( \frac{p+1}{2}\right)~. \label{eq:grid-term2-limit}
 \end{align*}
Therefore, finally, we can analyze
 \begin{align*}
 \Exp_S \sup_{\hat{f} \in \ridgeless(S)} [L_p(\hat{f})] & = \Exp_S \left[ \Exp_{(x,y)\sim \dist} \left[ |\hat{f}(x)-y|^p\right] \right]\\
 & \leq \Exp_S \left[ \Exp_{x\sim \unif([0,1]),\eps\sim \normal(0,\sigma^2)} \left[ |\hat{f}(x)-f^*(x)+\eps|^p\right] \right]\\
 & \leq  2^p \left[ \Exp_S \Exp_{x\sim \unif([0,1]),\eps\sim \normal(0,\sigma^2)} \left[ |\hat{f}(x)-f^*(x)|^p+|\eps|^p\right] \right]\\
 & \leq 2^p  \left[ \Exp_S \Exp_{x\sim \unif([0,1])} \left[ |\hat{f}(x)-f^*(x)|^p \right]+ \Exp_{\eps\sim \normal(0,\sigma^2)} |\eps|^p \right]~.
 \end{align*}
 Taking the limit on both sides as $n$ tends to $\infty$,
 \begin{align*}
  \lim_{n\rightarrow \infty} \Exp_S \sup_{\hat{f} \in \ridgeless(S)} [L_p(\hat{f})] &\leq 2^p \lim_{n \rightarrow \infty} \left[ \Exp_S \Exp_{x\sim \unif([0,1])} \left[ |\hat{f}(x)-f^*(x)|^p \right]+ \Exp_{\eps\sim \normal(0,\sigma^2)} |\eps|^p \right]\\
  & =  2^p \left[ \lim_{n \rightarrow \infty} \Exp_S \left[ \frac{T_1+T_2+T_3}{n} \right]+ \sigma^p \cdot \sqrt{\frac{2^p}{\pi}} \Gamma \left( \frac{p+1}{2}\right) \right]\\
  &\leq 2^p \left(0+ 8^p \sigma^p \cdot \sqrt{\frac{2^p}{\pi}} \Gamma \left( \frac{p+1}{2}\right) +0+\sigma^p \cdot \sqrt{\frac{2^p}{\pi}} \Gamma \left( \frac{p+1}{2}\right) \right)\\
  &\leq \frac{18^p \sqrt{2^p} \cdot \sigma^p}{\sqrt{\pi}} \Gamma \left( \frac{p+1}{2}\right)
 \end{align*}
\begin{align*}
L_p^*=L_p(f^*)&=\Exp_{(x,y)\sim \dist} \left[ |f^*(x)-y|^p\right]\\
    & = \Exp_{\eps\sim \normal (0,\sigma^2) }\left[ |f^*(x)-f^*(x)+\eps|^p \right] = \Exp_{\eps\sim \normal (0,\sigma^2) }\left[ |\eps|^p \right] \\
    &=  \sigma^p\cdot \sqrt{\frac{2^p}{\pi}} \Gamma \left( \frac{p+1}{2}\right)
   % &=  \frac{\sigma \sqrt{2}}{\pi^{\frac{1}{2p}}} \Gamma \left( \frac{p+1}{2}\right)^{1/p} 
\end{align*}
Therefore, combining the two
$$\lim_{n\rightarrow \infty} \Exp_S \sup_{\hat{f} \in \ridgeless(S)} [L_p(\hat{f})] \leq 18^p L_p^*.$$
\end{proof}