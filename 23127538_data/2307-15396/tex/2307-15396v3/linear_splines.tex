\section{Linear Splines}
We will sample $n-1$ points i.i.d. from $\dist$. For simplicity of exposition, we also assume that we get noisy labels corresponding to $x_0=0$ and $x_n=1$. We number the datapoints $S=\{(x_i,y_i): i=0,1,\dots,n\}$ such that
\begin{equation}
   0=x_0 \leq x_1 \leq x_2 \leq \dots \leq x_{n-1} \leq x_n=1, 
\end{equation}
\begin{equation}\label{eq:non-grid-dataset}
   \forall i \in [n], \hspace{1mm} y_i=f^*(x_i)+\eps_i\,\hspace{2mm} \text{where } \eps_i \sim \normal(0,\sigma^2).   
\end{equation}
Our goal is to analyze the risk of linear splines of the dataset $S$.
\begin{theorem}
 For the joint distribution specified as in the above, and any fixed $p \in \IN_{+}$, we have
 \[
 \lim_{n \rightarrow \infty} \Exp_S  [L_p(\hat{f}_{\text{spline}})] \leq c_p \, L_p^*~,
 \]
 where $L_p^*=L_p(f^*)$ is the Bayes error and $c_p$ is a constant that only depends on $p$.
\end{theorem}
\begin{proof}
 We have $n$ intervals in total: the $i$-th interval is $[x_{i-1},x_i)$. We denote their lengths by $\ell_1,\dots,\ell_n$ from left to right.
$$ \ell_i:= x_i-x_{i-1}.$$
Moreover, let $g_i:\IR \rightarrow \IR$ be the affine function joining the points $(x_{i-1},y_{i-1})$ and $(x_i,y_i)$. Thus, $g_i$ is the straight line joining the endpoints of the $i$-th interval. Then, 
%by definition 
the linear spline $\hat{f}_{\text{spline}}: [0,1]\rightarrow \IR$ satisfies
$$ \hat{f}_{\text{spline}}(x)= \sum_{i=1}^{n} g_i(x)\cdot \mathbf{1}\{x\in [x_{i-1},x_i)\}.$$
Fix any $i\in[n]$, and for any $x\in [x_{i-1},x_i)$,
\begin{align*}
 |\hat{f}_{\text{spline}}(x)-f^*(x)| &= |g_i(x)-f^*(x)| \\
 =&\left| y_{i-1}+ \frac{(y_{i}-y_{i-1})}{x_{i}-x_{i-1}} (x-x_{i-1})-f^*(x)\right|\\
 =& \left| f^*(x_{i-1})+\eps_{i-1} + \left(\frac{f^*(x_i)+\eps_i-f^*(x_{i-1})-\eps_{i-1}}{x_{i}-x_{i-1}}\right)(x-x_{i-1}) -f^*(x)\right| \\
 \leq & \left| f^*(x_{i-1}) -f^*(x)\right|+ |\eps_{i-1}|+ \left| \frac{G(x_i-x_{i-1})+\eps_i-\eps_{i-1}}{x_i-x_{i-1}} \right|  (x-x_{i-1})  \\
 \leq &  G(x-x_{i-1}) + |\eps_{i-1}|+ \left( \frac{G(x_i-x_{i-1})+|\eps_i|+|\eps_{i-1}|}{x_i-x_{i-1}} \right)  (x-x_{i-1})  \\
 \leq & G \cdot \ell_i + |\eps_{i-1}|+ \left( \frac{G \cdot \ell_i +|\eps_i|+|\eps_{i-1}|}{\ell_i} \right) \cdot \ell_i\\
 = & 2G \cdot \ell_i + |\eps_i|+2 |\eps_{i-1}|.
\end{align*}

Hence,
\begin{align}
  \Exp_{x \sim \unif{[0,1]}} \left[ |\hat{f}_{\text{spline}}(x)-f^*(x)|^p \right] &\leq \sum_{i=1}^{n} \prob{x\in [x_{i-1},x_i)} \Exp \left[|\hat{f}_{\text{spline}}(x)-f^*(x)|^p \mid x\in [x_{i-1},x_i) \right]  \nonumber\\
  & \leq \sum_{i=1}^{n} \ell_i \left( 2G \cdot \ell_i + |\eps_i|+2 |\eps_{i-1}|\right)^p \nonumber\\
  &= \sum_{i=1}^{n} \left[ \ell_i \left( (|\eps_i|+2|\eps_{i-1}|)^p +\sum_{j=1}^{p} \binom{p}{j} (2G \cdot \ell_i)^j (|\eps_i|+2|\eps_{i-1}|)^{p-j} \right) \right]
\end{align}
Therefore, taking the expectation with respect to $S$,
\begin{align*}
    \Exp_S \left[  \Exp_{x \sim \unif{[0,1]}} \left[ |\hat{f}_{\text{spline}}(x)-f^*(x)|^p \right] \right] & \leq \sum_{i=1}^{n} \Exp_S \left[ \ell_i \left( (|\eps_i|+2|\eps_{i-1}|)^p +\sum_{j=1}^{p} \binom{p}{j} (2G \cdot \ell_i)^j (|\eps_i|+2|\eps_{i-1}|)^{p-j} \right) \right]\\
    & \leq  \sum_{i=1}^{n}\left( \Exp_S \left[ \ell_i(|\eps_i|+2|\eps_{i-1}|)^p \right] +\sum_{j=1}^{p} \binom{p}{j} (2G)^j \cdot \Exp_S \left[ (\ell_i)^{j+1} (|\eps_i|+2|\eps_{i-1}|)^{p-j} \right] \right) \\
    &= \sum_{i=1}^{n} \sum_{j=1}^{p} \Exp_S \left[ T_j\right],
\end{align*}
where  $T_j:=\binom{p}{j}(2G)^j {\ell_i}^{j+1} (|\eps_i|+2|\eps_{i-1}|)^{p-j}$. Let $Y_1,Y_2 \iid \normal(0,\sigma^2)$. And let $Y=2|Y_1|+|Y_2|$. Then it is well-known that, for any finite $p'$, $\Exp[Y^{p'}]$ is finite, which we denote by $B(p')$.
\begin{align*}
    B(p')&=\Exp \left[ Y^{p'} \right] = \Exp \left[(2|Y_1|+|Y_2|)^{p'} \right] \leq 2^p \Exp \left[(|Y_1|+|Y_2|)^{p'} \right]\\
    & \leq 4^{p'} \Exp \left[ |Y_1|^{p'}+|Y_2|^{p'} \right] \leq 2 \cdot 4^{p'} \cdot \sigma^{p'} \cdot \sqrt{\frac{2^{p'}}{\pi}} \Gamma\left( \frac{p'+1}{2}\right).
\end{align*}
Also, we now need to characterize the distribution of the interval spacings $(\ell_1,\dots,\ell_n)$ and calculate the moments of each $\ell_i$. Let 
%$X_1,\dots,X_n \iid \text{Exponential}(1)$ 
$X_1,\dots,X_n \iid \text{Exp}(1)$ 
and $X=\sum_{i=1}^{n} X_i$. It is well-known that \nirmit{cite}
$$(\ell_1,\dots,\ell_n) \sim \left( \frac{X_1}{X},\dots, \frac{X_n}{X}\right).$$
Thus, the $\ell_i$'s are identically distributed. For any fixed $q$, calculating the $q$-th moment of $\ell_i$ for any $i\in[n]$
\begin{align*}
    \Exp [\ell_i^q] & =\Exp[\ell_1^q] = \Exp \left[ \frac{X_1^q}{(X_1+\dots+X_n)^q}\right] \leq \Exp \left[ \frac{X_1^q}{(X_2+\dots+X_n)^q}\right] \leq \Exp[X_1^q] \Exp \left[ \frac{1}{(X_2+\dots+X_n)^q}\right]~. 
\end{align*}
Letting $Z=X_2+\dots+X_n$, we have $Z\sim \Gamma(n-1,1)$. Therefore,
\begin{align*}
    \Exp \left[ \frac{1}{Z^q}\right] &= \int_{0}^{\infty} \frac{1}{z^q} \cdot \frac{z^{n-2}e^{-z}}{\Gamma(n-1)} dz\\
    &= \frac{1}{\Gamma(n-1)}\int_{0}^{\infty}  z^{n-q-2}e^{-z} dz\\
    &= \frac{\Gamma(n-q-1)}{\Gamma(n-1)}=\Theta \left( \frac{1}{n^q}\right)~.
\end{align*}
Therefore, using the fact that $\Exp[X_1^q]=q!$, we get
\begin{align*}
    \Exp [\ell_i^q] & \leq  \Exp \left[ X_1^q \right]  \cdot \Exp \left[ \frac{1}{(X_2+\dots+X_n)^q}\right] = \frac{q!}{\Theta(n^q)}.
\end{align*}
Combining this we can find the expectation of $T_j$
\begin{align*}
  \Exp_S \left[ T_j \right]&= \binom{p}{j} (2G)^{j} \cdot \Exp_S \left[ (\ell_i)^{j+1} (|\eps_i|+2|\eps_{i-1}|)^{p-j} \right]\\
&= \binom{p}{j} (2G)^{j} \cdot \Exp[ (\ell_i)^{j+1} ] \Exp[ (|\eps_i|+2|\eps_{i-1}|)^{p-j} ]  \\
&= \Theta\left(\frac{1}{n^{j+1}} \right)~. 
\end{align*}
Finally, combining substituting this in the above:
\begin{align*}
    \Exp_S \left[  \Exp_{x \sim \unif{[0,1]}} \left[ |\hat{f}_{\text{spline}}(x)-f^*(x)|^p \right] \right] 
    & \leq  \sum_{i=1}^{n}\left( \Exp \left[ \ell_i(|\eps_i|+2|\eps_{i-1}|)^p \right] +\sum_{j=1}^{p} \binom{p}{j} (2G)^j \cdot \Exp \left[ (\ell_i)^{j+1} (|\eps_i|+2|\eps_{i-1}|)^{p-j} \right] \right) \\
    & = \sum_{i=1}^{n} \left[ \frac{B(p)}{n} + \sum_{j=1}^{p} \Theta\left( \frac{1}{n^{j+1}}\right)\right] \\
    & =  B(p) + \sum_{j=1}^{p} \Theta\left( \frac{1}{n^{j}}\right).
\end{align*}
Taking the limit as $n$ approaches infinity, we get:
$$ \lim_{n \rightarrow \infty} \Exp_S \left[  \Exp_{x \sim \unif{[0,1]}} \left[ |\hat{f}_{\text{spline}}(x)-f^*(x)|^p \right] \right] \leq B(p) \leq 2 \cdot 4^{p} \cdot \sigma^p \cdot\sqrt{\frac{2^{p}}{\pi}} \Gamma\left( \frac{p+1}{2}\right).$$
Therefore, finally, we can analyze
 \begin{align*}
 \Exp_S L_p(\hat{f}_{\text{spline}}) & = \Exp_S \left[ \Exp_{(x,y)\sim \dist} \left[ |\hat{f}_{\text{spline}}(x)-y|^p\right] \right]\\
 & \leq \Exp_S \left[ \Exp_{x\sim \unif([0,1]),\eps\sim \normal(0,\sigma^2)} \left[ |\hat{f}_{\text{spline}}(x)-f^*(x)+\eps|^p\right] \right]\\
 & \leq  2^p \cdot  \Exp_S \Exp_{x\sim \unif([0,1]),\eps\sim \normal(0,\sigma^2)} \left[ |\hat{f}(x)-f^*(x)|^p+|\eps|^p\right]\\
 & \leq  2^p \left[ \Exp_S \Exp_{x\sim \unif([0,1])} \left[ |\hat{f}(x)-f^*(x)|^p \right]+ \Exp_{\eps\sim \normal(0,\sigma^2)} |\eps|^p \right]
 \end{align*}
 Taking the limit on both sides as $n$ tends to $\infty$,
 \begin{align*}
  \lim_{n\rightarrow \infty} \Exp_S L_p(\hat{f}_0)  &\leq 2^p \cdot \lim_{n \rightarrow \infty} \left[ \Exp_S \Exp_{x\sim \unif([0,1])} \left[ |\hat{f}(x)-f^*(x)|^p \right]+ \Exp_{\eps\sim \normal(0,\sigma^2)} |\eps|^p \right]\\
  & \leq  2^p \left[ 2 \cdot 4^{p} \cdot \sigma^p \cdot\sqrt{\frac{2^{p}}{\pi}} \Gamma\left( \frac{p+1}{2}\right) + \sigma^p \cdot \sqrt{\frac{2^p}{\pi}} \Gamma \left( \frac{p+1}{2}\right) \right]\\
  & = (2\cdot 8^p + 2^p) \cdot \sigma^p \cdot \sqrt{\frac{2^p}{\pi}} \Gamma \left( \frac{p+1}{2}\right)\\
  &= c_p L_p^*.
 \end{align*}
 \end{proof}