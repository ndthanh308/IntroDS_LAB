% qcircuit file
% example of quantum polar code preparation -- N=8, i=3
% full implementation -- expanding ZZ and XX measurement circuits
%
\Qcircuit @C=0.7em @R=.6em {
\lstick{\ket{u_1}} & \targ     & \qw       & \qw        & \qw &&&& \qw[-4]            &        
    \ctrl{1} & \qw                         & \qw        & \qw &&&& \qw[-4]            &
        \targ      & \qw       & \qw       & \qw        && \qw[-2]                    \\
\lstick{\ket{+}}   & \ctrl{-1} & \ctrl{+1} & \meterb{X} & \cw &&&& \lstick{\ket{0}\hspace*{-.3em}}   &
    \targ    & \targ                       & \meterb{Z} & \cw &&&& \lstick{\ket{+}\hspace*{-.3em}}   &
        \ctrl{-1}  & \ctrl{7}  & \qw       & \qw        & \meterb{X} & \cw            \\
\lstick{\ket{u_2}} & \qw       & \targ     & \qw        & \qw &&&& \qw[-4]            &
    \ctrl{3} & \qw                         & \qw        & \qw &&&& \qw[-4]            &
        \targ      & \qw       & \qw       & \qw        && \qw[-2]                    \\
%
&                                                                                     \\
%
\lstick{\ket{u_3}} & \targ     & \qw       & \qw        & \qw &&&& \qw[-4]            &
    \qw      &  \ctrl{-3}                  & \qw        & \qw &&&& \qw[-4]            &
        \qw        & \qw       & \qw       & \targ      && \qw[-2]                    \\
\lstick{\ket{+}}   & \ctrl{-1} & \ctrl{+1} & \meterb{X} & \cw &&&& \lstick{\ket{0}\hspace*{-.3em}}   &
    \targ    & \targ                       & \meterb{Z} & \cw &&&& \lstick{\ket{+}\hspace*{-.3em}}   &
        \qw        & \qw       & \ctrl{7}  & \ctrl{-1}  & \meterb{X} & \cw            \\
\lstick{\ket{u_4}} & \qw       & \targ     & \qw        & \qw &&&& \qw[-4]            &
    \qw      &  \ctrl{-1}                  & \qw        & \qw &&&& \qw[-4]            &
        \qw        & \qw       & \qw       & \targ      && \qw[-2]                    \\
%
&                                                                                     \\
%
\lstick{\ket{u_5}} & \targ     & \qw       & \qw        & \qw &&&& \qw[-4]            &        
    \ctrl{1} & \qw                         & \qw        & \qw &&&& \qw[-4]            &
        \qw        & \targ     & \qw       & \qw        && \qw[-2]                    \\
\lstick{\ket{+}}   & \ctrl{-1} & \ctrl{+1} & \meterb{X} & \cw &&&& \lstick{\ket{0}\hspace*{-.3em}}   &
    \targ    & \targ                       & \meterb{Z} & \cw &&&& \lstick{\ket{+}\hspace*{-.3em}}   &
        \ctrl{-7}  & \ctrl{1}  & \qw       & \qw        & \meterb{X} & \cw            \\
\lstick{\ket{u_6}} & \qw       & \targ     & \qw        & \qw &&&& \qw[-4]            &
    \ctrl{3} & \qw                         & \qw        & \qw &&&& \qw[-4]            &
        \qw        & \targ     & \qw       & \qw        && \qw[-2]                    \\
%
&                                                                                     \\
%
\lstick{\ket{u_7}} & \targ     & \qw       & \qw        & \qw &&&& \qw[-4]            &
    \qw      &  \ctrl{-3}                  & \qw        & \qw &&&& \qw[-4]            &
        \qw        & \qw       & \targ     & \qw        && \qw[-2]                    \\
\lstick{\ket{+}}   & \ctrl{-1} & \ctrl{+1} & \meterb{X} & \cw &&&& \lstick{\ket{0}\hspace*{-.3em}}   &
    \targ    & \targ                       & \meterb{Z} & \cw &&&& \lstick{\ket{+}\hspace*{-.3em}}   &
        \qw        & \qw       & \ctrl{1}  & \ctrl{-7}  & \meterb{X} & \cw            \\
\lstick{\ket{u_8}} & \qw       & \targ     & \qw        & \qw &&&& \qw[-4]            &
    \qw      &  \ctrl{-1}                  & \qw        & \qw &&&& \qw[-4]            &
        \qw        & \qw       & \targ     & \qw        && \qw[-2]
}