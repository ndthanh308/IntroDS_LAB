% qcircuit file
% example of quantum polar code preparation -- N=8, i=3
%
\Qcircuit @C=0.7em @R=0.9em {
\lstick{\ket{q_{2^0}}} & \qw & \mX\qwx[1]   &\qw\A{a}& \qww & \mZ\qwx[2] & \qw   &\qw\A{aa}& \qww & \mX\qwx[4] & \qw & \qw & \qw & \qww\A{aaa} \\
\lstick{\ket{q_{2^0}}} & \qw & \mX   &\qw\A{b}& \qww & \qw & \mZ\qwx[2]   &\qw      & \qww & \qw & \mX\qwx[4] & \qw & \qw & \qww 
    \ar@{<~>}"a"-<0em,.2em>;"b"+<0em,.2em> ^{\ket{q_{2^1}}} \\
\lstick{\ket{q_{2^0}}} & \qw & \mX\qwx[1]   &\qw\A{a}& \qww & \mZ & \qw   &\qw      & \qww & \qw & \qw & \mX\qwx[4] & \qw & \qww \\
\lstick{\ket{q_{2^0}}} & \qw & \mX   &\qw\A{b}& \qww & \qw & \mZ   &\qw\A{bb}& \qww & \qw & \qw & \qw & \mX\qwx[4] & \qww 
    \ar@{<~>}"a"-<0em,.2em>;"b"+<0em,.2em> ^{\ket{q_{2^1}}} 
    \ar@{<~>}"aa"-<0em,.2em>;"bb"+<0em,.2em> ^{\ket{q_{2^2}}} \\
\lstick{\ket{q_{2^0}}} & \qw & \mX\qwx[1]   &\qw\A{a}& \qww & \mZ\qwx[2] & \qw   &\qw\A{aa}& \qww & \mX & \qw & \qw & \qw & \qww \\
\lstick{\ket{q_{2^0}}} & \qw & \mX   &\qw\A{b}& \qww & \qw & \mZ\qwx[2]   &\qw      & \qww & \qw & \mX & \qw & \qw & \qww 
    \ar@{<~>}"a"-<0em,.2em>;"b"+<0em,.2em> ^{\ket{q_{2^1}}} \\
\lstick{\ket{q_{2^0}}} & \qw & \mX\qwx[1]   &\qw\A{a}& \qww & \mZ & \qw   &\qw      & \qww & \qw & \qw & \mX & \qw & \qww \\
\lstick{\ket{q_{2^0}}} & \qw & \mX   &\qw\A{b}& \qww & \qw & \mZ   &\qw\A{bb}& \qww & \qw & \qw & \qw & \mX & \qww\A{bbb} 
    \ar@{<~>}"a"-<0em,.2em>;"b"+<0em,.2em> ^{\ket{q_{2^1}}}
    \ar@{<~>}"aa"-<0em,.2em>;"bb"+<0em,.2em> ^{\ket{q_{2^2}}}
    \ar@{<~>}"aaa"+<.5em,-.2em>;"bbb"+<.5em,.2em> ^{\ket{q_{2^3}}}
}