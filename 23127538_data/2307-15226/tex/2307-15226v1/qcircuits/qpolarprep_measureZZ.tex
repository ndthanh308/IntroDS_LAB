% qcircuit file
% quantum polar code preparation -- Pauli Z \otimes Z measurement case
%
\Qcircuit @C=0.7em @R=.8em {
 & \qw\A{a} & \multigate{6}{Q_{N/2}} & \qw & \mZ\qwx[8]\A{A} & \qww & \qw         & \qww \\
 &   \\
 &   \\
 &   \\
 &   \\
 &   \\
 & \qw\A{b} & \ghost{Q_{N/2}}        & \qw & \qw         & \qww & \mZ\qwx[8]\A{B} & \qww
     \ar@{.}"a"-<0em,.3em>;"b"+<0em,.3em> 
     \ar@{.}"A"+<.5em,-.9em>;"B"+<-.4em,.9em> 
     \inputgrouph{1}{4}{1.7em}{\mathcal{Z}(n-1)\left\lbrace\raisebox{0em}[2.1em]{\,}\right.}{3em}
     \inputgrouph{5}{7}{1.1em}{\mathcal{X}(n-1)\left\lbrace\raisebox{0em}[1.4em]{\,}\right.}{3em}\\
%
% second block
 &   \\ 
 & \qw\A{a} & \multigate{6}{Q_{N/2}} & \qw & \mZ\A{A} & \qww & \qw         & \qww \\
 &   \\
 &   \\
 &   \\
 &   \\
 &   \\
 & \qw\A{b} & \ghost{Q_{N/2}}        & \qw & \qw         & \qww & \mZ\A{B} & \qww
     \ar@{.}"a"-<0em,.3em>;"b"+<0em,.3em> 
     \ar@{.}"A"+<.5em,-.9em>;"B"+<-.4em,.9em>
     \inputgrouph{9}{12}{1.7em}{\mathcal{Z}(n-1)\left\lbrace\raisebox{0em}[2.1em]{\,}\right.}{3em}
     \inputgrouph{13}{15}{1.1em}{\mathcal{X}(n-1)\left\lbrace\raisebox{0em}[1.4em]{\,}\right.}{3em}
     \inputgrouph{1}{12}{6em}{\mathcal{Z}(n)\left\lbrace\raisebox{0em}[6.6em]{\,}\right.}{8em}
     \inputgrouph{13}{15}{1.1em}{\mathcal{X}(n)\left\lbrace\raisebox{0em}[1.4em]{\,}\right.}{8em}
}