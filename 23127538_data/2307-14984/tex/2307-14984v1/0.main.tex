\documentclass{article}
\usepackage[final]{neurips_2023}

\usepackage[utf8]{inputenc} %
\usepackage[T1]{fontenc}    %
\usepackage{url}            %
\usepackage{booktabs}       %
\usepackage{amsfonts}       %
\usepackage{nicefrac}       %
\usepackage{microtype}      %
\usepackage{xcolor}         %

\usepackage{array}
\usepackage{graphicx}
\usepackage{clrscode}
\usepackage{enumitem}
\usepackage{multirow}
\usepackage{multicol}
\usepackage{float}
\usepackage{color}
\usepackage{amsopn}
\usepackage{mathrsfs}
\usepackage{mathtools}
\usepackage{amsmath}
\usepackage{arydshln}
\usepackage{blkarray}
\usepackage{courier}
\usepackage{rotating}
\usepackage{bm}
\usepackage{ragged2e}
\usepackage{setspace}
\usepackage{subfigure}
\usepackage{caption}
\usepackage{comment}
\usepackage{enumitem}
\usepackage{tabularx}
\usepackage{adjustbox}

\usepackage[linesnumbered,ruled,lined]{algorithm2e}
\usepackage{algorithmicx}
\usepackage{algpseudocode}
\usepackage{amsmath}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{prop}[theorem]{Proposition}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{remark}{Remark}
\newtheorem{definition}{Definition}
\newtheorem{assumption}{Assumption}

\title{S$^3$: Social-network Simulation System with\\ Large Language Model-Empowered Agents}

\author{Chen Gao, Xiaochong Lan, Zhihong Lu, Jinzhu Mao, \\ \textbf{Jinghua Piao, Huandong Wang, Depeng Jin, Yong Li}\\
Department of Electronic Engineering,\\ Tsinghua University\\
\texttt{liyong07@tsinghua.edu.cn}
}

\begin{document}
\maketitle
\begin{abstract}
Social network simulation plays a crucial role in addressing various challenges within social science. It offers extensive applications such as state prediction, phenomena explanation, and policy-making support, among others.
In this work, we harness the formidable human-like capabilities exhibited by large language models (LLMs) in sensing, reasoning, and behaving, and utilize these qualities to construct the S$^3$ system (short for \textbf{S}ocial network \textbf{S}imulation \textbf{S}ystem).
Adhering to the widely employed agent-based simulation paradigm, we employ prompt engineering and prompt tuning techniques to ensure that the agent's behavior closely emulates that of a genuine human within the social network.
Specifically, we simulate three pivotal aspects: emotion, attitude, and interaction behaviors. By endowing the agent in the system with the ability to perceive the informational environment and emulate human actions, we observe the emergence of population-level phenomena, including the propagation of information, attitudes, and emotions.
We conduct an evaluation encompassing two levels of simulation, employing real-world social network data. Encouragingly, the results demonstrate promising accuracy.
This work represents an initial step in the realm of social network simulation empowered by LLM-based agents. We anticipate that our endeavors will serve as a source of inspiration for the development of simulation systems within, but not limited to, social science.
\end{abstract}

\section{Introduction}\label{sec::intro}

The social network, comprising interconnected individuals in society, constitutes a cornerstone of the contemporary world. 
Diverging from mathematical analysis, computer simulation offers a fresh avenue to comprehend the formation and evolution of social networks. This serves as a fundamental tool for social scientists.
Notably, in 1996, there was already a book titled \textit{Social Science Microsimulation}~\cite{troitzsch1996social} providing valuable insights about simulation from the perspective of social science. Social simulation encompasses a wide range of domains, encompassing both individual and population social activities.
At the heart of social simulation lie two perspectives~\cite{gilbert2005simulation}: 1) the dynamic feedback or interaction among individuals, and 2) the states of the population, either as a collective whole or as distinct groups. By simulating social activities, researchers and practitioners can predict the future evolution of individual and population states. In addition, they facilitate experimental environments through interventions.
Social simulation can be implemented in two forms: microlevel simulation~\cite{chopard1998cellular,park2023generative} and macrolevel simulation~\cite{kolesar1975simulation,meadows1974dynamics, forrester1993system,marsh1978using}. In macrolevel simulation, also known as system-based simulation, researchers model the dynamics of the system using equations that elucidate the changing status of the population. Conversely, microlevel simulation, or agent-based simulation, involves researchers employing either human-crafted rules or parameterized models to depict the behavior of individuals (referred to as agents) who interact with others.
Recently, with the exponential growth of the Internet, online social networks have emerged as the principal platform for societal activities. Users engage in various interactive behaviors such as chatting, posting, and sharing content. Consequently, the study of social networks has become a central research focus within the realm of social science, thereby emphasizing the criticality of simulation in this domain.


Large language models (LLMs)~\cite{brown2020language,openai2023gpt4,chowdhery2022palm, anil2023palm,touvron2023llama,zeng2022glm} are the recent advancement in the field of deep learning, characterized by the utilization of an extensive array of neural layers. These models undergo training on vast textual corpora, acquiring a remarkable fundamental capacity to comprehend, generate, and manipulate human language. 
Given their impressive prowess in text comprehension, which closely approximates human-level performance, LLMs have emerged as a particularly auspicious avenue of research for approaching general artificial intelligence. Consequently, researchers~\cite{aher2023using,horton2023large,hamalainen2023evaluating,park2023generative} leverage LLMs as agent-like entities for simulating human-like behavior, capitalizing on three fundamental capabilities.
First and foremost, LLMs possess the ability to perceive and apprehend the world, albeit restricted to environments that can be adequately described in textual form. 
Secondly, LLMs are capable of devising and organizing task schedules by leveraging reasoning techniques that incorporate both task requirements and the attendant rewards. 
Throughout this process, LLMs effectively maintain and update a memory inventory, employing appropriately guided prompts rooted in human-like reasoning patterns.
Lastly, LLMs exhibit the capacity to generate texts that bear a striking resemblance to human-produced language. These textual outputs can influence the environment and interact with other agents. Consequently, it holds significant promise to adopt an agent-based simulation paradigm that harnesses LLMs to simulate each user within a social network, thereby capturing their respective behaviors and the intricate interplay among users.


In this study, we present the Social-network Simulation System (S$^3$), which employs LLM-empowered agents to simulate users within a social network effectively. Initially, we establish an environment using real-world social network data. To ensure the authenticity of this environment, we propose a user-demographic inference module that combines prompt engineering with prompt tuning, to infer user demographics such as age, gender, and occupation. 
Within the constructed environment, users have the ability to observe content from individuals they follow, thereby influencing their own attitudes, emotions, and subsequent behaviors. Users can forward content, create new content, or remain inactive. Hence, at the individual level, we employ prompt engineering and prompt tuning methodologies to simulate attitudes, emotions, and behaviors. Notably, this simulation considers both demographics and memory of historically-posted content.
At the population level, the accumulation of individual behaviors, including content generation and forwarding, alongside the evolving internal states of attitudes and emotions, leads to the emergence of collective behavior. This behavior encompasses the propagation of information, attitudes, and emotions.


To assess the efficacy of the proposed S$^3$ system, we have chosen two exemplary scenarios, namely, \textbf{gender discrimination} and \textbf{nuclear energy}. With respect to gender discrimination, our objective is to simulate user responses to online content associated with this issue, while closely observing the dissemination patterns of related information and evolving public sentiment. Regarding nuclear energy, our aim is to simulate user reactions to online content pertaining to power policies. In addition, we aim to simulate the contentious and conflicting interactions between two opposing population groups. To evaluate the precision of our simulations, we employ metrics that measure accuracy at both the individual and population levels.
This work's main contributions can be summarized as follows.
\begin{itemize}[leftmargin=*]
	\item We take the pioneering step of simulating social networks with large language models (LLMs), which follows the agent-based simulation paradigm, and empowers the agents with the latest advances.
	\item We develop a simulation system that supports both individual-level and population-level simulations, which can learn from the collected real social network data, and simulate future states.
	\item We systematically conduct the evaluation, and the results show that the simulation system with LLM-empowered agents can achieve considerable accuracy in multiple metrics. Consequently, our system introduces a novel simulation paradigm in social science research, offering extensive support for scientific investigations and real-world applications.
\end{itemize}


To provide a comprehensive understanding of the current research landscape, we begin by reviewing relevant works in Section~\ref{sec::related}. Subsequently, we proceed to introduce the simulation system in Section~\ref{sec::system}, followed by a detailed exposition of the methodology and implementation in Section~\ref{sec::method}. In Section~\ref{sec::discussion}, we engage in discussions and analyze open challenges associated with related research and applications. Finally, we conclude our work in Section~\ref{sec::conclusion}.

\input{2.related.tex}
\input{3.system.tex}
\input{4.method.tex}
\input{5.discussion.tex}

\section{Conclusion}\label{sec::conclusion}
In this paper, we present the S$^3$ system (Social Network Simulation System) as a novel approach aimed at tackling the complexities of social network simulation. By harnessing the advanced capabilities of large language models (LLMs) in the realms of perception, cognition, and behavior, we have established a framework for social network emulation. Our simulations concentrate on three pivotal facets: emotion, attitude, and interactive behaviors. This research marks a significant stride forward in social network simulation, pioneering the integration of LLM-empowered agents. Beyond social science, our work possesses the potential to stimulate the development of simulation systems across diverse domains. Employing this methodology enables researchers and policymakers to attain profound insights into intricate social dynamics, thereby facilitating informed decision-making and effectively addressing various societal challenges.

\begin{thebibliography}{10}
	
	\bibitem{aher2023using}
	Gati~V Aher, Rosa~I Arriaga, and Adam~Tauman Kalai.
	\newblock Using large language models to simulate multiple humans and replicate
	human subject studies.
	\newblock In {\em International Conference on Machine Learning}, pages
	337--371. PMLR, 2023.
	
	\bibitem{axelrod1997advancing}
	Robert Axelrod.
	\newblock Advancing the art of simulation in the social sciences.
	\newblock In {\em Simulating social phenomena}, pages 21--40. Springer, 1997.
	
	\bibitem{baumann2020modeling}
	Fabian Baumann, Philipp Lorenz-Spreen, Igor~M Sokolov, and Michele Starnini.
	\newblock Modeling echo chambers and polarization dynamics in social networks.
	\newblock {\em Physical Review Letters}, 124(4):048301, 2020.
	
	\bibitem{baumann2021emergence}
	Fabian Baumann, Philipp Lorenz-Spreen, Igor~M Sokolov, and Michele Starnini.
	\newblock Emergence of polarized ideological opinions in multidimensional topic
	spaces.
	\newblock {\em Physical Review X}, 11(1):011012, 2021.
	
	\bibitem{bratley1987guide}
	Paul Bratley, Bennett~L Fox, and Linus~E Schrage.
	\newblock A guide to simulation, 1987.
	
	\bibitem{brown2020language}
	Tom Brown, Benjamin Mann, Nick Ryder, Melanie Subbiah, Jared~D Kaplan, Prafulla
	Dhariwal, Arvind Neelakantan, Pranav Shyam, Girish Sastry, Amanda Askell,
	et~al.
	\newblock Language models are few-shot learners.
	\newblock {\em Advances in neural information processing systems},
	33:1877--1901, 2020.
	
	\bibitem{charness2002understanding}
	Gary Charness and Matthew Rabin.
	\newblock Understanding social preferences with simple tests.
	\newblock {\em The quarterly journal of economics}, 117(3):817--869, 2002.
	
	\bibitem{chopard1998cellular}
	Bastien Chopard and Michel Droz.
	\newblock Cellular automata.
	\newblock {\em Modelling of Physical}, pages 6--13, 1998.
	
	\bibitem{chowdhery2022palm}
	Aakanksha Chowdhery, Sharan Narang, Jacob Devlin, Maarten Bosma, Gaurav Mishra,
	Adam Roberts, Paul Barham, Hyung~Won Chung, Charles Sutton, Sebastian
	Gehrmann, et~al.
	\newblock Palm: Scaling language modeling with pathways.
	\newblock {\em arXiv preprint arXiv:2204.02311}, 2022.
	
	\bibitem{duetal2022glm}
	Zhengxiao Du, Yujie Qian, Xiao Liu, Ming Ding, Jiezhong Qiu, Zhilin Yang, and
	Jie Tang.
	\newblock Glm: General language model pretraining with autoregressive blank
	infilling.
	\newblock {\em arXiv preprint arXiv:2103.10360}, 2021.
	
	\bibitem{anil2023palm}
	Rohan~Anil et~al.
	\newblock Palm 2 technical report, 2023.
	
	\bibitem{flamino2023political}
	James Flamino, Alessandro Galeazzi, Stuart Feldman, Michael~W Macy, Brendan
	Cross, Zhenkun Zhou, Matteo Serafino, Alexandre Bovet, Hern{\'a}n~A Makse,
	and Boleslaw~K Szymanski.
	\newblock Political polarization of news media and influencers on twitter in
	the 2016 and 2020 us presidential elections.
	\newblock {\em Nature Human Behaviour}, pages 1--13, 2023.
	
	\bibitem{forrester1993system}
	Jay~W Forrester.
	\newblock System dynamics and the lessons of 35 years.
	\newblock In {\em A systems-based approach to policymaking}, pages 199--240.
	Springer, 1993.
	
	\bibitem{gilbert2005simulation}
	Nigel Gilbert and Klaus Troitzsch.
	\newblock {\em Simulation for the social scientist}.
	\newblock McGraw-Hill Education (UK), 2005.
	
	\bibitem{hamalainen2023evaluating}
	Perttu H{\"a}m{\"a}l{\"a}inen, Mikke Tavast, and Anton Kunnari.
	\newblock Evaluating large language models in generating synthetic hci research
	data: a case study.
	\newblock In {\em Proceedings of the 2023 CHI Conference on Human Factors in
		Computing Systems}, pages 1--19, 2023.
	
	\bibitem{hohmann2023quantifying}
	Marilena Hohmann, Karel Devriendt, and Michele Coscia.
	\newblock Quantifying ideological polarization on a network using generalized
	euclidean distance.
	\newblock {\em Science Advances}, 9(9):eabq2044, 2023.
	
	\bibitem{horton2023large}
	John~J Horton.
	\newblock Large language models as simulated economic agents: What can we learn
	from homo silicus?
	\newblock Technical report, National Bureau of Economic Research, 2023.
	
	\bibitem{kolesar1975simulation}
	Peter Kolesar and Warren~E Walker.
	\newblock A simulation model of police patrol operations: program description.
	\newblock 1975.
	
	\bibitem{lee2021all}
	Lik-Hang Lee, Tristan Braud, Pengyuan Zhou, Lin Wang, Dianlei Xu, Zijun Lin,
	Abhishek Kumar, Carlos Bermejo, and Pan Hui.
	\newblock All one needs to know about metaverse: A complete survey on
	technological singularity, virtual ecosystem, and research agenda.
	\newblock {\em arXiv preprint arXiv:2110.05352}, 2021.
	
	\bibitem{liu2023emergence}
	Jiazhen Liu, Shengda Huang, Nathaniel~M Aden, Neil~F Johnson, and Chaoming
	Song.
	\newblock Emergence of polarization in coevolving networks.
	\newblock {\em Physical Review Letters}, 130(3):037401, 2023.
	
	\bibitem{liuetal2022p}
	Xiao Liu, Kaixuan Ji, Yicheng Fu, Weng Tam, Zhengxiao Du, Zhilin Yang, and Jie
	Tang.
	\newblock P-tuning: Prompt tuning can be comparable to fine-tuning across
	scales and tasks.
	\newblock In {\em Proceedings of the 60th Annual Meeting of the Association for
		Computational Linguistics (Volume 2: Short Papers)}, pages 61--68, 2022.
	
	\bibitem{lorenz2023systematic}
	Philipp Lorenz-Spreen, Lisa Oswald, Stephan Lewandowsky, and Ralph Hertwig.
	\newblock A systematic review of worldwide causal and correlational evidence on
	digital media and democracy.
	\newblock {\em Nature human behaviour}, 7(1):74--101, 2023.
	
	\bibitem{luding2005information}
	Stefan Luding.
	\newblock Information propagation.
	\newblock {\em Nature}, 435(7039):159--160, 2005.
	
	\bibitem{marsh1978using}
	Lawrence~C Marsh and Meredith Scovill.
	\newblock Using system dynamics to model the social security system.
	\newblock In {\em NBER Workshop on Policy Analysis with Social Security
		Research Files}, pages 15--17, 1978.
	
	\bibitem{meadows1974dynamics}
	Dennis~L Meadows, William~W Behrens, Donella~H Meadows, Roger~F Naill,
	J{\o}rgen Randers, and Erich Zahn.
	\newblock {\em Dynamics of growth in a finite world}.
	\newblock Wright-Allen Press Cambridge, MA, 1974.
	
	\bibitem{notarmuzi2022universality}
	Daniele Notarmuzi, Claudio Castellano, Alessandro Flammini, Dario Mazzilli, and
	Filippo Radicchi.
	\newblock Universality, criticality and complexity of information propagation
	in social media.
	\newblock {\em Nature communications}, 13(1):1308, 2022.
	
	\bibitem{openai2023gpt4}
	OpenAI.
	\newblock Gpt-4 technical report, 2023.
	
	\bibitem{park2023generative}
	Joon~Sung Park, Joseph~C O'Brien, Carrie~J Cai, Meredith~Ringel Morris, Percy
	Liang, and Michael~S Bernstein.
	\newblock Generative agents: Interactive simulacra of human behavior.
	\newblock {\em arXiv preprint arXiv:2304.03442}, 2023.
	
	\bibitem{10.1145/3219819.3220077}
	Jiezhong Qiu, Jian Tang, Hao Ma, Yuxiao Dong, Kuansan Wang, and Jie Tang.
	\newblock Deepinf: Social influence prediction with deep learning.
	\newblock In {\em Proceedings of the 24th ACM SIGKDD international conference
		on knowledge discovery \& data mining}, pages 2110--2119, 2018.
	
	\bibitem{samuelson1988status}
	William Samuelson and Richard Zeckhauser.
	\newblock Status quo bias in decision making.
	\newblock {\em Journal of risk and uncertainty}, 1:7--59, 1988.
	
	\bibitem{santos2021link}
	Fernando~P Santos, Yphtach Lelkes, and Simon~A Levin.
	\newblock Link recommendation algorithms and dynamics of polarization in online
	social networks.
	\newblock {\em Proceedings of the National Academy of Sciences},
	118(50):e2102141118, 2021.
	
	\bibitem{schafer2002spinning}
	Joseph~A Schafer.
	\newblock Spinning the web of hate: Web-based hate propagation by extremist
	organizations.
	\newblock {\em Journal of Criminal Justice and Popular Culture}, 2002.
	
	\bibitem{schler2006effects}
	Jonathan Schler, Moshe Koppel, Shlomo Argamon, and James~W Pennebaker.
	\newblock Effects of age and gender on blogging.
	\newblock In {\em AAAI spring symposium: Computational approaches to analyzing
		weblogs}, volume~6, pages 199--205, 2006.
	
	\bibitem{spencer1984effect}
	Peter~D Spencer.
	\newblock The effect of oil discoveries on the british economyâ€”theoretical
	ambiguities and the consistent expectations simulation approach.
	\newblock {\em The Economic Journal}, 94(375):633--644, 1984.
	
	\bibitem{touvron2023llama}
	Hugo Touvron, Thibaut Lavril, Gautier Izacard, Xavier Martinet, Marie-Anne
	Lachaux, Timoth{\'e}e Lacroix, Baptiste Rozi{\`e}re, Naman Goyal, Eric
	Hambro, Faisal Azhar, et~al.
	\newblock Llama: Open and efficient foundation language models.
	\newblock {\em arXiv preprint arXiv:2302.13971}, 2023.
	
	\bibitem{troitzsch1996social}
	Klaus~G Troitzsch.
	\newblock Social science microsimulation.
	\newblock Springer Science \& Business Media, 1996.
	
	\bibitem{wang2022global}
	Jianghao Wang, Yichun Fan, Juan Palacios, Yuchen Chai, Nicolas
	Guetta-Jeanrenaud, Nick Obradovich, Chenghu Zhou, and Siqi Zheng.
	\newblock Global evidence of expressed sentiment alterations during the
	covid-19 pandemic.
	\newblock {\em Nature Human Behaviour}, 6(3):349--358, 2022.
	
	\bibitem{xie2021detecting}
	Jiarong Xie, Fanhui Meng, Jiachen Sun, Xiao Ma, Gang Yan, and Yanqing Hu.
	\newblock Detecting and modelling real percolation and phase transitions of
	information on social media.
	\newblock {\em Nature Human Behaviour}, 5(9):1161--1168, 2021.
	
	\bibitem{zeng2022glm}
	Aohan Zeng, Xiao Liu, Zhengxiao Du, Zihan Wang, Hanyu Lai, Ming Ding, Zhuoyi
	Yang, Yifan Xu, Wendi Zheng, Xiao Xia, et~al.
	\newblock Glm-130b: An open bilingual pre-trained model.
	\newblock {\em arXiv preprint arXiv:2210.02414}, 2022.
	
	\bibitem{10.1145/2700398}
	Jing Zhang, Jie Tang, Juanzi Li, Yang Liu, and Chunxiao Xing.
	\newblock Who influenced you? predicting retweet via social influence locality.
	\newblock {\em ACM Trans. Knowl. Discov. Data}, 9(3), apr 2015.
	
\end{thebibliography}


\end{document}
