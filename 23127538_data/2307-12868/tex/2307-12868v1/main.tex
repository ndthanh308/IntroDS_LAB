\documentclass{article}

% if you need to pass options to natbib, use, e.g.:
\PassOptionsToPackage{numbers, compress}{natbib}
% before loading neurips_2023


% ready for submission
% \usepackage[nonatbib]{neurips_2023}
% \usepackage{neurips_2023}
\usepackage[preprint]{neurips_2023}

% to compile a preprint version, e.g., for submission to arXiv, add add the
% [preprint] option:
%     \usepackage[preprint]{neurips_2023}


% to compile a camera-ready version, add the [final] option, e.g.:
%     \usepackage[final]{neurips_2023}


% to avoid loading the natbib package, add option nonatbib:
% \usepackage[nonatbib]{neurips_2023}
\usepackage[numbers,compress]{natbib}


\usepackage[utf8]{inputenc} % allow utf-8 input
\usepackage[T1]{fontenc}    % use 8-bit T1 fonts
\usepackage{hyperref}       % hyperlinks
\usepackage{url}            % simple URL typesetting
\usepackage{booktabs}       % professional-quality tables
\usepackage{amsfonts}       % blackboard math symbols
\usepackage{nicefrac}       % compact symbols for 1/2, etc.
\usepackage{microtype}      % microtypography
\usepackage{xcolor}         % colors

% add packages bellow
\usepackage{graphicx}
\usepackage{subfigure}
\usepackage{kotex}
\usepackage{duckuments}
% \usepackage{natbib}
% \usepackage{cite}
% For theorems and such
\usepackage{amsmath}
\usepackage{amssymb}
\usepackage{mathtools}
\usepackage{amsthm}
\usepackage[capitalize,noabbrev]{cleveref}
\usepackage[textsize=tiny]{todonotes}

% yh : figure related packages
\usepackage{wrapfig}
\usepackage{lipsum}
\usepackage[export]{adjustbox}

% yh : code related packages
\usepackage{listings}
\usepackage{xcolor}

\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

\lstdefinestyle{mystyle}{
    backgroundcolor=\color{backcolour},   
    commentstyle=\color{codegreen},
    keywordstyle=\color{magenta},
    numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily\footnotesize,
    breakatwhitespace=false,         
    breaklines=true,                 
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,                    
    numbersep=5pt,                  
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2
}

\lstset{style=mystyle}

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% THEOREMS
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\theoremstyle{plain}
\newtheorem{theorem}{Theorem}[section]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\theoremstyle{definition}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{assumption}[theorem]{Assumption}
\theoremstyle{remark}
\newtheorem{remark}[theorem]{Remark}

\usepackage{algorithmic}% http://ctan.org/pkg/algorithms
\usepackage{algorithm}% http://ctan.org/pkg/algorithms
% \usepackage{algpseudocode}% http://ctan.org/pkg/algorithmicx


\input{macros.tex}


% \title{Unsupervised Discovery of Semantic Latent \yh{Basis} in Diffusion Models}
% \title{Unsupervised Discovery of Semantic Latent Directions in Diffusion Models}
% \title{
%     \yh{Understanding the Semantic Structure of Diffusion Models using Riemannian Geometry}
% }
% \title{
%     Understanding the Geometry of the Latent Space of Diffusion Models
% }
\title{
    Understanding the Latent Space of Diffusion Models through the Lens of Riemannian Geometry
}

% The \author macro works with any number of authors. There are two commands
% used to separate the names and addresses of multiple authors: \And and \AND.
%
% Using \And between authors leaves it to LaTeX to determine where to break the
% lines. Using \AND forces a line break at that point. So, if LaTeX puts 3 of 4
% authors names on the first line, and the last on the second line, try using
% \AND instead of \And before the third author name.

\author{
Yong-Hyun Park$^{*1}$,~
Mingi Kwon$^{*2}$,~
Jaewoong Choi$^{3}$,~
Junghyo Jo$^{\dagger1}$,~
Youngjung Uh$^{\dagger2}$,
\vspace{+0.3em}
\\
\normalsize$^1$Seoul National University~~
$^2$Yonsei University~~
$^3$Korea Institute for Advanced Study\\
% \scriptsize {\texttt{\{enkeejunior1,jojunghyo\}@snu.ac.kr}}~~
% \scriptsize {\texttt{\{kwonmingi,yj.uh\}@yonsei.ac.kr}}~~
% \scriptsize {\texttt{chjw1475@kias.re.kr}}
}

% long version
% \author{
%     Yong-Hyun Park\\
%     % Department of Physics Education\\
%     Seoul National University\\
%     % Seoul, Korea \\
%     \texttt{enkeejunior1@snu.ac.kr} \\
%     \And
%     Mingi Kwon\thanks{Equal contributions}\\
%     % Department of Artificial Intelligence\\
%     Yonsei University\\
%     % Seoul, Korea \\
%     \texttt{kwonmingi@yonsei.ac.kr} \\
%     \And
%     Jaewoong Choi\\
%     Korea Institute for Advanced Study \\
%     \texttt{chjw1475@kias.re.kr} \\
%     \And
%     Junghyo Jo \\
%     % Department of Physics Education\\
%     Seoul National University\\
%     % Seoul, Korea \\
%     \texttt{jojunghyo@snu.ac.kr} \\
%     \And
%     Youngjung Uh\\
%     % Department of Artificial Intelligence\\
%     Yonsei University\\
%     % Seoul, Korea \\
%     \texttt{yj.uh@yonsei.ac.kr} \\
% }

% \newcommand{\citet}[1]{\citeauthor{#1} }


\begin{document}


\maketitle

% \blfootnote{$^*$Equal Contribution\hspace{3mm} $^dagger$ Corresponding authors}

\begin{abstract}
Despite the success of diffusion models (DMs), we still lack a thorough understanding of their latent space. 
To understand the latent space $\vx_t \in \mathcal{X}$, we analyze them from a geometrical perspective. 
Specifically, we utilize the pullback metric to find the local latent basis in $\mathcal{X}$ and their corresponding local tangent basis in $\mathcal{H}$, the intermediate feature maps of DMs. 
% {We validate latent basis by editing image through latent space traversal.}
% \modify{Discovered latent basis has unsupervised image editing capability, achieved through latent space traversal.}
{The discovered latent basis enables unsupervised image editing capability through latent space traversal.}
% The discovered latent basis allows for unsupervised image editing through latent space traversal."
% "The discovered latent basis provides unsupervised image editing capability through latent space traversal."
% "The discovered latent basis facilitates unsupervised image editing through latent space traversal
We investigate the discovered structure from two perspectives.
First, we examine how geometric structure evolves over {diffusion timesteps}. Through analysis, we show that {1) the model focuses on low-frequency components early in the generative process and attunes to high-frequency details later};
2) At early timesteps, different samples share similar tangent spaces;
and {3) The simpler datasets that DMs trained on, the more consistent the tangent space for each timestep.}
Second, we investigate how the geometric structure changes based on text conditioning in Stable Diffusion. The results show that 1) similar prompts yield {comparable} tangent spaces; and 2) the model depends less on text conditions in later timesteps.
To the best of our knowledge, this paper is the first to present image editing through $\vx$-space traversal and provide thorough analyses of the latent structure of DMs. 
% \jo{This paper presents the first proposal for image editing through x-space traversal and provides a thorough analysis of the geometry of DMs.}
%Our paper is the first to propose image editing through x-space traversal and analyze the geometry of DMs.

% mingi
% Despite the success of diffusion models (DMs), we still lack a thorough understanding of their latent space. 
% While image editing with Generative Adversarial Networks (GANs) builds upon latent space, DMs rely on editing the conditions such as text prompts.
% We present an unsupervised method to discover interpretable editing directions for the latent variables $\vx_t\in\mathcal{X}$ of DMs. 
% Our method adopts Riemannian geometry between \exspace{} and the intermediate feature maps \ehspace{} of the U-Nets to provide a deep understanding over the geometrical structure of \exspace{}. 
% The discovered local semantic basis and local tangent space by Riemannian geometry not only allow us to edit real images but also give us a rich understanding of DMs. 
% In this paper, we demonstrate that walking along the basis can successfully conduct real image editing in a semantically meaningful way in both unconditional diffusion models and Stable diffusion model. We also investigate what the DMs focus on within diffusion timesteps, samples, and datasets by analyzing discovered basis and tangent space. 

% \modify{they are globally consistent across different samples. Furthermore, editing in earlier timesteps edits coarse attributes, while ones in later timesteps focus on high-frequency details. We define the curvedness of a line segment between samples to show that \exspace{} is a curved manifold. Experiments on different baselines and datasets demonstrate the effectiveness of our method even on Stable Diffusion.} 
% Our source code will be publicly available for the future researchers.
\end{abstract}

\nnfootnote{$^*$Equal Contribution\hspace{3mm} $^\dagger$ Corresponding authors}
\vspace{-2.5em}

\input{1intro}
\input{2relatedwork}
\input{3method}
\input{4experiment}
\input{5conclusion}

\bibliography{reference_papers}
\bibliographystyle{plainnat}

\input{6appendix}

% \begin{ack}
% Use unnumbered first level headings for the acknowledgments. All acknowledgments
% go at the end of the paper before the list of references. Moreover, you are required to declare
% funding (financial activities supporting the submitted work) and competing interests (related financial activities outside the submitted work).
% More information about this disclosure can be found at: \url{https://neurips.cc/Conferences/2023/PaperInformation/FundingDisclosure}.


% Do {\bf not} include this section in the anonymized submission, only in the final paper. You can use the \texttt{ack} environment provided in the style file to autmoatically hide this section in the anonymized submission.
% \end{ack}



% \section{Supplementary Material}

% Authors may wish to optionally include extra information (complete proofs, additional experiments and plots) in the appendix. All such materials should be part of the supplemental material (submitted separately) and should NOT be included in the main submission.


% \section*{References}


% References follow the acknowledgments in the camera-ready paper. Use unnumbered first-level heading for
% the references. Any choice of citation style is acceptable as long as you are
% consistent. It is permissible to reduce the font size to \verb+small+ (9 point)
% when listing the references.
% Note that the Reference section does not count towards the page limit.
% \medskip


% {
% \small


% [1] Alexander, J.A.\ \& Mozer, M.C.\ (1995) Template-based algorithms for
% connectionist rule extraction. In G.\ Tesauro, D.S.\ Touretzky and T.K.\ Leen
% (eds.), {\it Advances in Neural Information Processing Systems 7},
% pp.\ 609--616. Cambridge, MA: MIT Press.


% [2] Bower, J.M.\ \& Beeman, D.\ (1995) {\it The Book of GENESIS: Exploring
%   Realistic Neural Models with the GEneral NEural SImulation System.}  New York:
% TELOS/Springer--Verlag.


% [3] Hasselmo, M.E., Schnell, E.\ \& Barkai, E.\ (1995) Dynamics of learning and
% recall at excitatory recurrent synapses and cholinergic modulation in rat
% hippocampal region CA3. {\it Journal of Neuroscience} {\bf 15}(7):5249-5262.
% }

% %%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\end{document}