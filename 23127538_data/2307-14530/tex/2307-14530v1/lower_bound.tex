% !TEX root = jmlr_version.tex

\subsection{Additional notation}
  For this section, we introduce additional notation.
  \begin{itemize}
    \item Let $\Omega$ be a set of $\{0, 1\}$-valued vectors $\omega$ indexed by a finite set $\mathcal{X}$, i.e. $\Omega = \{\omega_{x} \mid x \in \mathcal{X} \}$. Then the Hamming distance $d_H(\omega, \omega')$ between two elements $\omega, \omega'$ of $\Omega$ is defined as follows:
    \begin{align*}
        d_H(\omega_1, \omega_2) = |\{ x \in \mathcal{X} \mid \omega_x \neq \omega_x'\}|.
    \end{align*}
    \item For two probability distributions $\PP_1, \PP_2$, we denote by $\KL(\PP_1 \Vert \PP_2)$ the Kullback--Leibler divergence (or simply KL-divergence) between them.
    \item For a function $f\colon X \to Y$ and a subset $X' \subset X$ , we define the image of $X'$ as follows:
    \begin{align*}
        f(X') = \{ f(x) \mid x \in X'\}.
    \end{align*}
    Additionally, if $f(X')$ is a set of matrices and $\mathbf{Y}$ is a matrix of the suitable shape, then
    \begin{align*}
        \mathbf{Y} f(X') & = \{\mathbf{Y} \mathbf{X} \mid \mathbf{X} \in f(X')\}, \\
        f(X') \mathbf{Y} & = \{\mathbf{X} \mathbf{Y} \mid \mathbf{X} \in f(X') \}.
    \end{align*}
  \end{itemize}


\subsection{Checking the properties}
  Let $\omega$ be a $\{0, 1\}$-vector indexed by sets $\{k, k'\} \in \binom{[\nclusters]}{2}$. Define the set of such vectors by $\Omega$, $|\Omega| = 2^{\binom{\nclusters}{2}}$. Let $\probeMatrixFunction (\omega)$ be a matrix-valued function defined as follows:
  \begin{align*}
    \probeMatrixFunction_{k k'}(\omega) = \begin{cases}
        \frac{1}{4} + \omega_{\{k, k'\}} \cdot \frac{\mu}{\nsize}, & k \neq k', \\
        \frac{1}{2}, & k = k'.
    \end{cases}
  \end{align*}
  %
  We specify $\mu$ later. First, we prove that for any $\omega$, $\probeMatrixFunction(\omega)$ admits properties~\ref{theorem lower bound, property i}-\ref{theorem lower bound, property iv} of Theorem~\ref{theorem: lower bound}. We consider the following distribution of membership vectors. If $i \not \in \pureNodesSet$, i.e. the $i$-th node is not pure, then $\nodeWeights_i = \ones / \nclusters$, where $\ones \in \RR^\nclusters$ is the vector that consists of $\nclusters$ ones. For pure nodes, we require
  \begin{align*}
    |\pureNodesSet_k| = \begin{cases}
        \left \lceil (1 - 2^{-(\nclusters + 5)}) \cdot \nsize \cdot 2^{-k} \right \rceil, & \text{ if } k \in [\nclusters - 2], \\
        \left \lceil \frac{3}{2} (1 - 2^{-(\nclusters + 5)}) \cdot \nsize \cdot 2^{-k} \right \rceil, & \text{ if } k = \nclusters - 1, \\
        \left \lceil (1 - 2^{-(\nclusters + 5)}) \cdot \nsize \cdot 2^{-\nclusters} \right \rceil, & \text{ if } k = \nclusters.
    \end{cases}
  \end{align*}
  %
  Define
  \begin{align*}
    \mixedCardinality = \nsize - \sum_{k = 1}^\nclusters |\pureNodesSet_k|.
  \end{align*}
  %
  Clearly, we have $\mixedCardinality \le 2^{-(\nclusters + 5)} \nsize$. We denote the resulting matrix of memberships by $\nodeCommunityMatrix_0$.

  \begin{lemma}
  \label{lemma: property veryfiing}
    Let $\probeMatrixFunction(\cdot)$ and $\nodeCommunityMatrix_0$ be as above. Suppose that $\mu < \nsize / (8 \nclusters)$. Then for each $\probeMatrixFunction(\omega)$ and $\probMatrix = \sparsityParam \nodeCommunityMatrix_0 \probeMatrixFunction(\omega) \nodeCommunityMatrix^\T$, properties~\ref{theorem lower bound, property i}-\ref{theorem lower bound, property iv} hold.
  \end{lemma}

  \begin{proof}
    \textbf{Checking property~\ref{theorem lower bound, property i}.} We show that singular values of $\probeMatrixFunction (\omega)$ are bounded away from zero. To prove it, we study eigenvalues of $\probeMatrixFunction(\zero)$:
    \begin{align*}
        \lambda_k(\probeMatrixFunction(\zero)) = \lambda_k \left(\frac{1}{4} \identity + \frac{1}{4} \ones \ones^\T \right) = \frac{1}{4} + \frac{1}{4} \lambda_k(\ones \ones^\T) = \frac{1}{4} + \frac{\nclusters}{4} \indicator[k = 1].
    \end{align*}
    Thus, we may bound below singular values of $\probeMatrixFunction(\omega)$ using Weyl's inequality as follows:
    \begin{align*}
        \sigma_k(\probeMatrixFunction(\omega)) \ge \sigma_k(\probeMatrixFunction(\zero)) - \sigma_1(\probeMatrixFunction(\omega) - \probeMatrixFunction(\zero)) \ge \frac{1}{4} - \frac{\nclusters \mu}{\nsize},
    \end{align*}
    where we use Lemma~\ref{lemma: gershgorin circle theorem}. Since $\mu \le \nsize / (8 \nclusters)$, property~\ref{theorem lower bound, property i} is verified.
    
    \textbf{Checking property~\ref{theorem lower bound, property ii}.} Consider arbitrary $\omega \in \Omega$. Define $\probMatrix = \nodeCommunityMatrix_0 \probeMatrixFunction(\omega) \nodeCommunityMatrix_0^\T$. Then, for the $k$-th singular value, we have
    \begin{align*}
        \sigma_k(\probMatrix) = \sigma_k(\probeMatrixFunction(\omega) \nodeCommunityMatrix_0^\T \nodeCommunityMatrix_0).
    \end{align*}
    %
    Next, we obtain
    \begin{align*}
        \left( \nodeCommunityMatrix_0^\T \nodeCommunityMatrix_0 \right)_{k k'} = \sum_{i = 1}^\nsize \nodeCommunityMatrix_{i k} \nodeCommunityMatrix_{i k'}
        = \sum_{i \in \pureNodesSet} \nodeCommunityMatrix_{i k} \nodeCommunityMatrix_{i k'} + \sum_{i \not \in \pureNodesSet} \nodeCommunityMatrix_{i k} \nodeCommunityMatrix_{i k'}
        = \delta_{k k'} |\pureNodesSet_k| + \frac{\mixedCardinality}{\nclusters^2},
    \end{align*}
    where $\delta_{k k'}$ is the Kronecker delta. Thus, we get
    \begin{align*}
        \nodeCommunityMatrix_0^\T \nodeCommunityMatrix_0 = \diag(|\pureNodesSet_k|)_{k = 1}^\nclusters + \frac{\mixedCardinality}{\nclusters^2} \ones \ones^\T.
    \end{align*}
    %
    We study the Gershgorin circles of the matrix $\probeMatrixFunction(\omega) \nodeCommunityMatrix_0^\T \nodeCommunityMatrix_0$. The centers can be computed as follows:
    \begin{align*}
        \mathtt{c}_k &= \left[ \probeMatrixFunction(\omega) \nodeCommunityMatrix_0^\T \nodeCommunityMatrix_0 \right ]_{k k} = |\pureNodesSet_k| \cdot \probeMatrixFunction_{k k}(\omega) + \frac{\mixedCardinality}{\nclusters^2} [\probeMatrixFunction(\omega) \ones]_k \\
        & = \frac{1}{2} |\pureNodesSet_k| + \frac{\mixedCardinality}{\nclusters^2} \sum_{k' = 1}^\nclusters \probeMatrixFunction_{k k'}(\omega)
        = \frac{1}{2} |\pureNodesSet_k| + \frac{\mixedCardinality}{\nclusters^2} \left[ \frac{3 \nclusters}{4} + \frac{\mu}{\nsize} \sum_{k' \neq k} {\omega_{\{k, k'\}}} \right].
    \end{align*}
    %
    Thus, $\mathtt{c}_k \in [\frac{1}{2} |\pureNodesSet_k| - \mixedCardinality, \frac{1}{2} |\pureNodesSet_k| + \mixedCardinality]$. Next, we calculate the $k$-th radius:
    \begin{align*}
        R_k & = \sum_{k' \neq k} \left [ B(\omega) \nodeCommunityMatrix_0^\T \nodeCommunityMatrix_0 \right ]_{k' k} = \frac{\mixedCardinality}{\nclusters^2} \sum_{k' \neq k} [\probeMatrixFunction(\omega) \ones]_{k'} = \frac{\mixedCardinality}{\nclusters^2} \sum_{k' \neq k} \sum_{m = 1}^\nclusters \probeMatrixFunction_{k' m}(\omega) \\
        & \le \frac{\mixedCardinality}{\nclusters^2} \cdot \left(\frac{3 \nclusters^2}{4} + \frac{\nclusters^2 \mu}{\nsize} \right) \le \mixedCardinality.
    \end{align*}
    %
    Thus, we have
    \begin{align*}
        \frac{\sigma_k(\probMatrix)}{\sigma_{k + 1}(\probMatrix)} 
        \ge 
        \frac{\mathtt{c}_k - R_k}{\mathtt{c}_{k + 1} + R_k} 
        \ge 
        \frac{
            \frac{1}{2} |\pureNodesSet_k| - 2 \mixedCardinality
        }{
            \frac{1}{2} |\pureNodesSet_{k + 1}| + 2 \mixedCardinality
        }
        =
        \frac{
            |\pureNodesSet_k| - 4 \mixedCardinality
        }{
            |\pureNodesSet_{k + 1}| + 4 \mixedCardinality
        }.
    \end{align*}
    %
    By construction, we have $|\pureNodesSet_k| / |\pureNodesSet_{k + 1}| \ge 3/2 - O(\nsize^{-1})$. Next, for each $k$, we get
    \begin{align*}
        \frac{\mixedCardinality}{|\pureNodesSet_k|} \le \frac{\mixedCardinality}{|\pureNodesSet_\nclusters|} \le \frac{1}{32} \frac{1}{1 - 2^{- (\nclusters + 5)}} \le \frac{1}{32} \cdot \frac{2^5}{2^5 - 1} = \frac{1}{31}.
    \end{align*}
    %
    Thus, for large enough $\nsize$, we have
    \begin{align*}
        \frac{\sigma_k(\probMatrix)}{\sigma_{k + 1}(\probMatrix)} \ge \frac{3/2 - 4/31 }{1 + 4/31} - O(\nsize^{-1}) \ge 1.2.
    \end{align*}
    Next, we have
    \begin{align*}
        \max_j \sum_{i = 1}^\nsize \probMatrix_{ij} (1 - \probMatrix_{ij}) & \ge \max_{j \in \pureNodesSet_1} \sum_{i \in \pureNodesSet_1} \probMatrix_{ij} (1 - \probMatrix_{ij}) \\
        & \ge \sparsityParam |\pureNodesSet_1| \probeMatrixFunction_{11}(\omega) (1 - \sparsityParam \probeMatrixFunction_{11}(\omega)) \\
        & \ge \frac{\nsize \sparsityParam}{16}.
    \end{align*}

    \textbf{Checking properties~\ref{theorem lower bound, property iii}-\ref{theorem lower bound, property iv}.} The property~\ref{theorem lower bound, property iii} is trivially satisfied. We verify property~\ref{theorem lower bound, property iv} by the following chain of equalities:
    \begin{align*}
        \sum_{j \not \in \pureNodesSet_k} \indicator[
            \Vert \nodeCommunityMatrix_j - \ev_k \Vert_2 \le \delta \sqrt{\frac{\log \nsize}{\nsize \sparsityParam}}
        ] & = \mixedCardinality \cdot \indicator[\Vert \ones / \nclusters - \ev_k \Vert_2 \le \delta \sqrt{\frac{\log \nsize}{\nsize \sparsityParam}}] \\
        & = \mixedCardinality \cdot \indicator[
            (1 - \nclusters^{-1})^{1/2} \le \delta \sqrt{\frac{\log \nsize}{\nsize \sparsityParam}}
        ]
        = 0,
    \end{align*}
    provided $\nsize \sparsityParam > (1 - \nclusters^{-1})^{-1} \delta^2 \log \nsize$.
\end{proof}

\subsection{Permutation-resistant code}
  Let $\Omega'$ be the subset of $\Omega$ obtain from Lemma~\ref{lemma: varshamov-gilbert bound}. Then, for any distinct $\omega, \omega' \in \Omega'$, we have
  \begin{align*}
    d_H(\omega, \omega') \ge \frac{1}{8} \binom{\nclusters}{2} \quad \text{and} \quad |\Omega'| \ge 1 + 2^{\frac 1 8 \binom{\nclusters}{2}}.
  \end{align*}

  Clearly, the map $\probeMatrixFunction\colon \Omega \to [0, 1]^{\nclusters \times \nclusters}$ is injective, i.e. there exists a map $\probeMatrixFunction^{-1}\colon \probeMatrixFunction(\Omega) \to \Omega$ such that $\probeMatrixFunction^{-1} (\probeMatrixFunction(\omega)) = \omega$. Next, the set $\probeMatrixFunction(\Omega)$ is invariant under permutations, i.e.
  \begin{align*}
    \permutationMatrix \probeMatrixFunction(\Omega) \permutationMatrix^\T = \probeMatrixFunction(\Omega)
  \end{align*}
  for any permutation matrix $\permutationMatrix \in \mathbb{S}_\nclusters$. 

  We can express $\Vert \permutationMatrix \probeMatrixFunction(\omega_1) \permutationMatrix^\T - \probeMatrixFunction(\omega_2) \Vert_\F$ in terms of the Hamming distance $$d_H \left (\probeMatrixFunction^{-1}(\permutationMatrix \probeMatrixFunction(\omega_1) \permutationMatrix^\T), \probeMatrixFunction(\omega_2) \right ).$$ In the following lemma, we construct a subset of $\Omega''$ such that for any $\omega_1, \omega_2 \in \Omega''$ the Hamming distance $d_H \left (\probeMatrixFunction^{-1}(\permutationMatrix \probeMatrixFunction(\omega_1) \permutationMatrix^\T), \probeMatrixFunction(\omega_2) \right )$ is large.

  \begin{lemma}
  \label{lemma: factorization}
    There exists a set $\Omega'' \subset \Omega$ such that
    \begin{itemize}
      \item $\zero \in \Omega''$,
      \item for any distinct $\omega_1, \omega_2 \in \Omega''$, we have
      \begin{align*}
          \min_{\permutationMatrix \in \mathbb{S}_\nclusters} d_H(\probeMatrixFunction^{-1} \left( \permutationMatrix \probeMatrixFunction(\omega_1) \permutationMatrix^\T \right), \omega_2) \ge \frac{1}{17} \binom{\nclusters}{2},
      \end{align*}
      \item and it holds that
      \begin{align*}
          |\Omega''| \ge 1 + 2^{\frac{1}{8}\binom{\nclusters}{2}} / |\mathbb{S}_\nclusters|.
      \end{align*}
    \end{itemize}
  \end{lemma}

  \begin{proof}
    Define a map $T_{\permutationMatrix}\colon \Omega \to \Omega$ as follows:
    \begin{align*}
        T_{\permutationMatrix}(\omega) = \probeMatrixFunction^{-1} \left( \permutationMatrix \probeMatrixFunction(\omega) \permutationMatrix^\T \right).
    \end{align*}
    %
    Additionally, define the set $\mathcal{O}_\omega$ as
    \begin{align*}
        \mathcal{O}_\omega = \left \{ \omega' \mid \exists \permutationMatrix \in \mathbb{S}_\nclusters \text{ s.t. } d_{H}(T_{\permutationMatrix}(\omega), \omega') \le \frac{1}{17} \binom{\nclusters}{2} \right \}.
    \end{align*}
    %
    We claim that for any $\omega \in \Omega'$ we have
    \begin{align}
    \label{eq: intersection with Omega}
        |\mathcal{O}_\omega \cap \Omega'| \le \nclusters!.
    \end{align}
    %
    Indeed, if $|\mathcal{O}_\omega \cap \Omega'| > \nclusters!$ then there exists a permutation $\permutationMatrix_0$ such that $d_H(\omega_1, T_{\permutationMatrix_0}(\omega)) \le \frac{1}{17} \binom{\nclusters}{2}$ and $d_H(\omega_2, T_{\permutationMatrix_0}(\omega)) \le \frac{1}{17} \binom{\nclusters}{2}$ for two distinct $\omega_1, \omega_2 \in \Omega'$. By the triangle inequality, that implies $d_H(\omega_1, \omega_2) \le \frac{2}{17} \binom{\nclusters}{2}$ which contradicts the definition of $\Omega'$.

    We construct the set $\Omega''$ iteratively by the following procedure.
    \begin{algorithmic}[1]
        \State Set $\widehat{\Omega} = \Omega' \setminus \{\mathbf{0}\}$, $\Omega'' = \varnothing$
        \Repeat
        \State Choose $\omega \in \widehat{\Omega}$
        \State $\Omega'' := \Omega'' \cup \{\omega\}$
        \State $\widehat{\Omega} := \widehat{\Omega} \setminus \mathcal{O}_\omega$
        \Until{$\widehat{\Omega} = \varnothing$}
        \State $\Omega'' := \Omega'' \cup \{\mathbf{0}\}$
    \end{algorithmic}
    %
    Due to~\eqref{eq: intersection with Omega}, the loop will make at least $2^{\frac{1}{8}\binom{\nclusters}{2}} / |\mathbb{S}_\nclusters|$ iteration. Thus, we have
    \begin{align*}
        |\Omega''| \ge 1 + 2^{\frac{1}{8}\binom{\nclusters}{2}} / |\mathbb{S}_\nclusters|.
    \end{align*}
    %
    We only should check that for two distinct $\omega_1, \omega_2 \in \Omega''$ we have
    \begin{align*}
        \min_{\permutationMatrix \in \mathbb{S}_\nclusters} d_H(T_{\permutationMatrix}(\omega_1), \omega_2) \ge \frac{1}{17} \binom{\nclusters}{2}.
    \end{align*}
    %
    Assume that the opposite holds. Then, $\omega_1 \in \mathcal{O}_{\omega_2}$ and $\omega_2 \in \mathcal{O}_{\omega_1}$. If $\omega_1, \omega_2$ are non-zero that is impossible by the construction of $\Omega''$. WLOG, assume that $\omega_1 = \mathbf{0}$. Then, for any $\permutationMatrix \in \mathbb{S}_\nclusters$, we have
    \begin{align*}
        d_H(T_{\permutationMatrix}(\omega_1), \omega_2) = d_H(\omega_1, \omega_2) \ge \frac{1}{8} \binom{\nclusters}{2}
    \end{align*}
    by the definition of $\Omega'$, the contradiction.
  \end{proof}


\subsection{Bounding KL-divergence}
    In the following lemma, we bound the KL-divergence between probability distribution generated by matrix $\probeMatrixFunction(\zero)$ and other distributions defined by matrices of $\probeMatrixFunction(\omega), \omega \in \Omega \setminus \{\zero \}$.

  \begin{lemma}
  \label{lemma: kl divergence bound}
    Let $\probeMatrixFunction(\zero), \BC$ be as above. Denote by $\PP_0, \PP_{\omega}$ the distributions over graphs generated by matrices $\probeMatrixFunction(\zero), \probeMatrixFunction(\omega)$ respectively. Then, we have
    \begin{align}
    \label{eq: mean KL}
          \KL(\PP_{\omega} \Vert \PP_0 ) \le 8 \mu^2 \sparsityParam
    \end{align}
    for each non-zero $\omega$.
  \end{lemma}

  \begin{proof}
    Let $\probMatrix^{(0)} = \sparsityParam \nodeCommunityMatrix_0 \probeMatrixFunction(\zero) \nodeCommunityMatrix^\T_0$, $\probMatrix^{\omega} = \sparsityParam \nodeCommunityMatrix_0 \probeMatrixFunction(\omega) \nodeCommunityMatrix_0^\T$. Define a matrix-valued function $\mathtt{T}\colon \Omega \to [0, 1]^{\nclusters \times \nclusters}$ as follows:
    \begin{align*}
      \mathtt{T}_{ij}(\omega) = \begin{cases}
          \omega_{\{i, j\}}, & \text{ if } i \neq j, \\
          0, & \text{ if } i = j.
      \end{cases}
    \end{align*}
    %
    Clearly, we have $\probeMatrixFunction(\omega) = \probeMatrixFunction(\zero) + \frac{\mu}{\nsize} \mathtt{T}(\omega)$. Next, we get
    \begin{align*}
      \Delta^{\omega} := \probMatrix^{\probeMatrixFunction(\omega) } - \probMatrix^{(0)} = \frac{\sparsityParam \mu}{\nsize} \nodeCommunityMatrix \mathtt{T}(\omega) \nodeCommunityMatrix^\T.
    \end{align*}
    %
    Then, we have
    \begin{align*}
      \KL (\PP_{\omega} \Vert \PP_0 ) & = \sum_{1 \le i \le j \le \nsize} \KL \left( Bern(\probMatrix^{\omega}_{ij}) \Vert Bern(\probMatrix^{(0)}_{ij})\right) \\
      & = \sum_{1 \le i \le j \le \nsize} \probMatrix^{\omega}_{ij} \log \frac{\probMatrix^{\omega}_{ij}}{\probMatrix^{(0)}_{ij}} + (1 - \probMatrix^{\omega}_{ij}) \log \frac{1 - \probMatrix^{\omega}_{ij}}{1 -\probMatrix^{(0)}_{ij} } \\
      & = \sum_{1 \le i \le j \le \nsize} \probMatrix^{(0)}_{ij} \left(1 + \frac{\Delta^{\omega}_{ij}}{\probMatrix^{(0)}_{ij}} \right) \log \left(1 + \frac{\Delta^{\omega}_{ij}}{\probMatrix^{(0)}_{ij}} \right) + \sum_{1 \le i \le j \le \nsize} (1 - \probMatrix^{\omega}) \log \left(1 - \frac{\Delta_{ij}^{\omega}}{1 - \probMatrix^{(0)}_{ij}} \right) \\
      & \le \sum_{1 \le i \le j \le \nsize} \Delta_{ij}^{\omega} \left(1 + \frac{\Delta^{\omega}_{ij}}{\probMatrix^{(0)}_{ij}} \right) - \Delta_{ij}^{\omega} \left(1 - \frac{\Delta_{ij}^{\omega}}{1 - \probMatrix^{(0)}_{ij}} \right) \\
      & = \sum_{1 \le i \le j \le \nsize} \left(\Delta_{ij}^{\omega} \right)^2 \left( \frac{1}{\probMatrix^{(0)}_{ij}} + \frac{1}{1 - \probMatrix_{ij}^{(0)}} \right)
      = \sum_{1 \le i \le j \le \nsize} \frac{\left(\Delta_{ij}^{\omega} \right)^2}{\probMatrix_{ij}^{(0)} (1 - \probMatrix_{ij}^{(0)})},
    \end{align*}
    where we use inequality $\log(1 + x) \le x$, suitable for any $x \in (-1, + \infty)$. Next, we have
    \begin{align*}
      |\Delta_{ij}^{\omega}| & = \frac{\mu \sparsityParam}{\nsize} \nodeWeights_i^\T \mathtt{T}(\omega) \nodeWeights_j \le \frac{\mu \sparsityParam}{\nsize} \nodeWeights_i^\T \ones \ones^\T \nodeWeights_j = \frac{\mu \sparsityParam}{\nsize}, \\
      \probMatrix^{(0)}_{ij} & = \sparsityParam \nodeWeights_i^\T \left( \frac{1}{4} \identity + \frac{1}{4} \ones \ones^\T \right) \nodeWeights_j = \frac \sparsityParam 4 \nodeWeights_i^\T \nodeWeights_j + \frac \sparsityParam 4 \in [\sparsityParam/4, \sparsityParam/2].
    \end{align*}
    %
    Thus, we obtain
    \begin{align*}
      \KL (\PP_{\omega} \Vert \PP_0 ) \le 8 \mu^2 \sparsityParam.
    \end{align*}
  \end{proof}


\subsection{Proof of Theorem~\ref{theorem: lower bound}}
We distinguish two cases. The first one is when $\nclusters \ge 512$, and the second one is when $2 \le K \le 511$. For a reminder, we have defined $T_{\permutationMatrix} = \probeMatrixFunction^{-1} (\permutationMatrix \probeMatrixFunction(\omega) \permutationMatrix^\T),
  \mathtt{T}(\omega) = \probeMatrixFunction(\omega) - \probeMatrixFunction(\zero)$.

\textbf{Case 1. Suppose that $\nclusters \ge 512$.} 
Let $\Omega''$ be the set obtained from Lemma~\ref{lemma: factorization}. We define the desired set $\BC$ as follows:
  \begin{align*}
  % \label{eq: probe B matrices definition}
    \BC = \probeMatrixFunction(\Omega'').
  \end{align*}
  %
  Since $\probeMatrixFunction(\cdot)$ is injection, we have
  \begin{align*}
    |\BC| \ge 1 + 2^{\frac{1}{8} \binom{\nclusters}{2}} / |\mathbb{S}_\nclusters|.
  \end{align*}


% Define $T_{\permutationMatrix}, \mathtt{T}, \mathtt{B}$ be as in Lemmas~\ref{lemma: property veryfiing}-\ref{lemma: kl divergence bound}.



  First, we bound $\min_{\permutationMatrix \in \mathbb{S}_\nclusters} \Vert \permutationMatrix (\sparsityParam \constCommunityMatrix_1) \permutationMatrix^\T - \sparsityParam \constCommunityMatrix_2 \Vert_\F$ for two distinct $\constCommunityMatrix_1, \constCommunityMatrix_2 \in \BC$. Let $\omega_1, \omega_2$ be such that $\constCommunityMatrix_i = \probeMatrixFunction(\omega_i)$ for each $i \in \{1, 2\}$. We have
  \begin{align}
  \label{eq: lower bound risk permuted}
    \Vert \permutationMatrix \constCommunityMatrix_1 \permutationMatrix^\T - \constCommunityMatrix_2 \Vert_\F^2 & = \frac{\mu^2}{\nsize^2}
        \Vert 
            \permutationMatrix \mathtt{T}(\omega_1) \permutationMatrix^\T - \mathtt{T}(\omega_2)
        \Vert_\F^2 \nonumber \\
    & = \frac{\mu^2}{\nsize^2}
    \Vert 
        \mathtt{T}(T_{\permutationMatrix}(\omega_1)) - \mathtt{T}(\omega_2)
    \Vert_\F^2 \nonumber \\
    & =
    \frac{2 \mu^2}{\nsize^2} d_H(T_{\permutationMatrix}(\omega_1), \omega_2).
  \end{align}
  %
  Due to Lemma~\ref{lemma: factorization}, we have
  \begin{align*}
    \min_{\permutationMatrix \in \mathbb{S}_\nclusters}
    \Vert \permutationMatrix \constCommunityMatrix_1 \permutationMatrix^\T - \constCommunityMatrix_2 \Vert_\F \ge \frac{\mu \nclusters}{\sqrt{34} \nsize}. 
  \end{align*}
  %
  We apply Lemma~\ref{lemma: fano lemma} with $\alpha = 1/16$. Due to Lemma~\ref{lemma: kl divergence bound}, we should choose $\mu$ such that
  \begin{align*}
    8 \mu^2 \sparsityParam \le \frac{1}{16} \log \frac{2^{\frac{1}{8} \binom{\nclusters}{2}}}{|\mathbb{S}_\nclusters|}.
  \end{align*}
  %
  Since $\nclusters \ge 512$, we have
  \begin{align*}
    \log_2 \frac{2^{\frac{1}{8} \binom{\nclusters}{2}}}{|\mathbb{S}_\nclusters|} \ge \frac{1}{8} \binom{\nclusters}{2} - \nclusters \log_2 \nclusters \ge \frac{1}{16} \binom{\nclusters}{2} + \nclusters \left( \frac{\nclusters - 1}{32} - \log_2 \nclusters\right) \ge \frac{1}{16} \binom{\nclusters}{2}.
  \end{align*}
  %
  Hence, $|\BC| \ge 1 + 2^{\binom{\nclusters}{2} / 16}$, and it is enough to satisfy the following inequality:
  \begin{align*}
    8 \mu^2 \sparsityParam \le \frac{\log 2}{256} \binom{\nclusters}{2}.
  \end{align*}
  %
  We choose $\mu = \nclusters \sparsityParam^{-1/2} / 96$. We substitute $\mu$ to~\eqref{eq: lower bound risk permuted}, then apply Lemma~\ref{lemma: fano lemma}, and obtain the result.

  \textbf{Case 2. Suppose that $2 \le K \le 511$.} Choose $\omega \in \Omega$ such that
  \begin{align*}
    \sum_{S \in \binom{[K]}{2}} \omega_{S} \ge \frac{K^2}{4}.
  \end{align*}
  Then, we have
  \begin{align*}
    \Vert \probeMatrixFunction(\zero) - \permutationMatrix \probeMatrixFunction(\omega) \permutationMatrix^\T \Vert_{\F} = \frac{\mu}{\nsize} \Vert \permutationMatrix \mathtt{T}(\omega) \permutationMatrix^\T \Vert_{\F} = \frac{\mu}{\nsize} \sqrt{2 \sum_{S \in \binom{[K]}{2}} \omega_S} \ge \frac{ \mu K}{\sqrt{2} \nsize}.
  \end{align*}
  Let $\PP_\omega, \PP_0$ be distributions defined by the matrices of connection probabilities $\sparsityParam \nodeCommunityMatrix_0 \probeMatrixFunction(\omega) \nodeCommunityMatrix_0^\T, \sparsityParam \nodeCommunityMatrix_0 \probeMatrixFunction(\zero) \nodeCommunityMatrix_0^\T$ respectively. Then, due to Lemma~\ref{lemma: kl divergence bound}, we have
  \begin{align*}
    \KL(\PP_{\omega}, \PP_0) \le 8 \mu^2 \sparsityParam.
  \end{align*}
  Define $\BC = \{\probeMatrixFunction(\omega), \probeMatrixFunction(\zero)\}$. We choose $\mu = \frac{K \sparsityParam^{-1/2} \sqrt{2}}{1152}$. Since $K \le 511$, we have $\KL(\PP^{\omega}, \PP_0) \le 3.2$. Next, we apply Lemma~\ref{lemma: minimax bounds for 2 hypotheses}, and obtain
  \begin{align*}
    \inf_{\estimator[\communityMatrix]} \sup_{\constCommunityMatrix \in \BC} \PP \left ( 
        \min_{\permutationMatrix \in {\mathbb{S}_\nclusters}} \Vert \estimator[\communityMatrix] - \sparsityParam \permutationMatrix \constCommunityMatrix \permutationMatrix^\T \Vert_{\F} \ge \frac{K^2 \sqrt{\sparsityParam}}{1152 \cdot \nsize}
    \right ) \ge \frac{1}{4} e^{-3.2}.
  \end{align*}
