
\definecolor{codegreen}{rgb}{0,0.6,0}
\definecolor{codegray}{rgb}{0.5,0.5,0.5}
\definecolor{codepurple}{rgb}{0.58,0,0.82}
\definecolor{backcolour}{rgb}{0.95,0.95,0.92}

%custom line numbers for listing
\let\othelstnumber=\thelstnumber
\def\createlinenumber#1#2{
    \edef\thelstnumber{%
        \unexpanded{%
            \ifnum#1=\value{lstnumber}\relax
              #2%
            \else}%
        \expandafter\unexpanded\expandafter{\thelstnumber\othelstnumber\fi}%
    }
    \ifx\othelstnumber=\relax\else
      \let\othelstnumber\relax
    \fi
}

%\DeclareCaptionFormat{listing} {
%   \parbox{\textwidth}{\hspace{0cm}#1#2#3}
%
%\captionsetup[lstlisting]{format=listing,labelfont=black,textfont=black,
%        singlelinecheck=true, margin=0pt, font={tt,small,bf}}

\lstdefinestyle{customc}{
  belowcaptionskip=1\baselineskip,
  breaklines=true,
  frame=single,
  xleftmargin=0.35cm,
  xrightmargin=0.15cm,
  numbers=left,
  numbersep=5pt,  
  language=C,
  showstringspaces=false,
  basicstyle=\footnotesize\ttfamily,
  keywordstyle=\bfseries\color{green!40!black},
  commentstyle=\itshape\color{purple!40!black},
  identifierstyle=\color{blue},
  stringstyle=\color{orange},
}


\lstdefinestyle{customcArianeExploit1}{
  breaklines=true,
  frame=single,
  xleftmargin=0.4cm,
  xrightmargin=0.2cm,
  numbers=left,
  numbersep=5pt,  
  language=C,
  showstringspaces=false,
  basicstyle=\footnotesize\ttfamily,
  keywordstyle=\bfseries\color{green!40!black},
  commentstyle=\itshape\color{purple!60!black},
  identifierstyle=\color{blue},
  stringstyle=\color{yellow!50!black},
  morekeywords={asm},
  %keywords=[2]{safe_read,movs},
  keywordstyle=[2]\bfseries\color{brown!60!black},
}

\lstdefinestyle{customcArianeExploit}{
  breaklines=true,
  frame=single,
  xleftmargin=0.4cm,
  xrightmargin=0.2cm,
  numbers=left,
  numbersep=5pt,  
  language=C,
  showstringspaces=false,
  basicstyle=\footnotesize\ttfamily,
  keywordstyle=\bfseries\color{blue},
  commentstyle=\itshape\color{green!50!black},
  identifierstyle=\color{black},
  stringstyle=\color{brown},
  morekeywords={asm},
  %keywords=[2]{safe_read,movs},
  keywordstyle=[2]\bfseries\color{black},
}


\lstdefinestyle{customlog}{
  %belowcaptionskip=1\baselineskip,
  breaklines=true,
  frame=single,
  xleftmargin=0.35cm,
  xrightmargin=0.15cm,
  numbers=left,
  numbersep=5pt,  
  language=C,
  showstringspaces=false,
  basicstyle=\footnotesize\ttfamily,
  keywordstyle=\color{blue},
  commentstyle=\itshape\color{purple!40!black},
  identifierstyle=\color{blue},
  stringstyle=\color{orange},
  keywords=[2]{INFO},
  keywords=[3]{ERROR},x
  keywordstyle=[2]\bfseries\color{green!40!black},
  keywordstyle=[3]\bfseries\color{red!500!black},
}
%  ##keywordstyle=[4]\color{purple!40!black},
%   ##keywordstyle=[4]\color{purple!40!black},

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% Verilog Code Style
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\definecolor{verilogcommentcolor}{RGB}{0,124,0}
\definecolor{verilogkeywordcolor}{RGB}{49,49,255}
\definecolor{verilogsystemcolor}{RGB}{128,0,255}
\definecolor{verilognumbercolor}{RGB}{255,143,102}
\definecolor{verilogstringcolor}{RGB}{160,160,160}
\definecolor{verilogdefinecolor}{RGB}{128,64,0}
\definecolor{verilogoperatorcolor}{RGB}{0,0,128}
\definecolor{pointcolor}{RGB}{192,0,0} %dark red
% Verilog style
\lstdefinestyle{prettyverilog}{
   language           = Verilog,
   commentstyle       = \color{verilogcommentcolor},
   alsoletter         = \$'0123456789\`,
   literate           = *{+}{{\verilogColorOperator{+}}}{1}%
                         {-}{{\verilogColorOperator{-}}}{1}%
                         {@}{{\verilogColorOperator{@}}}{1}%
                         {;}{{\verilogColorOperator{;}}}{1}%
                         {*}{{\verilogColorOperator{*}}}{1}%
                         {?}{{\verilogColorOperator{? }}}{1}%
                         {:}{{\verilogColorOperator{:}}}{1}%
                         {<}{{\verilogColorOperator{<}}}{1}%
                         {>}{{\verilogColorOperator{>}}}{1}%
                         {!}{{\verilogColorOperator{!}}}{1}%
                         {^}{{\verilogColorOperator{^}}}{1}%
                         {|}{{\verilogColorOperator{| }}}{1}%
                         {||}{{\verilogColorOperator{|| }}}{1}%
                         {=}{{\verilogColorOperator{= }}}{1}%
                         {==}{{\verilogColorOperator{== }}}{1}%
                         {=>}{{\verilogColorOperator{=> }}}{1}%
                         {[}{{\verilogColorOperator{[}}}{1}%
                         {]}{{\verilogColorOperator{]}}}{1}%
                         {(}{{\verilogColorOperator{(}}}{1}%
                         {)}{{\verilogColorOperator{)}}}{1}%
                         {rightbracket}{{\verilogColorOperator{)}}}{1}%
                         {,}{{\verilogColorOperator{,}}}{1}%
                         {.}{{\verilogColorOperator{.}}}{1}%
                         {~}{{\verilogColorOperator{$\sim$}}}{1}%
                         {\%}{{\verilogColorOperator{\%}}}{1}%
                         {\&}{{\verilogColorOperator{\& }}}{1}%
                         {\&\&}{{\verilogColorOperator{\&\& }}}{1}%
                         {\#}{{\verilogColorOperator{\#}}}{1}%
                         {\ /\ }{{\verilogColorOperator{\ /\ }}}{3}%
                         {\ _}{\ \_}{2}%
                        ,
   morestring         = [s][\color{verilogstringcolor}]{"}{"},%
   identifierstyle    = \color{black},
   vlogdefinestyle    = \color{verilogdefinecolor},
   vlogconstantstyle  = \color{verilognumbercolor},
   vlogsystemstyle    = \color{verilogsystemcolor},
   basicstyle         = \small\fontencoding{T1}\ttfamily,
   %basicstyle         = \fontsize{9}{11}\fontencoding{T1}\ttfamily,
  columns=fullflexible, 
   keywordstyle       = \bfseries\color{verilogkeywordcolor},
   morekeywords      = {val, when, port, coverage, unique},
   numbers            = left,
   numbersep          = 5pt,
   tabsize            = 2,
   escapeinside       = {/*!}{!*/},
   upquote            = true,
   sensitive          = true,
   %stringstyle=\color{codepurple},
   showstringspaces   = false, %without this there will be a symbol in the places where there is a space
   frame              = single,
   breaklines         = true,
   abovecaptionskip   = 0pt,
   belowcaptionskip   = 2pt,   
   xleftmargin        =0.35cm,
   xrightmargin       =0.15cm,
   captionpos         = t,
   emph               = {Point, Point0, Point1, Point2, Point3, Point4, Point5, Point6, Point7, Point8, Point9},
   emphstyle          =\color{pointcolor},%\bfseries\color{pointcolor},
   emph               = {[2] STVEC,SCOUNTEREN,MSTATUS,MTVEC,ML1_ICACHE_MISS,ML1_DCACHE_MISS,MITLB_MISS,MDTLB_MISS,
                             MLOAD,MSTORE,MEXCEPTION,MEXCEPTION_RET,MBRANCH_JUMP,MCALL,MRET,MMIS_PREDICT,MSB_FULL,
                             MIF_EMPTY,MHPM_COUNTER_17,MHPM_COUNTER_18,MHPM_COUNTER_19,MHPM_COUNTER_20,MHPM_COUNTER_21,
                             MHPM_COUNTER_22,MHPM_COUNTER_23,MHPM_COUNTER_24,MHPM_COUNTER_25,MHPM_COUNTER_26,MHPM_COUNTER_27,
                             MHPM_COUNTER_28,MHPM_COUNTER_29,MHPM_COUNTER_30,MHPM_COUNTER_31}, % for the case study why combine fuzzing and formal
   emphstyle          = {[2]\bfseries\color{verilogkeywordcolor}}
}


% This is shamelessly stolen and modified from:
% https://github.com/jubobs/sclang-prettifier/blob/master/sclang-prettifier.dtx
\makeatletter

% Language name
\newcommand\language@verilog{Verilog}
\expandafter\lst@NormedDef\expandafter\languageNormedDefd@verilog%
  \expandafter{\language@verilog}
  
% save definition of single quote for testing
\lst@SaveOutputDef{`'}\quotesngl@verilog
\lst@SaveOutputDef{``}\backtick@verilog
\lst@SaveOutputDef{`\$}\dollar@verilog

% Extract first character token in sequence and store in macro 
% firstchar@verilog, per http://tex.stackexchange.com/a/159267/21891
\newcommand\getfirstchar@verilog{}
\newcommand\getfirstchar@@verilog{}
\newcommand\firstchar@verilog{}
\def\getfirstchar@verilog#1{\getfirstchar@@verilog#1\relax}
\def\getfirstchar@@verilog#1#2\relax{\def\firstchar@verilog{#1}}

% Initially empty hook for lst
\newcommand\addedToOutput@verilog{}
\lst@AddToHook{Output}{\addedToOutput@verilog}

% The style used for constants as set in lstdefinestyle
\newcommand\constantstyle@verilog{}
\lst@Key{vlogconstantstyle}\relax%
   {\def\constantstyle@verilog{#1}}

% The style used for defines as set in lstdefinestyle
\newcommand\definestyle@verilog{}
\lst@Key{vlogdefinestyle}\relax%
   {\def\definestyle@verilog{#1}}

% The style used for defines as set in lstdefinestyle
\newcommand\systemstyle@verilog{}
\lst@Key{vlogsystemstyle}\relax%
   {\def\systemstyle@verilog{#1}}

% Counter used to check current character is a digit
\newcount\currentchar@verilog
  
% Processing macro
\newcommand\@ddedToOutput@verilog
{%
   % If we're in \lstpkg{}' processing mode...
   \ifnum\lst@mode=\lst@Pmode%
      % Save the first token in the current identifier to \@getfirstchar
      \expandafter\getfirstchar@verilog\expandafter{\the\lst@token}%
      % Check if the token is a backtick
      \expandafter\ifx\firstchar@verilog\backtick@verilog
         % If so, then this starts a define
         \let\lst@thestyle\definestyle@verilog%
      \else
         % Check if the token is a dollar
         \expandafter\ifx\firstchar@verilog\dollar@verilog
            % If so, then this starts a system command
            \let\lst@thestyle\systemstyle@verilog%
         \else
            % Check if the token starts with a single quote
            \expandafter\ifx\firstchar@verilog\quotesngl@verilog
               % If so, then this starts a constant without length
               \let\lst@thestyle\constantstyle@verilog%
            \else
               \currentchar@verilog=48
               \loop
                  \expandafter\ifnum%
                  \expandafter`\firstchar@verilog=\currentchar@verilog%
                     \let\lst@thestyle\constantstyle@verilog%
                     \let\iterate\relax%
                  \fi
                  \advance\currentchar@verilog by \@ne%
                  \unless\ifnum\currentchar@verilog>57%
               \repeat%
            \fi
         \fi
      \fi
      % ...but override by keyword style if a keyword is detected!
      %\lsthk@DetectKeywords% 
   \fi
}

% Add processing macro only if verilog
\lst@AddToHook{PreInit}{%
  \ifx\lst@language\languageNormedDefd@verilog%
    \let\addedToOutput@verilog\@ddedToOutput@verilog%
  \fi
}

% Colour operators in literate
\newcommand{\verilogColorOperator}[1]
{%
  \ifnum\lst@mode=\lst@Pmode\relax%
   {\bfseries\textcolor{verilogoperatorcolor}{#1}}%
  \else
    #1%
  \fi
}



\makeatother
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
% End Verilog Code Style
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%



\lstdefinestyle{mystyle}{
    %backgroundcolor=\color{backcolour},   
    commentstyle=\textit,
    keywordstyle=\textbf,
    %numberstyle=\tiny\color{codegray},
    stringstyle=\color{codepurple},
    basicstyle=\ttfamily,
    breakatwhitespace=false,         
    breaklines=true,      
    %frame=tb,
    frame=single, 
    framexleftmargin=\parindent,
    captionpos=b,                    
    keepspaces=true,                 
    numbers=left,    
    numberstyle=\normalsize,
    stepnumber=1,
    numbersep=5pt,   
    xleftmargin=1.5\parindent,
    showspaces=false,                
    showstringspaces=false,
    showtabs=false,                  
    tabsize=2
}

\begin{comment}
\lstset{style=mystyle}
\end{comment}


\lstset{
  language=Java, 
  basicstyle=\small, 
  frame=single, 
  breaklines=true, 
  postbreak=\raisebox{0ex}[0ex][0ex]{\ensuremath{\hookrightarrow\space}},
  deletestring=[b]",
  deletestring=[b]'
}