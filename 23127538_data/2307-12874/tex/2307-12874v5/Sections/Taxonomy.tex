
\section{Wallet Design Taxonomy}
\label{sec:wallet-taxonomy}


We propose a design taxonomy for classifying and developing wallets that integrates traditional models and recent advances, as illustrated in \autoref{fig:multi_axes}. To develop this framework, we analyse various designs of wallets within the industry. We also identify known vulnerabilities and previous attacks associated with these wallets, as summarised in \autoref{tab:wlt._taxonomy}. 


% % Figure environment removed



\subsection{Infrastructure}
\label{sec:infrastructure}

This design factor is centred on the private key (\textcolor{teal}{\textit{sk}}) or transaction management infrastructure (see \autoref{sec:wallet_mechanism}) the controlling entity employs. 


\subsubsection{Software Wallets}
\label{sec:software-wallets} 

Software wallets are applications that manage private keys (\textcolor{teal}{\textit{sk}}) or transaction authorisation conditions within a software environment. Existing software infrastructure designs include desktop, browser, mobile and smart contract wallets, as demonstrated within \autoref{fig:wallet-taxonomy}. Desktop wallets are installed on computers and typically store \textcolor{teal}{\textit{enc\_sk}} in a local file within the computer's file system. Browser wallets present an alternative setup, with programs installed or built into the web browser and credentials are typically stored in the browser's local storage \cite{2024MetaMaskWallet}. Two existing designs are browser extensions, such as MetaMask and Phantom, and built-in browser-native wallets, such as Brave \cite{Brave2023BraveBrave}. 

Another prevalent wallet type is the mobile wallet, which is installed on devices with limited computing power and storage capability in comparison with PCs. Mobile wallets also typically store \textcolor{teal}{\textit{enc\_sk}} locally and can enhance security through mobile \acs{os} integrations such as the Android Keystore and iOS Keychain \cite{keystore}. However, if vulnerabilities are present in the operating system \autoref{sec:threat_class}, susceptibility to specific attacks that exploit these weaknesses exists (see \autoref{sec:privilege}).

To mitigate the risk of \textcolor{teal}{\textit{sk}} and \textcolor{teal}{\textit{rdm\_seed}} loss, smart contract wallets (e.g., Argent and Safe) are deployed on the blockchain to abstract typical \textcolor{teal}{\textit{sk}} management (see \autoref{sec:wallet_mechanism}) and create advanced transaction functions such as \acf{mfa}, ownership assignments, spending limits, and recovery mechanisms, often through integration with centralised or decentralised relayers \cite{di2020characteristics, erc4337}. 

TON Space, another smart contract wallet, allows users to create and sign transactions without leaving the chat by interacting through TON's standard Wallet-V4 account model \cite{tonwalletv4}. The key management functionality, bot-based transfers, and cloud backups are mediated through Telegram IDs and WebView sessions.  This approach shifts part of the trust boundary from the mobile operating system to Telegram’s \acs{api} and bot infrastructure, introducing centralisation risks \cite{beincrypto2025ton} and
exposing generic WebView attack surfaces \cite{halborn2024webview}. Despite their capabilities, smart contract wallets are susceptible to library vulnerabilities, implementation flaws, and access-control misconfigurations. These application logic vulnerabilities have resulted in significant financial losses in several cases \cite{palladino2017parity, Parisi2023WalletSecurity, bybit_certik}.

\subsubsection{Hardware Wallets}
\label{sec:hardware-wallets}

Hardware wallets typically involve \textcolor{teal}{\textit{sk}} management within a \acf{se} (e.g., microcontroller or smart card) to protect against tampering and facilitate the execution of cryptographic operations, such as transaction signing (see \autoref{sec:wallet_mechanism}). Isolated in design with no internet connectivity, their mechanism performs all cryptographic operations on an offline hardware device. They typically require a distinct online device to create and broadcast transactions \cite{ledgeracademy}. As shown in \autoref{fig:wallet-taxonomy}, the connection between both devices can be achieved through Bluetooth (e.g., Ledger), USB (e.g., Trezor), \acf{nfc} (e.g., Tangem) and QR codes (e.g., Ngrave). Specific hardware wallet vulnerabilities \cite{Cointelegraph2023LedgerRedefined, Ledger2018FirmwareFixed, CoinDesk2018SecurityAntennae, Freemindtronic2023LedgerHackers}, and attacks \cite{Akter2023AChallenges, hajdu2020using, wang2024efficient, courbon2016reverse} are discussed in \autoref{sec:vuln_phy} and \autoref{sec:physical-attacks}, respectively.

\subsection{Custody}
\label{sec:design-cust}

The degree of \textcolor{teal}{\textit{sk}} control by an entity or between one or more entities defines custody design. Custody setups include custodial, non-custodial and shared-custodial.


% Figure environment removed

\subsubsection{Custodial}
\label{sec:custodial-wallets}

In this model, \textcolor{teal}{\textit{enc\_sk}} is stored by a trusted custodian (e.g., Coinbase Exchange, Binance Exchange, Kraken Exchange) who signs user-initiated transactions. The user relinquishes \textcolor{teal}{\textit{sk}} security to the custodian who fully controls the wallet operations (see \autoref{sec:wallet_mechanism}), while the user solely crafts transaction messages. Although most of the design factors for custodial wallets are not disclosed (see \autoref{tab:wlt._taxonomy}), a classification of their design can be conducted using our framework. In the table, we denote \enquote{\smallhalfcirc} representing user-facing infrastructure and \enquote{\smallfullcirc} the internal infrastructure employed by the custodian. 

Two notable design variations exist in custodial wallets. First, an omnibus setup aggregates and controls all users' funds under a few shared addresses, without a one-to-one correspondence between user accounts and addresses. Second, a segregated setup assigns each user a unique blockchain address, with the custodian retaining control of the associated private keys (\textcolor{teal}{\textit{sk}}) \cite{chalkias2022broken}.


\subsubsection{Non-Custodial}
\label{sec:non-custodial-wallets}

In non-custodial wallet architectures (e.g., MetaMask, Phantom, Ledger), the user does not relinquish control to any custodian party. Instead, a direct interaction between the user and the blockchain network exists in these setups with the user in full control of \textcolor{teal}{\textit{sk}}, to facilitate all the wallet operations (see \autoref{sec:wallet_mechanism}). With full autonomy, the user is solely responsible for securing \textcolor{teal}{\textit{sk}} and is more susceptible to insecure user interaction threats as well as other vulnerabilities (see \autoref{sec:threat_class}) and attacks such as social engineering attacks and malware-based attacks (see \autoref{sec:application-attacks}) which aim to exploit user negligence. While non-custodial wallets are expected not to have credential control, a few incidents in the past (e.g., Slope Wallet \cite{CoinTelegraph}) have resulted in \textcolor{teal}{\textit{sk}} compromise due to poor implementation practices, insecure storage of sensitive information, or inadvertent leaks \cite{CoinTelegraph2022SlopeAttack}.


\subsubsection{Shared-Custodial}
\label{sec:semi-custodial-wallets}

Shared-custodial wallets strike a balance between custodial and non-custodial models by enabling joint control of the secret key (\textcolor{teal}{\textit{sk}}) between a user and a custodian. In this setup, the \textcolor{teal}{\textit{sk}} is split or distributed across two or more parties, allowing the user to delegate a degree of transaction authorisation rights and trust to the custodian. This arrangement gives both parties partial control over the wallet's signing and recovery operations \cite{erinle2024shared, Das2024Shared-CustodialWallets}. As a result, even if one party's security is compromised, the risk of a complete \textcolor{teal}{\textit{sk}} compromise is mitigated. For example, ZenGo’s operational model implements shared custody with \acf{mpc} by storing one part of the \textcolor{teal}{\textit{sk}} on ZenGo's centralised server, while the other part remains on the user's device \cite{zengo_rec}. Other shared custodian models are discussed in \autoref{sec:design-distr}.

\subsection{Initialisation}
\label{sec:design-init}

This pertains to the creation of the wallet through \textcolor{teal}{\textit{sk}} generation (see \autoref{sec:key_generation}) or contract deployment. During initialisation in smart contract wallets, user account contracts are typically created by interactions made by the relayer. In conventional wallets, the \textcolor{teal}{\textit{sk}} generation scheme can be non-deterministic, deterministic, or hierarchical deterministic, depending on the degree of randomness and flexibility required. Another interesting design option is the \acs{kdf} choice. Typically, most wallets (e.g., Ledger \cite{ledger_seed}) employ \acf{pbkdf}; however, novel research into threshold \acf{mfkdf} construction could influence current cryptographic designs \cite{NairMulti-FactorManagement, nair2023decentralizing}. While this improves security, more processing time and power may be required to generate the derived key \cite{trezor_memory}.

% \input{Exhibits/Types-Wallets}


\subsection{Distribution}
\label{sec:design-distr}

This is the degree of authorisation (see \autoref{sec:design-author}) or \textcolor{teal}{\textit{sk}} distribution between storage mechanisms.  Single or variations of shared authorisation between multiple user devices, multiple users or a user and a custodian (see \autoref{sec:design-cust}) are observable setups. Single setups allow for sole authorisation by a user or custodian, while authorisation is distributed in the shared setup to avoid a single point of failure. 

Multi-distributed designs typically exist in two forms: smart wallet-enabled multi-sig (on-chain multi-sig) and threshold \acs{mpc}. For smart contract wallets that follow \acf{eip} 4337, the account contract may adopt any of these schemes: single key, multi-sig, or \acs{mpc}, as the standard merely asks the contract to prove validity to \texttt{validateUserOp}. On-chain multi-sig typically has authorisation dispersed between multiple private keys (\textcolor{teal}{\textit{sk}}), while \acs{mpc} wallets divide a single \textcolor{teal}{\textit{sk}} into \enquote{key shares}, which are then distributed \cite{bip11, Lindell2020SecureComputation}. Design flexibility in some \acs{mpc} wallets also allows for a hierarchical sub-shard distribution (e.g., Web3Auth) if necessary \cite{web3_auth}. While both offer authorisation distribution, trade-offs exist between the two (see \autoref{sec:design-author} \& \autoref{sec:design-val}).

\subsection{Authentication}
\label{sec:design-authen}

% \textcolor{teal}{\textit{state\_trans\_info}}

Authentication is the process of verifying the legitimate wallet owner before granting access, either by decrypting \textcolor{teal}{\textit{enc\_sk}} with the \acf{kek} (see \autoref{sec:key-storage}) or by employing other methods defined within the underlying logic. Existing authentication methods include single-factor (\textcolor{teal}{\textit{pw}} or \textcolor{teal}{\textit{PIN}}), multi-factor authentication, and novel password-abstracted authentication methods such as passkeys enabled by smart contract or \acs{mpc} wallets. For instance, the Binance Web3 Wallet uses \acs{mpc} to generate three key-shares: one secured by Binance, one stored on the user’s device, and one encrypted with a user-defined recovery password and backed up to the user’s iCloud/Google Drive. The wallet uses a 2-of-3 threshold scheme to authorise transactions, so Binance’s single share is insufficient on its own \cite{Binance2023EmbracingWallet}.


% (see \autoref{sec:design-init})


\subsection{Authorisation}
\label{sec:design-author}

Authorisation in the context of wallets is defined as a direct or indirect confirmation of a state change transaction (see \hyperref[sec:def-trans]{Definition 3.2}) by a single signature or multiple signatures (\teal{$\sigma$}). In the \acs{eip}-4337 flow, the user signs a \texttt{UserOperation}. However, a Bundler/Relayer authorises the on-chain transaction by submitting the batch to the shared \texttt{EntryPoint} \cite{erc4337}. We therefore mark every 4337 wallet as \enquote{Relayer} in \autoref{tab:wlt._taxonomy}. \acs{mpc} key shards produce a single signature while being distributed among various parties with individual public addresses hidden. 

Multi-sig smart wallets demonstrate authorisation through multiple signatures, each associated with an individual public address. This approach does not enhance privacy since all involved addresses are visible on the blockchain. \acs{eip}-4337-enabled smart contract wallets employ a relayer (bundler) to aggregate multiple users' state transfer messages into a single authorised transition. Another factor that influences the authorisation setup is the choice of signature scheme.


\subsection{Validation}
\label{sec:design-val}
Transaction validation typically refers to authentication against the blockchain using the user's \textcolor{teal}{\textit{pk}} \cite{Homoliak2024SoK:Factors, Homoliak2020SmartOTPs:Wallets}. In addition to single distributed wallets, \acs{mpc} wallets also produce a single \textcolor{teal}{\textit{pk}} from key shards, which can be employed to validate the transaction. On the other hand, native multi-sig wallets validate each party's public key. \acs{eip}-4337 allows more flexible validation variations, as an \texttt{EntryPoint} contract validates and executes state changes sent by authenticated users \cite{erc4337}. Additionally, recent developments (\acs{erc}-1271 \cite{Ethereum2018ERC-1271:Contracts} \& \acs{erc}-6492 \cite{Ethereum2023ERC-6492:Contracts}) have enabled standardised and improved signature validation methods for smart contracts. 

\subsection{Recovery}
\label{sec:design-rec}

Recovery serves as a method to retrieve \textcolor{teal}{\textit{sk}} or lost transaction authorisation rights and typically follows the initialisation (see \autoref{sec:design-init}) and distribution (see \autoref{sec:design-distr}) setups selected.

\subsubsection{Seed Recovery}
The industry standard fallback for a user wallet is the \acf{bip} 39 mnemonic recovery phrase, usually 12 or 24 English words that encode the master \acf{hd} seed \cite{bip39_}. Specifically, 128–256 bits of random entropy are appended with a checksum and split into 11-bit chunks, each of which indexes one word in the 2048-word \acs{bip}-39 list. When the user re-enters the phrase, it is processed through 2048 iterations of PBKDF2 (Password-Based Key-Derivation Function v2) using HMAC-SHA-512 (a keyed-hash message-authentication code) to yield a 512-bit seed. This seed forms the root of the wallet’s \acs{hd} key tree, from which every subsequent \textcolor{teal}{\textit{sk}} is derived \cite{bip39_}.

Two notable design variations to the default mnemonics setup exist to offer additional security. First, the optional portability passphrase (\enquote{25th word}) in \acs{bip}‑39 allows plausible deniability if the base phrase is coerced \cite{vault12_bip39}. Second, \acs{slip}‑39 Shamir‑Secret‑Sharing mnemonics fragment the seed into shares, requiring a quorum (e.g., m‑of‑n) to restore the wallet \cite{trezorslip39, slip39_site}. Some mobile wallets go further by pairing mnemonics with encrypted cloud backups (e.g., Coinbase Wallet using iCloud/Google Drive), improving usability while keeping control with the user \cite{coinbase_backup}. 

Despite convenience gains, mnemonic phrases remain prime targets for social engineering and clipboard‑scraping malware, reinforcing the need for offline generation and, where feasible, distributed‑share approaches. Social platforms such as Telegram extend cloud backups into custodial-assisted models. For example, TON Space encrypts the seed locally and synchronises it with Telegram Cloud, binding recovery to the user’s Telegram ID. After re-authenticating that account, the Mini App reinjects the seed into a Wallet-V4 contract. This incurs no on-chain fee; however, it creates a single point of failure, as loss or compromise of the Telegram account threatens both availability and confidentiality \cite{beincrypto2025ton,tonwalletv4}.  


\subsubsection{Seedless Recovery}
Seedless recovery eliminates mnemonic phrases and re-establishes user authorisation rights without a seed. Single or multi-party variations exist, with common instantiations including contract-based social recovery, MPC re-sharing, and other implementations such as \acf{derec} \cite{buterin_social_recovery_2021, Lindell2020SecureComputation, derec}. Implementations differ and create distinct cost profiles in smart contract and \acs{mpc} wallets. \acs{mpc} wallets perform recovery off-chain through key fragment reconstruction and thus incur no on-chain network fees. By contrast, smart contract wallets (e.g., Coinbase Smart Wallet) implement recovery as an on-chain signer/owner change that requires a network fee \cite{coinbase_smart_wallet_recovery}. However, one smart contract wallet, Argent, circumvents this by offering users off-chain recovery \cite{argent_rec}. More recently, the \acs{derec} standard proposes an interoperable, multi-party key recovery framework that allows users to regain access across different wallets and services without relying on a single custodian \cite{derec}.



% \teal{$rdm\_seed$}

\subsection{Other Design Factors}
\label{sec:design-other}

\autoref{tab:wlt._taxonomy} shows other design factors such as transparency and agnosticism. The underlying mechanism of existing hardware, software, non-custodial and shared-custodial wallets often functions in degrees of transparency. While open-source models benefit from public audits, open knowledge of mechanisms can provide an advantage to an adversary. Chain support is another important factor, as integration with multiple blockchain networks defines blockchain-agnosticism. As blockchains often operate as fragmented systems, heterogeneous designs foster enhanced interoperability.

\input{Exhibits/Types-Wallets}
