\section{Attack Taxonomy}
\label{sec:attack-framework}

In this section, we present a comprehensive taxonomy of wallet attack vectors, systematically examining the methods, techniques, and targeted components involved. Building on our generalized wallet mechanisms and threat model taxonomy, we outline a broad spectrum of attacks, as illustrated in \autoref{fig:wallet-attacks}. These attacks are categorized based on the specific functions and components they target within the wallet infrastructure (see \autoref{sec:wallet_mechanism}) and are classified according to our threat model (see \autoref{sec:threat_class}). We further incorporate the infrastructure layer of our design taxonomy to capture the multi-layered nature of these threats, as summarized in \autoref{tab:attack_vectors}. To construct this taxonomy, we analysed data from academic literature and notable industry incidents from 2012 to 2024, each varying in severity and financial impact (see \autoref{fig:lossMonthly}).

% \subsection{Methodology}
% \label{sec:methodology-attacks}

% % Figure environment removed


\subsection{Network Attacks}
\label{sec:network-attacks} 

\subsubsection{Connection Hijack}
\label{sec:mitm}
These attacks aim to compromise the communication channel between wallets and other network participants using \acs{mitm} attacks to intercept and modify the \teal{$txn$} message generated by \hyperref[algo:transaction-signing]{Algorithm 3}. Various types of \acs{mitm} include Rogue \acs{ap} \cite{Hu2021SecurityCountermeasures}, \acs{dns} spoofing \cite{Ahmed2017MitigatingNetworking, Al-Mashhadi2020ASystems}, \acs{ip} spoofing \cite{shrivas2020disruptive} and \acf{icmp} redirection \cite{Feng2023Man-in-the-middleRedirects} as shown in \autoref{tab:attack_vectors}. Any software which allows users to manage or import the private key is vulnerable to these attacks. For example, EtherDelta, a \acs{dex} which allows users to import \teal{$sk$} was a victim of a \acs{mitm} attack following a \acs{dns} server compromise. Hardware wallets are also vulnerable to these attacks if the online wallet client (see \autoref{sec:hardware-wallets}) is compromised. Ledger has previously reported susceptibility to \acs{mitm} attacks.  

\subsubsection{Service Denial}
\label{sec:dos}

This is executed using adversary-controlled devices to orchestrate \acf{ddos} attacks which overwhelm the network infrastructure with an excessive volume of requests causing a decline or cessation of the wallet operations (see \autoref{sec:wallet_mechanism}) \cite{ChandanProtectiveCryptocoin}. These attacks often target the \acf{icmp}, \acf{tcp} handshake mechanism and other network infrastructure \cite{chaganti2022comprehensive}. One common medium of conducting a \acs{ddos} attack is through botnets, which involves an adversary using a network of computers \cite{krombholz2015advanced}. 


% The transaction management operations (see \autoref{sec:transaction_management}) in software wallets and the transaction broadcast function in hardware wallets are affected by this attack.


% % Figure environment removed

\subsection{Application Attacks}
\label{sec:application-attacks}

\subsubsection{Malware Execution}
\label{sec:malware}

This intrusively exploits system vulnerabilities to steal transaction data, the \teal{$sk$} and password credentials, or to manipulate wallet operations as described in \autoref{sec:wallet_mechanism}. Malware threatens the wallet mechanism by replacing the \teal{$recipient\_address$} via a clipboard hijacker \cite{li2020android} or input monitoring via keyloggers \cite{balakrishnan2023analysis} and other spyware types \cite{weichbroth2023security, ferdous2023review}. Hardware wallets are also vulnerable to clipboard hijack attacks \cite{ivanov2021ethclipper, Akter2023AChallenges}; malware can be injected through interactions between the wallet and removable media such as USB drives \cite{guri2018beatcoin}. Several studies have investigated malware execution on hardware wallets.

% \paragraph{Clipboard Hijacker}
% \label{sec:clipboard}

% This attack involves the use of malware to exploit the \enquote{ClipboardManager} component of a wallet device to monitor the contents of a user’s clipboard and steal the \teal{$pwd$} or replace the \teal{$recipient\_addr$} with the adversary's \cite{ulqinaku2019scan, li2020android}.

% This attack exploits the fact wallet addresses are difficult to type out.

% \paragraph{Keylogger}
% \label{sec:keylogger}

% Keyloggers can track every keystroke executed on an infected wallet device to steal password details (\teal{$pwd$}) and other confidential data \cite{balakrishnan2023analysis}.

% These programmes can intercept data transmitted by application programming interfaces (APIs), which enable other apps to accept keyboard input, despite not having administrator privileges.Software keyloggers are far more prevalent since they are much simpler to introduce and install on victims' devices. Software keyloggers do not pose a hazard to the systems they infect, in contrast to other types of malwares. In actuality, keyloggers are designed to function invisibly, sniffing out keystrokes while the machine is still in use. Keyloggers are undoubtedly a menace to consumers, even if they don't damage the hardware, particularly when they take private information.

% \paragraph{Ransomware}
% \label{sec:ransom}

% This malware specifically targets the file system, where the adversary encrypts data to deny user access (see \autoref{sec:key-storage}) to the wallet \cite{conti2018economic}. After successful infiltration, the adversary encrypts files on the wallet device and extorts a ransom in exchange for access to the encrypted data \cite{kapoor2021ransomware}.  

% \paragraph{Spyware}
% \label{sec:spyware}

% This is malware engineered to monitor the user's actions and retrieve confidential data such as the user's \teal{$pwd$} or the \teal{$sk$} \cite{weichbroth2023security, ferdous2023review}. It includes keyloggers which track every keystroke executed on an infected wallet device to steal confidential data \cite{shaikh2022survey, balakrishnan2023analysis}.

% \paragraph{Malicious Files}
% need access to the reference to write on this 


% \paragraph{Supply Chain Attack}
% \label{sec:supply}


% Supply Chain Attacks compromise wallet security by embedding malicious code during software or hardware development phases \cite{robinson2022new}. Such breaches can fundamentally undermine the integrity of key generation and transaction management mechanisms (\autoref{sec:transaction_management}), exposing sensitive operations to the adversary. An example of this attack occurred in the BitKeep wallet hack, where the compromise of the application update mechanism resulted in the hijack of the non-custodial wallet's (see \autoref{sec:non-custodial-wallets}) website and the loss of funds for users \cite{certik_2022}.

% \paragraph{Removable Media Infection}
% \label{sec:removable}

% This attack method capitalises on the interactions between hardware wallets described in \autoref{sec:hardware-wallets} and removable media, such as USB drives, to inject malware during critical processes like transaction signing (\autoref{sec:transaction_signing}) \cite{guri2018beatcoin}. By compromising these removable devices, adversaries can disrupt the secure execution of transaction creation (\autoref{sec:transaction_signing}).

\subsubsection{Social Engineering}
\label{sec:social}
These attacks aim to manipulate the user into divulging confidential data. Phishing attacks, for instance, aim to deceive wallet users into revealing \teal{$sk$} or \teal{$pw$} by mimicking legitimate services. If successful, the adversary can use supplementary attack vectors to gain unauthorised access \cite{krombholz2015advanced}. Instances where adversaries have employed phishing to deliver malware include the Pink Drainer, Monkey Drainer, Venom Drainer and Inferno attacks \autoref{tab:attack-incidents}. 



% automatic Github
% crypto-wallets-mapping.drawio.pdf
% scale=0.80

% crypto-wallets-mapping.drawio.drawio.pdf
% scale=0.40


\subsubsection{Privilege Escalation}
\label{sec:privilege}

These attacks aim to circumvent standard access controls to acquire elevated permissions. In the Android root privilege attack, the adversary can gain unauthorised root access to mobile wallets via vulnerabilities in the \acf{os} \cite{he2020security}. Another OS-related attack, Android USB debugging \cite{he2020security}, exploits \acf{os} vulnerabilities in mobile devices by wireless debugging, using a computer connected to the same network. Following this, the adversary gains unrestricted access to manipulate the execution flow of the wallet and capture \teal{$sk$}, \teal{$rdm\_seed$} and other sensitive data \cite{he2020security}. Logic Flow Exploitation encompasses several wallet types and involves the identification and exploitation of flaws in the programming logic of a wallet mechanism (\autoref{sec:wallet_mechanism}) to gain unauthorised access or manipulate wallet functions \cite{Parisi2023WalletSecurity}. The WazirX and parity wallet attacks are notable examples of this attack \cite{palladino2017parity}.

% This attack exploits the Android’s Linux-based operating system vulnerabilities of mobile wallets to gain unauthorised administrative control; therefore, giving the adversary unrestricted permission \cite{he2020security}. With escalated access, the adversary can manipulate the wallet function and steal the private key.


\subsection{Authentication Attacks}
\label{sec:auth-attacks}

% % Figure environment removed

\subsubsection{Credential Cracking}
\label{sec:cred-crack}

This category of attacks systematically attempts different credential values to bypass the authentication mechanism. Brute force attacks involve an adversary systematically trying all possible character combinations to bypass the authentication function and decrypt the \teal{$sk$}. If successful, the adversary can create malicious transactions using the \hyperref[algo:transaction-signing]{Algorithm 3} \cite{Kiktenko2019DetectingWallets}. Dictionary attacks, on the other hand, leverage commonly used words to predict \teal{$rdm\_seed$} phrases or passphrases for access. Unlike brute force attacks that exhaust all possible combinations, dictionary attacks are computationally less demanding \cite{Uddin2021Horus:Wallets}. Their success rate increases with the use of leaked password datasets \cite{praitheeshan2019security}.



% Prevents the figure from moving too far from the table
% \FloatBarrier

% \clearpage


% These attacks require substantial computational resources and may utilize multiple machines operating in parallel, making the process highly time-consuming \cite{volety2019cracking}

% \subsubsection{Dictionary Attacks}
% \label{sec:dictionary}

% \subsubsection{Code Reuse}
% \label{sec:code-reuse}

% These attacks manipulate the intended functionality of software components to alter execution flow and bypass security measures without necessarily injecting new code \cite{palladino2017parity}. An adversary can exploit existing code or logic constructs in the wallet mechanism to perform unauthorised actions \cite{bletsch2011jump}.

% A likely method of attack for the Gatecoin incident

% the malicious external party involved in this breach, managed to alter our system so that ETH deposit transfers by-passed the multi-sig cold storage and went directly to the hot wallet during the breach period

  
 % By leveraging inherent flaws, misconfigurations, or oversight in the system's design or implementation, attackers orchestrate unintended behaviour that can compromise security, integrity, or availability of the targeted system.



% \subsubsection{Evil Maid Attack}
% \label{sec:evil-maid}


% This attack leverages areas of a wallet device's storage that remain unencrypted, enabling attackers who gain physical access to substitute parts of the system with a maliciously modified version, which eventually leads to bypassing user authentication (\autoref{sec:key-storage}) \cite{altuwaijri2020android}. When the wallet owner next accesses their device, the tampered system could capture and leak their credentials to the attacker. Following the owner's next wallet use, the manipulated system can acquire and transfer credentials to the attacker.

\subsubsection{Identity Spoofing}
\label{sec:iden-spoof}

These involve an adversary's impersonating the user's identity to bypass the user verification mechanism and decrypt \teal{$sk$}. These include fake biometric attacks \cite{galbally2013image} which provide synthetic or reconstructed biometric data, and SIM swap attacks \cite{Kim2022ACountermeasures} which aim to bypass SMS-based 2FA and other identify spoofing attacks.

% \subsubsection{Communication Manipulation}
% \label{sec:fake-biometrics}

% This involves the adversary's attempts to bypass the authentication mechanisms by exploiting weaknesses in communication. This includes replay attacks, where the adversary captures a valid authentication message and resends it to the system to gain unauthorised access. 

% Resilience Against Replay Attacks. In our context au- thentication is tied to a specific bitstring τ, e.g., we want to make sure that an unusual transaction τ is initiated by the legitimate user. It is therefore important to ensure that previous successful authentications for a string τ cannot be mauled into successful authentications for a different string τ′, without the knowledge of the secret.


% Encryption of sensitive data. Once the session key is established slightly modified versions of the four Ledger protocols (Alive, Login, Setup, and Pay- ment) can be executed. The four new protocols are derived from the original Ledger protocols as follows. First a session identifier is established for each execution of each of these protocols. This will be generated dongle side, and transmitted to the API in plaintext. The session identifier does not need to be confidential, but will need to be fresh and generated by the dongle to avoid replay attacks. Then dongle and API execute the original protocol but encrypting under the current session key the sensitive data identified previously (Table 5). The computed ciphertexts will all include the established session identifier. A Message Authentication Code (MAC) is further computed and concatenated to the chiphertext. The other party will then be able to decrypt and verify the encrypted parts.


% exploiting the lack of time-sensitive or unique identifiers that prevent the reuse of such data.

% In the context of wallets, communication manipulation can target the exchange of authentication credentials or transaction data between the wallet and the blockchain network or a connected server. Attackers may intercept and replay valid authentication tokens or transaction requests, tricking the wallet into granting unauthorized access or executing unintended transactions. By leveraging flaws in session handling, non-unique tokens, or the absence of adequate cryptographic protections, attackers can effectively impersonate the legitimate user or gain control over their assets. This category includes attacks like replay attacks, where the adversary captures a valid authentication or transaction message and resends it to the system to gain unauthorized access, exploiting the lack of time-sensitive or unique identifiers that prevent the reuse of such data.

% \subsubsection{Physical Access}

% \subsubsection{Shoulder Surfing}

% \label{sec:shoulder-surfing}
% This is an attack that involves secretly monitoring users' input wallet credentials such as \teal{$recipient\_addr$}, \teal{$sk$} or \teal{$pwd$} to steal these credentials and gain unauthorised access to their crypto-wallets \cite{yasin2019contemplating}.

% \subsubsection{Fault Injection}
% \label{sec:fault-inj}

% These attacks manipulate the wallet's physical components and induce hardware errors to exploit vulnerabilities and access sensitive data \cite{hajdu2020using}. By manipulating the hardware's physical state, adversaries can induce several errors within computational processes to force it into an erroneous state and bypass the security mechanisms (\autoref{sec:wallet_mechanism}).

% This attack induces errors in a system to expose and exploit vulnerabilities, using software, hardware, or environmental methods. It aims to compromise a system's security or functionality, enabling unauthorized access or causing system failures. 

% In this attack, an adversary with physical access exploits the data remanence properties of \acs{ram} i.e. \acf{dram} and \acf{sram} in some wallet devices to retrieve \teal{$enc\_secret\_key$}, \teal{$pwd$}, or other sensitive data from memory after a cold restart \cite{shaikh2022survey}. 

\subsection{Storage \& Memory Attacks}
\label{sec:physical-attacks}

\subsubsection{Physical Tampering}
\label{sec:tam-per}

These primarily involve physically altering a wallet’s hardware to bypass security protections. In an evil maid attack, the attacker physically modifies the unencrypted storage of an unattended device to capture credentials or manipulate the system \cite{altuwaijri2020android}. In contrast, microscopy attacks use advanced techniques, such as electron microscopy, to examine the microelectronic components of a wallet and extract critical data or identify vulnerabilities, often without altering the hardware itself \cite{courbon2016reverse}.

\input{Exhibits/Attack-Incidents}

\begin{landscape}
\input{Exhibits/Attack-Vectors-2}
% % Figure environment removed
% \input{Exhibits/Types-Wallets.tex}
\end{landscape}

\subsubsection{Fault Injection}
\label{sec:fau-inj}

These attacks manipulate the wallet's components by forcing an erroneous system state to bypass the security mechanisms \cite{Akter2023AChallenges}.

 For instance, fault injection attacks on hardware wallets often exploit vulnerabilities in volatile memory (such as \acs{sram}) by manipulating environmental factors. Data remanence vulnerabilities in the Trezor wallet have been exploited to demonstrate these attacks \cite{trezor_memory, trezor_medium}. Fault injection attacks on smart contracts have also been shown in the literature \cite{hajdu2020using}.




\subsubsection{Other Non-Invasive Techniques}
\label{sec:non-inv-man}

Other non-invasive storage/memory attacks exist which are not based on fault injection methods. In a Cold Boot Attack, the attacker executes a cold restart on the wallet device to exploit the data remanence properties of volatile memory, such as DRAM and SRAM to retrieve sensitive data \cite{Shaikh2022SurveyExchanges}. Similarly, \acs{puf} attacks exploit the unique characteristics of hardware defence implementations known as \acf{puf} (see \autoref{sec:def_dis_def_vuln}), which have challenge-response functionality that exhibits physical unclonability \cite{Garcia-Bosque2020IntroductionApplications, wang2024efficient}. 


% \paragraph{Cold Boot Attack}
% \label{sec:cold-boot}

% This involves the adversary performing a cold restart on the wallet device to exploit the data remanence properties of \acs{ram} i.e. \acf{dram} and \acf{sram} and retrieve sensitive data \cite{shaikh2022survey}. Data remanence properties in Trezor's \acs{sram} chips have resulted in attack vulnerabilities \cite{trezor_medium, trezor_memory}. 

% \paragraph{\acf{puf} Attacks}
% \label{sec:puf}



% Attackers aim to uncover the physical structures and data storage mechanisms to reveal the \teal{$sk$}, algorithmic secrets, or other sensitive data integral to securing the wallet’s mechanism (see \autoref{sec:formalisation}). 


% These attacks involve exploiting unintended information leakage, such as power consumption measurements, to extract sensitive information like private keys \cite{san2019practical}. These attacks can be conducted using techniques like Single Trace Power Analysis and High-Correlation Analysis on cryptographic operations \cite{park2023stealing}. The attacker leverages the leaked information to compromise the security of the hardware wallet (\autoref{sec:hardware-wallets}). Side channel attacks can be carried out with minimal setup and rely on analyzing power traces or other unintended leakages \cite{gentilal2017trustzone}.


% Side-channel attacks exploit the physical emanations from a wallet's hardware during cryptographic operations, circumventing the mathematical security of algorithms detailed in \autoref{sec:formalisation}. Park et al. (2023) illustrate this through a sophisticated method that extracts private keys by analyzing a single trace of elliptic curve scalar multiplication, demonstrating the subtlety and efficiency of these attacks without needing device profiling. The vast array of leakage sources, including but not limited to power consumption patterns, timing discrepancies, and additional observable data, extend the attack surface significantly, as underscored by Lou et al. (2021) and Ali et al. (2023). These sources offer attackers multiple vectors for extracting sensitive data such as private keys (\teal{$\rho_r$}), highlighting the extensive and varied nature of side-channel threats.


% These attacks exploit systemic vulnerabilities, focusing on the 'side' or peripheral aspects of security mechanisms rather than confronting the cryptographic algorithms directly.


\subsection{Cryptanalysis Attacks}
\label{sec:cryptanalysis-analysis}

\subsubsection{Side-channel Analysis}
\label{sec:side-channel}

Non-invasive key extraction attacks on cryptographic functions including timing and power \acs{sca} are executed by exploiting side channels. These exploit leakages in behaviours exhibited by cryptographic functions (see \autoref{sec:wallet_mechanism}) through side-channels to measure and extract values such as time and power  \cite{Shaikh2022SurveyExchanges, Park2023}. Timing-based \acs{sca} measures the cryptographic function execution time. Successful implementation of a timing-based side-channel attack has been demonstrated on a Trezor One hardware wallet, \cite{kocher1996timing}. Power-based \acs{sca} analyses the cryptographic function's power trace, including the hash function. \acs{sca} on the hash function has been utilised to extract the \teal{$rdm\_seed$} \cite{Park2024CloningFunction}.

\subsubsection{Direct Exploitation}
\label{sec:impl-exp}

These attacks directly target implementation errors within the cryptographic surface area. Weak signature (\teal{$\sigma$}) attacks, for example, target weaknesses in the signing algorithm due to improper implementation, weak or outdated cryptographic algorithms or errors in encryption logic. \cite{Rokhjavan2023SecuringWallets}.  In addition, an adversary can exploit vulnerabilities in the \hyperref[algo:transaction-signing]{Algorithm 3} by reusing a nonce during transactions authorisation \cite{brengel2018identifying}. Such reuse can compromise the security of wallets by resulting in \teal{$sk$} leakage \cite{Ko2020PrivateSignatures}.

\subsection{Discussion}
\label{sec:attacks_discussion}

\subsubsection{Insight 1: Difference in Academia and Notable Industry Incidents}

Identifying attack vectors within the industry remains challenging, as sources often lack specificity. Notable attack vectors are significantly less clear (46\% unknown) and show a lower spread when compared to attacks described in the literature. This might be attributed to a lack of detailed post-mortem analysis in several incidents and a tendency for an adversary to prioritise cost-effective methods. Academia, on the other hand, shows a high percentage (93\%) and spread on various attack methods.

\subsubsection{Insight 2: Comparison of Custodial and Non-Custodial Attacks}
Custodial wallets and non-custodial accounts for 70\% and 30\% of attacks respectively.  Additionally, unknown methods are significantly higher in custodial wallets (50\%) than in non-custodial wallets (36\%). Incidents show a high degree of similarity between custodial and non-custodial attacks. For instance, in comparison to other attacks phishing attacks account for a relatively high percentage of both custodial (10\%) and non-custodial (36\%) wallets, especially factoring in the number of unknown attacks. 

\subsubsection{Insight 3: High Malware \& Phishing Attack Occurrence}

Application attacks account for a significant percentage of incident occurrences (43\%) with 34\% in custodial wallets and 48\% in non-custodial wallets. Our data also indicates that malware and phishing attacks are the most common attack vectors, accounting for 8\% and 18\% of incidents respectively. We also find phishing-malware attacks constitute 48\% of total non-custodial wallet attacks.



% \subsubsection{Insight 1: Difference in Custodial and Non-Custodial Attack Methods}

% \subsubsection{Difference in Attack Methods for Custodial and Non-Custodial Wallets}

% The contrasting occurrence of attack methods in custodial and non-custodial wallets underscores the varying security challenges faced by each type. The data indicates a crucial need for targeted security enhancements to suit custodial and non-custodial wallet architectures, in addition to employing security measures applicable to both.

% \subsubsection{Attack Insight 3: Difference in Custodial and Non-Custodial Attack Methods}

% \subsubsection{Attack Insight 2: Low Percentage of Authentication Attacks in Non-Custodial Wallets}

% Authentication-based attacks account for a relatively small proportion of the total incidents and funds lost in non-custodial wallets, as illustrated in \autoref{fig:custody-pie}. This likely stems from the inherent structure of non-custodial wallets, which grant users complete control over their private keys and seed phrases. Additionally, attackers may prefer targeting other vulnerabilities within non-custodial systems given the potential user negligence, shifting their focus away from direct authentication attacks.

% \subsubsection{Insight 3: High Percentage of Application Attacks in Non-Custodial Wallets}

% Application attacks constitute a significant portion of the security breaches observed in non-custodial wallets, as documented in \autoref{fig:custody-pie}. This is primarily attributable to the open design of the software environments that non-custodial wallets operate within. Many non-custodial wallets are built on platforms that permit third-party integrations and extensions, which, while enhancing functionality, also increase the attack surface. 


% was commented out in old version 
% These applications, often involving smart contracts or decentralised applications (dApps), are exposed to a range of vulnerabilities from coding errors to flawed logic, making them prime targets for attackers. Additionally, the autonomous nature of non-custodial wallets means that users must rely on their judgement or third-party tools to verify the security of the applications they interact with. 


% \subsubsection{Insight 4: Prevalence of Malware Phishing Attacks}

% What percentage of malware attacks are malware phishing?
% What wallets are malware phishing attacks more common on?

% Most wallet attacks were identified only after unauthorised fund transfers had been made using compromised private keys. This indicates significant deficiencies in the existing detection mechanisms within their security operations. Therefore, this demonstrates the need for more effective intrusion detection mechanisms within wallets.

% \subsubsection{Challenge 1: Inaccessibility of Root Causes in Industry} 

% A challenge encountered in our research was the lack of quality data on wallet attacks, with several root causes unknown. With more quality data, it would have been possible to map components in wallets with vulnerabilities, attack methods, vectors and root causes. 

% This attack targets vulnerabilities in the \hyperref[algo:key-generation]{key generation algorithm} or \hyperref[algo:transaction-signing]{signing algorithm} due to improper implementation, 

% such as insufficient validation mechanisms or encryption key size checks to compromise the signature integrity \cite{rokhjavan2023securing}. 

% The vulnerabilities may specifically be a product of weak or outdated cryptographic algorithms (detailed in \autoref{Encryption-Table-1}) 


% and errors in encryption logic.

% \subsection{Industry Incidents Analysis}
% \label{sec:attacks_analysis}


% This section analyses real-world wallet attacks, distinguishing between wallet types, attack targets and attack categories. 

% % % methodology

% The goal of our empirical analysis is to identify patterns which have emerged in previous real-world wallet attacks.

% The data we gather is employed for analysis purposes in \autoref{sec:incident-analysis}.
% Our dataset omits: \begin{enumerate*}
%   \item Incidents on \ac{defi} protocol mechanisms and \ac{defi} or \ac{dao} treasuries.
%   \item Research papers focused on wallets and cryptography with no attacks described.
% \end{enumerate*}

% \paragraph{Academic Papers}
% \label{sec:papers}

% We identify 63 academic papers, and 18 detailed security incident reports, focusing on several different wallet attacks. Our approach involves crawling  Google Scholar and conducting backwards and forward reference searches to identify further pertinent studies. We retrieve attacks on the various types of wallets in our taxonomy including software, hardware, brain, paper, and smart contract wallets (see \autoref{attack-vectors}). 

% \paragraph{Industry Incidents}
% \label{sec:incidents}
% Our data contains 69 real-world attacks on cryptocurrency wallets, which occurred between March 2012 and November 2023. We gather incidents from several sources including DeFiLama, Slowmist, and Rekt News. 



% % % analysis -- incident analysis

% \autoref{fig:attack-frequency} presents the correlation between the frequency of real-world attack incidents on cryptocurrency wallets and the total funds lost annually. Notably, the accumulated losses from these thefts exceed USD 4.5 billion. 2018 was particularly severe, with reported losses surpassing USD 1 billion. Frequently, these incidents involved the compromise of private keys; however, the precise methods utilised often remain undisclosed.



% % % analysis -- taxonomy analysis

% \autoref{fig:custody-method} shows the amount lost for custodial and non-custodial wallets grouped by attack methods. Non-custodial wallets account for one-third of wallets attacked, however, these wallet hacks are only one-tenth of total hacks at 439 million USD. On the other hand, custodial wallets account for 4.1 billion USD, which is 90\% of the total amount lost. This shows the average attack on custodial wallets (\$80 million USD) exceeds that of their non-custodial (\$25 million USD) counterparts. Additionally, nearly all wallets in our dataset are hot. With the exception of the FTX cold wallet incident which claimed a staggering \$400 million USD of user fund managed by the exchange.



% % % analysis -- previously commented out  --  taxonomy analysis

% Consistent with \autoref{sec:attack-framework}, we examine the frequency and impact of different attack methods as depicted in \autoref{fig:attack-method-frequency}. Application-based attacks are the most prevalent, constituting 42\% of all recorded attacks and accounting for 35\% of the total funds lost. Authentication attacks, while less frequent, are almost equally costly, causing 33\% of the financial losses from only 23\% of the incidents. Network attacks are markedly rarer, representing less than 3\% of both incidents and associated financial losses. In about 30\% of cases, the specific methods compromising private keys remain unidentified by wallet operators.

% In further detail, our analysis differentiates the impact of attack methods on custodial and non-custodial wallets as illustrated in \autoref{fig:custody-pie}. For custodial wallets, authentication attacks incur 35.61\% of the total funds lost, occurring in 25.49\% of the incidents. This suggests a high financial impact relative to their frequency. We also observe the prevalence of application attacks which are 33.09\% of the funds lost and 37.25\% of incidents, making them the most common attack vector in custodial settings. 

% Conversely, We find that non-custodial wallets exhibit a different pattern. Application attacks dominate, accounting for 62.99\% of the funds lost and 55.56\% of incidents, underscoring their critical role in non-custodial wallet security. Authentication attacks, while less damaging financially at 10.40\% of the funds lost, still represent 16.67\% of incidents, suggesting their relatively frequent exploitation. Network attacks remain minimal, both in frequency and impact, with just 0.03\% of funds lost and 5.56\% of incidents reported. Unknown attack methods also play a significant role, with 26.58\% of the funds lost and 22.22\% of incidents, reflecting the ongoing challenges in identifying and mitigating these attacks. Unknown methods comprise 22\% and 35\% of the non-custodial and custodial incidents respectively.




% % % analysis -- previously commented out  --  analysis on attack vectors

% \autoref{fig:wallet_attacks_bar} illustrates the frequency of wallet attack vectors. 

% Identifying attack vectors proves even more difficult as these are less clarified in sources than methods, as explained in \autoref{sec:challenges}. Despite more than 50\% of attack vectors being unknown, our data reveals some attack vectors. Notably, malware and phishing attacks are the most prevalent, with 20\% and 23\% of incidents respectively.

% Other significant vectors include storage exploits and SIM swap attacks, both notable for their impact on security, constituting 26.47\% and 25.89\% of the attack vectors. While storage exploits represent a considerable percentage of funds lost, they only account for 2.94\% of incidents, suggesting high effectiveness where used. Similarly, SIM swap attacks though high in funds claimed as a method only occur once. 

% Insider jobs and third-party breaches also contribute significantly to the attack landscape, indicating potential threats beyond the internal wallet mechanisms. Less common but still notable are server attacks, \acs{dns} hijacks, brute force, and API attacks, underscoring the diverse methods attackers employ to exploit wallet vulnerabilities.



% Website, storage and server attacks are categorised under wallet infrastructure attacks.


% Comparison of Total Funds Lost by Attack 

% \subsection{Industry Incidents Analysis}
% % \label{sec:attacks_analysis}




% was commented out in old version 
% This challenge compelled us to derive attack paths aligned with various attacker objectives as shown in \autoref{sec:attack-tree}. Our approach sheds light on potential vulnerabilities and attack vectors extend beyond this analysis.

% \subsubsection{Challenge 2: Clarity of Attack Vectors}
% \label{sec:method-inclarity}

% Many recorded incidents from exchanges or non-custodial wallet providers show a high degree of uncertainty in the reporting of attack vectors. 30\% of all incidents attack methods were unknown. This ambiguity often gives rise to various hypotheses from sources regarding the exact nature of the attacks. For instance, the atomic wallet hack of USD 100 million was said to be a result of one of four probable causes which include a \acf{mitm} attack, a malware code injection or an infrastructure breach \cite{cointele_atomic}. 

% was commented out in old version 
% This uncertainty from sources complicates the analysis, making it challenging to gain insights into attack vectors.

