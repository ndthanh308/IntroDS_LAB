\subsection{SED fitting}\label{s31}
SED fitting is a technique of fitting observed data (photometry and/or spectroscopy) with model spectra (for a review, see \cite{Walcher2011}).
Through SED fitting, we can estimate basic parameters of galaxies such as stellar mass ($M^*$), dust attenuation ($\tau$), and star formation history (SFH).

\subsubsection{{\sc Prospector}}\label{s311}
{\sc Prospector} \citep{Leja2017, Johnson2021} is a Baysian-based SED fitting code with which it is possible to fit with a flexible non-parametric SFH (e.g., \cite{CidFernandes2005,Ocvirk2006,Tojeiro2007,Dye2008}) by dividing look-back time into several age bins and assuming a constant SFR in each bin.

With high-quality input data, non-parametric SFH fitting can reproduce the true SFH more accurately than parametric SFH methods because of fewer assumptions on the SFH (e.g., \cite{Leja2019}).
\citet{Lower2020} have suggested that a non-parametric SFH can also estimate $M^*$ more accurately.
However, we should note that non-parametric SFH estimation still has prior dependence as \citet{Leja2019} have demonstrated.
{\sc Prospector} can fit spectroscopic and photometric data together to constrain parameters more tightly than fitting only photometric data \citep{Johnson2021}.



In this study, we input a flattened 1D spectrum and photometric data of each galaxy to {\sc Prospector} and estimate a non-parametric SFH to select RGs.
Below we briefly describe our parameter setting (for a detailed description of {\sc Prospector}, see \cite{Leja2017, Johnson2021}).

\subsubsection{{\sc Prospector} settings}\label{s312}
{\bf \underline{Stellar population:}}
{\sc Prospector} uses the Flexible Stellar Population Synthesis (FSPS, \cite{Conroy2009, Conroy2010}) to generate model SEDs of galaxies.
We assume a \citet{Chabrier2003} initial mass function.
We set stellar metallicity, total stellar mass, and the velocity dispersion of stellar components as free parameters and assume that their priors are uniform in $\log\left(Z^*/Z_\odot\right)$ between $-2$ and 0.19, in $\log\left(M^*/M_\odot\right)$ between $10^8$ and $10^{13}$, and uniform between $10~{\rm km/s}$ and $300~{\rm km/s}$.

{\bf \underline{Nebular emission:}}
We use nebular emission templates in {\sc Prospector} that are based on {\sc CLOUDY} \citep{Ferland1998, Ferland2013} and described in \citet{Byler2017}.
We assume that gas-phase metallicity is equal to stellar metallicity.
We set the ionization parameter $\log U$ as a free parameter with a uniform prior between $-4$ and $-1$.

{\bf \underline{Dust emission:}}
We also use dust emission templates with fixed parameters.
We do not use AGN dust emission templates because we have excluded AGN-hosting galaxies in the sample selection (section~\ref{s22}).

{\bf \underline{Dust attenuation:}}
We assume the two-component dust attenuation model by \citet{Charlot2000}.
This model has two types of attenuation. 
One is the attenuation only for birth clouds, $\tau_{\rm dust,1}\left(\lambda\right)$, calculated as:
\begin{equation}
    \tau_{\rm dust,1}\left(\lambda\right) = \hat{\tau}_{\rm dust,1} \left(\frac{\lambda}{5500~{\rm \AA}}\right)^{-1}.
\end{equation}
The other is the attenuation for the entire galaxy, $\tau_{\rm dust,2}\left(\lambda\right)$.
We use the equation of \citet{Noll2009}: 
\begin{equation}
    \tau_{\rm dust,2}\left(\lambda\right) = \hat{\tau}_{\rm dust,2} \left(k\left(\lambda\right) + D\left(\lambda\right)\right) \left(\frac{\lambda}{5500~{\rm \AA}}\right)^{n},
\end{equation}
where $k\left(\lambda\right)$ is \citet{Calzetti2000} attenuation curve and $D\left(\lambda\right)$ is the Lorentzian-like Drude profile  parameterizing the UV bump.
We use the $D\left(\lambda\right)$ definition by \citet{Kriek2013}.
This attenuation model has three parameters; $\hat{\tau}_{\rm dust,2}$, the ratio of $\hat{\tau}_{\rm dust,1}$ to $\hat{\tau}_{\rm dust,2}$, and the index $n$.
We set all three parameters as free parameters and assume their priors to be uniform between $0$ and $4$ for $\hat{\tau}_{\rm dust,2}$, uniform between $1.0$ and $0.4$ for $n$, and a normal distribution with $\mu=1.0$ and $\sigma=0.3$ truncated at $0.0$ and $2.0$ for $\hat{\tau}_{\rm dust,1}/\hat{\tau}_{\rm dust,2}$.

{\bf \underline{SFH:}}
We fix the number of age bins for non-parametric SFH fitting to eight and calculate the SFR for each bin.
\citet{Leja2019} have examined the dependence of the number of age bins on the reconstructed results and found that there is no significant dependence if the number of age bins is greater than 4.
We also fix the recent five age bins to [$0$ yr, $10^{7.5}$ yr], [$10^{7.5}$ yr, $10^{8}$ yr], [$10^{8}$ yr, $10^{8.33}$ yr], [$10^{8.33}$ yr, $10^{8.67}$ yr], and [$10^{8.67}$ yr, $10^{9}$ yr] in lookback time $t_l$, and set the remaining three age bins by splitting equally $\log t_l$ in the logarithmic interval from $10^9$ yr to $0.95 t_H$.

The typical priors of non-parametric SFHs used in {\sc Prospector} are the continuity prior \citep{Leja2019, Johnson2021} and the Dirichlet prior \citep{Leja2017, Leja2019}.
The continuity prior is for the ratio of SFRs in adjacent age bins, and the Student's-t distribution is widely used.
For the Dirichlet prior, we assume a Dirichlet distribution \citep{Leja2017, Leja2018} for the fractional sSFR in each age bin.
\citet{Leja2019} have examined the prior dependence of SFHs by applying {\sc Prospector} on mock data, finding that both priors can reconstruct the shape of the assumed SFH in mock data. 
However, they have also found that the continuity and Dirichlet priors tend to reconstruct the SFH ``dispersively'' and ``concentratedly'', respectively.
In this study, we use both priors and compare the results.
We have eight age bins, and total stellar mass is also a free parameter.
Thus, the number of free parameters for the SFH is seven for both priors: seven SFR ratios between the adjacent bins for the continuity prior and seven Dirichlet parameters.

{\bf \underline{Spectrophotometric calibration:}}
MaNGA data are already flux-calibrated by the DRP.
However, for any galaxy, the area of IFU spectroscopy is different from photometric apertures.
We apply the spectrophotometric calibration model in {\sc Prospector} to do aperture correction.
This model fits a polynomial calibration function to scale the input observed spectrum to model spectra so that its pseudo photometry is consistent with the observed multiband photometry (\cite{Johnson2021} for detail).
We confirm that this calibration model works well with mock data fitting results.

{\bf \underline{Emission-line marginalization:}}
Because {\sc Prospector} assumes all nebular emission lines to originate from star formation, our SED fitting will fail to reconstruct the spectrum around an observed emission line if the line is contaminated by a LIER, an AGN, or shock heating.
To avoid this problem, we marginalize the amplitude of each emission line in each fitting step. 
We fit for the velocity dispersion of gas, $\sigma_{\rm gas}$, assuming a uniform prior between $10~{\rm km/s}$ and $300~{\rm km/s}$.
We also confirm that introducing line marginalization can improve the model spectrum around a complex single-line feature consisting of narrow emission and broad absorption lines.

{\bf \underline{Likelihood calculation and the outlier model:}}
Finally, we calculate the likelihood $\mathcal{L}$ as the product of the likelihood for the photometric data $\mathcal{L}_{\rm phot}$ and the spectrum $\mathcal{L}_{\rm spec}$, as
\begin{equation}
    \ln\mathcal{L} = \ln\mathcal{L}_{\rm phot} + \left(1-f_{\rm out}\right)\ln\mathcal{L}_{\rm spec} + f_{\rm out}\ln\mathcal{L}_{\rm out},\label{eq_ltot}
\end{equation}
where $\mathcal{L}_{\rm out}$ is the penalty from the outlier model described below (equation \ref{eq_lout}).
Here, $\mathcal{L}$ is calculated on the assumption of Gaussian uncertainties, as
\begin{equation}
    \ln\mathcal{L}\left(f,m,\sigma\right) = -\sum_i^{N} \frac{\left(f_i-m_i\right)^2}{2\sigma_i^2},\label{eq_l}
\end{equation}
where $f$, $\sigma$, and $m$ are the observed flux density, its uncertainty, and the model flux density, respectively.

We apply the outlier model \citep{Hogg2010, Johnson2021} to ignore outlier data not fitted well by the model spectrum (e.g., cosmic rays, airglow lines, and complex line features).
On the assumption that a certain percentage $f_{\rm out}$ of data points are outliers, this model adds a penalty term in the likelihood calculation.
The penalty term is calculated by multiplying the uncertainty by $s_{\rm out}$ for all data points, as
\begin{equation}
    \ln\mathcal{L}_{\rm out}\left(f,m,\sigma\right) = -\sum_i^{N} \frac{\left(f_i-m_i\right)^2}{2\left(s_{\rm out}\sigma_i\right)^2}.\label{eq_lout}
\end{equation}
With this penalty term, the model becomes less sensitive to the spectral data.
In this study, we applied $s_{\rm out}=50$.
\par

Table~\ref{tab;fp} summarizes the free parameters and their priors.
This parameter setting is determined by referring to the run time, the distribution of each parameter obtained from several test runs, the range of each parameter in the Pipe3D and the MaNGA targeting catalog, and settings in some previous studies with {\sc Prospector} \citep{Tacchella2022}.

As an example, figure~\ref{fig;chi_square} shows the observed and modeled (best-fit) spectra and photometry of a galaxy at $z = 0.044$ (plateifu:10216-6102).
We calculate $\chi^2$ values for spectroscopic data ($\chi^2_{\rm spec}$) and photometric data ($\chi^2_{\rm photo}$) separately.
We find that the median of $\chi^2/N_{\rm data}$ ($N_{\rm data}$ is the number of data points) for the whole sample is $\chi^2_{\rm spec}/N_{\rm data,spec} = 1.15^{+1.82}_{-0.62}$ and $\chi^2_{\rm photo}/N_{\rm data,photo} = 2.44^{+3.85}_{-1.51}$.
While the median $\chi^2_{\rm spec}/N_{\rm data,spec}$ value is reasonable ($\simeq 1$), we find that objects whose spectra around the short-wavelength end are of poor quality have large $\chi^2_{\rm spec}/N_{\rm data,spec}$.
Indeed, the $\chi^2_{\rm spec}/N_{\rm data,spec}$ of those objects decreases close to unity if the data around the short-wavelength end are excluded.
On the other hand, the large median $\chi^2_{\rm photo}/N_{\rm data,photo}$ value is primarily because the WISE data (especially W4) of most objects are not reproduced well.
This problem may be resolved by adding new free parameters to the dust model.

% Figure environment removed

The joint posterior distribution plot (corner plot) of six key parameters for the same example galaxy as figure~\ref{fig;chi_square} is shown in figure~\ref{fig;corner}.
This galaxy is one of the rejuvenation galaxies selected with the method described in section~\ref{s32}.
We find that basic parameters such as $M^*$, $Z^*$ and $\hat{\tau}_{\rm dust,2}$ are strongly constrained.
The estimated SFH distribution shows that this galaxy experienced rejuvenation at $t_l = 10^8~{\rm yr}$ with ${\rm SFR}_{\rm 32~Myr} \sim 10 M_\odot/{\rm yr^{-1}}$, and the resumed star formation ended in the most recent time bin.
As the strong negative correlation between $\hat{\tau}_{\rm dust,2}$ and $\log\left(Z^*/Z_\odot\right)$ suggests, dust-metallicity degeneracy can also be seen in our results.
However, the $1\sigma$ range of $\hat{\tau}_{\rm dust,2}$ and $\log\left(Z^*/Z_\odot\right)$ is much smaller than the median value of each parameter, suggesting that our method can constrain these parameters reasonably well.
Besides, $\hat{\tau}_{\rm dust,2}$ and $\log\left(Z^*/Z_\odot\right)$ are not strongly correlated with the SFRs in the recent three bins that are very sensitive to the selection of RGs (see section~\ref{s32} for our selection method).
These results support our RG selection method.

% Figure environment removed

We also check whether {\sc Prospector} can select true RGs under this setting by running it on mock data (section~\ref{s4}) and comparing 
the results for the real data with
existing catalogs (appendix).

\begin{table*}[]
\caption{Free parameters and their priors for {\sc Prospector} fitting}\label{tab;fp}
\begin{tabular}{lp{6cm}p{6cm}}
\hline\hline
parameter                 & Description & prior \\ \hline
$\log\left(M^*/M_\odot\right)$ & total stellar mass & Uniform: min=8, max=13 \\
$\log\left(Z^*/Z_\odot\right)$ & stellar metallicity & Uniform: min=-2, max=0.19 \\
$\log U$ & ionization parameter & Uniform: min=-4, max=-1 \\
$n$ & power-law index of the dust attenuation curve of the diﬀuse dust & Uniform: min=-1, max=0.4 \\
$\hat{\tau}_{\rm dust,2}$ & optical depth of the diffuse dust attenuation & Uniform: min=0, max=4 \\
$\hat{\tau}_{\rm dust,1}$ & optical depth of the birth-cloud dust attenuation & Clipped normal in $\hat{\tau}_{\rm dust,1}/\hat{\tau}_{\rm dust,2}$: min=0, max=2, $\mu=1$, $\sigma=0.3$\\
$\sigma_*$ & velocity dispersion of the stellar component & Uniform: min=$10~{\rm km/s}$, max=$300~{\rm km/s}$ \\
$\sigma_{\rm gas}$ & velocity dispersion of gas & Uniform: min=$10~{\rm km/s}$, max=$300~{\rm km/s}$ \\
$f_{\rm out}$ & outlier fraction of spectral data points & Uniform: min=$10^{-5}$, max=$0.5$ \\
SFR ratios & $\Delta\log {\rm SFR}$ between adjacent age bins (only when using the continuity prior) & Student’s-t distribution with $\sigma=0.3$ and $\nu=2$ \\
Dirichlet parameters & weight of SFRs in each age bin (only when using the Dirichlet prior) & Dirichlet distribution with $\alpha_D=1$\\
\hline
\end{tabular}
\end{table*}

\subsection{Selection method}\label{s32}
As introduced in section~\ref{s1}, RGs are galaxies that have restarted star formation after being quenched.
We select RGs using reconstructed SFHs.

For each galaxy, first, we calculate $\mathcal{D}\left(z\right)$, the fraction of the mass that will be formed by the given redshift $z$ if the star formation rate is constant with ${\rm SFR}\left(z\right)$, as
\begin{align}
    \mathcal{D}\left(z\right) &= {\rm sSFR}\left(z\right) \times t_H \left(z\right)\\
    &= \frac{{\rm SFR}\left(z\right)}{M^*\left(z\right)} \times t_H \left(z\right), \nonumber
\end{align}
where $t_H(z)$ is the age of the universe at $z$.
Then, we classify the galaxy in each age bin into an SFG, GV, or QG using $\mathcal{D}\left(z\right)$ to track the evolution of type with cosmic time.
We determine the threshold $\mathcal{D}$ for classification by fitting the $\log\mathcal{D}$ distribution with a three-component mixture Gaussian profile.
Figure~\ref{fig;threshold} shows the fitting result of the $\log \mathcal{D}$ distribution in the latest age-bin, i.e., the bin from $t=10^{7.5}\ {\rm yr}$ to the observed time for the continuum prior. 
We have also confirmed that the Dirichlet prior gives almost the same results.
We fix the SFG/GV and GV/QG boundaries at $\log\mathcal{D}=-1.2$ and $-1.8$, respectively, based on the $1\sigma$ values of the peaks corresponding to SFGs and QGs.

Because the location of the SFMS depends on $z$ (e.g., \cite{Noeske2007, Elbaz2007, Whitaker2012, Speagle2014, Renzini2015, Tomczak2016, Pearson2018, Popesso2023}), the threshold $\mathcal{D}$ value can vary with redshift.
For example, \citet{Tacchella2022} have used $1/3$ and $1/20$ for the $\mathcal{D}$ thresholds ($-0.48$ and $-1.3$ for $\log\mathcal{D}$ thresholds) with a $z\sim0.8$ sample.
However, because our RG selection only focuses on the most recent $10^8$ years much shorter than the timescale of the change of the SFMS location, we can ignore the redshift dependence of the $\mathcal{D}$ threshold value in this study.

% Figure environment removed

Finally, we define an RG as a galaxy that returned to a GV or SFG from a QG within the recent $1 \times 10^8~{\rm yr}$.
This means $t_{\rm rej}$, the lookback time when a rejuvenation started, is either $10^8~{\rm yr}$ or $10^{7.5}~{\rm yr}$ in this study.
In other words, we define an RG as follows,
\begin{itemize}
    \item $t_{\rm rej}=10^{7.5}~{\rm yr}$\\
    $\left[0, 10^{7.5}~{\rm yr}\right]$: GV or SFG\\
    $\left[10^{7.5}~{\rm yr}, 10^{8.0}~{\rm yr}\right]$: QG
    \item $t_{\rm rej}=10^{8.0}~{\rm yr}$\\
    $\left[0, 10^{7.5}~{\rm yr}\right]$: QG, GV or SFG\\
    $\left[10^{7.5}~{\rm yr}, 10^{8.0}~{\rm yr}\right]$: GV or SFG\\
    $\left[10^{8.0}~{\rm yr}, 10^{8.33}~{\rm yr}\right]$: QG
\end{itemize}
It is conceivable that galaxies restart star formation before $10^8~{\rm yr}$.
However, the age-bin setting in our {\sc Prospector} run is equally spaced in logarithmic space; thus, returning to a GV or SFG in an age-bin older than $10^8{\rm yr}$ is a different-timescale event from the above definition.
For this reason, we limit $t_{\rm rej}$ to $10^{7.5}$ and $10^{8.0}$ and focus on the rejuvenation in the recent $\sim100~{\rm Myr}$.

We apply the above selection method to chain data obtained from {\sc Prospector} runs and calculate $p_{\rm RG}$, the probability that the galaxy is an RG, as
\begin{equation}
    p_{\rm RG} = \frac{n_{\rm chain,RG}}{n_{\rm chain}},
\end{equation}
where $n_{\rm chain}$ is the length of all chains and $n_{\rm chain,RG}$ is the number of chains classified as an RG.
As mentioned above, our RG definition has two patterns in terms of $t_{\rm rej}$, and we calculate $p_{\rm RG}$ as the total RG probability; 
as the sum of the probability of each $t_{\rm rej}$ pattern to select galaxies more likely to have rejuvenated regardless of their $t_{\rm rej}$.
We define the $t_{\rm rej}$ of a given galaxy as the timing with a higher $p_{\rm RG}$.

Each galaxy has two $p_{\rm RG}$ values: one with the continuum prior, $p_{\rm RG,con}$, and the other with the Dirichlet prior, $p_{\rm RG,Dir}$.
We select galaxies with $p_{\rm RG,con}>0.8$ and $p_{\rm RG,Dir}>0.5$ as RGs.
We determine these criteria with the SED fitting results of our parent sample and the mock data as described in sections~\ref{s43}.

Figure~\ref{fig;sSFH} shows examples of the specific star-formation history (sSFH) for the selected RGs.
Note that our method depends on the classification into QG/GV/SFG and hence that a galaxy with a clearly increasing sSFR may have a relatively low $p_{\rm RG}$ because its sSFR before rejuvenation is just below the threshold between QGs and GVs (e.g., 8078-6104 in figure~\ref{fig;sSFH} column 5 row 3). 

% Figure environment removed




