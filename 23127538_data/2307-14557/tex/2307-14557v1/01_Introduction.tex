%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\section{Introduction}
\label{sec:introduction}

\eat{
Overview of lattice-based cryptographic algorithms (HE and others) and their importance.
\begin{itemize}
    \item  Polynomial modular multiplication and its role in these algorithms: 
    \SubItem{ Ring learning with error is the key of this type of algorithm and involves lots of polynomial operations.}
    \SubItem{Polynomial modular multiplication is the most time-consuming part in these algorithms. Example: HE time breakdown.}
   \item Discuss existing research on accelerating polynomial modular multiplication and the limitations of current solutions.
   \SubItem{Most of them are NTT-based solutions, including ASIC, FPGA, and Compute-in-Memory(CIM) solutions.}
   \SubItem{Especially, CIM-based solution gains lots of benefits due to their speed.}
   \SubItem{However, If NTT-based solutions are best implementations in CIM paradigm?  We evaluate the suitability of NTT-based solutions for CIM paradigm (especially XBAR-type)}
    \item This workâ€™s contribution:
    \SubItem {Design a PMM CIM accelerator (non-NTT type) and first evaluate the suitability of NTT-based solutions for CIM paradigm (especially XBAR-type and discuss the pros and cons of conventional conv1d and NTT-type PMM in CIM.}
    \SubItem {Propose a new xbar data mapping for high-bitwidth data and reduce almost a bunch of find-grained shift-add operations.}
    \SubItem {PE-level optimization to increase memory utilization and support the different scales of problems with a fixed number of xbar.}
\end{itemize}
}

Post-quantum cryptography (PQC) represents a critical area of research in the field of cryptography, driven by the impending threat posed by quantum computing to current cryptographic systems~\cite{PQR}. Many of these cryptosystems are currently being considered potential PQC candidates to address the challenges posed by quantum computing. Among these cryptosystems, lattice-based cryptography has attracted significant interest from the research community owing to its robust security guarantees and relatively low computational complexity~\cite{LWE,lattice_ency}. Lattice-based cryptographic algorithms rely on the mathematical concept of a lattice, which is an intricate structure formed by repeating patterns of points in a multi-dimensional space.

% Lattice-based cryptographic algorithms are a type of post-quantum cryptographic technique that offer high security and privacy for data communication and storage. These algorithms, including homomorphic encryption (HE) and others, rely on the mathematical concept of lattices, which are complex structures formed by repeating patterns of points in a multi-dimensional space. 

One of the fundamental building blocks of lattice-based cryptographic algorithms is polynomial operations, specifically, polynomial modular multiplication (PMM). PMM is a critical operation in ring learning with error (RLWE) theory, a key concept in lattice-based cryptographic algorithms. Moreover, PMM is the most time-consuming part of these algorithms. For example, recent studies show that PMM represents more than half of the computational workload for lattice-based homomorphic encryption (HE) on the cloud side~\cite{cheetah}, and more than 90\% on the edge side~\cite{CIM_HE_SAC}. Though algorithmic optimizations like Number-Theoretic Transform (NTT)~\cite{NTT} can decrease computation complexity, PMM latency is still high~\cite{cheetah,HE_F1,CIM_HE_SAC}. As such, accelerating PMM is essential to improve the efficiency and practicality of lattice-based cryptographic algorithms. 

Currently, there have been significant efforts to accelerate PMM, particularly through the use of NTT. NTT-based solutions, including those implemented on application-specific integrated circuits (ASICs)~\cite{asic_ntt,leia,sapphire}, field-programmable gate arrays (FPGAs)\cite{fpga_ntt}, and compute-in-memory (CIM) architectures\cite{rmntt,bpntt,CryptoPIM,MENTT}, have demonstrated promising results in accelerating PMM. CIM-based PMM accelerators have gained attention for their effectiveness in reducing data transfer overheads by moving computation inside the memory~\cite{CIM_HE_SAC,CryptoPIM}. Work in~\cite{CryptoPIM} builds a Resistive RAM (ReRAM) based NTT accelerator that supports bit-wise computation inside the memory. Alternatively, \cite{MENTT} presents an in-SRAM NTT accelerator with bit-serial arithmetic operations. Crossbar arrays (XBAs)~\cite{fundamental} is another popular CIM fabric that can support highly efficient vector-matrix multiplication (VMM) and is also actively being exploited for supporting high-throughput NTT-based PMM implementations~\cite{rmntt,iedm_ntt}. 

Existing research efforts to accelerate PMM using XBAs have primarily focused on using NTT-based approaches~\cite{rmntt, iedm_ntt}. Such solutions claim to achieve improvements of over 50$\times$ compared to other CIM NTT accelerators. However, supporting PMM on XBAs comes with its own set of unique challenges. These challenges differ notably from those associated with the application of XBAs for the well-studied case of convolutional neural networks (CNNs). On the one hand, the high bitwidth and the large polynomial degree required for cryptographic applications result in a huge number of shift-add operations, which incur high area and energy overhead. On the other hand, it remains an open question whether NTT-based solutions are the most suitable for XBA-based CIM architectures. Existing NTT-based PMM implementations on XBAs suffer from high area costs and limited scalability. These challenges restrict existing XBA-based solutions from achieving high performance for lattice-based cryptographic algorithms. Therefore, exploring alternative approaches to accelerate PMM to overcome these limitations is crucial. %This research will provide efficient and scalable solutions using CIM fabrics, meeting the growing demand in the field. 

% These challenges also limit the scalability of the implementation, making it difficult to achieve high performance for lattice-based cryptographic algorithms that must deal with high degrees of polynomials and other specific parameter requirements of certain applications.

%Such advancements are crucial in demonstrating the viability of XBAs for accelerating PMM operations. However, these methods still face inherent challenges tied to the high bit-width requirements and long polynomial degrees necessary for cryptographic applications.
% Existing XBA-based PMM accelerators mainly focus on accelerating the NTT 

%  Recent work explored using XBAs~\cite{RMNTT,iedm_ntt} for PMM in HE computation and suggested improvements of over 50$\times$ were possible compared to other NTT solutions. \notes{add more recent work, iedm, dac, highlight the throughput benefits}


This paper proposes a novel XBA-based PMM accelerator, \name. Our solution distinguishes itself from existing XBA-based CIM methods by focusing on the non-NTT-based PMM. Our specific contributions are as follows:

\begin{itemize}
    \item We present observations revealing that NTT-based PMM may not be the most suitable choice for XBA-CIM. Our extensive studies show that the convolution 1D (Conv1D) solution holds potential advantages regarding area, latency, and noise over NTT when implementing PMM on XBAs.
    
    \item We propose a new XBA bit mapping technique for high-bitwidth, large polynomial degree data. The technique significantly reduces the overhead by removing most fine-grained shift-add operations. 
     \item We optimize data mapping at the processing engine (PE) level to support different problem scales with a fixed number of XBAs while maximizing throughput.
\end{itemize}

Our proposed \name offers significant improvements in throughput and area consumption, making it a competitive solution for accelerating PMM in lattice-based cryptographic algorithms. Specifically, \name achieves 200$\times$ latency improvement compared with a CPU implementation. It also leads to 3.9$\times$ throughput per area improvements compared with the state-of-the-art (SOTA) CIM accelerators for PMM. 