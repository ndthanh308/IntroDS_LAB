
\begin{mini!}
	{u, y}{\frac{1}{2} \|g(u) - \Xi\|^2_{Q_b} + \frac{1}{2} \|y - \Xi\|^2_{Q_a} + \frac{1}{2} \sum_{k=1}^{N-1}\|u_{k+1} - u_{k} \|^2_{R}}{}{}
	\addConstraint {y}{=g(u)}{}
	\addConstraint {(y,u)}{\in \mathcal{Z}}{}
\end{mini!}

\begin{equation}
	\mathcal{Z} = \{z | A z \leq b \}
\end{equation}
where
$u$ is the input,
$y$ is the output,
$g(u)$ is the 
$u_k$
$Q_a$, $Q_b$, $R$

\begin{equation}
	\mathcal{L} = f(u) + \lambda\tp (y-g(u)) + \mu\tp(A z -b); \mu\geq0
\end{equation}

\begin{equation}
	\begin{split}
	\nabla_u\mathcal{L} &= \nabla_uf(u) - \lambda\tp \nabla_ug(u) + \mu\tp A\nabla_uz\\
						&= (g(u) - \Xi)\tp Q_b \nabla_ug(u) + \\
						&+(u_{k+1} - u_{k}) R_a \nabla_u (u_{k+1} - u_k) - \lambda\tp \nabla_u g(u) + \mu\tp A \nabla_u z \\
						&= [(g(u) - \Xi)\tp Q_b - \lambda\tp] \nabla_ug(u) +\\
						&+(u_{k+1} - u_{k}) R_a \alpha + \mu\tp A \beta
\end{split}
\end{equation}
where
\begin{equation}
	\begin{split}
		\nabla_u (u_{k+1} - u_k) = 
		\begin{bmatrix}
			-1 & 1 & 0& \dots& 0& 0 \\
			0 & -1& 1 & \dots& 0& 0 \\
			\vdots & &&\ddots & -1 & 1 \\
			0 &0 &0 &0 &0 &0
		\end{bmatrix} = \alpha,
	\end{split}
\end{equation}

\begin{equation}
	\nabla_uz = \begin{bmatrix} 0 & 0 \\ 0 & I \end{bmatrix} = \beta.
\end{equation}

\begin{equation}
	\begin{split}
		\nabla_y\mathcal{L} &= (y-\Xi) \tp Q_a + \lambda\tp + \mu\tp A \nabla_y z \\
							&= (y-\Xi) \tp Q_a + \lambda\tp + \mu\tp A \gamma,
	\end{split}
\end{equation}
\begin{equation}
 \nabla_y z = \begin{bmatrix} I & 0 \\ 0 & 0 \end{bmatrix} = \gamma.
\end{equation}

