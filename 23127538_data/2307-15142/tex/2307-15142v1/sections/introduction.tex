\section{Introduction}


A large body of work in recommendations has developed methods to navigate an apparent trade-off between the goals of \textit{accuracy} (to recommend items a user is most likely to want) and \textit{diversity} (to recommend items from a range of categories) \cite{kunaver2017diversity, Adomavicius2012ImprovingAR, Raza2021DeepNN, Isufi2021AccuracydiversityTI, Alexandridis2015AccuracyVN, Hou2020ATE, Alhijawi2023MultifactorRM, Paudel2017FewerFA, He2022DoesUO, FernndezTobas2016AccuracyAD, Gogna2017BalancingAA, FerrariDacrema2021DemonstratingTE, Liu2012SolvingTA, Eskandanian2020UsingSM, Wu2020ServiceRW, Laci2017BeyondAO, Javari2015APM, Kleinberg2023CalibratedRF, Seymen2021ACO, Abdollahpouri2023CalibratedRA, Zhang2008AvoidingMI, Ashkan2015OptimalGD, Zhou2008SolvingTA}. Real-world recommender systems use heuristics to directly incorporate diversity into recommendations \cite{facebook, ebay}, and empirical evidence demonstrates that users prefer diverse recommendations \cite{10.1145/3366423.3380281, S2022DiversityVR, Kim2021CustomerSO, Park2013FromAT}.


A fundamental question remains: Why is there a trade-off in the first place? More specifically, why is ``accuracy'' unaligned with a user's true preference for diversity? Without a principled understanding of the accuracy-diversity trade-off, attempts to diversify recommendations have difficulty moving beyond a heuristic basis---and difficulty articulating what they are accomplishing at a deeper level.

In this work, we introduce and analyze a stylized model of recommendations that helps explain and reconcile the apparent accuracy-diversity trade-off. Our model studies this trade-off through the lens of a user's \textit{consumption constraints}: users typically examine a list of recommendations and use only the top (highest value) options. (A person can watch only one movie in an evening, a recruiter can select only a handful of candidates to interview.)
This lens has strong explanatory power:
\begin{itemize}[leftmargin=*]
    \item When the goal is to maximize the expected value of the \textit{top} recommended items, diverse recommendations are often optimal in our model. By accounting for a user's consumption constraints, optimizing for what they are most likely to want is aligned with recommending a diverse set of items.
    \item Without accounting for consumption constraints, optimal recommendations in our model are homogeneous. This suggests that the trade-off between accuracy and diversity can be explained by commonly-used accuracy metrics not accounting for consumption constraints.

\end{itemize}

A strength of our model is that we can precisely and interpretably analyze the optimal \textit{amount} of diversity in different settings, allowing us to isolate the effect of consumption constraints. This precision also yields practical insights about the role of diversity in recommendations. In Theorem 3, for example, we uncover natural settings where optimal recommendations overrepresent the category of item a user is \textit{least} likely to want---a paradox that appears in grocery stores, where even though customers are less likely to buy ice cream than milk, stores allocate much more space to ice cream.

\subsection{Model} There are $m$ types of items indexed by $[m]=\{1,2,\cdots,m\}.$ A user prefers exactly one type of item, preferring type $t\in[m]$ with probability $p_t$. The value of the $i$-th item of type $t$ is a random variable $X_i^{(t)}$ if the user prefers type $t$ and $0$ otherwise (so its expected value is $p_t\EE[X_i^{(t)}]$). The recommender knows only how $X_i^{(t)}$ are distributed, not their realizations. We refer to $p_t$ as the \vocab{likelihood} of a type and the random variable $X_i^{(t)}$ as a \vocab{conditional item value} (the value of an item conditional on the user preferring the item's type). 

Let $S_{n,k}$ be the set of $n$ items that maximizes the expected total value of the $k$ items with the highest realized values. We call $S_{n,k}$ the \vocab{optimal} set of $n$ recommendations with respect to this objective. (We omit the dependency of $S_{n,k}$ on the other model parameters, as these will be clear from context.)

$S_{n,k}$ arises naturally from an assumption that the user can only use $k$ items, so that they derive value from the $k$ highest value recommended items. So $S_{n,1}$ results from an assumption that the user uses only one item, while $S_{n,n}$ results from an assumption that the user uses \textit{every} recommended item.

$S_{n,n}$ maximizes the expected total value of all of the recommended items, so by linearity of expectation, $S_{n,n}$ contains the $n$ items with the highest individual expected values. 

Meanwhile, $S_{n,1}$ maximizes the expected value of the highest-value item, an objective that---importantly---is not maximized by choosing the individual items with the highest expected values.

\paragraph{Our overarching technical result and interpretation.} 
Our main results (summarized in \Cref{table:mainresults}) show across several settings that:
\begin{quote}
    $S_{n,k}$ is diverse for $k$ fixed and $n$ growing. Meanwhile, $S_{n,n}$ is homogeneous.
\end{quote} 
This technical result has an interpretation explaining the accuracy-diversity trade-off. Objectives that account for a user's consumption constraints naturally induce diversity, while objectives that do not account for consumption constraints can produce homogeneous recommendations. Thus, the observed trade-off is (partly) a consequence of common accuracy metrics not modeling consumption constraints.

One might suggest that our results show homogeneity is desirable when users can use all recommended items. We do not emphasize this interpretation since there are additional reasons outside of our model to incorporate diversity. Thus, our results are best interpreted as showing (1) that diversity arises under \textit{minimal} assumptions, and (2) that standard objectives can (mistakenly) induce homogeneity.

\paragraph{Evaluating diversity.} To evaluate diversity, we consider the representation of each type in $S_{n,k}$. In many of our results, representation falls on an interpretable continuum: from complete diversity (each type represented equally) to proportional diversity (each type represented proportionally to its likelihood $p_t$) to homogeneity (only the highest likelihood type represented). We formalize our measure of diversity in \Cref{sec:diversity}.

\input{figures/mainresults.tex}

\paragraph{Discussion and limitations.} Our model is purposefully stylized and minimal so that we can abstract a small set of ingredients common to a wide set of domains---namely, those where users prefer a certain category of items and a recommender has noisy estimates of user preferences and item values. Importantly, our model captures the consumption constraints of users: when a user is given a set of recommendations, they can typically use only the best few recommendations---a person can watch only one movie in an evening, a recruiter can select only a handful of candidates to interview. 

\textit{Other reasons for diversity.} Importantly, when we refer to \textit{optimal} sets of recommendations, we mean optimal with respect to our stylized optimization problem---maximizing the expected sum of the $k$ highest item values. In real-world contexts, there are many reasons to incorporate diversity that we do not consider here. For example, our model does not consider any explicit preferences users have for diversity. While such a preference may be empirically well-grounded, omitting such a preference makes our conclusions stronger: simply by modeling user consumption constraints, we show that diversity arises naturally in optimal recommendations \textit{even when} our model does not explicitly value diversity.

\textit{Model generalizations.} Real-world settings can differ from our model in natural ways. For example, users can prefer multiple types of items at a time and some items may fall under multiple types. We discuss generalizations in \Cref{sec:generalizations}. Here, the assumptions that users prefer only one type and items each fall under one type allow us to analyze diversity in an interpretable way: characterizing how represented each item type is in comparison to the user's likelihood of preferring that type.

\subsection{An illustrative example: Recovering Steck's standard of calibration}

We now consider a simple instantiation of our model, motivated by a thought experiment suggested by the Netflix researcher Harald Steck \cite{steck2018calibrated}. A user watches romance movies 70 percent of the time and action movies the other 30 percent of the time. Steck raises a concern that an accuracy-maximizing algorithm can produce entirely homogeneous recommendations in this setting, and proposes a standard of \textit{calibration}, where 70 percent of recommended movies here are romance and 30 percent are action. The example below reflects Steck's concern by showing that---before accounting for consumption constraints---optimal recommendations are homogeneous. Yet, by assuming a user can only watch one movie, the optimal recommendations in the example are in fact naturally \textit{calibrated}.

\begin{example}[Recovering calibration]\label{ex:steck}
    Suppose there are two genres of movies, romance and action, indexed 1 and 2 respectively. A user prefers romance with probability $p_1$ and action with probability $p_2$, with $p_1 > p_2.$ Movies from the user's preferred genre have values drawn i.i.d. from an exponential distribution $\Exp(\lambda)$, while other movies have value $0$. In the language of our model,
    $X_i^{(t)} \simiid \Exp(\lambda)$.
    
    $S_{n,n}$ maximizes the expected total value of recommended items, so by linearity of expectation it contains the items of highest individual expected value. The expected value of each romance and action movie are $p_1 \EE[\Exp(\lambda)]$ and $p_2 \EE[\Exp(\lambda)]$ respectively, so $S_{n,n}$ contains \textit{only} romance movies.

    $S_{n,1}$ maximizes the expected value of the best recommended movie. The expected value of the best item among $a_1$ romance movies and $a_2$ action movies (where $a_1+a_2=n$) is
    \begin{equation}
        p_1\cdot \EE[\text{max of $a_1$ draws from $\Exp(\lambda)$}] + p_2\cdot \EE[\text{max of $a_2$ draws from $\Exp(\lambda)$}]
    \end{equation}
    \begin{equation}
        \approx \frac{p_1}{\lambda} \log(a_1) + \frac{p_2}{\lambda} \log(a_2),
    \end{equation}
     which is maximized when $a_1 = p_1n$ and $a_2 = p_2n$ (as shown using Lagrange multipliers). Therefore, $S_{n,1}$ has proportional representation, recovering Steck's standard of calibration.
\end{example}



\subsection{Intuition for our overarching result}\label{sec:intuition}

In the model we propose, a user's value depends only on the recommended items from the user's preferred type. Therefore, conditional on a user preferring type $t$, the user's expected value from a set of recommendations with $a_t$ items of type $t$ is given by $h_t(a_t)$ for some function $h_t$. Then the user's expected value from a set of recommendations with $a_t$ items of type $t$ for all $t\in [m]$ is of the form
\begin{equation}\label{eq:water}
    \sum_{t=1}^m p_t h_t(a_t).
\end{equation}
The key idea of our work is that when accounting for consumption constraints, the function $h_t$ reflects diminishing returns: recommending additional items from a type becomes less and less valuable when we care only about the value of the best recommended items---when a user can only watch one movie, recommending three options for romance movies might be significantly better than two, because the platform doesn't know which exact romance movie the user may like; however, recommending 20 such movies is barely better than 19. Thus, when maximizing \eqref{eq:water}, it becomes preferable to recommend items from other types. Meanwhile, without modeling user consumption constraints, there are not necessarily diminishing returns since the user can use all of the additional items recommended.

The particular shape of the diminishing returns regulates the amount of resulting diversity. In \Cref{ex:steck}, we had that $h_t(x)\propto \log x,$ in which case \eqref{eq:water} is maximized when $a_t\propto p_t$, yielding proportional representation.\footnote{The mathematical result in this example also appears in the context of resource allocation (e.g., \cite{Ghorbanzadeh2014AUP}) and betting (e.g., \S 22.2 in \cite{easley2010networks}) in the presence of logarithmic utility.} Our technical work thus involves analyzing the functions $h_t$ in different settings (this reduces to analyzing the large order statistics of different distributions). Roughly speaking, heavier-tailed conditional item values imply larger marginal returns, resulting in less diversity.

\subsection{Related work}
As we have noted, there is a wide literature devoted to developing methods to navigate the accuracy-diversity trade-off \cite{kunaver2017diversity, Adomavicius2012ImprovingAR, Raza2021DeepNN, Isufi2021AccuracydiversityTI, Alexandridis2015AccuracyVN, Hou2020ATE, Alhijawi2023MultifactorRM, Paudel2017FewerFA, He2022DoesUO, FernndezTobas2016AccuracyAD, Gogna2017BalancingAA, FerrariDacrema2021DemonstratingTE, Liu2012SolvingTA, Eskandanian2020UsingSM, Wu2020ServiceRW, Laci2017BeyondAO, Javari2015APM, Kleinberg2023CalibratedRF, Seymen2021ACO, Abdollahpouri2023CalibratedRA, Zhang2008AvoidingMI, Ashkan2015OptimalGD, Zhou2008SolvingTA}. Such work is supported by empirical evidence suggesting that a combination of these two metrics is preferred by users \cite{10.1145/3366423.3380281, S2022DiversityVR, Kim2021CustomerSO, Park2013FromAT}. Of particular interest to us, however, is work that focuses on objectives that \textit{implicitly} correspond to diversity. In the context of web search, optimizing for the probability that the user is shown a satisfactory search result has been associated with diversification \cite{10.1145/1498759.1498766, Radlinski2008LearningDR}, since effective search results must account for different intents of queries (``pandas'' can refer to an animal or a Python package). More recent work has adapted this objective to the recommender system setting as a metric that unifies accuracy and diversity \cite{Parapar2021TowardsUM}. Our work, by explicitly characterizing optimal amounts of diversity, identifies consumption constraints as the underlying reason for why such approaches result in diversity. We discuss additional related work in \Cref{sec:additional-related-work}.


