 % \input{setup/preamble}
% \IfFileExists{setup/personalize.tex}{
% 	\input{setup/personalize} %Put a personalize.tex file in setup to use your own settings while compiling
% }{} %Please remember to put the file in .gitignore.
% \input{setup/macros}
% 
% \title{Counter Strategies in Fair Parity Games}
% 
% \begin{document}
% \maketitle 
% \date{}
% \section{Introduction}
% 
% \section{Preliminaries}
% 
% 
% 
% \subsection{Strategy Templates}
% % Let $\mathcal{G}^\ell = ((V,E, \chi), E^\ell)$ be a fair parity game and $(V'\subseteq V,E'\subseteq E)$ be a subgraph of $(V,E)$. Let $V'_i = V_i \cap V'$. $(V', E')$ is called a \textbf{strategy template} if it satisfies the following criteria,
% % 
% % \begin{align*}
% % &\text{if } v \in V'_1 \text{ does not lay on a cycle in }E', & |E'(v)|=1, \\
% % &\text{if } v \in V'_1 \text{ lays on a cycle in }E' & E^\ell(v) \subseteq E'(v) \text{ and } 1 \leq |E'(v)|\leq |E^\ell(v)| + 1,\\
% % &\text{if } v \in V'_0, & E'(v) = E(v).
% % \end{align*}
% % 
% % Intuitively, whenever an \Odd vertex lays on a cycle in $(V', E')$, we expect it
% % to have all its outgoing live edges, and possibly one more edge. Whenever it does not lay on a cycle, 
% % it has exactly one of its outgoing edge. All \Even vertices have all of their outgoing edges. Moreover, all of the vertices in $V$
% % have at least one outoing edge in $E'$.
% 
% A strategy template $(V',E')$ introduces a special family of strategies for \Odd $S_1$:
% A strategy $\sigma_1: \Vo \to V$ is in $S_1((V', E'))$ iff for all $v' \in V'_1$, \Odd takes every outgoing edge $(v',w')\in E'$ with a 
% positive probability. \IS{This can be a probablilistic automaton, or it can assign some order and alternate.}
% 
% In particular, the strategy that assigns all $(v',w')$ consecutively, according to a fixed order, is in $S_1((V',E'))$. \IS{This is not probabilistic, so it's not in $S_1$ in the currect definition.}
% These last kind of strategies are called \textit{alternating strategies}.
% 
% \begin{proposition}
% Let $\Wo$ be the winning region of \Odd in $\mathcal{G}^\ell= ((V,E, \chi),E^\ell)$. Then, there exists a strategy template
% $(\Wo, E')$ of $\mathcal{G}^\ell$ such that all strategies in $S_1((\Wo,E'))$ are winning for \Odd from $\Wo$.
% \end{proposition}
% %\begin{proof}
% %Let $w \in W_1$. Then there exists a winning strategy $\sigma_1: V^* \cdot \Vo \to V$ that wins the game from $w$.
% %\end{proof}
% To prove this proposition, we introduce the fixpoint formula calculating $\Wo$ and obtain a ranking function $r:\Wo \to \mathbb{N}^l$ from the formula, where $l$ is the least even upper bound of the assigned priorities. 
% The ranking function is an adaptation of Jurdzinski's small progress measures to fair parity games. 
% Then using the ranking $r$ we will prove that there exists a strategy template $(\Wo, E')$ of $\mathcal{G}^\ell$ such that all strategies in $S_1((\Wo, E'))$ are winning for \Odd.
% %\begin{definition}
% %Let $(V', E')$ be a strategy template of a game $\mathcal{G}^\ell$ with priorities $\leq$ d. A function $\rho: V'_0 \cup V'_1 \to \mathbb{N}^{d+1}$ is a \textbf{fair parity progress measure} for $(V',E')$ if the following hold for all $v\in V'$:
% %\begin{itemize}
% %    \item if $v \in V'_1 \cap V^l$ lays on a cycle in $(V',E')$:
% %    \begin{itemize}
% %        \item if $\chi(v)$ is odd: \\
% %        $\exists (v,w) \in E'$ with $ \rho(v) >_{l+1 -\chi(v)} \rho(w)$  and 
% %        $ \forall (v,w) \in E', \rho(v) \geq_{l -\chi(v)} \rho(w)$, 
% %        \item if $\chi(v)$ is even: \\$\exists (v,w) \in E'$ with $ \rho(v) >_{l+1 -\chi(v)} \rho(w)$ and $\forall (v,w) \in E', \rho(v) \geq_{l + 2 - \chi(v)} \rho(w)$.
% %    \end{itemize}
% %    \item otherwise:
% %    \begin{itemize}
% %       \item if $\chi(v)$ is odd, $\forall (v,w) \in E', \rho(v) \geq_{l+1-\chi(v)} \rho(w)$
% %        \item if $\chi(v)$ is even, $\forall (v,w) \in E', \rho(v) >_{l+1-\chi(v)} \rho(w)$
% %    \end{itemize}
% %\end{itemize}
% %\end{definition}
% 
% %\begin{lemma}
% %If there is a fair parity progress measure for a strategy template $(V', E')$ for a game $\mathcal{G}^\ell$, then in each strongly connected component, the maximum priority of a simple cycle is odd.
% %\end{lemma}

\vspace*{-0.25cm}
\section{Existence of Maximal Winning \Odd Strategy Templates}\label{sec:strat-templates}

This section proves the existence of maximal winning \Odd strategy templates\footnote{In the rest of this section, we will sometimes call \Odd strategy templates simply, \emph{strategy templates}, since these are the only strategy templates we will be dealing with.} in \Odd-fair parity games, formalized in the following theorem.

\begin{theorem}\label{thm:existence-maximaloddstrategytemplates}
    Given an \Odd-fair parity game $\mathcal{G}^\ell$, there exists a maximal winning \Odd strategy template. 
\end{theorem}

% Since the existence of maximal winning \Even strategy templates follow from previous work (as mentioned in Sec. 3), the proof of existence of maximal winning \Odd strategy templates
% allow us to use strategy templates as a formalization of strategies of both player in \Odd-fair parity games. This is the first formalization of both players' strategies in \Odd-fair games known to the authors.
% Furthermore, we use this formalization in Sec. 4 in the correctness proof of Zielonka's algorithm for \Odd-fair parity games.
We prove Thm.~\ref{thm:existence-maximaloddstrategytemplates} by giving an algorithm which constructs $\mathcal{S}$ from a ranking function induced by a fixed-point algorithm in the $\mu$-calculus which computes \Wo. Towards this goal, Sec.~\ref{sec:assump:prelim} first introduces necessary preliminaries, Sec.~\ref{sec:templates:solving} gives the fixed-point algorithm to compute \Wo and Sec.~\ref{sec:templates:ranking} formalizes how to extract a strategy template $\mathcal{S}$ from the ranking induced by this fixed-point and proves that $\mathcal{S}$ is indeed maximal and winning. % from this computation and Sec.~\ref{sec:templates:result} finally shows how this ranking can be used to construct maximal winning strategy templates and proves their correctness. 

While this section uses fixed-point algorithms extensively to \emph{construct} a maximal winning \Odd strategy template towards a \emph{proof} of Thm.~\ref{thm:existence-maximaloddstrategytemplates}, we note again that the proof of the new Zielonka's algorithm given in Sec.~\ref{sec:zielonka} only uses the \emph{existence} of templates (i.e., the fact that Thm.~\ref{thm:existence-maximaloddstrategytemplates} holds) and does not utilize their \emph{construction} via the algorithm presented here. %.\todo{But in the proofs we sometimes construct a strategy template, no? Maybe we can say "does not construct one" instead of "does not require the construction"}

\input{mucalculus}

\vspace{-0.1cm}
\subsection{A Fixed-Point Algorithm for $\mathcal{W}_{\Odd}$}\label{sec:templates:solving}

%\begin{align*}
%    \mathcal{W}_{Even}= \nu {Y_l} \mu {X_{l-1}} \ldots \nu {Y_2} \mu {X_1}. A_i\quad &(C_l \cap \Cpre_\Even(Y_l)) \cup \\
%                                                                        &(\bigcup_{i \in [1, l-1]} C_i \cap \Apre(Y_l, X_{l-1})) \cup \nonumber \\
%                                                                        & \ldots\nonumber \\
%                                                                        &(C_2 \cap \Cpre_\Even(Y_2)) \cup \nonumber \\
%                                                                        & (C_1 \cap \Apre(Y_2, X_1))\nonumber
%\end{align*}

Given an  \Odd-fair parity game $\mathcal{G}^\ell = \ltup{\langle V, \Ve, \Vo, E, \chi \rangle, E^\ell}$ this section presents a fixed-point algorithm in the $\mu$-calculus which computes the winning region $\Wo$ of player $\Odd$ in \Odd-fair parity games. It is obtained by negating the fixed-point formula computing \We \,in~\cite{banerjee2022fast}, formalized in the following proposition and proven in App.~\ref{app:fp-proof}.

%\vspace*{-0.15cm}
%It was recently shown in \cite{banerjee2022fast} that the winning region $\We$ for \Even in an \Odd-fair parity game $\mathcal{G}^\ell$ with least even upperbound color $l\geq 0$ can be computed by a fixed-point formula that preserves the complexity of parity fixed-point formula.
 %As \Odd-fair parity games are determined, we can simply compute the winning region for player $\Odd$ by negating this fixed-point formula, and obtain the formula in Prop.~\ref{prop: W_Odd}.
\begin{proposition}\label{prop: W_Odd}
Given an \Odd-fair parity game $\mathcal{G}^\ell = (\ltup{V, \Ve, \Vo, E, \chi}, E^\ell)$ with least even upper bound $l\geq 0$ it holds that $Z=\Wo$, where
\begin{small}
\begin{align}\label{eq:fp-odd}
    Z &:=\textstyle \mu {Y_l}.~  \nu {X_{l-1}}.~  \ldots \mu{Y_2}.~  \nu{X_1}.~  \bigcap_{j \in \ev{2}{l}} \B_j[Y_j, X_{j-1}], \\ \vspace{0.1cm}
    &\text{ where} \quad
    \B_j[\mathbf{Y}, \mathbf{X}] := \left(\textstyle\bigcup_{i \in [j+1,l]} C_i\right) \cup \left(\overline{C_j} \cap \Npre(\mathbf{Y}, \mathbf{X}) \right) \cup \left(C_j \cap \Cpre_\Odd(\mathbf{Y})\right).\nonumber
\end{align}
\end{small}
% then $Z=\Wo$.
% Further, it takes $\mathcal{O}(n^{l+1})$ symbolic steps to compute $Z$.
\end{proposition}

%\vspace*{-0.15cm}

Before utilizing \eqref{eq:fp-odd} we illustrate its computations via an example. %IRMAAAAK IRMAK

% In order to ease the understanding of the subsequent use of \eqref{eq:fp-odd} for the construction of strategy templates, let us consider the following example. 
%\vspace{-1cm}
%\vspace*{-0.15cm}

\begin{example}\label{ex:1}
Consider the \Odd-fair parity game $\mathcal{G}^\ell $ depicted in Fig.~\ref{fig:ex1} (left). Here, the name of the vertices coincide with their priorities, e.g., $C_2=\set{2a, 2b, 2c}$. $\Ve$ and $\Vo$ are indicated by circles and squares, respectively. Edges in $E^\ell$ are shown by dashed lines. 
% Let $\langle \mathcal{G}, E^\ell \rangle $ for $ \mathcal{G} = \langle V, \Ve, \Vo, E, \chi \rangle$ with $V = \{1a, 2a, 2b, 2c, 3a, 3b, 4a\}$, $\Ve=\{1a,2a,3a,3b,2c\}$, $\Vo=\{2b,4a\}$, $E^\ell = \{(4a, 2a), (4a,3a), (2b,2c)\}$, $E = E^\ell \cup \{(2a,2a),(2a,4a),(3a,4a),(1a,4a),(1a,2c),(2c,2b),(2b,3b),(3b,2b) \}$ and $C_1 = \{1a\}$, $C_2=\{2a,2b,2c\}$, $C_3 = \{3a,3b\}$, $C_4=\{4a\}$. The game graph is depicted in figure \ref{gamegraph} where the live edges are shown by dashed lines. 
% 
As the least even upper bound in this example is $l=4$, 

\vspace*{-0.3cm}
\begin{small}
\begin{align}\label{equ:fpexample}
    &Z = \mu Y_4.~ \nu X_3.~ \mu Y_2.~ \nu X_1.~ \Phi^{Y_4, X_3, Y_2, X_1}~\quad  \text{where}\\
    &\Phi^{Y_4, X_3, Y_2, X_1}:= (\overline{C_4} \cap \Npre(Y_4, X_3)) \cup (C_4 \cap \Cpre_\Odd(Y_4)))\nonumber\\
    & \hspace{2.03cm}\cap (\overline{C_2} \cap \Npre(Y_2, X_1)) \cup (C_2 \cap \Cpre_\Odd(Y_2)) \cup C_4 \cup C_3)\nonumber.
\end{align}
\end{small}

\vspace{-0.2cm}

% Figure environment removed

\vspace{-0.2cm}

Using the notation defined in Sec.~\ref{sec:assump:prelim}, we initialize  \eqref{equ:fpexample} by $Y_4^{0} = \emptyset$, $X_3^{0, 0} = V$, $Y_2^{0,0,0} = \emptyset$ and $X_1^{0,0,0,0} = V$ and observe from \eqref{equ:combindedPres} that  $\Cpre_\Odd(\emptyset)=\emptyset$ and $\Npre(\emptyset, V)=V$. We obtain 
\begin{small}
\begin{align*}
 X_1^{0,0,0,1} &= \Phi^{Y_4^{0}, X_3^{0, 0}, Y_2^{0,0,0}, X_1^{0,0,0,0} }
 =((\overline{C_4} \cap \Npre(\emptyset, V)) \cup (C_4 \cap \Cpre_\Odd(\emptyset)))\cap ((\overline{C_2} \cap \Npre(\emptyset, V)) \\ 
 & \quad \,\, \cup (C_2 \cap \Cpre_\Odd(\emptyset)) \cup C_4 \cup C_3) =(\overline{C_4} ) \cap (\overline{C_2} \cup C_4 \cup C_3) =C_3 \cup C_1\\
%   \end{align*}
%   \begin{align*}
  X_1^{0,0,0,2} &= \Phi^{Y_4^{0}, X_3^{0, 0}, Y_2^{0,0,0}, X_1^{0,0,0,1} }\\
  &= C_3 \cup (C_1 \cap \Npre(Y_2^{0,0,0}, X_1^{0,0,0,1})) = C_3 \cup (C_1 \cap \Npre(\emptyset, C_3\cup C_1))=C_3
%   \quad
%  &=X_1^{0,0,0,3}
\end{align*}
\end{small}

\vspace{-0.1cm}

where $ \Npre(\emptyset, C_3\cup C_1)=\emptyset$ as $v \in \Npre(\emptyset, C_3 \cup C_1)$ implies $v\in \Cpre_\Odd(C_3 \cup C_1) = \{2b,4a\}$ and $v\in \Ve \cup \Lpre^\forall(C_3 \cup C_1)$. However, $2b, 4a$ are \Odd vertices with live outgoing edges to $2a,2c\in (V \setminus (C_3 \cup C_1))$.
% 
In the next iteration, we again get $X_1^{0,0,0,3} = C_3$ and thus $X_1$ saturates with $C_3$. Therefore, $Y_2^{0,0,1}=C_3$. Now the next round of computations of $\Phi$ results in 
\begin{small}
\begin{align*}
   X_1^{0,0,1,1} &= \Phi^{Y_4^{0}, X_3^{0, 0}, Y_2^{0,0,1}, X_1^{0,0,1,0} } =  C_3 \cup (C_1 \cap \Npre(Y_2^{0,0,1}, X_1^{0,0,1,0})) \cup (C_2 \cap \Cpre_\Odd(Y_2^{0,0,1}))\\
 & =C_3 \cup (C_1 \cap \Npre(C_3, V)) \cup (C_2 \cap \Cpre_\Odd(C_3))=C_3 \cup C_1 \cup \{2b\}\\
    X_1^{0,0,1,2} &= \Phi^{Y_4^{0}, X_3^{0, 0}, Y_2^{0,0,1}, X_1^{0,0,1,1} } = C_3 \cup \{2b\}=X_1^{0,0,1,3} 
% = \Phi^{Y_4^{0}, X_3^{0, 0}, Y_2^{0,0,1}, X_1^{0,0,0,2} } = C_3 \cup \{2b\}\\
\end{align*}
\end{small}
Here $C_1$ and $\{2b\}$ get added in $X_1^{0,0,1,1}$ as $1a \in \Npre(C_3, V)$ trivially and $2b \in \Cpre_\Odd (C_3)$ due to the edge $(2b,3b)$. $C_1$ is removed from $X_1^{0,0,1,2}$ since
$1a$ cannot be forced by \Odd to $C_1 \cup C_3 \cup \{2b\}$ in the next step.
%$1a \not \in ( C_1 \cap \Npre(Y_2^{0,0,1}, X_1^{0,0,1,1} )) = (C_1 \cap \Npre(C_3, C_1 \cup C_3 \cup \{2b\}))$ since $1a \not \in \Cpre_\Odd(C_1\cup C_3 \cup \{2b\})$.
The fixed-point calculation proceeds in a similar fashion, until $Y_4$ reaches its saturation value $V \setminus \{2a\}$. 
The full computation of $Z$ is given in App.~\cite{app:example}. %\vspace{-2mm}
\end{example}

%\begin{align}\label{eq:fp-odd2}
%    \Wo = \mu {Y_l} \nu {X_{l-1}} \ldots \mu{Y_2} \nu{X_1}. \quad & (\overline{C_l} \cap \Npre(Y_l, X_{l-1})) \cup (C_l \cap \Cpre_\Odd(Y_l))\cap \\
%%                                                                                & \ldots \nonumber \\
 %%                                                                               & ((\bigcup_{i \in [j+1, l]} C_i) \cup (\overline{C_j} \cap \Npre(Y_j, X_{j-1})) \cup (C_j \cap \Cpre_\Odd(Y_j))) \cap \nonumber \\
 %                                                                               & \ldots \nonumber \\
 %                                                                               & ((\bigcup_{i \in [3, l]} C_i) \cup (\overline{C_2} \cap \Npre(Y_2, X_{1})) \cup (C_2 \cap \Cpre_\Odd(Y_2))) \nonumber
 %   \end{align}

\subsection{Construction of a Rank-based Strategy Template}\label{sec:templates:ranking}
Given an \Odd-fair parity game $\mathcal{G}^\ell$ with the least even priority upper bound $l\geq 0$, we define a ranking function $\rank{}: \Wo \to \mathbb{N}^{l}$ first introduced in~\cite{SE84} and highly related to \enquote{progress measures}~\cite{KlarlundKozen91,Klarlund94,Klarlund90,Jurdzinski00}. Intuitively, $\rank{v}$ indicates in which iteration $v$ was added to $Z$ in \eqref{eq:fp-odd} and  never got removed from $Z$ again, as illustrated by the following example. %We show that there exists a strategy template $\Sc=(V',\Ve',\Vo', E')$ of $\mathcal{G}^\ell$, constructed according to $r$, for which all compliant player \Odd strategies are winning in $\mathcal{G}^\ell$.

%Let us show the saturation values of a variable $Z$ with $Z^\infty$. That is, $Z^\infty = Z^n = Z^{n+1}$. %Also for all even $j \in \ev{2}{l}$, let us fix the notation

\begin{example}\label{ex:2}
 Consider again the \Odd-fair parity game depicted in Fig.~\ref{fig:ex1}. Here, $\rank{v}$ of each $v \in \Wo = V \setminus \{2a\}$ is shown in red next to the node in the figure. Intuitively, the $4-$tuple is associated with the subscript $Y_4,Y_3,Y_2,Y_1$ of $\Phi$ in \eqref{equ:fpexample}. For instance $\rank{3a}=(2,0,1,0)$ indicates that $3a$ was added to $Z$ 
 during the first iteration of $Y_2$ inside the second iteration of $Y_4$.
 More concretely, $3a \not \in Y_4^{0}, 3a \not \in Y_4^1, 3a \in Y_4^2$. So $2$ is the first iteration of the $Y_4$ variable in which $3a$ got included in the variable. For $Y_2$, $3a \not \in Y_2^{2,0, 0}$ and $3a \in Y_2^{2,0,1}$, and therefore $\rank{3a} =  (2,0,1,0)$.
\end{example}

The intuition of Ex.~\ref{ex:2} is formalized in the following definition.

% Formally, ranks are defined as follows:
\begin{definition}[rank]\label{def:rank}
Given an \Odd-fair parity game $\mathcal{G}^\ell = (\ltup{V, \Ve, \Vo, E, \chi}, E^\ell)$ with least even upper bound $l\geq 0$ and winning region $\Wo\subseteq V$, we define the ranking function $\rank{}: \Wo \to \mathbb{N}^{l}$ for $v\in \Wo$ such that 
 \begin{equation}\label{eq:rank}
  \textstyle\rank{v}=(r_l,0,r_{l-1},0\hdots r_2, 0) \quad\text{if}\quad v\in \bigcap_{j\in\ev{2}{l}}Y_j^{r_l,0,\hdots ,r_j}\setminus Y_j^{r_l,0,\hdots ,r_j-1}.
 \end{equation}
where the valuations of the variables $Y_j$ are obtained from the iterations of the fixed-point calculation in~\eqref{eq:fp-odd} as illustrated in Ex.~\ref{ex:1}.
\end{definition}

% The formal definition of the rank of $v \in \Wo$ is the following,
% \begin{definition}
% \[ \rank{v} = (j_l+1, 0, j_{l-2}+1, 0, \ldots, j_4+1, 0, j_2+1, 0) \]
% where $(j_l, 0, j_{l-2}, 0, \ldots, j_2, 0)= min\{ (a_l, 0, a_{l-2}, 0, \ldots, a_2, 0) \mid \forall (t_l, 0, t_{l-2}, 0, \ldots, t_2, 0 )  \in \mathbb{N}^l \geq (a_l, 0, a_{l-2}, 0, \ldots, a_2, 0), \, v \in X_1^{t_l, 0, \ldots, t_2, 0} \}$.
% \end{definition}
% Note that the even indices of a rank are always $0$. Even though this introduces a redundancy in the representation, keeping the ranks in this forms helps to provide intuition in the proofs. 
% Also note that, the reason why we seem to consider only the $Y_j$'s iteration counts comes from the fact that $X_j$ variables are least fixpoint variables; i.e. $ X_j^ 0 \supseteq X_j^1 \supseteq \ldots$ is a decreasing sequence, and $X_j^0$ is initialized as $V$, 
% so the smallest iteration count that contains $v$ is always $0$ for all $X_j$. On the other hand, $Y_j$s are least fixpoint variables, are initialized as $\emptyset$ and $Y_j^0 \subseteq Y_j^1 \subseteq \ldots $ is an increasing sequence. Thus, there exist a unique iteration count $j_j$ for all $Y_j$ such that $Y_j^{\ldots, j_j}$ contains $v$ for the first time.
% It was not needed to add $+1$ to $j_l, j_{l+1}, \ldots$ but the authors found it easier to work with this definition, since $\rank{v} = (j_l, 0, j_{l-2}, \ldots, j_2, 0)$ implies that for all $Y_m$, $v \in Y_m^{j_l, 0, \ldots, j_m, 0, 0, \ldots, 0}$ and $v \not \in Y_m^{j_l, 0, \ldots, j_m-1, 0, 0, \ldots, 0}$.


% \section{Strategy Templates}
A ranking function obtained from a fixed-point computation as in \eqref{eq:rank} naturally gives rise to a positional winning strategy for the respective player in (normal) $\omega$-regular games that allow for positional strategies. The corresponding positional strategy is obtained by always choosing a \emph{minimum ranked successor} in the winning region.\footnote{See \cite{banerjee2022fast} for a similar construction of the positional winning strategy of \Even in \Odd-fair parity games} 
% 
% acquired in this exact manner from the $\mu-$calculus formula that solves parity games \IS{ref}, gives a positional winning \Even, or \Odd strategy. The only thing \Even, or \Odd needs
% to do to win, is to take its \emph{minimum ranked successor} from each vertex that is hers. A similar strategy would work for the \Even player in \Odd-fair parity games, with the formula that is the negation of ~\eqref{eq:fp-odd}. This is because \Even has positional strategies in \Odd-fair parity games.
We use this insight to obtain a \emph{candidate} maximal strategy template for player \Odd (which we prove to be also \emph{winning} in Prop.~\ref{prop:mainresult}) as follows.
% We simply start with the outlined minimum ranked positional strategy induced by the ranking in \eqref{} and 
% 
% 
% Our contribution in this section is to show that a minimum ranked successor strategy based on the ranking function we get from \eqref{eq:fp-odd} gives us a maximal winning \Odd strategy template if we make sure all \Odd nodes that are seen infinitely often, see both their minimum ranked successors and all their live edges infinitely often. This is what we called the \emph{"almost positionality"} of \Odd strategies in \Odd-fair parity games.
% 
% 
% According to the definition of an \Odd strategy template, all \Odd nodes that lie on a cycle in the template, needs to have all their live outgoing edges in the template. 
% And all \Odd strategies compliant with the template, sees each edge in the template infinitely often if its source node is seen infinitely often. 
% Therefore, all we need to do to get the above-mentioned \Odd strategy template, is to
We start with a subgraph on \Wo defining the minimum ranked successor strategy for \Odd induced by the ranking in \eqref{eq:rank}, and then iteratively add all live edges of nodes that lie on a cycle in the subgraph, to the subgraph. The saturated subgraph then defines a strategy template for \Odd, as formalized next. 

\begin{definition}[Rank-based Strategy Template]\label{def:S}
    Given an \Odd-fair parity game $\mathcal{G}^\ell = (\ltup{V, \Ve, \Vo, E, \chi}, E^\ell)$ with least even upper bound $l\geq 0$ on the priorities of nodes, winning region $\Wo\subseteq V$ and the ranking function $\rank{}: \Wo \to \mathbb{N}^{l}$ from Defn.~\ref{def:rank}, we define a strategy template $\Sc^{\mathcal{G}^\ell}=(\Wo,E')$ where $E'$ is constructed as follows:
   \begin{enumerate}\label{const:S}
   \item[(S1)] for all $v \in \Ve \cap \Wo$, add all $(v, w)\in E$ to $E'$;
   \item[(S2)] for all $v \in \Vo \cap \Wo$, add $(v,w)\in E$ to $E'$ for a $w$ with %$w$ is the successor of $v$ with minimum rank, i.e., 
   $w=argmin_{w'\in E(v)}\rank{w'}$ ($w$ is arbitrarily picked amongst the successors with the mimimum ranking);
   \item[(S3)] for all $v \in V^\ell\cap \Wo$, add all $(v,w)\in E^\ell$ to $E'$ if $v$ lays on a cycle in $\mathcal{S}^{\mathcal{G}^\ell}$;
   \item[(S4)] repeat item (S3) until no new edges are added.
   \end{enumerate}
   We call $\Sc^{\mathcal{G}^\ell}$ the \emph{minimum rank based maximal \Odd strategy template of $\mathcal{G}^\ell$}.
   \end{definition}
   
      \begin{example}\label{ex:3}
    $\Sc^{\mathcal{G}^\ell}$ for $\mathcal{G}^\ell$ from Ex.~\ref{ex:1} is depicted in Fig.~\ref{fig:ex1} (right). %We see that the live edges originating from vertex $4a$ are not contained in the template as $4a$ cannot be seen infinitely often if player \Odd chooses the minimal rank successor (i.e., moves to $2b$) upon the first visit to $4a$. After that, $4a$ cannot be visited again if player \Odd plays a strategy compliant with the strategy template.
   \end{example}
   
   It is clear from the definition that $\Sc^{\mathcal{G}^\ell}$ is an \Odd strategy template in $\mathcal{G}^\ell$. It is also maximal since each $v \in \Wo$ is assigned a rank. %The next subsection proves that it is also \emph{winning}.
   It remains to show that it is winning:
   
   
   
%    \subsection{Soundness of the Candidate Template}\label{sec:soundness_candidate}
%   It is easy to see that Thm.~\ref{thm:existence-maximaloddstrategytemplates} is proven, if we can show that $\Sc^{\mathcal{G}^\ell}$ is indeed winning. This is the main result of this section and formalized next.
%     In the main theorem of this section Thm. \ref{thm:mainresult} we claim that $\Sc^{\mathcal{G}^\ell}$ is winning.
    \begin{proposition}\label{prop:mainresult}
        Every player \Odd strategy compliant with $\Sc^{\mathcal{G}^\ell}$ is winning for \Odd in $\mathcal{G}^\ell$.
    \end{proposition}
    
    \noindent The full proof of Prop.~\ref{prop:mainresult} can be found in App.~\ref{app:counter-strategy-templates} and we only give a proof-sketch here.
    
    First, recall that $\Sc^{\mathcal{G}^\ell}$ is obtained by extending a minimum-rank based strategy as formalized in Def.~\ref{def:S}. Based on this we call a play $v_1 v_2 \ldots$ in $\Sc^{\mathcal{G}^\ell}$ \emph{minimal} if for all $v_i \in V_\Odd$, $v_{i+1}$ is the minimum ranked successor of $v_i$. We further call a cycle minimal, if it is a section of a minimal play.
%     
    Now consider a play $\pi= v_0v_1\ldots$ which is compliant with $\Sc^{\mathcal{G}^\ell}$ and $v_0 \in \Wo$.  Since $\pi$ is compliant with an \Odd strategy template, it obeys the fairness condition. It is left to show that $\pi$ is \Odd winning.
    %This gives by induction that, a minimal cycle that passes through $v$ should be visited infinitely often. 
    %The main idea for proving Prop.~\ref{prop:mainresult} is now to show that any play that embeds an infinite minimal play is winning. 
    %The main idea for proving Prop.~\ref{prop:mainresult} is now to show that these minimal cycles are actually winning. 
    We do this by a chain of three observations,% formally proven in App.~\ref{app:counter-strategy-templates}:
    \begin{enumerate}
     \item If $\Wo \neq \emptyset$, there exists a non empty set $M := \{ v \in \Wo \mid \rank{v} = (1, 0, 1, 0, \ldots, 1, 0)\}$ (see Prop.~\ref{app-prop:Mexists}).
     \item All cycles in $\Sc^{\mathcal{G}^\ell}$ that pass through a vertex in $M$ are \Odd winning (see Prop.~\ref{app-prop:cycle-through-M}).
     \item All infinite minimal plays in $\Sc^{\mathcal{G}^\ell}$ visit $M$ infinitely often (see Prop.~\ref{app-prop:minimal-play-visits-M}).
    \end{enumerate}
    
    While item 1 simply follows from the observation that $(1,0,1,0 ,\ldots, 1, 0)$ is the minimum rank the ranking function assigns to a vertex and the set of nodes with this rank cannot be empty due to the monotonicity of \eqref{eq:fp-odd}, the proofs for item 2 and 3 are rather technical. %They require a careful analysis of the fixed-point algorithm in \eqref{eq:fp-odd} w.r.t.\ ranks over cycles within $\Sc^{\mathcal{G}^\ell}$ and are given in full detail in App.~\ref{app:counter-strategy-templates}.
    
    With the observations in item 1-3 being proven, we are ready to show that $\pi$ is \Odd winning. 
    Observe that $\pi = v_1 v_2 \ldots$ \enquote{embeds} an infinite minimal play, that is, there exists a subsequence $\pi' = v_{j_1} v_{j_2} \ldots$ of $\pi$ where $j_1 < j_2 < \ldots$ that is a minimal play. This is because whenever a $v \in V_\Odd \cap \Wo$ is seen infinitely often in $\pi$, $(v, v_{\min})$ is seen infinitely often as well, where $v_{\min}$ is the minimum-rank successor of $v$ in $\Sc^{\mathcal{G}^\ell}$.
    Since $\pi'$ visits $M$ infinitely often (from item 3), $\pi$ does so too.
    %This is because it embeds $\pi'$, which visists $M$ infinitely often (from item 3). %for any $v$ that is visited infinitely often in $\pi$, it's minimum-rank successor $v_{\min}$ is also visited infinitely often. 
    %This gives us an infinite minimal subsequence of $\pi$ and we know that all infinite minimal plays visit $M$ infinitely often (by item 3). %. Since all minimal plays visit $M$ infinitely often (from item 3) $\pi$ visits $M$ infinitely often. 
    Then due to pigeonhole principle, there exists an $x\in M$ that is visited infinitely often by $\pi$. Thus, a tail of $\pi$ can be seen as consecutive cycles over $x$. Since all cycles that pass through $M$ are \Odd winning (from item 2), we conclude that $\pi$ is \Odd winning.  
    
    Thm.~\ref{thm:existence-maximaloddstrategytemplates} now follows as a corollary of Prop.~\ref{prop:mainresult}.
    
    
%     
%     
% %   The main insight behind the proof of Prop.~\ref{prop:mainresult} is actually similar to the one enabling the proof of the \Odd-fair Zielonka's algorithm given in Sec.~\ref{} and consists of three steps: 
%   
%   It shows that there exists a core subset of the \Odd winning region $M\subseteq \Wo$, that is added to $Z$ in the first iteration of the 
%     fixed-point calculation in ~\eqref{eq:fp-odd}, to which each $v \in \Wo$ can be forced to reach by \Odd. 
%     
%     
%     
%     Here in particular, we show that any \Odd strategy compliant with $\Sc^{\mathcal{G}^\ell}$ reaches $\Wo'$ (infinitely often) while obeying the fairness condition, and is thus winning for \Odd.
% 
%     The full proof of Prop.~\ref{prop:mainresult} can be found in App.~\ref{??}. It consists of $3$ main propositions which we present here one-by-one along with some intuition on why they hold.
% 
%     \begin{proposition}\label{prop:Mexists}
%         If $\Wo \neq \emptyset$, there exists a non empty set $M := \{ v \in \Wo \mid \rank{v} = (1, 0, 1, 0, \ldots, 1, 0)\}$.
%     \end{proposition}
%     Observe that $(1,0,1,0 ,\ldots, 1, 0)$ is the minimum rank the ranking function assigns to a vertex. Also, the vertices in $M$ are exactly the vertices that are added to $Z$ during the
%     first iteration of the fixed-point calculation and are never removed. The existence of such a set is apparent from the fact that, each vertex $v \in \Wo$ that has a non-minimum rank, is in the set because 
%     of the vertices with smaller ranks, i.e. the vertices that got included to $Z$ prior to $v$. This requires a set of vertices that were added to $Z$ prior to all the others. 
% %     
%     Additionally, from \eqref{eq:fp-odd} we gather the observation that all $v \in M$ have odd priorities.
%     \begin{proposition}\label{prop:cycle-through-M}
%         All cycles in $\Sc^{\mathcal{G}^\ell}$ that pass through a vertex in $M$ are \Odd winning.% (i.e. the largest priority in the cycle is odd).
%     \end{proposition}
% 
%     To see why Prop.~\ref{prop:cycle-through-M} holds, we need to make an observation. 
%     For an even $m\leq l$, let $Y_m^\1$ denote the value of $Y_m$ after the first ever iteration over it is completed, during the computation of \eqref{eq:fp-odd}.
%     I.e. $Y_m^\1 = Y^{0,0,\ldots ,0, 1} = $
%     $$\nu X_{m-1}\ldots \mu Y_2 \nu X_1. \bigcap_{j \in \ev{m+2}{l}} \B_j[\emptyset, V] \cap \B_m[\emptyset, X_{m-1}] \cap \bigcap_{j \in \ev{2}{m-2}} \B_j[Y_j, X_{j-1}].$$
%     In the first term $\B_j$ takes $\emptyset$ and $V$ as arguments. This is due to all $Y_{j}, X_{j-1}$ variables for $j \leq m$ having the values they are initialized with. Observe that when the fixed-point above is calculated, all $X_{j-1}, Y_j$ values for $j < m$ will saturate at the same value,
%     which is the final result of the computation. That is, 
%     \begin{equation}\label{eq:Ym1}
%     Y_m^\1 = \bigcap_{j \in \ev{m+2}{l}} \B_j[\emptyset, V] \cap \B_m[\emptyset, Y_m^\1] \cap \bigcap_{j \in \ev{2}{m-2}} \B_j[Y_m^\1 Y_m^\1].
%     \end{equation}
%     If we go through the definition of $\B_j$ we see that: the first term of this formula adds or deletes $v \in C_j$ with $j > m$. It adds all the ones with odd $j$  and removes all the ones with even $j$.%is equal to $\bigcup_{j \in \ev{m+2}{l}}C_{j-1} \cup \bigcup_{j \in [1, m+1]}C_j$. That is, the first term eliminates all $v \in C_j$ with even $j>m$ from $Y_m^\1$ and add all $C_j$ with odd $j>m$.
%      The last term adds and removes $v \in C_j$ for $j \leq m-2$. It adds the ones in $\Cpre_\Odd(Y_m^\1)$ and removes the ones that are not. The middle term eliminates $C_m$ and all $v \in C_j \cap \neg \Npre(\emptyset, Y_m^\1)$ for $j < m$, and adds $v \in C_{m-1} \cap \Npre(\emptyset, Y_m^\1)$.
%     If we go through the definition of $\Npre$, we see that $\Npre(\emptyset, Y_m^\1) = \Cpre_\Odd(Y_m^\1) \cap (V_\Even \cup \Lpre^\forall(Y_m^\1))$.
%     This gives us the observation,
%     \begin{equation}\label{eq:obs}
%         \text{If  } v \in Y_m^\1 \text{ then either } \chi(v)>m\text{ and is odd, or }  v\in \Npre(\emptyset, Y_m^\1).
%     \end{equation}
%     %$ Y_m^\1$ consists of $v$ with either odd $\chi(v)>m$, or in $\Npre(\emptyset, Y_m^\1)$.
% 
%     Now observe that, for every $v \in M$, $v \in Y_m^\1$ for each even $m \leq l$. In particular, $ v \in Y_n^\1$ where $n$ is the even number for which $\chi(v) = n-1$.
%     It follows that $ v \in \B_n[\emptyset, Y_n^\1]$. Then, $v \in \Cpre_\Odd(Y_n^\1) \cap (V_\Even \cup \Lpre^\forall(Y_n^\1))$.
%     Since all live outgoing edges of $v$ are in $Y_n^\1$, for all $(v,w)$ in $\Sc^{\mathcal{G}^\ell}$, $w \in Y_n^\1$.
% 
%     By our previous observation $w$ either has an odd priority larger than $n$, or is in $ \Cpre_\Odd(Y_n^\1) \cap (V_\Even \cup \Lpre^\forall(Y_n^\1))$.
%     If $\chi(w)>n$ is odd, then $w \in Y^\1_{\chi(w)+1}$, and we repeat the same argument to conclude the highest priority seen is always odd.
% 
%     Before we present the third proposition, we need a lemma and some observations obtained from formula ~\eqref{eq:fp-odd}.
%     \begin{observation}\label{obs:v-Even-Odd-inequalities} 
%         \begin{align*}
%             &\quad \quad \quad \quad  \quad \quad \text{if } v \in V_\Even, \quad \quad \forall(v, w)\in E, \rank{v}\geq_{l+1-\chi(v)} \rank{w}\\
%             &\quad \quad \quad  \quad \quad \quad  \text{if } v \in V_\Odd, \quad \quad \exists(v, w)\in E, \rank{v}\geq_{l+1-\chi(v)} \rank{w}
%         \end{align*}
%         where $\rank{v} \geq_b \rank{w}$ denotes the $\geq$ relation in the lexicographic ordering, restricted to the first b elements of the tuples $\rank{v}$ and $\rank{w}$. If $\chi(v)$ is odd, the inequalities are strict. 
%     \end{observation}
%     We call a play $\pi = v_1 v_2 \ldots$ in $\Sc^{\mathcal{G}^\ell}$ \emph{minimal} if for all $v_i \in V_\Odd$, $v_{i+1}$ is the minimum ranked successor of $v_i$. We call a cycle minimal, if it is a section of a minimal play.
%     \begin{lemma}\label{lemma:minimalplayOddwinning}
%         Every minimal play is \Odd winning.
%     \end{lemma}
%     This lemma follows from Obs. \ref{obs:v-Even-Odd-inequalities}. A minimal play only sees minimal cycles. Let $\delta = w_1 w_2 \ldots w_1$ be such a cycle. 
%     $\delta$ cannot be an \Even winning cycle: Assume $b := max\{ \chi(w) \mid w \in \delta\} $ is even. Let $w_i\in \delta$ have priority $b$. Then by Obs. \ref{obs:v-Even-Odd-inequalities}, $\rank{w_i} >_{l+1-b} \rank{w_{i+1}} \geq_{l+1 - \chi(w_{i+1})} \ldots \geq_{l+1-\chi(w_{i-1})} \rank{w_i}$. Since for all $w_j \in \delta$, $\chi(w_{j})\leq b$, the previous inequality yields $\rank{w_i} >_{l+1-b} \rank{w_i}$, which is a contradiction.
% 
%     %The last proposition states that all $\pi$ that starts in \Wo and is compliant with $\Sc^{\mathcal{G}^\ell}$, visits $M$ infinitely often. 
%     \begin{proposition}\label{prop:minimal-play-visits-M}
%         Any minimal cycle in $\Sc^{\mathcal{G}^\ell}$ visits $M$.
%     \end{proposition}
%     Let $\delta = w_1 w_2 \ldots w_1$ be a minimal cycle and $w_k$ it vertex with a maximum prioirty. We will show that $w_k \in M$. By Lemma.~\ref{lemma:minimalplayOddwinning} we know $\chi(w_k)$ is odd. Furthermore, we have observed in \ref{eq:obs} that $w_k \in Y_m^\1$ for all $m > \chi(w_k)$. 
%     If we can show that $w_k \in Y_m^\1$ also for $m < \chi(w_k)$, then clearly $w_k \in M$. We will now show this. 
%     Assume to the contrary that $w_k \not \in M$ and let $j$ be the largest non-trivial index of $\rank{w_k}$. 
%     That is $j < l$ is the largest even integer such that $w_k \not \in Y_j^\1$. Let $t$ be the value of this index, i.e. $w_k \in Y_j^{0,\ldots, 0,t} \setminus Y_j^{0,\ldots, 0,{t-1}}$. 
%     Let us denote $Y_j^{0, \ldots, 0, t}$ by $Y_j^\te$ for short. 
%     
%     Since $\delta$ is minimal, Obs.~\ref{obs:v-Even-Odd-inequalities} gives us $\rank{w_i} \geq_{l+1 - \chi(w_i)} \rank{w_{i+1}}$ for all $w_i \in \delta$. Since $\chi(w_i) \leq \chi(w_k)$ for all $i$ and $\chi(w_k) < j$; $\rank{w_i} \geq_{l+1-j} \rank{w_{i+1}}$ for all $w_i \in \delta$. 
%     Since $\delta$ is a cycle, thise implies $\rank{w} =_{l+1-j} \rank{w'}$ for all $w, w'\in \delta$. This gives us that, for all $w\in \delta$, $w \in Y_j^\te \setminus Y_j^{\mathbf{t-1}}$.
% 
%     We can follow the same steps in equation~\eqref{eq:Ym1} to observe that 
%   $\forall (v,w)$ in $\Sc^{\mathcal{G}^\ell}$, $w \in \Npre(Y^{\mathbf{t-1}}_j, Y^\te_j) = \Cpre_\Odd(Y^\te_j) \cap (V_\Even \cup \Lpre^\forall(Y^\te_j) \cup Pre^\exists_\Odd(Y^\mathbf{t-1}_j))$.
%   If $w \in Pre^\exists_\Odd(Y_j^{\mathbf{t-1}})$, since $\delta$ is a minimal cycle, $\delta$ will have an element from $Y_j^{\mathbf{t-1}}$. However, this contradicts our observation that $\delta$ lies in $Y_j^\te \setminus Y_j^{\mathbf{t-1}}$.
%   On the other hand if non of the $w \in \delta $ lie in $ Pre^\exists_\Odd(Y_j^{\mathbf{t-1}})$ this implies that they all get into the formula due to reaching other nodes in $Y_j^\te \setminus Y_j^\mathbf{t-1}$. This is not possible since a node in $\delta$ has to be added to $Y_j^\te \setminus Y_j^\mathbf{t-1}$ as the first node and thus, have to have a successor in $Y_j^\mathbf{t-1}$. % while $Y_j^\te \setminus Y_j^{\mathbf{t-1}}$ is empty.
%     Therefore, $w_k\in M$.
% 
% %    We are now ready to prove the main theorem.
% %    \begin{proof}[Proof of Thm. \ref{thm:mainresult}]
% %         Let $\pi= v_0v_1\ldots$ be a play compliant with $\Sc^{\mathcal{G}^\ell}$ and $v_0 \in \Wo$. %Since all plays compliant with \Odd strategy templates obey the fairness condition, we only need to show that the maximum prioirty in $\pi$ is odd.
% %         Since $\pi$ is compliant with an \Odd strategy template, it obeys the fairness condition. 
% %         The fact that $\pi$ visits minimal cycles infinitely often follows from the fact that whenever a $v \in V_\Odd$ is seen infinitely often in $\pi$, $(v, v_{min})$ should be seen infinitely often as well.
% %         This gives by induction that, a minimal cycle that passes through $v$ should be visited infinitely often. Due to Prop.~\ref{prop:minimal-play-visits-M}, we know that therefore, $\pi$ visits $M$ infinitely often. Since $M$ is finite, $\pi$ visits a $x \in M$ infinitely often. Thus, a tail of $\pi$ can be seen as consecutive cycles over $x$. Since by Prop.~\ref{prop:cycle-through-M}, all cycles that pass through $M$ are \Odd winning, $\pi$ is \Odd winning.  
% %     \end{proof}
