\section{Conclusion}

In this paper, we propose a multi-stage probabilistic trajectory predictor: displacement space 
transformation, clustering stage, proposals generation, and ranking proposals.
At the clustering stage, we propose a novel trajectory clustering method (FP SC-GAN) based on deep features from a 
GAN framework. We also propose distance-based ranking proposals methods for assigning probabilities to the predictions.

We test our methods in two settings: train-test split and leave-one-dataset-out. The former 
comprise human and road agents' trajectory data, while the latter only address pedestrians' trajectory data. 
Experimental results show that our system surpasses the multimodal generative baselines (with \emph{k-variety loss})
in Top-3 ADE/FDE scores. It also performs equally or better than context-free generative baselines in Top-1 ADE/FDE scores. Moreover, the proposed 
clustering method copes better with distributional shifts (HOTEL dataset) than traditional clustering methods.
Finally, our ranking proposals methods based on distance similarity measures perform globally better than auxiliary deep neural 
networks. It is even more remarkable since these mechanisms do not require training an additional neural network and 
run in \emph{linear time}, while a constant-width MLP runs in \emph{quadratic time}.