\begin{algorithm}[tbp]
\caption{Composite sampling (control-switch)}
\label{alg:composite_sampling-cs}
\textbf{Input}: $\pi^\src$, $\pi^\targ$\\
\textbf{Initialize}: $\mathcal{D}^\src \leftarrow \emptyset$, $\mathcal{D}^\targ \leftarrow \emptyset$\\
\textbf{Output}: $\pib$
\begin{algorithmic}[1]
\FOR{each iteration}
\STATE $b \leftarrow \targ$ \COMMENT{Start sampling from the student} \label{line:StuSam-cs}
\STATE \emph{control-switch}$(t)$ $\leftarrow \mathit{false}$
        \FOR{each environment step} 
            \STATE $a_t \sim \pib(\cdot \mid s_t)$
            \STATE $ E \leftarrow (s_t,a_t,r^\targ_t,r^\src_t,c_t,\mathcal{I}_t,s_{t+1})$ \COMMENT{Generate experience}
            \IF{$b = \src$} \label{line:save_experience_begin}
            \STATE $\mathcal{D}^\src\leftarrow  \mathcal{D}^\src \cup \{E \}$ \COMMENT{Save the guide samples}
            \ELSE
            \STATE $\mathcal{D}^\targ\leftarrow  \mathcal{D}^\targ \cup \{E \}$ \COMMENT{Save the student samples}
            \ENDIF \label{line:save_experience_end}
            \IF{$\neg$ \emph{control-switch}$(t)$ $\wedge$ $c_t > 0$} \label{line:switch_control_begin}
            \STATE $b \leftarrow \src$ \COMMENT{Switch behaviour policy}
            \STATE \emph{control-switch}$(t)$ $\leftarrow \mathit{true}$ 
                \label{line:switch_control_end}
            \ENDIF 
        \ENDFOR
        \ENDFOR
\end{algorithmic}
\end{algorithm}