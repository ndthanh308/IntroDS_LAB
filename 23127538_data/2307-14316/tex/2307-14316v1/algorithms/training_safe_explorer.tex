\begin{algorithm}[h]
\caption{Maximum exploration RL for \textit{safe guide}}
\label{alg:safe-explorer}
\textbf{Input}: $\mathcal{M}^\src$, $\alpha$, $d$\\
\textbf{Initialize}: $\mathcal{D} \leftarrow \emptyset$, $\theta^\src_\chi \text{ for } \chi \in \{\pi,R,C,\beta\}$\\
\textbf{Output}: Optimized parameters $\theta^\src_\pi$ for $\pi^\src$

\begin{algorithmic}[1] %
\FOR{each iteration} 
    \FOR{each environment step}\label{lst:env_step_begin}
        \STATE $a_t \sim \pi^\src(\cdot \mid s_t)$
        \STATE $s_{t+1} \sim \mathcal{P}(\cdot \mid s_t,a_t)$
        \STATE $r^\delta_t \leftarrow \delta(f^\ddagger(s_t),f^\ddagger(s_{t+1}))$ \COMMENT{Auxiliary task \eqref{eq:DefAuxRew}}
        \STATE $c^\src_t \leftarrow c^\src(s_t,a_t)$
        \STATE $\mathcal{D}\leftarrow  \mathcal{D} \cup \{(s_t,a_t,r^\delta_t,c^\src_t,s_{t+1}) \}$
        \COMMENT{Replay buffer}
        \ENDFOR\label{lst:env_step_end}
        \FOR{each gradient step}\label{lst:update_begin}
        \STATE Sample experience from replay buffer $\mathcal{D}$
        \FOR{$\chi \in \{\pi,R,C,\beta\}$}
        \STATE $\theta^\src_\chi \leftarrow \theta^\src_\chi - \eta_\chi \hat{\nabla}_{\theta^\src_\chi} J_{\chi}(\theta^\src_\chi) $ \COMMENT{Parameter updating}
        \ENDFOR
    \ENDFOR{\label{lst:update_end}}
\ENDFOR \label{lastline}

\end{algorithmic}
\end{algorithm}
