

\documentclass[12pt,leqno,letterpaper]{article}

\usepackage{amsmath,amsthm,enumerate,amssymb}
\usepackage[utf8]{inputenc}

\usepackage[english]{babel}
%\usepackage{graphicx}
%\usepackage{color}
 
 



%\usepackage{graphicx}

\newtheorem{theorem}{Theorem}[section]
\newtheorem{proposition}[theorem]{Proposition}
\newtheorem{lemma}[theorem]{Lemma}
\newtheorem{corollary}[theorem]{Corollary}
\newtheorem{definition}[theorem]{Definition}
\newtheorem{conjecture}[theorem]{Conjecture}
\newtheorem{remark}[theorem]{Remark}
\newtheorem{example}[theorem]{Example}


\newcommand{\tr}{{\rm Tr\hskip -0.2em}~}
   \newcommand{\df}[2]{\frac{d#1}{d#2}}


\begin{document}

\title{Geometric properties for a class of deformed trace functions}
\author{Frank Hansen}
\date{}


\maketitle

\begin{abstract} We investigate geometric properties for a class of trace functions expressed in terms of the deformed logarithmic and exponential functions. These trace functions and their properties may be of independent interest, but we use them in this paper to extend earlier results of Beklan, Carlen and Lieb.
\\[1ex]them 
{\bf MSC2010} classification: 47A63; 15A90\\[1ex]
{\bf{Key words and phrases:}}  trace function, deformed trace function, convexity, entropy.
\end{abstract}



\section{Preliminaries}


Tsallis~\cite{tsallis:2009} generalised in 1988 the standard Bolzmann-Gibbs entropy to a non-extensive quantity $ S_q $ depending on a parameter $ q. $ In the quantum version it is given by
\[
S_q(\rho)=\frac{1-\tr\rho^q}{q-1}\qquad q\ne 1,
\]
where $ \rho $ is a density matrix. It has the property that
$
S_q(\rho)\to S(\rho)
$
for $ q\to 1, $ where $ S(\rho)=-\tr\rho\log\rho $ is the von Neumann entropy. 

\subsection{The deformed logarithm and exponential}
The Tsallis entropy may be written on a similar form
\[
S_q(\rho)=-\tr\rho\log_q(\rho),
\]
where the deformed logarithm $ \log_q $ defined for positive $ x $ is given by
\[
\log_q x=\int_1^x  t^{q-2}\,dt = \left\{\begin{array}{ll}
                                                         \displaystyle\frac{x^{q-1}-1}{q-1}\quad &q\ne 1\\[2.5ex]
                                                         \log x                                 &q=1.
                                                         \end{array}\right.
\]
The deformed logarithm is also denoted the $ q $-logarithm. The range of the $ q $-logarithm is given by the intervals
\[
\begin{array}{ll}
 \bigl(-(q-1)^{-1}, \infty\bigr)\quad&\text{for}\quad q>1\\[1.5ex]
  \bigl(-\infty, -(q-1)^{-1}\bigr)&\text{for}\quad q<1\\[1.5ex]
  \bigl(-\infty,\infty\bigr)&\text{for}\quad q=1.
 \end{array}
 \]
 The inverse function $ \exp_q $ (denoted the $ q $-exponential) is always positive and given by 
\[
\exp_q(x)=
\left\{\begin{array}{ll}
(x(q-1)+1)^{1/(q-1)}\quad&\text{for $ q>1 $ and $x>-(q-1)^{-1} $}\\[1.5ex]
(x(q-1)+1)^{1/(q-1)}\quad&\text{for $ q<1 $ and $x<-(q-1)^{-1} $}\\[1.5ex]
\exp x \quad&\text{for $ q=1$ and  $x\in\mathbf R. $ }
\end{array}\right.
\]
The $ q $-logarithm and the $ q $-exponential functions converge, respectively, to the logarithmic and the exponential functions for $ q\to 1. $
We note that
\begin{equation}\label{derivative of $ q-exponential}
\df{}{x}\log_q(x)=x^{q-2}\qquad\text{and}\qquad \df{}{x}\exp_q(x)=\exp_q(x)^{2-q}\,.
\end{equation}
We will also need the following lemma.

\begin{lemma}
Take arbitrary $ q\in\mathbf R. $ Independent of $ x> 0, $ we have
\[
\log_q x^p=p \log_\alpha x,
\]
where $ \alpha=1+p(q-1). $ Furthermore, take arbitrary $ q $ and set   $ \beta=1+(q-1)/p $ for $ p\ne 0. $ For any $ x\in\mathbf R $ in the domain of $ \exp_q\,, $ we obtain that $ px $ is in the domain of $ \exp_\beta $ and that
\[
(\exp_q x)^p=\exp_\beta(p x).
\]
\end{lemma}

\begin{proof}
We substitute $ u=t^{1/p} $ (thus $ t=u^p) $ in
\[
\log_q x^p=\int_1^{x^p} t^{q-2}\,dt
\]
and note that $ du=p^{-1} t^{(1-p)/p}\, dt. $ Therefore, $ dt=p t^{(p-1)/p}\, du $ and thus
\[
\log_q x^p=\int_1^x u^{p(q-2)} p u^{p-1}\,du=p\int_1^x u^{p(q-1)-1}\, du.
\]
Since $ p(q-1)-1=p(q-1)+1-2=\alpha-2, $ the first statement follows. The definition of $ \beta $ implies $ p/(1-q)=1/(1-\beta). $ There are now four cases depending on $ p>0, $ $ p<0, $ $ q>1 $ and $ q<1. $ In all four cases it follows that $ px $ is in the domain of $ \exp_\beta. $ We finally obtain from the first result in the lemma that
\[
\log_\beta(\exp_q x)^p=p\log_q(\exp_q x) =px
\]
and therefore $ (\exp_q x)^p = \exp_\beta(px). $
\end{proof}


\subsection{Convexity and min-max theorems}

The following results are well-know in convexity theory and very elementary. Since they play a pivotal role in this paper we provide the proofs as a convenience to the reader.

\begin{lemma} Let $ f\colon X\times Y\to \mathbf R $ be a function of two variable and set 
\[
g(x)=\inf_{y\in Y} f(x,y)\quad\text{and}\quad h(x)=\sup_{y\in Y} f(x,y)
\]
for $ x\in X. $

\begin{enumerate}[(i)]

\item If $ f(x,y) $ is jointly convex, then $ g $ is convex.

\item If $ f(x,y) $ is convex in the first variable, then $ h $ is convex.



\end{enumerate}

\end{lemma}

\begin{proof}
Take $ \varepsilon>0 $ and elements $ x_1,x_2\in X. $ Pick $ y_1,y_2\in Y $ such that
\[
g(x_1)\ge f(x_1,y_1)+\varepsilon\quad\text{and}\quad g(x_2)\ge f(x_2,y_2)+\varepsilon.
\]
Then
\[
\begin{array}{l}
g(\lambda x_1+(1-\lambda) x_2)\le f(\lambda x_1+(1-\lambda) x_2, \lambda y_1+(1-\lambda) y_2)\\[1.5ex]
\le\lambda f(x_1,y_1)+(1-\lambda) f(x_2,y_2)\le \lambda g(x_1)+(1-\lambda) g(x_2) -\varepsilon,
\end{array}
\]
so $ g $ is convex. Pick to $ \lambda x_1+(1-\lambda)x_2\in X $ and $ \varepsilon >0 $ an element $ z\in Y $ such that
\[
h(\lambda x_1+(1-\lambda) x_2) \le f(\lambda x_1+(1-\lambda) x_2, z)+\varepsilon.
\]
Then
\[
\begin{array}{l}
h(\lambda x_1+(1-\lambda) x_2)\le \lambda f(x_1,z)+(1-\lambda) f(x_2,z)+\varepsilon\\[1.5ex]
\le \lambda h(x_1)+(1-\lambda)h(x_2)+\varepsilon,
\end{array}
\]
so $ h $ is convex.
\end{proof}



\subsection{The Young tracial inequalities} 

The following inequalities are known as the tracial Young inequalities. We prefer to prove them as below.

\begin{proposition}\label{basic tracial inequalities}
Let $ A $ and $ B $ be positive definite matrices. Then
\[
\tr A^p B^{1-p} \le p\tr A+(1-p)\tr B\qquad 0\le p\le 1
\]
and
\[
\tr A^p B^{1-p} \ge p\tr A+(1-p)\tr B\qquad p\le 0, \,  p\ge 1.
\]
\end{proposition}

\begin{proof}
Let first $ 0\le p\le 1. $ We may write
\[
\begin{array}{rl}
\tr A^pB^{1-p}&=\tr L_A^p R_B^{1-p} I=S_f^I(A,B)\\[1.5ex]
&\le\tr \bigl(pL_A+(1-p)R_B\bigr)I=p\tr A+(1-p)\tr B,
\end{array}
\]
where $ f(t)=t^p $ for $ t>0, $ and $ L_A $ and $ R_B $ are the left and right multiplication operators. The first equality above in terms of the quasi-entropy $ S_f^I(A,B) $ follows since $ L_A $ and $ R_B $ commute, and the first inequality in the proposition then follows from the geometric-arithmetic mean inequality. Since Jensen's inequality reverses for the extensions of a chord (corresponding to the cases $ p\le 0 $ or $ p\ge 1), $ the second inequality of the proposition follows.
\end{proof}





\section{Variational expressions}  

We take the following variational representations from our paper \cite[Lemma 2.1]{shi-hansen:2020} with a slightly simplified proof.


\begin{proposition}\label{first variational expression for the in terms of the deformed logarithm} 
For positive definite operators $X$ and $ Y$ we have
\[
\tr Y=\left\{
\begin{array}{ll}
\displaystyle\max_{X>0}\bigl\{\tr X-\tr X^{2-q}\left(\log_q X-\log_q Y\right)\bigr\}, \quad &q\le 2,\\[2.5ex]
\displaystyle\min_{X>0}\bigl\{\tr X-\tr X^{2-q}\left(\log_q X-\log_q Y\right)\bigr\},  &q>2.
\end{array}
\right.
\]
\end{proposition}


\begin{proof}  We learned in Proposition~\ref{basic tracial inequalities} that
\[
\begin{array}{rl}
\tr X^{p}Y^{1-p} &\le  p \tr X+(1-p)\tr Y,\qquad 0\le p\le 1,\\[2ex]
\tr X^{p}Y^{1-p} &\ge  p \tr X+(1-p)\tr Y,\qquad p\le 0,\, p\ge 1.
\end{array}
\]
By combining the first inequality for $ 0\le p<1 $ with the case $ p>1 $ in the second, we obtain
\[
\tr Y \ge \tr X-\frac{\tr X-\tr X^pY^{1-p}}{1-p}\,, \qquad p\ge 0,\, p\ne 1,
\]
while the case $ p\le 0 $ gives the inequality
\[
\tr Y \le \tr X-\frac{\tr X-\tr X^pY^{1-p}}{1-p}\,, \qquad p\le 0.
\]
For $X=Y$ the above inequalities become equalities.
Setting $ q=2-p, $ the first range ($ p\ge 0, $ $ p\ne 1) $ is transformed to the range $( q\le 2, $ $ q\ne 1), $ while the second range $ (p\le 0) $ is transformed to the range $ (q\ge 2). $ Since $ p=2-q $ and $ 1-p=q-1 $ we obtain
\[
\tr Y=\left\{
\begin{array}{ll}
\displaystyle\max_{X>0}\Bigl\{\tr X-\frac{\tr X^{2-q}\left(X^{q-1}-Y^{q-1}\right)}{q-1}\Bigr\}, \quad & q\in(-\infty,2],\, q\ne 1, \\[2.5ex]
\displaystyle\min_{X>0}\Bigl\{\tr X-\frac{\tr X^{2-q}\left(X^{q-1}-Y^{q-1}\right)}{q-1}\Bigr\}, &q\in [2,\infty).
\end{array}
\right.
\]
By using the definition of the deformed logarithm we note that
\[
\frac{X^{q-1}-Y^{q-1}}{q-1}=\log_q(X)-\log_q(Y),
\]
and by inserting this in the expressions above, we obtain the desired statements of the proposition, except for $ q=1. $ 
We may finally let $ q $ tend to one in the first inequality and obtain the variational expression
\[
\tr Y=\max_{X>0}\Bigl\{\tr X-{\tr X\left(\log X-\log Y\right)}\Bigr\}
\]
by continuity. This completes the proof.
\end{proof}

Note that the last statement in the above proof entails the inequality 
\[
S(X\mid Y)\ge \tr (X-Y)
\]
for the relative quantum entropy $ S(X\mid Y). $


\section{Main results}  

Let $ H $ be an invertible contraction and $ A $ positive definite. Take $ q\ne 1 $ and set $ \beta=1+(p-1)/q\,. $
Since $ A $ is positive definite, it follows that 
\[
H^*\log_p(A)H > \frac{-1}{p-1}H^*H\ge \frac{-1}{p-1}\quad\text{for}\quad p>1
\]
and
\[
H^*\log_p(A)H < \frac{-1}{p-1}H^*H\le \frac{-1}{p-1}\quad\text{for}\quad p<1.
\]
We may therefore in both cases apply $ \exp_p $ to $ H^*\log_p(A)H. $ Thus
\[
Y=\exp_p\bigl(H^*\log_p(A)H\bigr)
\]
is well-defined and positive, and we set
\begin{equation}\label{Main deformed trace function}
\varphi_{p,q}(A)= \tr Y^q=\tr\left(\exp_p\bigl(H^*\log_p(A)H\bigr)\right)^q.
\end{equation}
Since $ (\exp_p x)^q=\exp_\beta(q x) $ we obtain
\[
Y^q=\left(\exp_p\bigl(H^*\log_p(A)H\bigr)\right)^q=\exp_\beta\bigl(q H^*\log_p(A)H\bigr).
\]
We define and calculate for positive definite $ X $ and $ A $ the function
\[
\begin{array}{l}
F(X,A)=\tr X-\tr X^{2-\beta}\left(\log_\beta X-\log_\beta Y^q\right)\\[2ex]
=\tr X-\tr X^{2-\beta}\left(\log_\beta X-q H^*\log_p(A) H\right)\\[2ex]
=\displaystyle \tr X-\tr X^{2-\beta}\left(\frac{X^{\beta-1}-I}{\beta-1}-qH^*\frac{A^{p-1}-I}{p-1}H\right)\\[3ex]
=\displaystyle \tr X-\frac{1}{\beta-1}\tr\bigl(X-X^{2-\beta}-X^{2-\beta}H^*(A^{p-1}-I)H\bigr)\\[3ex]
=\displaystyle\left(1-\frac{1}{\beta-1}\right)\tr X+\frac{1}{\beta-1}\tr \Bigl(X^{2-\beta}(I-H^*H)+ X^{2-\beta}H^* A^{p-1}H\Bigr),
\end{array}
\]
where we used that $ q/(p-1)=1/(\beta-1)\,. $ 
By replacing $ q $ with $ \beta $ in Proposition~\ref{first variational expression for the in terms of the deformed logarithm} 
we then obtain
\[
\varphi_{p,q}(A)=\left\{
\begin{array}{ll}
\displaystyle\sup_{X>0} F(X,A) \quad &\beta\le 2,\\[2.5ex]
\displaystyle\inf_{X>0} F(X,A)  &\beta>2.
\end{array}
\right.
\]
We next determine parameter values $ p $ and $ q $ such that $ F(X,A) $ is either (jointly) concave/convex or concave/convex in the second variable. To do this we use that the functions $ t\to t^p $ are operator concave, if and only if $ 0\le p\le 1, $ and operator convex, if and only if $ -1\le p\le 0 $ or $ 1\le p\le 2. $ It may be of interest to note that the same parameter conditions apply, if we only require matrix convexity or matrix concavity of order two, cf. \cite[Proposition 3.1]{hansen:2009:2}.
We also make use of Lieb's concavity theorem \cite[Corollary 1.1]{lieb:1973:1}  stating that the trace functions
\begin{equation}\label{Ando's and Lieb's trace functions}
(X,A)\to\tr X^p H^* A^q H
\end{equation}
are concave if $ p,q\ge 0 $ and $ p+q\le 1. $ Ando's theorem states \cite[Corollary 6.3]{ando:1979} that the trace functions in (\ref{Ando's and Lieb's trace functions}), for an arbitrary matrix $ H, $ are convex for either $ -1\le p,q\le 0 $ or for
\[
 \quad -1\le p\le 0\quad\text{and}\quad 1-p\le q\le 2,
\]
where obviously $ p $ and $ q $ may be interchanged in the condition.
Since $ H=I $ is a possibility, we realise that concavity of $ \varphi_{p,q} $ requires $ 0\le q\le 1, $ while convexity of $ \varphi_{p,q} $ requires $ q\le 0 $ or $ q\ge 1. $

Since we intend to eventually use operator convexity/concavity of the function $ t\to t^p, $   we are restricted to the cases
\[
-1\le p-1\le 2\quad\text{or equivalently}\quad 0\le p\le 3.
\]
Note that if $ \beta=1, $ then $ p=1. $ 
We next determine parameter values $ p $ and $ q $ that impart convexity or concavity of $ \varphi_{p,q}\,. $\\[1ex]
\noindent\textbf{Convexity} (Necessarily $ q\le 0 $ or $ q\ge 1) $  

\begin{enumerate}[(i)]

\item $ \beta<1 $ 

To impart convexity on $ \varphi_{p,q} $ for $ \beta\le 2, $ it is sufficient to show that $ F(X,A) $ is convex in the second variable.  Since $ \beta<1, $ it is equivalent to $ 0\le p-1\le 1, $ that is $ 1\le p\le 2. $ Inserting $ \beta $ we obtain
\[
1+\frac{p-1}{q}<1\quad\text{equivalent to}\quad\frac{p-1}{q}< 0.
\]
This is satisfied only for $ q< 0. $ In conclusion, $ \varphi_{p,q} $ is convex for $ 1\le p\le 2 $ and $ q\le 0. $ $( \varphi $ is constant for $ q=0). $

\item $ 1<\beta\le 2 $  

Convexity of $ F(X,A) $ in the second variable is equivalent to
\[
-1\le p-1\le 0\quad\text{or}\quad 1\le p-1\le 2,
\]
equivalent to $ 0\le p\le 1 $ or $ 2\le p\le 3. $ 
Inserting $ \beta $ we obtain
\[
1< 1+\frac{p-1}{q}\le 2\quad\text{equivalent to}\quad 0< \frac{p-1}{q}\le 1.
\]
If  $ 0\le p< 1 $ this is satisfied for $ q\le p-1. $  If $ 2\le p\le 3 $ it is satisfied for $ p-1\le q. $
 In conclusion, $ \varphi_{p,q} $ is convex for $ 0\le p\le 1 $ and $ q\le p-1, $ or for $ 2\le p\le 3 $ and $ p-1\le q. $ 

\item $ 2\le\beta $ 

To impart convexity on $ \varphi_{p,q} $ we have to show that $ F(X,A) $ is (jointly) convex. Since $ \beta>1, $ and considering the second term, this requires
$ -1\le 2-\beta\le 0 $ or $ 1\le 2-\beta\le 2. $ The second case is not possible, thus $ 2\le\beta\le 3. $ Inserting $ \beta $ we obtain
\[
2\le 1+\frac{p-1}{q}\le 3\quad\text{equivalent to}\quad 1\le \frac{p-1}{q}\le 2.
\]
 Under this condition $ F(X,A) $ is (jointly) convex if either
\begin{enumerate}

\item $ 1-(2-\beta)\le p-1\le 2 $ 

\item $ -1\le p-1\le 0. $

\end{enumerate}

Condition (a) is equivalent to  $ \beta\le p\le 3. $ This excludes $ q<0 $ but is satisfied for $ 1\le q\le p-1. $ Take now $ 2\le p\le 3 $ and assume  $ 1\le q\le p-1. $ Then $ \beta=1+(p-1)/q \le p. $  Therefore, $ \varphi_{p,q} $ is convex for $ 2\le p\le 3 $ and $ 1\le q\le p-1. $ 

Condition (b) is equivalent to $ 0\le p\le 1. $ This excludes $ q\ge 1 $ but is satisfied for negative $ q $ with $ 2q+1\le p\le 1+q. $ Therefore, $ \varphi_{p,q} $ is convex for $ 0\le p\le 1 $ and $ 2q+1\le p\le q+1. $ 



\end{enumerate}

\noindent\textbf{Concavity} (Necessarily $ 0\le q\le 1) $   

\begin{enumerate}[(i)]

\setcounter{enumi}{3}

\item $ \beta<1 $  

To impart concavity on $ \varphi_{p,q} $ for $ \beta\le 2, $ we must show that $ F(X,A) $ is (jointly) concave. Since in addition we assume $ \beta <1, $ the second term in $ F(X,A) $  requires that
\[
1< 2-\beta\le 2 \quad\text{or}\quad  -1\le 2-\beta\le 0. 
\]
The last case is not possible, so $ 0\le\beta< 1. $ To apply Ando's convexity theorem, we must also impose the conditions
 \[
 -1\le p-1\le 0\quad\text{and}\quad 1-(p-1)\le 2-\beta\le 2
 \]
 implying that $ 0<\beta\le p\le 1. $
 Inserting $ \beta $ we obtain
\[
0\le 1+\frac{p-1}{q}\le p\le 1\quad\text{equivalent to}\quad\frac{p-1}{q}\le p-1\le 0,
\]
which is satisfied for all $ 0<q\le 1 $ and $ 0\le p<1. $  Since we for these values of $ p $ and $ q $ automatically obtain
$
\beta=1+(p-1)/q\le p,
$
it follows that  $ \varphi_{p,q} $ is concave for $ 0\le p\le 1 $ and $ 0\le q\le 1. $


\item $ 1<\beta\le 2 $  

Joint concavity of $ F(X,A) $ requires $ 0\le 2-\beta\le 1 $ which is satisfied. In addition, we must have $ 0\le p-1\le 1 $ equivalent to $ 1\le p\le 2. $ Inserting $ \beta $ we obtain
\[
1< 1+\frac{p-1}{q}\le 2\quad\text{equivalent to}\quad 0< \frac{p-1}{q}\le 1.
\]
This is satisfied for $ p-1\le q\le 1. $ In conclusion, $ \varphi_{p,q} $ is concave for $ 1\le p\le 2 $ and $ p-1\le q\le 1. $ 

\item $ 2<\beta $   

Concavity of $ \varphi_{p,q} $ only requires that $ F(X,A) $ is concave in the second variable, and since $ \beta>1 $ this is equivalent to $ 0\le p-1\le 1 $ or $ 1\le p\le 2. $ Inserting $ \beta $ we obtain
\[
2< 1+\frac{p-1}{q}\quad\text{equivalent to}\quad 1< \frac{p-1}{q}
\]
and this is satisfied for $ 0< q< p-1. $ In conclusion, $ \varphi_{p,q} $ is concave for $ 1\le p\le 2 $ and $ 0\le q \le p-1. $ 

\end{enumerate}


Note that we under $ (i), (ii), (iv) $ and $ (v) $ in the preceding analysis used that $ \varphi_{p,q} $ is the partial maximisation of $ F(X,A) $ over positive definite $ X, $ while we in $ (iii) $ and $ (vi) $ used that $ \varphi_{p,q} $ is the partial minimisation of $ F(X,A). $ We have thus proved the following theorem.

\begin{theorem}  

The trace function $  \varphi_{p,q} $ defined in (\ref{Main deformed trace function}) has the following geometric properties depending on the parameters $ p $ and $ q. $

\begin{enumerate}[(i)]


\item $ \varphi_{p,q}(A) $ is concave in positive definite $ A $  for the parameter values
\[
\begin{array}{lll}

 0\le p\le 2\quad &\text{and}\quad  &0\le q\le 1, 
\end{array}
\]

\item $ \varphi_{p,q}(A) $ is convex in positive definite $ A $ for the parameter values 
\[
\begin{array}{lll}

 0\le p\le 1  \quad &\text{and}\quad  & q\le p-1 $\@ or \@ $ 2q\le p-1\le q,\\[1ex]

1\le p\le 2 \quad &\text{and}\quad  &q\le 0, \\[1ex]

2\le p\le 3  \quad &\text{and}\quad  & q\ge 1.
 
 \end{array}
 \]

\end{enumerate}

\end{theorem}

The special case $ q=1 $ was proved in \cite[Corollary 2.3 ]{shi-hansen:2020}.

\section{Extensions to several variables} 


\begin{theorem}\label{concavity (convexity) of deformed trace functions}
Let $ H_1,\dots,H_k $ be invertible matrices with $ H_1^*H_1 +\cdots+ H_k^*H_k\le I. $ The function
\begin{equation}\label{definition of varphi-function}
\varphi_{p,q}(A_1,\dots,A_k)=\tr\left(\exp_p\sum_{i=1}^k H_i^*\log_p(A_i) H_i\right)^q
\end{equation}
is well-defined in $ k $-tuples of positive definite matrices, and it has the same convexity/concavity properties (in terms of $ p $ and $ q) $ as it has for one variable.
\end{theorem}

\begin{proof}
Note that if $ p>1, $ then $ \log_p(A_i)> -(p-1)^{-1} $ for $ i=1,\dots,k $  and therefore
\[
\sum_{i=1}^k H_i^*\log_p(A_i) H_i> \frac{-I}{p-1}\,,
\]
since the sum is a convex combination of $ k $ terms, possibly including zero, that all are majorising $ -(p-1)^{-1}\cdot I. $ The sum is thus  in the domain of $ \exp_p $ so $  \varphi_{p,q} $ is well-defined. A similar argument shows that  $  \varphi_{p,q} $ is well-defined also for $ p<1. $ We
introduce the $ k\times k $ block matrices
\[
\hat A=\begin{pmatrix}
     A_1     & 0     & \cdots   & 0\\
     0         & A_2 &             & 0\\
     \vdots &         & \ddots  & \vdots\\
     0        & 0       & \dots    & A_k
     \end{pmatrix},\quad
\hat H=\begin{pmatrix}
     H_1    & 0        & \cdots & 0\\
     H_2    & 0        & \cdots & 0\\
     \vdots & \vdots & \ddots & \vdots\\
     H_k    & 0         & \cdots & 0
     \end{pmatrix}
\]
with zero matrices of suitable orders inserted and note that $ \hat H $ is a contraction. Furthermore,
\[
\left(\exp_p\bigl(\hat H^* \log_p (\hat A) \hat H\bigr)\right)^q=\begin{pmatrix}
     \displaystyle \left(\exp_p \sum_{i=1}^k H_i^* \log_p (A_i) H_i \right)^q   & 0       & \cdots   & 0\\
     0                                                     & 1       &  \cdots  & 0\\
     \vdots                                             & \vdots & \ddots   & \vdots\\
     0                                                     & 0        & \dots     & 1
     \end{pmatrix}.
\]
Therefore,
\[
\tr\left(\exp_p\bigl(\hat H^*\log_p (\hat A) \hat H\bigr)\right)^q=\tr\left(\exp_p\sum_{i=1}^k H^*_i \log_p (A_i) H_i\right)^q +(k-1)n,
\]
and the statement follows.
\end{proof}



\section{Comparison with $ \Upsilon_{p,q} $} 

Carlen and Lieb considered the trace  functions
\begin{equation}\label{Upsilon function}
\Upsilon_{p,q}(A)=\tr \bigl(H^* A^p H\bigr)^{q/p}
\end{equation}
for arbitrary parameters $ p $ and $ q, $ 
where $ H $ is an arbitrary matrix and $ A $ is positive definite. Note that $ \varphi_{p,q} $ is defined only for invertible contractions $ H, $ while $ \Upsilon_{p,q} $ is well-defined without any restrictions on $ H. $
We may extend $ \Upsilon_{p,q} $ to several variables in the same way as we just extended $ \varphi_{p,q} $ to several variables and obtain that $ \Upsilon_{p,q }(A_1,\dots,A_k) $ has the same geometric properties as $ \Upsilon_{p,q}(A). $


\begin{theorem}
Let $ H_1, \dots,H_k $ be matrices such that 
\[
H_1^*H_1+\cdots+H_k^*H_k=I,
\]
and consider the functions $ \varphi_{p,q}(A_1,\dots,A_k) $ and $ \Upsilon_{p,q}(A_1,\dots,A_k) $ defined in positive definite
matrices $ A_1,\dots,A_k\,. $ Then $ \varphi_{p,q} $ has the same convexity/concavity properties (with respect to $ p $ and $ q) $
as have $ \Upsilon_{p-1,q}\,. $
\end{theorem}

\begin{proof}
Choose positive definite matrices $ A_1,\dots,A_k\,. $
For $ q\ne1 $ we obtain
\[
\begin{array}{l}
\displaystyle\left(\exp_p\sum_{i=1}^k H_i^*\log_p(A_i) H_i\right)^q
=\left(I+(p-1)\sum_{i=1}^k H_i^*\log_p(A_i)H_i\right)^{q/(p-1)}\\[4ex]
=\displaystyle \left(I+(p-1)\sum_{i=1}^k H_i^*\frac{A_i^{p-1}-I}{p-1}H_i\right)^{q/(p-1)}\\[4ex]
=\displaystyle \left(I+\sum_{i=1}^k H_i^*(A_i^{p-1} -I)H_i\right)^{q/(p-1)}\\[4ex]
=\displaystyle \bigl(H_1^* A_1^{p-1}H_1+\cdots+H_k^*A_k^{p-1}H_k\bigr)^{q/(p-1)},
\end{array}
\]
where we used $ H_1^*H_1 +\cdots+ H_k^*H_k=I $ in the calculation. 
\end{proof}

Since the concavity/convexity properties of $ \varphi_{p,q} $ and $ \Upsilon_{p,q} $ do not depend of the number of variables, we 
conclude that the concavity/convexity properties of $ \varphi_{p,q}(A) $ and $ \Upsilon_{p-1,q}(A) $ are the same. We have thus obtained the following result.

\begin{theorem}\label{Main theorem about Upsilo}   

The trace function $  \Upsilon_{p,q} $ defined in (\ref{Upsilon function}) has the following geometric properties depending on the parameters $ p $ and $ q. $

\begin{enumerate}[(i)]

\item $ \Upsilon_{p,q}(A) $ is concave in positive definite $ A $ for the parameter values
\[
\begin{array}{lll}

 -1\le p\le 1\quad &\text{and}\quad  &0\le q\le 1, 
 
\end{array}
\]

\item $ \Upsilon_{p,q}(A) $ is convex in positive definite $ A $ for the parameter values
\[
\begin{array}{rlllll}

 -1&\le &p\le 0  \quad &\text{and}\quad  &q\le p\text{\hskip 0.8em or \hskip 0.8em} 2q\le p\le q, \\[1ex]
0&\le &p\le 1 \quad &\text{and}\quad  &q\le 0, \\[1ex]

1&\le &p\le 2  \quad &\text{and}\quad  & q\ge 1.
 
 \end{array}
 \]

\end{enumerate}

\end{theorem}

Carlen and Lieb \cite[Theorem 1.1]{carlen:2008} proved that the trace functions $  \Upsilon_{p,q}(A)  $ are concave for $ 0\le p\le 1 $ and $ p\le q\le 1, $ and convex for $ 1\le p\le 2 $ and $ p\le q. $
By the very different method developed in this paper we recovered the previous results of Carlen and Lieb and added a number of more cases possibly exhausting all possible cases.


\section{Variant trace functions}

We may also consider trace functions of the form
\[
A\to \|(H^* A^p H)^{1/p}\|_q=\bigl(\tr (H^* A^p H)^{q/p}\bigr)^{1/q}=\Upsilon_{p,q}(A)^{1/q}
\]
for arbitrary $ H, $ where $ A $ is positive definite. Note that $ \|\cdot\|_q $ is a norm for $ q>0, $ and that $ \Upsilon_{p,q}(A) $ is homogeneous of degree $ q. $ Because of homogeneity it follows from the general theory of convexity that if $ \Upsilon_{p,q}(A) $ is convex or concave, so is $ \Upsilon_{p,q}(A)^{1/q}. $ By a general amplification argument we then obtain that the function
\[
\Phi_{p,q}(A_1,\dots,A_k)=\left\lVert\left(\sum_{i=1}^k A_i^p\right)^{1/p} \right\rVert_q
\]
is convex/concave for the same parameter values $ p,q $ as  $ \Upsilon_{p,q}\,. $  Indeed,  consider $ k\times k $ block matrices
\[
\hat A=\begin{pmatrix}
     A_1     & 0     & \cdots   & 0\\
     0         & A_2 &             & 0\\
     \vdots &         & \ddots  & \vdots\\
     0        & 0       & \dots    & A_k
     \end{pmatrix},\quad
\hat H=\begin{pmatrix}
     I    & 0        & \cdots & 0\\
     I    & 0        & \cdots & 0\\
     \vdots & \vdots & \ddots & \vdots\\
     I    & 0         & \cdots & 0
     \end{pmatrix}
\]
with zero matrices of suitable orders inserted. Since by calculation
\[
\Upsilon_{p,q}(\hat A)^{1/q}=\Bigl(\tr\bigl(\hat H^* \hat A^p \hat H\bigr)^{q/p}\Bigr)^{1/q}=\left(\tr\left(\sum_{i=1}^k A_i^p\right)^{q/p}\right)^{1/q},
\]
the statement follows. Bekjan \cite[Lemma 1]{Bekjan:2004} proved that $ \Phi_{p,q}(A_1,\dots,A_k) $ is concave for $ -1\le p\le 0 $ and $ q=1. $
\\[1ex]


\noindent\textbf{Declaration of conﬂict of interest} The author has no conﬂict of interest.\\[1ex]
\noindent\textbf{No datasets were generated or analysed during the current study.}


\begin{thebibliography}{1}

\bibitem{ando:1979}
T.~Ando.
\newblock Concavity of certain maps of positive definite matrices and
  applications to \uppercase{H}adamard products.
\newblock {\em Linear Algebra Appl.}, 26:203--241, 1979.

\bibitem{Bekjan:2004}
Turdebek~N. Bekjan.
\newblock On joint convexity of trace functions.
\newblock {\em Linear Algebra and Its Applications}, 390:321--327, 2004.

\bibitem{carlen:2008}
E.A. Carlen and E.H. Lieb.
\newblock A \uppercase{M}inkowsky type trace inequality and strong
  subadditivity of quantum entropy \uppercase{II}: \uppercase{C}onvexity and
  concavity.
\newblock {\em Lett. Math. Phys.}, 83:107--126, 2008.

\bibitem{hansen:2009:2}
Frank Hansen and Jun Tomiyama.
\newblock Differential analysis of matrix convex functions \uppercase{II}.
\newblock {\em Journal of Inequalities in Pure and Applied Mathematics},
  10(2):5 pp., 2009.

\bibitem{lieb:1973:1}
E.~Lieb.
\newblock Convex trace functions and the
  \uppercase{W}igner-\uppercase{Y}anase-\uppercase{D}yson conjecture.
\newblock {\em Advances in Math.}, 11:267--288, 1973.

\bibitem{shi-hansen:2020}
Guanghua Shi and Frank Hansen.
\newblock Variational representations related to tsallis relative entropy.
\newblock {\em Letters in Mathematical Physics}, 110:2203--2220, 2020.

\bibitem{tsallis:2009}
C.~Tsallis.
\newblock Nonadditive entropy and nonextensive statistical mechanics - an
  overview after 20 years.
\newblock {\em Brazilian Journal of Physics}, 39(2A):337--356, 2009.

\end{thebibliography}



%\bibliography{Mathharv}
%\bibliographystyle{plain}



\vfill

{\small
\noindent Frank Hansen: Department of Mathematical Sciences, Copenhagen University, Denmark.\\
Email: frank.hansen@math.ku.dk.
      }


\end{document}


