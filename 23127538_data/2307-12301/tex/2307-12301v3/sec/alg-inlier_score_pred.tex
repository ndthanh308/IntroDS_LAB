% \label{algorithm-inlier_score_pred}

% \SetKwComment{Comment}{/* }{ */}
\SetKwProg{Init}{init}{}{}
\SetKwFor{RepTimes}{repeat}{times}{end}
\SetKwInOut{Input}{Input}\SetKwInOut{Output}{Output}
% \RestyleAlgo{ruled}



% ----- Inlier Score Prediction ------

\begin{algorithm}[t]

\caption{Inlier Score Prediction (ISP)}
\label{alg:isp}


\Input{Embeddings $F = \{f_i\}_{i=1}^n, \Hquad f_i \in \mathbb{R}^d$\\
Sampling iterations $s$ \\
Sample size $m$\\
}
\Output{Inlier scores $\boldsymbol{\eta} = \{\eta_i\}_{i=1}^n, \Hquad \eta_i \in [0, 1]$}

\Init{}{
    $\boldsymbol{\eta} = \{ \eta_i \}_{i=1}^n$ where $\eta_i = 1$ \\
}

\RepTimes{$s$}{
    $\Tilde{I} \gets $ take $m$ samples from $F$\\
    \For{$i \gets 1$ to $n$}{
        $\alpha_i = \max{( \{ \cos{(f_i, \Tilde{f})} \mid \Tilde{f} \in \Tilde{I}\} )}$ \\
        $\eta_i \gets \min{( \eta_i,  \alpha_i)}$
    }
}

\Return{$\boldsymbol{\eta}$}
\end{algorithm}
