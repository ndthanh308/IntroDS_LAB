\documentclass[twocolumn,showpacs,preprintnumbers,amsmath,amssymb]{revtex4-2}

\include{preamble.tex}

\begin{document}

%\preprint{APS/123-QED}

\title{Fluid pendulum explains reversals of the large-scale circulation in thermal convection}


\author{Nicholas J. Moore$^1$}%
\email{nickmoore83@gmail.com}
\thanks{The authors contributed equally.}
\author{Jinzi Mac Huang$^{2,3}$}
\email{machuang@nyu.edu}
\thanks{The authors contributed equally.}
\affiliation{1. Department of Mathematics, Colgate University, Hamilton, NY 13346, USA\\
2. NYU-ECNU Institute of Physics and Institute of Mathematical Sciences, New York University Shanghai, Shanghai, 200122, China \\
3. Applied Math Lab, Courant Institute, New York University, New York, NY 10012, USA
}%

\date{\today}
\begin{abstract}
We introduce a low-dimensional dynamical system to describe thermal convection in an annulus. The model derives systematically from a Fourier-Laurent truncation of the governing Navier-Stokes Boussinesq equations with no adjustable parameters and with the ability to generalize to any order. Comparison with fully resolved numerical solutions shows that the leading-order model captures parameter bifurcations and reversals of the large-scale circulation (LSC)  with quantitative accuracy, including states of (i) steady circulating flow, (ii) chaotic LSC reversals, and (iii) periodic LSC reversals. Casting the system in terms of the fluid's angular momentum and center of mass (CoM) reveals equivalence to a damped pendulum with forcing that raises the CoM above the fulcrum. This formulation offers a transparent mechanism for LSC reversals, namely the inertial overshoot of a driven pendulum, and it yields accurate predictions for the frequency of regular LSC reversals in the high Rayleigh-number limit.
\end{abstract}

% Abstract: PRL requires < 600 characters.

%\keywords{Suggested keywords}
%Use showkeys class option if keyword; %display desired
\maketitle

Thermal convection and the associated large-scale circulation (LSC) play an instrumental role in applications diverse as atmospheric and oceanic flow patterns \cite{Salmon1998, Zhong2009}, mantle convection \cite{Whitehead1972, Zhong2005, Whitehead2015, mac2018stochastic}, and solar magneto-hydrodynamics \cite{Wit2020}. In all of these settings, it is known that the LSC is prone to spontaneously reverse direction, manifesting, for example, as a sudden change in wind direction \cite{Doorn2000} or potentially a reversal of the Earth's magnetic dipole \cite{Glatzmaier1999}.

LSC reversals have been observed in controlled laboratory experiments \cite{Gorman1986, Brown2005, Brown2007, Xi2007, Sugiyama2010, Wang2018, Chen2019} and analyzed theoretically, going back to the famous Lorenz system describing thermal convection in a planar domain \cite{Lorenz1963}. Studies conducted in idealized geometries, e.g.~rectangular, cylindrical, or annular, show a sequence of transitions as the Rayleigh number increases. In the case of an annular domain, the sequence includes: (1) a stable conductive state with no fluid motion; (2) steady circulatory flow in either the clockwise (CW) or counter-clockwise (CCW) direction; (3) non-periodic dynamics and chaotic LSC reversals; (4) a high-Ra state in which LSC reversals recur periodically despite turbulent fluctuations at the small scale.

The classic Lorenz system has been shown to qualitatively reproduce many of these transitions \cite{Tritton1988, Gorman1986, Widmann1989, Ehrhard1990, Singer1991}, while more recent phenomenological models have lent further insight \cite{Araujo2005, Brown2007, Ni2015}. Often, these models conjecture additional terms to represent various physical effects. Such terms, while they may increase the predictive capacity via adjustable parameters, can obscure the connection with the governing equations. Ideally, a model for LSC reversals would achieve the following: \\
1.~Derive systematically from the governing equations, free of adjustable parameters and  conjectured terms, and with the ability to generalize to arbitrary order. \\
2.~Predict the parameter bifurcations listed above with quantitative accuracy; predict the frequency of regular LSC reversals in the high-Ra regime. \\
3.~Offer new physical insight into the complex process of LSC reversals.


This letter, together with its companion paper \cite{PRF2023}, describe a framework for thermal convection in an annulus that achieves these objectives. The framework derives systematically from a Fourier-Laurent truncation of the governing Navier-Stokes-Boussinesq (NSB) equations, with no adjustable parameters, and with the order of truncation corresponding to the accuracy of the model. Comparison with fully-resolved direct numerical simulations shows that the leading-order, three-dimensional system predicts the sequence of transitions, including LSC reversals, with quantitative accuracy. 

Casting the system in terms of the fluid's average angular momentum and center of mass (CoM) reveals equivalence to a damped, driven pendulum, with forcing that drives the CoM above the fulcrum. With this reformulation, a simple physical picture emerges. The driving term, since it raises the CoM,  tends to destabilize the system and, depending on the relative strengths of driving, damping, and restoring, leads to a range of different convective states.
This physical picture: 
(1) offers a parsimonious explanation for LSC reversals, namely the inertial overshoot of a damped, driven pendulum;
(2) yields accurate predictions for the frequency of regular LSC reversals in the high Rayleigh-number regime.





% Figure environment removed

\Cref{fig1}(a) depicts the problem setup in which a 2D annular fluid domain is heated from below \cite{Tritton1988, Gorman1986, Ehrhard1990}. Thermal exchange occurs along the outer boundary with an imposed temperature that decreases linearly with height, while the inner boundary remains adiabatic. We note that the annular geometry tends to reinforce the dominant circular flow pattern of thermal convection that appears generically across many settings, thus permitting one to isolate the main mechanism for LSC reversals.

Dimensionless temperature $T$, velocity $\uu$, and pressure $p$ fields are governed by the incompressible NSB equations
\begin{align}
\label{NS}
& \pd{\uu}{t} + \uu \cdot \grad \uu = -\grad p +
\Pr \Lap \uu + \Ra\, \Pra \, T \bvec{e_y}, \\
\label{tran_incomp}
& \pd{T}{t} + \uu \cdot \grad T = \Lap T, \quad
\grad \cdot \uu = 0 ,
\end{align}
which hold in the dimensionless annulus, $r_0<r<1/2$. Both the inner and outer rings are no-slip boundaries. Parameters include the Rayleigh number $\Ra$ and Prandtl number $\Pra$ \cite{PRF2023}. When the thermal forcing is sufficiently strong ($\Ra$ sufficiently high) the destabilizing action of buoyancy can give rise to natural convection. To quantify different convective states, we will examine the spatially-averaged {\em fluid angular momentum} $L(t)$, with $L>0$ corresponding to CCW rotation. 

The range of convective states are revealed by direct numerical simulations (DNS) of the NSB system as shown in \Cref{fig1}. Simulations are based on a Chebyshev-Fourier pseudo-spectral discretization  of \cref{NS,tran_incomp} in streamfunction-vorticity form with implicit-explicit time stepping \cite{PRF2023, peyret2002spectral, mac2021stable, Huang2022a}.
At low $\Ra$, \cref{fig1}(b) shows the existence of a stable conductive state with no fluid motion. In this regime, perturbations to the conductive state  decay rapidly, as seen in the plot below showing $L(t) \to 0$.
Increasing $\Ra$ eventually destabilizes the system, leading to the state shown in \cref{fig1}(c), where the fluid circulates either CW or CCW at a constant rate. By further increasing $\Ra$, this steady circulating state also destabilizes; the direction of circulation now alternates over time and the flow reverses chaotically, as shown in the time series of $L$ in \cref{fig1}(d). Interestingly, chaos disappears when $\Ra$ becomes sufficiently high, and \cref{fig1}(e) reveals an oscillating state with periodic LSC reversals. Although the reversals are periodic, the DNS resolves fine-scale turbulent fluctuations. The nature of the fluctuations are characterized by the frequency power spectrum of the temperature field, shown in \cref{fig1}(f) to follow the turbulent Bolgiano-Obukhov power law of natural convection \cite{Wu1990, Lohse2010}.

Remarkably, all of these states are recovered by a low-dimensional model arising systematically from the NSB equations. Briefly, the derivation is as follows. In polar coordinates, $\uu = u(r,\theta,t) \eth + v(r,\theta,t) \er$ and $T = T(r,\theta,t)$, we perform a Fourier expansion in $\theta$ and a Laurent expansion in $r$, and truncate each to a desired order while enforcing all boundary conditions (BCs). The choice of Laurent expansion is guided by the form of the  conductive-state solution (see \cite{PRF2023}), and thus recovers this basic state with no approximation made. Inserting the truncated variables into \cref{NS,tran_incomp} and projecting onto the Fourier-Laurent basis yields a finite-dimensional dynamical system. In this letter, we consider the lowest-order system able to satisfy all BCs. Casting in terms of angular momentum $L(t)$ and CoM coordinates $(\xc(t), \yc(t))$ gives:
\begin{align}
\label{Ldot}
\dot{L} &= - \Ra \Pra \, \xc - \alpha \Pra \, L , \\
\label{xdot}
\dot{\xc} &= -k L (\yc - y_1) - \beta \xc ,  \\
\label{ydot}
\dot{\yc} &= k L \xc - \beta (\yc - y_0) .
\end{align}
where $\alpha, \beta, k, y_0, y_1$ are positive parameters that depend on $r_0$ only \cite{PRF2023}. We find this ODE system best approximates the true dynamics when the annulus is relatively narrow, and so we set $r_0 = 0.4$ in all subsequent numerical examples.
Notably, our analysis differs from derivations of other ODE models (e.g.~the Lorenz system) in that, rather than simply averaging over the radial variable \cite{Tritton1988, Gorman1986, Ehrhard1990}, the truncated Laurent expansion satisfies the BCs on both the inner and outer rings (see also \cite{Yorke1987}), precluding the need for any friction factors with empirically estimated coefficients \cite{Ehrhard1990}. We believe this is one reason our model accurately recovers the high-$\Ra$ large-scale dynamics even though it does not resolve the turbulent flow field. 


Interestingly, \cref{Ldot,xdot,ydot} are mathematically equivalent to a damped pendulum system with a particular form of external driving. The most crucial parameters are $y_1$, the height of the pendulum's fulcrum, and $y_0$, the height of the conductive-state CoM. With no driving ($\beta=0$), \cref{Ldot,xdot,ydot} correspond exactly to a linearly damped pendulum with fulcrum $(0,y_1)$. The terms with $\beta$ arise from the interaction of boundary heating and buoyancy, and they drive $(\xc,\yc)$ towards the conductive-state CoM $(0,y_0)$. Exact formulas available in \cite{PRF2023} show that $0<y_1<y_0$ for any $r_0$, meaning that the driving acts to destabilize the system by raising the CoM above the fulcrum. We remind the reader that none of these terms were conjectured; each arises directly from analysis of the governing NSB equations.

How well does this simple ODE system predict the dynamics of convection? \Cref{fig2} shows trajectories of $(L,\xc,\yc)$ computed by fully-resolved DNS (left) versus those computed by the ODE model (right) for the same Rayleigh numbers as \cref{fig1}(c)--(e). \Cref{fig2}(a)--(c) shows that the trajectories from DNS and the ODE model are remarkably similar across the range of $\Ra$, exhibiting (a) convergence to a stable circulating state, (b) chaotic dynamics near a strange attractor, and (c) periodic orbits at the highest $\Ra$. The trajectories in (b) and (c) indicate reversals of the LSC, as can be seen by the sign change of $L$. The LSC reversals are chaotic in (b) and periodic in (c).

% Figure environment removed


The bifurcation diagram in \cref{fig2}(d) shows that a pitchfork bifurcation occurs at a critical value $\Ra_1^*$. At this value, the conductive state loses stability, and, simultaneously, the bistable circulating states appear (CW and CCW circulation). 
At a second critical value, $\Ra_2^*$, these circulating states lose stability through a Hopf bifurcation. Immediately past $\Ra_2^*$, the dynamics are fractal-like and chaotic, characteristic of a strange attractor. These observations are further supported by measurements of the fractal dimension $D_2$ \cite{ott2002chaos} and Lyapunov exponent $\lambda$ shown in the inset. At much higher $\Ra$, order reemerges and the trajectories of $(\xc,\yc)$ closely resemble pendulum motion.

The ODE model yields exact formulas for both critical values \cite{PRF2023}:
\begin{equation}
\label{ra12}
\Ra_1^*  =  \frac{\alpha\beta}{k\dy}, \quad
\Ra_2^* = \frac{\alpha^2 \, \Pra}{k \dy} \left( 
\frac{\alpha \Pra + 4\beta}{\alpha \Pra - 2\beta} 
\right),
\end{equation}
where $\dy = y_0-y_1>0$ is the distance between the conductive-state CoM and the pendulum fulcrum. Briefly, the value $\Ra_1^*$ is found through linear stability analysis of the conductive state $(L,\xc,\yc) = (0,0,y_0)$. As $\Ra$ crosses $\Ra_1^*$, the conductive state loses stability and the circulating states appear.
Immediately past $\Ra_1^*$, the Jacobian of each circulating state possesses three real, negative eigenvalues. As $\Ra$ increases further, two eigenvalues become complex, $z_{2,3} = \sigma \pm i \omega$, with $\sigma<0$ initially. As $\Ra$ crosses $\Ra_2^*$, $\sigma$ becomes positive and thus the circulating states lose stability, giving way to the strange attractor seen in \cref{fig2}(b).

The formulas for $\Ra_1^*$ and $\Ra_2^*$ in \cref{ra12} delineate parameter space into regions of different qualitative behavior, as illustrated by \Cref{fig3}. In the figure, colored dots correspond to fully-resolved DNS, showing regions of a stable conductive state (blue), bistable circulating states (green), and LSC reversals, both chaotic (orange) and periodic (red). \Cref{ra12} predicts the boundaries between these regions well. In particular, $\Ra_1^*$ is independent of the Prandtl number, giving the vertical green line, while the orange curve shows the $\Pra$ dependence of $\Ra_2^*$.


% Figure environment removed

Interestingly, the formula for $\Ra_2^*$ has two asymptotes that can be understood. First, for $\Pra$ below the threshold $\Pra^* = 2 \beta/\alpha$ (black dashed line), the denominator of $\Ra_2^*$ is negative, indicating that no threshold exists and the circulating states remain stable for arbitrarily large $\Ra$.
To our knowledge, no previous numerical or experimental work has reported this critical $\Pra^*$. Second, as $\Pra \to \infty$, \cref{ra12} shows that $\Ra_2^*$ increases linearly with $\Pra$, giving the slant asymptote seen in the figure.


As $\Ra$ increases well beyond $\Ra_2^*$, large-scale chaos subsides and gives way to the nearly periodic LSC reversals seen in \cref{fig2}(c). The return to order is indicated by the fractal dimension dropping to one and the Lyapunov exponent dropping to zero at the same Rayleigh number, roughly $\Ra = 10^9$ in \cref{fig2}(d) inset. At this value, a stable limit cycle emerges in the ODE system, producing periodic orbits that resemble pendulum motion. \Cref{fig4}(a) shows  four such orbits for Rayleigh numbers in the range $\Ra = 1/4 \mbox{ -- } 16 \times 10^{10}$. At the lowest $\Ra$, the pendulum length $l$ varies somewhat over the period, but at higher $\Ra$, the orbit tightens and $l$ remains nearly constant throughout.
It is important to note that, although the large-scale dynamics are regular in this regime, the DNS shows that turbulent fluctuations still inhabit the small scales [see \cref{fig1}(e)]. 

% Figure environment removed

Each swing of the pendulum corresponds to a reversal of the LSC, offering a way to predict the dominant frequency $f^*$ of the reversals. \Cref{Ldot,xdot,ydot} correspond to a damped, driven pendulum  with gravitational constant $g = k l^2 \, \Ra \, \Pra$. Since the amplitude of oscillation is not small, the frequency depends on both the pendulum length $l$ and the maximum swing angle $\phim$. As detailed in \cite{PRF2023}, both of these quantities can be estimated from an energy balance with energy $E = \frac{1}{2} k L^2 + \Ra\, \Pra\, (\yc-y_1)$. The result is a simple formula for the frequency of LSC reversals in the high-$\Ra$ regime,
\begin{equation}
\label{f*}
f^* = \frac{\sqrt{kl \, \Ra \, \Pra\,}}{ 4 \, K(\sin^2 ({\phim}/{2})) },
\end{equation}
where $K$ is the complete elliptic integral of the first kind, and formulas for $l$ and $\phim$ are given in \cite{PRF2023}. 

As seen in \cref{fig4}(b), this simple formula accurately predicts the reversal frequency measured in the fully-resolved DNS (blue circles) over the largest decade of $\Ra$ run (roughly $\Ra = 2\times 10^8$ to $2\times10^9$). At higher $\Ra$, DNS becomes computationally prohibitive but numerical solution of the ODE model is feasible, and the corresponding measurements of $f^*$ also agree with  \cref{f*}. The close agreement between DNS, the ODE model, and \cref{f*} suggests the primary mechanism for LSC reversals has been properly accounted for.

The main result of this work is the ODE model \cref{Ldot,xdot,ydot} for thermal convection in an annulus, which reveals a previously unrecognized link to a pendulum system with driving that raises the CoM above the fulcrum. The system accurately captures the sequence of parameter bifurcations, including chaotic and periodic reversals of the LSC, and it accurately predicts the frequency of LSC reversals in the high-$\Ra$ regime. In this letter, we have focused on the lowest-order system capable of satisfying the BCs, but the truncation procedure can in principle be carried out to any order. The analysis thus provides a blueprint for obtaining a hierarchy of models to better understand the turbulent fluctuations underlying thermal convection.

We reiterate that the annular shape of the domain analyzed here accentuates the dominant circular flow pattern of thermal convection, while suppressing other effects (e.g.~corner rolls or detached plumes \cite{Sugiyama2010, Ni2015, Araujo2005}) that tend to be geometry specific. These other effects undoubtedly influence LSC dynamics, but the fact that our system exhibits reversals without them indicates that such effects are not essential for LSC reversals. Rather, the primary mechanism for LSC reversals is the inertial overshoot of the fluid CoM, as can be accurately described by pendulum swinging motion.
With the essence of LSC reversals captured by \cref{Ldot,xdot,ydot}, we hope this model can serve as the foundation for understanding LSC reversals in other geometries or with other forms of thermal forcing, perhaps through the inclusion of additional forcing or stochastic terms, or through the extension into three dimensions to account for azimuthal rotations of the LSC plane \cite{Brown2005}.

\vspace{.4em}
\noindent\textbf{\si{}} Supplementary movies are available at \url{https://math.nyu.edu/~jinzi/research/AnnularConvection/Movie/}.



\bibliography{manuscript}% Produces the bibliography via BibTeX.

\end{document}
%
% ****** End of file apssamp.tex ******
