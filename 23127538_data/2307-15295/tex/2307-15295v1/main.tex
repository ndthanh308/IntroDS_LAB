% Please make sure you insert your data according to the instructions in PoSauthmanual.pdf
\documentclass[a4paper,11pt]{article}

\usepackage{caption}
\usepackage{subcaption}
\usepackage{pos}
\usepackage{lipsum} %package to generate placeholder text in the following
%added by Rasmus
\usepackage{wrapfig,lipsum,booktabs}
\usepackage{float}
\usepackage{todonotes}
\usepackage{array,multirow,graphicx}
\usepackage{wrapfig}
\usepackage{lineno}
%\linenumbers

\title{Sensitivity of the IceCube Upgrade to Atmospheric Neutrino Oscillations}

\ShortTitle{Sensitivity of the IceCube Upgrade to Atm. Neutrino Oscillations}

% Don't change:
\author{The IceCube Collaboration \\{\normalsize \normalfont(a complete list of authors can be found at the end of the proceedings)}\\}

% Your emails:
\emailAdd{philipp.eller@tum.de}
\emailAdd{kayla.leonard@icecube.wisc.edu}
\emailAdd{jcw5951@psu.edu}
\emailAdd{rasmus.orsoe@tum.de}

\abstract{
% start of abstract
IceCube DeepCore, the existing low-energy extension of the IceCube Neutrino Observatory, was designed to lower the neutrino detection energy threshold to the GeV range. A new extension, called the IceCube Upgrade, will consist of seven additional strings installed within the DeepCore fiducial volume. The new modules will have spacings of about 20 m horizontally and 3 m vertically, compared to about 40-70 m horizontally and 7 m vertically in DeepCore. It will be deployed in the polar season of 2025/26. This additional hardware features new types of optical modules with multi-PMT configurations, as well as calibration devices. This upgrade will more than triple the number of PMT channels with respect to current IceCube, and will significantly enhance its capabilities in the GeV energy range. However, the increased channel count also poses new computational challenges for the event simulation, selection, and reconstruction. In this contribution we present updated oscillation sensitivities based on the latest advancements in simulation, event selection, and reconstruction techniques.
% end of abstract

\vspace{4mm}
{\bfseries Corresponding authors:}
Philipp Eller$^{1*}$, Kayla Leonard DeHolton$^{2}$, Jan Weldert$^{2}$, Rasmus \O rs\o e$^{1}$\\
{$^{1}$ \itshape Technical University of Munich, TUM School of Natural Sciences, Physics Department, 85747 Garching, Germany}\\
{$^{2}$ \itshape Dept. of Physics, Pennsylvania State University, University Park, PA 16802, USA}\\[4mm]
$^*$ Presenter

\ConferenceLogo{PoS_ICRC2023_logo.pdf}

\FullConference{The 38th International Cosmic Ray Conference (ICRC2023)\\ 26 July -- 3 August, 2023\\ Nagoya, Japan}
}

\begin{document}

\maketitle

\section{Introduction}
The IceCube Neutrino Observatory has been detecting atmospheric neutrinos in the GeV energy range using its low-energy extension DeepCore for the past decade \cite{Aartsen:2016icecube, IceCube:2011deepcore}. This data has been used to make precision measurements of the atmospheric neutrino oscillation parameters \cite{IceCube:2017numuprl, IceCube:2019nutauprd, IceCube:2023oscnextprd}%, Flercnn if on arxiv in time}
, tau neutrino appearance \cite{IceCube:2019nutauprd} and preference for the neutrino mass ordering (NMO) \cite{IceCube:2019dyb}.
A new extension, called the IceCube Upgrade, will be deployed in the polar season of 2025/26 and will consist of seven additional strings installed within the DeepCore fiducial volume. The new modules will have spacings of about 20\,m horizontally and 3\,m vertically, compared to about 40-70\,m horizontally and 7\,m vertically in DeepCore. This additional hardware features new types of optical modules with multi-PMT configurations. DEggs consist of two 8-inch PMTs pointing up and downards \cite{IceCube:2022degg}, while mDOMs consist of 24 3-inch PMTs pointing in all directions \cite{IceCube:2019anq}, as well as new calibration devices. This Upgrade will more than triple the number of PMT channels with respect to current IceCube, and will significantly enhance its capabilities in the GeV energy range.

The work presented here uses events simulated for the full 93-string detector configuration (``IC93'') using the state-of-the-art IceCube simulation chain, and new techniques that have been developed to clean the raw data, reconstruct events, and reject backgrounds (Sec.~\ref{sec:sim_proc}). We quantify the expected performance of the Upgrade detector extension, and compare to a scenario without the extension (Sec.~\ref{sec:results}). The sensitivities presented here supersede previous ones \cite{Ishihara:2019aao}.


% IceCube uses the Antarctic ice as the detection medium. When neutrinos interact in the ice, the detector observes Cherenkov light emitted by charged particles produced in the interaction. The two main event signatures are \textit{tracks} which are elongated signatures that arise from a muon traveling through the detector (atmospheric $\mu$, $\nu_\mu^{CC}$ interactions, or some $\nu_\tau^{CC}$ interactions) or \textit{cascades} which are spherical signatures that arise from all other interaction types ($\nu_e^{CC}$, most $\nu_\tau^{CC}$, and $\nu^{NC}$). In addition to neutrinos, the detector can also be triggered by atmospheric muons and noise from radioactive decays in the modules' glass housing. Signal and both background types 

% In Section 2 we discuss some new techniques developed to handle the multi-PMT configuration of the Upgrade. In Section 3 we discuss the expected performance of the detector to several atmospheric neutrino oscillation measurements, using a combination of the new detector configuration plus the 12 years of DeepCore that will exist by the time the Upgrade.


\section{Simulation \& Processing}
\label{sec:sim_proc}

\subsection{Simulation}
\label{sec:sim}
Events are simulated following a similar procedure to Ref.~\cite{IceCube:2023oscnextprd}, including neutrino interactions with GENIE \cite{genie:2009} and the two primary backgrounds (atmospheric muons and pure detector noise triggers), assuming our latest ice model which takes into account birefreingence due to the crystalline structure of the ice \cite{Rongen:2021rgc}. For the IceCube and DeepCore strings, extra ice scattering and absorption in the refrozen boreholes is included due to different optical properties compared to the original glacial ice. For the Upgrade strings, the local ice property changes are not necessary because of a planned de-gassing procedure that will be used to eliminate air bubbles introduced in deployment. Event trigger and filtering is based on the current DeepCore implementation but adjusted to take into account the new multi-PMT Upgrade modules, delivering a realistic baseline performance, while further studies for optimized triggers and detector calibration with the new devices are ongoing.



\subsection{Noise Cleaning}
\label{sec:clean}
% Figure environment removed


Radioactive decays in the glass housing of the optical modules are the largest source of noise pollution in the data. In the past, it has been sufficient to use cuts on the temporal and spatial distance of hits for noise cleaning. However, because of the increased channel count and the increased levels of radioactivity in the new modules' glass, these cuts are no longer sufficient for the IceCube Upgrade.
We developed a new cleaning algorithm based on a Graph Neutral Network (GNN) specifically for the IceCube Upgrade. It performs a binary classification to predict whether a pulse is signal or noise. The GNN encodes the irregular grid of the detector and the irregular topology by representing each event as a point-cloud graph, where each node represents an observed pulse in the detector and edges are drawn to the 8 nearest hits. For each node, we use features that describe the observed pulse such as charge and arrival time, and features that describe the PMT such as its position, relative optical efficiency, direction, and surface area.

We train a customized version of the GNN DynEdge \cite{dynedge_paper} from the open-source framework \textit{GraphNeT} \cite{graphnet_paper}, using a dataset with about 4 million neutrino and muon events. We apply a threshold of 0.7 on the classification output. An example event cleaned by the GNN is shown in Fig. \ref{fig:noise}. The GNN reduces the average amount of noise per neutrino event by a factor of about 10 with only a minor loss in signal. Before cleaning, 70\% of hits in the uncleaned pulse series are noise, and after cleaning an average of 6.8\% of noise hits remain. In addition, when the GNN is applied to pure noise events, less than 1\% of these events survive. Neutrino events with at least 8 hits after cleaning on average retain 91\% of the signal.

\subsection{Reconstruction \& Classification}
\label{sec:reco}
% \begin{wraptable}{r}{7.0cm}
% \caption{Balance and sample size for each machine learning task.}\label{dataset_distribution:1}
% \begin{tabular}{lll}
% \textbf{Task}          & \textbf{\#} (million) & \textbf{Balance}                           \\
% Energy        & 3.7                  & ($\nu_{\alpha}: 100\%$)           \\
% Zenith        & 3.7                 & ($\nu_{\alpha}: 100\%$)           \\
% Topology      & 2.8                 & ($\mathcal{T}$: 50\% , $\mathcal{C}$: 50\%)   \\
% $\nu_{\alpha}$/$\mu$ & 0.65, 0.18                 & ($\nu_{\alpha}: 50\%, \mu: 50\%$)
% \end{tabular}
% \end{wraptable} 
% and their balance and size are shown in Table \ref{dataset_distribution:1}.
After events are cleaned, four separate instances of DynEdge are trained to reconstruct and classify events based on the cleaned pulse series. These tasks include reconstructing the neutrino energy, zenith angle \& uncertainty,  and classifying events by particle type (muon vs. neutrino) and event topology  (track vs. cascade). Each of the 4 models is trained on a different task-specific subsamples. Sample balancing is performed for the classification tasks. Figure \ref{fig:reco} shows the reconstruction performance for energy and cos(zenith). We find that the neutrino/muon classifier provides several orders of magnitude of background reduction. The track/cascade classifier achieves a 0.82 Area Under the Curve (AUC) score, which is a significant improvement compared to what's previously been reported for DynEdge for IC86 \cite{dynedge_paper}.

% Figure environment removed

%\vspace{8pt} % to make the page break cleaner
\subsection{Event Selection}
\label{sec:selection}
Several levels of cuts are used to suppress the main backgrounds (atmospheric muons and noise) and achieve a high-purity neutrino sample, summarized in Fig.~\ref{fig:rates}. The first round consists of a few simple straight cuts, similar to what was used in Ref.~\cite{IceCube:2023oscnextprd}, that eliminate the most obvious background events.
The cut with the largest rejection power is the number of pulses 
\begin{wrapfigure}{r}{0.47\textwidth}
    \centering
    \vspace{-1em}
    % Figure removed
    \caption{Event rates as a function of selection step, from filter level up to the analysis level.}
    \label{fig:rates}
\end{wrapfigure}remaining after the noise cleaning procedure described above. After the straight cuts, a collection of machine learning classifiers are used to identify muon background events. One of these is the muon/neutrino GNN classifier described above. There are also two Boosted Decision Trees (BDTs) that use reconstructed quantities and variables describing the spatial and temporal distribution of the hits. These three classifiers are able to suppress the remaining muon background by three orders of magnitude resulting in a sample that is heavily dominated by neutrinos. A few final cuts are made to focus on the the events for which most of the oscillation signal comes from. Figure \ref{fig:final} shows the final level event distributions after these cuts are made.

% Figure environment removed

\section{Expected Oscillation Analysis Sensitivities}
\label{sec:results}


The analyses presented here largely follow previous DeepCore analyses, such as \cite{IceCube:2023oscnextprd}, and reflect realistic baseline sensitivities, while there is still room for improvement from better knowledge of systematic uncertainties and further optimization of the event selection and analysis choices. New, necessary parameters are added to take into account the new module types such as a new optical efficiency scale, and additional low energy cross section uncertainties are added since the energy threshold is lowered to 3\,GeV. This leads to a different treatment for (simulated) data coming before and after the new strings are deployed. Therefore, the different time periods are treated as separate data sources and we run a combined, simultaneous fit with correlated parameters.

We present the IceCube sensitivities to the atmospheric oscillation parameters ($\Delta m^2_{31}$ and $\theta_{23}$), a non-unitarity test with tau neutrinos, and the neutrino mass ordering.
We compare two scenarios: one with no new hardware installed and data-taking continuing as it is today (denoted as ``IC86'', reflecting the current 86 string detector). The other scenario includes the combined fit between 12 years of IC86 with additional years using the extra seven strings of the IceCube Upgrade from 2026 onwards (denoted as ``IC86 (12 yr) + IC93'').
Since the NMO signal is at a lower energy than the other analyses, different systematic uncertainties become more/less relevant, and therefore a slightly different set of parameters is used for the NMO analysis. An overview of the systematic uncertainties used is provided in Table~\ref{tab:sys}, and more details on each can be found in Ref.~\cite{IceCube:2023oscnextprd}. The largest contributions to uncertainty are currently from flux parameters, though this can be improved in the future by switching to newer flux models with reduced uncertainty \cite{daemonflux:2023}. The analyses assume true normal ordering and oscillation parameter values from NuFit 5.2 \cite{Esteban:2020cvm}.

%compare an IC86 (15 years without the new strings, dotted black line) result with an IC86+IC93 (12 years without the new strings plus 3 years with the new strings, solid black line) result. The livetime plots compare x years of IC86 with 12 years of IC86 plus x-12 years of IC93 for x > 12 years. For a livetime <= 12 years, only the IC86 result is shown.

% Please add the following required packages to your document preamble:
% \usepackage{multirow}
\begin{table}[H]
\footnotesize
% \begin{tabular}{l|p{8cm}lccc}
\begin{tabular}{l|l|ccc}
\textbf{Description} & \textbf{Parameter(s)}                                                                                                                                        & \textbf{Atm. osc.} & $\mathbf{\nu_\tau}$ & \textbf{NMO} \\ \hline
         
\textbf{Flux} & & & & \\
Spectral index  &     $\gamma$              &         x          &     x         &      x       \\
           \multirow{3}{7.5cm}{Uncertainty on  Pion and Kaon production (Barr et al. \cite{Barr_2006})} & $d_\pi$           & -                  & -              & x            \\
           & $g_\pi$, $h_\pi$, $i_\pi$, $w_K$, $z_K$ & x                  & x              & x            \\
           & $y_K$             & x                  & x              & -            \\
           Neutrino and Muon Normalizations                                                                                                                             & $ A_{eff} $, $\mu_{atm}$  & x                  & x              & x            \\ \hline
% \multirow{4}{*}{\rotatebox[origin=c]{90}{Cross section}} 
\textbf{Cross sections} & & & & \\
Deep inelastic scattering uncertainty \cite{NuGen}        & $\mathrm{DIS}_{\mathrm{CSMS}}$          & x                  & x              & -            \\
               Axial masses for Resonant CC and Quasi-elastic scattering                                                                                                 & $M_{A,res}^{CC}$, $M_{A,QE}$  & x                  & x              & x            \\
               Axial masses for Resonant NC and Coherent $\pi$ scattering                                                                                                  & $M_{A,res}^{NC}$, $M_{A,coh}$  & -                  & -              & x            \\
               Model uncertainty on tau neutrino cross section \cite{Conrad:2010mh}                                                                                 &      $\nu_{\tau}$ xsec            & -                  & -              & x            \\ \hline
% \multirow{3}{*}{\rotatebox[origin=c]{90}{Detector}}  
\textbf{Detector} & & & & \\
Bulk ice properties scattering and absorption                                                                                                     &    scat., abs.               & x                  & x              & x            \\
               Optical module efficiencies (IceCube and Upgrade modules)                                                                                          & $\mathrm{OM}_\mathrm{eff, ICDC}$, $\mathrm{OM}_\mathrm{eff, ICU}$   & x                  & x              & x            \\
               Angular acceptance (IC86 configuration only)                                                                                                              &        $p_0, p_1$           & x                  & x              & x            \\ \hline
% \multirow{5}{*}{\rotatebox[origin=c]{90}{Oscillation}}  
\textbf{Oscillations} & & & & \\
\multirow{2}{*}{Mixing Angles}      &  $\theta_{13}$                 & -                  & -              & x            \\
               & $\theta_{23}$                         & M                  & x              & x            \\
              Mass splitting      &     $\Delta m^2_{31}$              & M                  & x              & x            \\
              Unitarity breaking parameter         &    $\nu_\tau$ norm               & -                  & M              & -            \\
              Neutrino Mass Ordering                                                                                                                                      &      NMO             & NO                 & NO             & M           
\end{tabular}
\caption{Configuration of nuisance parameters for the analyses presented. The marker ``x'' indicates that a systematic is included in the fit, ``-'' means not included, and ``M'' denotes the measurement variable(s).}
\label{tab:sys}
\end{table}

\subsection{Atmospheric Oscillation Parameters}

We follow a similar analysis procedure to existing IceCube measurements of the atmospheric oscillation parameters \cite{IceCube:2023oscnextprd}. Figure~\ref{fig:numu_app_2d} shows the sensitivity at the 90\% confidence level after 3 years with the new strings. In Fig.~\ref{fig:numu_app_1d}, one dimensional projections to the oscillation parameters are shown. The new strings increase IceCube's sensitivity to $\Delta m^2_{31}$ and $\theta_{23}$ by about 20-30\% and allow for a significantly better constraint of the atmospheric neutrino oscillation parameters.

% Figure environment removed


\subsection{Non-unitary Mixing: Tau Neutrinos}

This analysis shows how well we can constrain the unitarity of the PMNS matrix in the tau sector by scaling the amount of $\nu_\tau$ appearance. More information about how IceCube measures $\nu_\tau$ appearance can be found in \cite{IceCube:2019nutauprd}.
Figure~\ref{fig:nutau} compares the sensitivity to the $\nu_{\tau}$ normalization with and without IceCube Upgrade. With the 3 years of data including Upgrade strings, the uncertainty can be almost reduced by a factor of two. To illustrate the evolution of this sensitivity, Fig.~\ref{fig:nutau_live} shows the $1\sigma$ uncertainty on the $\nu_\tau$ normalization as a function of the detector livetime. The new instrumentation will significantly improve IceCube's ability to constrain this parameter.

% Figure environment removed




\subsection{Neutrino Mass Ordering}

Finally, the sensitivity to the neutrino mass ordering is shown, where median sensitivity is defined according to \cite{Blennow:2013oma}. More information about how IceCube determines the NMO can be found in \cite{IceCube:2019dyb}. Note that while the systematic parameters used for the NMO sensitives were updated with respect to the previous two sections, however the other analysis choices are not fully optimized in the sensitivities presented below.
IceCube's sensitivity to the NMO strongly depends on the true value of $\theta_{23}$; Fig.~\ref{fig:NMO_t23} shows the sensitivity as a function of $\theta_{23}$ for both possible orderings separately. The sensitivity is significantly improved by adding the new strings.
Figure~\ref{fig:NMO_live} shows the evolution of the NMO sensitivity over time. With the additional strings, IceCube will reach more than $2\sigma$ within a few years for any allowed value of $\theta_{23}$ and either true ordering. Assuming a true normal ordering and preferential value of $\theta_{23}$, more than $3\sigma$ sensitivities are expected within 5 years.

% Figure environment removed



% Figure environment removed

\section{Conclusions}
In this work we presented the first end to end, full Monte Carlo based analysis for IceCube Upgrade oscillation physics, including new, realistic methods such as the GNN event cleaning and reconstruction, as well as a new event selection pipeline.
Strong improvements over the current IceCube DeepCore detector are expected. For a livetime of 3 years of the Upgrade detector, we expect to collect 315 thousand neutrinos with the selection presented here. This combined with the 277 thousand neutrinos expected from the 12 year data taken by IceCube DeepCore up until deployment, uncertainties are reduced at the order of 20-30\% for the atmospheric neutrino oscillation parameters, around 40\% for the tau normalization and a factor of almost $4\times$ boost in NMO sensitivity is seen.
The sensitivities presented are expected to improve in the future when leveraging the additional calibration devices that will be deployed with the Upgrade, and further optimizing the triggers, event selection \& processing, and analysis choices.


% Bibtex references:
\bibliographystyle{ICRC}
\bibliography{references}

% Alternatively, you can include references by hand:
%\begin{thebibliography}{99}
%\bibitem{...}
%
%\end{thebibliography}

\clearpage

%The following list of authors, affiliations and funding agencies will be updated at the day of submission. The following template is a placeholder generated via https://authorlist.icecube.wisc.edu/icecube on March 25, 2023 and will be updated.
\input{authorlist_IceCube.tex}

\end{document}
