\section{Computational Methods}
\label{sec:methods}

The SCC--DFTB method is a computational approach that approximates 
traditional Density Functional Theory (DFT) by considering 
valence electron interactions in MD simulations. 
It serves as a valuable tool for accurately predicting structures 
and thermodynamic properties prior to synthesis, providing 
insights into the gas adsorption properties of 2D carbon--based 
materials and their potential applications in various gas 
adsorption environments.
The SCC--DFTB method involves solving Kohn--Sham equations to 
obtain total valence electronic densities and energies for each 
atom utilizing a Hamiltonian functional based on a two-center 
approximation and optimized pseudo--atomic orbitals as the basis 
functions \cite{DFTBplus, Qiang}. Slater--Koster parameter files 
are utilized to provide tabulated Hamiltonian matrix elements, 
overlap integrals, and repulsive splines fitted to DFT 
dissociation curves. 
%These parameter files are read into the 
%computer memory only once at the start of the simulation, as 
%described in Koskinen et al. (2009) \cite{KOSKINEN2009237}. 
These parameters describe the overlap and hopping integrals 
between pairs of atoms in the tight--binding Hamiltonian. 
The optimal set of Slater-–Koster parameters have two main 
requirements: a good reproduction of the structure of the 
relevant electronic bands, and faithful representation of the 
orbital contribution along such bands.
Therefore, in the scope of this approach the total energy
of the system is expressed as
\begin{equation}
    E^{\rm DFTB} = E_{\rm band}+E_{\rm rep}+E_{\rm SCC},
\end{equation}
with the band structure energy, $E_{\rm band}$, defined
from the summation of the orbital energies $\epsilon_i$
over all occupied orbitals $\Psi_i$; 
the repulsive energy $E_{\rm rep}$ for the core--core
interactions related to the exchange--correlation energy 
and other contributions in the form of a 
set of distance--dependent pairwise terms;
and an SCC contribution, $E_{\rm SCC}$, as the contributions
given by charge--charge interactions in the system.
Therefore, the electronic energy is calculated by summing 
the occupied Kohn-Sham (KS) single--particle energies and the 
contributions from repulsive energies between diatomic atoms. 
To account for self--consistent charge (SCC) effects during 
the dynamics, an iterative procedure is used. 
%with SCC 
%corrections implemented in the DFTB$+$ code 
%version 22.2 \cite{DFTBplus}. 
%This procedure leads to convergence to a new electron density 
%at every time step during the simulation. The convergence is 
%enhanced by using an electronic temperature of 1000 K.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%

\subsection{Structures and binding energies}

GPNL is a two--dimensional carbon allotrope 
that possesses a hexagonal lattice structure with periodic
pores and its structure as reported 
%It is derived from 
%graphene by introducing line defects in the form of carbon--carbon 
%triple bonds along its lattice. The GPNL structure reported 
by Balaban et al. \cite{balaban1968chemical}  and Martins et al. 
\cite{Martins2022}, consists of three types of symmetrically 
distributed rings: dodecagon (C$_{12}$), hexagon (C$_6$), and
square (C$_4$), which forms a tiling 
of the Euclidean plane. The unit cell of GPNL, determined by 
Fabris et al. using DFT\cite{fabris2018theoretical}, belongs
to the $P6/mmm$ space group and contains a single
irreducible atom, which is considered in our SCC--DFTB 
calculations.
In our study, we performed optimization of the GPNL unit 
cell, resulting in lattice parameters 
$\vec{ \text{a}} = \vec{b} = 
6.735$ \AA{} and bond lengths of 1.50 Å for the square ring and 1.48 
Å for the hexagon ring identifying seven points of 
high symmetry \cite{martins2021new} which is 
in good agreement with experimental measurements for 1.42--1.46 \AA{} for the 6--C rings and 1.50-1.52 \AA{} for the two bonds 
joining the 6--C rings \cite{du2017new},  as shown in Fig. \ref{fig:structureGPNL}a). 
The central nanopore (dodecagon ring) in the unit cell has a diameter 
of 5.66 Å, in good agreement with DFT data  
\cite{fabris2018theoretical,C2TC00006G} 
and experimental measure of 5.8 \AA{} \cite{du2017new}. 
%Martins et al. \cite{martins2021new}  identified in the GPNL structure. 
To compare the adsorption capabilities of GPNL with graphene, 
we also optimized the unit cell of graphene using a well--known 
lattice parameters and bond lengths, as depicted in Fig. 
\ref{fig:structureGPNL}b).

% Figure environment removed

%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\subsection{Binding energies}

The interaction potentials between H$_2$, CO$_2$, and CH$_4$ 
molecules with graphene and GPNL are investigated using the 
DFTB method. To avoid interactions with periodic replicas, the unit 
cell of the optimized GPNL structure is replicated by 
3$\times$4$\times$1 and the unit cell of graphene is replicated by 
5$\times$5$\times$1 along the $x$ and $y$ directions. 
The larger cells are initially optimized using SCC-DFTB. 
Adiabatic calculations follow to determine potential energy curves. 
These curves depict molecule interactions with fully relaxed periodic 
sheets at different distances and adsorbate sites, incorporating 
dispersion corrections through van der Waals interactions.
\cite{10.1063/1.1329889}.
Thus, the total energies, $E(z)$, of the molecule--2D material 
system with a separation $z$ between the adsorbate 
sites and the center of mass of the molecules
are varied above the surface in a range of 0.5 to 7 \AA{}, 
which defines the computation of the adsorption potential 
as a function of the distance separation.
The total energy is then computed as:
\begin{equation}
    E(z) = E_{\rm Tot} - \left( E_{\rm 2D material} + E_{\rm Molecule}
    \right),
\end{equation}
where $E_{\rm Surface}$ is the total energy of the 
2D material; $E_{\rm Molecule}$ is the total energy of the 
isolated molecule: H$_2$, CH$_4$, 
and CO$_2$; and $E_{\rm Tot}$ is the energy of the 
interacting system at every $z$--distance. 
Thus, the binding energy is defined as 
$E_b = E(z_{\rm min})$ with $z_{\rm min}$ as the 
equilibrium molecule--surface distance. 
Total energy calculations are performed for the 
molecule--2D material system, varying the distance between 
the surface and the center of mass of the molecules 
along the $z$--axis. 
We consider 3 different adsorption sites for graphene and 
5 sites for GPNL based on unit cells of 
the materials.
The molecular symmetry planes are consider 
with respect to the surface plane in the calculations. 
The repulsive potential is cut off at
a distance below the second nearest--neighbor interaction
region for numerical stability. 
%However, this approximation may not always provide 
%satisfactory dissociation curves. 
%The SCC--DFTB framework addresses this limitation by 
%shifting the repulsive energy functions downward.



%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
\subsection{Semi--Classical Molecular Dynamics Simulations}

We conducted semi--classical molecular dynamics simulations
to investigate the adsorption dynamics of H$_2$, CH$_4$,
and CO$_2$ molecules on graphene and GPNL. 
For graphene, a $5\times5\times1$ supercell 
was used, while for GPNL, a $3\times3\times1$ supercell was 
employed. The surfaces were optimized and equilibrated to a 
temperature of 300 K using a Nose--Hoover thermostat.
To simulate the adsorption dynamics, we defined a target area of 1 
nm$^2$ on the surface, and molecules were randomly distributed on it 
using the velocity Verlet algorithm. 
The impact energy of the molecules was 8 eV, 
and 650 independent trajectories were generated for each molecule. 
A time step of 0.25 fs was used, and the molecules were emitted 
vertically with random orientations at an initial distance of 
0.6 nm above the surface. The simulations were 
performed for a duration of 350 fs,  
This timeframe was meticulously chosen to ensure convergence
in our MD simulations. It provided ample time for the molecules
to travel away from the carbon sheets while also guaranteeing
that the attached molecules remained bonded to the carbon atoms, 
preventing any detachment from the sheets.
%The calculations were executed on a computer cluster with 
%160--240 cores, and the simulations typically had a wall time of 
%approximately 20 minutes. 
We have previously employed this approach to study hydrogenation 
mechanisms of fullerene cages \cite{DOMINGUEZGUTIERREZ2018189}, 
electronic properties 
of borophene \cite{C7TC00976C}, and dynamic physisorption pathways of 
molecules on alumina surfaces \cite{aluminadftb}, demonstrating 
excellent agreement with first principles DFT calculations.


%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%5
\subsection{Optical absorbance and electron transport calculations}
%
%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%%
%\subsection{Optical absorbance}


The optical absorption is investigated within the DFTB framework as 
an electronic dynamic process in response to an external electric
field \cite{C8CP04625E,B926051J}. 
The conventional adiabatic approximation gives the time evolution 
of the electron density matrix by time integration of the 
Liouville--von Newmann equation expressed as
\begin{equation}
    i \hbar \frac{\partial \hat \rho}{\partial t} = 
    S^{-1}\hat H \hat \rho - \hat \rho S^{-1},
\end{equation}
where $\hat \rho$ is the single electron density matrix, 
$\hat S$ is the overlap matrix, and $\hat H$ is the system Hamiltonian 
that includes the external electric field as 
$\hat H = \hat H_0 + E_0 \delta (t-t_0) \hat e$ with 
$E_0$, the magnitude of the electric field, 
and $\hat e$, its direction. 
Under the framework of linear response, the absorbance $I(\omega)$ is
calculated as the imaginary part of the Fourier transform of the
induced dipole moment caused by an external field. 
In this study, the external field strength was set to 
$E_0 = 0.001$ V/\AA{}. The induced dipole moment was evaluated over
a $200$ fs time period using a time step of $\Delta t$ = 0.01 fs. 
The Fourier transform was performed with an exponential damping
function (using a 5 fs damping constant) to eliminate noise.



 The Non--Equilibrium Green's Functions formalism (NEGF) 
 is a robust  theoretical framework commonly used for 
 modeling electron transport in  nano--scale devices and
 is implemented in the DFTB code  \cite{Pecchia_2008}. 
In Fig. \ref{fig:transport_}, we provide a detailed illustration
of the geometric configuration of the graphene and GPNL 
structures, highlighting the specific regions involved in the 
electron transport calculations. To ensure accurate and reliable
results, several steps are followed: 1) The structures are carefully
divided into distinct sections, including the principal layers, 
two electrode contacts (drain and source), and the device region. 
This partitioning enables a systematic analysis of electron 
transport within the designated "scattering region."; 2) 
The drain section, represented by red spheres, corresponds to 
the region where electrons exit the device, while the source 
section, depicted by blue spheres, represents the region where 
electrons enter the device; 3) To simulate realistic conditions and 
investigate the impact of specific molecules on electron transport,
CO$_2$ molecules are introduced into the graphene device section,
and CH$_4$ molecules are added to the GPNL device section.
This allows us to study the interaction between the adsorbates
and the carbon-based materials and observe their influence on
the electron transport properties; and 4) Before performing the 
electron transport calculations, the entire system undergoes an 
optimization process. This optimization involves adjusting the 
positions and orientations of the atoms to find the most 
energetically favorable configuration for the combined 
graphene/GPNL--adsorbate system.


% Figure environment removed
