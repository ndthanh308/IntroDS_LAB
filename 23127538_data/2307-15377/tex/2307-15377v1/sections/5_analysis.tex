\section{Discussion}
\label{sec:discussion}

\input{figures/figure_complexity.tex}
\subsection{Effectiveness of Considering the Interaction Representation}


The Graph convolution Siamese network~\cite{liang2017similarity} provides a basic framework to deal with pairwise graph inputs by predicting the interaction from individually embedded inputs (i.e., $I(G_\mathcal{A})$ and $I(G_\mathcal{B})$).
However, as the interaction is only minimally reflected in the final prediction layer, previous works have extended the scope to leverage interaction representations (i.e., $I_n(G_\mathcal{A},G_\mathcal{B})$) during the embedding stage.
\textit{MHCADDI} exchanges node representations between two graphs in the message-passing step, while \textit{SimGNN} compares all node pairs of two graphs after the node embedding layers.
Since \textit{MHCADDI} and \textit{SimGNN} show a substantial gain in predictive power compared to simple Siamese networks (see Table \ref{tab:AUROC} and Table \ref{tab:GED_results}), it can be concluded that utilizing $I(G_\mathcal{A},G_\mathcal{A})$ in the embedding stage is crucial when dealing with pairwise graphs.
However, as these methods utilize all node pairs, unnecessary complexity and redundant information are produced.
This results in suboptimal performance and efficiency, thereby compromising the final prediction.
Our CAGPool focuses on subgraphs that are extracted by the interaction representation, mitigating the issue of noisy representations.
The experimental results in Table \ref{tab:AUROC} and Table \ref{tab:GED_results} show that CAGPool successfully utilizes the interaction representations at the graph-level $I_g(G_\mathcal{A},G_\mathcal{A})$, achieving state-of-the-art performance on both tasks.


\subsection{The Efficiency of Co-attention Graph Pooling}
\label{sec:complexity}
Figure \ref{fig:fig_complexity} illustrates the complexity of each method that treats pairwise graph input.
The Graph convolution Siamese network, being the most basic form, has an overall complexity bounded by the complexity of embedding each graph with GNNs: $O(|E_\mathcal{A}| + |E_\mathcal{B}|)$.
Recent methods, such as \textit{MHCADDI} and \textit{SimGNN}, construct interaction representations at the node-level and require pairwise calculations for every node pair between $V_\mathcal{A}$ and $V_\mathcal{B}$.
Therefore, the computational complexity is bounded by $O(|V_\mathcal{A}||V_\mathcal{B}|)$.
Strictly speaking, \textit{SimGNN} has a complexity of $O(\mbox{max}(|V_\mathcal{A}|,|V_\mathcal{B}|)^2)$.
On the other hand, our approach requires additional computation with a complexity of $O(|V_\mathcal{A}| + |V_\mathcal{B}|)$ for constructing the interaction representation at the graph-level and selecting the nodes.
Therefore, CAGPool maintains the $O(|E_\mathcal{A}| + |E_\mathcal{B}|)$ complexity of the simple graph convolution Siamese network without increasing the complexity upper bound.
Additionally, we only need $W_\alpha \in \mathbb{R}^{2nF' \times 2nF'}$ and $b_\alpha \in \mathbb{R}^{2nF'}$ (see Equation (\ref{eq:alpha})) as additional trainable parameters, where $n$ is the number of GCN layers and $F'$ is the hidden dimension.
Given inputs $X_A$ and $X_B$, our module produces $X_A’$ and $X_B’$, demonstrating a 31.2 $\sim$ 64.7\% faster running time than the node-level interaction module when we set the number of nodes from 50 to 200.
We describe the details in the supplementary material.

\subsection{Ablation Study}
\input{tables/ablation}
We conduct an ablation study to validate (1) whether co-attention serves as an effective component when treating pairwise graphs, and (2) whether CAGPool demonstrates a meaningful improvement compared to individual pooling without considering interaction representation.

For (1), it can be concluded that leveraging co-attention is effective by comparing \textit{MHCADDI-ML} and CAGPool with \textit{MPNN-Concat} (the vanilla Siamese Network architecture in Figure~\ref{fig:fig_complexity}).
Moreover, CAGPool shows a significant improvement in performance even when compared to \textit{MHCADDI-ML}, implying that CAGPool is a more effective way to utilize the co-attention mechanism.

For (2), we only consider hierarchical pooling methods with node selection to match our experimental settings.
For a fair comparison with other hierarchical node selection-based pooling methods, we implemented TopKPool~\cite{gao2019graph} and SAGPool~\cite{pmlr-v97-lee19c} and kept the pooling ratio at 50\%.
Although all pooling methods show a gain in performance, our co-attention-based approach serves as the most effective pooling method for pairwise graph prediction.

\subsection{Future Works}

\textbf{Studies on the extracted subgraphs.}
The main focus of our work is the proposal of a novel pooling method, CAGPool, for extracting subgraphs from graph pairs, which we refer to as $G'_\mathcal{A} = (V'_\mathcal{A}, E'_\mathcal{A})$ and $G'_\mathcal{B} = (V'_\mathcal{B}, E'_\mathcal{B})$, that can help predict labels such as drug-drug interactions.
Even if some nodes, $v \in V'$, are isolated, they contain important information due to the use of GCN layers.
In the context of predicting drug-drug interactions, it can be extremely difficult to disambiguate the functional groups (i.e., subgraphs) related to a specific side effect, even for experts in the biomedical field.
This is because these subgraphs do not directly interact with each other, but rather affect each other through complex biological pathways within the human body.
While our research did not specifically investigate this analysis, we expect that our method can facilitate future research in this area by identifying subgraphs that are likely to be related to the functional groups responsible for the side effects between drugs.


